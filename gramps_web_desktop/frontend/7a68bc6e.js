/* Version: 24.12.0 - December 7, 2024 15:18:37 */
const t=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,e=Symbol(),i=new Map;class r{constructor(t,i){if(this._$cssResult$=!0,i!==e)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){let e=i.get(this.cssText);return t&&void 0===e&&(i.set(this.cssText,e=new CSSStyleSheet),e.replaceSync(this.cssText)),e}toString(){return this.cssText}}const n=(t,...i)=>{const n=1===t.length?t[0]:i.reduce(((e,i,r)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[r+1]),t[0]);return new r(n,e)},a=t?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let i="";for(const e of t.cssRules)i+=e.cssText;return(t=>new r("string"==typeof t?t:t+"",e))(i)})(t):t;var s;const o=window.trustedTypes,l=o?o.emptyScript:"",c=window.reactiveElementPolyfillSupport,d={toAttribute(t,e){switch(e){case Boolean:t=t?l:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},h=(t,e)=>e!==t&&(e==e||t==t),p={attribute:!0,type:String,converter:d,reflect:!1,hasChanged:h};class u extends HTMLElement{constructor(){super(),this._$Et=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Ei=null,this.o()}static addInitializer(t){var e;null!==(e=this.l)&&void 0!==e||(this.l=[]),this.l.push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((e,i)=>{const r=this._$Eh(i,e);void 0!==r&&(this._$Eu.set(r,i),t.push(r))})),t}static createProperty(t,e=p){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const i="symbol"==typeof t?Symbol():"__"+t,r=this.getPropertyDescriptor(t,i,e);void 0!==r&&Object.defineProperty(this.prototype,t,r)}}static getPropertyDescriptor(t,e,i){return{get(){return this[e]},set(r){const n=this[t];this[e]=r,this.requestUpdate(t,n,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||p}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),this.elementProperties=new Map(t.elementProperties),this._$Eu=new Map,this.hasOwnProperty("properties")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const i of e)this.createProperty(i,t[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)e.unshift(a(t))}else void 0!==t&&e.push(a(t));return e}static _$Eh(t,e){const i=e.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof t?t.toLowerCase():void 0}o(){var t;this._$Ep=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Em(),this.requestUpdate(),null===(t=this.constructor.l)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,i;(null!==(e=this._$Eg)&&void 0!==e?e:this._$Eg=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(i=t.hostConnected)||void 0===i||i.call(t))}removeController(t){var e;null===(e=this._$Eg)||void 0===e||e.splice(this._$Eg.indexOf(t)>>>0,1)}_$Em(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Et.set(e,this[e]),delete this[e])}))}createRenderRoot(){var e;const i=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,i)=>{t?e.adoptedStyleSheets=i.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):i.forEach((t=>{const i=document.createElement("style"),r=window.litNonce;void 0!==r&&i.setAttribute("nonce",r),i.textContent=t.cssText,e.appendChild(i)}))})(i,this.constructor.elementStyles),i}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$ES(t,e,i=p){var r,n;const a=this.constructor._$Eh(t,i);if(void 0!==a&&!0===i.reflect){const s=(null!==(n=null===(r=i.converter)||void 0===r?void 0:r.toAttribute)&&void 0!==n?n:d.toAttribute)(e,i.type);this._$Ei=t,null==s?this.removeAttribute(a):this.setAttribute(a,s),this._$Ei=null}}_$AK(t,e){var i,r,n;const a=this.constructor,s=a._$Eu.get(t);if(void 0!==s&&this._$Ei!==s){const t=a.getPropertyOptions(s),o=t.converter,l=null!==(n=null!==(r=null===(i=o)||void 0===i?void 0:i.fromAttribute)&&void 0!==r?r:"function"==typeof o?o:null)&&void 0!==n?n:d.fromAttribute;this._$Ei=s,this[s]=l(e,t.type),this._$Ei=null}}requestUpdate(t,e,i){let r=!0;void 0!==t&&(((i=i||this.constructor.getPropertyOptions(t)).hasChanged||h)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===i.reflect&&this._$Ei!==t&&(void 0===this._$E_&&(this._$E_=new Map),this._$E_.set(t,i))):r=!1),!this.isUpdatePending&&r&&(this._$Ep=this._$EC())}async _$EC(){this.isUpdatePending=!0;try{await this._$Ep}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Et&&(this._$Et.forEach(((t,e)=>this[e]=t)),this._$Et=void 0);let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(i)):this._$EU()}catch(t){throw e=!1,this._$EU(),t}e&&this._$AE(i)}willUpdate(t){}_$AE(t){var e;null===(e=this._$Eg)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Ep}shouldUpdate(t){return!0}update(t){void 0!==this._$E_&&(this._$E_.forEach(((t,e)=>this._$ES(e,this[e],t))),this._$E_=void 0),this._$EU()}updated(t){}firstUpdated(t){}}var m;u.finalized=!0,u.elementProperties=new Map,u.elementStyles=[],u.shadowRootOptions={mode:"open"},null==c||c({ReactiveElement:u}),(null!==(s=globalThis.reactiveElementVersions)&&void 0!==s?s:globalThis.reactiveElementVersions=[]).push("1.1.1");const f=globalThis.trustedTypes,g=f?f.createPolicy("lit-html",{createHTML:t=>t}):void 0,_=`lit$${(Math.random()+"").slice(9)}$`,v="?"+_,y=`<${v}>`,b=document,x=(t="")=>b.createComment(t),w=t=>null===t||"object"!=typeof t&&"function"!=typeof t,k=Array.isArray,T=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,S=/-->/g,C=/>/g,E=/>|[ 	\n\r](?:([^\s"'>=/]+)([ 	\n\r]*=[ 	\n\r]*(?:[^ 	\n\r"'`<>=]|("|')|))|$)/g,$=/'/g,A=/"/g,I=/^(?:script|style|textarea)$/i,M=(t=>(e,...i)=>({_$litType$:t,strings:e,values:i}))(1),P=Symbol.for("lit-noChange"),R=Symbol.for("lit-nothing"),z=new WeakMap,D=(t,e,i)=>{var r,n;const a=null!==(r=null==i?void 0:i.renderBefore)&&void 0!==r?r:e;let s=a._$litPart$;if(void 0===s){const t=null!==(n=null==i?void 0:i.renderBefore)&&void 0!==n?n:null;a._$litPart$=s=new N(e.insertBefore(x(),t),t,void 0,null!=i?i:{})}return s._$AI(t),s},j=b.createTreeWalker(b,129,null,!1);class O{constructor({strings:t,_$litType$:e},i){let r;this.parts=[];let n=0,a=0;const s=t.length-1,o=this.parts,[l,c]=((t,e)=>{const i=t.length-1,r=[];let n,a=2===e?"<svg>":"",s=T;for(let e=0;e<i;e++){const i=t[e];let o,l,c=-1,d=0;for(;d<i.length&&(s.lastIndex=d,l=s.exec(i),null!==l);)d=s.lastIndex,s===T?"!--"===l[1]?s=S:void 0!==l[1]?s=C:void 0!==l[2]?(I.test(l[2])&&(n=RegExp("</"+l[2],"g")),s=E):void 0!==l[3]&&(s=E):s===E?">"===l[0]?(s=null!=n?n:T,c=-1):void 0===l[1]?c=-2:(c=s.lastIndex-l[2].length,o=l[1],s=void 0===l[3]?E:'"'===l[3]?A:$):s===A||s===$?s=E:s===S||s===C?s=T:(s=E,n=void 0);const h=s===E&&t[e+1].startsWith("/>")?" ":"";a+=s===T?i+y:c>=0?(r.push(o),i.slice(0,c)+"$lit$"+i.slice(c)+_+h):i+_+(-2===c?(r.push(void 0),e):h)}const o=a+(t[i]||"<?>")+(2===e?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==g?g.createHTML(o):o,r]})(t,e);if(this.el=O.createElement(l,i),j.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(r=j.nextNode())&&o.length<s;){if(1===r.nodeType){if(r.hasAttributes()){const t=[];for(const e of r.getAttributeNames())if(e.endsWith("$lit$")||e.startsWith(_)){const i=c[a++];if(t.push(e),void 0!==i){const t=r.getAttribute(i.toLowerCase()+"$lit$").split(_),e=/([.?@])?(.*)/.exec(i);o.push({type:1,index:n,name:e[2],strings:t,ctor:"."===e[1]?V:"?"===e[1]?Y:"@"===e[1]?Z:H})}else o.push({type:6,index:n})}for(const e of t)r.removeAttribute(e)}if(I.test(r.tagName)){const t=r.textContent.split(_),e=t.length-1;if(e>0){r.textContent=f?f.emptyScript:"";for(let i=0;i<e;i++)r.append(t[i],x()),j.nextNode(),o.push({type:2,index:++n});r.append(t[e],x())}}}else if(8===r.nodeType)if(r.data===v)o.push({type:2,index:n});else{let t=-1;for(;-1!==(t=r.data.indexOf(_,t+1));)o.push({type:7,index:n}),t+=_.length-1}n++}}static createElement(t,e){const i=b.createElement("template");return i.innerHTML=t,i}}function B(t,e,i=t,r){var n,a,s,o;if(e===P)return e;let l=void 0!==r?null===(n=i._$Cl)||void 0===n?void 0:n[r]:i._$Cu;const c=w(e)?void 0:e._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(a=null==l?void 0:l._$AO)||void 0===a||a.call(l,!1),void 0===c?l=void 0:(l=new c(t),l._$AT(t,i,r)),void 0!==r?(null!==(s=(o=i)._$Cl)&&void 0!==s?s:o._$Cl=[])[r]=l:i._$Cu=l),void 0!==l&&(e=B(t,l._$AS(t,e.values),l,r)),e}class F{constructor(t,e){this.v=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(t){var e;const{el:{content:i},parts:r}=this._$AD,n=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:b).importNode(i,!0);j.currentNode=n;let a=j.nextNode(),s=0,o=0,l=r[0];for(;void 0!==l;){if(s===l.index){let e;2===l.type?e=new N(a,a.nextSibling,this,t):1===l.type?e=new l.ctor(a,l.name,l.strings,this,t):6===l.type&&(e=new q(a,this,t)),this.v.push(e),l=r[++o]}s!==(null==l?void 0:l.index)&&(a=j.nextNode(),s++)}return n}m(t){let e=0;for(const i of this.v)void 0!==i&&(void 0!==i.strings?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class N{constructor(t,e,i,r){var n;this.type=2,this._$AH=R,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=r,this._$Cg=null===(n=null==r?void 0:r.isConnected)||void 0===n||n}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cg}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===t.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=B(this,t,e),w(t)?t===R||null==t||""===t?(this._$AH!==R&&this._$AR(),this._$AH=R):t!==this._$AH&&t!==P&&this.$(t):void 0!==t._$litType$?this.T(t):void 0!==t.nodeType?this.S(t):(t=>{var e;return k(t)||"function"==typeof(null===(e=t)||void 0===e?void 0:e[Symbol.iterator])})(t)?this.A(t):this.$(t)}M(t,e=this._$AB){return this._$AA.parentNode.insertBefore(t,e)}S(t){this._$AH!==t&&(this._$AR(),this._$AH=this.M(t))}$(t){this._$AH!==R&&w(this._$AH)?this._$AA.nextSibling.data=t:this.S(b.createTextNode(t)),this._$AH=t}T(t){var e;const{values:i,_$litType$:r}=t,n="number"==typeof r?this._$AC(t):(void 0===r.el&&(r.el=O.createElement(r.h,this.options)),r);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===n)this._$AH.m(i);else{const t=new F(n,this),e=t.p(this.options);t.m(i),this.S(e),this._$AH=t}}_$AC(t){let e=z.get(t.strings);return void 0===e&&z.set(t.strings,e=new O(t)),e}A(t){k(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,r=0;for(const n of t)r===e.length?e.push(i=new N(this.M(x()),this.M(x()),this,this.options)):i=e[r],i._$AI(n),r++;r<e.length&&(this._$AR(i&&i._$AB.nextSibling,r),e.length=r)}_$AR(t=this._$AA.nextSibling,e){var i;for(null===(i=this._$AP)||void 0===i||i.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$Cg=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class H{constructor(t,e,i,r,n){this.type=1,this._$AH=R,this._$AN=void 0,this.element=t,this.name=e,this._$AM=r,this.options=n,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=R}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,i,r){const n=this.strings;let a=!1;if(void 0===n)t=B(this,t,e,0),a=!w(t)||t!==this._$AH&&t!==P,a&&(this._$AH=t);else{const r=t;let s,o;for(t=n[0],s=0;s<n.length-1;s++)o=B(this,r[i+s],e,s),o===P&&(o=this._$AH[s]),a||(a=!w(o)||o!==this._$AH[s]),o===R?t=R:t!==R&&(t+=(null!=o?o:"")+n[s+1]),this._$AH[s]=o}a&&!r&&this.k(t)}k(t){t===R?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class V extends H{constructor(){super(...arguments),this.type=3}k(t){this.element[this.name]=t===R?void 0:t}}const U=f?f.emptyScript:"";class Y extends H{constructor(){super(...arguments),this.type=4}k(t){t&&t!==R?this.element.setAttribute(this.name,U):this.element.removeAttribute(this.name)}}class Z extends H{constructor(t,e,i,r,n){super(t,e,i,r,n),this.type=5}_$AI(t,e=this){var i;if((t=null!==(i=B(this,t,e,0))&&void 0!==i?i:R)===P)return;const r=this._$AH,n=t===R&&r!==R||t.capture!==r.capture||t.once!==r.once||t.passive!==r.passive,a=t!==R&&(r===R||n);n&&this.element.removeEventListener(this.name,this,r),a&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,i;"function"==typeof this._$AH?this._$AH.call(null!==(i=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==i?i:this.element,t):this._$AH.handleEvent(t)}}class q{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){B(this,t)}}const W=window.litHtmlPolyfillSupport;var G,X;null==W||W(O,N),(null!==(m=globalThis.litHtmlVersions)&&void 0!==m?m:globalThis.litHtmlVersions=[]).push("2.1.1");class K extends u{constructor(){super(...arguments),this.renderOptions={host:this},this._$Dt=void 0}createRenderRoot(){var t,e;const i=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=i.firstChild),i}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Dt=D(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Dt)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Dt)||void 0===t||t.setConnected(!1)}render(){return P}}K.finalized=!0,K._$litElement$=!0,null===(G=globalThis.litElementHydrateSupport)||void 0===G||G.call(globalThis,{LitElement:K});const J=globalThis.litElementPolyfillSupport;null==J||J({LitElement:K}),(null!==(X=globalThis.litElementVersions)&&void 0!==X?X:globalThis.litElementVersions=[]).push("3.1.1");var Q=function(t,e){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},Q(t,e)};function tt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}Q(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var et=function(){return et=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},et.apply(this,arguments)};function it(t,e,i,r){var n,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(s=(a<3?n(s):a>3?n(e,i,s):n(e,i))||s);return a>3&&s&&Object.defineProperty(e,i,s),s}function rt(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],r=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function nt(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,a=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)s.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return s}"function"==typeof SuppressedError&&SuppressedError;const at=t=>e=>"function"==typeof e?((t,e)=>(window.customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:i,elements:r}=e;return{kind:i,elements:r,finisher(e){window.customElements.define(t,e)}}})(t,e),st=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?{...e,finisher(i){i.createProperty(e.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(i){i.createProperty(e.key,t)}};function ot(t){return(e,i)=>void 0!==i?((t,e,i)=>{e.constructor.createProperty(i,t)})(t,e,i):st(t,e)}function lt(t){return ot({...t,state:!0})}const ct=({finisher:t,descriptor:e})=>(i,r)=>{var n;if(void 0===r){const r=null!==(n=i.originalKey)&&void 0!==n?n:i.key,a=null!=e?{kind:"method",placement:"prototype",key:r,descriptor:e(i.key)}:{...i,key:r};return null!=t&&(a.finisher=function(e){t(e,r)}),a}{const n=i.constructor;void 0!==e&&Object.defineProperty(i,r,e(r)),null==t||t(n,r)}};function dt(t){return ct({finisher:(e,i)=>{Object.assign(e.prototype[i],t)}})}function ht(t,e){return ct({descriptor:i=>{const r={get(){var e,i;return null!==(i=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==i?i:null},enumerable:!0,configurable:!0};if(e){const e="symbol"==typeof i?Symbol():"__"+i;r.get=function(){var i,r;return void 0===this[e]&&(this[e]=null!==(r=null===(i=this.renderRoot)||void 0===i?void 0:i.querySelector(t))&&void 0!==r?r:null),this[e]}}return r}})}function pt(t){return ct({descriptor:e=>({async get(){var e;return await this.updateComplete,null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t)},enumerable:!0,configurable:!0})})}function ut(t,e,i){let r,n=t;return"object"==typeof t?(n=t.slot,r=t):r={flatten:e},null!=i||(i=""),ct({descriptor:t=>({get(){var t,e;const a="slot"+(n?`[name=${n}]`:":not([name])"),s=null===(t=this.renderRoot)||void 0===t?void 0:t.querySelector(a);let o=null!==(e=null==s?void 0:s.assignedNodes(r))&&void 0!==e?e:[];return i&&(o=o.filter((t=>t.nodeType===Node.ELEMENT_NODE&&t.matches(i)))),o},enumerable:!0,configurable:!0})})}(()=>{var t,e,i;const r=Symbol(),n=Symbol(),a=Symbol(),s=Symbol(),o=Symbol(),l=Symbol(),c=Symbol(),d=Symbol(),h=Symbol(),p=Symbol(),u=Symbol(),m=Symbol(),f=Symbol();class g{constructor(){this[t]=[],this[e]=[],this[i]=new Set}destructor(){this[h](this[a]);const t=this;t[r]=null,t[a]=null,t[n]=null}get top(){const t=this[r];return t[t.length-1]||null}push(t){t&&t!==this.top&&(this.remove(t),this[l](t),this[r].push(t))}remove(t){const e=this[r].indexOf(t);return-1!==e&&(this[r].splice(e,1),e===this[r].length&&this[l](this.top),!0)}pop(){const t=this.top;return t&&this.remove(t),t}has(t){return-1!==this[r].indexOf(t)}[(t=r,e=a,i=n,l)](t){const e=this[n],i=this[a];if(!t)return this[h](i),e.clear(),void(this[a]=[]);const r=this[p](t);if(r[r.length-1].parentNode!==document.body)throw Error("Non-connected element cannot be a blocking element");this[a]=r;const s=this[u](t);if(!i.length)return void this[d](r,s,e);let o=i.length-1,l=r.length-1;for(;o>0&&l>0&&i[o]===r[l];)o--,l--;i[o]!==r[l]&&this[c](i[o],r[l]),o>0&&this[h](i.slice(0,o)),l>0&&this[d](r.slice(0,l),s,null)}[c](t,e){const i=t[s];this[m](t)&&!t.inert&&(t.inert=!0,i.add(t)),i.has(e)&&(e.inert=!1,i.delete(e)),e[o]=t[o],e[s]=i,t[o]=void 0,t[s]=void 0}[h](t){for(const e of t){e[o].disconnect(),e[o]=void 0;const t=e[s];for(const e of t)e.inert=!1;e[s]=void 0}}[d](t,e,i){for(const r of t){const t=r.parentNode,n=t.children,a=new Set;for(let t=0;t<n.length;t++){const s=n[t];s===r||!this[m](s)||e&&e.has(s)||(i&&s.inert?i.add(s):(s.inert=!0,a.add(s)))}r[s]=a;const l=new MutationObserver(this[f].bind(this));r[o]=l;let c=t;const d=c;d.__shady&&d.host&&(c=d.host),l.observe(c,{childList:!0})}}[f](t){const e=this[a],i=this[n];for(const r of t){const t=r.target.host||r.target,n=t===document.body?e.length:e.indexOf(t),a=e[n-1],o=a[s];for(let t=0;t<r.removedNodes.length;t++){const e=r.removedNodes[t];if(e===a)return console.info("Detected removal of the top Blocking Element."),void this.pop();o.has(e)&&(e.inert=!1,o.delete(e))}for(let t=0;t<r.addedNodes.length;t++){const e=r.addedNodes[t];this[m](e)&&(i&&e.inert?i.add(e):(e.inert=!0,o.add(e)))}}}[m](t){return!1===/^(style|template|script)$/.test(t.localName)}[p](t){const e=[];let i=t;for(;i&&i!==document.body;)if(i.nodeType===Node.ELEMENT_NODE&&e.push(i),i.assignedSlot){for(;i=i.assignedSlot;)e.push(i);i=e.pop()}else i=i.parentNode||i.host;return e}[u](t){const e=t.shadowRoot;if(!e)return null;const i=new Set;let r,n,a;const s=e.querySelectorAll("slot");if(s.length&&s[0].assignedNodes)for(r=0;r<s.length;r++)for(a=s[r].assignedNodes({flatten:!0}),n=0;n<a.length;n++)a[n].nodeType===Node.ELEMENT_NODE&&i.add(a[n]);return i}}document.$blockingElements=new g})();var mt=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();function ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(){if("undefined"!=typeof window){var t=Array.prototype.slice,e=Element.prototype.matches||Element.prototype.msMatchesSelector,i=["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","details","summary","iframe","object","embed","[contenteditable]"].join(","),r=function(){function r(t,e){ft(this,r),this._inertManager=e,this._rootElement=t,this._managedNodes=new Set,this._rootElement.hasAttribute("aria-hidden")?this._savedAriaHidden=this._rootElement.getAttribute("aria-hidden"):this._savedAriaHidden=null,this._rootElement.setAttribute("aria-hidden","true"),this._makeSubtreeUnfocusable(this._rootElement),this._observer=new MutationObserver(this._onMutation.bind(this)),this._observer.observe(this._rootElement,{attributes:!0,childList:!0,subtree:!0})}return mt(r,[{key:"destructor",value:function(){this._observer.disconnect(),this._rootElement&&(null!==this._savedAriaHidden?this._rootElement.setAttribute("aria-hidden",this._savedAriaHidden):this._rootElement.removeAttribute("aria-hidden")),this._managedNodes.forEach((function(t){this._unmanageNode(t.node)}),this),this._observer=null,this._rootElement=null,this._managedNodes=null,this._inertManager=null}},{key:"_makeSubtreeUnfocusable",value:function(t){var e=this;o(t,(function(t){return e._visitNode(t)}));var i=document.activeElement;if(!document.body.contains(t)){for(var r=t,n=void 0;r;){if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){n=r;break}r=r.parentNode}n&&(i=n.activeElement)}t.contains(i)&&(i.blur(),i===document.activeElement&&document.body.focus())}},{key:"_visitNode",value:function(t){if(t.nodeType===Node.ELEMENT_NODE){var r=t;r!==this._rootElement&&r.hasAttribute("inert")&&this._adoptInertRoot(r),(e.call(r,i)||r.hasAttribute("tabindex"))&&this._manageNode(r)}}},{key:"_manageNode",value:function(t){var e=this._inertManager.register(t,this);this._managedNodes.add(e)}},{key:"_unmanageNode",value:function(t){var e=this._inertManager.deregister(t,this);e&&this._managedNodes.delete(e)}},{key:"_unmanageSubtree",value:function(t){var e=this;o(t,(function(t){return e._unmanageNode(t)}))}},{key:"_adoptInertRoot",value:function(t){var e=this._inertManager.getInertRoot(t);e||(this._inertManager.setInert(t,!0),e=this._inertManager.getInertRoot(t)),e.managedNodes.forEach((function(t){this._manageNode(t.node)}),this)}},{key:"_onMutation",value:function(e,i){e.forEach((function(e){var i=e.target;if("childList"===e.type)t.call(e.addedNodes).forEach((function(t){this._makeSubtreeUnfocusable(t)}),this),t.call(e.removedNodes).forEach((function(t){this._unmanageSubtree(t)}),this);else if("attributes"===e.type)if("tabindex"===e.attributeName)this._manageNode(i);else if(i!==this._rootElement&&"inert"===e.attributeName&&i.hasAttribute("inert")){this._adoptInertRoot(i);var r=this._inertManager.getInertRoot(i);this._managedNodes.forEach((function(t){i.contains(t.node)&&r._manageNode(t.node)}))}}),this)}},{key:"managedNodes",get:function(){return new Set(this._managedNodes)}},{key:"hasSavedAriaHidden",get:function(){return null!==this._savedAriaHidden}},{key:"savedAriaHidden",set:function(t){this._savedAriaHidden=t},get:function(){return this._savedAriaHidden}}]),r}(),n=function(){function t(e,i){ft(this,t),this._node=e,this._overrodeFocusMethod=!1,this._inertRoots=new Set([i]),this._savedTabIndex=null,this._destroyed=!1,this.ensureUntabbable()}return mt(t,[{key:"destructor",value:function(){if(this._throwIfDestroyed(),this._node&&this._node.nodeType===Node.ELEMENT_NODE){var t=this._node;null!==this._savedTabIndex?t.setAttribute("tabindex",this._savedTabIndex):t.removeAttribute("tabindex"),this._overrodeFocusMethod&&delete t.focus}this._node=null,this._inertRoots=null,this._destroyed=!0}},{key:"_throwIfDestroyed",value:function(){if(this.destroyed)throw new Error("Trying to access destroyed InertNode")}},{key:"ensureUntabbable",value:function(){if(this.node.nodeType===Node.ELEMENT_NODE){var t=this.node;if(e.call(t,i)){if(-1===t.tabIndex&&this.hasSavedTabIndex)return;t.hasAttribute("tabindex")&&(this._savedTabIndex=t.tabIndex),t.setAttribute("tabindex","-1"),t.nodeType===Node.ELEMENT_NODE&&(t.focus=function(){},this._overrodeFocusMethod=!0)}else t.hasAttribute("tabindex")&&(this._savedTabIndex=t.tabIndex,t.removeAttribute("tabindex"))}}},{key:"addInertRoot",value:function(t){this._throwIfDestroyed(),this._inertRoots.add(t)}},{key:"removeInertRoot",value:function(t){this._throwIfDestroyed(),this._inertRoots.delete(t),0===this._inertRoots.size&&this.destructor()}},{key:"destroyed",get:function(){return this._destroyed}},{key:"hasSavedTabIndex",get:function(){return null!==this._savedTabIndex}},{key:"node",get:function(){return this._throwIfDestroyed(),this._node}},{key:"savedTabIndex",set:function(t){this._throwIfDestroyed(),this._savedTabIndex=t},get:function(){return this._throwIfDestroyed(),this._savedTabIndex}}]),t}(),a=function(){function i(t){if(ft(this,i),!t)throw new Error("Missing required argument; InertManager needs to wrap a document.");this._document=t,this._managedNodes=new Map,this._inertRoots=new Map,this._observer=new MutationObserver(this._watchForInert.bind(this)),l(t.head||t.body||t.documentElement),"loading"===t.readyState?t.addEventListener("DOMContentLoaded",this._onDocumentLoaded.bind(this)):this._onDocumentLoaded()}return mt(i,[{key:"setInert",value:function(t,e){if(e){if(this._inertRoots.has(t))return;var i=new r(t,this);if(t.setAttribute("inert",""),this._inertRoots.set(t,i),!this._document.body.contains(t))for(var n=t.parentNode;n;)11===n.nodeType&&l(n),n=n.parentNode}else{if(!this._inertRoots.has(t))return;this._inertRoots.get(t).destructor(),this._inertRoots.delete(t),t.removeAttribute("inert")}}},{key:"getInertRoot",value:function(t){return this._inertRoots.get(t)}},{key:"register",value:function(t,e){var i=this._managedNodes.get(t);return void 0!==i?i.addInertRoot(e):i=new n(t,e),this._managedNodes.set(t,i),i}},{key:"deregister",value:function(t,e){var i=this._managedNodes.get(t);return i?(i.removeInertRoot(e),i.destroyed&&this._managedNodes.delete(t),i):null}},{key:"_onDocumentLoaded",value:function(){t.call(this._document.querySelectorAll("[inert]")).forEach((function(t){this.setInert(t,!0)}),this),this._observer.observe(this._document.body||this._document.documentElement,{attributes:!0,subtree:!0,childList:!0})}},{key:"_watchForInert",value:function(i,r){var n=this;i.forEach((function(i){switch(i.type){case"childList":t.call(i.addedNodes).forEach((function(i){if(i.nodeType===Node.ELEMENT_NODE){var r=t.call(i.querySelectorAll("[inert]"));e.call(i,"[inert]")&&r.unshift(i),r.forEach((function(t){this.setInert(t,!0)}),n)}}),n);break;case"attributes":if("inert"!==i.attributeName)return;var r=i.target,a=r.hasAttribute("inert");n.setInert(r,a)}}),this)}}]),i}();if(!Element.prototype.hasOwnProperty("inert")){var s=new a(document);Object.defineProperty(Element.prototype,"inert",{enumerable:!0,get:function(){return this.hasAttribute("inert")},set:function(t){s.setInert(this,t)}})}}function o(t,e,i){if(t.nodeType==Node.ELEMENT_NODE){var r=t;e&&e(r);var n=r.shadowRoot;if(n)return void o(n,e);if("content"==r.localName){for(var a=r,s=a.getDistributedNodes?a.getDistributedNodes():[],l=0;l<s.length;l++)o(s[l],e);return}if("slot"==r.localName){for(var c=r,d=c.assignedNodes?c.assignedNodes({flatten:!0}):[],h=0;h<d.length;h++)o(d[h],e);return}}for(var p=t.firstChild;null!=p;)o(p,e),p=p.nextSibling}function l(t){if(!t.querySelector("style#inert-style, link#inert-style")){var e=document.createElement("style");e.setAttribute("id","inert-style"),e.textContent="\n[inert] {\n  pointer-events: none;\n  cursor: default;\n}\n\n[inert], [inert] * {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n",t.appendChild(e)}}}();var gt={ANIMATE:"mdc-drawer--animate",CLOSING:"mdc-drawer--closing",DISMISSIBLE:"mdc-drawer--dismissible",MODAL:"mdc-drawer--modal",OPEN:"mdc-drawer--open",OPENING:"mdc-drawer--opening",ROOT:"mdc-drawer"},_t={APP_CONTENT_SELECTOR:".mdc-drawer-app-content",CLOSE_EVENT:"MDCDrawer:closed",OPEN_EVENT:"MDCDrawer:opened",SCRIM_SELECTOR:".mdc-drawer-scrim",LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",LIST_ITEM_ACTIVATED_SELECTOR:".mdc-list-item--activated,.mdc-deprecated-list-item--activated"},vt=function(){function t(t){void 0===t&&(t={}),this.adapter=t}return Object.defineProperty(t,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),t.prototype.init=function(){},t.prototype.destroy=function(){},t}(),yt=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.animationFrame=0,r.animationTimer=0,r}return tt(e,t),Object.defineProperty(e,"strings",{get:function(){return _t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return gt},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},elementHasClass:function(){return!1},notifyClose:function(){},notifyOpen:function(){},saveFocus:function(){},restoreFocus:function(){},focusActiveNavigationItem:function(){},trapFocus:function(){},releaseFocus:function(){}}},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.animationTimer&&clearTimeout(this.animationTimer)},e.prototype.open=function(){var t=this;this.isOpen()||this.isOpening()||this.isClosing()||(this.adapter.addClass(gt.OPEN),this.adapter.addClass(gt.ANIMATE),this.runNextAnimationFrame((function(){t.adapter.addClass(gt.OPENING)})),this.adapter.saveFocus())},e.prototype.close=function(){!this.isOpen()||this.isOpening()||this.isClosing()||this.adapter.addClass(gt.CLOSING)},e.prototype.isOpen=function(){return this.adapter.hasClass(gt.OPEN)},e.prototype.isOpening=function(){return this.adapter.hasClass(gt.OPENING)||this.adapter.hasClass(gt.ANIMATE)},e.prototype.isClosing=function(){return this.adapter.hasClass(gt.CLOSING)},e.prototype.handleKeydown=function(t){var e=t.keyCode;("Escape"===t.key||27===e)&&this.close()},e.prototype.handleTransitionEnd=function(t){var e=gt.OPENING,i=gt.CLOSING,r=gt.OPEN,n=gt.ANIMATE,a=gt.ROOT;this.isElement(t.target)&&this.adapter.elementHasClass(t.target,a)&&(this.isClosing()?(this.adapter.removeClass(r),this.closed(),this.adapter.restoreFocus(),this.adapter.notifyClose()):(this.adapter.focusActiveNavigationItem(),this.opened(),this.adapter.notifyOpen()),this.adapter.removeClass(n),this.adapter.removeClass(e),this.adapter.removeClass(i))},e.prototype.opened=function(){},e.prototype.closed=function(){},e.prototype.runNextAnimationFrame=function(t){var e=this;cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame((function(){e.animationFrame=0,clearTimeout(e.animationTimer),e.animationTimer=setTimeout(t,0)}))},e.prototype.isElement=function(t){return Boolean(t.classList)},e}(vt),bt=yt,xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tt(e,t),e.prototype.handleScrimClick=function(){this.close()},e.prototype.opened=function(){this.adapter.trapFocus()},e.prototype.closed=function(){this.adapter.releaseFocus()},e}(yt);const wt=t=>t.nodeType===Node.ELEMENT_NODE;function kt(t){return{addClass:e=>{t.classList.add(e)},removeClass:e=>{t.classList.remove(e)},hasClass:e=>t.classList.contains(e)}}let Tt=!1;const St=()=>{},Ct={get passive(){return Tt=!0,!1}};document.addEventListener("x",St,Ct),document.removeEventListener("x",St);const Et=Tt,$t=(t=window.document)=>{let e=t.activeElement;const i=[];if(!e)return i;for(;e&&(i.push(e),e.shadowRoot);)e=e.shadowRoot.activeElement;return i},At=t=>{const e=$t();if(!e.length)return!1;const i=e[e.length-1],r=new Event("check-if-focused",{bubbles:!0,composed:!0});let n=[];const a=t=>{n=t.composedPath()};return document.body.addEventListener("check-if-focused",a),i.dispatchEvent(r),document.body.removeEventListener("check-if-focused",a),-1!==n.indexOf(t)};class It extends K{click(){if(this.mdcRoot)return this.mdcRoot.focus(),void this.mdcRoot.click();super.click()}createFoundation(){void 0!==this.mdcFoundation&&this.mdcFoundation.destroy(),this.mdcFoundationClass&&(this.mdcFoundation=new this.mdcFoundationClass(this.createAdapter()),this.mdcFoundation.init())}firstUpdated(){this.createFoundation()}}const Mt=t=>(e,i)=>{if(e.constructor._observers){if(!e.constructor.hasOwnProperty("_observers")){const t=e.constructor._observers;e.constructor._observers=new Map,t.forEach(((t,i)=>e.constructor._observers.set(i,t)))}}else{e.constructor._observers=new Map;const t=e.updated;e.updated=function(e){t.call(this,e),e.forEach(((t,e)=>{const i=this.constructor._observers.get(e);void 0!==i&&i.call(this,this[e],t)}))}}e.constructor._observers.set(i,t)},Lt=1,Pt=2,Rt=3,zt=4,Dt=t=>(...e)=>({_$litDirective$:t,values:e});class jt{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}const Ot=Dt(class extends jt{constructor(t){var e;if(super(t),t.type!==Lt||"class"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((e=>t[e])).join(" ")+" "}update(t,[e]){var i,r;if(void 0===this.st){this.st=new Set,void 0!==t.strings&&(this.et=new Set(t.strings.join(" ").split(/\s/).filter((t=>""!==t))));for(const t in e)e[t]&&!(null===(i=this.et)||void 0===i?void 0:i.has(t))&&this.st.add(t);return this.render(e)}const n=t.element.classList;this.st.forEach((t=>{t in e||(n.remove(t),this.st.delete(t))}));for(const t in e){const i=!!e[t];i===this.st.has(t)||(null===(r=this.et)||void 0===r?void 0:r.has(t))||(i?(n.add(t),this.st.add(t)):(n.remove(t),this.st.delete(t)))}return P}}),Bt=document.$blockingElements;class Ft extends It{constructor(){super(...arguments),this._previousFocus=null,this.open=!1,this.hasHeader=!1,this.type=""}get mdcFoundationClass(){return"modal"===this.type?xt:bt}createAdapter(){return Object.assign(Object.assign({},kt(this.mdcRoot)),{elementHasClass:(t,e)=>t.classList.contains(e),saveFocus:()=>{this._previousFocus=this.getRootNode().activeElement},restoreFocus:()=>{this._previousFocus&&this._previousFocus.focus&&this._previousFocus.focus()},notifyClose:()=>{this.open=!1,this.dispatchEvent(new Event(_t.CLOSE_EVENT,{bubbles:!0,cancelable:!0}))},notifyOpen:()=>{this.open=!0,this.dispatchEvent(new Event(_t.OPEN_EVENT,{bubbles:!0,cancelable:!0}))},focusActiveNavigationItem:()=>{},trapFocus:()=>{Bt.push(this),this.appContent.inert=!0},releaseFocus:()=>{Bt.remove(this),this.appContent.inert=!1}})}_handleScrimClick(){this.mdcFoundation instanceof xt&&this.mdcFoundation.handleScrimClick()}render(){const t="dismissible"===this.type||"modal"===this.type,e="modal"===this.type,i=this.hasHeader?M`
      <div class="mdc-drawer__header">
        <h3 class="mdc-drawer__title"><slot name="title"></slot></h3>
        <h6 class="mdc-drawer__subtitle"><slot name="subtitle"></slot></h6>
        <slot name="header"></slot>
      </div>
      `:"";return M`
      <aside class="mdc-drawer ${Ot({"mdc-drawer--dismissible":t,"mdc-drawer--modal":e})}">
        ${i}
        <div class="mdc-drawer__content"><slot></slot></div>
      </aside>
      ${e?M`<div class="mdc-drawer-scrim"
                          @click="${this._handleScrimClick}"></div>`:""}
      <div class="mdc-drawer-app-content">
        <slot name="appContent"></slot>
      </div>
      `}firstUpdated(){this.mdcRoot.addEventListener("keydown",(t=>this.mdcFoundation.handleKeydown(t))),this.mdcRoot.addEventListener("transitionend",(t=>this.mdcFoundation.handleTransitionEnd(t)))}updated(t){t.has("type")&&this.createFoundation()}}it([ht(".mdc-drawer")],Ft.prototype,"mdcRoot",void 0),it([ht(".mdc-drawer-app-content")],Ft.prototype,"appContent",void 0),it([Mt((function(t){""!==this.type&&(t?this.mdcFoundation.open():this.mdcFoundation.close())})),ot({type:Boolean,reflect:!0})],Ft.prototype,"open",void 0),it([ot({type:Boolean})],Ft.prototype,"hasHeader",void 0),it([ot({reflect:!0})],Ft.prototype,"type",void 0);const Nt=n`.mdc-drawer{border-color:rgba(0, 0, 0, 0.12);background-color:#fff;background-color:var(--mdc-theme-surface, #fff);border-top-left-radius:0;border-top-right-radius:0;border-top-right-radius:var(--mdc-shape-large, 0);border-bottom-right-radius:0;border-bottom-right-radius:var(--mdc-shape-large, 0);border-bottom-left-radius:0;z-index:6;width:256px;display:flex;flex-direction:column;flex-shrink:0;box-sizing:border-box;height:100%;border-right-width:1px;border-right-style:solid;overflow:hidden;transition-property:transform;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1)}.mdc-drawer .mdc-drawer__title{color:rgba(0, 0, 0, 0.87)}.mdc-drawer .mdc-deprecated-list-group__subheader{color:rgba(0, 0, 0, 0.6)}.mdc-drawer .mdc-drawer__subtitle{color:rgba(0, 0, 0, 0.6)}.mdc-drawer .mdc-deprecated-list-item__graphic{color:rgba(0, 0, 0, 0.6)}.mdc-drawer .mdc-deprecated-list-item{color:rgba(0, 0, 0, 0.87)}.mdc-drawer .mdc-deprecated-list-item--activated .mdc-deprecated-list-item__graphic{color:#6200ee}.mdc-drawer .mdc-deprecated-list-item--activated{color:rgba(98, 0, 238, 0.87)}[dir=rtl] .mdc-drawer,.mdc-drawer[dir=rtl]{border-top-left-radius:0;border-top-left-radius:var(--mdc-shape-large, 0);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:0;border-bottom-left-radius:var(--mdc-shape-large, 0)}.mdc-drawer .mdc-deprecated-list-item{border-radius:4px;border-radius:var(--mdc-shape-small, 4px)}.mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content{margin-left:256px;margin-right:0}[dir=rtl] .mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content,.mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content[dir=rtl]{margin-left:0;margin-right:256px}[dir=rtl] .mdc-drawer,.mdc-drawer[dir=rtl]{border-right-width:0;border-left-width:1px;border-right-style:none;border-left-style:solid}.mdc-drawer .mdc-deprecated-list-item{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-subtitle2-font-size, 0.875rem);line-height:1.375rem;line-height:var(--mdc-typography-subtitle2-line-height, 1.375rem);font-weight:500;font-weight:var(--mdc-typography-subtitle2-font-weight, 500);letter-spacing:0.0071428571em;letter-spacing:var(--mdc-typography-subtitle2-letter-spacing, 0.0071428571em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle2-text-transform, inherit);height:calc(48px - 2 * 4px);margin:8px 8px;padding:0 8px}.mdc-drawer .mdc-deprecated-list-item:nth-child(1){margin-top:2px}.mdc-drawer .mdc-deprecated-list-item:nth-last-child(1){margin-bottom:0}.mdc-drawer .mdc-deprecated-list-group__subheader{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-body2-font-size, 0.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:0.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, 0.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit);display:block;margin-top:0;line-height:normal;margin:0;padding:0 16px}.mdc-drawer .mdc-deprecated-list-group__subheader::before{display:inline-block;width:0;height:24px;content:"";vertical-align:0}.mdc-drawer .mdc-deprecated-list-divider{margin:3px 0 4px}.mdc-drawer .mdc-deprecated-list-item__text,.mdc-drawer .mdc-deprecated-list-item__graphic{pointer-events:none}.mdc-drawer--animate{transform:translateX(-100%)}[dir=rtl] .mdc-drawer--animate,.mdc-drawer--animate[dir=rtl]{transform:translateX(100%)}.mdc-drawer--opening{transform:translateX(0);transition-duration:250ms}[dir=rtl] .mdc-drawer--opening,.mdc-drawer--opening[dir=rtl]{transform:translateX(0)}.mdc-drawer--closing{transform:translateX(-100%);transition-duration:200ms}[dir=rtl] .mdc-drawer--closing,.mdc-drawer--closing[dir=rtl]{transform:translateX(100%)}.mdc-drawer__header{flex-shrink:0;box-sizing:border-box;min-height:64px;padding:0 16px 4px}.mdc-drawer__title{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-headline6-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1.25rem;font-size:var(--mdc-typography-headline6-font-size, 1.25rem);line-height:2rem;line-height:var(--mdc-typography-headline6-line-height, 2rem);font-weight:500;font-weight:var(--mdc-typography-headline6-font-weight, 500);letter-spacing:0.0125em;letter-spacing:var(--mdc-typography-headline6-letter-spacing, 0.0125em);text-decoration:inherit;text-decoration:var(--mdc-typography-headline6-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-headline6-text-transform, inherit);display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-drawer__title::before{display:inline-block;width:0;height:36px;content:"";vertical-align:0}.mdc-drawer__title::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-drawer__subtitle{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-body2-font-size, 0.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:0.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, 0.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit);display:block;margin-top:0;line-height:normal;margin-bottom:0}.mdc-drawer__subtitle::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-drawer__content{height:100%;overflow-y:auto;-webkit-overflow-scrolling:touch}.mdc-drawer--dismissible{left:0;right:initial;display:none;position:absolute}[dir=rtl] .mdc-drawer--dismissible,.mdc-drawer--dismissible[dir=rtl]{left:initial;right:0}.mdc-drawer--dismissible.mdc-drawer--open{display:flex}.mdc-drawer-app-content{margin-left:0;margin-right:0;position:relative}[dir=rtl] .mdc-drawer-app-content,.mdc-drawer-app-content[dir=rtl]{margin-left:0;margin-right:0}.mdc-drawer--modal{box-shadow:0px 8px 10px -5px rgba(0, 0, 0, 0.2),0px 16px 24px 2px rgba(0, 0, 0, 0.14),0px 6px 30px 5px rgba(0,0,0,.12);left:0;right:initial;display:none;position:fixed}.mdc-drawer--modal+.mdc-drawer-scrim{background-color:rgba(0, 0, 0, 0.32)}[dir=rtl] .mdc-drawer--modal,.mdc-drawer--modal[dir=rtl]{left:initial;right:0}.mdc-drawer--modal.mdc-drawer--open{display:flex}.mdc-drawer-scrim{display:none;position:fixed;top:0;left:0;width:100%;height:100%;z-index:5;transition-property:opacity;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1)}.mdc-drawer--open+.mdc-drawer-scrim{display:block}.mdc-drawer--animate+.mdc-drawer-scrim{opacity:0}.mdc-drawer--opening+.mdc-drawer-scrim{transition-duration:250ms;opacity:1}.mdc-drawer--closing+.mdc-drawer-scrim{transition-duration:200ms;opacity:0}.mdc-drawer-app-content{overflow:auto;flex:1}:host{display:flex;height:100%}.mdc-drawer{width:256px;width:var(--mdc-drawer-width, 256px)}.mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content{margin-left:256px;margin-left:var(--mdc-drawer-width, 256px);margin-right:0}[dir=rtl] .mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content,.mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content[dir=rtl]{margin-left:0;margin-right:256px;margin-right:var(--mdc-drawer-width, 256px)}`;let Ht=class extends Ft{};Ht.styles=[Nt],Ht=it([at("mwc-drawer")],Ht);var Vt={ACTIVE:"mdc-tab-indicator--active",FADE:"mdc-tab-indicator--fade",NO_TRANSITION:"mdc-tab-indicator--no-transition"},Ut={CONTENT_SELECTOR:".mdc-tab-indicator__content"},Yt=function(t){function e(i){return t.call(this,et(et({},e.defaultAdapter),i))||this}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return Vt},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Ut},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},computeContentClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},setContentStyleProperty:function(){}}},enumerable:!1,configurable:!0}),e.prototype.computeContentClientRect=function(){return this.adapter.computeContentClientRect()},e}(vt),Zt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tt(e,t),e.prototype.activate=function(){this.adapter.addClass(Yt.cssClasses.ACTIVE)},e.prototype.deactivate=function(){this.adapter.removeClass(Yt.cssClasses.ACTIVE)},e}(Yt),qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tt(e,t),e.prototype.activate=function(t){if(t){var e=this.computeContentClientRect(),i=t.width/e.width,r=t.left-e.left;this.adapter.addClass(Yt.cssClasses.NO_TRANSITION),this.adapter.setContentStyleProperty("transform","translateX("+r+"px) scaleX("+i+")"),this.computeContentClientRect(),this.adapter.removeClass(Yt.cssClasses.NO_TRANSITION),this.adapter.addClass(Yt.cssClasses.ACTIVE),this.adapter.setContentStyleProperty("transform","")}else this.adapter.addClass(Yt.cssClasses.ACTIVE)},e.prototype.deactivate=function(){this.adapter.removeClass(Yt.cssClasses.ACTIVE)},e}(Yt);class Wt extends It{constructor(){super(...arguments),this.icon="",this.fade=!1}get mdcFoundationClass(){return this.fade?Zt:qt}render(){const t={"mdc-tab-indicator__content--icon":this.icon,"material-icons":this.icon,"mdc-tab-indicator__content--underline":!this.icon};return M`
      <span class="mdc-tab-indicator ${Ot({"mdc-tab-indicator--fade":this.fade})}">
        <span class="mdc-tab-indicator__content ${Ot(t)}">${this.icon}</span>
      </span>
      `}updated(t){t.has("fade")&&this.createFoundation()}createAdapter(){return Object.assign(Object.assign({},kt(this.mdcRoot)),{computeContentClientRect:()=>this.contentElement.getBoundingClientRect(),setContentStyleProperty:(t,e)=>this.contentElement.style.setProperty(t,e)})}computeContentClientRect(){return this.mdcFoundation.computeContentClientRect()}activate(t){this.mdcFoundation.activate(t)}deactivate(){this.mdcFoundation.deactivate()}}it([ht(".mdc-tab-indicator")],Wt.prototype,"mdcRoot",void 0),it([ht(".mdc-tab-indicator__content")],Wt.prototype,"contentElement",void 0),it([ot()],Wt.prototype,"icon",void 0),it([ot({type:Boolean})],Wt.prototype,"fade",void 0);const Gt=n`.material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}.mdc-tab-indicator .mdc-tab-indicator__content--underline{border-color:#6200ee;border-color:var(--mdc-theme-primary, #6200ee)}.mdc-tab-indicator .mdc-tab-indicator__content--icon{color:#018786;color:var(--mdc-theme-secondary, #018786)}.mdc-tab-indicator .mdc-tab-indicator__content--underline{border-top-width:2px}.mdc-tab-indicator .mdc-tab-indicator__content--icon{height:34px;font-size:34px}.mdc-tab-indicator{display:flex;position:absolute;top:0;left:0;justify-content:center;width:100%;height:100%;pointer-events:none;z-index:1}.mdc-tab-indicator__content{transform-origin:left;opacity:0}.mdc-tab-indicator__content--underline{align-self:flex-end;box-sizing:border-box;width:100%;border-top-style:solid}.mdc-tab-indicator__content--icon{align-self:center;margin:0 auto}.mdc-tab-indicator--active .mdc-tab-indicator__content{opacity:1}.mdc-tab-indicator .mdc-tab-indicator__content{transition:250ms transform cubic-bezier(0.4, 0, 0.2, 1)}.mdc-tab-indicator--no-transition .mdc-tab-indicator__content{transition:none}.mdc-tab-indicator--fade .mdc-tab-indicator__content{transition:150ms opacity linear}.mdc-tab-indicator--active.mdc-tab-indicator--fade .mdc-tab-indicator__content{transition-delay:100ms}`;let Xt=class extends Wt{};function Kt(t,e){return(t.matches||t.webkitMatchesSelector||t.msMatchesSelector).call(t,e)}Xt.styles=[Gt],Xt=it([at("mwc-tab-indicator")],Xt);var Jt={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},Qt={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},te={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300};var ee=["touchstart","pointerdown","mousedown","keydown"],ie=["touchend","pointerup","mouseup","contextmenu"],re=[],ne=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.activationAnimationHasEnded=!1,r.activationTimer=0,r.fgDeactivationRemovalTimer=0,r.fgScale="0",r.frame={width:0,height:0},r.initialSize=0,r.layoutFrame=0,r.maxRadius=0,r.unboundedCoords={left:0,top:0},r.activationState=r.defaultActivationState(),r.activationTimerCallback=function(){r.activationAnimationHasEnded=!0,r.runDeactivationUXLogicIfReady()},r.activateHandler=function(t){r.activateImpl(t)},r.deactivateHandler=function(){r.deactivateImpl()},r.focusHandler=function(){r.handleFocus()},r.blurHandler=function(){r.handleBlur()},r.resizeHandler=function(){r.layout()},r}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return Jt},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Qt},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return te},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this,i=this.supportsPressRipple();if(this.registerRootHandlers(i),i){var r=e.cssClasses,n=r.ROOT,a=r.UNBOUNDED;requestAnimationFrame((function(){t.adapter.addClass(n),t.adapter.isUnbounded()&&(t.adapter.addClass(a),t.layoutInternal())}))}},e.prototype.destroy=function(){var t=this;if(this.supportsPressRipple()){this.activationTimer&&(clearTimeout(this.activationTimer),this.activationTimer=0,this.adapter.removeClass(e.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer&&(clearTimeout(this.fgDeactivationRemovalTimer),this.fgDeactivationRemovalTimer=0,this.adapter.removeClass(e.cssClasses.FG_DEACTIVATION));var i=e.cssClasses,r=i.ROOT,n=i.UNBOUNDED;requestAnimationFrame((function(){t.adapter.removeClass(r),t.adapter.removeClass(n),t.removeCssVars()}))}this.deregisterRootHandlers(),this.deregisterDeactivationHandlers()},e.prototype.activate=function(t){this.activateImpl(t)},e.prototype.deactivate=function(){this.deactivateImpl()},e.prototype.layout=function(){var t=this;this.layoutFrame&&cancelAnimationFrame(this.layoutFrame),this.layoutFrame=requestAnimationFrame((function(){t.layoutInternal(),t.layoutFrame=0}))},e.prototype.setUnbounded=function(t){var i=e.cssClasses.UNBOUNDED;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.handleFocus=function(){var t=this;requestAnimationFrame((function(){return t.adapter.addClass(e.cssClasses.BG_FOCUSED)}))},e.prototype.handleBlur=function(){var t=this;requestAnimationFrame((function(){return t.adapter.removeClass(e.cssClasses.BG_FOCUSED)}))},e.prototype.supportsPressRipple=function(){return this.adapter.browserSupportsCssVars()},e.prototype.defaultActivationState=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},e.prototype.registerRootHandlers=function(t){var e,i;if(t){try{for(var r=rt(ee),n=r.next();!n.done;n=r.next()){var a=n.value;this.adapter.registerInteractionHandler(a,this.activateHandler)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler)}this.adapter.registerInteractionHandler("focus",this.focusHandler),this.adapter.registerInteractionHandler("blur",this.blurHandler)},e.prototype.registerDeactivationHandlers=function(t){var e,i;if("keydown"===t.type)this.adapter.registerInteractionHandler("keyup",this.deactivateHandler);else try{for(var r=rt(ie),n=r.next();!n.done;n=r.next()){var a=n.value;this.adapter.registerDocumentInteractionHandler(a,this.deactivateHandler)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}},e.prototype.deregisterRootHandlers=function(){var t,e;try{for(var i=rt(ee),r=i.next();!r.done;r=i.next()){var n=r.value;this.adapter.deregisterInteractionHandler(n,this.activateHandler)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.adapter.deregisterInteractionHandler("focus",this.focusHandler),this.adapter.deregisterInteractionHandler("blur",this.blurHandler),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler)},e.prototype.deregisterDeactivationHandlers=function(){var t,e;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler);try{for(var i=rt(ie),r=i.next();!r.done;r=i.next()){var n=r.value;this.adapter.deregisterDocumentInteractionHandler(n,this.deactivateHandler)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.removeCssVars=function(){var t=this,i=e.strings;Object.keys(i).forEach((function(e){0===e.indexOf("VAR_")&&t.adapter.updateCssVariable(i[e],null)}))},e.prototype.activateImpl=function(t){var e=this;if(!this.adapter.isSurfaceDisabled()){var i=this.activationState;if(!i.isActivated){var r=this.previousActivationEvent;if(!(r&&void 0!==t&&r.type!==t.type))i.isActivated=!0,i.isProgrammatic=void 0===t,i.activationEvent=t,i.wasActivatedByPointer=!i.isProgrammatic&&(void 0!==t&&("mousedown"===t.type||"touchstart"===t.type||"pointerdown"===t.type)),void 0!==t&&re.length>0&&re.some((function(t){return e.adapter.containsEventTarget(t)}))?this.resetActivationState():(void 0!==t&&(re.push(t.target),this.registerDeactivationHandlers(t)),i.wasElementMadeActive=this.checkElementMadeActive(t),i.wasElementMadeActive&&this.animateActivation(),requestAnimationFrame((function(){re=[],i.wasElementMadeActive||void 0===t||" "!==t.key&&32!==t.keyCode||(i.wasElementMadeActive=e.checkElementMadeActive(t),i.wasElementMadeActive&&e.animateActivation()),i.wasElementMadeActive||(e.activationState=e.defaultActivationState())})))}}},e.prototype.checkElementMadeActive=function(t){return void 0===t||"keydown"!==t.type||this.adapter.isSurfaceActive()},e.prototype.animateActivation=function(){var t=this,i=e.strings,r=i.VAR_FG_TRANSLATE_START,n=i.VAR_FG_TRANSLATE_END,a=e.cssClasses,s=a.FG_DEACTIVATION,o=a.FG_ACTIVATION,l=e.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal();var c="",d="";if(!this.adapter.isUnbounded()){var h=this.getFgTranslationCoordinates(),p=h.startPoint,u=h.endPoint;c=p.x+"px, "+p.y+"px",d=u.x+"px, "+u.y+"px"}this.adapter.updateCssVariable(r,c),this.adapter.updateCssVariable(n,d),clearTimeout(this.activationTimer),clearTimeout(this.fgDeactivationRemovalTimer),this.rmBoundedActivationClasses(),this.adapter.removeClass(s),this.adapter.computeBoundingRect(),this.adapter.addClass(o),this.activationTimer=setTimeout((function(){t.activationTimerCallback()}),l)},e.prototype.getFgTranslationCoordinates=function(){var t,e=this.activationState,i=e.activationEvent;return t=e.wasActivatedByPointer?function(t,e,i){if(!t)return{x:0,y:0};var r,n,a=e.x,s=e.y,o=a+i.left,l=s+i.top;if("touchstart"===t.type){var c=t;r=c.changedTouches[0].pageX-o,n=c.changedTouches[0].pageY-l}else{var d=t;r=d.pageX-o,n=d.pageY-l}return{x:r,y:n}}(i,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):{x:this.frame.width/2,y:this.frame.height/2},{startPoint:t={x:t.x-this.initialSize/2,y:t.y-this.initialSize/2},endPoint:{x:this.frame.width/2-this.initialSize/2,y:this.frame.height/2-this.initialSize/2}}},e.prototype.runDeactivationUXLogicIfReady=function(){var t=this,i=e.cssClasses.FG_DEACTIVATION,r=this.activationState,n=r.hasDeactivationUXRun,a=r.isActivated;(n||!a)&&this.activationAnimationHasEnded&&(this.rmBoundedActivationClasses(),this.adapter.addClass(i),this.fgDeactivationRemovalTimer=setTimeout((function(){t.adapter.removeClass(i)}),te.FG_DEACTIVATION_MS))},e.prototype.rmBoundedActivationClasses=function(){var t=e.cssClasses.FG_ACTIVATION;this.adapter.removeClass(t),this.activationAnimationHasEnded=!1,this.adapter.computeBoundingRect()},e.prototype.resetActivationState=function(){var t=this;this.previousActivationEvent=this.activationState.activationEvent,this.activationState=this.defaultActivationState(),setTimeout((function(){return t.previousActivationEvent=void 0}),e.numbers.TAP_DELAY_MS)},e.prototype.deactivateImpl=function(){var t=this,e=this.activationState;if(e.isActivated){var i=et({},e);e.isProgrammatic?(requestAnimationFrame((function(){t.animateDeactivation(i)})),this.resetActivationState()):(this.deregisterDeactivationHandlers(),requestAnimationFrame((function(){t.activationState.hasDeactivationUXRun=!0,t.animateDeactivation(i),t.resetActivationState()})))}},e.prototype.animateDeactivation=function(t){var e=t.wasActivatedByPointer,i=t.wasElementMadeActive;(e||i)&&this.runDeactivationUXLogicIfReady()},e.prototype.layoutInternal=function(){var t=this;this.frame=this.adapter.computeBoundingRect();var i=Math.max(this.frame.height,this.frame.width);this.maxRadius=this.adapter.isUnbounded()?i:Math.sqrt(Math.pow(t.frame.width,2)+Math.pow(t.frame.height,2))+e.numbers.PADDING;var r=Math.floor(i*e.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&r%2!=0?this.initialSize=r-1:this.initialSize=r,this.fgScale=""+this.maxRadius/this.initialSize,this.updateLayoutCssVars()},e.prototype.updateLayoutCssVars=function(){var t=e.strings,i=t.VAR_FG_SIZE,r=t.VAR_LEFT,n=t.VAR_TOP,a=t.VAR_FG_SCALE;this.adapter.updateCssVariable(i,this.initialSize+"px"),this.adapter.updateCssVariable(a,this.fgScale),this.adapter.isUnbounded()&&(this.unboundedCoords={left:Math.round(this.frame.width/2-this.initialSize/2),top:Math.round(this.frame.height/2-this.initialSize/2)},this.adapter.updateCssVariable(r,this.unboundedCoords.left+"px"),this.adapter.updateCssVariable(n,this.unboundedCoords.top+"px"))},e}(vt),ae=ne;const se=Dt(class extends jt{constructor(t){var e;if(super(t),t.type!==Lt||"style"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce(((e,i)=>{const r=t[i];return null==r?e:e+`${i=i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`}),"")}update(t,[e]){const{style:i}=t.element;if(void 0===this.ct){this.ct=new Set;for(const t in e)this.ct.add(t);return this.render(e)}this.ct.forEach((t=>{null==e[t]&&(this.ct.delete(t),t.includes("-")?i.removeProperty(t):i[t]="")}));for(const t in e){const r=e[t];null!=r&&(this.ct.add(t),t.includes("-")?i.setProperty(t,r):i[t]=r)}return P}});class oe extends It{constructor(){super(...arguments),this.primary=!1,this.accent=!1,this.unbounded=!1,this.disabled=!1,this.activated=!1,this.selected=!1,this.internalUseStateLayerCustomProperties=!1,this.hovering=!1,this.bgFocused=!1,this.fgActivation=!1,this.fgDeactivation=!1,this.fgScale="",this.fgSize="",this.translateStart="",this.translateEnd="",this.leftPos="",this.topPos="",this.mdcFoundationClass=ae}get isActive(){return Kt(this.parentElement||this,":active")}createAdapter(){return{browserSupportsCssVars:()=>!0,isUnbounded:()=>this.unbounded,isSurfaceActive:()=>this.isActive,isSurfaceDisabled:()=>this.disabled,addClass:t=>{switch(t){case"mdc-ripple-upgraded--background-focused":this.bgFocused=!0;break;case"mdc-ripple-upgraded--foreground-activation":this.fgActivation=!0;break;case"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation=!0}},removeClass:t=>{switch(t){case"mdc-ripple-upgraded--background-focused":this.bgFocused=!1;break;case"mdc-ripple-upgraded--foreground-activation":this.fgActivation=!1;break;case"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation=!1}},containsEventTarget:()=>!0,registerInteractionHandler:()=>{},deregisterInteractionHandler:()=>{},registerDocumentInteractionHandler:()=>{},deregisterDocumentInteractionHandler:()=>{},registerResizeHandler:()=>{},deregisterResizeHandler:()=>{},updateCssVariable:(t,e)=>{switch(t){case"--mdc-ripple-fg-scale":this.fgScale=e;break;case"--mdc-ripple-fg-size":this.fgSize=e;break;case"--mdc-ripple-fg-translate-end":this.translateEnd=e;break;case"--mdc-ripple-fg-translate-start":this.translateStart=e;break;case"--mdc-ripple-left":this.leftPos=e;break;case"--mdc-ripple-top":this.topPos=e}},computeBoundingRect:()=>(this.parentElement||this).getBoundingClientRect(),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset})}}startPress(t){this.waitForFoundation((()=>{this.mdcFoundation.activate(t)}))}endPress(){this.waitForFoundation((()=>{this.mdcFoundation.deactivate()}))}startFocus(){this.waitForFoundation((()=>{this.mdcFoundation.handleFocus()}))}endFocus(){this.waitForFoundation((()=>{this.mdcFoundation.handleBlur()}))}startHover(){this.hovering=!0}endHover(){this.hovering=!1}waitForFoundation(t){this.mdcFoundation?t():this.updateComplete.then(t)}update(t){t.has("disabled")&&this.disabled&&this.endHover(),super.update(t)}render(){const t=this.activated&&(this.primary||!this.accent),e=this.selected&&(this.primary||!this.accent),i={"mdc-ripple-surface--accent":this.accent,"mdc-ripple-surface--primary--activated":t,"mdc-ripple-surface--accent--activated":this.accent&&this.activated,"mdc-ripple-surface--primary--selected":e,"mdc-ripple-surface--accent--selected":this.accent&&this.selected,"mdc-ripple-surface--disabled":this.disabled,"mdc-ripple-surface--hover":this.hovering,"mdc-ripple-surface--primary":this.primary,"mdc-ripple-surface--selected":this.selected,"mdc-ripple-upgraded--background-focused":this.bgFocused,"mdc-ripple-upgraded--foreground-activation":this.fgActivation,"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation,"mdc-ripple-upgraded--unbounded":this.unbounded,"mdc-ripple-surface--internal-use-state-layer-custom-properties":this.internalUseStateLayerCustomProperties};return M`
        <div class="mdc-ripple-surface mdc-ripple-upgraded ${Ot(i)}"
          style="${se({"--mdc-ripple-fg-scale":this.fgScale,"--mdc-ripple-fg-size":this.fgSize,"--mdc-ripple-fg-translate-end":this.translateEnd,"--mdc-ripple-fg-translate-start":this.translateStart,"--mdc-ripple-left":this.leftPos,"--mdc-ripple-top":this.topPos})}"></div>`}}it([ht(".mdc-ripple-surface")],oe.prototype,"mdcRoot",void 0),it([ot({type:Boolean})],oe.prototype,"primary",void 0),it([ot({type:Boolean})],oe.prototype,"accent",void 0),it([ot({type:Boolean})],oe.prototype,"unbounded",void 0),it([ot({type:Boolean})],oe.prototype,"disabled",void 0),it([ot({type:Boolean})],oe.prototype,"activated",void 0),it([ot({type:Boolean})],oe.prototype,"selected",void 0),it([ot({type:Boolean})],oe.prototype,"internalUseStateLayerCustomProperties",void 0),it([lt()],oe.prototype,"hovering",void 0),it([lt()],oe.prototype,"bgFocused",void 0),it([lt()],oe.prototype,"fgActivation",void 0),it([lt()],oe.prototype,"fgDeactivation",void 0),it([lt()],oe.prototype,"fgScale",void 0),it([lt()],oe.prototype,"fgSize",void 0),it([lt()],oe.prototype,"translateStart",void 0),it([lt()],oe.prototype,"translateEnd",void 0),it([lt()],oe.prototype,"leftPos",void 0),it([lt()],oe.prototype,"topPos",void 0);const le=n`.mdc-ripple-surface{--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0);will-change:transform,opacity;position:relative;outline:none;overflow:hidden}.mdc-ripple-surface::before,.mdc-ripple-surface::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-ripple-surface::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1;z-index:var(--mdc-ripple-z-index, 1)}.mdc-ripple-surface::after{z-index:0;z-index:var(--mdc-ripple-z-index, 0)}.mdc-ripple-surface.mdc-ripple-upgraded::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-ripple-surface.mdc-ripple-upgraded::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-ripple-surface.mdc-ripple-upgraded--foreground-activation::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-ripple-surface.mdc-ripple-upgraded--foreground-deactivation::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-ripple-surface::before,.mdc-ripple-surface::after{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-ripple-surface.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-ripple-surface[data-mdc-ripple-is-unbounded],.mdc-ripple-upgraded--unbounded{overflow:visible}.mdc-ripple-surface[data-mdc-ripple-is-unbounded]::before,.mdc-ripple-surface[data-mdc-ripple-is-unbounded]::after,.mdc-ripple-upgraded--unbounded::before,.mdc-ripple-upgraded--unbounded::after{top:calc(50% - 50%);left:calc(50% - 50%);width:100%;height:100%}.mdc-ripple-surface[data-mdc-ripple-is-unbounded].mdc-ripple-upgraded::before,.mdc-ripple-surface[data-mdc-ripple-is-unbounded].mdc-ripple-upgraded::after,.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::before,.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::after{top:var(--mdc-ripple-top, calc(50% - 50%));left:var(--mdc-ripple-left, calc(50% - 50%));width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-ripple-surface[data-mdc-ripple-is-unbounded].mdc-ripple-upgraded::after,.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-ripple-surface::before,.mdc-ripple-surface::after{background-color:#000;background-color:var(--mdc-ripple-color, #000)}.mdc-ripple-surface:hover::before,.mdc-ripple-surface.mdc-ripple-surface--hover::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-ripple-surface.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-ripple-surface:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-ripple-surface.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}:host{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;display:block}:host .mdc-ripple-surface{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;will-change:unset}.mdc-ripple-surface--primary::before,.mdc-ripple-surface--primary::after{background-color:#6200ee;background-color:var(--mdc-ripple-color, var(--mdc-theme-primary, #6200ee))}.mdc-ripple-surface--primary:hover::before,.mdc-ripple-surface--primary.mdc-ripple-surface--hover::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-ripple-surface--primary.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--primary:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-ripple-surface--primary:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--primary:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-ripple-surface--primary.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-ripple-surface--primary--activated::before{opacity:0.12;opacity:var(--mdc-ripple-activated-opacity, 0.12)}.mdc-ripple-surface--primary--activated::before,.mdc-ripple-surface--primary--activated::after{background-color:#6200ee;background-color:var(--mdc-ripple-color, var(--mdc-theme-primary, #6200ee))}.mdc-ripple-surface--primary--activated:hover::before,.mdc-ripple-surface--primary--activated.mdc-ripple-surface--hover::before{opacity:0.16;opacity:var(--mdc-ripple-hover-opacity, 0.16)}.mdc-ripple-surface--primary--activated.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--primary--activated:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:0.24;opacity:var(--mdc-ripple-focus-opacity, 0.24)}.mdc-ripple-surface--primary--activated:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--primary--activated:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:0.24;opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-ripple-surface--primary--activated.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-ripple-surface--primary--selected::before{opacity:0.08;opacity:var(--mdc-ripple-selected-opacity, 0.08)}.mdc-ripple-surface--primary--selected::before,.mdc-ripple-surface--primary--selected::after{background-color:#6200ee;background-color:var(--mdc-ripple-color, var(--mdc-theme-primary, #6200ee))}.mdc-ripple-surface--primary--selected:hover::before,.mdc-ripple-surface--primary--selected.mdc-ripple-surface--hover::before{opacity:0.12;opacity:var(--mdc-ripple-hover-opacity, 0.12)}.mdc-ripple-surface--primary--selected.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--primary--selected:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:0.2;opacity:var(--mdc-ripple-focus-opacity, 0.2)}.mdc-ripple-surface--primary--selected:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--primary--selected:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:0.2;opacity:var(--mdc-ripple-press-opacity, 0.2)}.mdc-ripple-surface--primary--selected.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.2)}.mdc-ripple-surface--accent::before,.mdc-ripple-surface--accent::after{background-color:#018786;background-color:var(--mdc-ripple-color, var(--mdc-theme-secondary, #018786))}.mdc-ripple-surface--accent:hover::before,.mdc-ripple-surface--accent.mdc-ripple-surface--hover::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-ripple-surface--accent.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--accent:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-ripple-surface--accent:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--accent:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-ripple-surface--accent.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-ripple-surface--accent--activated::before{opacity:0.12;opacity:var(--mdc-ripple-activated-opacity, 0.12)}.mdc-ripple-surface--accent--activated::before,.mdc-ripple-surface--accent--activated::after{background-color:#018786;background-color:var(--mdc-ripple-color, var(--mdc-theme-secondary, #018786))}.mdc-ripple-surface--accent--activated:hover::before,.mdc-ripple-surface--accent--activated.mdc-ripple-surface--hover::before{opacity:0.16;opacity:var(--mdc-ripple-hover-opacity, 0.16)}.mdc-ripple-surface--accent--activated.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--accent--activated:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:0.24;opacity:var(--mdc-ripple-focus-opacity, 0.24)}.mdc-ripple-surface--accent--activated:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--accent--activated:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:0.24;opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-ripple-surface--accent--activated.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-ripple-surface--accent--selected::before{opacity:0.08;opacity:var(--mdc-ripple-selected-opacity, 0.08)}.mdc-ripple-surface--accent--selected::before,.mdc-ripple-surface--accent--selected::after{background-color:#018786;background-color:var(--mdc-ripple-color, var(--mdc-theme-secondary, #018786))}.mdc-ripple-surface--accent--selected:hover::before,.mdc-ripple-surface--accent--selected.mdc-ripple-surface--hover::before{opacity:0.12;opacity:var(--mdc-ripple-hover-opacity, 0.12)}.mdc-ripple-surface--accent--selected.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--accent--selected:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:0.2;opacity:var(--mdc-ripple-focus-opacity, 0.2)}.mdc-ripple-surface--accent--selected:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--accent--selected:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:0.2;opacity:var(--mdc-ripple-press-opacity, 0.2)}.mdc-ripple-surface--accent--selected.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.2)}.mdc-ripple-surface--disabled{opacity:0}.mdc-ripple-surface--internal-use-state-layer-custom-properties::before,.mdc-ripple-surface--internal-use-state-layer-custom-properties::after{background-color:#000;background-color:var(--mdc-ripple-hover-state-layer-color, #000)}.mdc-ripple-surface--internal-use-state-layer-custom-properties:hover::before,.mdc-ripple-surface--internal-use-state-layer-custom-properties.mdc-ripple-surface--hover::before{opacity:0.04;opacity:var(--mdc-ripple-hover-state-layer-opacity, 0.04)}.mdc-ripple-surface--internal-use-state-layer-custom-properties.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--internal-use-state-layer-custom-properties:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-state-layer-opacity, 0.12)}.mdc-ripple-surface--internal-use-state-layer-custom-properties:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--internal-use-state-layer-custom-properties:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-pressed-state-layer-opacity, 0.12)}.mdc-ripple-surface--internal-use-state-layer-custom-properties.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-pressed-state-layer-opacity, 0.12)}`;let ce=class extends oe{};ce.styles=[le],ce=it([at("mwc-ripple")],ce);class de{constructor(t){this.startPress=e=>{t().then((t=>{t&&t.startPress(e)}))},this.endPress=()=>{t().then((t=>{t&&t.endPress()}))},this.startFocus=()=>{t().then((t=>{t&&t.startFocus()}))},this.endFocus=()=>{t().then((t=>{t&&t.endFocus()}))},this.startHover=()=>{t().then((t=>{t&&t.startHover()}))},this.endHover=()=>{t().then((t=>{t&&t.endHover()}))}}}var he={ACTIVE:"mdc-tab--active"},pe={ARIA_SELECTED:"aria-selected",CONTENT_SELECTOR:".mdc-tab__content",INTERACTED_EVENT:"MDCTab:interacted",RIPPLE_SELECTOR:".mdc-tab__ripple",TABINDEX:"tabIndex",TAB_INDICATOR_SELECTOR:".mdc-tab-indicator"},ue=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.focusOnActivate=!0,r}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return he},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return pe},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setAttr:function(){},activateIndicator:function(){},deactivateIndicator:function(){},notifyInteracted:function(){},getOffsetLeft:function(){return 0},getOffsetWidth:function(){return 0},getContentOffsetLeft:function(){return 0},getContentOffsetWidth:function(){return 0},focus:function(){}}},enumerable:!1,configurable:!0}),e.prototype.handleClick=function(){this.adapter.notifyInteracted()},e.prototype.isActive=function(){return this.adapter.hasClass(he.ACTIVE)},e.prototype.setFocusOnActivate=function(t){this.focusOnActivate=t},e.prototype.activate=function(t){this.adapter.addClass(he.ACTIVE),this.adapter.setAttr(pe.ARIA_SELECTED,"true"),this.adapter.setAttr(pe.TABINDEX,"0"),this.adapter.activateIndicator(t),this.focusOnActivate&&this.adapter.focus()},e.prototype.deactivate=function(){this.isActive()&&(this.adapter.removeClass(he.ACTIVE),this.adapter.setAttr(pe.ARIA_SELECTED,"false"),this.adapter.setAttr(pe.TABINDEX,"-1"),this.adapter.deactivateIndicator())},e.prototype.computeDimensions=function(){var t=this.adapter.getOffsetWidth(),e=this.adapter.getOffsetLeft(),i=this.adapter.getContentOffsetWidth(),r=this.adapter.getContentOffsetLeft();return{contentLeft:e+r,contentRight:e+r+i,rootLeft:e,rootRight:e+t}},e}(vt);let me=0;class fe extends It{constructor(){super(...arguments),this.mdcFoundationClass=ue,this.label="",this.icon="",this.hasImageIcon=!1,this.isFadingIndicator=!1,this.minWidth=!1,this.isMinWidthIndicator=!1,this.indicatorIcon="",this.stacked=!1,this.focusOnActivate=!0,this._active=!1,this.initFocus=!1,this.shouldRenderRipple=!1,this.useStateLayerCustomProperties=!1,this.rippleElement=null,this.rippleHandlers=new de((()=>(this.shouldRenderRipple=!0,this.ripple.then((t=>this.rippleElement=t)),this.ripple)))}get active(){return this._active}connectedCallback(){this.dir=document.dir,super.connectedCallback()}firstUpdated(){super.firstUpdated(),this.id=this.id||"mdc-tab-"+ ++me}render(){const t={"mdc-tab--min-width":this.minWidth,"mdc-tab--stacked":this.stacked};let e=M``;(this.hasImageIcon||this.icon)&&(e=M`
        <span class="mdc-tab__icon material-icons"><slot name="icon">${this.icon}</slot></span>`);let i=M``;return this.label&&(i=M`
        <span class="mdc-tab__text-label">${this.label}</span>`),M`
      <button
        @click="${this.handleClick}"
        class="mdc-tab ${Ot(t)}"
        role="tab"
        aria-selected="false"
        tabindex="-1"
        @focus="${this.focus}"
        @blur="${this.handleBlur}"
        @mousedown="${this.handleRippleMouseDown}"
        @mouseenter="${this.handleRippleMouseEnter}"
        @mouseleave="${this.handleRippleMouseLeave}"
        @touchstart="${this.handleRippleTouchStart}"
        @touchend="${this.handleRippleDeactivate}"
        @touchcancel="${this.handleRippleDeactivate}">
        <span class="mdc-tab__content">
          ${e}
          ${i}
          ${this.isMinWidthIndicator?this.renderIndicator():""}
        </span>
        ${this.isMinWidthIndicator?"":this.renderIndicator()}
        ${this.renderRipple()}
      </button>`}renderIndicator(){return M`<mwc-tab-indicator
        .icon="${this.indicatorIcon}"
        .fade="${this.isFadingIndicator}"></mwc-tab-indicator>`}renderRipple(){return this.shouldRenderRipple?M`<mwc-ripple primary
        .internalUseStateLayerCustomProperties="${this.useStateLayerCustomProperties}"></mwc-ripple>`:""}createAdapter(){return Object.assign(Object.assign({},kt(this.mdcRoot)),{setAttr:(t,e)=>this.mdcRoot.setAttribute(t,e),activateIndicator:async t=>{await this.tabIndicator.updateComplete,this.tabIndicator.activate(t)},deactivateIndicator:async()=>{await this.tabIndicator.updateComplete,this.tabIndicator.deactivate()},notifyInteracted:()=>this.dispatchEvent(new CustomEvent(ue.strings.INTERACTED_EVENT,{detail:{tabId:this.id},bubbles:!0,composed:!0,cancelable:!0})),getOffsetLeft:()=>this.offsetLeft,getOffsetWidth:()=>this.mdcRoot.offsetWidth,getContentOffsetLeft:()=>this._contentElement.offsetLeft,getContentOffsetWidth:()=>this._contentElement.offsetWidth,focus:()=>{this.initFocus?this.initFocus=!1:this.mdcRoot.focus()}})}activate(t){t||(this.initFocus=!0),this.mdcFoundation?(this.mdcFoundation.activate(t),this.setActive(this.mdcFoundation.isActive())):this.updateComplete.then((()=>{this.mdcFoundation.activate(t),this.setActive(this.mdcFoundation.isActive())}))}deactivate(){this.mdcFoundation.deactivate(),this.setActive(this.mdcFoundation.isActive())}setActive(t){const e=this.active;e!==t&&(this._active=t,this.requestUpdate("active",e))}computeDimensions(){return this.mdcFoundation.computeDimensions()}computeIndicatorClientRect(){return this.tabIndicator.computeContentClientRect()}focus(){this.mdcRoot.focus(),this.handleFocus()}handleClick(){this.handleFocus(),this.mdcFoundation.handleClick()}handleFocus(){this.handleRippleFocus()}handleBlur(){this.handleRippleBlur()}handleRippleMouseDown(t){const e=()=>{window.removeEventListener("mouseup",e),this.handleRippleDeactivate()};window.addEventListener("mouseup",e),this.rippleHandlers.startPress(t)}handleRippleTouchStart(t){this.rippleHandlers.startPress(t)}handleRippleDeactivate(){this.rippleHandlers.endPress()}handleRippleMouseEnter(){this.rippleHandlers.startHover()}handleRippleMouseLeave(){this.rippleHandlers.endHover()}handleRippleFocus(){this.rippleHandlers.startFocus()}handleRippleBlur(){this.rippleHandlers.endFocus()}get isRippleActive(){var t;return(null===(t=this.rippleElement)||void 0===t?void 0:t.isActive)||!1}}fe.shadowRootOptions={mode:"open",delegatesFocus:!0},it([ht(".mdc-tab")],fe.prototype,"mdcRoot",void 0),it([ht("mwc-tab-indicator")],fe.prototype,"tabIndicator",void 0),it([ot()],fe.prototype,"label",void 0),it([ot()],fe.prototype,"icon",void 0),it([ot({type:Boolean})],fe.prototype,"hasImageIcon",void 0),it([ot({type:Boolean})],fe.prototype,"isFadingIndicator",void 0),it([ot({type:Boolean})],fe.prototype,"minWidth",void 0),it([ot({type:Boolean})],fe.prototype,"isMinWidthIndicator",void 0),it([ot({type:Boolean,reflect:!0,attribute:"active"})],fe.prototype,"active",null),it([ot()],fe.prototype,"indicatorIcon",void 0),it([ot({type:Boolean})],fe.prototype,"stacked",void 0),it([Mt((async function(t){await this.updateComplete,this.mdcFoundation.setFocusOnActivate(t)})),ot({type:Boolean})],fe.prototype,"focusOnActivate",void 0),it([ht(".mdc-tab__content")],fe.prototype,"_contentElement",void 0),it([lt()],fe.prototype,"shouldRenderRipple",void 0),it([lt()],fe.prototype,"useStateLayerCustomProperties",void 0),it([pt("mwc-ripple")],fe.prototype,"ripple",void 0),it([dt({passive:!0})],fe.prototype,"handleRippleTouchStart",null);const ge=n`.material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}.mdc-tab{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-button-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-button-font-size, 0.875rem);line-height:2.25rem;line-height:var(--mdc-typography-button-line-height, 2.25rem);font-weight:500;font-weight:var(--mdc-typography-button-font-weight, 500);letter-spacing:0.0892857143em;letter-spacing:var(--mdc-typography-button-letter-spacing, 0.0892857143em);text-decoration:none;text-decoration:var(--mdc-typography-button-text-decoration, none);text-transform:uppercase;text-transform:var(--mdc-typography-button-text-transform, uppercase);position:relative}.mdc-tab .mdc-tab__text-label{color:rgba(0, 0, 0, 0.6)}.mdc-tab .mdc-tab__icon{color:rgba(0, 0, 0, 0.54);fill:currentColor}.mdc-tab.mdc-ripple-upgraded--background-focused.mdc-tab--active .mdc-tab__focus-ring,.mdc-tab:not(.mdc-ripple-upgraded):focus.mdc-tab--active .mdc-tab__focus-ring{pointer-events:none;border:2px solid transparent;border-radius:8px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc( 100% + -12px );width:calc( 100% + -8px );margin-top:-2px;z-index:2}@media screen and (forced-colors: active){.mdc-tab.mdc-ripple-upgraded--background-focused.mdc-tab--active .mdc-tab__focus-ring,.mdc-tab:not(.mdc-ripple-upgraded):focus.mdc-tab--active .mdc-tab__focus-ring{border-color:CanvasText}}.mdc-tab.mdc-ripple-upgraded--background-focused.mdc-tab--active .mdc-tab__focus-ring::after,.mdc-tab:not(.mdc-ripple-upgraded):focus.mdc-tab--active .mdc-tab__focus-ring::after{content:"";border:2px solid transparent;border-radius:10px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-tab.mdc-ripple-upgraded--background-focused.mdc-tab--active .mdc-tab__focus-ring::after,.mdc-tab:not(.mdc-ripple-upgraded):focus.mdc-tab--active .mdc-tab__focus-ring::after{border-color:CanvasText}}.mdc-tab.mdc-ripple-upgraded--background-focused .mdc-tab__focus-ring,.mdc-tab:not(.mdc-ripple-upgraded):focus .mdc-tab__focus-ring{pointer-events:none;border:2px solid transparent;border-radius:8px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc( 100% + -8px );width:calc( 100% + -8px );z-index:2}@media screen and (forced-colors: active){.mdc-tab.mdc-ripple-upgraded--background-focused .mdc-tab__focus-ring,.mdc-tab:not(.mdc-ripple-upgraded):focus .mdc-tab__focus-ring{border-color:CanvasText}}.mdc-tab.mdc-ripple-upgraded--background-focused .mdc-tab__focus-ring::after,.mdc-tab:not(.mdc-ripple-upgraded):focus .mdc-tab__focus-ring::after{content:"";border:2px solid transparent;border-radius:10px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-tab.mdc-ripple-upgraded--background-focused .mdc-tab__focus-ring::after,.mdc-tab:not(.mdc-ripple-upgraded):focus .mdc-tab__focus-ring::after{border-color:CanvasText}}.mdc-tab__content{position:relative}.mdc-tab__icon{width:24px;height:24px;font-size:24px}.mdc-tab--active .mdc-tab__text-label{color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}.mdc-tab--active .mdc-tab__icon{color:#6200ee;color:var(--mdc-theme-primary, #6200ee);fill:currentColor}.mdc-tab{background:none}.mdc-tab{min-width:90px;padding-right:24px;padding-left:24px;display:flex;flex:1 0 auto;justify-content:center;box-sizing:border-box;margin:0;padding-top:0;padding-bottom:0;border:none;outline:none;text-align:center;white-space:nowrap;cursor:pointer;-webkit-appearance:none;z-index:1}.mdc-tab::-moz-focus-inner{padding:0;border:0}.mdc-tab--min-width{flex:0 1 auto}.mdc-tab__content{display:flex;align-items:center;justify-content:center;height:inherit;pointer-events:none}.mdc-tab__text-label{transition:150ms color linear;display:inline-block;line-height:1;z-index:2}.mdc-tab__icon{transition:150ms color linear;z-index:2}.mdc-tab--stacked .mdc-tab__content{flex-direction:column;align-items:center;justify-content:center}.mdc-tab--stacked .mdc-tab__text-label{padding-top:6px;padding-bottom:4px}.mdc-tab--active .mdc-tab__text-label,.mdc-tab--active .mdc-tab__icon{transition-delay:100ms}.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label{padding-left:8px;padding-right:0}[dir=rtl] .mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label,.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label[dir=rtl]{padding-left:0;padding-right:8px}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}.mdc-tab{--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-tab .mdc-tab__ripple::before,.mdc-tab .mdc-tab__ripple::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-tab .mdc-tab__ripple::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1;z-index:var(--mdc-ripple-z-index, 1)}.mdc-tab .mdc-tab__ripple::after{z-index:0;z-index:var(--mdc-ripple-z-index, 0)}.mdc-tab.mdc-ripple-upgraded .mdc-tab__ripple::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-tab.mdc-ripple-upgraded .mdc-tab__ripple::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-tab.mdc-ripple-upgraded--unbounded .mdc-tab__ripple::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-tab.mdc-ripple-upgraded--foreground-activation .mdc-tab__ripple::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-tab.mdc-ripple-upgraded--foreground-deactivation .mdc-tab__ripple::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-tab .mdc-tab__ripple::before,.mdc-tab .mdc-tab__ripple::after{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-tab.mdc-ripple-upgraded .mdc-tab__ripple::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-tab .mdc-tab__ripple::before,.mdc-tab .mdc-tab__ripple::after{background-color:#6200ee;background-color:var(--mdc-ripple-color, var(--mdc-theme-primary, #6200ee))}.mdc-tab:hover .mdc-tab__ripple::before,.mdc-tab.mdc-ripple-surface--hover .mdc-tab__ripple::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-tab.mdc-ripple-upgraded--background-focused .mdc-tab__ripple::before,.mdc-tab:not(.mdc-ripple-upgraded):focus .mdc-tab__ripple::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-tab:not(.mdc-ripple-upgraded) .mdc-tab__ripple::after{transition:opacity 150ms linear}.mdc-tab:not(.mdc-ripple-upgraded):active .mdc-tab__ripple::after{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-tab.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-tab__ripple{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;will-change:transform,opacity}:host{outline:none;flex:1 0 auto;display:flex;justify-content:center;-webkit-tap-highlight-color:transparent}.mdc-tab{height:var(--mdc-tab-height, 48px);margin-left:0;margin-right:0;padding-right:var(--mdc-tab-horizontal-padding, 24px);padding-left:var(--mdc-tab-horizontal-padding, 24px)}.mdc-tab--stacked{height:var(--mdc-tab-stacked-height, 72px)}.mdc-tab::-moz-focus-inner{border:0}.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label{padding-left:8px;padding-right:0}[dir=rtl] .mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label,.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label[dir=rtl]{padding-left:0;padding-right:8px}.mdc-tab:not(.mdc-tab--active) .mdc-tab__text-label{color:var(--mdc-tab-text-label-color-default, rgba(0, 0, 0, 0.6))}.mdc-tab:not(.mdc-tab--active) .mdc-tab__icon{color:var(--mdc-tab-color-default, rgba(0, 0, 0, 0.54))}`;let _e=class extends fe{};_e.styles=[ge],_e=it([at("mwc-tab")],_e);var ve={ANIMATING:"mdc-tab-scroller--animating",SCROLL_AREA_SCROLL:"mdc-tab-scroller__scroll-area--scroll",SCROLL_TEST:"mdc-tab-scroller__test"},ye={AREA_SELECTOR:".mdc-tab-scroller__scroll-area",CONTENT_SELECTOR:".mdc-tab-scroller__scroll-content"},be=function(t){this.adapter=t},xe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tt(e,t),e.prototype.getScrollPositionRTL=function(){var t=this.adapter.getScrollAreaScrollLeft(),e=this.calculateScrollEdges().right;return Math.round(e-t)},e.prototype.scrollToRTL=function(t){var e=this.calculateScrollEdges(),i=this.adapter.getScrollAreaScrollLeft(),r=this.clampScrollValue(e.right-t);return{finalScrollPosition:r,scrollDelta:r-i}},e.prototype.incrementScrollRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft(),i=this.clampScrollValue(e-t);return{finalScrollPosition:i,scrollDelta:i-e}},e.prototype.getAnimatingScrollPosition=function(t){return t},e.prototype.calculateScrollEdges=function(){return{left:0,right:this.adapter.getScrollContentOffsetWidth()-this.adapter.getScrollAreaOffsetWidth()}},e.prototype.clampScrollValue=function(t){var e=this.calculateScrollEdges();return Math.min(Math.max(e.left,t),e.right)},e}(be),we=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tt(e,t),e.prototype.getScrollPositionRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft();return Math.round(t-e)},e.prototype.scrollToRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft(),i=this.clampScrollValue(-t);return{finalScrollPosition:i,scrollDelta:i-e}},e.prototype.incrementScrollRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft(),i=this.clampScrollValue(e-t);return{finalScrollPosition:i,scrollDelta:i-e}},e.prototype.getAnimatingScrollPosition=function(t,e){return t-e},e.prototype.calculateScrollEdges=function(){var t=this.adapter.getScrollContentOffsetWidth();return{left:this.adapter.getScrollAreaOffsetWidth()-t,right:0}},e.prototype.clampScrollValue=function(t){var e=this.calculateScrollEdges();return Math.max(Math.min(e.right,t),e.left)},e}(be),ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tt(e,t),e.prototype.getScrollPositionRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft();return Math.round(e-t)},e.prototype.scrollToRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft(),i=this.clampScrollValue(t);return{finalScrollPosition:i,scrollDelta:e-i}},e.prototype.incrementScrollRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft(),i=this.clampScrollValue(e+t);return{finalScrollPosition:i,scrollDelta:e-i}},e.prototype.getAnimatingScrollPosition=function(t,e){return t+e},e.prototype.calculateScrollEdges=function(){return{left:this.adapter.getScrollContentOffsetWidth()-this.adapter.getScrollAreaOffsetWidth(),right:0}},e.prototype.clampScrollValue=function(t){var e=this.calculateScrollEdges();return Math.min(Math.max(e.right,t),e.left)},e}(be),Te=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.isAnimating=!1,r}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return ve},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return ye},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{eventTargetMatchesSelector:function(){return!1},addClass:function(){},removeClass:function(){},addScrollAreaClass:function(){},setScrollAreaStyleProperty:function(){},setScrollContentStyleProperty:function(){},getScrollContentStyleValue:function(){return""},setScrollAreaScrollLeft:function(){},getScrollAreaScrollLeft:function(){return 0},getScrollContentOffsetWidth:function(){return 0},getScrollAreaOffsetWidth:function(){return 0},computeScrollAreaClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},computeScrollContentClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},computeHorizontalScrollbarHeight:function(){return 0}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this.adapter.computeHorizontalScrollbarHeight();this.adapter.setScrollAreaStyleProperty("margin-bottom",-t+"px"),this.adapter.addScrollAreaClass(e.cssClasses.SCROLL_AREA_SCROLL)},e.prototype.getScrollPosition=function(){if(this.isRTL())return this.computeCurrentScrollPositionRTL();var t=this.calculateCurrentTranslateX();return this.adapter.getScrollAreaScrollLeft()-t},e.prototype.handleInteraction=function(){this.isAnimating&&this.stopScrollAnimation()},e.prototype.handleTransitionEnd=function(t){var i=t.target;this.isAnimating&&this.adapter.eventTargetMatchesSelector(i,e.strings.CONTENT_SELECTOR)&&(this.isAnimating=!1,this.adapter.removeClass(e.cssClasses.ANIMATING))},e.prototype.incrementScroll=function(t){0!==t&&this.animate(this.getIncrementScrollOperation(t))},e.prototype.incrementScrollImmediate=function(t){if(0!==t){var e=this.getIncrementScrollOperation(t);0!==e.scrollDelta&&(this.stopScrollAnimation(),this.adapter.setScrollAreaScrollLeft(e.finalScrollPosition))}},e.prototype.scrollTo=function(t){this.isRTL()?this.scrollToImplRTL(t):this.scrollToImpl(t)},e.prototype.getRTLScroller=function(){return this.rtlScrollerInstance||(this.rtlScrollerInstance=this.rtlScrollerFactory()),this.rtlScrollerInstance},e.prototype.calculateCurrentTranslateX=function(){var t=this.adapter.getScrollContentStyleValue("transform");if("none"===t)return 0;var e=/\((.+?)\)/.exec(t);if(!e)return 0;var i=nt(e[1].split(","),6);i[0],i[1],i[2],i[3];var r=i[4];return i[5],parseFloat(r)},e.prototype.clampScrollValue=function(t){var e=this.calculateScrollEdges();return Math.min(Math.max(e.left,t),e.right)},e.prototype.computeCurrentScrollPositionRTL=function(){var t=this.calculateCurrentTranslateX();return this.getRTLScroller().getScrollPositionRTL(t)},e.prototype.calculateScrollEdges=function(){return{left:0,right:this.adapter.getScrollContentOffsetWidth()-this.adapter.getScrollAreaOffsetWidth()}},e.prototype.scrollToImpl=function(t){var e=this.getScrollPosition(),i=this.clampScrollValue(t),r=i-e;this.animate({finalScrollPosition:i,scrollDelta:r})},e.prototype.scrollToImplRTL=function(t){var e=this.getRTLScroller().scrollToRTL(t);this.animate(e)},e.prototype.getIncrementScrollOperation=function(t){if(this.isRTL())return this.getRTLScroller().incrementScrollRTL(t);var e=this.getScrollPosition(),i=t+e,r=this.clampScrollValue(i);return{finalScrollPosition:r,scrollDelta:r-e}},e.prototype.animate=function(t){var i=this;0!==t.scrollDelta&&(this.stopScrollAnimation(),this.adapter.setScrollAreaScrollLeft(t.finalScrollPosition),this.adapter.setScrollContentStyleProperty("transform","translateX("+t.scrollDelta+"px)"),this.adapter.computeScrollAreaClientRect(),requestAnimationFrame((function(){i.adapter.addClass(e.cssClasses.ANIMATING),i.adapter.setScrollContentStyleProperty("transform","none")})),this.isAnimating=!0)},e.prototype.stopScrollAnimation=function(){this.isAnimating=!1;var t=this.getAnimatingScrollPosition();this.adapter.removeClass(e.cssClasses.ANIMATING),this.adapter.setScrollContentStyleProperty("transform","translateX(0px)"),this.adapter.setScrollAreaScrollLeft(t)},e.prototype.getAnimatingScrollPosition=function(){var t=this.calculateCurrentTranslateX(),e=this.adapter.getScrollAreaScrollLeft();return this.isRTL()?this.getRTLScroller().getAnimatingScrollPosition(e,t):e-t},e.prototype.rtlScrollerFactory=function(){var t=this.adapter.getScrollAreaScrollLeft();this.adapter.setScrollAreaScrollLeft(t-1);var e=this.adapter.getScrollAreaScrollLeft();if(e<0)return this.adapter.setScrollAreaScrollLeft(t),new we(this.adapter);var i=this.adapter.computeScrollAreaClientRect(),r=this.adapter.computeScrollContentClientRect(),n=Math.round(r.right-i.right);return this.adapter.setScrollAreaScrollLeft(t),n===e?new ke(this.adapter):new xe(this.adapter)},e.prototype.isRTL=function(){return"rtl"===this.adapter.getScrollContentStyleValue("direction")},e}(vt),Se=Te;class Ce extends It{constructor(){super(...arguments),this.mdcFoundationClass=Se,this._scrollbarHeight=-1}_handleInteraction(){this.mdcFoundation.handleInteraction()}_handleTransitionEnd(t){this.mdcFoundation.handleTransitionEnd(t)}render(){return M`
      <div class="mdc-tab-scroller">
        <div class="mdc-tab-scroller__scroll-area"
            @wheel="${this._handleInteraction}"
            @touchstart="${this._handleInteraction}"
            @pointerdown="${this._handleInteraction}"
            @mousedown="${this._handleInteraction}"
            @keydown="${this._handleInteraction}"
            @transitionend="${this._handleTransitionEnd}">
          <div class="mdc-tab-scroller__scroll-content"><slot></slot></div>
        </div>
      </div>
      `}createAdapter(){return Object.assign(Object.assign({},kt(this.mdcRoot)),{eventTargetMatchesSelector:(t,e)=>Kt(t,e),addScrollAreaClass:t=>this.scrollAreaElement.classList.add(t),setScrollAreaStyleProperty:(t,e)=>this.scrollAreaElement.style.setProperty(t,e),setScrollContentStyleProperty:(t,e)=>this.scrollContentElement.style.setProperty(t,e),getScrollContentStyleValue:t=>window.getComputedStyle(this.scrollContentElement).getPropertyValue(t),setScrollAreaScrollLeft:t=>this.scrollAreaElement.scrollLeft=t,getScrollAreaScrollLeft:()=>this.scrollAreaElement.scrollLeft,getScrollContentOffsetWidth:()=>this.scrollContentElement.offsetWidth,getScrollAreaOffsetWidth:()=>this.scrollAreaElement.offsetWidth,computeScrollAreaClientRect:()=>this.scrollAreaElement.getBoundingClientRect(),computeScrollContentClientRect:()=>this.scrollContentElement.getBoundingClientRect(),computeHorizontalScrollbarHeight:()=>(-1===this._scrollbarHeight&&(this.scrollAreaElement.style.overflowX="scroll",this._scrollbarHeight=this.scrollAreaElement.offsetHeight-this.scrollAreaElement.clientHeight,this.scrollAreaElement.style.overflowX=""),this._scrollbarHeight)})}getScrollPosition(){return this.mdcFoundation.getScrollPosition()}getScrollContentWidth(){return this.scrollContentElement.offsetWidth}incrementScrollPosition(t){this.mdcFoundation.incrementScroll(t)}scrollToPosition(t){this.mdcFoundation.scrollTo(t)}}it([ht(".mdc-tab-scroller")],Ce.prototype,"mdcRoot",void 0),it([ht(".mdc-tab-scroller__scroll-area")],Ce.prototype,"scrollAreaElement",void 0),it([ht(".mdc-tab-scroller__scroll-content")],Ce.prototype,"scrollContentElement",void 0),it([dt({passive:!0})],Ce.prototype,"_handleInteraction",null);const Ee=n`.mdc-tab-scroller{overflow-y:hidden}.mdc-tab-scroller.mdc-tab-scroller--animating .mdc-tab-scroller__scroll-content{transition:250ms transform cubic-bezier(0.4, 0, 0.2, 1)}.mdc-tab-scroller__test{position:absolute;top:-9999px;width:100px;height:100px;overflow-x:scroll}.mdc-tab-scroller__scroll-area{-webkit-overflow-scrolling:touch;display:flex;overflow-x:hidden}.mdc-tab-scroller__scroll-area::-webkit-scrollbar,.mdc-tab-scroller__test::-webkit-scrollbar{display:none}.mdc-tab-scroller__scroll-area--scroll{overflow-x:scroll}.mdc-tab-scroller__scroll-content{position:relative;display:flex;flex:1 0 auto;transform:none;will-change:transform}.mdc-tab-scroller--align-start .mdc-tab-scroller__scroll-content{justify-content:flex-start}.mdc-tab-scroller--align-end .mdc-tab-scroller__scroll-content{justify-content:flex-end}.mdc-tab-scroller--align-center .mdc-tab-scroller__scroll-content{justify-content:center}.mdc-tab-scroller--animating .mdc-tab-scroller__scroll-area{-webkit-overflow-scrolling:auto}:host{display:flex}.mdc-tab-scroller{flex:1}`;let $e=class extends Ce{};$e.styles=[Ee],$e=it([at("mwc-tab-scroller")],$e);var Ae={ARROW_LEFT_KEY:"ArrowLeft",ARROW_RIGHT_KEY:"ArrowRight",END_KEY:"End",ENTER_KEY:"Enter",HOME_KEY:"Home",SPACE_KEY:"Space",TAB_ACTIVATED_EVENT:"MDCTabBar:activated",TAB_SCROLLER_SELECTOR:".mdc-tab-scroller",TAB_SELECTOR:".mdc-tab"},Ie={ARROW_LEFT_KEYCODE:37,ARROW_RIGHT_KEYCODE:39,END_KEYCODE:35,ENTER_KEYCODE:13,EXTRA_SCROLL_AMOUNT:20,HOME_KEYCODE:36,SPACE_KEYCODE:32},Me=new Set;Me.add(Ae.ARROW_LEFT_KEY),Me.add(Ae.ARROW_RIGHT_KEY),Me.add(Ae.END_KEY),Me.add(Ae.HOME_KEY),Me.add(Ae.ENTER_KEY),Me.add(Ae.SPACE_KEY);var Le=new Map;Le.set(Ie.ARROW_LEFT_KEYCODE,Ae.ARROW_LEFT_KEY),Le.set(Ie.ARROW_RIGHT_KEYCODE,Ae.ARROW_RIGHT_KEY),Le.set(Ie.END_KEYCODE,Ae.END_KEY),Le.set(Ie.HOME_KEYCODE,Ae.HOME_KEY),Le.set(Ie.ENTER_KEYCODE,Ae.ENTER_KEY),Le.set(Ie.SPACE_KEYCODE,Ae.SPACE_KEY);var Pe=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.useAutomaticActivation=!1,r}return tt(e,t),Object.defineProperty(e,"strings",{get:function(){return Ae},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Ie},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{scrollTo:function(){},incrementScroll:function(){},getScrollPosition:function(){return 0},getScrollContentWidth:function(){return 0},getOffsetWidth:function(){return 0},isRTL:function(){return!1},setActiveTab:function(){},activateTabAtIndex:function(){},deactivateTabAtIndex:function(){},focusTabAtIndex:function(){},getTabIndicatorClientRectAtIndex:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getTabDimensionsAtIndex:function(){return{rootLeft:0,rootRight:0,contentLeft:0,contentRight:0}},getPreviousActiveTabIndex:function(){return-1},getFocusedTabIndex:function(){return-1},getIndexOfTabById:function(){return-1},getTabListLength:function(){return 0},notifyTabActivated:function(){}}},enumerable:!1,configurable:!0}),e.prototype.setUseAutomaticActivation=function(t){this.useAutomaticActivation=t},e.prototype.activateTab=function(t){var e,i=this.adapter.getPreviousActiveTabIndex();this.indexIsInRange(t)&&t!==i&&(-1!==i&&(this.adapter.deactivateTabAtIndex(i),e=this.adapter.getTabIndicatorClientRectAtIndex(i)),this.adapter.activateTabAtIndex(t,e),this.scrollIntoView(t),this.adapter.notifyTabActivated(t))},e.prototype.handleKeyDown=function(t){var e=this.getKeyFromEvent(t);if(void 0!==e)if(this.isActivationKey(e)||t.preventDefault(),this.useAutomaticActivation){if(this.isActivationKey(e))return;var i=this.determineTargetFromKey(this.adapter.getPreviousActiveTabIndex(),e);this.adapter.setActiveTab(i),this.scrollIntoView(i)}else{var r=this.adapter.getFocusedTabIndex();if(this.isActivationKey(e))this.adapter.setActiveTab(r);else{i=this.determineTargetFromKey(r,e);this.adapter.focusTabAtIndex(i),this.scrollIntoView(i)}}},e.prototype.handleTabInteraction=function(t){this.adapter.setActiveTab(this.adapter.getIndexOfTabById(t.detail.tabId))},e.prototype.scrollIntoView=function(t){this.indexIsInRange(t)&&(0!==t?t!==this.adapter.getTabListLength()-1?this.isRTL()?this.scrollIntoViewImplRTL(t):this.scrollIntoViewImpl(t):this.adapter.scrollTo(this.adapter.getScrollContentWidth()):this.adapter.scrollTo(0))},e.prototype.determineTargetFromKey=function(t,e){var i=this.isRTL(),r=this.adapter.getTabListLength()-1,n=t;return e===Ae.END_KEY?n=r:e===Ae.ARROW_LEFT_KEY&&!i||e===Ae.ARROW_RIGHT_KEY&&i?n-=1:e===Ae.ARROW_RIGHT_KEY&&!i||e===Ae.ARROW_LEFT_KEY&&i?n+=1:n=0,n<0?n=r:n>r&&(n=0),n},e.prototype.calculateScrollIncrement=function(t,e,i,r){var n=this.adapter.getTabDimensionsAtIndex(e),a=n.contentLeft-i-r,s=n.contentRight-i-Ie.EXTRA_SCROLL_AMOUNT,o=a+Ie.EXTRA_SCROLL_AMOUNT;return e<t?Math.min(s,0):Math.max(o,0)},e.prototype.calculateScrollIncrementRTL=function(t,e,i,r,n){var a=this.adapter.getTabDimensionsAtIndex(e),s=n-a.contentLeft-i,o=n-a.contentRight-i-r+Ie.EXTRA_SCROLL_AMOUNT,l=s-Ie.EXTRA_SCROLL_AMOUNT;return e>t?Math.max(o,0):Math.min(l,0)},e.prototype.findAdjacentTabIndexClosestToEdge=function(t,e,i,r){var n=e.rootLeft-i,a=e.rootRight-i-r,s=n+a;return n<0||s<0?t-1:a>0||s>0?t+1:-1},e.prototype.findAdjacentTabIndexClosestToEdgeRTL=function(t,e,i,r,n){var a=n-e.rootLeft-r-i,s=n-e.rootRight-i,o=a+s;return a>0||o>0?t+1:s<0||o<0?t-1:-1},e.prototype.getKeyFromEvent=function(t){return Me.has(t.key)?t.key:Le.get(t.keyCode)},e.prototype.isActivationKey=function(t){return t===Ae.SPACE_KEY||t===Ae.ENTER_KEY},e.prototype.indexIsInRange=function(t){return t>=0&&t<this.adapter.getTabListLength()},e.prototype.isRTL=function(){return this.adapter.isRTL()},e.prototype.scrollIntoViewImpl=function(t){var e=this.adapter.getScrollPosition(),i=this.adapter.getOffsetWidth(),r=this.adapter.getTabDimensionsAtIndex(t),n=this.findAdjacentTabIndexClosestToEdge(t,r,e,i);if(this.indexIsInRange(n)){var a=this.calculateScrollIncrement(t,n,e,i);this.adapter.incrementScroll(a)}},e.prototype.scrollIntoViewImplRTL=function(t){var e=this.adapter.getScrollPosition(),i=this.adapter.getOffsetWidth(),r=this.adapter.getTabDimensionsAtIndex(t),n=this.adapter.getScrollContentWidth(),a=this.findAdjacentTabIndexClosestToEdgeRTL(t,r,e,i,n);if(this.indexIsInRange(a)){var s=this.calculateScrollIncrementRTL(t,a,e,i,n);this.adapter.incrementScroll(s)}},e}(vt);class Re extends It{constructor(){super(...arguments),this.mdcFoundationClass=Pe,this.activeIndex=0,this._previousActiveIndex=-1}_handleTabInteraction(t){this.mdcFoundation.handleTabInteraction(t)}_handleKeydown(t){this.mdcFoundation.handleKeyDown(t)}render(){return M`
      <div class="mdc-tab-bar" role="tablist"
          @MDCTab:interacted="${this._handleTabInteraction}"
          @keydown="${this._handleKeydown}">
        <mwc-tab-scroller><slot></slot></mwc-tab-scroller>
      </div>
      `}_getTabs(){return this.tabsSlot.assignedNodes({flatten:!0}).filter((t=>t instanceof fe))}_getTab(t){return this._getTabs()[t]}createAdapter(){return{scrollTo:t=>this.scrollerElement.scrollToPosition(t),incrementScroll:t=>this.scrollerElement.incrementScrollPosition(t),getScrollPosition:()=>this.scrollerElement.getScrollPosition(),getScrollContentWidth:()=>this.scrollerElement.getScrollContentWidth(),getOffsetWidth:()=>this.mdcRoot.offsetWidth,isRTL:()=>"rtl"===window.getComputedStyle(this.mdcRoot).getPropertyValue("direction"),setActiveTab:t=>this.mdcFoundation.activateTab(t),activateTabAtIndex:(t,e)=>{const i=this._getTab(t);void 0!==i&&i.activate(e),this._previousActiveIndex=t},deactivateTabAtIndex:t=>{const e=this._getTab(t);void 0!==e&&e.deactivate()},focusTabAtIndex:t=>{const e=this._getTab(t);void 0!==e&&e.focus()},getTabIndicatorClientRectAtIndex:t=>{const e=this._getTab(t);return void 0!==e?e.computeIndicatorClientRect():new DOMRect},getTabDimensionsAtIndex:t=>{const e=this._getTab(t);return void 0!==e?e.computeDimensions():{rootLeft:0,rootRight:0,contentLeft:0,contentRight:0}},getPreviousActiveTabIndex:()=>this._previousActiveIndex,getFocusedTabIndex:()=>{const t=this._getTabs(),e=this.getRootNode().activeElement;return t.indexOf(e)},getIndexOfTabById:t=>{const e=this._getTabs();for(let i=0;i<e.length;i++)if(e[i].id===t)return i;return-1},getTabListLength:()=>this._getTabs().length,notifyTabActivated:t=>{this.activeIndex=t,this.dispatchEvent(new CustomEvent(Pe.strings.TAB_ACTIVATED_EVENT,{detail:{index:t},bubbles:!0,cancelable:!0}))}}}firstUpdated(){}async getUpdateComplete(){const t=await super.getUpdateComplete();return await this.scrollerElement.updateComplete,void 0===this.mdcFoundation&&this.createFoundation(),t}scrollIndexIntoView(t){this.mdcFoundation.scrollIntoView(t)}}it([ht(".mdc-tab-bar")],Re.prototype,"mdcRoot",void 0),it([ht("mwc-tab-scroller")],Re.prototype,"scrollerElement",void 0),it([ht("slot")],Re.prototype,"tabsSlot",void 0),it([Mt((async function(){await this.updateComplete,this.activeIndex!==this._previousActiveIndex&&this.mdcFoundation.activateTab(this.activeIndex)})),ot({type:Number})],Re.prototype,"activeIndex",void 0);const ze=n`.mdc-tab-bar{width:100%}.mdc-tab{height:48px}.mdc-tab--stacked{height:72px}:host{display:block}.mdc-tab-bar{flex:1}mwc-tab{--mdc-tab-height: 48px;--mdc-tab-stacked-height: 72px}`;let De=class extends Re{};De.styles=[ze],De=it([at("mwc-tab-bar")],De);var je={FIXED_CLASS:"mdc-top-app-bar--fixed",FIXED_SCROLLED_CLASS:"mdc-top-app-bar--fixed-scrolled",SHORT_CLASS:"mdc-top-app-bar--short",SHORT_COLLAPSED_CLASS:"mdc-top-app-bar--short-collapsed",SHORT_HAS_ACTION_ITEM_CLASS:"mdc-top-app-bar--short-has-action-item"},Oe={DEBOUNCE_THROTTLE_RESIZE_TIME_MS:100,MAX_TOP_APP_BAR_HEIGHT:128},Be={ACTION_ITEM_SELECTOR:".mdc-top-app-bar__action-item",NAVIGATION_EVENT:"MDCTopAppBar:nav",NAVIGATION_ICON_SELECTOR:".mdc-top-app-bar__navigation-icon",ROOT_SELECTOR:".mdc-top-app-bar",TITLE_SELECTOR:".mdc-top-app-bar__title"},Fe=function(t){function e(i){return t.call(this,et(et({},e.defaultAdapter),i))||this}return tt(e,t),Object.defineProperty(e,"strings",{get:function(){return Be},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return je},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Oe},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},getTopAppBarHeight:function(){return 0},notifyNavigationIconClicked:function(){},getViewportScrollY:function(){return 0},getTotalActionItems:function(){return 0}}},enumerable:!1,configurable:!0}),e.prototype.handleTargetScroll=function(){},e.prototype.handleWindowResize=function(){},e.prototype.handleNavigationClick=function(){this.adapter.notifyNavigationIconClicked()},e}(vt),Ne=function(t){function e(e){var i=t.call(this,e)||this;return i.wasDocked=!0,i.isDockedShowing=!0,i.currentAppBarOffsetTop=0,i.isCurrentlyBeingResized=!1,i.resizeThrottleId=0,i.resizeDebounceId=0,i.lastScrollPosition=i.adapter.getViewportScrollY(),i.topAppBarHeight=i.adapter.getTopAppBarHeight(),i}return tt(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.adapter.setStyle("top","")},e.prototype.handleTargetScroll=function(){var t=Math.max(this.adapter.getViewportScrollY(),0),e=t-this.lastScrollPosition;this.lastScrollPosition=t,this.isCurrentlyBeingResized||(this.currentAppBarOffsetTop-=e,this.currentAppBarOffsetTop>0?this.currentAppBarOffsetTop=0:Math.abs(this.currentAppBarOffsetTop)>this.topAppBarHeight&&(this.currentAppBarOffsetTop=-this.topAppBarHeight),this.moveTopAppBar())},e.prototype.handleWindowResize=function(){var t=this;this.resizeThrottleId||(this.resizeThrottleId=setTimeout((function(){t.resizeThrottleId=0,t.throttledResizeHandler()}),Oe.DEBOUNCE_THROTTLE_RESIZE_TIME_MS)),this.isCurrentlyBeingResized=!0,this.resizeDebounceId&&clearTimeout(this.resizeDebounceId),this.resizeDebounceId=setTimeout((function(){t.handleTargetScroll(),t.isCurrentlyBeingResized=!1,t.resizeDebounceId=0}),Oe.DEBOUNCE_THROTTLE_RESIZE_TIME_MS)},e.prototype.checkForUpdate=function(){var t=-this.topAppBarHeight,e=this.currentAppBarOffsetTop<0,i=this.currentAppBarOffsetTop>t,r=e&&i;if(r)this.wasDocked=!1;else{if(!this.wasDocked)return this.wasDocked=!0,!0;if(this.isDockedShowing!==i)return this.isDockedShowing=i,!0}return r},e.prototype.moveTopAppBar=function(){if(this.checkForUpdate()){var t=this.currentAppBarOffsetTop;Math.abs(t)>=this.topAppBarHeight&&(t=-Oe.MAX_TOP_APP_BAR_HEIGHT),this.adapter.setStyle("top",t+"px")}},e.prototype.throttledResizeHandler=function(){var t=this.adapter.getTopAppBarHeight();this.topAppBarHeight!==t&&(this.wasDocked=!1,this.currentAppBarOffsetTop-=this.topAppBarHeight-t,this.topAppBarHeight=t),this.handleTargetScroll()},e}(Fe),He=Ne;const Ve=Et?{passive:!0}:void 0;class Ue extends It{constructor(){super(...arguments),this.centerTitle=!1,this.handleTargetScroll=()=>{this.mdcFoundation.handleTargetScroll()},this.handleNavigationClick=()=>{this.mdcFoundation.handleNavigationClick()}}get scrollTarget(){return this._scrollTarget||window}set scrollTarget(t){this.unregisterScrollListener();const e=this.scrollTarget;this._scrollTarget=t,this.updateRootPosition(),this.requestUpdate("scrollTarget",e),this.registerScrollListener()}updateRootPosition(){if(this.mdcRoot){const t=this.scrollTarget===window;this.mdcRoot.style.position=t?"":"absolute"}}render(){let t=M`<span class="mdc-top-app-bar__title"><slot name="title"></slot></span>`;return this.centerTitle&&(t=M`<section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-center">${t}</section>`),M`
      <header class="mdc-top-app-bar ${Ot(this.barClasses())}">
      <div class="mdc-top-app-bar__row">
        <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start" id="navigation">
          <slot name="navigationIcon"
            @click=${this.handleNavigationClick}></slot>
          ${this.centerTitle?null:t}
        </section>
        ${this.centerTitle?t:null}
        <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end" id="actions" role="toolbar">
          <slot name="actionItems"></slot>
        </section>
      </div>
    </header>
    <div class="${Ot(this.contentClasses())}">
      <slot></slot>
    </div>
    `}createAdapter(){return Object.assign(Object.assign({},kt(this.mdcRoot)),{setStyle:(t,e)=>this.mdcRoot.style.setProperty(t,e),getTopAppBarHeight:()=>this.mdcRoot.clientHeight,notifyNavigationIconClicked:()=>{this.dispatchEvent(new Event(Be.NAVIGATION_EVENT,{bubbles:!0,cancelable:!0}))},getViewportScrollY:()=>this.scrollTarget instanceof Window?this.scrollTarget.pageYOffset:this.scrollTarget.scrollTop,getTotalActionItems:()=>this._actionItemsSlot.assignedNodes({flatten:!0}).length})}registerListeners(){this.registerScrollListener()}unregisterListeners(){this.unregisterScrollListener()}registerScrollListener(){this.scrollTarget.addEventListener("scroll",this.handleTargetScroll,Ve)}unregisterScrollListener(){this.scrollTarget.removeEventListener("scroll",this.handleTargetScroll)}firstUpdated(){super.firstUpdated(),this.updateRootPosition(),this.registerListeners()}disconnectedCallback(){super.disconnectedCallback(),this.unregisterListeners()}}it([ht(".mdc-top-app-bar")],Ue.prototype,"mdcRoot",void 0),it([ht('slot[name="actionItems"]')],Ue.prototype,"_actionItemsSlot",void 0),it([ot({type:Boolean})],Ue.prototype,"centerTitle",void 0),it([ot({type:Object})],Ue.prototype,"scrollTarget",null);class Ye extends Ue{constructor(){super(...arguments),this.mdcFoundationClass=He,this.prominent=!1,this.dense=!1,this.handleResize=()=>{this.mdcFoundation.handleWindowResize()}}barClasses(){return{"mdc-top-app-bar--dense":this.dense,"mdc-top-app-bar--prominent":this.prominent,"center-title":this.centerTitle}}contentClasses(){return{"mdc-top-app-bar--fixed-adjust":!this.dense&&!this.prominent,"mdc-top-app-bar--dense-fixed-adjust":this.dense&&!this.prominent,"mdc-top-app-bar--prominent-fixed-adjust":!this.dense&&this.prominent,"mdc-top-app-bar--dense-prominent-fixed-adjust":this.dense&&this.prominent}}registerListeners(){super.registerListeners(),window.addEventListener("resize",this.handleResize,Ve)}unregisterListeners(){super.unregisterListeners(),window.removeEventListener("resize",this.handleResize)}}it([ot({type:Boolean,reflect:!0})],Ye.prototype,"prominent",void 0),it([ot({type:Boolean,reflect:!0})],Ye.prototype,"dense",void 0);const Ze=n`.mdc-top-app-bar{background-color:#6200ee;background-color:var(--mdc-theme-primary, #6200ee);color:white;display:flex;position:fixed;flex-direction:column;justify-content:space-between;box-sizing:border-box;width:100%;z-index:4}.mdc-top-app-bar .mdc-top-app-bar__action-item,.mdc-top-app-bar .mdc-top-app-bar__navigation-icon{color:#fff;color:var(--mdc-theme-on-primary, #fff)}.mdc-top-app-bar .mdc-top-app-bar__action-item::before,.mdc-top-app-bar .mdc-top-app-bar__action-item::after,.mdc-top-app-bar .mdc-top-app-bar__navigation-icon::before,.mdc-top-app-bar .mdc-top-app-bar__navigation-icon::after{background-color:#fff;background-color:var(--mdc-ripple-color, var(--mdc-theme-on-primary, #fff))}.mdc-top-app-bar .mdc-top-app-bar__action-item:hover::before,.mdc-top-app-bar .mdc-top-app-bar__action-item.mdc-ripple-surface--hover::before,.mdc-top-app-bar .mdc-top-app-bar__navigation-icon:hover::before,.mdc-top-app-bar .mdc-top-app-bar__navigation-icon.mdc-ripple-surface--hover::before{opacity:0.08;opacity:var(--mdc-ripple-hover-opacity, 0.08)}.mdc-top-app-bar .mdc-top-app-bar__action-item.mdc-ripple-upgraded--background-focused::before,.mdc-top-app-bar .mdc-top-app-bar__action-item:not(.mdc-ripple-upgraded):focus::before,.mdc-top-app-bar .mdc-top-app-bar__navigation-icon.mdc-ripple-upgraded--background-focused::before,.mdc-top-app-bar .mdc-top-app-bar__navigation-icon:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:0.24;opacity:var(--mdc-ripple-focus-opacity, 0.24)}.mdc-top-app-bar .mdc-top-app-bar__action-item:not(.mdc-ripple-upgraded)::after,.mdc-top-app-bar .mdc-top-app-bar__navigation-icon:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-top-app-bar .mdc-top-app-bar__action-item:not(.mdc-ripple-upgraded):active::after,.mdc-top-app-bar .mdc-top-app-bar__navigation-icon:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:0.24;opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-top-app-bar .mdc-top-app-bar__action-item.mdc-ripple-upgraded,.mdc-top-app-bar .mdc-top-app-bar__navigation-icon.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-top-app-bar__row{display:flex;position:relative;box-sizing:border-box;width:100%;height:64px}.mdc-top-app-bar__section{display:inline-flex;flex:1 1 auto;align-items:center;min-width:0;padding:8px 12px;z-index:1}.mdc-top-app-bar__section--align-start{justify-content:flex-start;order:-1}.mdc-top-app-bar__section--align-end{justify-content:flex-end;order:1}.mdc-top-app-bar__title{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-headline6-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1.25rem;font-size:var(--mdc-typography-headline6-font-size, 1.25rem);line-height:2rem;line-height:var(--mdc-typography-headline6-line-height, 2rem);font-weight:500;font-weight:var(--mdc-typography-headline6-font-weight, 500);letter-spacing:0.0125em;letter-spacing:var(--mdc-typography-headline6-letter-spacing, 0.0125em);text-decoration:inherit;text-decoration:var(--mdc-typography-headline6-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-headline6-text-transform, inherit);padding-left:20px;padding-right:0;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;z-index:1}[dir=rtl] .mdc-top-app-bar__title,.mdc-top-app-bar__title[dir=rtl]{padding-left:0;padding-right:20px}.mdc-top-app-bar--short-collapsed{border-top-left-radius:0;border-top-right-radius:0;border-bottom-right-radius:24px;border-bottom-left-radius:0}[dir=rtl] .mdc-top-app-bar--short-collapsed,.mdc-top-app-bar--short-collapsed[dir=rtl]{border-top-left-radius:0;border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:24px}.mdc-top-app-bar--short{top:0;right:auto;left:0;width:100%;transition:width 250ms cubic-bezier(0.4, 0, 0.2, 1)}[dir=rtl] .mdc-top-app-bar--short,.mdc-top-app-bar--short[dir=rtl]{right:0;left:auto}.mdc-top-app-bar--short .mdc-top-app-bar__row{height:56px}.mdc-top-app-bar--short .mdc-top-app-bar__section{padding:4px}.mdc-top-app-bar--short .mdc-top-app-bar__title{transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1);opacity:1}.mdc-top-app-bar--short-collapsed{box-shadow:0px 2px 4px -1px rgba(0, 0, 0, 0.2),0px 4px 5px 0px rgba(0, 0, 0, 0.14),0px 1px 10px 0px rgba(0,0,0,.12);width:56px;transition:width 300ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-top-app-bar--short-collapsed .mdc-top-app-bar__title{display:none}.mdc-top-app-bar--short-collapsed .mdc-top-app-bar__action-item{transition:padding 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-top-app-bar--short-collapsed.mdc-top-app-bar--short-has-action-item{width:112px}.mdc-top-app-bar--short-collapsed.mdc-top-app-bar--short-has-action-item .mdc-top-app-bar__section--align-end{padding-left:0;padding-right:12px}[dir=rtl] .mdc-top-app-bar--short-collapsed.mdc-top-app-bar--short-has-action-item .mdc-top-app-bar__section--align-end,.mdc-top-app-bar--short-collapsed.mdc-top-app-bar--short-has-action-item .mdc-top-app-bar__section--align-end[dir=rtl]{padding-left:12px;padding-right:0}.mdc-top-app-bar--dense .mdc-top-app-bar__row{height:48px}.mdc-top-app-bar--dense .mdc-top-app-bar__section{padding:0 4px}.mdc-top-app-bar--dense .mdc-top-app-bar__title{padding-left:12px;padding-right:0}[dir=rtl] .mdc-top-app-bar--dense .mdc-top-app-bar__title,.mdc-top-app-bar--dense .mdc-top-app-bar__title[dir=rtl]{padding-left:0;padding-right:12px}.mdc-top-app-bar--prominent .mdc-top-app-bar__row{height:128px}.mdc-top-app-bar--prominent .mdc-top-app-bar__title{align-self:flex-end;padding-bottom:2px}.mdc-top-app-bar--prominent .mdc-top-app-bar__action-item,.mdc-top-app-bar--prominent .mdc-top-app-bar__navigation-icon{align-self:flex-start}.mdc-top-app-bar--fixed{transition:box-shadow 200ms linear}.mdc-top-app-bar--fixed-scrolled{box-shadow:0px 2px 4px -1px rgba(0, 0, 0, 0.2),0px 4px 5px 0px rgba(0, 0, 0, 0.14),0px 1px 10px 0px rgba(0,0,0,.12);transition:box-shadow 200ms linear}.mdc-top-app-bar--dense.mdc-top-app-bar--prominent .mdc-top-app-bar__row{height:96px}.mdc-top-app-bar--dense.mdc-top-app-bar--prominent .mdc-top-app-bar__section{padding:0 12px}.mdc-top-app-bar--dense.mdc-top-app-bar--prominent .mdc-top-app-bar__title{padding-left:20px;padding-right:0;padding-bottom:9px}[dir=rtl] .mdc-top-app-bar--dense.mdc-top-app-bar--prominent .mdc-top-app-bar__title,.mdc-top-app-bar--dense.mdc-top-app-bar--prominent .mdc-top-app-bar__title[dir=rtl]{padding-left:0;padding-right:20px}.mdc-top-app-bar--fixed-adjust{padding-top:64px}.mdc-top-app-bar--dense-fixed-adjust{padding-top:48px}.mdc-top-app-bar--short-fixed-adjust{padding-top:56px}.mdc-top-app-bar--prominent-fixed-adjust{padding-top:128px}.mdc-top-app-bar--dense-prominent-fixed-adjust{padding-top:96px}@media(max-width: 599px){.mdc-top-app-bar__row{height:56px}.mdc-top-app-bar__section{padding:4px}.mdc-top-app-bar--short{transition:width 200ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-top-app-bar--short-collapsed{transition:width 250ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-top-app-bar--short-collapsed .mdc-top-app-bar__section--align-end{padding-left:0;padding-right:12px}[dir=rtl] .mdc-top-app-bar--short-collapsed .mdc-top-app-bar__section--align-end,.mdc-top-app-bar--short-collapsed .mdc-top-app-bar__section--align-end[dir=rtl]{padding-left:12px;padding-right:0}.mdc-top-app-bar--prominent .mdc-top-app-bar__title{padding-bottom:6px}.mdc-top-app-bar--fixed-adjust{padding-top:56px}}:host{display:block}.mdc-top-app-bar{color:#fff;color:var(--mdc-theme-on-primary, #fff);width:100%;width:var(--mdc-top-app-bar-width, 100%)}.mdc-top-app-bar--prominent #navigation ::slotted(*),.mdc-top-app-bar--prominent #actions ::slotted(*){align-self:flex-start}#navigation ::slotted(*),#actions ::slotted(*){--mdc-icon-button-ripple-opacity: 0.24}.mdc-top-app-bar--short-collapsed #actions ::slotted(*){transition:padding 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-top-app-bar__section--align-center{justify-content:center}.mdc-top-app-bar__section--align-center .mdc-top-app-bar__title{padding-left:0;padding-right:0}.center-title .mdc-top-app-bar__section--align-start,.center-title .mdc-top-app-bar__section--align-end{flex-basis:0}.mdc-top-app-bar--dense.mdc-top-app-bar--prominent .mdc-top-app-bar__section--align-center .mdc-top-app-bar__title{padding-left:0;padding-right:0}.mdc-top-app-bar--fixed-scrolled{box-shadow:var(--mdc-top-app-bar-fixed-box-shadow, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}`;let qe=class extends Ye{};qe.styles=[Ze],qe=it([at("mwc-top-app-bar")],qe);const We=n`:host{font-family:var(--mdc-icon-font, "Material Icons");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}`;let Ge=class extends K{render(){return M`<span><slot></slot></span>`}};function Xe(t,e,i){if(void 0!==e)return function(t,e,i){const r=t.constructor;if(!i){const t=`__${e}`;if(!(i=r.getPropertyDescriptor(e,t)))throw new Error("@ariaProperty must be used after a @property decorator")}const n=i;let a="";if(!n.set)throw new Error(`@ariaProperty requires a setter for ${e}`);if(t.dispatchWizEvent)return i;const s={configurable:!0,enumerable:!0,set(t){if(""===a){const t=r.getPropertyOptions(e);a="string"==typeof t.attribute?t.attribute:e}this.hasAttribute(a)&&this.removeAttribute(a),n.set.call(this,t)}};return n.get&&(s.get=function(){return n.get.call(this)}),s}(t,e,i);throw new Error("@ariaProperty only supports TypeScript Decorators")}Ge.styles=[We],Ge=it([at("mwc-icon")],Ge);const Ke=t=>null!=t?t:R;class Je extends K{constructor(){super(...arguments),this.raised=!1,this.unelevated=!1,this.outlined=!1,this.dense=!1,this.disabled=!1,this.trailingIcon=!1,this.fullwidth=!1,this.icon="",this.label="",this.expandContent=!1,this.shouldRenderRipple=!1,this.rippleHandlers=new de((()=>(this.shouldRenderRipple=!0,this.ripple)))}renderOverlay(){return M``}renderRipple(){const t=this.raised||this.unelevated;return this.shouldRenderRipple?M`<mwc-ripple class="ripple" .primary="${!t}" .disabled="${this.disabled}"></mwc-ripple>`:""}focus(){const t=this.buttonElement;t&&(this.rippleHandlers.startFocus(),t.focus())}blur(){const t=this.buttonElement;t&&(this.rippleHandlers.endFocus(),t.blur())}getRenderClasses(){return{"mdc-button--raised":this.raised,"mdc-button--unelevated":this.unelevated,"mdc-button--outlined":this.outlined,"mdc-button--dense":this.dense}}render(){return M`
      <button
          id="button"
          class="mdc-button ${Ot(this.getRenderClasses())}"
          ?disabled="${this.disabled}"
          aria-label="${this.label||this.icon}"
          aria-haspopup="${Ke(this.ariaHasPopup)}"
          @focus="${this.handleRippleFocus}"
          @blur="${this.handleRippleBlur}"
          @mousedown="${this.handleRippleActivate}"
          @mouseenter="${this.handleRippleMouseEnter}"
          @mouseleave="${this.handleRippleMouseLeave}"
          @touchstart="${this.handleRippleActivate}"
          @touchend="${this.handleRippleDeactivate}"
          @touchcancel="${this.handleRippleDeactivate}">
        ${this.renderOverlay()}
        ${this.renderRipple()}
        <span class="leading-icon">
          <slot name="icon">
            ${this.icon&&!this.trailingIcon?this.renderIcon():""}
          </slot>
        </span>
        <span class="mdc-button__label">${this.label}</span>
        <span class="slot-container ${Ot({flex:this.expandContent})}">
          <slot></slot>
        </span>
        <span class="trailing-icon">
          <slot name="trailingIcon">
            ${this.icon&&this.trailingIcon?this.renderIcon():""}
          </slot>
        </span>
      </button>`}renderIcon(){return M`
    <mwc-icon class="mdc-button__icon">
      ${this.icon}
    </mwc-icon>`}handleRippleActivate(t){const e=()=>{window.removeEventListener("mouseup",e),this.handleRippleDeactivate()};window.addEventListener("mouseup",e),this.rippleHandlers.startPress(t)}handleRippleDeactivate(){this.rippleHandlers.endPress()}handleRippleMouseEnter(){this.rippleHandlers.startHover()}handleRippleMouseLeave(){this.rippleHandlers.endHover()}handleRippleFocus(){this.rippleHandlers.startFocus()}handleRippleBlur(){this.rippleHandlers.endFocus()}}Je.shadowRootOptions={mode:"open",delegatesFocus:!0},it([Xe,ot({type:String,attribute:"aria-haspopup"})],Je.prototype,"ariaHasPopup",void 0),it([ot({type:Boolean,reflect:!0})],Je.prototype,"raised",void 0),it([ot({type:Boolean,reflect:!0})],Je.prototype,"unelevated",void 0),it([ot({type:Boolean,reflect:!0})],Je.prototype,"outlined",void 0),it([ot({type:Boolean})],Je.prototype,"dense",void 0),it([ot({type:Boolean,reflect:!0})],Je.prototype,"disabled",void 0),it([ot({type:Boolean,attribute:"trailingicon"})],Je.prototype,"trailingIcon",void 0),it([ot({type:Boolean,reflect:!0})],Je.prototype,"fullwidth",void 0),it([ot({type:String})],Je.prototype,"icon",void 0),it([ot({type:String})],Je.prototype,"label",void 0),it([ot({type:Boolean})],Je.prototype,"expandContent",void 0),it([ht("#button")],Je.prototype,"buttonElement",void 0),it([pt("mwc-ripple")],Je.prototype,"ripple",void 0),it([lt()],Je.prototype,"shouldRenderRipple",void 0),it([dt({passive:!0})],Je.prototype,"handleRippleActivate",null);const Qe=n`.mdc-button{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-button-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-button-font-size, 0.875rem);line-height:2.25rem;line-height:var(--mdc-typography-button-line-height, 2.25rem);font-weight:500;font-weight:var(--mdc-typography-button-font-weight, 500);letter-spacing:0.0892857143em;letter-spacing:var(--mdc-typography-button-letter-spacing, 0.0892857143em);text-decoration:none;text-decoration:var(--mdc-typography-button-text-decoration, none);text-transform:uppercase;text-transform:var(--mdc-typography-button-text-transform, uppercase)}.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:0;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:#fff;background-color:var(--mdc-elevation-overlay-color, #fff)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:transparent}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{display:none}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{pointer-events:none;border:2px solid transparent;border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc( 100% + 4px );width:calc( 100% + 4px );display:block}}@media screen and (forced-colors: active)and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring::after,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring::after{content:"";border:2px solid transparent;border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}}@media screen and (forced-colors: active)and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring::after,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring::after{border-color:CanvasText}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:transparent}.mdc-button{height:36px;border-radius:4px;border-radius:var(--mdc-shape-small, 4px)}.mdc-button:not(:disabled){color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}.mdc-button:disabled{color:rgba(0, 0, 0, 0.38)}.mdc-button .mdc-button__icon{font-size:1.125rem;width:1.125rem;height:1.125rem}.mdc-button .mdc-button__ripple{border-radius:4px;border-radius:var(--mdc-shape-small, 4px)}.mdc-button--raised,.mdc-button--unelevated{height:36px;border-radius:4px;border-radius:var(--mdc-shape-small, 4px)}.mdc-button--raised:not(:disabled),.mdc-button--unelevated:not(:disabled){background-color:#6200ee;background-color:var(--mdc-theme-primary, #6200ee)}.mdc-button--raised:disabled,.mdc-button--unelevated:disabled{background-color:rgba(0, 0, 0, 0.12)}.mdc-button--raised:not(:disabled),.mdc-button--unelevated:not(:disabled){color:#fff;color:var(--mdc-theme-on-primary, #fff)}.mdc-button--raised:disabled,.mdc-button--unelevated:disabled{color:rgba(0, 0, 0, 0.38)}.mdc-button--raised .mdc-button__icon,.mdc-button--unelevated .mdc-button__icon{font-size:1.125rem;width:1.125rem;height:1.125rem}.mdc-button--raised .mdc-button__ripple,.mdc-button--unelevated .mdc-button__ripple{border-radius:4px;border-radius:var(--mdc-shape-small, 4px)}.mdc-button--outlined{height:36px;border-radius:4px;border-radius:var(--mdc-shape-small, 4px);padding:0 15px 0 15px;border-width:1px}.mdc-button--outlined:not(:disabled){color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}.mdc-button--outlined:disabled{color:rgba(0, 0, 0, 0.38)}.mdc-button--outlined .mdc-button__icon{font-size:1.125rem;width:1.125rem;height:1.125rem}.mdc-button--outlined .mdc-button__ripple{border-radius:4px;border-radius:var(--mdc-shape-small, 4px)}.mdc-button--outlined:not(:disabled){border-color:rgba(0, 0, 0, 0.12)}.mdc-button--outlined:disabled{border-color:rgba(0, 0, 0, 0.12)}.mdc-button--outlined.mdc-button--icon-trailing{padding:0 11px 0 15px}.mdc-button--outlined.mdc-button--icon-leading{padding:0 15px 0 11px}.mdc-button--outlined .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:1px}.mdc-button--outlined .mdc-button__touch{left:calc(-1 * 1px);width:calc(100% + 2 * 1px)}.mdc-button--raised{box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2),0px 2px 2px 0px rgba(0, 0, 0, 0.14),0px 1px 5px 0px rgba(0,0,0,.12);transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--raised:hover,.mdc-button--raised:focus{box-shadow:0px 2px 4px -1px rgba(0, 0, 0, 0.2),0px 4px 5px 0px rgba(0, 0, 0, 0.14),0px 1px 10px 0px rgba(0,0,0,.12)}.mdc-button--raised:active{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2),0px 8px 10px 1px rgba(0, 0, 0, 0.14),0px 3px 14px 2px rgba(0,0,0,.12)}.mdc-button--raised:disabled{box-shadow:0px 0px 0px 0px rgba(0, 0, 0, 0.2),0px 0px 0px 0px rgba(0, 0, 0, 0.14),0px 0px 0px 0px rgba(0,0,0,.12)}:host{display:inline-flex;outline:none;-webkit-tap-highlight-color:transparent;vertical-align:top}:host([fullwidth]){width:100%}:host([raised]),:host([unelevated]){--mdc-ripple-color:#fff;--mdc-ripple-focus-opacity:0.24;--mdc-ripple-hover-opacity:0.08;--mdc-ripple-press-opacity:0.24}.trailing-icon ::slotted(*),.trailing-icon .mdc-button__icon,.leading-icon ::slotted(*),.leading-icon .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .trailing-icon ::slotted(*),[dir=rtl] .trailing-icon .mdc-button__icon,[dir=rtl] .leading-icon ::slotted(*),[dir=rtl] .leading-icon .mdc-button__icon,.trailing-icon ::slotted(*[dir=rtl]),.trailing-icon .mdc-button__icon[dir=rtl],.leading-icon ::slotted(*[dir=rtl]),.leading-icon .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.trailing-icon ::slotted(*),.trailing-icon .mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .trailing-icon ::slotted(*),[dir=rtl] .trailing-icon .mdc-button__icon,.trailing-icon ::slotted(*[dir=rtl]),.trailing-icon .mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}.slot-container{display:inline-flex;align-items:center;justify-content:center}.slot-container.flex{flex:auto}.mdc-button{flex:auto;overflow:hidden;padding-left:8px;padding-left:var(--mdc-button-horizontal-padding, 8px);padding-right:8px;padding-right:var(--mdc-button-horizontal-padding, 8px)}.mdc-button--raised{box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12);box-shadow:var(--mdc-button-raised-box-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mdc-button--raised:focus{box-shadow:0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12);box-shadow:var(--mdc-button-raised-box-shadow-focus, var(--mdc-button-raised-box-shadow-hover, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12)))}.mdc-button--raised:hover{box-shadow:0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12);box-shadow:var(--mdc-button-raised-box-shadow-hover, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mdc-button--raised:active{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);box-shadow:var(--mdc-button-raised-box-shadow-active, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mdc-button--raised:disabled{box-shadow:0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12);box-shadow:var(--mdc-button-raised-box-shadow-disabled, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mdc-button--raised,.mdc-button--unelevated{padding-left:16px;padding-left:var(--mdc-button-horizontal-padding, 16px);padding-right:16px;padding-right:var(--mdc-button-horizontal-padding, 16px)}.mdc-button--outlined{border-width:1px;border-width:var(--mdc-button-outline-width, 1px);padding-left:calc(16px - 1px);padding-left:calc(var(--mdc-button-horizontal-padding, 16px) - var(--mdc-button-outline-width, 1px));padding-right:calc(16px - 1px);padding-right:calc(var(--mdc-button-horizontal-padding, 16px) - var(--mdc-button-outline-width, 1px))}.mdc-button--outlined:not(:disabled){border-color:rgba(0, 0, 0, 0.12);border-color:var(--mdc-button-outline-color, rgba(0, 0, 0, 0.12))}.mdc-button--outlined .ripple{top:calc(-1 * 1px);top:calc(-1 * var(--mdc-button-outline-width, 1px));left:calc(-1 * 1px);left:calc(-1 * var(--mdc-button-outline-width, 1px));right:initial;right:initial;border-width:1px;border-width:var(--mdc-button-outline-width, 1px);border-style:solid;border-color:transparent}[dir=rtl] .mdc-button--outlined .ripple,.mdc-button--outlined .ripple[dir=rtl]{left:initial;left:initial;right:calc(-1 * 1px);right:calc(-1 * var(--mdc-button-outline-width, 1px))}.mdc-button--dense{height:28px;margin-top:0;margin-bottom:0}.mdc-button--dense .mdc-button__touch{height:100%}:host([disabled]){pointer-events:none}:host([disabled]) .mdc-button{color:rgba(0, 0, 0, 0.38);color:var(--mdc-button-disabled-ink-color, rgba(0, 0, 0, 0.38))}:host([disabled]) .mdc-button--raised,:host([disabled]) .mdc-button--unelevated{background-color:rgba(0, 0, 0, 0.12);background-color:var(--mdc-button-disabled-fill-color, rgba(0, 0, 0, 0.12))}:host([disabled]) .mdc-button--outlined{border-color:rgba(0, 0, 0, 0.12);border-color:var(--mdc-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}`;let ti=class extends Je{};ti.styles=[Qe],ti=it([at("mwc-button")],ti);var ei={NOTCH_ELEMENT_SELECTOR:".mdc-notched-outline__notch"},ii={NOTCH_ELEMENT_PADDING:8},ri={NO_LABEL:"mdc-notched-outline--no-label",OUTLINE_NOTCHED:"mdc-notched-outline--notched",OUTLINE_UPGRADED:"mdc-notched-outline--upgraded"},ni=function(t){function e(i){return t.call(this,et(et({},e.defaultAdapter),i))||this}return tt(e,t),Object.defineProperty(e,"strings",{get:function(){return ei},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return ri},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return ii},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNotchWidthProperty:function(){},removeNotchWidthProperty:function(){}}},enumerable:!1,configurable:!0}),e.prototype.notch=function(t){var i=e.cssClasses.OUTLINE_NOTCHED;t>0&&(t+=ii.NOTCH_ELEMENT_PADDING),this.adapter.setNotchWidthProperty(t),this.adapter.addClass(i)},e.prototype.closeNotch=function(){var t=e.cssClasses.OUTLINE_NOTCHED;this.adapter.removeClass(t),this.adapter.removeNotchWidthProperty()},e}(vt);class ai extends It{constructor(){super(...arguments),this.mdcFoundationClass=ni,this.width=0,this.open=!1,this.lastOpen=this.open}createAdapter(){return{addClass:t=>this.mdcRoot.classList.add(t),removeClass:t=>this.mdcRoot.classList.remove(t),setNotchWidthProperty:t=>this.notchElement.style.setProperty("width",`${t}px`),removeNotchWidthProperty:()=>this.notchElement.style.removeProperty("width")}}openOrClose(t,e){this.mdcFoundation&&(t&&void 0!==e?this.mdcFoundation.notch(e):this.mdcFoundation.closeNotch())}render(){this.openOrClose(this.open,this.width);const t=Ot({"mdc-notched-outline--notched":this.open});return M`
      <span class="mdc-notched-outline ${t}">
        <span class="mdc-notched-outline__leading"></span>
        <span class="mdc-notched-outline__notch">
          <slot></slot>
        </span>
        <span class="mdc-notched-outline__trailing"></span>
      </span>`}}it([ht(".mdc-notched-outline")],ai.prototype,"mdcRoot",void 0),it([ot({type:Number})],ai.prototype,"width",void 0),it([ot({type:Boolean,reflect:!0})],ai.prototype,"open",void 0),it([ht(".mdc-notched-outline__notch")],ai.prototype,"notchElement",void 0);const si=n`.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(100% / 0.75)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}:host{display:block;position:absolute;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] :host,:host([dir=rtl]){text-align:right}::slotted(.mdc-floating-label){display:inline-block;position:relative;top:17px;bottom:auto;max-width:100%}::slotted(.mdc-floating-label--float-above){text-overflow:clip}.mdc-notched-outline--upgraded ::slotted(.mdc-floating-label--float-above){max-width:calc(100% / 0.75)}.mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-notched-outline .mdc-notched-outline__leading,.mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-shape-small, 4px)) * 2)}}.mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-color:var(--mdc-notched-outline-border-color, var(--mdc-theme-primary, #6200ee));border-width:1px;border-width:var(--mdc-notched-outline-stroke-width, 1px)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0;padding-top:var(--mdc-notched-outline-notch-offset, 0)}`;let oi=class extends ai{};var li,ci;oi.styles=[si],oi=it([at("mwc-notched-outline")],oi);const di=null!==(ci=null===(li=window.ShadyDOM)||void 0===li?void 0:li.inUse)&&void 0!==ci&&ci;class hi extends It{constructor(){super(...arguments),this.disabled=!1,this.containingForm=null,this.formDataListener=t=>{this.disabled||this.setFormData(t.formData)}}findFormElement(){if(!this.shadowRoot||di)return null;const t=this.getRootNode().querySelectorAll("form");for(const e of Array.from(t))if(e.contains(this))return e;return null}connectedCallback(){var t;super.connectedCallback(),this.containingForm=this.findFormElement(),null===(t=this.containingForm)||void 0===t||t.addEventListener("formdata",this.formDataListener)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this.containingForm)||void 0===t||t.removeEventListener("formdata",this.formDataListener),this.containingForm=null}click(){this.formElement&&!this.disabled&&(this.formElement.focus(),this.formElement.click())}firstUpdated(){super.firstUpdated(),this.shadowRoot&&this.mdcRoot.addEventListener("change",(t=>{this.dispatchEvent(new Event("change",t))}))}}hi.shadowRootOptions={mode:"open",delegatesFocus:!0},it([ot({type:Boolean})],hi.prototype,"disabled",void 0);var pi={LABEL_FLOAT_ABOVE:"mdc-floating-label--float-above",LABEL_REQUIRED:"mdc-floating-label--required",LABEL_SHAKE:"mdc-floating-label--shake",ROOT:"mdc-floating-label"},ui=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.shakeAnimationEndHandler=function(){r.handleShakeAnimationEnd()},r}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return pi},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},getWidth:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.adapter.registerInteractionHandler("animationend",this.shakeAnimationEndHandler)},e.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("animationend",this.shakeAnimationEndHandler)},e.prototype.getWidth=function(){return this.adapter.getWidth()},e.prototype.shake=function(t){var i=e.cssClasses.LABEL_SHAKE;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.float=function(t){var i=e.cssClasses,r=i.LABEL_FLOAT_ABOVE,n=i.LABEL_SHAKE;t?this.adapter.addClass(r):(this.adapter.removeClass(r),this.adapter.removeClass(n))},e.prototype.setRequired=function(t){var i=e.cssClasses.LABEL_REQUIRED;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.handleShakeAnimationEnd=function(){var t=e.cssClasses.LABEL_SHAKE;this.adapter.removeClass(t)},e}(vt);const mi=Dt(class extends jt{constructor(t){switch(super(t),this.foundation=null,this.previousPart=null,t.type){case Lt:case Rt:break;default:throw new Error("FloatingLabel directive only support attribute and property parts")}}update(t,[e]){if(t!==this.previousPart){this.foundation&&this.foundation.destroy(),this.previousPart=t;const e=t.element;e.classList.add("mdc-floating-label");const i=(t=>({addClass:e=>t.classList.add(e),removeClass:e=>t.classList.remove(e),getWidth:()=>t.scrollWidth,registerInteractionHandler:(e,i)=>{t.addEventListener(e,i)},deregisterInteractionHandler:(e,i)=>{t.removeEventListener(e,i)}}))(e);this.foundation=new ui(i),this.foundation.init()}return this.render(e)}render(t){return this.foundation}});var fi={LINE_RIPPLE_ACTIVE:"mdc-line-ripple--active",LINE_RIPPLE_DEACTIVATING:"mdc-line-ripple--deactivating"},gi=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.transitionEndHandler=function(t){r.handleTransitionEnd(t)},r}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return fi},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.adapter.registerEventHandler("transitionend",this.transitionEndHandler)},e.prototype.destroy=function(){this.adapter.deregisterEventHandler("transitionend",this.transitionEndHandler)},e.prototype.activate=function(){this.adapter.removeClass(fi.LINE_RIPPLE_DEACTIVATING),this.adapter.addClass(fi.LINE_RIPPLE_ACTIVE)},e.prototype.setRippleCenter=function(t){this.adapter.setStyle("transform-origin",t+"px center")},e.prototype.deactivate=function(){this.adapter.addClass(fi.LINE_RIPPLE_DEACTIVATING)},e.prototype.handleTransitionEnd=function(t){var e=this.adapter.hasClass(fi.LINE_RIPPLE_DEACTIVATING);"opacity"===t.propertyName&&e&&(this.adapter.removeClass(fi.LINE_RIPPLE_ACTIVE),this.adapter.removeClass(fi.LINE_RIPPLE_DEACTIVATING))},e}(vt);const _i=Dt(class extends jt{constructor(t){switch(super(t),this.previousPart=null,this.foundation=null,t.type){case Lt:case Rt:return;default:throw new Error("LineRipple only support attribute and property parts.")}}update(t,e){if(this.previousPart!==t){this.foundation&&this.foundation.destroy(),this.previousPart=t;const e=t.element;e.classList.add("mdc-line-ripple");const i=(t=>({addClass:e=>t.classList.add(e),removeClass:e=>t.classList.remove(e),hasClass:e=>t.classList.contains(e),setStyle:(e,i)=>t.style.setProperty(e,i),registerEventHandler:(e,i)=>{t.addEventListener(e,i)},deregisterEventHandler:(e,i)=>{t.removeEventListener(e,i)}}))(e);this.foundation=new gi(i),this.foundation.init()}return this.render()}render(){return this.foundation}});var vi={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",INPUT_SELECTOR:".mdc-text-field__input",LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-text-field__icon--leading",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",OUTLINE_SELECTOR:".mdc-notched-outline",PREFIX_SELECTOR:".mdc-text-field__affix--prefix",SUFFIX_SELECTOR:".mdc-text-field__affix--suffix",TRAILING_ICON_SELECTOR:".mdc-text-field__icon--trailing"},yi={DISABLED:"mdc-text-field--disabled",FOCUSED:"mdc-text-field--focused",HELPER_LINE:"mdc-text-field-helper-line",INVALID:"mdc-text-field--invalid",LABEL_FLOATING:"mdc-text-field--label-floating",NO_LABEL:"mdc-text-field--no-label",OUTLINED:"mdc-text-field--outlined",ROOT:"mdc-text-field",TEXTAREA:"mdc-text-field--textarea",WITH_LEADING_ICON:"mdc-text-field--with-leading-icon",WITH_TRAILING_ICON:"mdc-text-field--with-trailing-icon",WITH_INTERNAL_COUNTER:"mdc-text-field--with-internal-counter"},bi={LABEL_SCALE:.75},xi=["pattern","min","max","required","step","minlength","maxlength"],wi=["color","date","datetime-local","month","range","time","week"],ki=["mousedown","touchstart"],Ti=["click","keydown"],Si=function(t){function e(i,r){void 0===r&&(r={});var n=t.call(this,et(et({},e.defaultAdapter),i))||this;return n.isFocused=!1,n.receivedUserInput=!1,n.valid=!0,n.useNativeValidation=!0,n.validateOnValueChange=!0,n.helperText=r.helperText,n.characterCounter=r.characterCounter,n.leadingIcon=r.leadingIcon,n.trailingIcon=r.trailingIcon,n.inputFocusHandler=function(){n.activateFocus()},n.inputBlurHandler=function(){n.deactivateFocus()},n.inputInputHandler=function(){n.handleInput()},n.setPointerXOffset=function(t){n.setTransformOrigin(t)},n.textFieldInteractionHandler=function(){n.handleTextFieldInteraction()},n.validationAttributeChangeHandler=function(t){n.handleValidationAttributeChange(t)},n}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return yi},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return vi},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return bi},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldAlwaysFloat",{get:function(){var t=this.getNativeInput().type;return wi.indexOf(t)>=0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldFloat",{get:function(){return this.shouldAlwaysFloat||this.isFocused||!!this.getValue()||this.isBadInput()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldShake",{get:function(){return!this.isFocused&&!this.isValid()&&!!this.getValue()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!0},setInputAttr:function(){},removeInputAttr:function(){},registerTextFieldInteractionHandler:function(){},deregisterTextFieldInteractionHandler:function(){},registerInputInteractionHandler:function(){},deregisterInputInteractionHandler:function(){},registerValidationAttributeChangeHandler:function(){return new MutationObserver((function(){}))},deregisterValidationAttributeChangeHandler:function(){},getNativeInput:function(){return null},isFocused:function(){return!1},activateLineRipple:function(){},deactivateLineRipple:function(){},setLineRippleTransformOrigin:function(){},shakeLabel:function(){},floatLabel:function(){},setLabelRequired:function(){},hasLabel:function(){return!1},getLabelWidth:function(){return 0},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t,e,i,r;this.adapter.hasLabel()&&this.getNativeInput().required&&this.adapter.setLabelRequired(!0),this.adapter.isFocused()?this.inputFocusHandler():this.adapter.hasLabel()&&this.shouldFloat&&(this.notchOutline(!0),this.adapter.floatLabel(!0),this.styleFloating(!0)),this.adapter.registerInputInteractionHandler("focus",this.inputFocusHandler),this.adapter.registerInputInteractionHandler("blur",this.inputBlurHandler),this.adapter.registerInputInteractionHandler("input",this.inputInputHandler);try{for(var n=rt(ki),a=n.next();!a.done;a=n.next()){var s=a.value;this.adapter.registerInputInteractionHandler(s,this.setPointerXOffset)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}try{for(var o=rt(Ti),l=o.next();!l.done;l=o.next()){s=l.value;this.adapter.registerTextFieldInteractionHandler(s,this.textFieldInteractionHandler)}}catch(t){i={error:t}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}this.validationObserver=this.adapter.registerValidationAttributeChangeHandler(this.validationAttributeChangeHandler),this.setcharacterCounter(this.getValue().length)},e.prototype.destroy=function(){var t,e,i,r;this.adapter.deregisterInputInteractionHandler("focus",this.inputFocusHandler),this.adapter.deregisterInputInteractionHandler("blur",this.inputBlurHandler),this.adapter.deregisterInputInteractionHandler("input",this.inputInputHandler);try{for(var n=rt(ki),a=n.next();!a.done;a=n.next()){var s=a.value;this.adapter.deregisterInputInteractionHandler(s,this.setPointerXOffset)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}try{for(var o=rt(Ti),l=o.next();!l.done;l=o.next()){s=l.value;this.adapter.deregisterTextFieldInteractionHandler(s,this.textFieldInteractionHandler)}}catch(t){i={error:t}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}this.adapter.deregisterValidationAttributeChangeHandler(this.validationObserver)},e.prototype.handleTextFieldInteraction=function(){var t=this.adapter.getNativeInput();t&&t.disabled||(this.receivedUserInput=!0)},e.prototype.handleValidationAttributeChange=function(t){var e=this;t.some((function(t){return xi.indexOf(t)>-1&&(e.styleValidity(!0),e.adapter.setLabelRequired(e.getNativeInput().required),!0)})),t.indexOf("maxlength")>-1&&this.setcharacterCounter(this.getValue().length)},e.prototype.notchOutline=function(t){if(this.adapter.hasOutline()&&this.adapter.hasLabel())if(t){var e=this.adapter.getLabelWidth()*bi.LABEL_SCALE;this.adapter.notchOutline(e)}else this.adapter.closeOutline()},e.prototype.activateFocus=function(){this.isFocused=!0,this.styleFocused(this.isFocused),this.adapter.activateLineRipple(),this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating(this.shouldFloat),this.adapter.shakeLabel(this.shouldShake)),!this.helperText||!this.helperText.isPersistent()&&this.helperText.isValidation()&&this.valid||this.helperText.showToScreenReader()},e.prototype.setTransformOrigin=function(t){if(!this.isDisabled()&&!this.adapter.hasOutline()){var e=t.touches,i=e?e[0]:t,r=i.target.getBoundingClientRect(),n=i.clientX-r.left;this.adapter.setLineRippleTransformOrigin(n)}},e.prototype.handleInput=function(){this.autoCompleteFocus(),this.setcharacterCounter(this.getValue().length)},e.prototype.autoCompleteFocus=function(){this.receivedUserInput||this.activateFocus()},e.prototype.deactivateFocus=function(){this.isFocused=!1,this.adapter.deactivateLineRipple();var t=this.isValid();this.styleValidity(t),this.styleFocused(this.isFocused),this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating(this.shouldFloat),this.adapter.shakeLabel(this.shouldShake)),this.shouldFloat||(this.receivedUserInput=!1)},e.prototype.getValue=function(){return this.getNativeInput().value},e.prototype.setValue=function(t){if(this.getValue()!==t&&(this.getNativeInput().value=t),this.setcharacterCounter(t.length),this.validateOnValueChange){var e=this.isValid();this.styleValidity(e)}this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating(this.shouldFloat),this.validateOnValueChange&&this.adapter.shakeLabel(this.shouldShake))},e.prototype.isValid=function(){return this.useNativeValidation?this.isNativeInputValid():this.valid},e.prototype.setValid=function(t){this.valid=t,this.styleValidity(t);var e=!t&&!this.isFocused&&!!this.getValue();this.adapter.hasLabel()&&this.adapter.shakeLabel(e)},e.prototype.setValidateOnValueChange=function(t){this.validateOnValueChange=t},e.prototype.getValidateOnValueChange=function(){return this.validateOnValueChange},e.prototype.setUseNativeValidation=function(t){this.useNativeValidation=t},e.prototype.isDisabled=function(){return this.getNativeInput().disabled},e.prototype.setDisabled=function(t){this.getNativeInput().disabled=t,this.styleDisabled(t)},e.prototype.setHelperTextContent=function(t){this.helperText&&this.helperText.setContent(t)},e.prototype.setLeadingIconAriaLabel=function(t){this.leadingIcon&&this.leadingIcon.setAriaLabel(t)},e.prototype.setLeadingIconContent=function(t){this.leadingIcon&&this.leadingIcon.setContent(t)},e.prototype.setTrailingIconAriaLabel=function(t){this.trailingIcon&&this.trailingIcon.setAriaLabel(t)},e.prototype.setTrailingIconContent=function(t){this.trailingIcon&&this.trailingIcon.setContent(t)},e.prototype.setcharacterCounter=function(t){if(this.characterCounter){var e=this.getNativeInput().maxLength;if(-1===e)throw new Error("MDCTextFieldFoundation: Expected maxlength html property on text input or textarea.");this.characterCounter.setCounterValue(t,e)}},e.prototype.isBadInput=function(){return this.getNativeInput().validity.badInput||!1},e.prototype.isNativeInputValid=function(){return this.getNativeInput().validity.valid},e.prototype.styleValidity=function(t){var i=e.cssClasses.INVALID;if(t?this.adapter.removeClass(i):this.adapter.addClass(i),this.helperText){if(this.helperText.setValidity(t),!this.helperText.isValidation())return;var r=this.helperText.isVisible(),n=this.helperText.getId();r&&n?this.adapter.setInputAttr(vi.ARIA_DESCRIBEDBY,n):this.adapter.removeInputAttr(vi.ARIA_DESCRIBEDBY)}},e.prototype.styleFocused=function(t){var i=e.cssClasses.FOCUSED;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.styleDisabled=function(t){var i=e.cssClasses,r=i.DISABLED,n=i.INVALID;t?(this.adapter.addClass(r),this.adapter.removeClass(n)):this.adapter.removeClass(r),this.leadingIcon&&this.leadingIcon.setDisabled(t),this.trailingIcon&&this.trailingIcon.setDisabled(t)},e.prototype.styleFloating=function(t){var i=e.cssClasses.LABEL_FLOATING;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.getNativeInput=function(){return(this.adapter?this.adapter.getNativeInput():null)||{disabled:!1,maxLength:-1,required:!1,type:"input",validity:{badInput:!1,valid:!0},value:""}},e}(vt),Ci=Si;const Ei=t=>void 0===t.strings,$i={},Ai=Dt(class extends jt{constructor(t){if(super(t),t.type!==Rt&&t.type!==Lt&&t.type!==zt)throw Error("The `live` directive is not allowed on child or event bindings");if(!Ei(t))throw Error("`live` bindings can only contain a single expression")}render(t){return t}update(t,[e]){if(e===P||e===R)return e;const i=t.element,r=t.name;if(t.type===Rt){if(e===i[r])return P}else if(t.type===zt){if(!!e===i.hasAttribute(r))return P}else if(t.type===Lt&&i.getAttribute(r)===e+"")return P;return((t,e=$i)=>{t._$AH=e})(t),e}}),Ii=["touchstart","touchmove","scroll","mousewheel"],Mi=(t={})=>{const e={};for(const i in t)e[i]=t[i];return Object.assign({badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!0,valueMissing:!1},e)};class Li extends hi{constructor(){super(...arguments),this.mdcFoundationClass=Ci,this.value="",this.type="text",this.placeholder="",this.label="",this.icon="",this.iconTrailing="",this.disabled=!1,this.required=!1,this.minLength=-1,this.maxLength=-1,this.outlined=!1,this.helper="",this.validateOnInitialRender=!1,this.validationMessage="",this.autoValidate=!1,this.pattern="",this.min="",this.max="",this.step=null,this.size=null,this.helperPersistent=!1,this.charCounter=!1,this.endAligned=!1,this.prefix="",this.suffix="",this.name="",this.readOnly=!1,this.autocapitalize="",this.outlineOpen=!1,this.outlineWidth=0,this.isUiValid=!0,this.focused=!1,this._validity=Mi(),this.validityTransform=null}get validity(){return this._checkValidity(this.value),this._validity}get willValidate(){return this.formElement.willValidate}get selectionStart(){return this.formElement.selectionStart}get selectionEnd(){return this.formElement.selectionEnd}focus(){const t=new CustomEvent("focus");this.formElement.dispatchEvent(t),this.formElement.focus()}blur(){const t=new CustomEvent("blur");this.formElement.dispatchEvent(t),this.formElement.blur()}select(){this.formElement.select()}setSelectionRange(t,e,i){this.formElement.setSelectionRange(t,e,i)}update(t){t.has("autoValidate")&&this.mdcFoundation&&this.mdcFoundation.setValidateOnValueChange(this.autoValidate),t.has("value")&&"string"!=typeof this.value&&(this.value=`${this.value}`),super.update(t)}setFormData(t){this.name&&t.append(this.name,this.value)}render(){const t=this.charCounter&&-1!==this.maxLength,e=!!this.helper||!!this.validationMessage||t,i={"mdc-text-field--disabled":this.disabled,"mdc-text-field--no-label":!this.label,"mdc-text-field--filled":!this.outlined,"mdc-text-field--outlined":this.outlined,"mdc-text-field--with-leading-icon":this.icon,"mdc-text-field--with-trailing-icon":this.iconTrailing,"mdc-text-field--end-aligned":this.endAligned};return M`
      <label class="mdc-text-field ${Ot(i)}">
        ${this.renderRipple()}
        ${this.outlined?this.renderOutline():this.renderLabel()}
        ${this.renderLeadingIcon()}
        ${this.renderPrefix()}
        ${this.renderInput(e)}
        ${this.renderSuffix()}
        ${this.renderTrailingIcon()}
        ${this.renderLineRipple()}
      </label>
      ${this.renderHelperText(e,t)}
    `}updated(t){t.has("value")&&void 0!==t.get("value")&&(this.mdcFoundation.setValue(this.value),this.autoValidate&&this.reportValidity())}renderRipple(){return this.outlined?"":M`
      <span class="mdc-text-field__ripple"></span>
    `}renderOutline(){return this.outlined?M`
      <mwc-notched-outline
          .width=${this.outlineWidth}
          .open=${this.outlineOpen}
          class="mdc-notched-outline">
        ${this.renderLabel()}
      </mwc-notched-outline>`:""}renderLabel(){return this.label?M`
      <span
          .floatingLabelFoundation=${mi(this.label)}
          id="label">${this.label}</span>
    `:""}renderLeadingIcon(){return this.icon?this.renderIcon(this.icon):""}renderTrailingIcon(){return this.iconTrailing?this.renderIcon(this.iconTrailing,!0):""}renderIcon(t,e=!1){return M`<i class="material-icons mdc-text-field__icon ${Ot({"mdc-text-field__icon--leading":!e,"mdc-text-field__icon--trailing":e})}">${t}</i>`}renderPrefix(){return this.prefix?this.renderAffix(this.prefix):""}renderSuffix(){return this.suffix?this.renderAffix(this.suffix,!0):""}renderAffix(t,e=!1){return M`<span class="mdc-text-field__affix ${Ot({"mdc-text-field__affix--prefix":!e,"mdc-text-field__affix--suffix":e})}">
        ${t}</span>`}renderInput(t){const e=-1===this.minLength?void 0:this.minLength,i=-1===this.maxLength?void 0:this.maxLength,r=this.autocapitalize?this.autocapitalize:void 0,n=this.validationMessage&&!this.isUiValid,a=this.label?"label":void 0,s=t?"helper-text":void 0,o=this.focused||this.helperPersistent||n?"helper-text":void 0;return M`
      <input
          aria-labelledby=${Ke(a)}
          aria-controls="${Ke(s)}"
          aria-describedby="${Ke(o)}"
          class="mdc-text-field__input"
          type="${this.type}"
          .value="${Ai(this.value)}"
          ?disabled="${this.disabled}"
          placeholder="${this.placeholder}"
          ?required="${this.required}"
          ?readonly="${this.readOnly}"
          minlength="${Ke(e)}"
          maxlength="${Ke(i)}"
          pattern="${Ke(this.pattern?this.pattern:void 0)}"
          min="${Ke(""===this.min?void 0:this.min)}"
          max="${Ke(""===this.max?void 0:this.max)}"
          step="${Ke(null===this.step?void 0:this.step)}"
          size="${Ke(null===this.size?void 0:this.size)}"
          name="${Ke(""===this.name?void 0:this.name)}"
          inputmode="${Ke(this.inputMode)}"
          autocapitalize="${Ke(r)}"
          @input="${this.handleInputChange}"
          @focus="${this.onInputFocus}"
          @blur="${this.onInputBlur}">`}renderLineRipple(){return this.outlined?"":M`
      <span .lineRippleFoundation=${_i()}></span>
    `}renderHelperText(t,e){const i=this.validationMessage&&!this.isUiValid,r={"mdc-text-field-helper-text--persistent":this.helperPersistent,"mdc-text-field-helper-text--validation-msg":i},n=this.focused||this.helperPersistent||i?void 0:"true",a=i?this.validationMessage:this.helper;return t?M`
      <div class="mdc-text-field-helper-line">
        <div id="helper-text"
             aria-hidden="${Ke(n)}"
             class="mdc-text-field-helper-text ${Ot(r)}"
             >${a}</div>
        ${this.renderCharCounter(e)}
      </div>`:""}renderCharCounter(t){const e=Math.min(this.value.length,this.maxLength);return t?M`
      <span class="mdc-text-field-character-counter"
            >${e} / ${this.maxLength}</span>`:""}onInputFocus(){this.focused=!0}onInputBlur(){this.focused=!1,this.reportValidity()}checkValidity(){const t=this._checkValidity(this.value);if(!t){const t=new Event("invalid",{bubbles:!1,cancelable:!0});this.dispatchEvent(t)}return t}reportValidity(){const t=this.checkValidity();return this.mdcFoundation.setValid(t),this.isUiValid=t,t}_checkValidity(t){const e=this.formElement.validity;let i=Mi(e);if(this.validityTransform){const e=this.validityTransform(t,i);i=Object.assign(Object.assign({},i),e),this.mdcFoundation.setUseNativeValidation(!1)}else this.mdcFoundation.setUseNativeValidation(!0);return this._validity=i,this._validity.valid}setCustomValidity(t){this.validationMessage=t,this.formElement.setCustomValidity(t)}handleInputChange(){this.value=this.formElement.value}createAdapter(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.getRootAdapterMethods()),this.getInputAdapterMethods()),this.getLabelAdapterMethods()),this.getLineRippleAdapterMethods()),this.getOutlineAdapterMethods())}getRootAdapterMethods(){return Object.assign({registerTextFieldInteractionHandler:(t,e)=>this.addEventListener(t,e),deregisterTextFieldInteractionHandler:(t,e)=>this.removeEventListener(t,e),registerValidationAttributeChangeHandler:t=>{const e=new MutationObserver((e=>{t((t=>t.map((t=>t.attributeName)).filter((t=>t)))(e))}));return e.observe(this.formElement,{attributes:!0}),e},deregisterValidationAttributeChangeHandler:t=>t.disconnect()},kt(this.mdcRoot))}getInputAdapterMethods(){return{getNativeInput:()=>this.formElement,setInputAttr:()=>{},removeInputAttr:()=>{},isFocused:()=>!!this.shadowRoot&&this.shadowRoot.activeElement===this.formElement,registerInputInteractionHandler:(t,e)=>this.formElement.addEventListener(t,e,{passive:t in Ii}),deregisterInputInteractionHandler:(t,e)=>this.formElement.removeEventListener(t,e)}}getLabelAdapterMethods(){return{floatLabel:t=>this.labelElement&&this.labelElement.floatingLabelFoundation.float(t),getLabelWidth:()=>this.labelElement?this.labelElement.floatingLabelFoundation.getWidth():0,hasLabel:()=>Boolean(this.labelElement),shakeLabel:t=>this.labelElement&&this.labelElement.floatingLabelFoundation.shake(t),setLabelRequired:t=>{this.labelElement&&this.labelElement.floatingLabelFoundation.setRequired(t)}}}getLineRippleAdapterMethods(){return{activateLineRipple:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.activate()},deactivateLineRipple:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.deactivate()},setLineRippleTransformOrigin:t=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.setRippleCenter(t)}}}async getUpdateComplete(){var t;const e=await super.getUpdateComplete();return await(null===(t=this.outlineElement)||void 0===t?void 0:t.updateComplete),e}firstUpdated(){var t;super.firstUpdated(),this.mdcFoundation.setValidateOnValueChange(this.autoValidate),this.validateOnInitialRender&&this.reportValidity(),null===(t=this.outlineElement)||void 0===t||t.updateComplete.then((()=>{var t;this.outlineWidth=(null===(t=this.labelElement)||void 0===t?void 0:t.floatingLabelFoundation.getWidth())||0}))}getOutlineAdapterMethods(){return{closeOutline:()=>this.outlineElement&&(this.outlineOpen=!1),hasOutline:()=>Boolean(this.outlineElement),notchOutline:t=>{this.outlineElement&&!this.outlineOpen&&(this.outlineWidth=t,this.outlineOpen=!0)}}}async layout(){await this.updateComplete;const t=this.labelElement;if(!t)return void(this.outlineOpen=!1);const e=!!this.label&&!!this.value;if(t.floatingLabelFoundation.float(e),!this.outlined)return;this.outlineOpen=e,await this.updateComplete;const i=t.floatingLabelFoundation.getWidth();this.outlineOpen&&(this.outlineWidth=i,await this.updateComplete)}}it([ht(".mdc-text-field")],Li.prototype,"mdcRoot",void 0),it([ht("input")],Li.prototype,"formElement",void 0),it([ht(".mdc-floating-label")],Li.prototype,"labelElement",void 0),it([ht(".mdc-line-ripple")],Li.prototype,"lineRippleElement",void 0),it([ht("mwc-notched-outline")],Li.prototype,"outlineElement",void 0),it([ht(".mdc-notched-outline__notch")],Li.prototype,"notchElement",void 0),it([ot({type:String})],Li.prototype,"value",void 0),it([ot({type:String})],Li.prototype,"type",void 0),it([ot({type:String})],Li.prototype,"placeholder",void 0),it([ot({type:String}),Mt((function(t,e){void 0!==e&&this.label!==e&&this.layout()}))],Li.prototype,"label",void 0),it([ot({type:String})],Li.prototype,"icon",void 0),it([ot({type:String})],Li.prototype,"iconTrailing",void 0),it([ot({type:Boolean,reflect:!0})],Li.prototype,"disabled",void 0),it([ot({type:Boolean})],Li.prototype,"required",void 0),it([ot({type:Number})],Li.prototype,"minLength",void 0),it([ot({type:Number})],Li.prototype,"maxLength",void 0),it([ot({type:Boolean,reflect:!0}),Mt((function(t,e){void 0!==e&&this.outlined!==e&&this.layout()}))],Li.prototype,"outlined",void 0),it([ot({type:String})],Li.prototype,"helper",void 0),it([ot({type:Boolean})],Li.prototype,"validateOnInitialRender",void 0),it([ot({type:String})],Li.prototype,"validationMessage",void 0),it([ot({type:Boolean})],Li.prototype,"autoValidate",void 0),it([ot({type:String})],Li.prototype,"pattern",void 0),it([ot({type:String})],Li.prototype,"min",void 0),it([ot({type:String})],Li.prototype,"max",void 0),it([ot({type:String})],Li.prototype,"step",void 0),it([ot({type:Number})],Li.prototype,"size",void 0),it([ot({type:Boolean})],Li.prototype,"helperPersistent",void 0),it([ot({type:Boolean})],Li.prototype,"charCounter",void 0),it([ot({type:Boolean})],Li.prototype,"endAligned",void 0),it([ot({type:String})],Li.prototype,"prefix",void 0),it([ot({type:String})],Li.prototype,"suffix",void 0),it([ot({type:String})],Li.prototype,"name",void 0),it([ot({type:String})],Li.prototype,"inputMode",void 0),it([ot({type:Boolean})],Li.prototype,"readOnly",void 0),it([ot({type:String})],Li.prototype,"autocapitalize",void 0),it([lt()],Li.prototype,"outlineOpen",void 0),it([lt()],Li.prototype,"outlineWidth",void 0),it([lt()],Li.prototype,"isUiValid",void 0),it([lt()],Li.prototype,"focused",void 0),it([dt({passive:!0})],Li.prototype,"handleInputChange",null);const Pi=n`.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:0.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform;transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required::after,.mdc-floating-label--required[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-106%) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-106%) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);border-bottom-width:2px;opacity:0;z-index:2}.mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(100% / 0.75)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}.mdc-text-field--filled{--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0);will-change:transform,opacity}.mdc-text-field--filled .mdc-text-field__ripple::before,.mdc-text-field--filled .mdc-text-field__ripple::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-text-field--filled .mdc-text-field__ripple::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1;z-index:var(--mdc-ripple-z-index, 1)}.mdc-text-field--filled .mdc-text-field__ripple::after{z-index:0;z-index:var(--mdc-ripple-z-index, 0)}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-text-field--filled.mdc-ripple-upgraded--unbounded .mdc-text-field__ripple::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-text-field--filled.mdc-ripple-upgraded--foreground-activation .mdc-text-field__ripple::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-text-field--filled.mdc-ripple-upgraded--foreground-deactivation .mdc-text-field__ripple::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-text-field--filled .mdc-text-field__ripple::before,.mdc-text-field--filled .mdc-text-field__ripple::after{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-text-field__ripple{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-floating-label{color:rgba(0, 0, 0, 0.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input{color:rgba(0, 0, 0, 0.87)}@media all{.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:rgba(0, 0, 0, 0.54)}}@media all{.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:rgba(0, 0, 0, 0.54)}}.mdc-text-field .mdc-text-field__input{caret-color:#6200ee;caret-color:var(--mdc-theme-primary, #6200ee)}.mdc-text-field:not(.mdc-text-field--disabled)+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:rgba(0, 0, 0, 0.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field-character-counter,.mdc-text-field:not(.mdc-text-field--disabled)+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:rgba(0, 0, 0, 0.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__icon--leading{color:rgba(0, 0, 0, 0.54)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__icon--trailing{color:rgba(0, 0, 0, 0.54)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__affix--prefix{color:rgba(0, 0, 0, 0.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__affix--suffix{color:rgba(0, 0, 0, 0.6)}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:0.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);height:28px;transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}}.mdc-text-field__affix{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:0.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);height:28px;transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled .mdc-text-field__ripple::before,.mdc-text-field--filled .mdc-text-field__ripple::after{background-color:rgba(0, 0, 0, 0.87);background-color:var(--mdc-ripple-color, rgba(0, 0, 0, 0.87))}.mdc-text-field--filled:hover .mdc-text-field__ripple::before,.mdc-text-field--filled.mdc-ripple-surface--hover .mdc-text-field__ripple::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:whitesmoke}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0, 0, 0, 0.42)}.mdc-text-field--filled:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0, 0, 0, 0.87)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-color:#6200ee;border-bottom-color:var(--mdc-theme-primary, #6200ee)}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:rgba(0, 0, 0, 0.38)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:rgba(0, 0, 0, 0.87)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#6200ee;border-color:var(--mdc-theme-primary, #6200ee)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-shape-small, 4px)) * 2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px, var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-text-field__ripple::before,.mdc-text-field--outlined .mdc-text-field__ripple::after{background-color:transparent;background-color:var(--mdc-ripple-color, transparent)}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:transparent}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0;transition:none}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px;line-height:1.5rem}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0 - 0%)) translateY(-10.25px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-10.25px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-10.25px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-10.25px) scale(0.75)}}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-24.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-24.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused:not(.mdc-text-field--disabled) .mdc-floating-label{color:rgba(98, 0, 238, 0.87)}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid .mdc-text-field__input{caret-color:#b00020;caret-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__icon--trailing{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}.mdc-text-field--disabled .mdc-text-field__input{color:rgba(0, 0, 0, 0.38)}@media all{.mdc-text-field--disabled .mdc-text-field__input::placeholder{color:rgba(0, 0, 0, 0.38)}}@media all{.mdc-text-field--disabled .mdc-text-field__input:-ms-input-placeholder{color:rgba(0, 0, 0, 0.38)}}.mdc-text-field--disabled .mdc-floating-label{color:rgba(0, 0, 0, 0.38)}.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:rgba(0, 0, 0, 0.38)}.mdc-text-field--disabled .mdc-text-field-character-counter,.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:rgba(0, 0, 0, 0.38)}.mdc-text-field--disabled .mdc-text-field__icon--leading{color:rgba(0, 0, 0, 0.3)}.mdc-text-field--disabled .mdc-text-field__icon--trailing{color:rgba(0, 0, 0, 0.3)}.mdc-text-field--disabled .mdc-text-field__affix--prefix{color:rgba(0, 0, 0, 0.38)}.mdc-text-field--disabled .mdc-text-field__affix--suffix{color:rgba(0, 0, 0, 0.38)}.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0, 0, 0, 0.06)}.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:rgba(0, 0, 0, 0.06)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__input::placeholder{color:GrayText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__input:-ms-input-placeholder{color:GrayText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-text-field--disabled .mdc-floating-label{color:GrayText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:GrayText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field-character-counter,.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:GrayText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__icon--leading{color:GrayText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__icon--trailing{color:GrayText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__affix--prefix{color:GrayText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-text-field--disabled .mdc-text-field__affix--suffix{color:GrayText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:GrayText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:GrayText}}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled{background-color:#fafafa}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-text-field-helper-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-caption-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.75rem;font-size:var(--mdc-typography-caption-font-size, 0.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight, 400);letter-spacing:0.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing, 0.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform, inherit);display:block;margin-top:0;line-height:normal;margin:0;opacity:0;will-change:opacity;transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-text-field-helper-text::before{display:inline-block;width:0;height:16px;content:"";vertical-align:0}.mdc-text-field-helper-text--persistent{transition:none;opacity:1;will-change:initial}.mdc-text-field-character-counter{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-caption-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.75rem;font-size:var(--mdc-typography-caption-font-size, 0.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight, 400);letter-spacing:0.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing, 0.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform, inherit);display:block;margin-top:0;line-height:normal;margin-left:auto;margin-right:0;padding-left:16px;padding-right:0;white-space:nowrap}.mdc-text-field-character-counter::before{display:inline-block;width:0;height:16px;content:"";vertical-align:0}[dir=rtl] .mdc-text-field-character-counter,.mdc-text-field-character-counter[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-text-field-character-counter,.mdc-text-field-character-counter[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field__icon{align-self:center;cursor:pointer}.mdc-text-field__icon:not([tabindex]),.mdc-text-field__icon[tabindex="-1"]{cursor:default;pointer-events:none}.mdc-text-field__icon svg{display:block}.mdc-text-field__icon--leading{margin-left:16px;margin-right:8px}[dir=rtl] .mdc-text-field__icon--leading,.mdc-text-field__icon--leading[dir=rtl]{margin-left:8px;margin-right:16px}.mdc-text-field__icon--trailing{padding:12px;margin-left:0px;margin-right:0px}[dir=rtl] .mdc-text-field__icon--trailing,.mdc-text-field__icon--trailing[dir=rtl]{margin-left:0px;margin-right:0px}.material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}:host{display:inline-flex;flex-direction:column;outline:none}.mdc-text-field{width:100%}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0, 0, 0, 0.42);border-bottom-color:var(--mdc-text-field-idle-line-color, rgba(0, 0, 0, 0.42))}.mdc-text-field:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0, 0, 0, 0.87);border-bottom-color:var(--mdc-text-field-hover-line-color, rgba(0, 0, 0, 0.87))}.mdc-text-field.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0, 0, 0, 0.06);border-bottom-color:var(--mdc-text-field-disabled-line-color, rgba(0, 0, 0, 0.06))}.mdc-text-field.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-text-field__input{direction:inherit}mwc-notched-outline{--mdc-notched-outline-border-color: var( --mdc-text-field-outlined-idle-border-color, rgba(0, 0, 0, 0.38) )}:host(:not([disabled]):hover) :not(.mdc-text-field--invalid):not(.mdc-text-field--focused) mwc-notched-outline{--mdc-notched-outline-border-color: var( --mdc-text-field-outlined-hover-border-color, rgba(0, 0, 0, 0.87) )}:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--outlined){background-color:var(--mdc-text-field-fill-color, whitesmoke)}:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid mwc-notched-outline{--mdc-notched-outline-border-color: var( --mdc-text-field-error-color, var(--mdc-theme-error, #b00020) )}:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-character-counter,:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid .mdc-text-field__icon{color:var(--mdc-text-field-error-color, var(--mdc-theme-error, #b00020))}:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label,:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label::after{color:var(--mdc-text-field-label-ink-color, rgba(0, 0, 0, 0.6))}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused mwc-notched-outline{--mdc-notched-outline-stroke-width: 2px}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) mwc-notched-outline{--mdc-notched-outline-border-color: var( --mdc-text-field-focused-label-color, var(--mdc-theme-primary, rgba(98, 0, 238, 0.87)) )}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) .mdc-floating-label{color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}:host(:not([disabled])) .mdc-text-field .mdc-text-field__input{color:var(--mdc-text-field-ink-color, rgba(0, 0, 0, 0.87))}:host(:not([disabled])) .mdc-text-field .mdc-text-field__input::placeholder{color:var(--mdc-text-field-label-ink-color, rgba(0, 0, 0, 0.6))}:host(:not([disabled])) .mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg),:host(:not([disabled])) .mdc-text-field-helper-line:not(.mdc-text-field--invalid) .mdc-text-field-character-counter{color:var(--mdc-text-field-label-ink-color, rgba(0, 0, 0, 0.6))}:host([disabled]) .mdc-text-field:not(.mdc-text-field--outlined){background-color:var(--mdc-text-field-disabled-fill-color, #fafafa)}:host([disabled]) .mdc-text-field.mdc-text-field--outlined mwc-notched-outline{--mdc-notched-outline-border-color: var( --mdc-text-field-outlined-disabled-border-color, rgba(0, 0, 0, 0.06) )}:host([disabled]) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label,:host([disabled]) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label::after{color:var(--mdc-text-field-disabled-ink-color, rgba(0, 0, 0, 0.38))}:host([disabled]) .mdc-text-field .mdc-text-field__input,:host([disabled]) .mdc-text-field .mdc-text-field__input::placeholder{color:var(--mdc-text-field-disabled-ink-color, rgba(0, 0, 0, 0.38))}:host([disabled]) .mdc-text-field-helper-line .mdc-text-field-helper-text,:host([disabled]) .mdc-text-field-helper-line .mdc-text-field-character-counter{color:var(--mdc-text-field-disabled-ink-color, rgba(0, 0, 0, 0.38))}`;let Ri=class extends Li{};Ri.styles=[Pi],Ri=it([at("mwc-textfield")],Ri);class zi extends K{constructor(){super(...arguments),this.disabled=!1,this.icon="",this.shouldRenderRipple=!1,this.rippleHandlers=new de((()=>(this.shouldRenderRipple=!0,this.ripple)))}renderRipple(){return this.shouldRenderRipple?M`
            <mwc-ripple
                .disabled="${this.disabled}"
                unbounded>
            </mwc-ripple>`:""}focus(){const t=this.buttonElement;t&&(this.rippleHandlers.startFocus(),t.focus())}blur(){const t=this.buttonElement;t&&(this.rippleHandlers.endFocus(),t.blur())}render(){return M`<button
        class="mdc-icon-button mdc-icon-button--display-flex"
        aria-label="${this.ariaLabel||this.icon}"
        aria-haspopup="${Ke(this.ariaHasPopup)}"
        ?disabled="${this.disabled}"
        @focus="${this.handleRippleFocus}"
        @blur="${this.handleRippleBlur}"
        @mousedown="${this.handleRippleMouseDown}"
        @mouseenter="${this.handleRippleMouseEnter}"
        @mouseleave="${this.handleRippleMouseLeave}"
        @touchstart="${this.handleRippleTouchStart}"
        @touchend="${this.handleRippleDeactivate}"
        @touchcancel="${this.handleRippleDeactivate}"
    >${this.renderRipple()}
    ${this.icon?M`<i class="material-icons">${this.icon}</i>`:""}
    <span
      ><slot></slot
    ></span>
  </button>`}handleRippleMouseDown(t){const e=()=>{window.removeEventListener("mouseup",e),this.handleRippleDeactivate()};window.addEventListener("mouseup",e),this.rippleHandlers.startPress(t)}handleRippleTouchStart(t){this.rippleHandlers.startPress(t)}handleRippleDeactivate(){this.rippleHandlers.endPress()}handleRippleMouseEnter(){this.rippleHandlers.startHover()}handleRippleMouseLeave(){this.rippleHandlers.endHover()}handleRippleFocus(){this.rippleHandlers.startFocus()}handleRippleBlur(){this.rippleHandlers.endFocus()}}it([ot({type:Boolean,reflect:!0})],zi.prototype,"disabled",void 0),it([ot({type:String})],zi.prototype,"icon",void 0),it([Xe,ot({type:String,attribute:"aria-label"})],zi.prototype,"ariaLabel",void 0),it([Xe,ot({type:String,attribute:"aria-haspopup"})],zi.prototype,"ariaHasPopup",void 0),it([ht("button")],zi.prototype,"buttonElement",void 0),it([pt("mwc-ripple")],zi.prototype,"ripple",void 0),it([lt()],zi.prototype,"shouldRenderRipple",void 0),it([dt({passive:!0})],zi.prototype,"handleRippleMouseDown",null),it([dt({passive:!0})],zi.prototype,"handleRippleTouchStart",null);const Di=n`.material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}.mdc-icon-button{font-size:24px;width:48px;height:48px;padding:12px}.mdc-icon-button .mdc-icon-button__focus-ring{display:none}.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block;max-height:48px;max-width:48px}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{pointer-events:none;border:2px solid transparent;border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}}@media screen and (forced-colors: active)and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring::after,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring::after{content:"";border:2px solid transparent;border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}}@media screen and (forced-colors: active)and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring::after,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:40px;height:40px;margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-icon-button.mdc-icon-button--reduced-size.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button.mdc-icon-button--reduced-size:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{max-height:40px;max-width:40px}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button:disabled{color:rgba(0, 0, 0, 0.38);color:var(--mdc-theme-text-disabled-on-light, rgba(0, 0, 0, 0.38))}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:transparent;fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:transparent;fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}:host{display:inline-block;outline:none}:host([disabled]){pointer-events:none}.mdc-icon-button i,.mdc-icon-button svg,.mdc-icon-button img,.mdc-icon-button ::slotted(*){display:block}:host{--mdc-ripple-color: currentcolor;-webkit-tap-highlight-color:transparent}:host,.mdc-icon-button{vertical-align:top}.mdc-icon-button{width:var(--mdc-icon-button-size, 48px);height:var(--mdc-icon-button-size, 48px);padding:calc( (var(--mdc-icon-button-size, 48px) - var(--mdc-icon-size, 24px)) / 2 )}.mdc-icon-button i,.mdc-icon-button svg,.mdc-icon-button img,.mdc-icon-button ::slotted(*){display:block;width:var(--mdc-icon-size, 24px);height:var(--mdc-icon-size, 24px)}`;let ji=class extends zi{};ji.styles=[Di],ji=it([at("mwc-icon-button")],ji);class Oi extends K{constructor(){super(...arguments),this.value="",this.group=null,this.tabindex=-1,this.disabled=!1,this.twoline=!1,this.activated=!1,this.graphic=null,this.multipleGraphics=!1,this.hasMeta=!1,this.noninteractive=!1,this.selected=!1,this.shouldRenderRipple=!1,this._managingList=null,this.boundOnClick=this.onClick.bind(this),this._firstChanged=!0,this._skipPropRequest=!1,this.rippleHandlers=new de((()=>(this.shouldRenderRipple=!0,this.ripple))),this.listeners=[{target:this,eventNames:["click"],cb:()=>{this.onClick()}},{target:this,eventNames:["mouseenter"],cb:this.rippleHandlers.startHover},{target:this,eventNames:["mouseleave"],cb:this.rippleHandlers.endHover},{target:this,eventNames:["focus"],cb:this.rippleHandlers.startFocus},{target:this,eventNames:["blur"],cb:this.rippleHandlers.endFocus},{target:this,eventNames:["mousedown","touchstart"],cb:t=>{const e=t.type;this.onDown("mousedown"===e?"mouseup":"touchend",t)}}]}get text(){const t=this.textContent;return t?t.trim():""}render(){const t=this.renderText(),e=this.graphic?this.renderGraphic():M``,i=this.hasMeta?this.renderMeta():M``;return M`
      ${this.renderRipple()}
      ${e}
      ${t}
      ${i}`}renderRipple(){return this.shouldRenderRipple?M`
      <mwc-ripple
        .activated=${this.activated}>
      </mwc-ripple>`:this.activated?M`<div class="fake-activated-ripple"></div>`:""}renderGraphic(){const t={multi:this.multipleGraphics};return M`
      <span class="mdc-deprecated-list-item__graphic material-icons ${Ot(t)}">
        <slot name="graphic"></slot>
      </span>`}renderMeta(){return M`
      <span class="mdc-deprecated-list-item__meta material-icons">
        <slot name="meta"></slot>
      </span>`}renderText(){const t=this.twoline?this.renderTwoline():this.renderSingleLine();return M`
      <span class="mdc-deprecated-list-item__text">
        ${t}
      </span>`}renderSingleLine(){return M`<slot></slot>`}renderTwoline(){return M`
      <span class="mdc-deprecated-list-item__primary-text">
        <slot></slot>
      </span>
      <span class="mdc-deprecated-list-item__secondary-text">
        <slot name="secondary"></slot>
      </span>
    `}onClick(){this.fireRequestSelected(!this.selected,"interaction")}onDown(t,e){const i=()=>{window.removeEventListener(t,i),this.rippleHandlers.endPress()};window.addEventListener(t,i),this.rippleHandlers.startPress(e)}fireRequestSelected(t,e){if(this.noninteractive)return;const i=new CustomEvent("request-selected",{bubbles:!0,composed:!0,detail:{source:e,selected:t}});this.dispatchEvent(i)}connectedCallback(){super.connectedCallback(),this.noninteractive||this.setAttribute("mwc-list-item","");for(const t of this.listeners)for(const e of t.eventNames)t.target.addEventListener(e,t.cb,{passive:!0})}disconnectedCallback(){super.disconnectedCallback();for(const t of this.listeners)for(const e of t.eventNames)t.target.removeEventListener(e,t.cb);this._managingList&&(this._managingList.debouncedLayout?this._managingList.debouncedLayout(!0):this._managingList.layout(!0))}firstUpdated(){const t=new Event("list-item-rendered",{bubbles:!0,composed:!0});this.dispatchEvent(t)}}it([ht("slot")],Oi.prototype,"slotElement",void 0),it([pt("mwc-ripple")],Oi.prototype,"ripple",void 0),it([ot({type:String})],Oi.prototype,"value",void 0),it([ot({type:String,reflect:!0})],Oi.prototype,"group",void 0),it([ot({type:Number,reflect:!0})],Oi.prototype,"tabindex",void 0),it([ot({type:Boolean,reflect:!0}),Mt((function(t){t?this.setAttribute("aria-disabled","true"):this.setAttribute("aria-disabled","false")}))],Oi.prototype,"disabled",void 0),it([ot({type:Boolean,reflect:!0})],Oi.prototype,"twoline",void 0),it([ot({type:Boolean,reflect:!0})],Oi.prototype,"activated",void 0),it([ot({type:String,reflect:!0})],Oi.prototype,"graphic",void 0),it([ot({type:Boolean})],Oi.prototype,"multipleGraphics",void 0),it([ot({type:Boolean})],Oi.prototype,"hasMeta",void 0),it([ot({type:Boolean,reflect:!0}),Mt((function(t){t?(this.removeAttribute("aria-checked"),this.removeAttribute("mwc-list-item"),this.selected=!1,this.activated=!1,this.tabIndex=-1):this.setAttribute("mwc-list-item","")}))],Oi.prototype,"noninteractive",void 0),it([ot({type:Boolean,reflect:!0}),Mt((function(t){const e=this.getAttribute("role"),i="gridcell"===e||"option"===e||"row"===e||"tab"===e;i&&t?this.setAttribute("aria-selected","true"):i&&this.setAttribute("aria-selected","false"),this._firstChanged?this._firstChanged=!1:this._skipPropRequest||this.fireRequestSelected(t,"property")}))],Oi.prototype,"selected",void 0),it([lt()],Oi.prototype,"shouldRenderRipple",void 0),it([lt()],Oi.prototype,"_managingList",void 0);const Bi=n`:host{cursor:pointer;user-select:none;-webkit-tap-highlight-color:transparent;height:48px;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:var(--mdc-list-side-padding, 16px);padding-right:var(--mdc-list-side-padding, 16px);outline:none;height:48px;color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87))}:host:focus{outline:none}:host([activated]){color:#6200ee;color:var(--mdc-theme-primary, #6200ee);--mdc-ripple-color: var( --mdc-theme-primary, #6200ee )}:host([activated]) .mdc-deprecated-list-item__graphic{color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}:host([activated]) .fake-activated-ripple::before{position:absolute;display:block;top:0;bottom:0;left:0;right:0;width:100%;height:100%;pointer-events:none;z-index:1;content:"";opacity:0.12;opacity:var(--mdc-ripple-activated-opacity, 0.12);background-color:#6200ee;background-color:var(--mdc-ripple-color, var(--mdc-theme-primary, #6200ee))}.mdc-deprecated-list-item__graphic{flex-shrink:0;align-items:center;justify-content:center;fill:currentColor;display:inline-flex}.mdc-deprecated-list-item__graphic ::slotted(*){flex-shrink:0;align-items:center;justify-content:center;fill:currentColor;width:100%;height:100%;text-align:center}.mdc-deprecated-list-item__meta{width:var(--mdc-list-item-meta-size, 24px);height:var(--mdc-list-item-meta-size, 24px);margin-left:auto;margin-right:0;color:rgba(0, 0, 0, 0.38);color:var(--mdc-theme-text-hint-on-background, rgba(0, 0, 0, 0.38))}.mdc-deprecated-list-item__meta.multi{width:auto}.mdc-deprecated-list-item__meta ::slotted(*){width:var(--mdc-list-item-meta-size, 24px);line-height:var(--mdc-list-item-meta-size, 24px)}.mdc-deprecated-list-item__meta ::slotted(.material-icons),.mdc-deprecated-list-item__meta ::slotted(mwc-icon){line-height:var(--mdc-list-item-meta-size, 24px) !important}.mdc-deprecated-list-item__meta ::slotted(:not(.material-icons):not(mwc-icon)){-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-caption-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.75rem;font-size:var(--mdc-typography-caption-font-size, 0.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight, 400);letter-spacing:0.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing, 0.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform, inherit)}[dir=rtl] .mdc-deprecated-list-item__meta,.mdc-deprecated-list-item__meta[dir=rtl]{margin-left:0;margin-right:auto}.mdc-deprecated-list-item__meta ::slotted(*){width:100%;height:100%}.mdc-deprecated-list-item__text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-deprecated-list-item__text ::slotted([for]),.mdc-deprecated-list-item__text[for]{pointer-events:none}.mdc-deprecated-list-item__primary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;line-height:normal;margin-bottom:-20px;display:block}.mdc-deprecated-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-deprecated-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-deprecated-list-item__secondary-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-body2-font-size, 0.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:0.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, 0.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit);text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;line-height:normal;display:block}.mdc-deprecated-list-item__secondary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-deprecated-list--dense .mdc-deprecated-list-item__secondary-text{font-size:inherit}* ::slotted(a),a{color:inherit;text-decoration:none}:host([twoline]){height:72px}:host([twoline]) .mdc-deprecated-list-item__text{align-self:flex-start}:host([disabled]),:host([noninteractive]){cursor:default;pointer-events:none}:host([disabled]) .mdc-deprecated-list-item__text ::slotted(*){opacity:.38}:host([disabled]) .mdc-deprecated-list-item__text ::slotted(*),:host([disabled]) .mdc-deprecated-list-item__primary-text ::slotted(*),:host([disabled]) .mdc-deprecated-list-item__secondary-text ::slotted(*){color:#000;color:var(--mdc-theme-on-surface, #000)}.mdc-deprecated-list-item__secondary-text ::slotted(*){color:rgba(0, 0, 0, 0.54);color:var(--mdc-theme-text-secondary-on-background, rgba(0, 0, 0, 0.54))}.mdc-deprecated-list-item__graphic ::slotted(*){background-color:transparent;color:rgba(0, 0, 0, 0.38);color:var(--mdc-theme-text-icon-on-background, rgba(0, 0, 0, 0.38))}.mdc-deprecated-list-group__subheader ::slotted(*){color:rgba(0, 0, 0, 0.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87))}:host([graphic=avatar]) .mdc-deprecated-list-item__graphic{width:var(--mdc-list-item-graphic-size, 40px);height:var(--mdc-list-item-graphic-size, 40px)}:host([graphic=avatar]) .mdc-deprecated-list-item__graphic.multi{width:auto}:host([graphic=avatar]) .mdc-deprecated-list-item__graphic ::slotted(*){width:var(--mdc-list-item-graphic-size, 40px);line-height:var(--mdc-list-item-graphic-size, 40px)}:host([graphic=avatar]) .mdc-deprecated-list-item__graphic ::slotted(.material-icons),:host([graphic=avatar]) .mdc-deprecated-list-item__graphic ::slotted(mwc-icon){line-height:var(--mdc-list-item-graphic-size, 40px) !important}:host([graphic=avatar]) .mdc-deprecated-list-item__graphic ::slotted(*){border-radius:50%}:host([graphic=avatar]) .mdc-deprecated-list-item__graphic,:host([graphic=medium]) .mdc-deprecated-list-item__graphic,:host([graphic=large]) .mdc-deprecated-list-item__graphic,:host([graphic=control]) .mdc-deprecated-list-item__graphic{margin-left:0;margin-right:var(--mdc-list-item-graphic-margin, 16px)}[dir=rtl] :host([graphic=avatar]) .mdc-deprecated-list-item__graphic,[dir=rtl] :host([graphic=medium]) .mdc-deprecated-list-item__graphic,[dir=rtl] :host([graphic=large]) .mdc-deprecated-list-item__graphic,[dir=rtl] :host([graphic=control]) .mdc-deprecated-list-item__graphic,:host([graphic=avatar]) .mdc-deprecated-list-item__graphic[dir=rtl],:host([graphic=medium]) .mdc-deprecated-list-item__graphic[dir=rtl],:host([graphic=large]) .mdc-deprecated-list-item__graphic[dir=rtl],:host([graphic=control]) .mdc-deprecated-list-item__graphic[dir=rtl]{margin-left:var(--mdc-list-item-graphic-margin, 16px);margin-right:0}:host([graphic=icon]) .mdc-deprecated-list-item__graphic{width:var(--mdc-list-item-graphic-size, 24px);height:var(--mdc-list-item-graphic-size, 24px);margin-left:0;margin-right:var(--mdc-list-item-graphic-margin, 32px)}:host([graphic=icon]) .mdc-deprecated-list-item__graphic.multi{width:auto}:host([graphic=icon]) .mdc-deprecated-list-item__graphic ::slotted(*){width:var(--mdc-list-item-graphic-size, 24px);line-height:var(--mdc-list-item-graphic-size, 24px)}:host([graphic=icon]) .mdc-deprecated-list-item__graphic ::slotted(.material-icons),:host([graphic=icon]) .mdc-deprecated-list-item__graphic ::slotted(mwc-icon){line-height:var(--mdc-list-item-graphic-size, 24px) !important}[dir=rtl] :host([graphic=icon]) .mdc-deprecated-list-item__graphic,:host([graphic=icon]) .mdc-deprecated-list-item__graphic[dir=rtl]{margin-left:var(--mdc-list-item-graphic-margin, 32px);margin-right:0}:host([graphic=avatar]:not([twoLine])),:host([graphic=icon]:not([twoLine])){height:56px}:host([graphic=medium]:not([twoLine])),:host([graphic=large]:not([twoLine])){height:72px}:host([graphic=medium]) .mdc-deprecated-list-item__graphic,:host([graphic=large]) .mdc-deprecated-list-item__graphic{width:var(--mdc-list-item-graphic-size, 56px);height:var(--mdc-list-item-graphic-size, 56px)}:host([graphic=medium]) .mdc-deprecated-list-item__graphic.multi,:host([graphic=large]) .mdc-deprecated-list-item__graphic.multi{width:auto}:host([graphic=medium]) .mdc-deprecated-list-item__graphic ::slotted(*),:host([graphic=large]) .mdc-deprecated-list-item__graphic ::slotted(*){width:var(--mdc-list-item-graphic-size, 56px);line-height:var(--mdc-list-item-graphic-size, 56px)}:host([graphic=medium]) .mdc-deprecated-list-item__graphic ::slotted(.material-icons),:host([graphic=medium]) .mdc-deprecated-list-item__graphic ::slotted(mwc-icon),:host([graphic=large]) .mdc-deprecated-list-item__graphic ::slotted(.material-icons),:host([graphic=large]) .mdc-deprecated-list-item__graphic ::slotted(mwc-icon){line-height:var(--mdc-list-item-graphic-size, 56px) !important}:host([graphic=large]){padding-left:0px}`;let Fi=class extends Oi{};Fi.styles=[Bi],Fi=it([at("mwc-list-item")],Fi);var Ni={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},Hi=new Set;Hi.add(Ni.BACKSPACE),Hi.add(Ni.ENTER),Hi.add(Ni.SPACEBAR),Hi.add(Ni.PAGE_UP),Hi.add(Ni.PAGE_DOWN),Hi.add(Ni.END),Hi.add(Ni.HOME),Hi.add(Ni.ARROW_LEFT),Hi.add(Ni.ARROW_UP),Hi.add(Ni.ARROW_RIGHT),Hi.add(Ni.ARROW_DOWN),Hi.add(Ni.DELETE),Hi.add(Ni.ESCAPE),Hi.add(Ni.TAB);var Vi=8,Ui=13,Yi=32,Zi=33,qi=34,Wi=35,Gi=36,Xi=37,Ki=38,Ji=39,Qi=40,tr=46,er=27,ir=9,rr=new Map;rr.set(Vi,Ni.BACKSPACE),rr.set(Ui,Ni.ENTER),rr.set(Yi,Ni.SPACEBAR),rr.set(Zi,Ni.PAGE_UP),rr.set(qi,Ni.PAGE_DOWN),rr.set(Wi,Ni.END),rr.set(Gi,Ni.HOME),rr.set(Xi,Ni.ARROW_LEFT),rr.set(Ki,Ni.ARROW_UP),rr.set(Ji,Ni.ARROW_RIGHT),rr.set(Qi,Ni.ARROW_DOWN),rr.set(tr,Ni.DELETE),rr.set(er,Ni.ESCAPE),rr.set(ir,Ni.TAB);var nr,ar,sr=new Set;function or(t){var e=t.key;if(Hi.has(e))return e;var i=rr.get(t.keyCode);return i||Ni.UNKNOWN}sr.add(Ni.PAGE_UP),sr.add(Ni.PAGE_DOWN),sr.add(Ni.END),sr.add(Ni.HOME),sr.add(Ni.ARROW_LEFT),sr.add(Ni.ARROW_UP),sr.add(Ni.ARROW_RIGHT),sr.add(Ni.ARROW_DOWN);var lr="mdc-list-item--activated",cr="mdc-list-item",dr="mdc-list-item--disabled",hr="mdc-list-item--selected",pr="mdc-list-item__text",ur="mdc-list-item__primary-text",mr="mdc-list";(nr={})[""+lr]="mdc-list-item--activated",nr[""+cr]="mdc-list-item",nr[""+dr]="mdc-list-item--disabled",nr[""+hr]="mdc-list-item--selected",nr[""+ur]="mdc-list-item__primary-text",nr[""+mr]="mdc-list";var fr=((ar={})[""+lr]="mdc-deprecated-list-item--activated",ar[""+cr]="mdc-deprecated-list-item",ar[""+dr]="mdc-deprecated-list-item--disabled",ar[""+hr]="mdc-deprecated-list-item--selected",ar[""+pr]="mdc-deprecated-list-item__text",ar[""+ur]="mdc-deprecated-list-item__primary-text",ar[""+mr]="mdc-deprecated-list",ar),gr={ACTION_EVENT:"MDCList:action",SELECTION_CHANGE_EVENT:"MDCList:selectionChange",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:"\n    ."+cr+" button:not(:disabled),\n    ."+cr+" a,\n    ."+fr[cr]+" button:not(:disabled),\n    ."+fr[cr]+" a\n  ",DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:"\n    ."+cr+" button:not(:disabled),\n    ."+cr+" a,\n    ."+cr+' input[type="radio"]:not(:disabled),\n    .'+cr+' input[type="checkbox"]:not(:disabled),\n    .'+fr[cr]+" button:not(:disabled),\n    ."+fr[cr]+" a,\n    ."+fr[cr]+' input[type="radio"]:not(:disabled),\n    .'+fr[cr]+' input[type="checkbox"]:not(:disabled)\n  ',RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},_r={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};const vr=(t,e)=>t-e,yr=["input","button","textarea","select"];function br(t){return t instanceof Set}const xr=t=>{const e=t===_r.UNSET_INDEX?new Set:t;return br(e)?new Set(e):new Set([e])};class wr extends vt{constructor(t){super(Object.assign(Object.assign({},wr.defaultAdapter),t)),this.isMulti_=!1,this.wrapFocus_=!1,this.isVertical_=!0,this.selectedIndex_=_r.UNSET_INDEX,this.focusedItemIndex_=_r.UNSET_INDEX,this.useActivatedClass_=!1,this.ariaCurrentAttrValue_=null}static get strings(){return gr}static get numbers(){return _r}static get defaultAdapter(){return{focusItemAtIndex:()=>{},getFocusedElementIndex:()=>0,getListItemCount:()=>0,isFocusInsideList:()=>!1,isRootFocused:()=>!1,notifyAction:()=>{},notifySelected:()=>{},getSelectedStateForElementIndex:()=>!1,setDisabledStateForElementIndex:()=>{},getDisabledStateForElementIndex:()=>!1,setSelectedStateForElementIndex:()=>{},setActivatedStateForElementIndex:()=>{},setTabIndexForElementIndex:()=>{},setAttributeForElementIndex:()=>{},getAttributeForElementIndex:()=>null}}setWrapFocus(t){this.wrapFocus_=t}setMulti(t){this.isMulti_=t;const e=this.selectedIndex_;if(t){if(!br(e)){const t=e===_r.UNSET_INDEX;this.selectedIndex_=t?new Set:new Set([e])}}else if(br(e))if(e.size){const t=Array.from(e).sort(vr);this.selectedIndex_=t[0]}else this.selectedIndex_=_r.UNSET_INDEX}setVerticalOrientation(t){this.isVertical_=t}setUseActivatedClass(t){this.useActivatedClass_=t}getSelectedIndex(){return this.selectedIndex_}setSelectedIndex(t){this.isIndexValid_(t)&&(this.isMulti_?this.setMultiSelectionAtIndex_(xr(t)):this.setSingleSelectionAtIndex_(t))}handleFocusIn(t,e){e>=0&&this.adapter.setTabIndexForElementIndex(e,0)}handleFocusOut(t,e){e>=0&&this.adapter.setTabIndexForElementIndex(e,-1),setTimeout((()=>{this.adapter.isFocusInsideList()||this.setTabindexToFirstSelectedItem_()}),0)}handleKeydown(t,e,i){const r="ArrowLeft"===or(t),n="ArrowUp"===or(t),a="ArrowRight"===or(t),s="ArrowDown"===or(t),o="Home"===or(t),l="End"===or(t),c="Enter"===or(t),d="Spacebar"===or(t);if(this.adapter.isRootFocused())return void(n||l?(t.preventDefault(),this.focusLastElement()):(s||o)&&(t.preventDefault(),this.focusFirstElement()));let h,p=this.adapter.getFocusedElementIndex();if(!(-1===p&&(p=i,p<0))){if(this.isVertical_&&s||!this.isVertical_&&a)this.preventDefaultEvent(t),h=this.focusNextElement(p);else if(this.isVertical_&&n||!this.isVertical_&&r)this.preventDefaultEvent(t),h=this.focusPrevElement(p);else if(o)this.preventDefaultEvent(t),h=this.focusFirstElement();else if(l)this.preventDefaultEvent(t),h=this.focusLastElement();else if((c||d)&&e){const e=t.target;if(e&&"A"===e.tagName&&c)return;this.preventDefaultEvent(t),this.setSelectedIndexOnAction_(p,!0)}this.focusedItemIndex_=p,void 0!==h&&(this.setTabindexAtIndex_(h),this.focusedItemIndex_=h)}}handleSingleSelection(t,e,i){t!==_r.UNSET_INDEX&&(this.setSelectedIndexOnAction_(t,e,i),this.setTabindexAtIndex_(t),this.focusedItemIndex_=t)}focusNextElement(t){let e=t+1;if(e>=this.adapter.getListItemCount()){if(!this.wrapFocus_)return t;e=0}return this.adapter.focusItemAtIndex(e),e}focusPrevElement(t){let e=t-1;if(e<0){if(!this.wrapFocus_)return t;e=this.adapter.getListItemCount()-1}return this.adapter.focusItemAtIndex(e),e}focusFirstElement(){return this.adapter.focusItemAtIndex(0),0}focusLastElement(){const t=this.adapter.getListItemCount()-1;return this.adapter.focusItemAtIndex(t),t}setEnabled(t,e){this.isIndexValid_(t)&&this.adapter.setDisabledStateForElementIndex(t,!e)}preventDefaultEvent(t){const e=`${t.target.tagName}`.toLowerCase();-1===yr.indexOf(e)&&t.preventDefault()}setSingleSelectionAtIndex_(t,e=!0){this.selectedIndex_!==t&&(this.selectedIndex_!==_r.UNSET_INDEX&&(this.adapter.setSelectedStateForElementIndex(this.selectedIndex_,!1),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(this.selectedIndex_,!1)),e&&this.adapter.setSelectedStateForElementIndex(t,!0),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(t,!0),this.setAriaForSingleSelectionAtIndex_(t),this.selectedIndex_=t,this.adapter.notifySelected(t))}setMultiSelectionAtIndex_(t,e=!0){const i=((t,e)=>{const i=Array.from(t),r=Array.from(e),n={added:[],removed:[]},a=i.sort(vr),s=r.sort(vr);let o=0,l=0;for(;o<a.length||l<s.length;){const t=a[o],e=s[l];t!==e?void 0!==t&&(void 0===e||t<e)?(n.removed.push(t),o++):void 0!==e&&(void 0===t||e<t)&&(n.added.push(e),l++):(o++,l++)}return n})(xr(this.selectedIndex_),t);if(i.removed.length||i.added.length){for(const t of i.removed)e&&this.adapter.setSelectedStateForElementIndex(t,!1),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(t,!1);for(const t of i.added)e&&this.adapter.setSelectedStateForElementIndex(t,!0),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(t,!0);this.selectedIndex_=t,this.adapter.notifySelected(t,i)}}setAriaForSingleSelectionAtIndex_(t){this.selectedIndex_===_r.UNSET_INDEX&&(this.ariaCurrentAttrValue_=this.adapter.getAttributeForElementIndex(t,gr.ARIA_CURRENT));const e=null!==this.ariaCurrentAttrValue_,i=e?gr.ARIA_CURRENT:gr.ARIA_SELECTED;this.selectedIndex_!==_r.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex_,i,"false");const r=e?this.ariaCurrentAttrValue_:"true";this.adapter.setAttributeForElementIndex(t,i,r)}setTabindexAtIndex_(t){this.focusedItemIndex_===_r.UNSET_INDEX&&0!==t?this.adapter.setTabIndexForElementIndex(0,-1):this.focusedItemIndex_>=0&&this.focusedItemIndex_!==t&&this.adapter.setTabIndexForElementIndex(this.focusedItemIndex_,-1),this.adapter.setTabIndexForElementIndex(t,0)}setTabindexToFirstSelectedItem_(){let t=0;"number"==typeof this.selectedIndex_&&this.selectedIndex_!==_r.UNSET_INDEX?t=this.selectedIndex_:br(this.selectedIndex_)&&this.selectedIndex_.size>0&&(t=Math.min(...this.selectedIndex_)),this.setTabindexAtIndex_(t)}isIndexValid_(t){if(t instanceof Set){if(!this.isMulti_)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");if(0===t.size)return!0;{let e=!1;for(const i of t)if(e=this.isIndexInRange_(i),e)break;return e}}if("number"==typeof t){if(this.isMulti_)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+t);return t===_r.UNSET_INDEX||this.isIndexInRange_(t)}return!1}isIndexInRange_(t){const e=this.adapter.getListItemCount();return t>=0&&t<e}setSelectedIndexOnAction_(t,e,i){if(this.adapter.getDisabledStateForElementIndex(t))return;let r=t;if(this.isMulti_&&(r=new Set([t])),this.isIndexValid_(r)){if(this.isMulti_)this.toggleMultiAtIndex(t,i,e);else if(e||i)this.setSingleSelectionAtIndex_(t,e);else{this.selectedIndex_===t&&this.setSingleSelectionAtIndex_(_r.UNSET_INDEX)}e&&this.adapter.notifyAction(t)}}toggleMultiAtIndex(t,e,i=!0){let r=!1;r=void 0===e?!this.adapter.getSelectedStateForElementIndex(t):e;const n=xr(this.selectedIndex_);r?n.add(t):n.delete(t),this.setMultiSelectionAtIndex_(n,i)}}const kr=t=>t.hasAttribute("mwc-list-item");function Tr(){const t=this.itemsReadyResolver;this.itemsReady=new Promise((t=>this.itemsReadyResolver=t)),t()}class Sr extends It{constructor(){super(),this.mdcAdapter=null,this.mdcFoundationClass=wr,this.activatable=!1,this.multi=!1,this.wrapFocus=!1,this.itemRoles=null,this.innerRole=null,this.innerAriaLabel=null,this.rootTabbable=!1,this.previousTabindex=null,this.noninteractive=!1,this.itemsReadyResolver=()=>{},this.itemsReady=Promise.resolve([]),this.items_=[];const t=function(t,e=50){let i;return function(r=!0){clearTimeout(i),i=setTimeout((()=>{t(r)}),e)}}(this.layout.bind(this));this.debouncedLayout=(e=!0)=>{Tr.call(this),t(e)}}async getUpdateComplete(){const t=await super.getUpdateComplete();return await this.itemsReady,t}get items(){return this.items_}updateItems(){var t;const e=null!==(t=this.assignedElements)&&void 0!==t?t:[],i=[];for(const t of e)kr(t)&&(i.push(t),t._managingList=this),t.hasAttribute("divider")&&!t.hasAttribute("role")&&t.setAttribute("role","separator");this.items_=i;const r=new Set;if(this.items_.forEach(((t,e)=>{this.itemRoles?t.setAttribute("role",this.itemRoles):t.removeAttribute("role"),t.selected&&r.add(e)})),this.multi)this.select(r);else{const t=r.size?r.entries().next().value[1]:-1;this.select(t)}const n=new Event("items-updated",{bubbles:!0,composed:!0});this.dispatchEvent(n)}get selected(){const t=this.index;if(!br(t))return-1===t?null:this.items[t];const e=[];for(const i of t)e.push(this.items[i]);return e}get index(){return this.mdcFoundation?this.mdcFoundation.getSelectedIndex():-1}render(){const t=null===this.innerRole?void 0:this.innerRole,e=null===this.innerAriaLabel?void 0:this.innerAriaLabel,i=this.rootTabbable?"0":"-1";return M`
      <!-- @ts-ignore -->
      <ul
          tabindex=${i}
          role="${Ke(t)}"
          aria-label="${Ke(e)}"
          class="mdc-deprecated-list"
          @keydown=${this.onKeydown}
          @focusin=${this.onFocusIn}
          @focusout=${this.onFocusOut}
          @request-selected=${this.onRequestSelected}
          @list-item-rendered=${this.onListItemConnected}>
        <slot></slot>
        ${this.renderPlaceholder()}
      </ul>
    `}renderPlaceholder(){var t;const e=null!==(t=this.assignedElements)&&void 0!==t?t:[];return void 0!==this.emptyMessage&&0===e.length?M`
        <mwc-list-item noninteractive>${this.emptyMessage}</mwc-list-item>
      `:null}firstUpdated(){super.firstUpdated(),this.items.length||(this.mdcFoundation.setMulti(this.multi),this.layout())}onFocusIn(t){if(this.mdcFoundation&&this.mdcRoot){const e=this.getIndexOfTarget(t);this.mdcFoundation.handleFocusIn(t,e)}}onFocusOut(t){if(this.mdcFoundation&&this.mdcRoot){const e=this.getIndexOfTarget(t);this.mdcFoundation.handleFocusOut(t,e)}}onKeydown(t){if(this.mdcFoundation&&this.mdcRoot){const e=this.getIndexOfTarget(t),i=t.target,r=kr(i);this.mdcFoundation.handleKeydown(t,r,e)}}onRequestSelected(t){if(this.mdcFoundation){let e=this.getIndexOfTarget(t);if(-1===e&&(this.layout(),e=this.getIndexOfTarget(t),-1===e))return;if(this.items[e].disabled)return;const i=t.detail.selected,r=t.detail.source;this.mdcFoundation.handleSingleSelection(e,"interaction"===r,i),t.stopPropagation()}}getIndexOfTarget(t){const e=this.items,i=t.composedPath();for(const t of i){let i=-1;if(wt(t)&&kr(t)&&(i=e.indexOf(t)),-1!==i)return i}return-1}createAdapter(){return this.mdcAdapter={getListItemCount:()=>this.mdcRoot?this.items.length:0,getFocusedElementIndex:this.getFocusedItemIndex,getAttributeForElementIndex:(t,e)=>{if(!this.mdcRoot)return"";const i=this.items[t];return i?i.getAttribute(e):""},setAttributeForElementIndex:(t,e,i)=>{if(!this.mdcRoot)return;const r=this.items[t];r&&r.setAttribute(e,i)},focusItemAtIndex:t=>{const e=this.items[t];e&&e.focus()},setTabIndexForElementIndex:(t,e)=>{const i=this.items[t];i&&(i.tabindex=e)},notifyAction:t=>{const e={bubbles:!0,composed:!0};e.detail={index:t};const i=new CustomEvent("action",e);this.dispatchEvent(i)},notifySelected:(t,e)=>{const i={bubbles:!0,composed:!0};i.detail={index:t,diff:e};const r=new CustomEvent("selected",i);this.dispatchEvent(r)},isFocusInsideList:()=>At(this),isRootFocused:()=>{const t=this.mdcRoot;return t.getRootNode().activeElement===t},setDisabledStateForElementIndex:(t,e)=>{const i=this.items[t];i&&(i.disabled=e)},getDisabledStateForElementIndex:t=>{const e=this.items[t];return!!e&&e.disabled},setSelectedStateForElementIndex:(t,e)=>{const i=this.items[t];i&&(i.selected=e)},getSelectedStateForElementIndex:t=>{const e=this.items[t];return!!e&&e.selected},setActivatedStateForElementIndex:(t,e)=>{const i=this.items[t];i&&(i.activated=e)}},this.mdcAdapter}selectUi(t,e=!1){const i=this.items[t];i&&(i.selected=!0,i.activated=e)}deselectUi(t){const e=this.items[t];e&&(e.selected=!1,e.activated=!1)}select(t){this.mdcFoundation&&this.mdcFoundation.setSelectedIndex(t)}toggle(t,e){this.multi&&this.mdcFoundation.toggleMultiAtIndex(t,e)}onListItemConnected(t){const e=t.target;this.layout(-1===this.items.indexOf(e))}layout(t=!0){t&&this.updateItems();const e=this.items[0];for(const t of this.items)t.tabindex=-1;e&&(this.noninteractive?this.previousTabindex||(this.previousTabindex=e):e.tabindex=0),this.itemsReadyResolver()}getFocusedItemIndex(){if(!this.mdcRoot)return-1;if(!this.items.length)return-1;const t=$t();if(!t.length)return-1;for(let e=t.length-1;e>=0;e--){const i=t[e];if(kr(i))return this.items.indexOf(i)}return-1}focusItemAtIndex(t){for(const t of this.items)if(0===t.tabindex){t.tabindex=-1;break}this.items[t].tabindex=0,this.items[t].focus()}focus(){const t=this.mdcRoot;t&&t.focus()}blur(){const t=this.mdcRoot;t&&t.blur()}}it([ot({type:String})],Sr.prototype,"emptyMessage",void 0),it([ht(".mdc-deprecated-list")],Sr.prototype,"mdcRoot",void 0),it([ut("",!0,"*")],Sr.prototype,"assignedElements",void 0),it([ut("",!0,'[tabindex="0"]')],Sr.prototype,"tabbableElements",void 0),it([ot({type:Boolean}),Mt((function(t){this.mdcFoundation&&this.mdcFoundation.setUseActivatedClass(t)}))],Sr.prototype,"activatable",void 0),it([ot({type:Boolean}),Mt((function(t,e){this.mdcFoundation&&this.mdcFoundation.setMulti(t),void 0!==e&&this.layout()}))],Sr.prototype,"multi",void 0),it([ot({type:Boolean}),Mt((function(t){this.mdcFoundation&&this.mdcFoundation.setWrapFocus(t)}))],Sr.prototype,"wrapFocus",void 0),it([ot({type:String}),Mt((function(t,e){void 0!==e&&this.updateItems()}))],Sr.prototype,"itemRoles",void 0),it([ot({type:String})],Sr.prototype,"innerRole",void 0),it([ot({type:String})],Sr.prototype,"innerAriaLabel",void 0),it([ot({type:Boolean})],Sr.prototype,"rootTabbable",void 0),it([ot({type:Boolean,reflect:!0}),Mt((function(t){var e,i;if(t){const t=null!==(i=null===(e=this.tabbableElements)||void 0===e?void 0:e[0])&&void 0!==i?i:null;this.previousTabindex=t,t&&t.setAttribute("tabindex","-1")}else!t&&this.previousTabindex&&(this.previousTabindex.setAttribute("tabindex","0"),this.previousTabindex=null)}))],Sr.prototype,"noninteractive",void 0);const Cr=n`@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}:host{display:block}.mdc-deprecated-list{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);line-height:1.75rem;line-height:var(--mdc-typography-subtitle1-line-height, 1.75rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:0.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);line-height:1.5rem;margin:0;padding:8px 0;list-style-type:none;color:rgba(0, 0, 0, 0.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87));padding:var(--mdc-list-vertical-padding, 8px) 0}.mdc-deprecated-list:focus{outline:none}.mdc-deprecated-list-item{height:48px}.mdc-deprecated-list--dense{padding-top:4px;padding-bottom:4px;font-size:.812rem}.mdc-deprecated-list ::slotted([divider]){height:0;margin:0;border:none;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgba(0, 0, 0, 0.12)}.mdc-deprecated-list ::slotted([divider][padded]){margin:0 var(--mdc-list-side-padding, 16px)}.mdc-deprecated-list ::slotted([divider][inset]){margin-left:var(--mdc-list-inset-margin, 72px);margin-right:0;width:calc( 100% - var(--mdc-list-inset-margin, 72px) )}[dir=rtl] .mdc-deprecated-list ::slotted([divider][inset]),.mdc-deprecated-list ::slotted([divider][inset][dir=rtl]){margin-left:0;margin-right:var(--mdc-list-inset-margin, 72px)}.mdc-deprecated-list ::slotted([divider][inset][padded]){width:calc( 100% - var(--mdc-list-inset-margin, 72px) - var(--mdc-list-side-padding, 16px) )}.mdc-deprecated-list--dense ::slotted([mwc-list-item]){height:40px}.mdc-deprecated-list--dense ::slotted([mwc-list]){--mdc-list-item-graphic-size: 20px}.mdc-deprecated-list--two-line.mdc-deprecated-list--dense ::slotted([mwc-list-item]),.mdc-deprecated-list--avatar-list.mdc-deprecated-list--dense ::slotted([mwc-list-item]){height:60px}.mdc-deprecated-list--avatar-list.mdc-deprecated-list--dense ::slotted([mwc-list]){--mdc-list-item-graphic-size: 36px}:host([noninteractive]){pointer-events:none;cursor:default}.mdc-deprecated-list--dense ::slotted(.mdc-deprecated-list-item__primary-text){display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-deprecated-list--dense ::slotted(.mdc-deprecated-list-item__primary-text)::before{display:inline-block;width:0;height:24px;content:"";vertical-align:0}.mdc-deprecated-list--dense ::slotted(.mdc-deprecated-list-item__primary-text)::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}`;let Er=class extends Sr{};Er.styles=[Cr],Er=it([at("mwc-list")],Er);var $r,Ar,Ir={ANCHOR:"mdc-menu-surface--anchor",ANIMATING_CLOSED:"mdc-menu-surface--animating-closed",ANIMATING_OPEN:"mdc-menu-surface--animating-open",FIXED:"mdc-menu-surface--fixed",IS_OPEN_BELOW:"mdc-menu-surface--is-open-below",OPEN:"mdc-menu-surface--open",ROOT:"mdc-menu-surface"},Mr={CLOSED_EVENT:"MDCMenuSurface:closed",CLOSING_EVENT:"MDCMenuSurface:closing",OPENED_EVENT:"MDCMenuSurface:opened",OPENING_EVENT:"MDCMenuSurface:opening",FOCUSABLE_ELEMENTS:["button:not(:disabled)",'[href]:not([aria-disabled="true"])',"input:not(:disabled)","select:not(:disabled)","textarea:not(:disabled)",'[tabindex]:not([tabindex="-1"]):not([aria-disabled="true"])'].join(", ")},Lr={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67,TOUCH_EVENT_WAIT_MS:30};!function(t){t[t.BOTTOM=1]="BOTTOM",t[t.CENTER=2]="CENTER",t[t.RIGHT=4]="RIGHT",t[t.FLIP_RTL=8]="FLIP_RTL"}($r||($r={})),function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=4]="TOP_RIGHT",t[t.BOTTOM_LEFT=1]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",t[t.TOP_START=8]="TOP_START",t[t.TOP_END=12]="TOP_END",t[t.BOTTOM_START=9]="BOTTOM_START",t[t.BOTTOM_END=13]="BOTTOM_END"}(Ar||(Ar={}));var Pr=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.isSurfaceOpen=!1,r.isQuickOpen=!1,r.isHoistedElement=!1,r.isFixedPosition=!1,r.isHorizontallyCenteredOnViewport=!1,r.maxHeight=0,r.openBottomBias=0,r.openAnimationEndTimerId=0,r.closeAnimationEndTimerId=0,r.animationRequestId=0,r.anchorCorner=Ar.TOP_START,r.originCorner=Ar.TOP_START,r.anchorMargin={top:0,right:0,bottom:0,left:0},r.position={x:0,y:0},r}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return Ir},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Mr},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Lr},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Corner",{get:function(){return Ar},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},hasAnchor:function(){return!1},isElementInContainer:function(){return!1},isFocused:function(){return!1},isRtl:function(){return!1},getInnerDimensions:function(){return{height:0,width:0}},getAnchorDimensions:function(){return null},getWindowDimensions:function(){return{height:0,width:0}},getBodyDimensions:function(){return{height:0,width:0}},getWindowScroll:function(){return{x:0,y:0}},setPosition:function(){},setMaxHeight:function(){},setTransformOrigin:function(){},saveFocus:function(){},restoreFocus:function(){},notifyClose:function(){},notifyClosing:function(){},notifyOpen:function(){},notifyOpening:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=e.cssClasses,i=t.ROOT,r=t.OPEN;if(!this.adapter.hasClass(i))throw new Error(i+" class required in root element.");this.adapter.hasClass(r)&&(this.isSurfaceOpen=!0)},e.prototype.destroy=function(){clearTimeout(this.openAnimationEndTimerId),clearTimeout(this.closeAnimationEndTimerId),cancelAnimationFrame(this.animationRequestId)},e.prototype.setAnchorCorner=function(t){this.anchorCorner=t},e.prototype.flipCornerHorizontally=function(){this.originCorner=this.originCorner^$r.RIGHT},e.prototype.setAnchorMargin=function(t){this.anchorMargin.top=t.top||0,this.anchorMargin.right=t.right||0,this.anchorMargin.bottom=t.bottom||0,this.anchorMargin.left=t.left||0},e.prototype.setIsHoisted=function(t){this.isHoistedElement=t},e.prototype.setFixedPosition=function(t){this.isFixedPosition=t},e.prototype.isFixed=function(){return this.isFixedPosition},e.prototype.setAbsolutePosition=function(t,e){this.position.x=this.isFinite(t)?t:0,this.position.y=this.isFinite(e)?e:0},e.prototype.setIsHorizontallyCenteredOnViewport=function(t){this.isHorizontallyCenteredOnViewport=t},e.prototype.setQuickOpen=function(t){this.isQuickOpen=t},e.prototype.setMaxHeight=function(t){this.maxHeight=t},e.prototype.setOpenBottomBias=function(t){this.openBottomBias=t},e.prototype.isOpen=function(){return this.isSurfaceOpen},e.prototype.open=function(){var t=this;this.isSurfaceOpen||(this.adapter.notifyOpening(),this.adapter.saveFocus(),this.isQuickOpen?(this.isSurfaceOpen=!0,this.adapter.addClass(e.cssClasses.OPEN),this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.notifyOpen()):(this.adapter.addClass(e.cssClasses.ANIMATING_OPEN),this.animationRequestId=requestAnimationFrame((function(){t.dimensions=t.adapter.getInnerDimensions(),t.autoposition(),t.adapter.addClass(e.cssClasses.OPEN),t.openAnimationEndTimerId=setTimeout((function(){t.openAnimationEndTimerId=0,t.adapter.removeClass(e.cssClasses.ANIMATING_OPEN),t.adapter.notifyOpen()}),Lr.TRANSITION_OPEN_DURATION)})),this.isSurfaceOpen=!0))},e.prototype.close=function(t){var i=this;if(void 0===t&&(t=!1),this.isSurfaceOpen){if(this.adapter.notifyClosing(),this.isQuickOpen)return this.isSurfaceOpen=!1,t||this.maybeRestoreFocus(),this.adapter.removeClass(e.cssClasses.OPEN),this.adapter.removeClass(e.cssClasses.IS_OPEN_BELOW),void this.adapter.notifyClose();this.adapter.addClass(e.cssClasses.ANIMATING_CLOSED),requestAnimationFrame((function(){i.adapter.removeClass(e.cssClasses.OPEN),i.adapter.removeClass(e.cssClasses.IS_OPEN_BELOW),i.closeAnimationEndTimerId=setTimeout((function(){i.closeAnimationEndTimerId=0,i.adapter.removeClass(e.cssClasses.ANIMATING_CLOSED),i.adapter.notifyClose()}),Lr.TRANSITION_CLOSE_DURATION)})),this.isSurfaceOpen=!1,t||this.maybeRestoreFocus()}},e.prototype.handleBodyClick=function(t){var e=t.target;this.adapter.isElementInContainer(e)||this.close()},e.prototype.handleKeydown=function(t){var e=t.keyCode;("Escape"===t.key||27===e)&&this.close()},e.prototype.autoposition=function(){var t;this.measurements=this.getAutoLayoutmeasurements();var i=this.getoriginCorner(),r=this.getMenuSurfaceMaxHeight(i),n=this.hasBit(i,$r.BOTTOM)?"bottom":"top",a=this.hasBit(i,$r.RIGHT)?"right":"left",s=this.getHorizontalOriginOffset(i),o=this.getVerticalOriginOffset(i),l=this.measurements,c=l.anchorSize,d=l.surfaceSize,h=((t={})[a]=s,t[n]=o,t);c.width/d.width>Lr.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(a="center"),(this.isHoistedElement||this.isFixedPosition)&&this.adjustPositionForHoistedElement(h),this.adapter.setTransformOrigin(a+" "+n),this.adapter.setPosition(h),this.adapter.setMaxHeight(r?r+"px":""),this.hasBit(i,$r.BOTTOM)||this.adapter.addClass(e.cssClasses.IS_OPEN_BELOW)},e.prototype.getAutoLayoutmeasurements=function(){var t=this.adapter.getAnchorDimensions(),e=this.adapter.getBodyDimensions(),i=this.adapter.getWindowDimensions(),r=this.adapter.getWindowScroll();return t||(t={top:this.position.y,right:this.position.x,bottom:this.position.y,left:this.position.x,width:0,height:0}),{anchorSize:t,bodySize:e,surfaceSize:this.dimensions,viewportDistance:{top:t.top,right:i.width-t.right,bottom:i.height-t.bottom,left:t.left},viewportSize:i,windowScroll:r}},e.prototype.getoriginCorner=function(){var t,i,r=this.originCorner,n=this.measurements,a=n.viewportDistance,s=n.anchorSize,o=n.surfaceSize,l=e.numbers.MARGIN_TO_EDGE;this.hasBit(this.anchorCorner,$r.BOTTOM)?(t=a.top-l+this.anchorMargin.bottom,i=a.bottom-l-this.anchorMargin.bottom):(t=a.top-l+this.anchorMargin.top,i=a.bottom-l+s.height-this.anchorMargin.top),!(i-o.height>0)&&t>i+this.openBottomBias&&(r=this.setBit(r,$r.BOTTOM));var c,d,h=this.adapter.isRtl(),p=this.hasBit(this.anchorCorner,$r.FLIP_RTL),u=this.hasBit(this.anchorCorner,$r.RIGHT)||this.hasBit(r,$r.RIGHT),m=!1;(m=h&&p?!u:u)?(c=a.left+s.width+this.anchorMargin.right,d=a.right-this.anchorMargin.right):(c=a.left+this.anchorMargin.left,d=a.right+s.width-this.anchorMargin.left);var f=c-o.width>0,g=d-o.width>0,_=this.hasBit(r,$r.FLIP_RTL)&&this.hasBit(r,$r.RIGHT);return g&&_&&h||!f&&_?r=this.unsetBit(r,$r.RIGHT):(f&&m&&h||f&&!m&&u||!g&&c>=d)&&(r=this.setBit(r,$r.RIGHT)),r},e.prototype.getMenuSurfaceMaxHeight=function(t){if(this.maxHeight>0)return this.maxHeight;var i=this.measurements.viewportDistance,r=0,n=this.hasBit(t,$r.BOTTOM),a=this.hasBit(this.anchorCorner,$r.BOTTOM),s=e.numbers.MARGIN_TO_EDGE;return n?(r=i.top+this.anchorMargin.top-s,a||(r+=this.measurements.anchorSize.height)):(r=i.bottom-this.anchorMargin.bottom+this.measurements.anchorSize.height-s,a&&(r-=this.measurements.anchorSize.height)),r},e.prototype.getHorizontalOriginOffset=function(t){var e=this.measurements.anchorSize,i=this.hasBit(t,$r.RIGHT),r=this.hasBit(this.anchorCorner,$r.RIGHT);if(i){var n=r?e.width-this.anchorMargin.left:this.anchorMargin.right;return this.isHoistedElement||this.isFixedPosition?n-(this.measurements.viewportSize.width-this.measurements.bodySize.width):n}return r?e.width-this.anchorMargin.right:this.anchorMargin.left},e.prototype.getVerticalOriginOffset=function(t){var e=this.measurements.anchorSize,i=this.hasBit(t,$r.BOTTOM),r=this.hasBit(this.anchorCorner,$r.BOTTOM);return i?r?e.height-this.anchorMargin.top:-this.anchorMargin.bottom:r?e.height+this.anchorMargin.bottom:this.anchorMargin.top},e.prototype.adjustPositionForHoistedElement=function(t){var e,i,r=this.measurements,n=r.windowScroll,a=r.viewportDistance,s=r.surfaceSize,o=r.viewportSize,l=Object.keys(t);try{for(var c=rt(l),d=c.next();!d.done;d=c.next()){var h=d.value,p=t[h]||0;!this.isHorizontallyCenteredOnViewport||"left"!==h&&"right"!==h?(p+=a[h],this.isFixedPosition||("top"===h?p+=n.y:"bottom"===h?p-=n.y:"left"===h?p+=n.x:p-=n.x),t[h]=p):t[h]=(o.width-s.width)/2}}catch(t){e={error:t}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}},e.prototype.maybeRestoreFocus=function(){var t=this,e=this.adapter.isFocused(),i=this.adapter.getOwnerDocument?this.adapter.getOwnerDocument():document,r=i.activeElement&&this.adapter.isElementInContainer(i.activeElement);(e||r)&&setTimeout((function(){t.adapter.restoreFocus()}),Lr.TOUCH_EVENT_WAIT_MS)},e.prototype.hasBit=function(t,e){return Boolean(t&e)},e.prototype.setBit=function(t,e){return t|e},e.prototype.unsetBit=function(t,e){return t^e},e.prototype.isFinite=function(t){return"number"==typeof t&&isFinite(t)},e}(vt),Rr=Pr;const zr={TOP_LEFT:Ar.TOP_LEFT,TOP_RIGHT:Ar.TOP_RIGHT,BOTTOM_LEFT:Ar.BOTTOM_LEFT,BOTTOM_RIGHT:Ar.BOTTOM_RIGHT,TOP_START:Ar.TOP_START,TOP_END:Ar.TOP_END,BOTTOM_START:Ar.BOTTOM_START,BOTTOM_END:Ar.BOTTOM_END};class Dr extends It{constructor(){super(...arguments),this.mdcFoundationClass=Rr,this.absolute=!1,this.fullwidth=!1,this.fixed=!1,this.x=null,this.y=null,this.quick=!1,this.open=!1,this.stayOpenOnBodyClick=!1,this.bitwiseCorner=Ar.TOP_START,this.previousMenuCorner=null,this.menuCorner="START",this.corner="TOP_START",this.styleTop="",this.styleLeft="",this.styleRight="",this.styleBottom="",this.styleMaxHeight="",this.styleTransformOrigin="",this.anchor=null,this.previouslyFocused=null,this.previousAnchor=null,this.onBodyClickBound=()=>{}}render(){return this.renderSurface()}renderSurface(){const t=this.getRootClasses(),e=this.getRootStyles();return M`
      <div
          class=${Ot(t)}
          style="${se(e)}"
          @keydown=${this.onKeydown}
          @opened=${this.registerBodyClick}
          @closed=${this.deregisterBodyClick}>
        ${this.renderContent()}
      </div>`}getRootClasses(){return{"mdc-menu-surface":!0,"mdc-menu-surface--fixed":this.fixed,"mdc-menu-surface--fullwidth":this.fullwidth}}getRootStyles(){return{top:this.styleTop,left:this.styleLeft,right:this.styleRight,bottom:this.styleBottom,"max-height":this.styleMaxHeight,"transform-origin":this.styleTransformOrigin}}renderContent(){return M`<slot></slot>`}createAdapter(){return Object.assign(Object.assign({},kt(this.mdcRoot)),{hasAnchor:()=>!!this.anchor,notifyClose:()=>{const t=new CustomEvent("closed",{bubbles:!0,composed:!0});this.open=!1,this.mdcRoot.dispatchEvent(t)},notifyClosing:()=>{const t=new CustomEvent("closing",{bubbles:!0,composed:!0});this.mdcRoot.dispatchEvent(t)},notifyOpen:()=>{const t=new CustomEvent("opened",{bubbles:!0,composed:!0});this.open=!0,this.mdcRoot.dispatchEvent(t)},notifyOpening:()=>{const t=new CustomEvent("opening",{bubbles:!0,composed:!0});this.mdcRoot.dispatchEvent(t)},isElementInContainer:()=>!1,isRtl:()=>!!this.mdcRoot&&"rtl"===getComputedStyle(this.mdcRoot).direction,setTransformOrigin:t=>{this.mdcRoot&&(this.styleTransformOrigin=t)},isFocused:()=>At(this),saveFocus:()=>{const t=$t(),e=t.length;e||(this.previouslyFocused=null),this.previouslyFocused=t[e-1]},restoreFocus:()=>{this.previouslyFocused&&"focus"in this.previouslyFocused&&this.previouslyFocused.focus()},getInnerDimensions:()=>{const t=this.mdcRoot;return t?{width:t.offsetWidth,height:t.offsetHeight}:{width:0,height:0}},getAnchorDimensions:()=>{const t=this.anchor;return t?t.getBoundingClientRect():null},getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:t=>{this.mdcRoot&&(this.styleLeft="left"in t?`${t.left}px`:"",this.styleRight="right"in t?`${t.right}px`:"",this.styleTop="top"in t?`${t.top}px`:"",this.styleBottom="bottom"in t?`${t.bottom}px`:"")},setMaxHeight:async t=>{this.mdcRoot&&(this.styleMaxHeight=t,await this.updateComplete,this.styleMaxHeight=`var(--mdc-menu-max-height, ${t})`)}})}onKeydown(t){this.mdcFoundation&&this.mdcFoundation.handleKeydown(t)}onBodyClick(t){if(this.stayOpenOnBodyClick)return;-1===t.composedPath().indexOf(this)&&this.close()}registerBodyClick(){this.onBodyClickBound=this.onBodyClick.bind(this),document.body.addEventListener("click",this.onBodyClickBound,{passive:!0,capture:!0})}deregisterBodyClick(){document.body.removeEventListener("click",this.onBodyClickBound,{capture:!0})}onOpenChanged(t,e){this.mdcFoundation&&(t?this.mdcFoundation.open():void 0!==e&&this.mdcFoundation.close())}close(){this.open=!1}show(){this.open=!0}}it([ht(".mdc-menu-surface")],Dr.prototype,"mdcRoot",void 0),it([ht("slot")],Dr.prototype,"slotElement",void 0),it([ot({type:Boolean}),Mt((function(t){this.mdcFoundation&&!this.fixed&&this.mdcFoundation.setIsHoisted(t)}))],Dr.prototype,"absolute",void 0),it([ot({type:Boolean})],Dr.prototype,"fullwidth",void 0),it([ot({type:Boolean}),Mt((function(t){this.mdcFoundation&&!this.absolute&&this.mdcFoundation.setFixedPosition(t)}))],Dr.prototype,"fixed",void 0),it([ot({type:Number}),Mt((function(t){this.mdcFoundation&&null!==this.y&&null!==t&&(this.mdcFoundation.setAbsolutePosition(t,this.y),this.mdcFoundation.setAnchorMargin({left:t,top:this.y,right:-t,bottom:this.y}))}))],Dr.prototype,"x",void 0),it([ot({type:Number}),Mt((function(t){this.mdcFoundation&&null!==this.x&&null!==t&&(this.mdcFoundation.setAbsolutePosition(this.x,t),this.mdcFoundation.setAnchorMargin({left:this.x,top:t,right:-this.x,bottom:t}))}))],Dr.prototype,"y",void 0),it([ot({type:Boolean}),Mt((function(t){this.mdcFoundation&&this.mdcFoundation.setQuickOpen(t)}))],Dr.prototype,"quick",void 0),it([ot({type:Boolean,reflect:!0}),Mt((function(t,e){this.onOpenChanged(t,e)}))],Dr.prototype,"open",void 0),it([ot({type:Boolean})],Dr.prototype,"stayOpenOnBodyClick",void 0),it([lt(),Mt((function(t){this.mdcFoundation&&this.mdcFoundation.setAnchorCorner(t)}))],Dr.prototype,"bitwiseCorner",void 0),it([ot({type:String}),Mt((function(t){if(this.mdcFoundation){const e="START"===t||"END"===t,i=null===this.previousMenuCorner,r=!i&&t!==this.previousMenuCorner;e&&(r||i&&"END"===t)&&(this.bitwiseCorner=this.bitwiseCorner^$r.RIGHT,this.mdcFoundation.flipCornerHorizontally(),this.previousMenuCorner=t)}}))],Dr.prototype,"menuCorner",void 0),it([ot({type:String}),Mt((function(t){if(this.mdcFoundation&&t){let e=zr[t];"END"===this.menuCorner&&(e^=$r.RIGHT),this.bitwiseCorner=e}}))],Dr.prototype,"corner",void 0),it([lt()],Dr.prototype,"styleTop",void 0),it([lt()],Dr.prototype,"styleLeft",void 0),it([lt()],Dr.prototype,"styleRight",void 0),it([lt()],Dr.prototype,"styleBottom",void 0),it([lt()],Dr.prototype,"styleMaxHeight",void 0),it([lt()],Dr.prototype,"styleTransformOrigin",void 0);const jr=n`.mdc-menu-surface{display:none;position:absolute;box-sizing:border-box;max-width:calc(100vw - 32px);max-width:var(--mdc-menu-max-width, calc(100vw - 32px));max-height:calc(100vh - 32px);max-height:var(--mdc-menu-max-height, calc(100vh - 32px));margin:0;padding:0;transform:scale(1);transform-origin:top left;opacity:0;overflow:auto;will-change:transform,opacity;z-index:8;transition:opacity .03s linear,transform .12s cubic-bezier(0, 0, 0.2, 1),height 250ms cubic-bezier(0, 0, 0.2, 1);box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2),0px 8px 10px 1px rgba(0, 0, 0, 0.14),0px 3px 14px 2px rgba(0,0,0,.12);background-color:#fff;background-color:var(--mdc-theme-surface, #fff);color:#000;color:var(--mdc-theme-on-surface, #000);border-radius:4px;border-radius:var(--mdc-shape-medium, 4px);transform-origin-left:top left;transform-origin-right:top right}.mdc-menu-surface:focus{outline:none}.mdc-menu-surface--animating-open{display:inline-block;transform:scale(0.8);opacity:0}.mdc-menu-surface--open{display:inline-block;transform:scale(1);opacity:1}.mdc-menu-surface--animating-closed{display:inline-block;opacity:0;transition:opacity .075s linear}[dir=rtl] .mdc-menu-surface,.mdc-menu-surface[dir=rtl]{transform-origin-left:top right;transform-origin-right:top left}.mdc-menu-surface--anchor{position:relative;overflow:visible}.mdc-menu-surface--fixed{position:fixed}.mdc-menu-surface--fullwidth{width:100%}:host(:not([open])){display:none}.mdc-menu-surface{z-index:8;z-index:var(--mdc-menu-z-index, 8);min-width:112px;min-width:var(--mdc-menu-min-width, 112px)}`;let Or=class extends Dr{};Or.styles=[jr],Or=it([at("mwc-menu-surface")],Or);var Br,Fr={MENU_SELECTED_LIST_ITEM:"mdc-menu-item--selected",MENU_SELECTION_GROUP:"mdc-menu__selection-group",ROOT:"mdc-menu"},Nr={ARIA_CHECKED_ATTR:"aria-checked",ARIA_DISABLED_ATTR:"aria-disabled",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",SELECTED_EVENT:"MDCMenu:selected",SKIP_RESTORE_FOCUS:"data-menu-item-skip-restore-focus"},Hr={FOCUS_ROOT_INDEX:-1};!function(t){t[t.NONE=0]="NONE",t[t.LIST_ROOT=1]="LIST_ROOT",t[t.FIRST_ITEM=2]="FIRST_ITEM",t[t.LAST_ITEM=3]="LAST_ITEM"}(Br||(Br={}));var Vr=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.closeAnimationEndTimerId=0,r.defaultFocusState=Br.LIST_ROOT,r.selectedIndex=-1,r}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return Fr},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Nr},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Hr},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},getAttributeFromElementAtIndex:function(){return null},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},notifySelected:function(){},getMenuItemCount:function(){return 0},focusItemAtIndex:function(){},focusListRoot:function(){},getSelectedSiblingOfItemAtIndex:function(){return-1},isSelectableItemAtIndex:function(){return!1}}},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.closeAnimationEndTimerId&&clearTimeout(this.closeAnimationEndTimerId),this.adapter.closeSurface()},e.prototype.handleKeydown=function(t){var e=t.key,i=t.keyCode;("Tab"===e||9===i)&&this.adapter.closeSurface(!0)},e.prototype.handleItemAction=function(t){var e=this,i=this.adapter.getElementIndex(t);if(!(i<0)){this.adapter.notifySelected({index:i});var r="true"===this.adapter.getAttributeFromElementAtIndex(i,Nr.SKIP_RESTORE_FOCUS);this.adapter.closeSurface(r),this.closeAnimationEndTimerId=setTimeout((function(){var i=e.adapter.getElementIndex(t);i>=0&&e.adapter.isSelectableItemAtIndex(i)&&e.setSelectedIndex(i)}),Pr.numbers.TRANSITION_CLOSE_DURATION)}},e.prototype.handleMenuSurfaceOpened=function(){switch(this.defaultFocusState){case Br.FIRST_ITEM:this.adapter.focusItemAtIndex(0);break;case Br.LAST_ITEM:this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount()-1);break;case Br.NONE:break;default:this.adapter.focusListRoot()}},e.prototype.setDefaultFocusState=function(t){this.defaultFocusState=t},e.prototype.getSelectedIndex=function(){return this.selectedIndex},e.prototype.setSelectedIndex=function(t){if(this.validatedIndex(t),!this.adapter.isSelectableItemAtIndex(t))throw new Error("MDCMenuFoundation: No selection group at specified index.");var e=this.adapter.getSelectedSiblingOfItemAtIndex(t);e>=0&&(this.adapter.removeAttributeFromElementAtIndex(e,Nr.ARIA_CHECKED_ATTR),this.adapter.removeClassFromElementAtIndex(e,Fr.MENU_SELECTED_LIST_ITEM)),this.adapter.addClassToElementAtIndex(t,Fr.MENU_SELECTED_LIST_ITEM),this.adapter.addAttributeToElementAtIndex(t,Nr.ARIA_CHECKED_ATTR,"true"),this.selectedIndex=t},e.prototype.setEnabled=function(t,e){this.validatedIndex(t),e?(this.adapter.removeClassFromElementAtIndex(t,dr),this.adapter.addAttributeToElementAtIndex(t,Nr.ARIA_DISABLED_ATTR,"false")):(this.adapter.addClassToElementAtIndex(t,dr),this.adapter.addAttributeToElementAtIndex(t,Nr.ARIA_DISABLED_ATTR,"true"))},e.prototype.validatedIndex=function(t){var e=this.adapter.getMenuItemCount();if(!(t>=0&&t<e))throw new Error("MDCMenuFoundation: No list item at specified index.")},e}(vt);class Ur extends It{constructor(){super(...arguments),this.mdcFoundationClass=Vr,this.listElement_=null,this.anchor=null,this.open=!1,this.quick=!1,this.wrapFocus=!1,this.innerRole="menu",this.innerAriaLabel=null,this.corner="TOP_START",this.x=null,this.y=null,this.absolute=!1,this.multi=!1,this.activatable=!1,this.fixed=!1,this.forceGroupSelection=!1,this.fullwidth=!1,this.menuCorner="START",this.stayOpenOnBodyClick=!1,this.defaultFocus="LIST_ROOT",this._listUpdateComplete=null}get listElement(){return this.listElement_||(this.listElement_=this.renderRoot.querySelector("mwc-list")),this.listElement_}get items(){const t=this.listElement;return t?t.items:[]}get index(){const t=this.listElement;return t?t.index:-1}get selected(){const t=this.listElement;return t?t.selected:null}render(){return this.renderSurface()}renderSurface(){const t=this.getSurfaceClasses();return M`
      <mwc-menu-surface
        ?hidden=${!this.open}
        .anchor=${this.anchor}
        .open=${this.open}
        .quick=${this.quick}
        .corner=${this.corner}
        .x=${this.x}
        .y=${this.y}
        .absolute=${this.absolute}
        .fixed=${this.fixed}
        .fullwidth=${this.fullwidth}
        .menuCorner=${this.menuCorner}
        ?stayOpenOnBodyClick=${this.stayOpenOnBodyClick}
        class=${Ot(t)}
        @closed=${this.onClosed}
        @opened=${this.onOpened}
        @keydown=${this.onKeydown}>
      ${this.renderList()}
    </mwc-menu-surface>`}getSurfaceClasses(){return{"mdc-menu":!0,"mdc-menu-surface":!0}}renderList(){const t="menu"===this.innerRole?"menuitem":"option",e=this.renderListClasses();return M`
      <mwc-list
          rootTabbable
          .innerAriaLabel=${this.innerAriaLabel}
          .innerRole=${this.innerRole}
          .multi=${this.multi}
          class=${Ot(e)}
          .itemRoles=${t}
          .wrapFocus=${this.wrapFocus}
          .activatable=${this.activatable}
          @action=${this.onAction}>
        <slot></slot>
      </mwc-list>`}renderListClasses(){return{"mdc-deprecated-list":!0}}createAdapter(){return{addClassToElementAtIndex:(t,e)=>{const i=this.listElement;if(!i)return;const r=i.items[t];r&&("mdc-menu-item--selected"===e?this.forceGroupSelection&&!r.selected&&i.toggle(t,!0):r.classList.add(e))},removeClassFromElementAtIndex:(t,e)=>{const i=this.listElement;if(!i)return;const r=i.items[t];r&&("mdc-menu-item--selected"===e?r.selected&&i.toggle(t,!1):r.classList.remove(e))},addAttributeToElementAtIndex:(t,e,i)=>{const r=this.listElement;if(!r)return;const n=r.items[t];n&&n.setAttribute(e,i)},removeAttributeFromElementAtIndex:(t,e)=>{const i=this.listElement;if(!i)return;const r=i.items[t];r&&r.removeAttribute(e)},getAttributeFromElementAtIndex:(t,e)=>{const i=this.listElement;if(!i)return null;const r=i.items[t];return r?r.getAttribute(e):null},elementContainsClass:(t,e)=>t.classList.contains(e),closeSurface:()=>{this.open=!1},getElementIndex:t=>{const e=this.listElement;return e?e.items.indexOf(t):-1},notifySelected:()=>{},getMenuItemCount:()=>{const t=this.listElement;return t?t.items.length:0},focusItemAtIndex:t=>{const e=this.listElement;if(!e)return;const i=e.items[t];i&&i.focus()},focusListRoot:()=>{this.listElement&&this.listElement.focus()},getSelectedSiblingOfItemAtIndex:t=>{const e=this.listElement;if(!e)return-1;const i=e.items[t];if(!i||!i.group)return-1;for(let r=0;r<e.items.length;r++){if(r===t)continue;const n=e.items[r];if(n.selected&&n.group===i.group)return r}return-1},isSelectableItemAtIndex:t=>{const e=this.listElement;if(!e)return!1;const i=e.items[t];return!!i&&i.hasAttribute("group")}}}onKeydown(t){this.mdcFoundation&&this.mdcFoundation.handleKeydown(t)}onAction(t){const e=this.listElement;if(this.mdcFoundation&&e){const i=t.detail.index,r=e.items[i];r&&this.mdcFoundation.handleItemAction(r)}}onOpened(){this.open=!0,this.mdcFoundation&&this.mdcFoundation.handleMenuSurfaceOpened()}onClosed(){this.open=!1}async getUpdateComplete(){await this._listUpdateComplete;return await super.getUpdateComplete()}async firstUpdated(){super.firstUpdated();const t=this.listElement;t&&(this._listUpdateComplete=t.updateComplete,await this._listUpdateComplete)}select(t){const e=this.listElement;e&&e.select(t)}close(){this.open=!1}show(){this.open=!0}getFocusedItemIndex(){const t=this.listElement;return t?t.getFocusedItemIndex():-1}focusItemAtIndex(t){const e=this.listElement;e&&e.focusItemAtIndex(t)}layout(t=!0){const e=this.listElement;e&&e.layout(t)}}it([ht(".mdc-menu")],Ur.prototype,"mdcRoot",void 0),it([ht("slot")],Ur.prototype,"slotElement",void 0),it([ot({type:Object})],Ur.prototype,"anchor",void 0),it([ot({type:Boolean,reflect:!0})],Ur.prototype,"open",void 0),it([ot({type:Boolean})],Ur.prototype,"quick",void 0),it([ot({type:Boolean})],Ur.prototype,"wrapFocus",void 0),it([ot({type:String})],Ur.prototype,"innerRole",void 0),it([ot({type:String})],Ur.prototype,"innerAriaLabel",void 0),it([ot({type:String})],Ur.prototype,"corner",void 0),it([ot({type:Number})],Ur.prototype,"x",void 0),it([ot({type:Number})],Ur.prototype,"y",void 0),it([ot({type:Boolean})],Ur.prototype,"absolute",void 0),it([ot({type:Boolean})],Ur.prototype,"multi",void 0),it([ot({type:Boolean})],Ur.prototype,"activatable",void 0),it([ot({type:Boolean})],Ur.prototype,"fixed",void 0),it([ot({type:Boolean})],Ur.prototype,"forceGroupSelection",void 0),it([ot({type:Boolean})],Ur.prototype,"fullwidth",void 0),it([ot({type:String})],Ur.prototype,"menuCorner",void 0),it([ot({type:Boolean})],Ur.prototype,"stayOpenOnBodyClick",void 0),it([ot({type:String}),Mt((function(t){this.mdcFoundation&&this.mdcFoundation.setDefaultFocusState(Br[t])}))],Ur.prototype,"defaultFocus",void 0);const Yr=n`mwc-list ::slotted([mwc-list-item]:not([twoline])),mwc-list ::slotted([noninteractive]:not([twoline])){height:var(--mdc-menu-item-height, 48px)}`;let Zr=class extends Ur{};Zr.styles=[Yr],Zr=it([at("mwc-menu")],Zr);class qr extends K{constructor(){super(...arguments),this.indeterminate=!1,this.progress=0,this.buffer=1,this.reverse=!1,this.closed=!1,this.stylePrimaryHalf="",this.stylePrimaryFull="",this.styleSecondaryQuarter="",this.styleSecondaryHalf="",this.styleSecondaryFull="",this.animationReady=!0,this.closedAnimationOff=!1,this.resizeObserver=null}connectedCallback(){super.connectedCallback(),this.rootEl&&this.attachResizeObserver()}render(){const t={"mdc-linear-progress--closed":this.closed,"mdc-linear-progress--closed-animation-off":this.closedAnimationOff,"mdc-linear-progress--indeterminate":this.indeterminate,"mdc-linear-progress--animation-ready":this.animationReady},e={"--mdc-linear-progress-primary-half":this.stylePrimaryHalf,"--mdc-linear-progress-primary-half-neg":""!==this.stylePrimaryHalf?`-${this.stylePrimaryHalf}`:"","--mdc-linear-progress-primary-full":this.stylePrimaryFull,"--mdc-linear-progress-primary-full-neg":""!==this.stylePrimaryFull?`-${this.stylePrimaryFull}`:"","--mdc-linear-progress-secondary-quarter":this.styleSecondaryQuarter,"--mdc-linear-progress-secondary-quarter-neg":""!==this.styleSecondaryQuarter?`-${this.styleSecondaryQuarter}`:"","--mdc-linear-progress-secondary-half":this.styleSecondaryHalf,"--mdc-linear-progress-secondary-half-neg":""!==this.styleSecondaryHalf?`-${this.styleSecondaryHalf}`:"","--mdc-linear-progress-secondary-full":this.styleSecondaryFull,"--mdc-linear-progress-secondary-full-neg":""!==this.styleSecondaryFull?`-${this.styleSecondaryFull}`:""},i={"flex-basis":this.indeterminate?"100%":100*this.buffer+"%"},r={transform:this.indeterminate?"scaleX(1)":`scaleX(${this.progress})`};return M`
      <div
          role="progressbar"
          class="mdc-linear-progress ${Ot(t)}"
          style="${se(e)}"
          dir="${Ke(this.reverse?"rtl":void 0)}"
          aria-label="${Ke(this.ariaLabel)}"
          aria-valuemin="0"
          aria-valuemax="1"
          aria-valuenow="${Ke(this.indeterminate?void 0:this.progress)}"
        @transitionend="${this.syncClosedState}">
        <div class="mdc-linear-progress__buffer">
          <div
            class="mdc-linear-progress__buffer-bar"
            style=${se(i)}>
          </div>
          <div class="mdc-linear-progress__buffer-dots"></div>
        </div>
        <div
            class="mdc-linear-progress__bar mdc-linear-progress__primary-bar"
            style=${se(r)}>
          <span class="mdc-linear-progress__bar-inner"></span>
        </div>
        <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
          <span class="mdc-linear-progress__bar-inner"></span>
        </div>
      </div>`}update(t){!t.has("closed")||this.closed&&void 0!==t.get("closed")||this.syncClosedState(),super.update(t)}async firstUpdated(t){super.firstUpdated(t),this.attachResizeObserver()}syncClosedState(){this.closedAnimationOff=this.closed}updated(t){!t.has("indeterminate")&&t.has("reverse")&&this.indeterminate&&this.restartAnimation(),t.has("indeterminate")&&void 0!==t.get("indeterminate")&&this.indeterminate&&window.ResizeObserver&&this.calculateAndSetAnimationDimensions(this.rootEl.offsetWidth),super.updated(t)}disconnectedCallback(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),super.disconnectedCallback()}attachResizeObserver(){if(window.ResizeObserver)return this.resizeObserver=new window.ResizeObserver((t=>{if(this.indeterminate)for(const e of t)if(e.contentRect){const t=e.contentRect.width;this.calculateAndSetAnimationDimensions(t)}})),void this.resizeObserver.observe(this.rootEl);this.resizeObserver=null}calculateAndSetAnimationDimensions(t){const e=.8367142*t,i=2.00611057*t,r=.37651913*t,n=.84386165*t,a=1.60277782*t;this.stylePrimaryHalf=`${e}px`,this.stylePrimaryFull=`${i}px`,this.styleSecondaryQuarter=`${r}px`,this.styleSecondaryHalf=`${n}px`,this.styleSecondaryFull=`${a}px`,this.restartAnimation()}async restartAnimation(){this.animationReady=!1,await this.updateComplete,await new Promise(requestAnimationFrame),this.animationReady=!0,await this.updateComplete}open(){this.closed=!1}close(){this.closed=!0}}it([ht(".mdc-linear-progress")],qr.prototype,"rootEl",void 0),it([ot({type:Boolean,reflect:!0})],qr.prototype,"indeterminate",void 0),it([ot({type:Number})],qr.prototype,"progress",void 0),it([ot({type:Number})],qr.prototype,"buffer",void 0),it([ot({type:Boolean,reflect:!0})],qr.prototype,"reverse",void 0),it([ot({type:Boolean,reflect:!0})],qr.prototype,"closed",void 0),it([Xe,ot({attribute:"aria-label"})],qr.prototype,"ariaLabel",void 0),it([lt()],qr.prototype,"stylePrimaryHalf",void 0),it([lt()],qr.prototype,"stylePrimaryFull",void 0),it([lt()],qr.prototype,"styleSecondaryQuarter",void 0),it([lt()],qr.prototype,"styleSecondaryHalf",void 0),it([lt()],qr.prototype,"styleSecondaryFull",void 0),it([lt()],qr.prototype,"animationReady",void 0),it([lt()],qr.prototype,"closedAnimationOff",void 0);const Wr=n`@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%);transform:translateX(var(--mdc-linear-progress-primary-half, 83.67142%))}100%{transform:translateX(200.611057%);transform:translateX(var(--mdc-linear-progress-primary-full, 200.611057%))}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%);transform:translateX(var(--mdc-linear-progress-secondary-quarter, 37.651913%))}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%);transform:translateX(var(--mdc-linear-progress-secondary-half, 84.386165%))}100%{transform:translateX(160.277782%);transform:translateX(var(--mdc-linear-progress-secondary-full, 160.277782%))}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(-10px)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(-83.67142%);transform:translateX(var(--mdc-linear-progress-primary-half-neg, -83.67142%))}100%{transform:translateX(-200.611057%);transform:translateX(var(--mdc-linear-progress-primary-full-neg, -200.611057%))}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(-37.651913%);transform:translateX(var(--mdc-linear-progress-secondary-quarter-neg, -37.651913%))}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(-84.386165%);transform:translateX(var(--mdc-linear-progress-secondary-half-neg, -84.386165%))}100%{transform:translateX(-160.277782%);transform:translateX(var(--mdc-linear-progress-secondary-full-neg, -160.277782%))}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}.mdc-linear-progress{position:relative;width:100%;transform:translateZ(0);outline:1px solid transparent;overflow:hidden;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}@media screen and (forced-colors: active){.mdc-linear-progress{outline-color:CanvasText}}.mdc-linear-progress__bar{position:absolute;width:100%;height:100%;animation:none;transform-origin:top left;transition:transform 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top-style:solid}.mdc-linear-progress__buffer{display:flex;position:absolute;width:100%;height:100%}.mdc-linear-progress__buffer-dots{background-repeat:repeat-x;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering 250ms infinite linear}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress__secondary-bar{display:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;display:block}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation:mdc-linear-progress-primary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation:mdc-linear-progress-secondary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress:not([dir=ltr]) .mdc-linear-progress__bar,.mdc-linear-progress[dir=rtl]:not([dir=ltr]) .mdc-linear-progress__bar{right:0;-webkit-transform-origin:center right;transform-origin:center right}[dir=rtl] .mdc-linear-progress:not([dir=ltr]).mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar,.mdc-linear-progress[dir=rtl]:not([dir=ltr]).mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress:not([dir=ltr]).mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar,.mdc-linear-progress[dir=rtl]:not([dir=ltr]).mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress:not([dir=ltr]) .mdc-linear-progress__buffer-dots,.mdc-linear-progress[dir=rtl]:not([dir=ltr]) .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse 250ms infinite linear;transform:rotate(0)}[dir=rtl] .mdc-linear-progress:not([dir=ltr]).mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar,.mdc-linear-progress[dir=rtl]:not([dir=ltr]).mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}[dir=rtl] .mdc-linear-progress:not([dir=ltr]).mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar,.mdc-linear-progress[dir=rtl]:not([dir=ltr]).mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}.mdc-linear-progress--closed{opacity:0}.mdc-linear-progress--closed-animation-off .mdc-linear-progress__buffer-dots{animation:none}.mdc-linear-progress--closed-animation-off.mdc-linear-progress--indeterminate .mdc-linear-progress__bar,.mdc-linear-progress--closed-animation-off.mdc-linear-progress--indeterminate .mdc-linear-progress__bar .mdc-linear-progress__bar-inner{animation:none}.mdc-linear-progress__bar-inner{border-color:#6200ee;border-color:var(--mdc-theme-primary, #6200ee)}.mdc-linear-progress__buffer-dots{background-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='%23e6e6e6'/%3E%3C/svg%3E")}.mdc-linear-progress__buffer-bar{background-color:#e6e6e6}.mdc-linear-progress{height:4px}.mdc-linear-progress__bar-inner{border-top-width:4px}.mdc-linear-progress__buffer-dots{background-size:10px 4px}:host{display:block}.mdc-linear-progress__buffer-bar{background-color:#e6e6e6;background-color:var(--mdc-linear-progress-buffer-color, #e6e6e6)}.mdc-linear-progress__buffer-dots{background-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='%23e6e6e6'/%3E%3C/svg%3E");background-image:var(--mdc-linear-progress-buffering-dots-image, url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='%23e6e6e6'/%3E%3C/svg%3E"))}`;let Gr=class extends qr{};Gr.styles=[Wr],Gr=it([at("mwc-linear-progress")],Gr);var Xr={CLOSING:"mdc-snackbar--closing",OPEN:"mdc-snackbar--open",OPENING:"mdc-snackbar--opening"},Kr={ACTION_SELECTOR:".mdc-snackbar__action",ARIA_LIVE_LABEL_TEXT_ATTR:"data-mdc-snackbar-label-text",CLOSED_EVENT:"MDCSnackbar:closed",CLOSING_EVENT:"MDCSnackbar:closing",DISMISS_SELECTOR:".mdc-snackbar__dismiss",LABEL_SELECTOR:".mdc-snackbar__label",OPENED_EVENT:"MDCSnackbar:opened",OPENING_EVENT:"MDCSnackbar:opening",REASON_ACTION:"action",REASON_DISMISS:"dismiss",SURFACE_SELECTOR:".mdc-snackbar__surface"},Jr={DEFAULT_AUTO_DISMISS_TIMEOUT_MS:5e3,INDETERMINATE:-1,MAX_AUTO_DISMISS_TIMEOUT_MS:1e4,MIN_AUTO_DISMISS_TIMEOUT_MS:4e3,SNACKBAR_ANIMATION_CLOSE_TIME_MS:75,SNACKBAR_ANIMATION_OPEN_TIME_MS:150,ARIA_LIVE_DELAY_MS:1e3},Qr=Xr.OPENING,tn=Xr.OPEN,en=Xr.CLOSING,rn=Kr.REASON_ACTION,nn=Kr.REASON_DISMISS,an=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.opened=!1,r.animationFrame=0,r.animationTimer=0,r.autoDismissTimer=0,r.autoDismissTimeoutMs=Jr.DEFAULT_AUTO_DISMISS_TIMEOUT_MS,r.closeOnEscape=!0,r}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return Xr},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Kr},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Jr},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},announce:function(){},notifyClosed:function(){},notifyClosing:function(){},notifyOpened:function(){},notifyOpening:function(){},removeClass:function(){}}},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.clearAutoDismissTimer(),cancelAnimationFrame(this.animationFrame),this.animationFrame=0,clearTimeout(this.animationTimer),this.animationTimer=0,this.adapter.removeClass(Qr),this.adapter.removeClass(tn),this.adapter.removeClass(en)},e.prototype.open=function(){var t=this;this.clearAutoDismissTimer(),this.opened=!0,this.adapter.notifyOpening(),this.adapter.removeClass(en),this.adapter.addClass(Qr),this.adapter.announce(),this.runNextAnimationFrame((function(){t.adapter.addClass(tn),t.animationTimer=setTimeout((function(){var e=t.getTimeoutMs();t.handleAnimationTimerEnd(),t.adapter.notifyOpened(),e!==Jr.INDETERMINATE&&(t.autoDismissTimer=setTimeout((function(){t.close(nn)}),e))}),Jr.SNACKBAR_ANIMATION_OPEN_TIME_MS)}))},e.prototype.close=function(t){var e=this;void 0===t&&(t=""),this.opened&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=0,this.clearAutoDismissTimer(),this.opened=!1,this.adapter.notifyClosing(t),this.adapter.addClass(Xr.CLOSING),this.adapter.removeClass(Xr.OPEN),this.adapter.removeClass(Xr.OPENING),clearTimeout(this.animationTimer),this.animationTimer=setTimeout((function(){e.handleAnimationTimerEnd(),e.adapter.notifyClosed(t)}),Jr.SNACKBAR_ANIMATION_CLOSE_TIME_MS))},e.prototype.isOpen=function(){return this.opened},e.prototype.getTimeoutMs=function(){return this.autoDismissTimeoutMs},e.prototype.setTimeoutMs=function(t){var e=Jr.MIN_AUTO_DISMISS_TIMEOUT_MS,i=Jr.MAX_AUTO_DISMISS_TIMEOUT_MS;if(!(t===Jr.INDETERMINATE||t<=i&&t>=e))throw new Error("\n        timeoutMs must be an integer in the range "+e+""+i+"\n        (or "+Jr.INDETERMINATE+" to disable), but got '"+t+"'");this.autoDismissTimeoutMs=t},e.prototype.getCloseOnEscape=function(){return this.closeOnEscape},e.prototype.setCloseOnEscape=function(t){this.closeOnEscape=t},e.prototype.handleKeyDown=function(t){("Escape"===t.key||27===t.keyCode)&&this.getCloseOnEscape()&&this.close(nn)},e.prototype.handleActionButtonClick=function(t){this.close(rn)},e.prototype.handleActionIconClick=function(t){this.close(nn)},e.prototype.clearAutoDismissTimer=function(){clearTimeout(this.autoDismissTimer),this.autoDismissTimer=0},e.prototype.handleAnimationTimerEnd=function(){this.animationTimer=0,this.adapter.removeClass(Xr.OPENING),this.adapter.removeClass(Xr.CLOSING)},e.prototype.runNextAnimationFrame=function(t){var e=this;cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame((function(){e.animationFrame=0,clearTimeout(e.animationTimer),e.animationTimer=setTimeout(t,0)}))},e}(vt);const sn=(t,e)=>{var i,r;const n=t._$AN;if(void 0===n)return!1;for(const t of n)null===(r=(i=t)._$AO)||void 0===r||r.call(i,e,!1),sn(t,e);return!0},on=t=>{let e,i;do{if(void 0===(e=t._$AM))break;i=e._$AN,i.delete(t),t=e}while(0===(null==i?void 0:i.size))},ln=t=>{for(let e;e=t._$AM;t=e){let i=e._$AN;if(void 0===i)e._$AN=i=new Set;else if(i.has(t))break;i.add(t),hn(e)}};function cn(t){void 0!==this._$AN?(on(this),this._$AM=t,ln(this)):this._$AM=t}function dn(t,e=!1,i=0){const r=this._$AH,n=this._$AN;if(void 0!==n&&0!==n.size)if(e)if(Array.isArray(r))for(let t=i;t<r.length;t++)sn(r[t],!1),on(r[t]);else null!=r&&(sn(r,!1),on(r));else sn(this,t)}const hn=t=>{var e,i,r,n;t.type==Pt&&(null!==(e=(r=t)._$AP)&&void 0!==e||(r._$AP=dn),null!==(i=(n=t)._$AQ)&&void 0!==i||(n._$AQ=cn))};class pn extends jt{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,e,i){super._$AT(t,e,i),ln(this),this.isConnected=t._$AU}_$AO(t,e=!0){var i,r;t!==this.isConnected&&(this.isConnected=t,t?null===(i=this.reconnected)||void 0===i||i.call(this):null===(r=this.disconnected)||void 0===r||r.call(this)),e&&(sn(this,t),on(this))}setValue(t){if(Ei(this._$Ct))this._$Ct._$AI(t,this);else{const e=[...this._$Ct._$AH];e[this._$Ci]=t,this._$Ct._$AI(e,this,0)}}disconnected(){}reconnected(){}}const{ARIA_LIVE_DELAY_MS:un}=an.numbers;const mn=Dt(class extends pn{constructor(t){if(super(t),this.labelEl=null,this.timerId=null,this.previousPart=null,t.type!==Pt)throw new Error("AccessibleSnackbarLabel only supports child parts.")}update(t,[e,i]){var r;if(!i)return;if(null===this.labelEl){const i=document.createElement("div"),n=M`<div class="mdc-snackbar__label" role="status" aria-live="polite"></div>`;D(n,i);const a=i.firstElementChild;return a.textContent=e,null===(r=t.endNode)||void 0===r||r.parentNode.insertBefore(a,t.endNode),this.labelEl=a,a}const n=this.labelEl;n.setAttribute("aria-live","off"),n.textContent="";const a=document.createElement("span");return a.style.display="inline-block",a.style.width="0",a.style.height="1px",a.textContent="",n.appendChild(a),n.setAttribute("data-mdc-snackbar-label-text",e),null!==this.timerId&&clearTimeout(this.timerId),this.timerId=window.setTimeout((()=>{this.timerId=null,n.setAttribute("aria-live","polite"),n.removeAttribute("data-mdc-snackbar-label-text"),n.textContent=e,this.setValue(this.labelEl)}),un),n}render(t,e){return e?M`
      <div class="mdc-snackbar__label" role="status" aria-live="polite">${t}</div>`:M``}}),{OPENING_EVENT:fn,OPENED_EVENT:gn,CLOSING_EVENT:_n,CLOSED_EVENT:vn}=an.strings;class yn extends It{constructor(){super(...arguments),this.mdcFoundationClass=an,this.open=!1,this.timeoutMs=5e3,this.closeOnEscape=!1,this.labelText="",this.stacked=!1,this.leading=!1,this.reason=""}render(){const t={"mdc-snackbar--stacked":this.stacked,"mdc-snackbar--leading":this.leading};return M`
      <div class="mdc-snackbar ${Ot(t)}" @keydown="${this._handleKeydown}">
        <div class="mdc-snackbar__surface">
          ${mn(this.labelText,this.open)}
          <div class="mdc-snackbar__actions">
            <slot name="action" @click="${this._handleActionClick}"></slot>
            <slot name="dismiss" @click="${this._handleDismissClick}"></slot>
          </div>
        </div>
      </div>`}createAdapter(){return Object.assign(Object.assign({},kt(this.mdcRoot)),{announce:()=>{},notifyClosed:t=>{this.dispatchEvent(new CustomEvent(vn,{bubbles:!0,cancelable:!0,detail:{reason:t}}))},notifyClosing:t=>{this.open=!1,this.dispatchEvent(new CustomEvent(_n,{bubbles:!0,cancelable:!0,detail:{reason:t}}))},notifyOpened:()=>{this.dispatchEvent(new CustomEvent(gn,{bubbles:!0,cancelable:!0}))},notifyOpening:()=>{this.open=!0,this.dispatchEvent(new CustomEvent(fn,{bubbles:!0,cancelable:!0}))}})}show(){this.open=!0}close(t=""){this.reason=t,this.open=!1}firstUpdated(){super.firstUpdated(),this.open&&this.mdcFoundation.open()}_handleKeydown(t){this.mdcFoundation.handleKeyDown(t)}_handleActionClick(t){this.mdcFoundation.handleActionButtonClick(t)}_handleDismissClick(t){this.mdcFoundation.handleActionIconClick(t)}}it([ht(".mdc-snackbar")],yn.prototype,"mdcRoot",void 0),it([ht(".mdc-snackbar__label")],yn.prototype,"labelElement",void 0),it([ot({type:Boolean,reflect:!0}),Mt((function(t){this.mdcFoundation&&(t?this.mdcFoundation.open():(this.mdcFoundation.close(this.reason),this.reason=""))}))],yn.prototype,"open",void 0),it([Mt((function(t){this.mdcFoundation.setTimeoutMs(t)})),ot({type:Number})],yn.prototype,"timeoutMs",void 0),it([Mt((function(t){this.mdcFoundation.setCloseOnEscape(t)})),ot({type:Boolean})],yn.prototype,"closeOnEscape",void 0),it([ot({type:String})],yn.prototype,"labelText",void 0),it([ot({type:Boolean})],yn.prototype,"stacked",void 0),it([ot({type:Boolean})],yn.prototype,"leading",void 0);const bn=n`.mdc-snackbar{z-index:8;margin:8px;display:none;position:fixed;right:0;bottom:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;pointer-events:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-snackbar__surface{background-color:#333333}.mdc-snackbar__label{color:rgba(255, 255, 255, 0.87)}.mdc-snackbar__surface{min-width:344px}@media(max-width: 480px),(max-width: 344px){.mdc-snackbar__surface{min-width:100%}}.mdc-snackbar__surface{max-width:672px}.mdc-snackbar__surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2),0px 6px 10px 0px rgba(0, 0, 0, 0.14),0px 1px 18px 0px rgba(0,0,0,.12)}.mdc-snackbar__surface{border-radius:4px;border-radius:var(--mdc-shape-small, 4px)}.mdc-snackbar--opening,.mdc-snackbar--open,.mdc-snackbar--closing{display:flex}.mdc-snackbar--open .mdc-snackbar__label,.mdc-snackbar--open .mdc-snackbar__actions{visibility:visible}.mdc-snackbar--leading{justify-content:flex-start}.mdc-snackbar--stacked .mdc-snackbar__label{padding-left:16px;padding-right:8px;padding-bottom:12px}[dir=rtl] .mdc-snackbar--stacked .mdc-snackbar__label,.mdc-snackbar--stacked .mdc-snackbar__label[dir=rtl]{padding-left:8px;padding-right:16px}.mdc-snackbar--stacked .mdc-snackbar__surface{flex-direction:column;align-items:flex-start}.mdc-snackbar--stacked .mdc-snackbar__actions{align-self:flex-end;margin-bottom:8px}.mdc-snackbar__surface{padding-left:0;padding-right:8px;display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;transform:scale(0.8);opacity:0}.mdc-snackbar__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid transparent;border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-snackbar__surface::before{border-color:CanvasText}}[dir=rtl] .mdc-snackbar__surface,.mdc-snackbar__surface[dir=rtl]{padding-left:8px;padding-right:0}.mdc-snackbar--open .mdc-snackbar__surface{transform:scale(1);opacity:1;pointer-events:auto;transition:opacity 150ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-snackbar--closing .mdc-snackbar__surface{transform:scale(1);transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-snackbar__label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-body2-font-size, 0.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:0.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, 0.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit);padding-left:16px;padding-right:8px;width:100%;flex-grow:1;box-sizing:border-box;margin:0;visibility:hidden;padding-top:14px;padding-bottom:14px}[dir=rtl] .mdc-snackbar__label,.mdc-snackbar__label[dir=rtl]{padding-left:8px;padding-right:16px}.mdc-snackbar__label::before{display:inline;content:attr(data-mdc-snackbar-label-text)}.mdc-snackbar__actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box;visibility:hidden}.mdc-snackbar__action:not(:disabled){color:#bb86fc}.mdc-snackbar__action .mdc-button__ripple::before,.mdc-snackbar__action .mdc-button__ripple::after{background-color:#bb86fc;background-color:var(--mdc-ripple-color, #bb86fc)}.mdc-snackbar__action:hover .mdc-button__ripple::before,.mdc-snackbar__action.mdc-ripple-surface--hover .mdc-button__ripple::before{opacity:0.08;opacity:var(--mdc-ripple-hover-opacity, 0.08)}.mdc-snackbar__action.mdc-ripple-upgraded--background-focused .mdc-button__ripple::before,.mdc-snackbar__action:not(.mdc-ripple-upgraded):focus .mdc-button__ripple::before{transition-duration:75ms;opacity:0.24;opacity:var(--mdc-ripple-focus-opacity, 0.24)}.mdc-snackbar__action:not(.mdc-ripple-upgraded) .mdc-button__ripple::after{transition:opacity 150ms linear}.mdc-snackbar__action:not(.mdc-ripple-upgraded):active .mdc-button__ripple::after{transition-duration:75ms;opacity:0.24;opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-snackbar__action.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-snackbar__dismiss{color:rgba(255, 255, 255, 0.87)}.mdc-snackbar__dismiss .mdc-icon-button__ripple::before,.mdc-snackbar__dismiss .mdc-icon-button__ripple::after{background-color:rgba(255, 255, 255, 0.87);background-color:var(--mdc-ripple-color, rgba(255, 255, 255, 0.87))}.mdc-snackbar__dismiss:hover .mdc-icon-button__ripple::before,.mdc-snackbar__dismiss.mdc-ripple-surface--hover .mdc-icon-button__ripple::before{opacity:0.08;opacity:var(--mdc-ripple-hover-opacity, 0.08)}.mdc-snackbar__dismiss.mdc-ripple-upgraded--background-focused .mdc-icon-button__ripple::before,.mdc-snackbar__dismiss:not(.mdc-ripple-upgraded):focus .mdc-icon-button__ripple::before{transition-duration:75ms;opacity:0.24;opacity:var(--mdc-ripple-focus-opacity, 0.24)}.mdc-snackbar__dismiss:not(.mdc-ripple-upgraded) .mdc-icon-button__ripple::after{transition:opacity 150ms linear}.mdc-snackbar__dismiss:not(.mdc-ripple-upgraded):active .mdc-icon-button__ripple::after{transition-duration:75ms;opacity:0.24;opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-snackbar__dismiss.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-snackbar__dismiss.mdc-snackbar__dismiss{width:36px;height:36px;padding:6px;font-size:18px}.mdc-snackbar__dismiss.mdc-snackbar__dismiss .mdc-icon-button__focus-ring{display:none}.mdc-snackbar__dismiss.mdc-snackbar__dismiss.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-snackbar__dismiss.mdc-snackbar__dismiss:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block;max-height:36px;max-width:36px}@media screen and (forced-colors: active){.mdc-snackbar__dismiss.mdc-snackbar__dismiss.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-snackbar__dismiss.mdc-snackbar__dismiss:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{pointer-events:none;border:2px solid transparent;border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}}@media screen and (forced-colors: active)and (forced-colors: active){.mdc-snackbar__dismiss.mdc-snackbar__dismiss.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-snackbar__dismiss.mdc-snackbar__dismiss:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-snackbar__dismiss.mdc-snackbar__dismiss.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring::after,.mdc-snackbar__dismiss.mdc-snackbar__dismiss:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring::after{content:"";border:2px solid transparent;border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}}@media screen and (forced-colors: active)and (forced-colors: active){.mdc-snackbar__dismiss.mdc-snackbar__dismiss.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring::after,.mdc-snackbar__dismiss.mdc-snackbar__dismiss:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-snackbar__dismiss.mdc-snackbar__dismiss.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:36px;height:36px;margin-top:0px;margin-bottom:0px;margin-right:0px;margin-left:0px}.mdc-snackbar__dismiss.mdc-snackbar__dismiss.mdc-icon-button--reduced-size.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-snackbar__dismiss.mdc-snackbar__dismiss.mdc-icon-button--reduced-size:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{max-height:36px;max-width:36px}.mdc-snackbar__dismiss.mdc-snackbar__dismiss .mdc-icon-button__touch{position:absolute;top:50%;height:36px;left:50%;width:36px;transform:translate(-50%, -50%)}.mdc-snackbar__action+.mdc-snackbar__dismiss{margin-left:8px;margin-right:0}[dir=rtl] .mdc-snackbar__action+.mdc-snackbar__dismiss,.mdc-snackbar__action+.mdc-snackbar__dismiss[dir=rtl]{margin-left:0;margin-right:8px}slot[name=action]::slotted(mwc-button){--mdc-theme-primary: var( --mdc-snackbar-action-color, #bb86fc )}slot[name=dismiss]::slotted(mwc-icon-button){--mdc-icon-size: 18px;--mdc-icon-button-size: 36px;color:rgba(255, 255, 255, 0.87);margin-left:8px;margin-right:0}[dir=rtl] slot[name=dismiss]::slotted(mwc-icon-button),::slotted(mwc-icon-buttonslot[name=dismiss][dir=rtl]){margin-left:0;margin-right:8px}`;let xn=class extends yn{};function wn(t){this.message=t}xn.styles=[bn],xn=it([at("mwc-snackbar")],xn),wn.prototype=new Error,wn.prototype.name="InvalidCharacterError";var kn="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new wn("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,r,n=0,a=0,s="";r=e.charAt(a++);~r&&(i=n%4?64*i+r:r,n++%4)?s+=String.fromCharCode(255&i>>(-2*n&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return s};function Tn(t){this.message=t}function Sn(t,e){if("string"!=typeof t)throw new Tn("Invalid token specified");var i=!0===(e=e||{}).header?0:1;try{return JSON.parse(function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(t){return decodeURIComponent(kn(t).replace(/(.)/g,(function(t,e){var i=e.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i})))}(e)}catch(t){return kn(e)}}(t.split(".")[i]))}catch(t){throw new Tn("Invalid token specified: "+t.message)}}Tn.prototype=new Error,Tn.prototype.name="InvalidTokenError";const Cn="";function En(){localStorage.removeItem("access_token"),localStorage.removeItem("access_token_expires"),localStorage.removeItem("refresh_token"),window.dispatchEvent(new CustomEvent("user:loggedout",{bubbles:!0,composed:!0}))}function $n(t,e){localStorage.setItem("access_token",t),localStorage.setItem("access_token_expires",e)}function An(){const t=localStorage.getItem("access_token");let e={};try{e=Sn(t)||{}}catch{e={}}return e.tree}function In(){const t=localStorage.getItem("access_token");if(!t||"1"===t)return null;try{return(Sn(t)||{}).permissions||{}}catch(t){return{}}}function Mn(){try{const t=localStorage.getItem("grampsjs_settings"),e=JSON.parse(t)||{},i=localStorage.getItem("grampsjs_settings_tree"),r=An()||"unknown",n=JSON.parse(i)?.[r]||{};return{...e,...n}}catch(t){return{}}}function Ln(t,e=!1){const i=e?"grampsjs_settings_tree":"grampsjs_settings",r=localStorage.getItem(i),n=JSON.parse(r)||{},a=An()||"unknown",s={...e?n?.[a]:n,...t},o=e?{[a]:s}:s;localStorage.setItem(i,JSON.stringify(o)),window.dispatchEvent(new CustomEvent("settings:changed",{bubbles:!0,composed:!0}))}function Pn(t){const e=An(),i=e?{[e]:t}:t,r=JSON.stringify(i);localStorage.setItem("recentObjects",r)}function Rn(){try{const t=localStorage.getItem("chatMessages"),e=JSON.parse(t),i=An();return i?e[i]:[]}catch(t){return[]}}function zn(t){const e=An();if(!e)return;const i=localStorage.getItem("chatMessages"),r={...JSON.parse(i),...{[e]:t}},n=JSON.stringify(r);localStorage.setItem("chatMessages",n)}async function Dn(t,e){try{const r=await fetch(`${Cn}/api/token/`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,password:e})});if(401===r.status||403===r.status)throw new Error("Wrong username or password");if(200!==r.status)throw new Error(r.statusText||`Error ${r.status}`);const n=await r.json();if(void 0===n.access_token)return{error:"Access token missing in response"};if(void 0===n.refresh_token)return{error:"Refresh token missing in response"};const a=Date.now()+9e5;return $n(n.access_token,a),i=n.refresh_token,localStorage.setItem("refresh_token",i),{}}catch(t){return{error:t.message}}var i}async function jn(t=3){const e=localStorage.getItem("refresh_token");if(null===e)return{error:"No refresh token found!"};try{const i=await fetch(`${Cn}/api/token/refresh/`,{method:"POST",headers:{Authorization:`Bearer ${e}`,Accept:"application/json","Content-Type":"application/json"}});if(403===i.status||422===i.status)throw En(),new Error("Failed refreshing token");if(429===i.status&&t>0)return await new Promise((t=>setTimeout(t,1e3))),jn(t-1);const r=await i.json();if(void 0===r.access_token)throw new Error("Access token missing in response");const n=Date.now()+9e5;return $n(r.access_token,n),{}}catch(t){return{error:t.message}}}async function On(t,e=!0){const i=localStorage.getItem("access_token");let r={};null!==i&&(r={Authorization:`Bearer ${i}`});try{const i=await fetch(`${Cn}${t}`,{method:"GET",headers:r});let n;try{n=await i.json()}catch(t){n={}}if(401===i.status){if(null===localStorage.getItem("refresh_token"))throw new Error("Missing refresh token");const i=await jn();if("error"in i)throw new Error(i.error);return On(t,e)}if(403===i.status)throw new Error("Authorization error");if(200!==i.status)throw new Error(n?.error?.message||i.statusText||`Error ${i.status}`);return e?{data:n,total_count:i.headers.get("X-Total-Count"),etag:i.headers.get("ETag")}:{data:await i.text()}}catch(t){return t instanceof TypeError?{error:"Network error"}:{error:t.message}}}async function Bn(t,e,i,r=!0,n=!0,a=!1){const s=localStorage.getItem("access_token"),o={Accept:"application/json"};null!==s&&(o.Authorization=`Bearer ${s}`),r&&(o["Content-Type"]="application/json");try{const s=await fetch(`${Cn}${e}`,{method:t,headers:o,body:r?JSON.stringify(i):i});let l;try{l=await s.json()}catch(t){l={}}if(401===s.status){if(a)throw new Error(l.message);if(null===localStorage.getItem("refresh_token"))throw new Error("Missing refresh token");const s=await jn();if("error"in s)throw new Error(s.error);return Bn(t,e,i,r,n)}if(403===s.status)throw new Error("Not authorized");if(201!==s.status&&200!==s.status&&202!==s.status)throw new Error(l?.error?.message||s.statusText||`Error ${s.status}`);return n&&window.dispatchEvent(new CustomEvent("db:changed",{bubbles:!0,composed:!0})),202===s.status&&"task"in l?l:{data:l,total_count:s.headers.get("X-Total-Count"),etag:s.headers.get("ETag")}}catch(t){return{error:t.message}}}async function Fn(t,e,i=!0,r=!0){return Bn("PUT",t,e,i,r)}async function Nn(t,e,i=!0,r=!0,n=!1){return Bn("POST",t,e,i,r,n)}function Hn(t){const e=localStorage.getItem("access_token");return`${Cn}${t}?jwt=${e}`}function Vn(t,e=!1){const i=localStorage.getItem("access_token");if(null===i){const i=`${Cn}/api/media/${t}/file`;return e?`${i}?download=1`:i}const r=`${Cn}/api/media/${t}/file?jwt=${i}`;return e?`${r}&download=1`:r}function Un(t,e,i=!1){const r=localStorage.getItem("access_token");return null===r?`${Cn}/api/media/${t}/thumbnail/${e}?square=${i}`:`${Cn}/api/media/${t}/thumbnail/${e}?jwt=${r}&square=${i}`}function Yn(t,e,i,r=!1){const n=localStorage.getItem("access_token"),[a,s,o,l]=e;return null===n?`${Cn}/api/media/${t}/cropped/${a}/${s}/${o}/${l}/thumbnail/${i}?square=${r}`:`${Cn}/api/media/${t}/cropped/${a}/${s}/${o}/${l}/thumbnail/${i}?jwt=${n}&square=${r}`}async function Zn(t){return(await On(`/api/tasks/${t}`)).data}async function qn(t,e,i=1e3,r=1/0){const n=["FAILURE","REVOKED","SUCCESS"];let a=0,s={};for(;!n.includes(s.state)&&a<r;)s=await Zn(t),e(s),await new Promise((t=>setTimeout(t,i))),a+=1}function Wn(){try{const t=localStorage.getItem("bookmarks"),e=JSON.parse(t),i=An();return i?e[i]:{}}catch(t){return{}}}function Gn(){try{const t=localStorage.getItem("bookmarks");return JSON.parse(t)??{}}catch(t){return{}}}function Xn(){try{const t=localStorage.getItem("tasks");return JSON.parse(t)??{}}catch(t){return{}}}function Kn(t,e){const i=An(),r=Xn();if(r?.[i]?.[t]===e){delete r[i][t];const e=JSON.stringify(r);localStorage.setItem("tasks",e)}}const Jn=["ar","bg","br","ca","cs","da","de_AT","de","el","en_GB","en","eo","es","fi","fr","ga","he","hr","hu","is","it","ja","ko","lt","lv","mk","nb","nl","nn","pl","pt_BR","pt_PT","ro","ru","sk","sl","sq","sr","sv","ta","tr","uk","vi","zh_CN","zh_HK","zh_TW"],Qn={};async function ta(t){if(!(t in Qn)&&Jn.includes(t)){const e=await fetch(`/lang/${t}.json`);try{Qn[t]=await e.json()}catch{}}return Qn[t]??{}}const ea=["_Back","_Bookmarks","_Delete","_Generate","_Media Type:","_Names","_Reports","_Save","Abbreviation","Abort changes?","About","Above the name","Add a new event","Add a new media object","Add an existing person as a child of the family","Add an existing repository","Add existing child to family","Add","Added","Address Note","Addresses","Adopted people","Adopted","Adult Christening","After","Age at death","Age","Agency","Ahnentafel Report","Aide","Album","Also Known As","Alternate Marriage","Ancestor Tree","and","Annulment","Apply","Archive","Association Note","Association","Associations","Attribute Note","Attributes","Audio","Author","Baptism","Bar Mitzvah","Bas Mitzvah","Before","between","Birth Date","Birth Date","Birth Name","Birth Place","Birth year","Birth","Birthday and Anniversary Report","Blessing","Bold","Book","Bookstore","Borough","Both","Bottom paper margin","Bride","Building","Burial","Calculated","Calendar","Call name","Call Number","Cancel","Card","Caste","Cause Of Death","Cause","Celebrant","Cemetery","Census","Check and Repair Database","Check and Repair","Check if a separate section is required.","Check Integrity","Child Reference Note","Children","Christening","Church","Citation","Citations having <count> notes","Citations with <count> media","Citations","City","Civil Union","Clear","Clergy","Collection","Color","Complete Individual Report","Complete","Con_fidence","Confidence:","Confidence","Confirmation","Connector","Country","Counts number of ancestors of selected person","County","Create and add a new note","Cremation","CSS filename to use, html format only","Custom","Dashboard","Database overview","Database Summary Report","Date","Death Date","Death Place","Death year","Death","default","Default","Degree","Delete","Deleted","Department","Descendant Report","Descendant Tree","Description","Detailed Ancestral Report","Detailed Descendant Report","Details","Disconnected people","District","Divorce Filing","Divorce","Do not include a title","Do not include any dates or places","Do not include any occupation","Do not include","Do not scale tree","done","Download","E-mail","Edit Citation","Edit Event","Edit Family","Edit Media Object","Edit Note","Edit Person","Edit Place","Edit Repository","Edit Source","Edit","Edited","Education","Elected","Electronic","Emigration","Enclosed By","Encloses","End of Line Report","Engagement","Entire Database","Error","Estimated","Event Note","Event Reference Editor","Event Reference Note","Event Type","Event","Events having <count> notes","Events with <count> media","Events with <count> sources","Events","Families having <count> notes","Families with <count> LDS events","Families with <count> media","Families with <count> sources","Families with incomplete events","Families","Family Descendant Tree","Family Group Report","Family Lines Graph","Family nick name","Family Note","Family Tree","Family","Fan Chart","Farm","Father","Female","Females","Feudal","Fiche","File","Film","Filter","First Communion","Foster","FTP","full circle","Full Name","Gallery","Gender","General","Generates documents in OpenDocument Text format (.odt).","Generates documents in plain text format (.txt).","Given name","Given","Godfather","Graduation","Gramps ID","Groom","Hamlet","High","Home Page","Home Person","Hourglass Graph","How to handle living people","Html code","Identification Number","Image","Immigration","Import Family Tree","Import","in","Informant","Inherited","Italic","Item count","Kinship Report","Language","Last changed","Latitude","LDS Note","Left paper margin","Library","Link","List of places to report on","Loading items...","Locality","Location","Longitude","Low","Magazine","Male","Males","Manuscript","Map","Marriage Banns","Marriage Contract","Marriage Date","Marriage License","Marriage Settlement","Marriage","Married Name","Married","Matrilineal","Matronymic","Max Ancestor Generations","Max Descendant Generations","Media Note","Media Object","Media Objects","Media Reference Note","Media with <count> sources","Media","Medical Information","Medium","Military Service","Mother","Municipality","Name Note","Name type","Name","National Origin","Naturalization","Neighborhood","New Citation","New Event","New Family","New Media","New Note","New Person","New Place","New Repository","New Source","New Tag","New","Newspaper","Next","Nick name","Nickname","No errors were found: the database has passed internal checks.","No generations of empty boxes for unknown ancestors","No Home Person set.","No items","Nobility Title","None","Normal","Not found","Not Related","Note Link Report","Note type:","Note","Notes","Number of Ancestors Report","Number of Children","Number of citations","Number of events","Number of families","Number of generations:","Number of individuals","Number of Marriages","Number of media","Number of notes","Number of people","Number of places","Number of repositories","Number of sources","Number of tags","Number","Occupation","OK","Options","Ordination","Other","Output file format.","Output file name. MANDATORY","Page","Paper orientation number.","Paper size name.","Parents","Parish","Participants","Partner","Password: ","Path","Patrilineal","Patronymic","PDF","People having <count> notes","People marked private","People missing parents","People not marked private","People with <count> addresses","People with <count> associations","People with <count> LDS events","People with <count> media","People with <count> sources","People with a nickname","People with an alternate name","People with children","People with incomplete events","People with incomplete names","people with media","People with multiple marriage records","People with no marriage records","People with unknown gender","People without a known birth date","People without a known death date","People","Person Details","Person Filters","Person Note","Person","Photo","Place Note","Place Report","Place with <count> sources","Place","Places having <count> notes","Places with <count> media","Places","Portrait","Preferences","Prefix","Previous","Primary","Priority","Private","Probate","Produces a complete report on the selected people","Produces a detailed ancestral report","Produces a detailed descendant report","Produces a family group report showing information on a set of parents and their children.","Produces a graphical ancestral tree","Produces a graphical calendar","Produces a graphical descendant tree around a family","Produces a graphical descendant tree","Produces a list of descendants of the active person","Produces a list of people with a specified tag","Produces a report of birthdays and anniversaries","Produces a textual ancestral report","Produces a textual end of line report","Produces a textual place report","Produces a textual report of kinship for a given person","Produces a timeline chart.","Produces an hourglass graph using Graphviz.","Produces family line graphs using Graphviz.","Produces fan charts","Produces relationship graphs using Graphviz.","Produces statistical bar and pie charts of the people in the database","Property","Provides a summary of the current database","Province","Pseudonym","Publication info","Quality","Range","Record is private","Record is public","Records Report","References","Refresh","Region","Regular","Relationship Graph","Relationship to _Father:","Relationship to _Mother:","Relationship to home person","Relationship to home person","Relationship type:","Relationship","Relationships","Religion","Report","Repositories","Repository Note","Repository Reference Note","Repository","Research","Reset","Residence","Retirement","Right paper margin","Role","Run","Safe","Second date","Select a file","Select a person as the father","Select a person as the mother","Select an existing media object","Select an existing note","Select an existing place","Select an existing source","Select the format to display names","Select...","Select","Selected","self","Set _Home Person","Share an existing event","Show Details","show people by generations","Shows some interesting records about people and families","Shows status of links in notes","Siblings","Size in cm","Social Security Number","Source Note","Source Reference Note","Source text","Source: Author","Source: Title","Source","Sources having <count> notes","Sources with <count> media","Sources with <count> Repository references","Sources","Span","Sponsored","Spouses","State","Statistics Charts","Statistics","Status","Stepchild","Street","Style name.","Suffix","Sunday","Surname origin type:","Surname","Surnames","System Information","Tag Report","Tag","Tags","Taken","Text","The centre person for the report","The format and language for dates, with examples","The number of characters per line","The number of generations to include in the report","The translation to be used for the report.","This field is mandatory","Time","Timeline Chart","Timeline","Title","To Do","Tombstone","Top Left","Top paper margin","Total size of media objects","Town","Transcript","Type","Underline","Undo","Unknown ","Unknown","Unmarried","Updating checksums on media","upright","Use Compression","Use Fathers Display format","Username: ","Value","Version","Very High","Very Low","Video","Village","Web Home","Web Search","Web site","Whether a line break should follow the name.","Whether to include Gramps IDs","Whether to include private data","Whether to restrict data on recently-dead people","Whether to start a new page after each generation.","white","Wife","Will","Witness","Zoom","Don't use call name","Father's Age","Mother's Age","Wives use husband's surname (from first family listed)"];var ia=1e3,ra=6e4,na=36e5,aa="millisecond",sa="second",oa="minute",la="hour",ca="day",da="week",ha="month",pa="quarter",ua="year",ma="date",fa="YYYY-MM-DDTHH:mm:ssZ",ga="Invalid Date",_a=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,va=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ya={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},ba=function(t,e,i){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(i)+t},xa={s:ba,z:function(t){var e=-t.utcOffset(),i=Math.abs(e),r=Math.floor(i/60),n=i%60;return(e<=0?"+":"-")+ba(r,2,"0")+":"+ba(n,2,"0")},m:function t(e,i){if(e.date()<i.date())return-t(i,e);var r=12*(i.year()-e.year())+(i.month()-e.month()),n=e.clone().add(r,ha),a=i-n<0,s=e.clone().add(r+(a?-1:1),ha);return+(-(r+(i-n)/(a?n-s:s-n))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:ha,y:ua,w:da,d:ca,D:ma,h:la,m:oa,s:sa,ms:aa,Q:pa}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},wa="en",ka={};ka[wa]=ya;var Ta=function(t){return t instanceof $a},Sa=function(t,e,i){var r;if(!t)return wa;if("string"==typeof t)ka[t]&&(r=t),e&&(ka[t]=e,r=t);else{var n=t.name;ka[n]=t,r=n}return!i&&r&&(wa=r),r||!i&&wa},Ca=function(t,e){if(Ta(t))return t.clone();var i="object"==typeof e?e:{};return i.date=t,i.args=arguments,new $a(i)},Ea=xa;Ea.l=Sa,Ea.i=Ta,Ea.w=function(t,e){return Ca(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var $a=function(){function t(t){this.$L=Sa(t.locale,null,!0),this.parse(t)}var e=t.prototype;return e.parse=function(t){this.$d=function(t){var e=t.date,i=t.utc;if(null===e)return new Date(NaN);if(Ea.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(_a);if(r){var n=r[2]-1||0,a=(r[7]||"0").substring(0,3);return i?new Date(Date.UTC(r[1],n,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)):new Date(r[1],n,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},e.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},e.$utils=function(){return Ea},e.isValid=function(){return!(this.$d.toString()===ga)},e.isSame=function(t,e){var i=Ca(t);return this.startOf(e)<=i&&i<=this.endOf(e)},e.isAfter=function(t,e){return Ca(t)<this.startOf(e)},e.isBefore=function(t,e){return this.endOf(e)<Ca(t)},e.$g=function(t,e,i){return Ea.u(t)?this[e]:this.set(i,t)},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this.$d.getTime()},e.startOf=function(t,e){var i=this,r=!!Ea.u(e)||e,n=Ea.p(t),a=function(t,e){var n=Ea.w(i.$u?Date.UTC(i.$y,e,t):new Date(i.$y,e,t),i);return r?n:n.endOf(ca)},s=function(t,e){return Ea.w(i.toDate()[t].apply(i.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),i)},o=this.$W,l=this.$M,c=this.$D,d="set"+(this.$u?"UTC":"");switch(n){case ua:return r?a(1,0):a(31,11);case ha:return r?a(1,l):a(0,l+1);case da:var h=this.$locale().weekStart||0,p=(o<h?o+7:o)-h;return a(r?c-p:c+(6-p),l);case ca:case ma:return s(d+"Hours",0);case la:return s(d+"Minutes",1);case oa:return s(d+"Seconds",2);case sa:return s(d+"Milliseconds",3);default:return this.clone()}},e.endOf=function(t){return this.startOf(t,!1)},e.$set=function(t,e){var i,r=Ea.p(t),n="set"+(this.$u?"UTC":""),a=(i={},i[ca]=n+"Date",i[ma]=n+"Date",i[ha]=n+"Month",i[ua]=n+"FullYear",i[la]=n+"Hours",i[oa]=n+"Minutes",i[sa]=n+"Seconds",i[aa]=n+"Milliseconds",i)[r],s=r===ca?this.$D+(e-this.$W):e;if(r===ha||r===ua){var o=this.clone().set(ma,1);o.$d[a](s),o.init(),this.$d=o.set(ma,Math.min(this.$D,o.daysInMonth())).$d}else a&&this.$d[a](s);return this.init(),this},e.set=function(t,e){return this.clone().$set(t,e)},e.get=function(t){return this[Ea.p(t)]()},e.add=function(t,e){var i,r=this;t=Number(t);var n=Ea.p(e),a=function(e){var i=Ca(r);return Ea.w(i.date(i.date()+Math.round(e*t)),r)};if(n===ha)return this.set(ha,this.$M+t);if(n===ua)return this.set(ua,this.$y+t);if(n===ca)return a(1);if(n===da)return a(7);var s=(i={},i[oa]=ra,i[la]=na,i[sa]=ia,i)[n]||1,o=this.$d.getTime()+t*s;return Ea.w(o,this)},e.subtract=function(t,e){return this.add(-1*t,e)},e.format=function(t){var e=this,i=this.$locale();if(!this.isValid())return i.invalidDate||ga;var r=t||fa,n=Ea.z(this),a=this.$H,s=this.$m,o=this.$M,l=i.weekdays,c=i.months,d=function(t,i,n,a){return t&&(t[i]||t(e,r))||n[i].substr(0,a)},h=function(t){return Ea.s(a%12||12,t,"0")},p=i.meridiem||function(t,e,i){var r=t<12?"AM":"PM";return i?r.toLowerCase():r},u={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:Ea.s(o+1,2,"0"),MMM:d(i.monthsShort,o,c,3),MMMM:d(c,o),D:this.$D,DD:Ea.s(this.$D,2,"0"),d:String(this.$W),dd:d(i.weekdaysMin,this.$W,l,2),ddd:d(i.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(a),HH:Ea.s(a,2,"0"),h:h(1),hh:h(2),a:p(a,s,!0),A:p(a,s,!1),m:String(s),mm:Ea.s(s,2,"0"),s:String(this.$s),ss:Ea.s(this.$s,2,"0"),SSS:Ea.s(this.$ms,3,"0"),Z:n};return r.replace(va,(function(t,e){return e||u[t]||n.replace(":","")}))},e.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},e.diff=function(t,e,i){var r,n=Ea.p(e),a=Ca(t),s=(a.utcOffset()-this.utcOffset())*ra,o=this-a,l=Ea.m(this,a);return l=(r={},r[ua]=l/12,r[ha]=l,r[pa]=l/3,r[da]=(o-s)/6048e5,r[ca]=(o-s)/864e5,r[la]=o/na,r[oa]=o/ra,r[sa]=o/ia,r)[n]||o,i?l:Ea.a(l)},e.daysInMonth=function(){return this.endOf(ha).$D},e.$locale=function(){return ka[this.$L]},e.locale=function(t,e){if(!t)return this.$L;var i=this.clone(),r=Sa(t,e,!0);return r&&(i.$L=r),i},e.clone=function(){return Ea.w(this.$d,this)},e.toDate=function(){return new Date(this.valueOf())},e.toJSON=function(){return this.isValid()?this.toISOString():null},e.toISOString=function(){return this.$d.toISOString()},e.toString=function(){return this.$d.toUTCString()},t}(),Aa=$a.prototype;Ca.prototype=Aa,[["$ms",aa],["$s",sa],["$m",oa],["$H",la],["$W",ca],["$M",ha],["$y",ua],["$D",ma]].forEach((function(t){Aa[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),Ca.extend=function(t,e){return t.$i||(t(e,$a,Ca),t.$i=!0),Ca},Ca.locale=Sa,Ca.isDayjs=Ta,Ca.unix=function(t){return Ca(1e3*t)},Ca.en=ka[wa],Ca.Ls=ka,Ca.p={};var Ia=function(t,e,i){t=t||{};var r=e.prototype,n={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function a(t,e,i,n){return r.fromToBase(t,e,i,n)}i.en.relativeTime=n,r.fromToBase=function(e,r,a,s,o){for(var l,c,d,h=a.$locale().relativeTime||n,p=t.thresholds||[{l:"s",r:44,d:sa},{l:"m",r:89},{l:"mm",r:44,d:oa},{l:"h",r:89},{l:"hh",r:21,d:la},{l:"d",r:35},{l:"dd",r:25,d:ca},{l:"M",r:45},{l:"MM",r:10,d:ha},{l:"y",r:17},{l:"yy",d:ua}],u=p.length,m=0;m<u;m+=1){var f=p[m];f.d&&(l=s?i(e).diff(a,f.d,!0):a.diff(e,f.d,!0));var g=(t.rounding||Math.round)(Math.abs(l));if(d=l>0,g<=f.r||!f.r){g<=1&&m>0&&(f=p[m-1]);var _=h[f.l];o&&(g=o(""+g)),c="string"==typeof _?_.replace("%d",g):_(g,r,f.l,d);break}}if(r)return c;var v=d?h.future:h.past;return"function"==typeof v?v(c):v.replace("%s",c)},r.to=function(t,e){return a(t,e,this,!0)},r.from=function(t,e){return a(t,e,this)};var s=function(t){return t.$u?i.utc():i()};r.toNow=function(t){return this.to(s(this),t)},r.fromNow=function(t){return this.from(s(this),t)}},Ma="M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z",La="M12 1A2.5 2.5 0 0 0 9.5 3.5A2.5 2.5 0 0 0 11 5.79V7H7A2 2 0 0 0 5 9V9.71A2.5 2.5 0 0 0 3.5 12A2.5 2.5 0 0 0 5 14.29V15H4A2 2 0 0 0 2 17V18.21A2.5 2.5 0 0 0 .5 20.5A2.5 2.5 0 0 0 3 23A2.5 2.5 0 0 0 5.5 20.5A2.5 2.5 0 0 0 4 18.21V17H8V18.21A2.5 2.5 0 0 0 6.5 20.5A2.5 2.5 0 0 0 9 23A2.5 2.5 0 0 0 11.5 20.5A2.5 2.5 0 0 0 10 18.21V17A2 2 0 0 0 8 15H7V14.29A2.5 2.5 0 0 0 8.5 12A2.5 2.5 0 0 0 7 9.71V9H17V9.71A2.5 2.5 0 0 0 15.5 12A2.5 2.5 0 0 0 17 14.29V15H16A2 2 0 0 0 14 17V18.21A2.5 2.5 0 0 0 12.5 20.5A2.5 2.5 0 0 0 15 23A2.5 2.5 0 0 0 17.5 20.5A2.5 2.5 0 0 0 16 18.21V17H20V18.21A2.5 2.5 0 0 0 18.5 20.5A2.5 2.5 0 0 0 21 23A2.5 2.5 0 0 0 23.5 20.5A2.5 2.5 0 0 0 22 18.21V17A2 2 0 0 0 20 15H19V14.29A2.5 2.5 0 0 0 20.5 12A2.5 2.5 0 0 0 19 9.71V9A2 2 0 0 0 17 7H13V5.79A2.5 2.5 0 0 0 14.5 3.5A2.5 2.5 0 0 0 12 1M12 2.5A1 1 0 0 1 13 3.5A1 1 0 0 1 12 4.5A1 1 0 0 1 11 3.5A1 1 0 0 1 12 2.5M6 11A1 1 0 0 1 7 12A1 1 0 0 1 6 13A1 1 0 0 1 5 12A1 1 0 0 1 6 11M18 11A1 1 0 0 1 19 12A1 1 0 0 1 18 13A1 1 0 0 1 17 12A1 1 0 0 1 18 11M3 19.5A1 1 0 0 1 4 20.5A1 1 0 0 1 3 21.5A1 1 0 0 1 2 20.5A1 1 0 0 1 3 19.5M9 19.5A1 1 0 0 1 10 20.5A1 1 0 0 1 9 21.5A1 1 0 0 1 8 20.5A1 1 0 0 1 9 19.5M15 19.5A1 1 0 0 1 16 20.5A1 1 0 0 1 15 21.5A1 1 0 0 1 14 20.5A1 1 0 0 1 15 19.5M21 19.5A1 1 0 0 1 22 20.5A1 1 0 0 1 21 21.5A1 1 0 0 1 20 20.5A1 1 0 0 1 21 19.5Z",Pa="M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z",Ra="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z";const za=M`<svg
  height="24"
  width="24"
  viewBox="0 0 24 24"
>
  <path
    fill="#000000"
    d="M10,2H14L13.21,9.91L19.66,5.27L21.66,8.73L14.42,12L21.66,15.27L19.66,18.73L13.21,14.09L14,22H10L10.79,14.09L4.34,18.73L2.34,15.27L9.58,12L2.34,8.73L4.34,5.27L10.79,9.91L10,2Z"
  />
</svg>`,Da=M`<svg height="24" width="24" viewBox="0 0 24 24">
  <path fill="#000000" d="M10.5,2H13.5V8H19V11H13.5V22H10.5V11H5V8H10.5V2Z" />
</svg>`,ja=M`<svg height="24" width="24" viewBox="0 0 24 24">
  <path
    d="m8.748 6.4766c-3.0431 1e-6 -5.5234 2.4804-5.5234 5.5234 0 3.0431 2.4804 5.5234 5.5234 5.5234 0.93172 0 1.8089-0.23453 2.5801-0.64453-0.36367-0.29425-0.69179-0.62746-0.98242-0.99414-0.49253 0.2017-1.0307 0.31641-1.5977 0.31641-2.3282 0-4.2012-1.873-4.2012-4.2012 0-2.3282 1.873-4.2012 4.2012-4.2012 2.3282 0 4.2012 1.873 4.2012 4.2012 0 0.72003-0.19536 1.3855-0.51172 1.9766 0.26276 0.3773 0.60147 0.69303 0.99219 0.9375 0.53009-0.84757 0.8418-1.8439 0.8418-2.9141 0-3.0431-2.4804-5.5234-5.5234-5.5234zm6.5098 0c-0.93172 1e-7 -1.8089 0.23453-2.5801 0.64453 0.36367 0.29425 0.69179 0.62746 0.98242 0.99414 0.49253-0.2017 1.0307-0.31641 1.5977-0.31641 2.3282 2e-7 4.2012 1.873 4.2012 4.2012 0 2.3282-1.873 4.2012-4.2012 4.2012-2.3282 0-4.2012-1.873-4.2012-4.2012 0-0.72003 0.19536-1.3855 0.51172-1.9766-0.26276-0.3773-0.60147-0.69303-0.99219-0.9375-0.53009 0.84757-0.8418 1.8439-0.8418 2.9141 2e-7 3.0431 2.4804 5.5234 5.5234 5.5234 3.0431-2e-6 5.5234-2.4804 5.5234-5.5234 0-3.0431-2.4804-5.5234-5.5234-5.5234z"
  ></path>
</svg>`,Oa=M`<svg height="24" width="24" viewBox="0 0 24 24">
  <path
    fill="#000000"
    d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"
  />
</svg>`,Ba=M`<svg
  height="24"
  width="24"
  viewBox="0 0 24 24"
>
  <path
    fill="#000000"
    d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"
  />
</svg>`,Fa=M`<svg
  height="24"
  width="24"
  viewBox="0 0 24 24"
>
  <path
    fill="#000000"
    d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"
  />
</svg>`;function Na(t,e="#999999"){return M`<i
    ><svg height="24" width="24" viewBox="0 0 24 24">
      <path fill="${e}" d="${t}" /></svg
  ></i>`}function Ha(t,e="#999999",i=0,r=""){return M`<svg
    height="24"
    width="24"
    viewBox="0 0 24 24"
    slot="${r}"
    transform="rotate(${i})"
  >
    <path fill="${e}" d="${t}" />
  </svg>`}function Va(t,e="#999999"){return`data:image/svg+xml,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' height='24' width='24' viewBox='0 0 24 24'><path fill='${e}' d='${t}' /></svg>`)}`}function Ua(t,e=1){const i=/^#?([a-z\d]{4})([a-z\d]{4})([a-z\d]{4})$/i.exec(t);if(i){return`rgb(${parseInt(i[1],32)/255}, ${parseInt(i[2],32)/255}, ${parseInt(i[3],32)/255}, ${e})`}return null}function Ya(t,e=1){const i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(i){return`rgb(${parseInt(i[1],16)}, ${parseInt(i[2],16)}, ${parseInt(i[3],16)}, ${e})`}return null}function Za(t,e){return void 0===e?"":e in t?t[e].replace("_",""):e.replace("_","")}function qa(t){return`${t.name_given||""} ${t.name_surname||""} ${t.name_suffix||""}`.trim()}function Wa(t){return`${t.prefix} ${t.surname} ${t.connector}`.trim()}function Ga(t,e={givenfirst:!0}){const i=t.primary_name?.suffix??"",r=t.primary_name?.first_name??"",n=t.primary_name?.surname_list?.map(Wa)?.join(" ")??"";return e.givenfirst?`${r} ${n} ${i}`.trim():`${n}, ${r} ${i}`.trim()}function Xa(t){return t.father||t.mother?`${qa(t.father||{})} & ${qa(t.mother||{})}`:""}function Ka(t){return t.source?.title?`${t.source?.title||""}\n          ${t.page?` (${t.page})`:""}`:""}function Ja(t,e=!0){return t.summary?M`${t.summary}${e&&t.date?` (${t.date})`:""}`:""}function Qa(t){return M`
    <span class="event">
      <mwc-icon class="inline ${"M"===t.sex?"male":"female"}"
        >person</mwc-icon
      >
      <a href="${""}/person/${t.gramps_id}"
        >${t.name_given||""}
        ${t.name_surname||""}</a
      >
    </span>
    ${t?.birth?.date?M` <span class="event"
          ><i>${za}</i> ${t.birth.date}</span
        >`:""}
    ${t?.death?.date?M` <span class="event"
          ><i>${Da}</i> ${t.death.date}</span
        >`:""}
  `}function ts(t,e){switch(e){case"person":return t?.primary_name?.first_name;case"event":return t.type;case"family":default:return"";case"place":return t?.name?.value||t.title;case"source":return t.title;case"repository":return t.name;case"citation":return t.page;case"media":return t.desc}}Ca.extend(Ia);const es={person:"person",family:"people",event:"event",place:"place",source:"bookmarks",citation:"bookmark",repository:"account_balance",note:"sticky_note_2",media:"photo",tag:"label"},is={person:"people",family:"families",event:"events",place:"places",source:"sources",citation:"citations",repository:"repositories",note:"notes",media:"media",tag:"tags"};function rs(t,e,i){switch(t){case"person":return`\n    ${e?.profile?.birth?.date?`* ${e.profile.birth.date}`:""}${e?.profile?.birth?.place&&e?.profile?.birth?.date?", ":""}${e?.profile?.birth?.place||""}\n    `;case"event":return`\n    ${e?.profile?.date||""}${e?.profile?.place&&e?.profile?.date?", ":""}${e?.profile?.place||""}\n    `;case"place":return`\n    ${e?.profile?.type?e.profile.type:""}\n    `;case"repository":return`\n    ${e.type?Za(i,e.type):""}\n    `;case"note":return e?.text?.string||"";case"media":return e.mime?.startsWith("audio")?Za(i,"Audio"):e.mime?.startsWith("video")?Za(i,"Video"):e.mime?.startsWith("image")?Za(i,"Image"):"application/pdf"===e.mime?Za(i,"PDF"):e.mime||"";default:return""}}function ns(t,e){return Ca.locale(("pt_PT"===e?"pt":e).toLowerCase().replace("_","-")),Ca.unix(t).fromNow()}function as(t,e){let i;return function(...r){clearTimeout(i),i=setTimeout((()=>{clearTimeout(i),t(...r)}),e)}}function ss(t,e,i){switch(e){case"person":return qa(t);case"event":return Ja(t,i);case"family":return Xa(t);case"place":case"repository":return t.name;case"source":return t.title;case"citation":return Ka(t);case"media":return t.desc;default:return""}}function os(t,e,i){t.dispatchEvent(new CustomEvent(e,{bubbles:!0,composed:!0,detail:i}))}function ls(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}function cs(t,e,i){return 0===t&&0===e&&0===i?0:Math.ceil(2440587.5+Date.UTC(t,e-1,i)/864e5)}const ds={IsFemale:"Females",HasUnknownGender:"People with unknown gender",IsMale:"Males",HasAlternateName:"People with an alternate name",HasNickname:"People with a nickname",HaveAltFamilies:"Adopted people",HaveChildren:"People with children",IncompleteNames:"People with incomplete names",NeverMarried:"People with no marriage records",MultipleMarriages:"People with multiple marriage records",NoBirthdate:"People without a known birth date",NoDeathdate:"People without a known death date",PersonWithIncompleteEvent:"People with incomplete events",FamilyWithIncompleteEvent:"Families with incomplete events",PeoplePrivate:"People marked private",PeoplePublic:"People not marked private",MissingParent:"People missing parents",Disconnected:"Disconnected people"},hs={citations:{HasGallery:"Citations with <count> media",HasNote:"Citations having <count> notes"},events:{HasGallery:"Events with <count> media",HasNote:"Events having <count> notes",HasSourceCount:"Events with <count> sources"},families:{HasGallery:"Families with <count> media",HasNote:"Families having <count> notes",HasSourceCount:"Families with <count> sources"},media:{HasSourceCount:"Media with <count> sources"},notes:{},people:{HavePhotos:"People with <count> media",HasNote:"People having <count> notes",HasSourceCount:"People with <count> sources",HasAddress:"People with <count> addresses",HasAssociation:"People with <count> associations"},places:{HasGallery:"Places with <count> media",HasNote:"Places having <count> notes",HasSourceCount:"Place with <count> sources"},repositories:{},sources:{HasGallery:"Sources with <count> media",HasNote:"Sources having <count> notes",HasRepository:"Sources with <count> Repository references"}},ps={"image/":"Image","audio/":"Audio","video/":"Video","text/":"Text","application/pdf":"PDF"},us={0:"description",1:"pie_chart",5:"account_tree"};function ms(t,e){return t.length>0&&e.length>0&&t.every((t=>e.includes(t)))}function fs(t){const e=function(t){return"media"===t.object_type?t.object.handle:t.object?.media_list?.length?t.object.media_list[0].ref:""}(t),i=function(t){return t.object?.media_list?.length?t.object.media_list[0].rect:[]}(t);if(e)return M`<grampsjs-img
      handle="${e}"
      slot="graphic"
      circle
      square
      size="70"
      .rect="${i}"
      .mime=""
      ><mwc-icon class="placeholder"
        >${es[t.object_type]}</mwc-icon
      ></grampsjs-img
    >`;if("tag"===t.object_type){const e=t.object?.color?.length>7?Ua(t.object.color,.6):Ya(t.object.color,.6);return M`<mwc-icon slot="graphic" style="background-color:${e};"
      >${es[t.object_type]}</mwc-icon
    >`}return M`<mwc-icon slot="graphic"
    >${es[t.object_type]}</mwc-icon
  >`}function gs(t){"Enter"!==t.code&&"Space"!==t.code||(t.target.click(),t.preventDefault(),t.stopPropagation())}function _s(t){return void 0===t||6!==t.modifier&&("[0,0,0,false]"===JSON.stringify(t.dateval.slice(0,4))&&!(t.dateval.len>4&&"[0,0,0,false]"!==JSON.stringify(t.dateval.slice(4))))}const vs=/((?:^|\s)https?:\/\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/gi;function ys(t,e=!0){if(e)return t.replace(vs,(t=>`<a href="${t}" target="_blank">${t}</a>`));const i=t.split(vs);return M`${i.map((t=>t.match(vs)?M`<a href="${t}" target="_blank">${t}</a>
          <md-icon class="linkicon"
            >${Ha("M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z","#0d47a1")}</md-icon
          > `:t))}`}function bs(t){if(void 0===t||_s(t)||6===t.modifier)return[void 0,void 0];let e=t.dateval[2],i=t.dateval[6]??e;return 2===t.calendar?(e-=3760,i-=3760):3===t.calendar?(e+=1791,i+=1791):4===t.calendar?(e+=621,i+=621):5===t.calendar&&(e=Math.floor(.97022*e+621.565),i=Math.floor(.97022*i+621.565)),[e,i]}var xs="___________".split("_"),ws={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},ks={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},Ts={name:"ar",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:xs,monthsShort:xs,weekStart:6,relativeTime:{future:" %s",past:" %s",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(t){return t.replace(/[]/g,(function(t){return ks[t]})).replace(//g,",")},postformat:function(t){return t.replace(/\d/g,(function(t){return ws[t]})).replace(/,/g,"")},ordinal:function(t){return t},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"}};Ca.locale(Ts,null,!0);var Ss={name:"bg",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:"___________".split("_"),monthsShort:"___________".split("_"),weekStart:1,ordinal:function(t){var e=t%100;if(e>10&&e<20)return t+"-";var i=t%10;return 1===i?t+"-":2===i?t+"-":7===i||8===i?t+"-":t+"-"},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},relativeTime:{future:" %s",past:" %s",s:" ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "}};Ca.locale(Ss,null,!0);var Cs={name:"ca",weekdays:"Diumenge_Dilluns_Dimarts_Dimecres_Dijous_Divendres_Dissabte".split("_"),weekdaysShort:"Dg._Dl._Dt._Dc._Dj._Dv._Ds.".split("_"),weekdaysMin:"Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),months:"Gener_Febrer_Mar_Abril_Maig_Juny_Juliol_Agost_Setembre_Octubre_Novembre_Desembre".split("_"),monthsShort:"Gen._Febr._Mar_Abr._Maig_Juny_Jul._Ag._Set._Oct._Nov._Des.".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",LLL:"D MMMM [de] YYYY [a les] H:mm",LLLL:"dddd D MMMM [de] YYYY [a les] H:mm",ll:"D MMM YYYY",lll:"D MMM YYYY, H:mm",llll:"ddd D MMM YYYY, H:mm"},relativeTime:{future:"d'aqu %s",past:"fa %s",s:"uns segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},ordinal:function(t){return""+t+(1===t||3===t?"r":2===t?"n":4===t?"t":"")}};function Es(t){return t>1&&t<5&&1!=~~(t/10)}function $s(t,e,i,r){var n=t+" ";switch(i){case"s":return e||r?"pr sekund":"pr sekundami";case"m":return e?"minuta":r?"minutu":"minutou";case"mm":return e||r?n+(Es(t)?"minuty":"minut"):n+"minutami";case"h":return e?"hodina":r?"hodinu":"hodinou";case"hh":return e||r?n+(Es(t)?"hodiny":"hodin"):n+"hodinami";case"d":return e||r?"den":"dnem";case"dd":return e||r?n+(Es(t)?"dny":"dn"):n+"dny";case"M":return e||r?"msc":"mscem";case"MM":return e||r?n+(Es(t)?"msce":"msc"):n+"msci";case"y":return e||r?"rok":"rokem";case"yy":return e||r?n+(Es(t)?"roky":"let"):n+"lety"}}Ca.locale(Cs,null,!0);var As={name:"cs",weekdays:"nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),weekdaysShort:"ne_po_t_st_t_p_so".split("_"),weekdaysMin:"ne_po_t_st_t_p_so".split("_"),months:"leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_"),monthsShort:"led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_"),weekStart:1,yearStart:4,ordinal:function(t){return t+"."},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},relativeTime:{future:"za %s",past:"ped %s",s:$s,m:$s,mm:$s,h:$s,hh:$s,d:$s,dd:$s,M:$s,MM:$s,y:$s,yy:$s}};Ca.locale(As,null,!0);var Is={name:"da",weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn._man._tirs._ons._tors._fre._lr.".split("_"),weekdaysMin:"s._ma._ti._on._to._fr._l.".split("_"),months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj_juni_juli_aug._sept._okt._nov._dec.".split("_"),weekStart:1,ordinal:function(t){return t+"."},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},relativeTime:{future:"om %s",past:"%s siden",s:"f sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en mned",MM:"%d mneder",y:"et r",yy:"%d r"}};Ca.locale(Is,null,!0);var Ms={s:"ein paar Sekunden",m:["eine Minute","einer Minute"],mm:"%d Minuten",h:["eine Stunde","einer Stunde"],hh:"%d Stunden",d:["ein Tag","einem Tag"],dd:["%d Tage","%d Tagen"],M:["ein Monat","einem Monat"],MM:["%d Monate","%d Monaten"],y:["ein Jahr","einem Jahr"],yy:["%d Jahre","%d Jahren"]};function Ls(t,e,i){var r=Ms[i];return Array.isArray(r)&&(r=r[e?0:1]),r.replace("%d",t)}var Ps={name:"de",weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan_Feb_Mrz_Apr_Mai_Juni_Juli_Aug_Sept_Okt_Nov_Dez".split("_"),ordinal:function(t){return t+"."},weekStart:1,yearStart:4,formats:{LTS:"HH:mm:ss",LT:"HH:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},relativeTime:{future:"in %s",past:"vor %s",s:Ls,m:Ls,mm:Ls,h:Ls,hh:Ls,d:Ls,dd:Ls,M:Ls,MM:Ls,y:Ls,yy:Ls}};Ca.locale(Ps,null,!0);var Rs={name:"el",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:"___________".split("_"),monthsShort:"___________".split("_"),ordinal:function(t){return t},weekStart:1,relativeTime:{future:" %s",past:" %s",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},formats:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"}};Ca.locale(Rs,null,!0);var zs={name:"en-gb",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekStart:1,yearStart:4,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},ordinal:function(t){var e=["th","st","nd","rd"],i=t%100;return"["+t+(e[(i-20)%10]||e[i]||e[0])+"]"}};Ca.locale(zs,null,!0);var Ds={name:"eo",weekdays:"dimano_lundo_mardo_merkredo_ado_vendredo_sabato".split("_"),months:"januaro_februaro_marto_aprilo_majo_junio_julio_agusto_septembro_oktobro_novembro_decembro".split("_"),weekStart:1,weekdaysShort:"dim_lun_mard_merk_a_ven_sab".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_ag_sep_okt_nov_dec".split("_"),weekdaysMin:"di_lu_ma_me_a_ve_sa".split("_"),ordinal:function(t){return t},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D[-a de] MMMM, YYYY",LLL:"D[-a de] MMMM, YYYY HH:mm",LLLL:"dddd, [la] D[-a de] MMMM, YYYY HH:mm"},relativeTime:{future:"post %s",past:"anta %s",s:"sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"}};Ca.locale(Ds,null,!0);var js={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},ordinal:function(t){return t+""}};function Os(t,e,i,r){var n={s:"muutama sekunti",m:"minuutti",mm:"%d minuuttia",h:"tunti",hh:"%d tuntia",d:"piv",dd:"%d piv",M:"kuukausi",MM:"%d kuukautta",y:"vuosi",yy:"%d vuotta",numbers:"nolla_yksi_kaksi_kolme_nelj_viisi_kuusi_seitsemn_kahdeksan_yhdeksn".split("_")},a={s:"muutaman sekunnin",m:"minuutin",mm:"%d minuutin",h:"tunnin",hh:"%d tunnin",d:"pivn",dd:"%d pivn",M:"kuukauden",MM:"%d kuukauden",y:"vuoden",yy:"%d vuoden",numbers:"nollan_yhden_kahden_kolmen_neljn_viiden_kuuden_seitsemn_kahdeksan_yhdeksn".split("_")},s=r&&!e?a:n,o=s[i];return t<10?o.replace("%d",s.numbers[t]):o.replace("%d",t)}Ca.locale(js,null,!0);var Bs={name:"fi",weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),ordinal:function(t){return t+"."},weekStart:1,yearStart:4,relativeTime:{future:"%s pst",past:"%s sitten",s:Os,m:Os,mm:Os,h:Os,hh:Os,d:Os,dd:Os,M:Os,MM:Os,y:Os,yy:Os},formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM[ta] YYYY",LLL:"D. MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, D. MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"D. MMM YYYY",lll:"D. MMM YYYY, [klo] HH.mm",llll:"ddd, D. MMM YYYY, [klo] HH.mm"}};Ca.locale(Bs,null,!0);var Fs={name:"fr",weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(t){return""+t+(1===t?"er":"")}};Ca.locale(Fs,null,!0);var Ns={s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",hh2:"",d:"",dd:"%d ",dd2:"",M:"",MM:"%d ",MM2:"",y:"",yy:"%d ",yy2:""};function Hs(t,e,i){return(Ns[i+(2===t?"2":"")]||Ns[i]).replace("%d",t)}var Vs={name:"he",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:"___________".split("_"),monthsShort:"___________".split("_"),relativeTime:{future:" %s",past:" %s",s:Hs,m:Hs,mm:Hs,h:Hs,hh:Hs,d:Hs,dd:Hs,M:Hs,MM:Hs,y:Hs,yy:Hs},ordinal:function(t){return t},format:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY HH:mm",LLLL:"dddd, D []MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY HH:mm",LLLL:"dddd, D []MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"}};Ca.locale(Vs,null,!0);var Us="sijenja_veljae_oujka_travnja_svibnja_lipnja_srpnja_kolovoza_rujna_listopada_studenoga_prosinca".split("_"),Ys="sijeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_"),Zs=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/,qs=function(t,e){return Zs.test(e)?Us[t.month()]:Ys[t.month()]};qs.s=Ys,qs.f=Us;var Ws={name:"hr",weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),months:qs,monthsShort:"sij._velj._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},relativeTime:{future:"za %s",past:"prije %s",s:"sekunda",m:"minuta",mm:"%d minuta",h:"sat",hh:"%d sati",d:"dan",dd:"%d dana",M:"mjesec",MM:"%d mjeseci",y:"godina",yy:"%d godine"},ordinal:function(t){return t+"."}};Ca.locale(Ws,null,!0);var Gs={name:"hu",weekdays:"vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),weekdaysShort:"vas_ht_kedd_sze_cst_pn_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),months:"janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),monthsShort:"jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),ordinal:function(t){return t+"."},weekStart:1,relativeTime:{future:"%s mlva",past:"%s",s:function(t,e,i,r){return"nhny msodperc"+(r||e?"":"e")},m:function(t,e,i,r){return"egy perc"+(r||e?"":"e")},mm:function(t,e,i,r){return t+" perc"+(r||e?"":"e")},h:function(t,e,i,r){return"egy "+(r||e?"ra":"rja")},hh:function(t,e,i,r){return t+" "+(r||e?"ra":"rja")},d:function(t,e,i,r){return"egy "+(r||e?"nap":"napja")},dd:function(t,e,i,r){return t+" "+(r||e?"nap":"napja")},M:function(t,e,i,r){return"egy "+(r||e?"hnap":"hnapja")},MM:function(t,e,i,r){return t+" "+(r||e?"hnap":"hnapja")},y:function(t,e,i,r){return"egy "+(r||e?"v":"ve")},yy:function(t,e,i,r){return t+" "+(r||e?"v":"ve")}},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"}};Ca.locale(Gs,null,!0);var Xs={name:"is",weekdays:"sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),months:"janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),weekStart:1,weekdaysShort:"sun_mn_ri_mi_fim_fs_lau".split("_"),monthsShort:"jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),weekdaysMin:"Su_M_r_Mi_Fi_F_La".split("_"),ordinal:function(t){return t},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd, D. MMMM YYYY [kl.] H:mm"}};Ca.locale(Xs,null,!0);var Ks={name:"it",weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),weekStart:1,monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"tra %s",past:"%s fa",s:"qualche secondo",m:"un minuto",mm:"%d minuti",h:"un' ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:function(t){return t+""}};Ca.locale(Ks,null,!0);var Js={name:"ja",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),ordinal:function(t){return t+""},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMD dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMD(ddd) HH:mm"},meridiem:function(t){return t<12?"":""},relativeTime:{future:"%s",past:"%s",s:"",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}};Ca.locale(Js,null,!0);var Qs="sausio_vasario_kovo_balandio_gegus_birelio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_"),to="sausis_vasaris_kovas_balandis_gegu_birelis_liepa_rugpjtis_rugsjis_spalis_lapkritis_gruodis".split("_"),eo=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?|MMMM?(\[[^\[\]]*\]|\s)+D[oD]?/,io=function(t,e){return eo.test(e)?Qs[t.month()]:to[t.month()]};io.s=to,io.f=Qs;var ro={name:"lt",weekdays:"sekmadienis_pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis".split("_"),weekdaysShort:"sek_pir_ant_tre_ket_pen_e".split("_"),weekdaysMin:"s_p_a_t_k_pn_".split("_"),months:io,monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),ordinal:function(t){return t+"."},weekStart:1,relativeTime:{future:"u %s",past:"prie %s",s:"kelias sekundes",m:"minut",mm:"%d minutes",h:"valand",hh:"%d valandas",d:"dien",dd:"%d dienas",M:"menes",MM:"%d mnesius",y:"metus",yy:"%d metus"},format:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"}};Ca.locale(ro,null,!0);var no={name:"nb",weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"s._ma._ti._on._to._fr._l.".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),ordinal:function(t){return t+"."},weekStart:1,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] HH:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},relativeTime:{future:"om %s",past:"%s siden",s:"noen sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en mned",MM:"%d mneder",y:"ett r",yy:"%d r"}};Ca.locale(no,null,!0);var ao={name:"nl",weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),ordinal:function(t){return t+"."},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"een minuut",mm:"%d minuten",h:"een uur",hh:"%d uur",d:"een dag",dd:"%d dagen",M:"een maand",MM:"%d maanden",y:"een jaar",yy:"%d jaar"}};Ca.locale(ao,null,!0);var so={name:"nn",weekdays:"sundag_mndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mn_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_m_ty_on_to_fr_la".split("_"),months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),ordinal:function(t){return t+"."},weekStart:1,relativeTime:{future:"om %s",past:"for %s sidan",s:"nokre sekund",m:"eitt minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein mnad",MM:"%d mnadar",y:"eitt r",yy:"%d r"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"}};function oo(t){return t%10<5&&t%10>1&&~~(t/10)%10!=1}function lo(t,e,i){var r=t+" ";switch(i){case"m":return e?"minuta":"minut";case"mm":return r+(oo(t)?"minuty":"minut");case"h":return e?"godzina":"godzin";case"hh":return r+(oo(t)?"godziny":"godzin");case"MM":return r+(oo(t)?"miesice":"miesicy");case"yy":return r+(oo(t)?"lata":"lat")}}Ca.locale(so,null,!0);var co="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_"),ho="stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_"),po=/D MMMM/,uo=function(t,e){return po.test(e)?co[t.month()]:ho[t.month()]};uo.s=ho,uo.f=co;var mo={name:"pl",weekdays:"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_r_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_r_Cz_Pt_So".split("_"),months:uo,monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),ordinal:function(t){return t+"."},weekStart:1,yearStart:4,relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:lo,mm:lo,h:lo,hh:lo,d:"1 dzie",dd:"%d dni",M:"miesic",MM:lo,y:"rok",yy:lo},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"}};Ca.locale(mo,null,!0);var fo={name:"pt-br",weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),ordinal:function(t){return t+""},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [s] HH:mm"},relativeTime:{future:"em %s",past:"h %s",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"}};Ca.locale(fo,null,!0);var go={name:"pt",weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sab".split("_"),weekdaysMin:"Do_2_3_4_5_6_Sa".split("_"),months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),ordinal:function(t){return t+""},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [s] HH:mm"},relativeTime:{future:"em %s",past:"h %s",s:"alguns segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"}};Ca.locale(go,null,!0);var _o="___________".split("_"),vo="___________".split("_"),yo="._._._.____._._._._.".split("_"),bo="._.__.____._._._._.".split("_"),xo=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function wo(t,e,i){var r,n;return"m"===i?e?"":"":t+" "+(r=+t,n={mm:e?"__":"__",hh:"__",dd:"__",MM:"__",yy:"__"}[i].split("_"),r%10==1&&r%100!=11?n[0]:r%10>=2&&r%10<=4&&(r%100<10||r%100>=20)?n[1]:n[2])}var ko=function(t,e){return xo.test(e)?_o[t.month()]:vo[t.month()]};ko.s=vo,ko.f=_o;var To=function(t,e){return xo.test(e)?yo[t.month()]:bo[t.month()]};To.s=bo,To.f=yo;var So={name:"ru",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:ko,monthsShort:To,weekStart:1,yearStart:4,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., H:mm",LLLL:"dddd, D MMMM YYYY ., H:mm"},relativeTime:{future:" %s",past:"%s ",s:" ",m:wo,mm:wo,h:"",hh:wo,d:"",dd:wo,M:"",MM:wo,y:"",yy:wo},ordinal:function(t){return t},meridiem:function(t){return t<4?"":t<12?"":t<17?"":""}};function Co(t){return t>1&&t<5&&1!=~~(t/10)}function Eo(t,e,i,r){var n=t+" ";switch(i){case"s":return e||r?"pr seknd":"pr sekundami";case"m":return e?"minta":r?"mintu":"mintou";case"mm":return e||r?n+(Co(t)?"minty":"mint"):n+"mintami";case"h":return e?"hodina":r?"hodinu":"hodinou";case"hh":return e||r?n+(Co(t)?"hodiny":"hodn"):n+"hodinami";case"d":return e||r?"de":"dom";case"dd":return e||r?n+(Co(t)?"dni":"dn"):n+"dami";case"M":return e||r?"mesiac":"mesiacom";case"MM":return e||r?n+(Co(t)?"mesiace":"mesiacov"):n+"mesiacmi";case"y":return e||r?"rok":"rokom";case"yy":return e||r?n+(Co(t)?"roky":"rokov"):n+"rokmi"}}Ca.locale(So,null,!0);var $o={name:"sk",weekdays:"nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_t_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_t_pi_so".split("_"),months:"janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_"),monthsShort:"jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_"),weekStart:1,yearStart:4,ordinal:function(t){return t+"."},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},relativeTime:{future:"za %s",past:"pred %s",s:Eo,m:Eo,mm:Eo,h:Eo,hh:Eo,d:Eo,dd:Eo,M:Eo,MM:Eo,y:Eo,yy:Eo}};Ca.locale($o,null,!0);var Ao={name:"sl",weekdays:"nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),weekStart:1,weekdaysShort:"ned._pon._tor._sre._et._pet._sob.".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdaysMin:"ne_po_to_sr_e_pe_so".split("_"),ordinal:function(t){return t+"."},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},relativeTime:{future:"ez %s",past:"pred %s",s:"nekaj sekund",m:"minuta",mm:"%d minut",h:"ura",hh:"%d ur",d:"dan",dd:"%d dni",M:"mesec",MM:"%d mesecev",y:"leto",yy:"%d let"}};Ca.locale(Ao,null,!0);var Io={name:"sq",weekdays:"E Diel_E Hn_E Mart_E Mrkur_E Enjte_E Premte_E Shtun".split("_"),months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nntor_Dhjetor".split("_"),weekStart:1,weekdaysShort:"Die_Hn_Mar_Mr_Enj_Pre_Sht".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nn_Dhj".split("_"),weekdaysMin:"D_H_Ma_M_E_P_Sh".split("_"),ordinal:function(t){return t},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"n %s",past:"%s m par",s:"disa sekonda",m:"nj minut",mm:"%d minuta",h:"nj or",hh:"%d or",d:"nj dit",dd:"%d dit",M:"nj muaj",MM:"%d muaj",y:"nj vit",yy:"%d vite"}};Ca.locale(Io,null,!0);var Mo={words:{m:["jedan minut","jednog minuta"],mm:["%d minut","%d minuta","%d minuta"],h:["jedan sat","jednog sata"],hh:["%d sat","%d sata","%d sati"],d:["jedan dan","jednog dana"],dd:["%d dan","%d dana","%d dana"],M:["jedan mesec","jednog meseca"],MM:["%d mesec","%d meseca","%d meseci"],y:["jednu godinu","jedne godine"],yy:["%d godinu","%d godine","%d godina"]},correctGrammarCase:function(t,e){return t%10>=1&&t%10<=4&&(t%100<10||t%100>=20)?t%10==1?e[0]:e[1]:e[2]},relativeTimeFormatter:function(t,e,i,r){var n=Mo.words[i];if(1===i.length)return"y"===i&&e?"jedna godina":r||e?n[0]:n[1];var a=Mo.correctGrammarCase(t,n);return"yy"===i&&e&&"%d godinu"===a?t+" godina":a.replace("%d",t)}},Lo={name:"sr",weekdays:"Nedelja_Ponedeljak_Utorak_Sreda_etvrtak_Petak_Subota".split("_"),weekdaysShort:"Ned._Pon._Uto._Sre._et._Pet._Sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),months:"Januar_Februar_Mart_April_Maj_Jun_Jul_Avgust_Septembar_Oktobar_Novembar_Decembar".split("_"),monthsShort:"Jan._Feb._Mar._Apr._Maj_Jun_Jul_Avg._Sep._Okt._Nov._Dec.".split("_"),weekStart:1,relativeTime:{future:"za %s",past:"pre %s",s:"nekoliko sekundi",m:Mo.relativeTimeFormatter,mm:Mo.relativeTimeFormatter,h:Mo.relativeTimeFormatter,hh:Mo.relativeTimeFormatter,d:Mo.relativeTimeFormatter,dd:Mo.relativeTimeFormatter,M:Mo.relativeTimeFormatter,MM:Mo.relativeTimeFormatter,y:Mo.relativeTimeFormatter,yy:Mo.relativeTimeFormatter},ordinal:function(t){return t+"."},formats:{LT:"H:mm",LTS:"H:mm:ss",L:"D. M. YYYY.",LL:"D. MMMM YYYY.",LLL:"D. MMMM YYYY. H:mm",LLLL:"dddd, D. MMMM YYYY. H:mm"}};Ca.locale(Lo,null,!0);var Po={name:"sv",weekdays:"sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_mn_tis_ons_tor_fre_lr".split("_"),weekdaysMin:"s_m_ti_on_to_fr_l".split("_"),months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekStart:1,yearStart:4,ordinal:function(t){var e=t%10;return"["+t+(1===e||2===e?"a":"e")+"]"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},relativeTime:{future:"om %s",past:"fr %s sedan",s:"ngra sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"}};Ca.locale(Po,null,!0);var Ro={name:"ta",weekdays:"______".split("_"),months:"___________".split("_"),weekdaysShort:"______".split("_"),monthsShort:"___________".split("_"),weekdaysMin:"______".split("_"),ordinal:function(t){return t},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},relativeTime:{future:"%s ",past:"%s ",s:"  ",m:" ",mm:"%d ",h:"  ",hh:"%d  ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "}};Ca.locale(Ro,null,!0);var zo={name:"tr",weekdays:"Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),months:"Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),monthsShort:"Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),weekStart:1,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"%s sonra",past:"%s nce",s:"birka saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir yl",yy:"%d yl"},ordinal:function(t){return t+"."}};Ca.locale(zo,null,!0);var Do="___________".split("_"),jo="___________".split("_"),Oo=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function Bo(t,e,i){var r,n;return"m"===i?e?"":"":"h"===i?e?"":"":t+" "+(r=+t,n={ss:e?"__":"__",mm:e?"__":"__",hh:e?"__":"__",dd:"__",MM:"__",yy:"__"}[i].split("_"),r%10==1&&r%100!=11?n[0]:r%10>=2&&r%10<=4&&(r%100<10||r%100>=20)?n[1]:n[2])}var Fo=function(t,e){return Oo.test(e)?Do[t.month()]:jo[t.month()]};Fo.s=jo,Fo.f=Do;var No={name:"uk",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:Fo,monthsShort:"___________".split("_"),weekStart:1,relativeTime:{future:" %s",past:"%s ",s:" ",m:Bo,mm:Bo,h:Bo,hh:Bo,d:"",dd:Bo,M:"",MM:Bo,y:"",yy:Bo},ordinal:function(t){return t},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"}};Ca.locale(No,null,!0);var Ho={name:"vi",weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),weekStart:1,weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),ordinal:function(t){return t},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY HH:mm",LLLL:"dddd, D MMMM [nm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},relativeTime:{future:"%s ti",past:"%s trc",s:"vi giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ngy",dd:"%d ngy",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"}};Ca.locale(Ho,null,!0);var Vo={name:"zh-cn",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),ordinal:function(t,e){return"W"===e?t+"":t+""},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDAhmm",LLLL:"YYYYMDddddAhmm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},relativeTime:{future:"%s",past:"%s",s:"",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},meridiem:function(t,e){var i=100*t+e;return i<600?"":i<900?"":i<1100?"":i<1300?"":i<1800?"":""}};Ca.locale(Vo,null,!0);var Uo={name:"zh-hk",months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),ordinal:function(t){return t+""},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm"},relativeTime:{future:"%s",past:"%s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "}};Ca.locale(Uo,null,!0);var Yo={name:"zh-tw",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),ordinal:function(t){return t+""},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},relativeTime:{future:"%s",past:"%s",s:"",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}};Ca.locale(Yo,null,!0);var Zo,qo={CLOSING:"mdc-dialog--closing",OPEN:"mdc-dialog--open",OPENING:"mdc-dialog--opening",SCROLLABLE:"mdc-dialog--scrollable",SCROLL_LOCK:"mdc-dialog-scroll-lock",STACKED:"mdc-dialog--stacked",FULLSCREEN:"mdc-dialog--fullscreen",SCROLL_DIVIDER_HEADER:"mdc-dialog-scroll-divider-header",SCROLL_DIVIDER_FOOTER:"mdc-dialog-scroll-divider-footer",SURFACE_SCRIM_SHOWN:"mdc-dialog__surface-scrim--shown",SURFACE_SCRIM_SHOWING:"mdc-dialog__surface-scrim--showing",SURFACE_SCRIM_HIDING:"mdc-dialog__surface-scrim--hiding",SCRIM_HIDDEN:"mdc-dialog__scrim--hidden"},Wo={ACTION_ATTRIBUTE:"data-mdc-dialog-action",BUTTON_DEFAULT_ATTRIBUTE:"data-mdc-dialog-button-default",BUTTON_SELECTOR:".mdc-dialog__button",CLOSED_EVENT:"MDCDialog:closed",CLOSE_ACTION:"close",CLOSING_EVENT:"MDCDialog:closing",CONTAINER_SELECTOR:".mdc-dialog__container",CONTENT_SELECTOR:".mdc-dialog__content",DESTROY_ACTION:"destroy",INITIAL_FOCUS_ATTRIBUTE:"data-mdc-dialog-initial-focus",OPENED_EVENT:"MDCDialog:opened",OPENING_EVENT:"MDCDialog:opening",SCRIM_SELECTOR:".mdc-dialog__scrim",SUPPRESS_DEFAULT_PRESS_SELECTOR:["textarea",".mdc-menu .mdc-list-item",".mdc-menu .mdc-deprecated-list-item"].join(", "),SURFACE_SELECTOR:".mdc-dialog__surface"},Go={DIALOG_ANIMATION_CLOSE_TIME_MS:75,DIALOG_ANIMATION_OPEN_TIME_MS:150},Xo=function(){function t(){this.rafIDs=new Map}return t.prototype.request=function(t,e){var i=this;this.cancel(t);var r=requestAnimationFrame((function(r){i.rafIDs.delete(t),e(r)}));this.rafIDs.set(t,r)},t.prototype.cancel=function(t){var e=this.rafIDs.get(t);e&&(cancelAnimationFrame(e),this.rafIDs.delete(t))},t.prototype.cancelAll=function(){var t=this;this.rafIDs.forEach((function(e,i){t.cancel(i)}))},t.prototype.getQueue=function(){var t=[];return this.rafIDs.forEach((function(e,i){t.push(i)})),t},t}();!function(t){t.POLL_SCROLL_POS="poll_scroll_position",t.POLL_LAYOUT_CHANGE="poll_layout_change"}(Zo||(Zo={}));var Ko=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.dialogOpen=!1,r.isFullscreen=!1,r.animationFrame=0,r.animationTimer=0,r.escapeKeyAction=Wo.CLOSE_ACTION,r.scrimClickAction=Wo.CLOSE_ACTION,r.autoStackButtons=!0,r.areButtonsStacked=!1,r.suppressDefaultPressSelector=Wo.SUPPRESS_DEFAULT_PRESS_SELECTOR,r.animFrame=new Xo,r.contentScrollHandler=function(){r.handleScrollEvent()},r.windowResizeHandler=function(){r.layout()},r.windowOrientationChangeHandler=function(){r.layout()},r}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return qo},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Wo},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Go},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addBodyClass:function(){},addClass:function(){},areButtonsStacked:function(){return!1},clickDefaultButton:function(){},eventTargetMatches:function(){return!1},getActionFromEvent:function(){return""},getInitialFocusEl:function(){return null},hasClass:function(){return!1},isContentScrollable:function(){return!1},notifyClosed:function(){},notifyClosing:function(){},notifyOpened:function(){},notifyOpening:function(){},releaseFocus:function(){},removeBodyClass:function(){},removeClass:function(){},reverseButtons:function(){},trapFocus:function(){},registerContentEventHandler:function(){},deregisterContentEventHandler:function(){},isScrollableContentAtTop:function(){return!1},isScrollableContentAtBottom:function(){return!1},registerWindowEventHandler:function(){},deregisterWindowEventHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.adapter.hasClass(qo.STACKED)&&this.setAutoStackButtons(!1),this.isFullscreen=this.adapter.hasClass(qo.FULLSCREEN)},e.prototype.destroy=function(){this.animationTimer&&(clearTimeout(this.animationTimer),this.handleAnimationTimerEnd()),this.isFullscreen&&this.adapter.deregisterContentEventHandler("scroll",this.contentScrollHandler),this.animFrame.cancelAll(),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler),this.adapter.deregisterWindowEventHandler("orientationchange",this.windowOrientationChangeHandler)},e.prototype.open=function(t){var e=this;this.dialogOpen=!0,this.adapter.notifyOpening(),this.adapter.addClass(qo.OPENING),this.isFullscreen&&this.adapter.registerContentEventHandler("scroll",this.contentScrollHandler),t&&t.isAboveFullscreenDialog&&this.adapter.addClass(qo.SCRIM_HIDDEN),this.adapter.registerWindowEventHandler("resize",this.windowResizeHandler),this.adapter.registerWindowEventHandler("orientationchange",this.windowOrientationChangeHandler),this.runNextAnimationFrame((function(){e.adapter.addClass(qo.OPEN),e.adapter.addBodyClass(qo.SCROLL_LOCK),e.layout(),e.animationTimer=setTimeout((function(){e.handleAnimationTimerEnd(),e.adapter.trapFocus(e.adapter.getInitialFocusEl()),e.adapter.notifyOpened()}),Go.DIALOG_ANIMATION_OPEN_TIME_MS)}))},e.prototype.close=function(t){var e=this;void 0===t&&(t=""),this.dialogOpen&&(this.dialogOpen=!1,this.adapter.notifyClosing(t),this.adapter.addClass(qo.CLOSING),this.adapter.removeClass(qo.OPEN),this.adapter.removeBodyClass(qo.SCROLL_LOCK),this.isFullscreen&&this.adapter.deregisterContentEventHandler("scroll",this.contentScrollHandler),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler),this.adapter.deregisterWindowEventHandler("orientationchange",this.windowOrientationChangeHandler),cancelAnimationFrame(this.animationFrame),this.animationFrame=0,clearTimeout(this.animationTimer),this.animationTimer=setTimeout((function(){e.adapter.releaseFocus(),e.handleAnimationTimerEnd(),e.adapter.notifyClosed(t)}),Go.DIALOG_ANIMATION_CLOSE_TIME_MS))},e.prototype.showSurfaceScrim=function(){var t=this;this.adapter.addClass(qo.SURFACE_SCRIM_SHOWING),this.runNextAnimationFrame((function(){t.adapter.addClass(qo.SURFACE_SCRIM_SHOWN)}))},e.prototype.hideSurfaceScrim=function(){this.adapter.removeClass(qo.SURFACE_SCRIM_SHOWN),this.adapter.addClass(qo.SURFACE_SCRIM_HIDING)},e.prototype.handleSurfaceScrimTransitionEnd=function(){this.adapter.removeClass(qo.SURFACE_SCRIM_HIDING),this.adapter.removeClass(qo.SURFACE_SCRIM_SHOWING)},e.prototype.isOpen=function(){return this.dialogOpen},e.prototype.getEscapeKeyAction=function(){return this.escapeKeyAction},e.prototype.setEscapeKeyAction=function(t){this.escapeKeyAction=t},e.prototype.getScrimClickAction=function(){return this.scrimClickAction},e.prototype.setScrimClickAction=function(t){this.scrimClickAction=t},e.prototype.getAutoStackButtons=function(){return this.autoStackButtons},e.prototype.setAutoStackButtons=function(t){this.autoStackButtons=t},e.prototype.getSuppressDefaultPressSelector=function(){return this.suppressDefaultPressSelector},e.prototype.setSuppressDefaultPressSelector=function(t){this.suppressDefaultPressSelector=t},e.prototype.layout=function(){var t=this;this.animFrame.request(Zo.POLL_LAYOUT_CHANGE,(function(){t.layoutInternal()}))},e.prototype.handleClick=function(t){if(this.adapter.eventTargetMatches(t.target,Wo.SCRIM_SELECTOR)&&""!==this.scrimClickAction)this.close(this.scrimClickAction);else{var e=this.adapter.getActionFromEvent(t);e&&this.close(e)}},e.prototype.handleKeydown=function(t){var e="Enter"===t.key||13===t.keyCode;if(e&&!this.adapter.getActionFromEvent(t)){var i=t.composedPath?t.composedPath()[0]:t.target,r=!this.suppressDefaultPressSelector||!this.adapter.eventTargetMatches(i,this.suppressDefaultPressSelector);e&&r&&this.adapter.clickDefaultButton()}},e.prototype.handleDocumentKeydown=function(t){("Escape"===t.key||27===t.keyCode)&&""!==this.escapeKeyAction&&this.close(this.escapeKeyAction)},e.prototype.handleScrollEvent=function(){var t=this;this.animFrame.request(Zo.POLL_SCROLL_POS,(function(){t.toggleScrollDividerHeader(),t.toggleScrollDividerFooter()}))},e.prototype.layoutInternal=function(){this.autoStackButtons&&this.detectStackedButtons(),this.toggleScrollableClasses()},e.prototype.handleAnimationTimerEnd=function(){this.animationTimer=0,this.adapter.removeClass(qo.OPENING),this.adapter.removeClass(qo.CLOSING)},e.prototype.runNextAnimationFrame=function(t){var e=this;cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame((function(){e.animationFrame=0,clearTimeout(e.animationTimer),e.animationTimer=setTimeout(t,0)}))},e.prototype.detectStackedButtons=function(){this.adapter.removeClass(qo.STACKED);var t=this.adapter.areButtonsStacked();t&&this.adapter.addClass(qo.STACKED),t!==this.areButtonsStacked&&(this.adapter.reverseButtons(),this.areButtonsStacked=t)},e.prototype.toggleScrollableClasses=function(){this.adapter.removeClass(qo.SCROLLABLE),this.adapter.isContentScrollable()&&(this.adapter.addClass(qo.SCROLLABLE),this.isFullscreen&&(this.toggleScrollDividerHeader(),this.toggleScrollDividerFooter()))},e.prototype.toggleScrollDividerHeader=function(){this.adapter.isScrollableContentAtTop()?this.adapter.hasClass(qo.SCROLL_DIVIDER_HEADER)&&this.adapter.removeClass(qo.SCROLL_DIVIDER_HEADER):this.adapter.addClass(qo.SCROLL_DIVIDER_HEADER)},e.prototype.toggleScrollDividerFooter=function(){this.adapter.isScrollableContentAtBottom()?this.adapter.hasClass(qo.SCROLL_DIVIDER_FOOTER)&&this.adapter.removeClass(qo.SCROLL_DIVIDER_FOOTER):this.adapter.addClass(qo.SCROLL_DIVIDER_FOOTER)},e}(vt),Jo=Ko;function Qo(t){return void 0===t&&(t=window),!!function(t){void 0===t&&(t=window);var e=!1;try{var i={get passive(){return e=!0,!1}},r=function(){};t.document.addEventListener("test",r,i),t.document.removeEventListener("test",r,i)}catch(t){e=!1}return e}(t)&&{passive:!0}}const tl=document.$blockingElements;class el extends It{constructor(){super(...arguments),this.hideActions=!1,this.stacked=!1,this.heading="",this.scrimClickAction="close",this.escapeKeyAction="close",this.open=!1,this.defaultAction="close",this.actionAttribute="dialogAction",this.initialFocusAttribute="dialogInitialFocus",this.initialSupressDefaultPressSelector="",this.mdcFoundationClass=Jo,this.boundHandleClick=null,this.boundHandleKeydown=null,this.boundHandleDocumentKeydown=null}set suppressDefaultPressSelector(t){this.mdcFoundation?this.mdcFoundation.setSuppressDefaultPressSelector(t):this.initialSupressDefaultPressSelector=t}get suppressDefaultPressSelector(){return this.mdcFoundation?this.mdcFoundation.getSuppressDefaultPressSelector():this.initialSupressDefaultPressSelector}get primaryButton(){let t=this.primarySlot.assignedNodes();t=t.filter((t=>t instanceof HTMLElement));const e=t[0];return e||null}emitNotification(t,e){const i=new CustomEvent(t,{detail:e?{action:e}:{}});this.dispatchEvent(i)}getInitialFocusEl(){const t=`[${this.initialFocusAttribute}]`,e=this.querySelector(t);if(e)return e;const i=this.primarySlot.assignedNodes({flatten:!0}),r=this.searchNodeTreesForAttribute(i,this.initialFocusAttribute);if(r)return r;const n=this.secondarySlot.assignedNodes({flatten:!0}),a=this.searchNodeTreesForAttribute(n,this.initialFocusAttribute);if(a)return a;const s=this.contentSlot.assignedNodes({flatten:!0});return this.searchNodeTreesForAttribute(s,this.initialFocusAttribute)}searchNodeTreesForAttribute(t,e){for(const i of t)if(i instanceof HTMLElement){if(i.hasAttribute(e))return i;{const t=i.querySelector(`[${e}]`);if(t)return t}}return null}createAdapter(){return Object.assign(Object.assign({},kt(this.mdcRoot)),{addBodyClass:()=>document.body.style.overflow="hidden",removeBodyClass:()=>document.body.style.overflow="",areButtonsStacked:()=>this.stacked,clickDefaultButton:()=>{const t=this.primaryButton;t&&t.click()},eventTargetMatches:(t,e)=>!!t&&Kt(t,e),getActionFromEvent:t=>{if(!t.target)return"";const e=function(t,e){if(t.closest)return t.closest(e);for(var i=t;i;){if(Kt(i,e))return i;i=i.parentElement}return null}(t.target,`[${this.actionAttribute}]`);return e&&e.getAttribute(this.actionAttribute)},getInitialFocusEl:()=>this.getInitialFocusEl(),isContentScrollable:()=>{const t=this.contentElement;return!!t&&t.scrollHeight>t.offsetHeight},notifyClosed:t=>this.emitNotification("closed",t),notifyClosing:t=>{this.closingDueToDisconnect||(this.open=!1),this.emitNotification("closing",t)},notifyOpened:()=>this.emitNotification("opened"),notifyOpening:()=>{this.open=!0,this.emitNotification("opening")},reverseButtons:()=>{},releaseFocus:()=>{tl.remove(this)},trapFocus:t=>{this.isConnected&&(tl.push(this),t&&t.focus())},registerContentEventHandler:(t,e)=>{this.contentElement.addEventListener(t,e)},deregisterContentEventHandler:(t,e)=>{this.contentElement.removeEventListener(t,e)},isScrollableContentAtTop:()=>{const t=this.contentElement;return!!t&&0===t.scrollTop},isScrollableContentAtBottom:()=>{const t=this.contentElement;return!!t&&Math.ceil(t.scrollHeight-t.scrollTop)===t.clientHeight},registerWindowEventHandler:(t,e)=>{window.addEventListener(t,e,Qo())},deregisterWindowEventHandler:(t,e)=>{window.removeEventListener(t,e,Qo())}})}render(){const t={[qo.STACKED]:this.stacked};let e=M``;this.heading&&(e=this.renderHeading());const i={"mdc-dialog__actions":!this.hideActions};return M`
    <div class="mdc-dialog ${Ot(t)}"
        role="alertdialog"
        aria-modal="true"
        aria-labelledby="title"
        aria-describedby="content">
      <div class="mdc-dialog__container">
        <div class="mdc-dialog__surface">
          ${e}
          <div id="content" class="mdc-dialog__content">
            <slot id="contentSlot"></slot>
          </div>
          <footer
              id="actions"
              class="${Ot(i)}">
            <span>
              <slot name="secondaryAction"></slot>
            </span>
            <span>
             <slot name="primaryAction"></slot>
            </span>
          </footer>
        </div>
      </div>
      <div class="mdc-dialog__scrim"></div>
    </div>`}renderHeading(){return M`
      <h2 id="title" class="mdc-dialog__title">${this.heading}</h2>`}firstUpdated(){super.firstUpdated(),this.mdcFoundation.setAutoStackButtons(!0),this.initialSupressDefaultPressSelector?this.suppressDefaultPressSelector=this.initialSupressDefaultPressSelector:this.suppressDefaultPressSelector=[this.suppressDefaultPressSelector,"mwc-textarea","mwc-menu mwc-list-item","mwc-select mwc-list-item"].join(", "),this.boundHandleClick=this.mdcFoundation.handleClick.bind(this.mdcFoundation),this.boundHandleKeydown=this.mdcFoundation.handleKeydown.bind(this.mdcFoundation),this.boundHandleDocumentKeydown=this.mdcFoundation.handleDocumentKeydown.bind(this.mdcFoundation)}connectedCallback(){super.connectedCallback(),this.open&&this.mdcFoundation&&!this.mdcFoundation.isOpen()&&(this.setEventListeners(),this.mdcFoundation.open())}disconnectedCallback(){super.disconnectedCallback(),this.open&&this.mdcFoundation&&(this.removeEventListeners(),this.closingDueToDisconnect=!0,this.mdcFoundation.close(this.currentAction||this.defaultAction),this.closingDueToDisconnect=!1,this.currentAction=void 0,tl.remove(this))}forceLayout(){this.mdcFoundation.layout()}focus(){const t=this.getInitialFocusEl();t&&t.focus()}blur(){if(!this.shadowRoot)return;const t=this.shadowRoot.activeElement;if(t)t instanceof HTMLElement&&t.blur();else{const t=this.getRootNode(),e=t instanceof Document?t.activeElement:null;e instanceof HTMLElement&&e.blur()}}setEventListeners(){this.boundHandleClick&&this.mdcRoot.addEventListener("click",this.boundHandleClick),this.boundHandleKeydown&&this.mdcRoot.addEventListener("keydown",this.boundHandleKeydown,Qo()),this.boundHandleDocumentKeydown&&document.addEventListener("keydown",this.boundHandleDocumentKeydown,Qo())}removeEventListeners(){this.boundHandleClick&&this.mdcRoot.removeEventListener("click",this.boundHandleClick),this.boundHandleKeydown&&this.mdcRoot.removeEventListener("keydown",this.boundHandleKeydown),this.boundHandleDocumentKeydown&&document.removeEventListener("keydown",this.boundHandleDocumentKeydown)}close(){this.open=!1}show(){this.open=!0}}it([ht(".mdc-dialog")],el.prototype,"mdcRoot",void 0),it([ht('slot[name="primaryAction"]')],el.prototype,"primarySlot",void 0),it([ht('slot[name="secondaryAction"]')],el.prototype,"secondarySlot",void 0),it([ht("#contentSlot")],el.prototype,"contentSlot",void 0),it([ht(".mdc-dialog__content")],el.prototype,"contentElement",void 0),it([ht(".mdc-container")],el.prototype,"conatinerElement",void 0),it([ot({type:Boolean})],el.prototype,"hideActions",void 0),it([ot({type:Boolean}),Mt((function(){this.forceLayout()}))],el.prototype,"stacked",void 0),it([ot({type:String})],el.prototype,"heading",void 0),it([ot({type:String}),Mt((function(t){this.mdcFoundation.setScrimClickAction(t)}))],el.prototype,"scrimClickAction",void 0),it([ot({type:String}),Mt((function(t){this.mdcFoundation.setEscapeKeyAction(t)}))],el.prototype,"escapeKeyAction",void 0),it([ot({type:Boolean,reflect:!0}),Mt((function(t){this.mdcFoundation&&this.isConnected&&(t?(this.setEventListeners(),this.mdcFoundation.open()):(this.removeEventListeners(),this.mdcFoundation.close(this.currentAction||this.defaultAction),this.currentAction=void 0))}))],el.prototype,"open",void 0),it([ot()],el.prototype,"defaultAction",void 0),it([ot()],el.prototype,"actionAttribute",void 0),it([ot()],el.prototype,"initialFocusAttribute",void 0);const il=n`.mdc-dialog .mdc-dialog__surface{background-color:#fff;background-color:var(--mdc-theme-surface, #fff)}.mdc-dialog .mdc-dialog__scrim{background-color:rgba(0,0,0,.32)}.mdc-dialog .mdc-dialog__surface-scrim{background-color:rgba(0,0,0,.32)}.mdc-dialog .mdc-dialog__title{color:rgba(0,0,0,.87)}.mdc-dialog .mdc-dialog__content{color:rgba(0,0,0,.6)}.mdc-dialog .mdc-dialog__close{color:#000;color:var(--mdc-theme-on-surface, #000)}.mdc-dialog .mdc-dialog__close .mdc-icon-button__ripple::before,.mdc-dialog .mdc-dialog__close .mdc-icon-button__ripple::after{background-color:#000;background-color:var(--mdc-ripple-color, var(--mdc-theme-on-surface, #000))}.mdc-dialog .mdc-dialog__close:hover .mdc-icon-button__ripple::before,.mdc-dialog .mdc-dialog__close.mdc-ripple-surface--hover .mdc-icon-button__ripple::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-dialog .mdc-dialog__close.mdc-ripple-upgraded--background-focused .mdc-icon-button__ripple::before,.mdc-dialog .mdc-dialog__close:not(.mdc-ripple-upgraded):focus .mdc-icon-button__ripple::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-dialog .mdc-dialog__close:not(.mdc-ripple-upgraded) .mdc-icon-button__ripple::after{transition:opacity 150ms linear}.mdc-dialog .mdc-dialog__close:not(.mdc-ripple-upgraded):active .mdc-icon-button__ripple::after{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-dialog .mdc-dialog__close.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-dialog.mdc-dialog--scrollable .mdc-dialog__title,.mdc-dialog.mdc-dialog--scrollable .mdc-dialog__actions,.mdc-dialog.mdc-dialog--scrollable.mdc-dialog-scroll-divider-footer .mdc-dialog__actions{border-color:rgba(0,0,0,.12)}.mdc-dialog.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:1px solid rgba(0,0,0,.12);margin-bottom:0}.mdc-dialog.mdc-dialog-scroll-divider-header.mdc-dialog--fullscreen .mdc-dialog__header{box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2),0px 2px 2px 0px rgba(0, 0, 0, 0.14),0px 1px 5px 0px rgba(0,0,0,.12)}.mdc-dialog .mdc-dialog__surface{border-radius:4px;border-radius:var(--mdc-shape-medium, 4px)}.mdc-dialog__surface{box-shadow:0px 11px 15px -7px rgba(0, 0, 0, 0.2),0px 24px 38px 3px rgba(0, 0, 0, 0.14),0px 9px 46px 8px rgba(0,0,0,.12)}.mdc-dialog__title{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-headline6-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1.25rem;font-size:var(--mdc-typography-headline6-font-size, 1.25rem);line-height:2rem;line-height:var(--mdc-typography-headline6-line-height, 2rem);font-weight:500;font-weight:var(--mdc-typography-headline6-font-weight, 500);letter-spacing:0.0125em;letter-spacing:var(--mdc-typography-headline6-letter-spacing, 0.0125em);text-decoration:inherit;text-decoration:var(--mdc-typography-headline6-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-headline6-text-transform, inherit)}.mdc-dialog__content{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-body1-font-size, 1rem);line-height:1.5rem;line-height:var(--mdc-typography-body1-line-height, 1.5rem);font-weight:400;font-weight:var(--mdc-typography-body1-font-weight, 400);letter-spacing:0.03125em;letter-spacing:var(--mdc-typography-body1-letter-spacing, 0.03125em);text-decoration:inherit;text-decoration:var(--mdc-typography-body1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body1-text-transform, inherit)}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:0;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:#fff;background-color:var(--mdc-elevation-overlay-color, #fff)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:7;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(max-width: 600px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;transform:scale(0.8);opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid transparent;border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid transparent;display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid transparent}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid transparent}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{transform:none;opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1;z-index:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}#actions:not(.mdc-dialog__actions){display:none}.mdc-dialog__surface{box-shadow:var(--mdc-dialog-box-shadow, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}@media(min-width: 560px){.mdc-dialog .mdc-dialog__surface{max-width:560px;max-width:var(--mdc-dialog-max-width, 560px)}}.mdc-dialog .mdc-dialog__scrim{background-color:rgba(0, 0, 0, 0.32);background-color:var(--mdc-dialog-scrim-color, rgba(0, 0, 0, 0.32))}.mdc-dialog .mdc-dialog__title{color:rgba(0, 0, 0, 0.87);color:var(--mdc-dialog-heading-ink-color, rgba(0, 0, 0, 0.87))}.mdc-dialog .mdc-dialog__content{color:rgba(0, 0, 0, 0.6);color:var(--mdc-dialog-content-ink-color, rgba(0, 0, 0, 0.6))}.mdc-dialog.mdc-dialog--scrollable .mdc-dialog__title,.mdc-dialog.mdc-dialog--scrollable .mdc-dialog__actions{border-color:rgba(0, 0, 0, 0.12);border-color:var(--mdc-dialog-scroll-divider-color, rgba(0, 0, 0, 0.12))}.mdc-dialog .mdc-dialog__surface{min-width:280px;min-width:var(--mdc-dialog-min-width, 280px)}.mdc-dialog .mdc-dialog__surface{max-height:var(--mdc-dialog-max-height, calc(100% - 32px))}#actions ::slotted(*){margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] #actions ::slotted(*),#actions ::slotted(*[dir=rtl]){margin-left:0;margin-right:8px}[dir=rtl] #actions ::slotted(*),#actions ::slotted(*[dir=rtl]){text-align:left}.mdc-dialog--stacked #actions{flex-direction:column-reverse}.mdc-dialog--stacked #actions *:not(:last-child) ::slotted(*){flex-basis:.000000001px;margin-top:12px}`;let rl=class extends el{};rl.styles=[il],rl=it([at("mwc-dialog")],rl);window.customElements.define("grampsjs-list-item",class extends Fi{static get properties(){return{href:{type:String}}}static get styles(){return[super.styles,n`
        a {
          width: 100%;
          height: 100%;
          display: flex;
          align-items: center;
        }
      `]}render(){const t=super.render(),e=this.href?`${this.href}`:"";return M` ${this.renderRipple()}
      <a href=${e}> ${t} </a>`}});const nl=n`
  :host {
    --grampsjs-body-font-family: 'Inter var', sans-serif;
    --grampsjs-heading-font-family: 'Roboto Slab', serif;
    --md-ref-typeface-plain: 'Inter var', sans-serif;
    font-size: 18px;
    font-family: var(--grampsjs-body-font-family);
    font-weight: 300;
    --mdc-theme-primary: #6d4c41;
    --mdc-theme-on-primary: rgba(255, 255, 255, 0.95);
    --mdc-theme-secondary: #0277bd;
    --mdc-theme-on-secondary: rgba(255, 255, 255, 0.95);
    --mdc-theme-text-primary-on-background: rgba(0, 0, 0, 0.8);
    --mdc-theme-text-secondary-on-background: rgba(0, 0, 0, 0.45);
    --mdc-typography-font-family: var(--grampsjs-body-font-family);
    --color-boy: #64b5f6;
    --color-girl: #ef9a9a;
    --md-sys-color-primary: rgb(109 76 65);
    --md-sys-color-surface-tint: rgb(109 76 65);
    --md-sys-color-on-primary: rgb(255 255 255);
    --md-sys-color-primary-container: rgb(255 219 207);
    --md-sys-color-on-primary-container: rgb(57 12 0);
    --md-sys-color-secondary: rgb(49 98 141);
    --md-sys-color-on-secondary: rgb(255 255 255);
    --md-sys-color-secondary-container: rgb(207 229 255);
    --md-sys-color-on-secondary-container: rgb(0 29 52);
    --md-sys-color-tertiary: rgb(106 94 47);
    --md-sys-color-on-tertiary: rgb(255 255 255);
    --md-sys-color-tertiary-container: rgb(243 226 167);
    --md-sys-color-on-tertiary-container: rgb(34 27 0);
    --md-sys-color-error: rgb(186 26 26);
    --md-sys-color-on-error: rgb(255 255 255);
    --md-sys-color-error-container: rgb(255 218 214);
    --md-sys-color-on-error-container: rgb(65 0 2);
    --md-sys-color-background: rgb(255 248 246);
    --md-sys-color-on-background: rgb(35 25 23);
    --md-sys-color-surface: #fff;
    --md-sys-color-on-surface: rgb(35 25 23);
    --md-sys-color-surface-variant: rgb(245 222 215);
    --md-sys-color-on-surface-variant: rgb(83 67 63);
    --md-sys-color-outline: rgb(133 115 110);
    --md-sys-color-outline-variant: rgb(216 194 187);
    --md-sys-color-shadow: rgb(0 0 0);
    --md-sys-color-scrim: rgb(0 0 0);
    --md-sys-color-inverse-surface: rgb(57 46 43);
    --md-sys-color-inverse-on-surface: rgb(255 237 232);
    --md-sys-color-inverse-primary: rgb(255 181 156);
    --md-sys-color-primary-fixed: rgb(255 219 207);
    --md-sys-color-on-primary-fixed: rgb(57 12 0);
    --md-sys-color-primary-fixed-dim: rgb(255 181 156);
    --md-sys-color-on-primary-fixed-variant: rgb(114 53 32);
    --md-sys-color-secondary-fixed: rgb(207 229 255);
    --md-sys-color-on-secondary-fixed: rgb(0 29 52);
    --md-sys-color-secondary-fixed-dim: rgb(157 203 251);
    --md-sys-color-on-secondary-fixed-variant: rgb(18 74 115);
    --md-sys-color-tertiary-fixed: rgb(243 226 167);
    --md-sys-color-on-tertiary-fixed: rgb(34 27 0);
    --md-sys-color-tertiary-fixed-dim: rgb(214 198 141);
    --md-sys-color-on-tertiary-fixed-variant: rgb(81 70 26);
    --md-sys-color-surface-dim: rgb(232 214 209);
    --md-sys-color-surface-bright: rgb(255 248 246);
    --md-sys-color-surface-container-lowest: rgb(255 255 255);
    --md-sys-color-surface-container-low: rgb(255 241 237);
    --md-sys-color-surface-container: #fff;
    --md-sys-color-surface-container-high: #fff;
    --md-sys-color-surface-container-highest: #fff;
    --md-primary-tab-label-text-weight: 425;
    --md-primary-tab-label-text-size: 16px;
  }

  mwc-tab-bar {
    --mdc-typography-button-text-transform: none;
    --mdc-typography-button-font-weight: 400;
    --mdc-typography-button-letter-spacing: 0px;
    --mdc-typography-button-font-size: 16px;
    --mdc-tab-text-label-color-default: #6d4c41;
  }

  mwc-tab {
    flex-grow: 0;
  }

  label {
    display: inline-flex;
    place-items: center;
    gap: 12px;
    font-size: 15px;
    font-weight: 350;
    color: var(--md-sys-color-on-background, #000);
  }

  h2,
  h3,
  h4 {
    font-weight: 300;
    font-family: var(--grampsjs-heading-font-family);
  }

  h1 {
    font-weight: 400;
    font-family: var(--grampsjs-heading-font-family);
    font-size: 34px;
  }

  h2 {
    font-size: 32px;
    margin-top: 10px;
    margin-bottom: 30px;
  }

  h3 {
    font-size: 26px;
    margin-top: 30px;
    margin-bottom: 20px;
  }

  h4 {
    font-size: 20px;
  }

  h4.label {
    font-family: var(--grampsjs-body-font-family);
    font-size: 18px;
  }

  b,
  strong {
    font-weight: 600;
  }

  a:link,
  a:visited,
  span.link {
    color: #0d47a1;
    text-decoration: none;
  }

  a:hover,
  span.link:hover {
    color: #1976d2;
    text-decoration: underline;
    text-decoration-thickness: 1px;
    text-underline-offset: 0.2em;
  }

  .link {
    cursor: pointer;
  }

  .linkicon {
    --md-icon-size: 15px;
    margin-right: 8px;
    position: relative;
    bottom: -1px;
    opacity: 0.7;
  }

  .nopointer {
    pointer-events: none;
  }

  i svg {
    height: 1em;
    top: 0.125em;
    position: relative;
  }

  .md {
    font-weight: 400;
  }

  hr {
    border: 0;
    height: 0.5px;
    background: rgba(0, 0, 0, 0.4);
  }

  dt {
    font-size: 14px;
    color: rgba(0, 0, 0, 0.5);
    font-weight: 400;
    margin-bottom: 0.2em;
  }

  dd {
    margin: 0;
    padding: 0 0 1em 0;
  }

  dl div {
    float: left;
    margin-right: 3rem;
  }

  p {
    margin-top: 1.2em;
    margin-bottom: 1.2em;
  }

  h2 mwc-icon {
    color: rgba(0, 0, 0, 0.2);
    font-size: 1.05em;
    position: relative;
    top: 0.15em;
  }

  mwc-list {
    --mdc-list-item-graphic-margin: 16px;
  }

  mwc-list.large {
    --mdc-typography-subtitle1-color: rgba(0, 0, 0, 1);
    --mdc-typography-subtitle1-font-size: 18px;
    --mdc-typography-subtitle1-font-weight: 300;
    --mdc-typography-subtitle1-letter-spacing: -0.01em;
  }

  .avatar.skeleton {
    width: 44px;
    height: 44px;
    border-radius: 22px;
  }

  .float-right {
    float: right;
  }

  mwc-icon.inline {
    vertical-align: middle;
    size: 0.8em;
    padding-right: 0.2em;
    position: relative;
    bottom: auto;
    top: auto;
    color: rgba(0, 0, 0, 0.35);
  }

  mwc-icon.male {
    color: var(--color-boy);
  }

  mwc-icon.female {
    color: var(--color-girl);
  }

  .event {
    margin-right: 1em;
  }

  .event i svg path {
    fill: #999999;
  }

  .event i svg {
    height: 16px;
    width: auto;
  }

  .edit {
    color: var(--mdc-theme-secondary);
    --mdc-theme-primary: var(--mdc-theme-secondary);
    --mdc-theme-on-primary: var(--mdc-theme-on-secondary);
  }

  mwc-icon-button.large {
    --mdc-icon-size: 32px;
  }

  h2 .given-name {
    text-decoration: underline rgba(0, 0, 0, 0.6);
    text-underline-offset: 0.15em;
    text-decoration-thickness: 0.1rem;
  }

  span.skeleton {
    display: inline-block;
    background: #eee;
    background: linear-gradient(110deg, #ececec 8%, #f5f5f5 18%, #ececec 33%);
    opacity: 0.8;
    border-radius: 3px;
    background-size: 200% 100%;
    animation: 1.5s shine linear infinite;
  }

  .alert {
    background-color: rgba(109, 76, 65, 0.15);
    border-left: 4px solid rgba(109, 76, 65, 0.7);
    border-radius: 5px;
    padding: 0.8em 1em;
    font-size: 0.8em;
    color: rgba(0, 0, 0, 0.8);
    margin: 1.5em 0;
  }

  .alert.error {
    color: #bf360c;
    background-color: rgba(191, 54, 12, 0.2);
    border-left-color: rgba(191, 54, 12, 0.7);
  }

  .alert.warn {
    color: rgba(0, 0, 0, 0.5);
    background-color: rgba(251, 192, 45, 0.2);
    border-left-color: rgba(251, 192, 45, 0.7);
  }

  .success {
    color: #41ad49;
  }

  .error {
    color: #bf360c;
  }

  .warn {
    color: #f9a825;
  }

  @keyframes shine {
    to {
      background-position-x: -200%;
    }
  }

  grampsjs-task-progress-indicator.button {
    position: relative;
    top: 6px;
    left: 10px;
  }

  grampsjs-task-progress-indicator.button-left {
    position: relative;
    top: 6px;
    right: 10px;
  }

  h2.editable:hover {
    background-color: rgba(2, 119, 189, 0.2);
  }

  .monospace {
    font-family: 'Commit Mono';
    border: 1px solid rgba(0, 0, 0, 0.15);
    border-radius: 5px;
    background-color: rgba(0, 0, 0, 0.05);
    padding: 0.3em;
    font-size: 0.9em;
    color: rgb(125, 0, 0, 0.8);
  }

  @media (max-width: 768px) {
    :host {
      font-size: 16px;
    }

    h1 {
      font-size: 24px;
    }

    h2 {
      font-size: 24px;
    }

    h3 {
      font-size: 20px;
    }

    h4 {
      font-size: 18px;
    }
  }
`,al=t=>class extends t{static get properties(){return{strings:{type:Object}}}constructor(){super(),this.strings={}}_(t,...e){if(void 0===t)return"";let i=t;t in this.strings&&(i=this.strings[t]),i=i.replace("_","");for(let t=0;t<=e.length;t+=1)i=i.replace("%s",e[t]);return i}},sl=[["Person","/new_person","person"],["Family","/new_family","people"],["Event","/new_event","event"],["Place","/new_place","place"],["Source","/new_source","bookmarks"],["Citation","/new_citation","bookmark"],["Repository","/new_repository","account_balance"],["Note","/new_note","sticky_note_2"],["Media Object","/new_media","photo"],["Task","/new_task","task_alt"]];class ol extends(al(K)){static get styles(){return[nl,n`
        mwc-menu {
          --mdc-list-item-graphic-margin: 16px;
        }

        mwc-list-item.header {
          font-size: 14px;
          color: #666;
          font-weight: 400;
        }
      `]}render(){return M`
      <div style="position: relative;">
        <mwc-icon-button
          icon="add"
          @click="${this._handleClickAdd}"
          id="button_add"
        ></mwc-icon-button>
        <mwc-menu
          id="menu_add"
          corner="BOTTOM_RIGHT"
          menuCorner="END"
          x="0"
          y="0"
        >
          <mwc-list-item noninteractive class="header"
            >${this._("Add")}</mwc-list-item
          >
          <li divider role="separator"></li>
          ${sl.map((t=>this._menuItem(...t)))}
        </mwc-menu>
      </div>
    `}_menuItem(t,e,i){return M`
      <grampsjs-list-item href="${""}${e}" graphic="icon">
        <span>${this._(t)}</span>
        <mwc-icon slot="graphic">${i}</mwc-icon>
      </grampsjs-list-item>
    `}firstUpdated(){const t=this.shadowRoot.getElementById("button_add");this.shadowRoot.getElementById("menu_add").anchor=t}_handleClickAdd(){const t=this.shadowRoot.getElementById("menu_add");t.open=!t.open}}window.customElements.define("grampsjs-add-menu",ol);var ll="top",cl="bottom",dl="right",hl="left",pl="auto",ul=[ll,cl,dl,hl],ml="start",fl="end",gl="clippingParents",_l="viewport",vl="popper",yl="reference",bl=ul.reduce((function(t,e){return t.concat([e+"-"+ml,e+"-"+fl])}),[]),xl=[].concat(ul,[pl]).reduce((function(t,e){return t.concat([e,e+"-"+ml,e+"-"+fl])}),[]),wl=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function kl(t){return t?(t.nodeName||"").toLowerCase():null}function Tl(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Sl(t){return t instanceof Tl(t).Element||t instanceof Element}function Cl(t){return t instanceof Tl(t).HTMLElement||t instanceof HTMLElement}function El(t){return"undefined"!=typeof ShadowRoot&&(t instanceof Tl(t).ShadowRoot||t instanceof ShadowRoot)}var $l={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var i=e.styles[t]||{},r=e.attributes[t]||{},n=e.elements[t];Cl(n)&&kl(n)&&(Object.assign(n.style,i),Object.keys(r).forEach((function(t){var e=r[t];!1===e?n.removeAttribute(t):n.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach((function(t){var r=e.elements[t],n=e.attributes[t]||{},a=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:i[t]).reduce((function(t,e){return t[e]="",t}),{});Cl(r)&&kl(r)&&(Object.assign(r.style,a),Object.keys(n).forEach((function(t){r.removeAttribute(t)})))}))}},requires:["computeStyles"]};function Al(t){return t.split("-")[0]}var Il=Math.max,Ml=Math.min,Ll=Math.round;function Pl(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map((function(t){return t.brand+"/"+t.version})).join(" "):navigator.userAgent}function Rl(){return!/^((?!chrome|android).)*safari/i.test(Pl())}function zl(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var r=t.getBoundingClientRect(),n=1,a=1;e&&Cl(t)&&(n=t.offsetWidth>0&&Ll(r.width)/t.offsetWidth||1,a=t.offsetHeight>0&&Ll(r.height)/t.offsetHeight||1);var s=(Sl(t)?Tl(t):window).visualViewport,o=!Rl()&&i,l=(r.left+(o&&s?s.offsetLeft:0))/n,c=(r.top+(o&&s?s.offsetTop:0))/a,d=r.width/n,h=r.height/a;return{width:d,height:h,top:c,right:l+d,bottom:c+h,left:l,x:l,y:c}}function Dl(t){var e=zl(t),i=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:i,height:r}}function jl(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(i&&El(i)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Ol(t){return Tl(t).getComputedStyle(t)}function Bl(t){return["table","td","th"].indexOf(kl(t))>=0}function Fl(t){return((Sl(t)?t.ownerDocument:t.document)||window.document).documentElement}function Nl(t){return"html"===kl(t)?t:t.assignedSlot||t.parentNode||(El(t)?t.host:null)||Fl(t)}function Hl(t){return Cl(t)&&"fixed"!==Ol(t).position?t.offsetParent:null}function Vl(t){for(var e=Tl(t),i=Hl(t);i&&Bl(i)&&"static"===Ol(i).position;)i=Hl(i);return i&&("html"===kl(i)||"body"===kl(i)&&"static"===Ol(i).position)?e:i||function(t){var e=/firefox/i.test(Pl());if(/Trident/i.test(Pl())&&Cl(t)&&"fixed"===Ol(t).position)return null;var i=Nl(t);for(El(i)&&(i=i.host);Cl(i)&&["html","body"].indexOf(kl(i))<0;){var r=Ol(i);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||e&&"filter"===r.willChange||e&&r.filter&&"none"!==r.filter)return i;i=i.parentNode}return null}(t)||e}function Ul(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Yl(t,e,i){return Il(t,Ml(e,i))}function Zl(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function ql(t,e){return e.reduce((function(e,i){return e[i]=t,e}),{})}var Wl={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,i=t.state,r=t.name,n=t.options,a=i.elements.arrow,s=i.modifiersData.popperOffsets,o=Al(i.placement),l=Ul(o),c=[hl,dl].indexOf(o)>=0?"height":"width";if(a&&s){var d=function(t,e){return Zl("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:ql(t,ul))}(n.padding,i),h=Dl(a),p="y"===l?ll:hl,u="y"===l?cl:dl,m=i.rects.reference[c]+i.rects.reference[l]-s[l]-i.rects.popper[c],f=s[l]-i.rects.reference[l],g=Vl(a),_=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,v=m/2-f/2,y=d[p],b=_-h[c]-d[u],x=_/2-h[c]/2+v,w=Yl(y,x,b),k=l;i.modifiersData[r]=((e={})[k]=w,e.centerOffset=w-x,e)}},effect:function(t){var e=t.state,i=t.options.element,r=void 0===i?"[data-popper-arrow]":i;null!=r&&("string"!=typeof r||(r=e.elements.popper.querySelector(r)))&&jl(e.elements.popper,r)&&(e.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Gl(t){return t.split("-")[1]}var Xl={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Kl(t){var e,i=t.popper,r=t.popperRect,n=t.placement,a=t.variation,s=t.offsets,o=t.position,l=t.gpuAcceleration,c=t.adaptive,d=t.roundOffsets,h=t.isFixed,p=s.x,u=void 0===p?0:p,m=s.y,f=void 0===m?0:m,g="function"==typeof d?d({x:u,y:f}):{x:u,y:f};u=g.x,f=g.y;var _=s.hasOwnProperty("x"),v=s.hasOwnProperty("y"),y=hl,b=ll,x=window;if(c){var w=Vl(i),k="clientHeight",T="clientWidth";if(w===Tl(i)&&"static"!==Ol(w=Fl(i)).position&&"absolute"===o&&(k="scrollHeight",T="scrollWidth"),n===ll||(n===hl||n===dl)&&a===fl)b=cl,f-=(h&&w===x&&x.visualViewport?x.visualViewport.height:w[k])-r.height,f*=l?1:-1;if(n===hl||(n===ll||n===cl)&&a===fl)y=dl,u-=(h&&w===x&&x.visualViewport?x.visualViewport.width:w[T])-r.width,u*=l?1:-1}var S,C=Object.assign({position:o},c&&Xl),E=!0===d?function(t,e){var i=t.x,r=t.y,n=e.devicePixelRatio||1;return{x:Ll(i*n)/n||0,y:Ll(r*n)/n||0}}({x:u,y:f},Tl(i)):{x:u,y:f};return u=E.x,f=E.y,l?Object.assign({},C,((S={})[b]=v?"0":"",S[y]=_?"0":"",S.transform=(x.devicePixelRatio||1)<=1?"translate("+u+"px, "+f+"px)":"translate3d("+u+"px, "+f+"px, 0)",S)):Object.assign({},C,((e={})[b]=v?f+"px":"",e[y]=_?u+"px":"",e.transform="",e))}var Jl={passive:!0};var Ql={left:"right",right:"left",bottom:"top",top:"bottom"};function tc(t){return t.replace(/left|right|bottom|top/g,(function(t){return Ql[t]}))}var ec={start:"end",end:"start"};function ic(t){return t.replace(/start|end/g,(function(t){return ec[t]}))}function rc(t){var e=Tl(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function nc(t){return zl(Fl(t)).left+rc(t).scrollLeft}function ac(t){var e=Ol(t),i=e.overflow,r=e.overflowX,n=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+n+r)}function sc(t){return["html","body","#document"].indexOf(kl(t))>=0?t.ownerDocument.body:Cl(t)&&ac(t)?t:sc(Nl(t))}function oc(t,e){var i;void 0===e&&(e=[]);var r=sc(t),n=r===(null==(i=t.ownerDocument)?void 0:i.body),a=Tl(r),s=n?[a].concat(a.visualViewport||[],ac(r)?r:[]):r,o=e.concat(s);return n?o:o.concat(oc(Nl(s)))}function lc(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function cc(t,e,i){return e===_l?lc(function(t,e){var i=Tl(t),r=Fl(t),n=i.visualViewport,a=r.clientWidth,s=r.clientHeight,o=0,l=0;if(n){a=n.width,s=n.height;var c=Rl();(c||!c&&"fixed"===e)&&(o=n.offsetLeft,l=n.offsetTop)}return{width:a,height:s,x:o+nc(t),y:l}}(t,i)):Sl(e)?function(t,e){var i=zl(t,!1,"fixed"===e);return i.top=i.top+t.clientTop,i.left=i.left+t.clientLeft,i.bottom=i.top+t.clientHeight,i.right=i.left+t.clientWidth,i.width=t.clientWidth,i.height=t.clientHeight,i.x=i.left,i.y=i.top,i}(e,i):lc(function(t){var e,i=Fl(t),r=rc(t),n=null==(e=t.ownerDocument)?void 0:e.body,a=Il(i.scrollWidth,i.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),s=Il(i.scrollHeight,i.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),o=-r.scrollLeft+nc(t),l=-r.scrollTop;return"rtl"===Ol(n||i).direction&&(o+=Il(i.clientWidth,n?n.clientWidth:0)-a),{width:a,height:s,x:o,y:l}}(Fl(t)))}function dc(t,e,i,r){var n="clippingParents"===e?function(t){var e=oc(Nl(t)),i=["absolute","fixed"].indexOf(Ol(t).position)>=0&&Cl(t)?Vl(t):t;return Sl(i)?e.filter((function(t){return Sl(t)&&jl(t,i)&&"body"!==kl(t)})):[]}(t):[].concat(e),a=[].concat(n,[i]),s=a[0],o=a.reduce((function(e,i){var n=cc(t,i,r);return e.top=Il(n.top,e.top),e.right=Ml(n.right,e.right),e.bottom=Ml(n.bottom,e.bottom),e.left=Il(n.left,e.left),e}),cc(t,s,r));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function hc(t){var e,i=t.reference,r=t.element,n=t.placement,a=n?Al(n):null,s=n?Gl(n):null,o=i.x+i.width/2-r.width/2,l=i.y+i.height/2-r.height/2;switch(a){case ll:e={x:o,y:i.y-r.height};break;case cl:e={x:o,y:i.y+i.height};break;case dl:e={x:i.x+i.width,y:l};break;case hl:e={x:i.x-r.width,y:l};break;default:e={x:i.x,y:i.y}}var c=a?Ul(a):null;if(null!=c){var d="y"===c?"height":"width";switch(s){case ml:e[c]=e[c]-(i[d]/2-r[d]/2);break;case fl:e[c]=e[c]+(i[d]/2-r[d]/2)}}return e}function pc(t,e){void 0===e&&(e={});var i=e,r=i.placement,n=void 0===r?t.placement:r,a=i.strategy,s=void 0===a?t.strategy:a,o=i.boundary,l=void 0===o?gl:o,c=i.rootBoundary,d=void 0===c?_l:c,h=i.elementContext,p=void 0===h?vl:h,u=i.altBoundary,m=void 0!==u&&u,f=i.padding,g=void 0===f?0:f,_=Zl("number"!=typeof g?g:ql(g,ul)),v=p===vl?yl:vl,y=t.rects.popper,b=t.elements[m?v:p],x=dc(Sl(b)?b:b.contextElement||Fl(t.elements.popper),l,d,s),w=zl(t.elements.reference),k=hc({reference:w,element:y,strategy:"absolute",placement:n}),T=lc(Object.assign({},y,k)),S=p===vl?T:w,C={top:x.top-S.top+_.top,bottom:S.bottom-x.bottom+_.bottom,left:x.left-S.left+_.left,right:S.right-x.right+_.right},E=t.modifiersData.offset;if(p===vl&&E){var $=E[n];Object.keys(C).forEach((function(t){var e=[dl,cl].indexOf(t)>=0?1:-1,i=[ll,cl].indexOf(t)>=0?"y":"x";C[t]+=$[i]*e}))}return C}function uc(t,e){void 0===e&&(e={});var i=e,r=i.placement,n=i.boundary,a=i.rootBoundary,s=i.padding,o=i.flipVariations,l=i.allowedAutoPlacements,c=void 0===l?xl:l,d=Gl(r),h=d?o?bl:bl.filter((function(t){return Gl(t)===d})):ul,p=h.filter((function(t){return c.indexOf(t)>=0}));0===p.length&&(p=h);var u=p.reduce((function(e,i){return e[i]=pc(t,{placement:i,boundary:n,rootBoundary:a,padding:s})[Al(i)],e}),{});return Object.keys(u).sort((function(t,e){return u[t]-u[e]}))}var mc={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var n=i.mainAxis,a=void 0===n||n,s=i.altAxis,o=void 0===s||s,l=i.fallbackPlacements,c=i.padding,d=i.boundary,h=i.rootBoundary,p=i.altBoundary,u=i.flipVariations,m=void 0===u||u,f=i.allowedAutoPlacements,g=e.options.placement,_=Al(g),v=l||(_===g||!m?[tc(g)]:function(t){if(Al(t)===pl)return[];var e=tc(t);return[ic(t),e,ic(e)]}(g)),y=[g].concat(v).reduce((function(t,i){return t.concat(Al(i)===pl?uc(e,{placement:i,boundary:d,rootBoundary:h,padding:c,flipVariations:m,allowedAutoPlacements:f}):i)}),[]),b=e.rects.reference,x=e.rects.popper,w=new Map,k=!0,T=y[0],S=0;S<y.length;S++){var C=y[S],E=Al(C),$=Gl(C)===ml,A=[ll,cl].indexOf(E)>=0,I=A?"width":"height",M=pc(e,{placement:C,boundary:d,rootBoundary:h,altBoundary:p,padding:c}),L=A?$?dl:hl:$?cl:ll;b[I]>x[I]&&(L=tc(L));var P=tc(L),R=[];if(a&&R.push(M[E]<=0),o&&R.push(M[L]<=0,M[P]<=0),R.every((function(t){return t}))){T=C,k=!1;break}w.set(C,R)}if(k)for(var z=function(t){var e=y.find((function(e){var i=w.get(e);if(i)return i.slice(0,t).every((function(t){return t}))}));if(e)return T=e,"break"},D=m?3:1;D>0;D--){if("break"===z(D))break}e.placement!==T&&(e.modifiersData[r]._skip=!0,e.placement=T,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function fc(t,e,i){return void 0===i&&(i={x:0,y:0}),{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function gc(t){return[ll,dl,cl,hl].some((function(e){return t[e]>=0}))}var _c={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,i=t.options,r=t.name,n=i.offset,a=void 0===n?[0,0]:n,s=xl.reduce((function(t,i){return t[i]=function(t,e,i){var r=Al(t),n=[hl,ll].indexOf(r)>=0?-1:1,a="function"==typeof i?i(Object.assign({},e,{placement:t})):i,s=a[0],o=a[1];return s=s||0,o=(o||0)*n,[hl,dl].indexOf(r)>=0?{x:o,y:s}:{x:s,y:o}}(i,e.rects,a),t}),{}),o=s[e.placement],l=o.x,c=o.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=s}};var vc={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,r=t.name,n=i.mainAxis,a=void 0===n||n,s=i.altAxis,o=void 0!==s&&s,l=i.boundary,c=i.rootBoundary,d=i.altBoundary,h=i.padding,p=i.tether,u=void 0===p||p,m=i.tetherOffset,f=void 0===m?0:m,g=pc(e,{boundary:l,rootBoundary:c,padding:h,altBoundary:d}),_=Al(e.placement),v=Gl(e.placement),y=!v,b=Ul(_),x=function(t){return"x"===t?"y":"x"}(b),w=e.modifiersData.popperOffsets,k=e.rects.reference,T=e.rects.popper,S="function"==typeof f?f(Object.assign({},e.rects,{placement:e.placement})):f,C="number"==typeof S?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),E=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,$={x:0,y:0};if(w){if(a){var A,I="y"===b?ll:hl,M="y"===b?cl:dl,L="y"===b?"height":"width",P=w[b],R=P+g[I],z=P-g[M],D=u?-T[L]/2:0,j=v===ml?k[L]:T[L],O=v===ml?-T[L]:-k[L],B=e.elements.arrow,F=u&&B?Dl(B):{width:0,height:0},N=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},H=N[I],V=N[M],U=Yl(0,k[L],F[L]),Y=y?k[L]/2-D-U-H-C.mainAxis:j-U-H-C.mainAxis,Z=y?-k[L]/2+D+U+V+C.mainAxis:O+U+V+C.mainAxis,q=e.elements.arrow&&Vl(e.elements.arrow),W=q?"y"===b?q.clientTop||0:q.clientLeft||0:0,G=null!=(A=null==E?void 0:E[b])?A:0,X=P+Z-G,K=Yl(u?Ml(R,P+Y-G-W):R,P,u?Il(z,X):z);w[b]=K,$[b]=K-P}if(o){var J,Q="x"===b?ll:hl,tt="x"===b?cl:dl,et=w[x],it="y"===x?"height":"width",rt=et+g[Q],nt=et-g[tt],at=-1!==[ll,hl].indexOf(_),st=null!=(J=null==E?void 0:E[x])?J:0,ot=at?rt:et-k[it]-T[it]-st+C.altAxis,lt=at?et+k[it]+T[it]-st-C.altAxis:nt,ct=u&&at?function(t,e,i){var r=Yl(t,e,i);return r>i?i:r}(ot,et,lt):Yl(u?ot:rt,et,u?lt:nt);w[x]=ct,$[x]=ct-et}e.modifiersData[r]=$}},requiresIfExists:["offset"]};function yc(t,e,i){void 0===i&&(i=!1);var r,n,a=Cl(e),s=Cl(e)&&function(t){var e=t.getBoundingClientRect(),i=Ll(e.width)/t.offsetWidth||1,r=Ll(e.height)/t.offsetHeight||1;return 1!==i||1!==r}(e),o=Fl(e),l=zl(t,s,i),c={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(a||!a&&!i)&&(("body"!==kl(e)||ac(o))&&(c=(r=e)!==Tl(r)&&Cl(r)?{scrollLeft:(n=r).scrollLeft,scrollTop:n.scrollTop}:rc(r)),Cl(e)?((d=zl(e,!0)).x+=e.clientLeft,d.y+=e.clientTop):o&&(d.x=nc(o))),{x:l.left+c.scrollLeft-d.x,y:l.top+c.scrollTop-d.y,width:l.width,height:l.height}}function bc(t){var e=new Map,i=new Set,r=[];function n(t){i.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!i.has(t)){var r=e.get(t);r&&n(r)}})),r.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){i.has(t.name)||n(t)})),r}function xc(t){var e;return function(){return e||(e=new Promise((function(i){Promise.resolve().then((function(){e=void 0,i(t())}))}))),e}}var wc={placement:"bottom",modifiers:[],strategy:"absolute"};function kc(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function Tc(t){void 0===t&&(t={});var e=t,i=e.defaultModifiers,r=void 0===i?[]:i,n=e.defaultOptions,a=void 0===n?wc:n;return function(t,e,i){void 0===i&&(i=a);var n={placement:"bottom",orderedModifiers:[],options:Object.assign({},wc,a),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},s=[],o=!1,l={state:n,setOptions:function(i){var o="function"==typeof i?i(n.options):i;c(),n.options=Object.assign({},a,n.options,o),n.scrollParents={reference:Sl(t)?oc(t):t.contextElement?oc(t.contextElement):[],popper:oc(e)};var d=function(t){var e=bc(t);return wl.reduce((function(t,i){return t.concat(e.filter((function(t){return t.phase===i})))}),[])}(function(t){var e=t.reduce((function(t,e){var i=t[e.name];return t[e.name]=i?Object.assign({},i,e,{options:Object.assign({},i.options,e.options),data:Object.assign({},i.data,e.data)}):e,t}),{});return Object.keys(e).map((function(t){return e[t]}))}([].concat(r,n.options.modifiers)));return n.orderedModifiers=d.filter((function(t){return t.enabled})),n.orderedModifiers.forEach((function(t){var e=t.name,i=t.options,r=void 0===i?{}:i,a=t.effect;if("function"==typeof a){var o=a({state:n,name:e,instance:l,options:r}),c=function(){};s.push(o||c)}})),l.update()},forceUpdate:function(){if(!o){var t=n.elements,e=t.reference,i=t.popper;if(kc(e,i)){n.rects={reference:yc(e,Vl(i),"fixed"===n.options.strategy),popper:Dl(i)},n.reset=!1,n.placement=n.options.placement,n.orderedModifiers.forEach((function(t){return n.modifiersData[t.name]=Object.assign({},t.data)}));for(var r=0;r<n.orderedModifiers.length;r++)if(!0!==n.reset){var a=n.orderedModifiers[r],s=a.fn,c=a.options,d=void 0===c?{}:c,h=a.name;"function"==typeof s&&(n=s({state:n,options:d,name:h,instance:l})||n)}else n.reset=!1,r=-1}}},update:xc((function(){return new Promise((function(t){l.forceUpdate(),t(n)}))})),destroy:function(){c(),o=!0}};if(!kc(t,e))return l;function c(){s.forEach((function(t){return t()})),s=[]}return l.setOptions(i).then((function(t){!o&&i.onFirstUpdate&&i.onFirstUpdate(t)})),l}}var Sc=Tc({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,i=t.instance,r=t.options,n=r.scroll,a=void 0===n||n,s=r.resize,o=void 0===s||s,l=Tl(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&c.forEach((function(t){t.addEventListener("scroll",i.update,Jl)})),o&&l.addEventListener("resize",i.update,Jl),function(){a&&c.forEach((function(t){t.removeEventListener("scroll",i.update,Jl)})),o&&l.removeEventListener("resize",i.update,Jl)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,i=t.name;e.modifiersData[i]=hc({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,i=t.options,r=i.gpuAcceleration,n=void 0===r||r,a=i.adaptive,s=void 0===a||a,o=i.roundOffsets,l=void 0===o||o,c={placement:Al(e.placement),variation:Gl(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:n,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,Kl(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,Kl(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},$l,_c,mc,vc,Wl,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,i=t.name,r=e.rects.reference,n=e.rects.popper,a=e.modifiersData.preventOverflow,s=pc(e,{elementContext:"reference"}),o=pc(e,{altBoundary:!0}),l=fc(s,r),c=fc(o,n,a),d=gc(l),h=gc(c);e.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":h})}}]}),Cc="tippy-content",Ec="tippy-backdrop",$c="tippy-arrow",Ac="tippy-svg-arrow",Ic={passive:!0,capture:!0},Mc=function(){return document.body};function Lc(t,e,i){if(Array.isArray(t)){var r=t[e];return null==r?Array.isArray(i)?i[e]:i:r}return t}function Pc(t,e){var i={}.toString.call(t);return 0===i.indexOf("[object")&&i.indexOf(e+"]")>-1}function Rc(t,e){return"function"==typeof t?t.apply(void 0,e):t}function zc(t,e){return 0===e?t:function(r){clearTimeout(i),i=setTimeout((function(){t(r)}),e)};var i}function Dc(t){return[].concat(t)}function jc(t,e){-1===t.indexOf(e)&&t.push(e)}function Oc(t){return[].slice.call(t)}function Bc(t){return Object.keys(t).reduce((function(e,i){return void 0!==t[i]&&(e[i]=t[i]),e}),{})}function Fc(){return document.createElement("div")}function Nc(t){return["Element","Fragment"].some((function(e){return Pc(t,e)}))}function Hc(t){return Nc(t)?[t]:function(t){return Pc(t,"NodeList")}(t)?Oc(t):Array.isArray(t)?t:Oc(document.querySelectorAll(t))}function Vc(t,e){t.forEach((function(t){t&&(t.style.transitionDuration=e+"ms")}))}function Uc(t,e){t.forEach((function(t){t&&t.setAttribute("data-state",e)}))}function Yc(t,e,i){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(e){t[r](e,i)}))}function Zc(t,e){for(var i=e;i;){var r;if(t.contains(i))return!0;i=null==i.getRootNode||null==(r=i.getRootNode())?void 0:r.host}return!1}var qc={isTouch:!1},Wc=0;function Gc(){qc.isTouch||(qc.isTouch=!0,window.performance&&document.addEventListener("mousemove",Xc))}function Xc(){var t=performance.now();t-Wc<20&&(qc.isTouch=!1,document.removeEventListener("mousemove",Xc)),Wc=t}function Kc(){var t,e=document.activeElement;if((t=e)&&t._tippy&&t._tippy.reference===t){var i=e._tippy;e.blur&&!i.state.isVisible&&e.blur()}}var Jc=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto,Qc=Object.assign({appendTo:Mc,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),td=Object.keys(Qc);function ed(t){var e=(t.plugins||[]).reduce((function(e,i){var r,n=i.name,a=i.defaultValue;n&&(e[n]=void 0!==t[n]?t[n]:null!=(r=Qc[n])?r:a);return e}),{});return Object.assign({},t,e)}function id(t,e){var i=Object.assign({},e,{content:Rc(e.content,[t])},e.ignoreAttributes?{}:function(t,e){return(e?Object.keys(ed(Object.assign({},Qc,{plugins:e}))):td).reduce((function(e,i){var r=(t.getAttribute("data-tippy-"+i)||"").trim();if(!r)return e;if("content"===i)e[i]=r;else try{e[i]=JSON.parse(r)}catch(t){e[i]=r}return e}),{})}(t,e.plugins));return i.aria=Object.assign({},Qc.aria,i.aria),i.aria={expanded:"auto"===i.aria.expanded?e.interactive:i.aria.expanded,content:"auto"===i.aria.content?e.interactive?null:"describedby":i.aria.content},i}var rd=function(){return"innerHTML"};function nd(t,e){t[rd()]=e}function ad(t){var e=Fc();return!0===t?e.className=$c:(e.className=Ac,Nc(t)?e.appendChild(t):nd(e,t)),e}function sd(t,e){Nc(e.content)?(nd(t,""),t.appendChild(e.content)):"function"!=typeof e.content&&(e.allowHTML?nd(t,e.content):t.textContent=e.content)}function od(t){var e=t.firstElementChild,i=Oc(e.children);return{box:e,content:i.find((function(t){return t.classList.contains(Cc)})),arrow:i.find((function(t){return t.classList.contains($c)||t.classList.contains(Ac)})),backdrop:i.find((function(t){return t.classList.contains(Ec)}))}}function ld(t){var e=Fc(),i=Fc();i.className="tippy-box",i.setAttribute("data-state","hidden"),i.setAttribute("tabindex","-1");var r=Fc();function n(i,r){var n=od(e),a=n.box,s=n.content,o=n.arrow;r.theme?a.setAttribute("data-theme",r.theme):a.removeAttribute("data-theme"),"string"==typeof r.animation?a.setAttribute("data-animation",r.animation):a.removeAttribute("data-animation"),r.inertia?a.setAttribute("data-inertia",""):a.removeAttribute("data-inertia"),a.style.maxWidth="number"==typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?a.setAttribute("role",r.role):a.removeAttribute("role"),i.content===r.content&&i.allowHTML===r.allowHTML||sd(s,t.props),r.arrow?o?i.arrow!==r.arrow&&(a.removeChild(o),a.appendChild(ad(r.arrow))):a.appendChild(ad(r.arrow)):o&&a.removeChild(o)}return r.className=Cc,r.setAttribute("data-state","hidden"),sd(r,t.props),e.appendChild(i),i.appendChild(r),n(t.props,t.props),{popper:e,onUpdate:n}}ld.$$tippy=!0;var cd=1,dd=[],hd=[];function pd(t,e){var i,r,n,a,s,o,l,c,d=id(t,Object.assign({},Qc,ed(Bc(e)))),h=!1,p=!1,u=!1,m=!1,f=[],g=zc(q,d.interactiveDebounce),_=cd++,v=(c=d.plugins).filter((function(t,e){return c.indexOf(t)===e})),y={id:_,reference:t,popper:Fc(),popperInstance:null,props:d,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:v,clearDelayTimeouts:function(){clearTimeout(i),clearTimeout(r),cancelAnimationFrame(n)},setProps:function(e){if(y.state.isDestroyed)return;P("onBeforeUpdate",[y,e]),Y();var i=y.props,r=id(t,Object.assign({},i,Bc(e),{ignoreAttributes:!0}));y.props=r,U(),i.interactiveDebounce!==r.interactiveDebounce&&(D(),g=zc(q,r.interactiveDebounce));i.triggerTarget&&!r.triggerTarget?Dc(i.triggerTarget).forEach((function(t){t.removeAttribute("aria-expanded")})):r.triggerTarget&&t.removeAttribute("aria-expanded");z(),L(),w&&w(i,r);y.popperInstance&&(K(),Q().forEach((function(t){requestAnimationFrame(t._tippy.popperInstance.forceUpdate)})));P("onAfterUpdate",[y,e])},setContent:function(t){y.setProps({content:t})},show:function(){var t=y.state.isVisible,e=y.state.isDestroyed,i=!y.state.isEnabled,r=qc.isTouch&&!y.props.touch,n=Lc(y.props.duration,0,Qc.duration);if(t||e||i||r)return;if($().hasAttribute("disabled"))return;if(P("onShow",[y],!1),!1===y.props.onShow(y))return;y.state.isVisible=!0,E()&&(x.style.visibility="visible");L(),F(),y.state.isMounted||(x.style.transition="none");if(E()){var a=I();Vc([a.box,a.content],0)}o=function(){var t;if(y.state.isVisible&&!m){if(m=!0,x.offsetHeight,x.style.transition=y.props.moveTransition,E()&&y.props.animation){var e=I(),i=e.box,r=e.content;Vc([i,r],n),Uc([i,r],"visible")}R(),z(),jc(hd,y),null==(t=y.popperInstance)||t.forceUpdate(),P("onMount",[y]),y.props.animation&&E()&&function(t,e){H(t,e)}(n,(function(){y.state.isShown=!0,P("onShown",[y])}))}},function(){var t,e=y.props.appendTo,i=$();t=y.props.interactive&&e===Mc||"parent"===e?i.parentNode:Rc(e,[i]);t.contains(x)||t.appendChild(x);y.state.isMounted=!0,K()}()},hide:function(){var t=!y.state.isVisible,e=y.state.isDestroyed,i=!y.state.isEnabled,r=Lc(y.props.duration,1,Qc.duration);if(t||e||i)return;if(P("onHide",[y],!1),!1===y.props.onHide(y))return;y.state.isVisible=!1,y.state.isShown=!1,m=!1,h=!1,E()&&(x.style.visibility="hidden");if(D(),N(),L(!0),E()){var n=I(),a=n.box,s=n.content;y.props.animation&&(Vc([a,s],r),Uc([a,s],"hidden"))}R(),z(),y.props.animation?E()&&function(t,e){H(t,(function(){!y.state.isVisible&&x.parentNode&&x.parentNode.contains(x)&&e()}))}(r,y.unmount):y.unmount()},hideWithInteractivity:function(t){A().addEventListener("mousemove",g),jc(dd,g),g(t)},enable:function(){y.state.isEnabled=!0},disable:function(){y.hide(),y.state.isEnabled=!1},unmount:function(){y.state.isVisible&&y.hide();if(!y.state.isMounted)return;J(),Q().forEach((function(t){t._tippy.unmount()})),x.parentNode&&x.parentNode.removeChild(x);hd=hd.filter((function(t){return t!==y})),y.state.isMounted=!1,P("onHidden",[y])},destroy:function(){if(y.state.isDestroyed)return;y.clearDelayTimeouts(),y.unmount(),Y(),delete t._tippy,y.state.isDestroyed=!0,P("onDestroy",[y])}};if(!d.render)return y;var b=d.render(y),x=b.popper,w=b.onUpdate;x.setAttribute("data-tippy-root",""),x.id="tippy-"+y.id,y.popper=x,t._tippy=y,x._tippy=y;var k=v.map((function(t){return t.fn(y)})),T=t.hasAttribute("aria-expanded");return U(),z(),L(),P("onCreate",[y]),d.showOnCreate&&tt(),x.addEventListener("mouseenter",(function(){y.props.interactive&&y.state.isVisible&&y.clearDelayTimeouts()})),x.addEventListener("mouseleave",(function(){y.props.interactive&&y.props.trigger.indexOf("mouseenter")>=0&&A().addEventListener("mousemove",g)})),y;function S(){var t=y.props.touch;return Array.isArray(t)?t:[t,0]}function C(){return"hold"===S()[0]}function E(){var t;return!(null==(t=y.props.render)||!t.$$tippy)}function $(){return l||t}function A(){var t,e,i=$().parentNode;return i?null!=(e=Dc(i)[0])&&null!=(t=e.ownerDocument)&&t.body?e.ownerDocument:document:document}function I(){return od(x)}function M(t){return y.state.isMounted&&!y.state.isVisible||qc.isTouch||a&&"focus"===a.type?0:Lc(y.props.delay,t?0:1,Qc.delay)}function L(t){void 0===t&&(t=!1),x.style.pointerEvents=y.props.interactive&&!t?"":"none",x.style.zIndex=""+y.props.zIndex}function P(t,e,i){var r;(void 0===i&&(i=!0),k.forEach((function(i){i[t]&&i[t].apply(i,e)})),i)&&(r=y.props)[t].apply(r,e)}function R(){var e=y.props.aria;if(e.content){var i="aria-"+e.content,r=x.id;Dc(y.props.triggerTarget||t).forEach((function(t){var e=t.getAttribute(i);if(y.state.isVisible)t.setAttribute(i,e?e+" "+r:r);else{var n=e&&e.replace(r,"").trim();n?t.setAttribute(i,n):t.removeAttribute(i)}}))}}function z(){!T&&y.props.aria.expanded&&Dc(y.props.triggerTarget||t).forEach((function(t){y.props.interactive?t.setAttribute("aria-expanded",y.state.isVisible&&t===$()?"true":"false"):t.removeAttribute("aria-expanded")}))}function D(){A().removeEventListener("mousemove",g),dd=dd.filter((function(t){return t!==g}))}function j(e){if(!qc.isTouch||!u&&"mousedown"!==e.type){var i=e.composedPath&&e.composedPath()[0]||e.target;if(!y.props.interactive||!Zc(x,i)){if(Dc(y.props.triggerTarget||t).some((function(t){return Zc(t,i)}))){if(qc.isTouch)return;if(y.state.isVisible&&y.props.trigger.indexOf("click")>=0)return}else P("onClickOutside",[y,e]);!0===y.props.hideOnClick&&(y.clearDelayTimeouts(),y.hide(),p=!0,setTimeout((function(){p=!1})),y.state.isMounted||N())}}}function O(){u=!0}function B(){u=!1}function F(){var t=A();t.addEventListener("mousedown",j,!0),t.addEventListener("touchend",j,Ic),t.addEventListener("touchstart",B,Ic),t.addEventListener("touchmove",O,Ic)}function N(){var t=A();t.removeEventListener("mousedown",j,!0),t.removeEventListener("touchend",j,Ic),t.removeEventListener("touchstart",B,Ic),t.removeEventListener("touchmove",O,Ic)}function H(t,e){var i=I().box;function r(t){t.target===i&&(Yc(i,"remove",r),e())}if(0===t)return e();Yc(i,"remove",s),Yc(i,"add",r),s=r}function V(e,i,r){void 0===r&&(r=!1),Dc(y.props.triggerTarget||t).forEach((function(t){t.addEventListener(e,i,r),f.push({node:t,eventType:e,handler:i,options:r})}))}function U(){var t;C()&&(V("touchstart",Z,{passive:!0}),V("touchend",W,{passive:!0})),(t=y.props.trigger,t.split(/\s+/).filter(Boolean)).forEach((function(t){if("manual"!==t)switch(V(t,Z),t){case"mouseenter":V("mouseleave",W);break;case"focus":V(Jc?"focusout":"blur",G);break;case"focusin":V("focusout",G)}}))}function Y(){f.forEach((function(t){var e=t.node,i=t.eventType,r=t.handler,n=t.options;e.removeEventListener(i,r,n)})),f=[]}function Z(t){var e,i=!1;if(y.state.isEnabled&&!X(t)&&!p){var r="focus"===(null==(e=a)?void 0:e.type);a=t,l=t.currentTarget,z(),!y.state.isVisible&&Pc(t,"MouseEvent")&&dd.forEach((function(e){return e(t)})),"click"===t.type&&(y.props.trigger.indexOf("mouseenter")<0||h)&&!1!==y.props.hideOnClick&&y.state.isVisible?i=!0:tt(t),"click"===t.type&&(h=!i),i&&!r&&et(t)}}function q(t){var e=t.target,i=$().contains(e)||x.contains(e);if("mousemove"!==t.type||!i){var r=Q().concat(x).map((function(t){var e,i=null==(e=t._tippy.popperInstance)?void 0:e.state;return i?{popperRect:t.getBoundingClientRect(),popperState:i,props:d}:null})).filter(Boolean);(function(t,e){var i=e.clientX,r=e.clientY;return t.every((function(t){var e=t.popperRect,n=t.popperState,a=t.props.interactiveBorder,s=n.placement.split("-")[0],o=n.modifiersData.offset;if(!o)return!0;var l="bottom"===s?o.top.y:0,c="top"===s?o.bottom.y:0,d="right"===s?o.left.x:0,h="left"===s?o.right.x:0,p=e.top-r+l>a,u=r-e.bottom-c>a,m=e.left-i+d>a,f=i-e.right-h>a;return p||u||m||f}))})(r,t)&&(D(),et(t))}}function W(t){X(t)||y.props.trigger.indexOf("click")>=0&&h||(y.props.interactive?y.hideWithInteractivity(t):et(t))}function G(t){y.props.trigger.indexOf("focusin")<0&&t.target!==$()||y.props.interactive&&t.relatedTarget&&x.contains(t.relatedTarget)||et(t)}function X(t){return!!qc.isTouch&&C()!==t.type.indexOf("touch")>=0}function K(){J();var e=y.props,i=e.popperOptions,r=e.placement,n=e.offset,a=e.getReferenceClientRect,s=e.moveTransition,l=E()?od(x).arrow:null,c=a?{getBoundingClientRect:a,contextElement:a.contextElement||$()}:t,d={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(t){var e=t.state;if(E()){var i=I().box;["placement","reference-hidden","escaped"].forEach((function(t){"placement"===t?i.setAttribute("data-placement",e.placement):e.attributes.popper["data-popper-"+t]?i.setAttribute("data-"+t,""):i.removeAttribute("data-"+t)})),e.attributes.popper={}}}},h=[{name:"offset",options:{offset:n}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!s}},d];E()&&l&&h.push({name:"arrow",options:{element:l,padding:3}}),h.push.apply(h,(null==i?void 0:i.modifiers)||[]),y.popperInstance=Sc(c,x,Object.assign({},i,{placement:r,onFirstUpdate:o,modifiers:h}))}function J(){y.popperInstance&&(y.popperInstance.destroy(),y.popperInstance=null)}function Q(){return Oc(x.querySelectorAll("[data-tippy-root]"))}function tt(t){y.clearDelayTimeouts(),t&&P("onTrigger",[y,t]),F();var e=M(!0),r=S(),n=r[0],a=r[1];qc.isTouch&&"hold"===n&&a&&(e=a),e?i=setTimeout((function(){y.show()}),e):y.show()}function et(t){if(y.clearDelayTimeouts(),P("onUntrigger",[y,t]),y.state.isVisible){if(!(y.props.trigger.indexOf("mouseenter")>=0&&y.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(t.type)>=0&&h)){var e=M(!1);e?r=setTimeout((function(){y.state.isVisible&&y.hide()}),e):n=requestAnimationFrame((function(){y.hide()}))}}else N()}}function ud(t,e){void 0===e&&(e={});var i=Qc.plugins.concat(e.plugins||[]);document.addEventListener("touchstart",Gc,Ic),window.addEventListener("blur",Kc);var r=Object.assign({},e,{plugins:i}),n=Hc(t).reduce((function(t,e){var i=e&&pd(e,r);return i&&t.push(i),t}),[]);return Nc(t)?n[0]:n}ud.defaultProps=Qc,ud.setDefaultProps=function(t){Object.keys(t).forEach((function(e){Qc[e]=t[e]}))},ud.currentInput=qc,Object.assign({},$l,{effect:function(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow)}}),ud.setDefaultProps({render:ld});window.customElements.define("grampsjs-tooltip",class extends K{static get styles(){return[n`
        :host {
          display: none;
        }
      `]}static get properties(){return{for:{type:String},target:{type:Object,attribute:!1},content:{type:String},strings:{type:Object},theme:{type:String},_tippy:{type:Object}}}constructor(){super(),this.for="",this.target={},this.content="",this.strings={},this.theme="",this._tippy={}}_getTarget(){const{parentNode:t}=this,e=this.getRootNode();let i;return i=this.for?e.querySelector(`#${this.for}`):t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.host:t,i}firstUpdated(){this.target=this._getTarget(),this._initTippy()}updated(t){t.has("content")&&this.content&&this._tippy.setContent(this.content),t.has("strings")&&this._tippy.setContent(this.content||this.innerHTML)}_initTippy(){const t={content:this.innerHTML,allowHTML:!0};this.theme&&(t.theme=this.theme),this._tippy=ud(this.target,t)}render(){return M`<slot></slot>`}});class md extends(al(K)){static get styles(){return[nl,n`
        mwc-top-app-bar {
          --mdc-typography-headline6-font-family: var(
            --grampsjs-heading-font-family
          );
          --mdc-typography-headline6-font-weight: 400;
          --mdc-typography-headline6-font-size: 19px;
        }

        mwc-top-app-bar.edit {
          --mdc-theme-primary: var(--mdc-theme-secondary);
          --mdc-theme-on-primary: var(--mdc-theme-on-secondary);
        }
      `]}static get properties(){return{add:{type:Boolean},editMode:{type:Boolean},editTitle:{type:String},editDialogContent:{type:String},saveButton:{type:Boolean}}}constructor(){super(),this.add=!1,this.editMode=!1,this.editTitle="",this.editDialogContent="",this.saveButton=!1}render(){return M`
      <mwc-top-app-bar class="${Ot({edit:this.editMode})}">
        ${this.editMode?M`<mwc-icon-button
                slot="navigationIcon"
                icon="close"
                id="button-close"
                @click="${this._handleCloseIcon}"
              ></mwc-icon-button>
              <grampsjs-tooltip for="button-close" .strings="${this.strings}"
                >${this._("Stop editing")}</grampsjs-tooltip
              > `:M`<mwc-icon-button
              slot="navigationIcon"
              icon="menu"
              @click="${this._toggleDrawer}"
            ></mwc-icon-button>`}
        <div id="app-title" slot="title">
          ${this.editMode&&this.editTitle?this.editTitle:this._dbInfo?.database?.name||"Gramps Web"}
        </div>
        ${this.editMode?M`
                ${this.saveButton?M`
                      <mwc-icon-button
                        icon="save"
                        slot="actionItems"
                        id="button-save"
                        @click="${this._handleSaveIcon}"
                      ></mwc-icon-button>
                      <grampsjs-tooltip
                        for="button-save"
                        .strings="${this.strings}"
                        >${this._("_Save")}</grampsjs-tooltip
                      >
                    `:""}
                <mwc-icon-button
                  icon="delete"
                  slot="actionItems"
                  id="button-delete"
                  @click="${this._handleDeleteIcon}"
                ></mwc-icon-button>
                <grampsjs-tooltip for="button-delete" .strings="${this.strings}"
                  >${this._("_Delete")}</grampsjs-tooltip
                >
              `:M`
                ${this.add?M`
                      <grampsjs-add-menu
                        slot="actionItems"
                        .strings="${this.strings}"
                        id="button-add"
                      ></grampsjs-add-menu>
                      <grampsjs-tooltip
                        for="button-add"
                        .strings="${this.strings}"
                        >${this._("Add")}</grampsjs-tooltip
                      >
                    `:""}
                <mwc-icon-button
                  icon="account_circle"
                  slot="actionItems"
                  @click="${()=>this._handleNav("settings")}"
                  id="button-settings"
                ></mwc-icon-button>
                <grampsjs-tooltip
                  for="button-settings"
                  .strings="${this.strings}"
                  >${this._("Preferences")}</grampsjs-tooltip
                >
                <mwc-icon-button
                  icon="search"
                  slot="actionItems"
                  id="button-search"
                  @click="${()=>this._handleNav("search")}"
                ></mwc-icon-button>
                <grampsjs-tooltip for="button-search" .strings="${this.strings}"
                  >${this._("Search")}</grampsjs-tooltip
                >
              `}
      </mwc-top-app-bar>
      ${this.editDialogContent}
    `}_toggleDrawer(){os(this,"drawer:toggle")}_handleNav(t){os(this,"nav",{path:t})}_handleCloseIcon(){this.saveButton?this.editDialogContent=M`
        <mwc-dialog open @closed="${this._handleDialog}">
          <div>${this._("Abort changes?")}</div>
          <mwc-button slot="primaryAction" dialogAction="discard">
            ${this._("Discard")}
          </mwc-button>
          <mwc-button slot="secondaryAction" dialogAction="cancel">
            ${this._("Cancel")}
          </mwc-button>
        </mwc-dialog>
      `:this._editModeOff()}_handleDeleteIcon(){this.editDialogContent=M`
      <mwc-dialog open @closed="${this._handleDialog}">
        <div>${this._("Delete this object?")}</div>
        <mwc-button slot="primaryAction" dialogAction="delete">
          ${this._("_Delete")}
        </mwc-button>
        <mwc-button slot="secondaryAction" dialogAction="cancel">
          ${this._("Cancel")}
        </mwc-button>
      </mwc-dialog>
    `}_handleDialog(t){"discard"===t.detail.action?this._editModeOff():"delete"===t.detail.action&&this._deleteObject(),this.editDialogContent=""}_editModeOff(){os(this,"edit-mode:off",{})}_handleSaveIcon(){os(this,"edit-mode:save")}_disableEditMode(){this.editMode=!1}_enableEditMode(t){this.editMode=!0,this.editTitle=t.detail.title,this.saveButton=t.detail?.saveButton||!1}_deleteObject(){os(this,"edit-mode:delete")}connectedCallback(){super.connectedCallback(),window.addEventListener("edit-mode:on",(t=>this._enableEditMode(t))),window.addEventListener("edit-mode:off",(t=>this._disableEditMode(t)))}}window.customElements.define("grampsjs-app-bar",md);class fd extends K{constructor(){super(...arguments),this.indeterminate=!1,this.progress=0,this.density=0,this.closed=!1}open(){this.closed=!1}close(){this.closed=!0}render(){const t={"mdc-circular-progress--closed":this.closed,"mdc-circular-progress--indeterminate":this.indeterminate},e=48+4*this.density,i={width:`${e}px`,height:`${e}px`};return M`
      <div
        class="mdc-circular-progress ${Ot(t)}"
        style="${se(i)}"
        role="progressbar"
        aria-label="${Ke(this.ariaLabel)}"
        aria-valuemin="0"
        aria-valuemax="1"
        aria-valuenow="${Ke(this.indeterminate?void 0:this.progress)}">
        ${this.renderDeterminateContainer()}
        ${this.renderIndeterminateContainer()}
      </div>`}renderDeterminateContainer(){const t=48+4*this.density,e=t/2,i=this.density>=-3?18+11*this.density/6:12.5+5*(this.density+3)/4,r=6.2831852*i,n=(1-this.progress)*r,a=this.density>=-3?4+this.density*(1/3):3+(this.density+3)*(1/6);return M`
      <div class="mdc-circular-progress__determinate-container">
        <svg class="mdc-circular-progress__determinate-circle-graphic"
             viewBox="0 0 ${t} ${t}">
          <circle class="mdc-circular-progress__determinate-track"
                  cx="${e}" cy="${e}" r="${i}"
                  stroke-width="${a}"></circle>
          <circle class="mdc-circular-progress__determinate-circle"
                  cx="${e}" cy="${e}" r="${i}"
                  stroke-dasharray="${6.2831852*i}"
                  stroke-dashoffset="${n}"
                  stroke-width="${a}"></circle>
        </svg>
      </div>`}renderIndeterminateContainer(){return M`
      <div class="mdc-circular-progress__indeterminate-container">
        <div class="mdc-circular-progress__spinner-layer">
          ${this.renderIndeterminateSpinnerLayer()}
        </div>
      </div>`}renderIndeterminateSpinnerLayer(){const t=48+4*this.density,e=t/2,i=this.density>=-3?18+11*this.density/6:12.5+5*(this.density+3)/4,r=6.2831852*i,n=.5*r,a=this.density>=-3?4+this.density*(1/3):3+(this.density+3)*(1/6);return M`
        <div class="mdc-circular-progress__circle-clipper mdc-circular-progress__circle-left">
          <svg class="mdc-circular-progress__indeterminate-circle-graphic"
               viewBox="0 0 ${t} ${t}">
            <circle cx="${e}" cy="${e}" r="${i}"
                    stroke-dasharray="${r}"
                    stroke-dashoffset="${n}"
                    stroke-width="${a}"></circle>
          </svg>
        </div>
        <div class="mdc-circular-progress__gap-patch">
          <svg class="mdc-circular-progress__indeterminate-circle-graphic"
               viewBox="0 0 ${t} ${t}">
            <circle cx="${e}" cy="${e}" r="${i}"
                    stroke-dasharray="${r}"
                    stroke-dashoffset="${n}"
                    stroke-width="${.8*a}"></circle>
          </svg>
        </div>
        <div class="mdc-circular-progress__circle-clipper mdc-circular-progress__circle-right">
          <svg class="mdc-circular-progress__indeterminate-circle-graphic"
               viewBox="0 0 ${t} ${t}">
            <circle cx="${e}" cy="${e}" r="${i}"
                    stroke-dasharray="${r}"
                    stroke-dashoffset="${n}"
                    stroke-width="${a}"></circle>
          </svg>
        </div>`}update(t){super.update(t),t.has("progress")&&(this.progress>1&&(this.progress=1),this.progress<0&&(this.progress=0))}}it([ot({type:Boolean,reflect:!0})],fd.prototype,"indeterminate",void 0),it([ot({type:Number,reflect:!0})],fd.prototype,"progress",void 0),it([ot({type:Number,reflect:!0})],fd.prototype,"density",void 0),it([ot({type:Boolean,reflect:!0})],fd.prototype,"closed",void 0),it([Xe,ot({type:String,attribute:"aria-label"})],fd.prototype,"ariaLabel",void 0);const gd=n`.mdc-circular-progress__determinate-circle,.mdc-circular-progress__indeterminate-circle-graphic{stroke:#6200ee;stroke:var(--mdc-theme-primary, #6200ee)}.mdc-circular-progress__determinate-track{stroke:transparent}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-color-1-fade-in-out{from{opacity:.99}25%{opacity:.99}26%{opacity:0}89%{opacity:0}90%{opacity:.99}to{opacity:.99}}@keyframes mdc-circular-progress-color-2-fade-in-out{from{opacity:0}15%{opacity:0}25%{opacity:.99}50%{opacity:.99}51%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-3-fade-in-out{from{opacity:0}40%{opacity:0}50%{opacity:.99}75%{opacity:.99}76%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-4-fade-in-out{from{opacity:0}65%{opacity:0}75%{opacity:.99}90%{opacity:.99}to{opacity:0}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}.mdc-circular-progress{display:inline-flex;position:relative;direction:ltr;line-height:0;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:transparent}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-1{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-1-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-2{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-2-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-3{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-3-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-4{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-4-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--closed{opacity:0}:host{display:inline-flex}.mdc-circular-progress__determinate-track{stroke:transparent;stroke:var(--mdc-circular-progress-track-color, transparent)}`;let _d=class extends fd{};_d.styles=[gd],_d=it([at("mwc-circular-progress")],_d);window.customElements.define("grampsjs-password-manager-polyfill",class extends K{createRenderRoot(){return document.body}styles(){return`\n    .password-manager-polyfill {\n      position: absolute;\n      top: ${(this.boundingRect?.y||19)+48}px;\n      left: calc(50% - ${(this.boundingRect?.width||360)/2}px);\n      width: ${this.boundingRect?.width||360}px;\n      opacity: 0;\n      z-index: -1;\n    }\n    .password-manager-polyfill input {\n      width: 100%;\n      height: 62px;\n      padding: 0;\n      border: 0;\n    }\n    .password-manager-polyfill input[type="submit"] {\n      width: 0;\n      height: 0;\n    }\n  `}static get properties(){return{credentials:{type:Object},boundingRect:{type:Object}}}constructor(){super(),this.credentials={}}render(){return M`
      <form
        class="password-manager-polyfill"
        aria-hidden="true"
        @submit=${this._handleSubmit}
      >
        <input
          tabindex="-1"
          id="username"
          autocapitalize="off"
          type="text"
          .value="${this.credentials.username||""}"
          @input=${this._valueChanged}
        />
        <input
          tabindex="-1"
          id="password"
          type="password"
          autocapitalize="off"
          .value="${this.credentials.password||""}"
          @input=${this._valueChanged}
        />
        <input type="submit" />
        <style>
          ${this.styles()}
        </style>
      </form>
    `}_handleSubmit(t){t.preventDefault(),os(this,"form-submitted")}_valueChanged(t){this.credentials={...this.credentials,[t.target.id]:t.target.value},os(this,"value-changed",{value:this.credentials})}});class vd extends(al(K)){static get styles(){return[nl,n`
        div#preview {
          margin-top: 25px;
        }

        img.img-preview {
          max-width: 300px;
          max-height: 300px;
        }

        .file-icon {
          color: rgba(0, 0, 0, 0.6);
          --mdc-icon-size: 100px;
        }

        span.filename {
          font-size: 0.8em;
          line-height: 36px;
          margin-left: 1em;
        }
      `]}static get properties(){return{file:{type:Object},imageUrl:{type:String},preview:{type:Boolean},filename:{type:Boolean},disabled:{type:Boolean},outlined:{type:Boolean},label:{type:String},accept:{type:String}}}constructor(){super(),this.file={},this.imageUrl="",this.preview=!1,this.filename=!1,this.disabled=!1,this.outlined=!1,this.label="",this.accept=void 0}render(){return M`
      <input
        id="input-upload"
        type="file"
        accept="${this.accept}"
        hidden
        @change="${this._handleInputChange}"
      />
      <mwc-button
        ?raised="${!this.outlined}"
        ?outlined="${this.outlined}"
        ?disabled="${this.disabled}"
        icon="upload"
        @click="${this._handleClickUpload}"
      >
        ${this.label||this._("Select a file")}
      </mwc-button>
      ${this.filename?this.renderFileName():""}
      ${this.preview?this.renderPreview():""}
    `}renderPreview(){return this.file.name?M`
      <div id="preview">
        ${this.file.type.startsWith("image")?this.renderImage():this.renderIcon()}
      </div>
    `:""}renderFileName(){return M`<span class="filename">${this.file.name}</span>`}renderImage(){return this.imageUrl?M` <img src="${this.imageUrl}" alt="" class="img-preview" /> `:""}renderIcon(){return M` <mwc-icon class="file-icon">insert_drive_file</mwc-icon> `}_handleClickUpload(){this.shadowRoot.getElementById("input-upload").click()}_handleInputChange(){const t=this.shadowRoot.getElementById("input-upload");if(t?.files?.length){this.imageUrl="",[this.file]=t.files;const e=new FileReader;e.onload=()=>{this.imageUrl=e.result},e.readAsDataURL(this.file),this.handleChange()}}async readAsJson(){return await async function(t){return new Promise(((e,i)=>{const r=new FileReader;r.onload=t=>{try{const i=JSON.parse(t.target.result);e(i)}catch(t){i(t)}},r.onerror=t=>i(t),r.readAsText(t)}))}(this.file)}reset(){this.file={},this.imageUrl="";this.shadowRoot.getElementById("input-upload").value=""}handleChange(){os(this,"formdata:changed",{data:this.file})}}window.customElements.define("grampsjs-form-upload",vd);class yd extends K{static get styles(){return[nl,n`
        .success {
          color: #41ad49;
        }

        .error {
          color: #bf360c;
        }

        .warn {
          color: #f9a825;
        }
      `]}static get properties(){return{progress:{type:Number},size:{type:Number},error:{type:Boolean},open:{type:Boolean},errorMessage:{type:String},infoMessage:{type:String}}}constructor(){super(),this.progress=-1,this.size=24,this.error=!1,this.open=!1,this.errorMessage="",this.infoMessage=""}reset(){this.progress=-1,this.error=!1,this.errorMessage="",this.infoMessage=""}render(){return this.open?this.error?this.renderError():this.progress<=-1?this.renderIndeterminate():this.progress>=1?this.renderSuccess():this.renderProgress():this.renderClosed()}_getDensity(){return-6+Math.round((this.size-24)/4)}renderClosed(){return M`
      <mwc-circular-progress closed density="${this._getDensity()}">
      </mwc-circular-progress>
    `}renderIndeterminate(){return M`
      <mwc-circular-progress
        indeterminate
        style="--mdc-theme-primary: rgba(0, 0, 0, 0.5);"
        density="${this._getDensity()}"
      >
      </mwc-circular-progress>
    `}renderProgress(){return M`
      <mwc-circular-progress
        progress="${Math.max(this.progress,.05)}"
        density="${this._getDensity()}"
        id="progress-determinate"
      >
      </mwc-circular-progress>
      ${this.infoMessage?M` <grampsjs-tooltip
            for="progress-determinate"
            content="${this.infoMessage}"
          ></grampsjs-tooltip>`:""}
    `}renderSuccess(){return M`
      <mwc-icon style="--mdc-icon-size: ${this.size}px;" class="success"
        >check_circle</mwc-icon
      >
    `}renderError(){return M`
      <mwc-icon
        id="error-icon"
        style="--mdc-icon-size: ${this.size}px;"
        class="error"
        >cancel</mwc-icon
      >
      ${this.errorMessage?M`
            <grampsjs-tooltip for="error-icon" theme="error"
              >${this.errorMessage}</grampsjs-tooltip
            >
          `:""}
    `}_handleClick(){os(this,"edit:action",{action:"updateProp",data:{private:!this.private}})}}window.customElements.define("grampsjs-progress-indicator",yd);const bd=-1,xd={"#email_host":"EMAIL_HOST","#email_port":"EMAIL_PORT","#email_user":"EMAIL_HOST_USER","#email_pw":"EMAIL_HOST_PASSWORD","#email_from":"DEFAULT_FROM_EMAIL","#base_url":"BASE_URL"};class wd extends(al(K)){static get styles(){return[nl,n`
        .container {
          margin-left: auto;
          margin-right: auto;
          max-width: 30em;
          overflow-x: hidden;
          word-wrap: break-word;
          padding: 3em 1.5em;
        }

        mwc-textfield {
          width: 100%;
          margin-bottom: 0.7em;
        }

        h1,
        h2,
        h3 {
          color: var(--mdc-theme-primary);
        }

        p {
          line-height: 1.6;
        }

        .progress {
          position: relative;
          top: 0.2em;
          margin-left: 0.5em;
        }
      `]}static get properties(){return{token:{type:String},stateUser:{type:Number},stateConfig:{type:Number},stateTree:{type:Number},_errorUser:{type:String},_errorConfig:{type:String},_errorTree:{type:String},_uploadHint:{type:String},_tree:{type:String}}}constructor(){super(),this.token="",this.stateUser=0,this.stateConfig=0,this.stateTree=0,this._errorUser="",this._errorConfig="",this._errorTree="",this._uploadHint="",this._tree=""}render(){return M`
      <div class="container">
        <div class="form">
          <h1>${this._("Welcome to Gramps Web")}</h1>

          <h3>
            ${this._("Create an admin account")}
            ${0!==this.stateUser?M`
                  <span class="icon">
                    ${Na(Ma,"#41AD49")}
                  </span>
                `:""}
          </h3>

          <p>${this._("Enter the details for the admin user.")}</p>

          <mwc-textfield
            @input="${this.checkValidity}"
            outlined
            required
            autocapitalize="off"
            id="username"
            label="${this._("Username")}"
            type="text"
          ></mwc-textfield>
          <mwc-textfield
            @input="${this.checkValidity}"
            outlined
            required
            autocapitalize="off"
            id="password"
            label="${this._("Password")}"
            type="password"
          ></mwc-textfield>
          <mwc-textfield
            @input="${this.checkValidity}"
            outlined
            required
            autocapitalize="off"
            id="email"
            label="${this._("E-mail")}"
            type="email"
          ></mwc-textfield>
          <mwc-textfield
            @input="${this.checkValidity}"
            outlined
            id="full_name"
            label="${this._("Full Name")}"
            type="text"
          ></mwc-textfield>

          ${this._tree?"":M`
                <h3>
                  ${this._("E-mail settings")}
                  ${0!==this.stateConfig?M`
                        <span class="icon">
                          ${Na(Ma,"#41AD49")}
                        </span>
                      `:""}
                </h3>

                <p>
                  ${this._("Optionally, enter existing IMAP credentials to enable e-mail notifications required e.g. for user registration.")}
                </p>

                <mwc-textfield
                  @input="${this.checkValidity}"
                  outlined
                  id="email_host"
                  label="${this._("SMTP host")}"
                  type="text"
                ></mwc-textfield>
                <mwc-textfield
                  @input="${this.checkValidity}"
                  outlined
                  id="email_port"
                  label="${this._("SMTP port")}"
                  type="text"
                  pattern="[0-9]+"
                ></mwc-textfield>
                <mwc-textfield
                  @input="${this.checkValidity}"
                  outlined
                  id="email_user"
                  label="${this._("SMTP user")}"
                  type="text"
                ></mwc-textfield>
                <mwc-textfield
                  @input="${this.checkValidity}"
                  outlined
                  id="email_pw"
                  label="${this._("SMTP password")}"
                  type="password"
                ></mwc-textfield>
                <mwc-textfield
                  @input="${this.checkValidity}"
                  outlined
                  id="email_from"
                  label="${this._("From address")}"
                  type="email"
                ></mwc-textfield>
                <mwc-textfield
                  @input="${this.checkValidity}"
                  outlined
                  id="base_url"
                  label="${this._("Gramps Web base URL")}"
                  type="url"
                  placeholder="https://grampsweb.mydomain.com"
                ></mwc-textfield>
              `}

          <h3>
            ${this._("Upload family tree")}
            ${0!==this.stateTree?M`
                  <span class="icon">
                    ${Na(Ma,"#41AD49")}
                  </span>
                `:""}
          </h3>

          <p>${this._("Optionally, upload existing family tree data.")}</p>

          <p>
            <grampsjs-form-upload
              .strings="${this.strings}"
              filename
              @formdata:changed="${this._handleUploadChanged}"
              ?disabled="${3===this.stateUser}"
            ></grampsjs-form-upload>
          </p>
          ${this._uploadHint?M`${this._uploadHint}`:""}

          <p style="margin-top: 2em;">
            ${this._("Need help? Check out ")}<a
              href="https://www.grampsweb.org/Deployment/"
              >${this._("the documentation")}</a
            >.
          </p>

          <h3>${this._("Submit")}</h3>

          <mwc-button
            raised
            label="${this._("Submit")}"
            type="submit"
            @click="${this._submit}"
            ?disabled=${1!==this.stateUser&&this.stateUser!==bd}
          >
          </mwc-button>

          <p>
            ${this._showProgress(this._("Creating owner account"),this.stateUser,this._errorUser)}
            ${this._tree?"":this._showProgress(this._("Storing configuration"),this.stateConfig,this._errorConfig)}
            ${this._showProgress(this._("Importing family tree"),this.stateTree,this._errorTree)}
          </p>

          <div
            style="visibility:${3===this.stateUser&&2!==this.stateConfig&&2!==this.stateTree?"visible":"hidden"};"
          >
            <mwc-button
              raised
              label="start"
              type="submit"
              id="start-btn"
              @click="${this._done}"
            >
            </mwc-button>
          </div>
        </div>
      </div>
    `}_showProgress(t,e,i){return M`
      <br />
      ${t}
      <span class="progress">
        <grampsjs-progress-indicator
          ?open="${0!==e&&1!==e}"
          ?error="${e===bd}"
          errorMessage="${e===bd?i:""}"
          progress="${3===e?1:-1}"
        ></grampsjs-progress-indicator>
      </span>
    `}async _submit(){const t=this.shadowRoot.querySelector("#username")?.value||"",e=this.shadowRoot.querySelector("#password")?.value||"",i=this.shadowRoot.querySelector("#email")?.value||"",r=this.shadowRoot.querySelector("#full_name")?.value||"";if(await this._submitUser(t,e,i,r),this.stateUser===bd)return;const n=await Dn(t,e);if("error"in n)return this.stateUser=bd,void(this._errorUser=n.error||"");if(1===this.stateConfig&&(await this._submitConfig(),this.stateConfig!==bd&&(this.stateConfig=3)),1===this.stateTree){const t=this.shadowRoot.querySelector("grampsjs-form-upload"),e=t.file.name.split(".").pop().toLowerCase();await this._submitTree(e,t.file)}}async _submitUser(t,e,i,r){this.stateUser=2;try{const n=await fetch(`${Cn}/api/users/${t}/create_owner/`,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"},body:JSON.stringify({password:e,email:i,full_name:r})});if(201===n.status){this.stateUser=3;const t=this.shadowRoot.querySelector("#start-btn");return void(t&&t.scrollIntoView({block:"start",behavior:"smooth"}))}const a=await n.json();if(this.stateUser=bd,409===n.status){(a?.error?.message||"").toLowerCase().includes("mail")?this._errorUser=this._("This e-mail address is already in use"):this._errorUser=this._("This user name is already in use")}else this._errorUser=a?.error?.message||""}catch(t){this.stateUser=bd,this._errorUser=`${t}`||""}}async _submitConfig(){this.stateConfig=2;for(const t of Object.keys(xd)){const e=xd[t],i=this.shadowRoot.querySelector(t);i&&i?.value&&await this._submitConfigSingle(e,i.value)}}async _submitConfigSingle(t,e){const i=await Fn(`/api/config/${t}/`,{value:e});"error"in i&&(this.stateConfig=bd,this._errorConfig=i.error||"")}async _submitTree(t,e){this.stateTree=2;const i=await Nn(`/api/importers/${t}/file`,e,!1);"error"in i?(this.stateTree=bd,this._errorTree=i.error||""):"task"in i?qn(i.task.id,(t=>{"SUCCESS"===t.state?this.stateTree=3:"FAILURE"!==t.state&&"REVOKED"!==t.state||(this.stateTree=bd,this._errorTree=t.state)})):this.stateTree=3}_done(){os(this,"firstrun:done")}_handleUploadChanged(){const t=this.shadowRoot.querySelector("grampsjs-form-upload");if(!t.file?.name)return this._uploadHint="",void(this.stateTree=0);const e=t.file.name.split(".").pop().toLowerCase();return["gpkg","gramps","gw","def","vcf","csv","ged"].includes(e)?"gpkg"===e?(this._uploadHint=M`<p class="alert error">
        ${this._("The Gramps package format (.gpkg) is currently not supported.")}
        ${this._("Please upload a file in Gramps XML (.gramps) format without media files.")}
      </p>`,void(this.stateTree=0)):(this._uploadHint="gramps"!==e?M`<p class="alert warn">
        ${this._("If you intend to synchronize an existing Gramps database with Gramps Web, use the Gramps XML (.gramps) format instead.")}
      </p>`:"",void(this.stateTree=1)):(this._uploadHint=M`<p class="alert error">
        ${this._("Unsupported format")}
      </p>`,void(this.stateTree=0))}checkValidity(){0===this.stateUser&&this._checkValidityUser()?this.stateUser=1:1!==this.stateUser||this._checkValidityUser()||(this.stateUser=0),0===this.stateConfig&&this._checkValidityConfig()?this.stateConfig=1:1!==this.stateConfig||this._checkValidityConfig()||(this.stateConfig=0)}_checkValidityUser(){const t=this.shadowRoot.getElementById("username"),e=this.shadowRoot.getElementById("password"),i=this.shadowRoot.getElementById("full_name"),r=this.shadowRoot.getElementById("email");return t?.validity?.valid&&e?.validity?.valid&&i?.validity?.valid&&r?.validity?.valid||!1}_checkValidityConfig(){const t=this.shadowRoot.getElementById("email_host"),e=this.shadowRoot.getElementById("email_port"),i=this.shadowRoot.getElementById("email_user"),r=this.shadowRoot.getElementById("email_pw"),n=this.shadowRoot.getElementById("email_from"),a=this.shadowRoot.getElementById("base_url");return t?.validity?.valid&&t?.value&&e?.validity?.valid&&e?.value&&i?.validity?.valid&&i?.value&&r?.validity?.valid&&r?.value&&n?.validity?.valid&&n?.value&&a?.validity?.valid&&a?.value||!1}updated(t){t.has("token")&&(this._tree=(Sn(this.token)||{}).tree||"")}}window.customElements.define("grampsjs-first-run",wd);class kd extends(al(K)){static get styles(){return[nl,n`
        #login-container {
          margin: auto;
          height: 100%;
          max-width: 20em;
        }

        #login-form {
          position: relative;
          top: 25vh;
        }

        #login-form mwc-textfield {
          width: 100%;
          margin-bottom: 0.7em;
        }

        #login-form mwc-button {
        }

        p.reset-link {
          padding-top: 1em;
          font-size: 0.9em;
        }

        p.success {
          padding-top: 1em;
          color: #4caf50;
          font-size: 1.2em;
          font-weight: 400;
          --mdc-icon-size: 1.6em;
          line-height: 1.4em;
          text-align: center;
        }

        mwc-circular-progress {
          --mdc-theme-primary: white;
        }
      `]}static get properties(){return{resetpw:{type:Boolean},register:{type:Boolean},isFormValid:{type:Boolean},credentials:{type:Object},tree:{type:String}}}constructor(){super(),this.resetpw=!1,this.register=!1,this.isFormValid=!1,this.credentials={},this.tree=""}render(){return this.resetpw?this._renderResetPw():this.register?this._renderRegister():this._renderLogin()}_renderLogin(){return M`
      <div id="login-container">
        <form
          id="login-form"
          action="${""}/"
          @keydown="${this._handleLoginKey}"
        >
          <mwc-textfield
            outlined
            autocapitalize="off"
            id="username"
            label="${this._("Username")}"
            @input="${this._credChanged}"
            @change="${this._credChanged}"
            value="${this.credentials.username||""}"
          ></mwc-textfield>
          <mwc-textfield
            outlined
            autocapitalize="off"
            id="password"
            label="${this._("Password")}"
            type="password"
            @input="${this._credChanged}"
            @change="${this._credChanged}"
            value="${this.credentials.password||""}"
          ></mwc-textfield>
          <mwc-button
            raised
            label="${this._("login")}"
            type="submit"
            @click="${this._submitLogin}"
          >
            <span slot="trailingIcon" style="display:none;">
              <mwc-circular-progress
                indeterminate
                density="-7"
                closed
                id="login-progress"
              >
              </mwc-circular-progress>
            </span>
          </mwc-button>
          <p class="reset-link">
            <span
              class="link"
              @click="${()=>{this.resetpw=!0}}"
              >${this._("Lost password?")}</span
            >
          </p>
          ${window.grampsjsConfig.hideRegisterLink?"":M`
                <p class="reset-link">
                  <span
                    class="link"
                    @click="${()=>{this.register=!0}}"
                    >${this._("Register new account")}</span
                  >
                </p>
              `}
        </form>
        <grampsjs-password-manager-polyfill
          .credentials=${this.credentials}
          @form-submitted=${this._submitLogin}
          @value-changed=${this._loginFormChanged}
        ></grampsjs-password-manager-polyfill>
      </div>
    `}firstUpdated(){const t=this.shadowRoot.querySelector("grampsjs-password-manager-polyfill");null!==t&&(t.boundingRect=this.getBoundingClientRect())}_credChanged(t){this.credentials={...this.credentials,[t.target.id]:t.target.value}}_renderResetPw(){return M`
      <div id="login-container">
        <form id="login-form" action="${""}/">
          <div id="inner-form">
            <mwc-textfield
              outlined
              autocapitalize="off"
              id="username"
              label="${this._("Username")}"
              type="text"
            ></mwc-textfield>
            <mwc-button
              raised
              label="${this._("reset password")}"
              type="submit"
              @click="${this._resetPw}"
            >
              <span slot="trailingIcon" style="display:none;">
                <mwc-circular-progress
                  indeterminate
                  density="-7"
                  closed
                  id="login-progress"
                >
                </mwc-circular-progress>
              </span>
            </mwc-button>
          </div>
          <p class="success" id="reset-success" style="display:none;">
            <mwc-icon>check_circle</mwc-icon><br />
            ${this._("A password reset link has been sent by e-mail.")}
          </p>
          <p class="reset-link">
            <span
              class="link"
              @click="${()=>{this.resetpw=!1}}"
              >${this._("_Back")}</span
            >
          </p>
        </form>
      </div>
    `}_renderRegister(){return M`
      <div id="login-container">
        <form
          id="login-form"
          action="${""}/"
          @keydown="${this._checkFormValid}"
        >
          <div id="inner-form">
            <mwc-textfield
              required
              outlined
              autocapitalize="off"
              id="username"
              label="${this._("Username")}"
              type="text"
            ></mwc-textfield>
            <mwc-textfield
              required
              outlined
              autocapitalize="off"
              id="password"
              label="${this._("Password")}"
              type="password"
            ></mwc-textfield>
            <mwc-textfield
              required
              outlined
              autocapitalize="off"
              id="email"
              label="${this._("E-mail")}"
              type="email"
            ></mwc-textfield>
            <mwc-textfield
              required
              outlined
              id="fullname"
              label="${this._("Full Name")}"
              type="text"
            ></mwc-textfield>
            <mwc-button
              raised
              label="${this._("Submit")}"
              type="submit"
              @click="${this._register}"
              ?disabled="${!this.isFormValid}"
            >
              <span slot="trailingIcon" style="display:none;">
                <mwc-circular-progress
                  indeterminate
                  density="-7"
                  closed
                  id="login-progress"
                >
                </mwc-circular-progress>
              </span>
            </mwc-button>
          </div>
          <p class="success" id="register-success" style="display:none;">
            <mwc-icon>check_circle</mwc-icon><br />
            ${this._("New account registered successfully.")}
            <br />
            ${this._("Please confirm your e-mail address by clicking the link in the e-mail you received and then wait for the tree owner to activate your account.")}
          </p>
          <p class="reset-link">
            ${this._("Already have an account?")}
            <span
              class="link"
              @click="${()=>{this.register=!1}}"
              >${this._("login")}</span
            >
          </p>
        </form>
      </div>
    `}_checkFormValid(){const t=Array.from(this.shadowRoot.querySelectorAll("mwc-textfield"));this.isFormValid=t.every((t=>t?.validity?.valid))}_handleLoginKey(t){"Enter"===t.code&&this._submitLogin()}async _submitLogin(){const t=this.shadowRoot.getElementById("login-progress");t.parentElement.style.display="block",t.closed=!1,Dn(this.credentials.username,this.credentials.password).then((e=>{"error"in e?(t.parentElement.style.display="none",t.closed=!0,this._showError(e.error)):document.location.href="/"}))}_loginFormChanged(t){this.credentials={...this.credentials,...t.detail.value}}async _resetPw(){const t=this.shadowRoot.getElementById("username");if(""===t.value)return void this._showError("Username must not be empty.");const e=await async function(t){try{const e=await fetch(`${Cn}/api/users/${t}/password/reset/trigger/`,{method:"POST",headers:{"Content-Type":"application/json"}});if(404===e.status)throw new Error("User not found or user has no e-mail address.");if(500===e.status)throw new Error("The server encountered an error while trying to send the e-mail.");if(201!==e.status&&202!==e.status)throw new Error(e.statusText||`Error ${e.status}`);return{}}catch(t){return{error:t.message}}}(t.value),i=this.shadowRoot.getElementById("inner-form"),r=this.shadowRoot.getElementById("reset-success");"error"in e?this._showError(e.error):(r.style.display="block",i.style.display="none")}async _register(){const t=this.shadowRoot.getElementById("username"),e=this.shadowRoot.getElementById("password"),i=this.shadowRoot.getElementById("email"),r=this.shadowRoot.getElementById("fullname"),n=this.tree||"",a=await async function(t,e,i,r,n){try{let a={password:e,email:i,full_name:r};a=n?{...a,tree:n}:a;const s=await fetch(`${Cn}/api/users/${t}/register/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});let o;try{o=await s.json()}catch(t){o={}}if(409===s.status)throw new Error("Username or e-mail already taken.");if(201!==s.status)throw new Error(o?.error?.message||`Error ${s.status}`);return{}}catch(t){return{error:t.message}}}(t.value,e.value,i.value,r.value,n),s=this.shadowRoot.getElementById("inner-form"),o=this.shadowRoot.getElementById("register-success");"error"in a?this._showError(a.error):(o.style.display="block",s.style.display="none")}_showError(t){os(this,"grampsjs:error",{message:t})}}window.customElements.define("grampsjs-login",kd);class Td extends(al(K)){static get styles(){return[nl,n`
        grampsjs-list-item span {
          color: #444;
        }
      `]}static get properties(){return{add:{type:Boolean},editMode:{type:Boolean},editTitle:{type:String},editDialogContent:{type:String},saveButton:{type:Boolean},canViewPrivate:{type:Boolean},canUseChat:{type:Boolean}}}constructor(){super(),this.add=!1,this.editMode=!1,this.editTitle="",this.editDialogContent="",this.saveButton=!1,this.canViewPrivate=!1,this.canUseChat=!1}render(){return M` <mwc-list>
      <grampsjs-list-item href="${""}/" graphic="icon">
        <span>${this._("Home Page")}</span>
        <mwc-icon slot="graphic">home</mwc-icon>
      </grampsjs-list-item>
      <grampsjs-list-item href="${""}/blog" graphic="icon">
        <span>${this._("Blog")}</span>
        <mwc-icon slot="graphic">rss_feed</mwc-icon>
      </grampsjs-list-item>
      <grampsjs-list-item href="${""}/people" graphic="icon">
        <span>${this._("Lists")}</span>
        <mwc-icon slot="graphic">list</mwc-icon>
      </grampsjs-list-item>
      <grampsjs-list-item href="${""}/map" graphic="icon">
        <span>${this._("Map")}</span>
        <mwc-icon slot="graphic">map</mwc-icon>
      </grampsjs-list-item>
      <grampsjs-list-item href="${""}/tree" graphic="icon">
        <span>${this._("Family Tree")}</span>
        <mwc-icon slot="graphic">${Na(La)}</mwc-icon>
      </grampsjs-list-item>
      ${this.canUseChat?M`
            <grampsjs-list-item href="${""}/chat" graphic="icon">
              <span>${this._("Chat")}</span>
              <mwc-icon slot="graphic">${Na("M12,3C17.5,3 22,6.58 22,11C22,15.42 17.5,19 12,19C10.76,19 9.57,18.82 8.47,18.5C5.55,21 2,21 2,21C4.33,18.67 4.7,17.1 4.75,16.5C3.05,15.07 2,13.13 2,11C2,6.58 6.5,3 12,3Z")}</mwc-icon>
            </grampsjs-list-item>
          `:""}
      <li divider padded role="separator"></li>
      <grampsjs-list-item href="${""}/recent" graphic="icon">
        <span>${this._("History")}</span>
        <mwc-icon slot="graphic">history</mwc-icon>
      </grampsjs-list-item>
      <grampsjs-list-item href="${""}/bookmarks" graphic="icon">
        <span>${this._("_Bookmarks")}</span>
        <mwc-icon slot="graphic">bookmark</mwc-icon>
      </grampsjs-list-item>
      <grampsjs-list-item href="${""}/tasks" graphic="icon">
        <span>${this._("Tasks")}</span>
        <mwc-icon slot="graphic">checklist</mwc-icon>
      </grampsjs-list-item>
      <grampsjs-list-item href="${""}/export" graphic="icon">
        <span>${this._("Export")}</span>
        <mwc-icon slot="graphic">download_file</mwc-icon>
      </grampsjs-list-item>
      <grampsjs-list-item href="${""}/reports" graphic="icon">
        <span>${this._("_Reports").replace("_","")}</span>
        <mwc-icon slot="graphic">menu_book</mwc-icon>
      </grampsjs-list-item>
      ${this.canViewPrivate?M`
            <grampsjs-list-item href="${""}/revisions" graphic="icon">
              <span>${this._("Revisions")}</span>
              <mwc-icon slot="graphic">commit</mwc-icon>
            </grampsjs-list-item>
          `:""}
    </mwc-list>`}}window.customElements.define("grampsjs-main-menu",Td);class Sd extends K{constructor(){super(...arguments),this.mini=!1,this.exited=!1,this.disabled=!1,this.extended=!1,this.showIconAtEnd=!1,this.reducedTouchTarget=!1,this.icon="",this.label="",this.shouldRenderRipple=!1,this.useStateLayerCustomProperties=!1,this.rippleHandlers=new de((()=>(this.shouldRenderRipple=!0,this.ripple)))}render(){const t=this.mini&&!this.reducedTouchTarget,e={"mdc-fab--mini":this.mini,"mdc-fab--touch":t,"mdc-fab--exited":this.exited,"mdc-fab--extended":this.extended,"icon-end":this.showIconAtEnd},i=this.label?this.label:this.icon;return M`<button
          class="mdc-fab ${Ot(e)}"
          ?disabled="${this.disabled}"
          aria-label="${i}"
          @mouseenter=${this.handleRippleMouseEnter}
          @mouseleave=${this.handleRippleMouseLeave}
          @focus=${this.handleRippleFocus}
          @blur=${this.handleRippleBlur}
          @mousedown=${this.handleRippleActivate}
          @touchstart=${this.handleRippleStartPress}
          @touchend=${this.handleRippleDeactivate}
          @touchcancel=${this.handleRippleDeactivate}><!--
        -->${this.renderBeforeRipple()}<!--
        -->${this.renderRipple()}<!--
        -->${this.showIconAtEnd?this.renderLabel():""}<!--
        --><span class="material-icons mdc-fab__icon"><!--
          --><slot name="icon">${this.icon}</slot><!--
       --></span><!--
        -->${this.showIconAtEnd?"":this.renderLabel()}<!--
        -->${this.renderTouchTarget()}<!--
      --></button>`}renderIcon(){return M``}renderTouchTarget(){const t=this.mini&&!this.reducedTouchTarget;return M`${t?M`<div class="mdc-fab__touch"></div>`:""}`}renderLabel(){const t=""!==this.label&&this.extended;return M`${t?M`<span class="mdc-fab__label">${this.label}</span>`:""}`}renderBeforeRipple(){return M``}renderRipple(){return this.shouldRenderRipple?M`<mwc-ripple class="ripple"
        .internalUseStateLayerCustomProperties="${this.useStateLayerCustomProperties}"
         ></mwc-ripple>`:""}handleRippleActivate(t){const e=()=>{window.removeEventListener("mouseup",e),this.handleRippleDeactivate()};window.addEventListener("mouseup",e),this.handleRippleStartPress(t)}handleRippleStartPress(t){this.rippleHandlers.startPress(t)}handleRippleDeactivate(){this.rippleHandlers.endPress()}handleRippleMouseEnter(){this.rippleHandlers.startHover()}handleRippleMouseLeave(){this.rippleHandlers.endHover()}handleRippleFocus(){this.rippleHandlers.startFocus()}handleRippleBlur(){this.rippleHandlers.endFocus()}}Sd.shadowRootOptions={mode:"open",delegatesFocus:!0},it([pt("mwc-ripple")],Sd.prototype,"ripple",void 0),it([ot({type:Boolean})],Sd.prototype,"mini",void 0),it([ot({type:Boolean})],Sd.prototype,"exited",void 0),it([ot({type:Boolean})],Sd.prototype,"disabled",void 0),it([ot({type:Boolean})],Sd.prototype,"extended",void 0),it([ot({type:Boolean})],Sd.prototype,"showIconAtEnd",void 0),it([ot({type:Boolean})],Sd.prototype,"reducedTouchTarget",void 0),it([ot()],Sd.prototype,"icon",void 0),it([ot()],Sd.prototype,"label",void 0),it([lt()],Sd.prototype,"shouldRenderRipple",void 0),it([lt()],Sd.prototype,"useStateLayerCustomProperties",void 0),it([dt({passive:!0})],Sd.prototype,"handleRippleStartPress",null);const Cd=n`:host .mdc-fab .material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}:host{outline:none;--mdc-ripple-color: currentcolor;user-select:none;-webkit-tap-highlight-color:transparent;display:inline-flex;-webkit-tap-highlight-color:transparent;display:inline-flex;outline:none;user-select:none}:host .mdc-touch-target-wrapper{display:inline}:host .mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:0;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:#fff;background-color:var(--mdc-elevation-overlay-color, #fff)}:host .mdc-fab{position:relative;display:inline-flex;position:relative;align-items:center;justify-content:center;box-sizing:border-box;width:56px;height:56px;padding:0;border:none;fill:currentColor;text-decoration:none;cursor:pointer;user-select:none;-moz-appearance:none;-webkit-appearance:none;overflow:visible;transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1),opacity 15ms linear 30ms,transform 270ms 0ms cubic-bezier(0, 0, 0.2, 1)}:host .mdc-fab .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}:host .mdc-fab::-moz-focus-inner{padding:0;border:0}:host .mdc-fab:hover{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2),0px 8px 10px 1px rgba(0, 0, 0, 0.14),0px 3px 14px 2px rgba(0,0,0,.12)}:host .mdc-fab.mdc-ripple-upgraded--background-focused,:host .mdc-fab:not(.mdc-ripple-upgraded):focus{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2),0px 8px 10px 1px rgba(0, 0, 0, 0.14),0px 3px 14px 2px rgba(0,0,0,.12)}:host .mdc-fab .mdc-fab__focus-ring{position:absolute}:host .mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,:host .mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{pointer-events:none;border:2px solid transparent;border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc( 100% + 4px );width:calc( 100% + 4px )}@media screen and (forced-colors: active){:host .mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,:host .mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{border-color:CanvasText}}:host .mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,:host .mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{content:"";border:2px solid transparent;border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){:host .mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,:host .mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{border-color:CanvasText}}:host .mdc-fab:active,:host .mdc-fab:focus:active{box-shadow:0px 7px 8px -4px rgba(0, 0, 0, 0.2),0px 12px 17px 2px rgba(0, 0, 0, 0.14),0px 5px 22px 4px rgba(0,0,0,.12)}:host .mdc-fab:active,:host .mdc-fab:focus{outline:none}:host .mdc-fab:hover{cursor:pointer}:host .mdc-fab>svg{width:100%}:host .mdc-fab--mini{width:40px;height:40px}:host .mdc-fab--extended{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-button-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-button-font-size, 0.875rem);line-height:2.25rem;line-height:var(--mdc-typography-button-line-height, 2.25rem);font-weight:500;font-weight:var(--mdc-typography-button-font-weight, 500);letter-spacing:0.0892857143em;letter-spacing:var(--mdc-typography-button-letter-spacing, 0.0892857143em);text-decoration:none;text-decoration:var(--mdc-typography-button-text-decoration, none);text-transform:uppercase;text-transform:var(--mdc-typography-button-text-transform, uppercase);border-radius:24px;padding-left:20px;padding-right:20px;width:auto;max-width:100%;height:48px;line-height:normal}:host .mdc-fab--extended .mdc-fab__ripple{border-radius:24px}:host .mdc-fab--extended .mdc-fab__icon{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] :host .mdc-fab--extended .mdc-fab__icon,:host .mdc-fab--extended .mdc-fab__icon[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}:host .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] :host .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon,:host .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}:host .mdc-fab--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}:host .mdc-fab--touch .mdc-fab__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}:host .mdc-fab::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid transparent;border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){:host .mdc-fab::before{border-color:CanvasText}}:host .mdc-fab__label{justify-content:flex-start;text-overflow:ellipsis;white-space:nowrap;overflow-x:hidden;overflow-y:visible}:host .mdc-fab__icon{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}:host .mdc-fab .mdc-fab__icon{display:inline-flex;align-items:center;justify-content:center}:host .mdc-fab--exited{transform:scale(0);opacity:0;transition:opacity 15ms linear 150ms,transform 180ms 0ms cubic-bezier(0.4, 0, 1, 1)}:host .mdc-fab--exited .mdc-fab__icon{transform:scale(0);transition:transform 135ms 0ms cubic-bezier(0.4, 0, 1, 1)}:host .mdc-fab{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786);box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2),0px 6px 10px 0px rgba(0, 0, 0, 0.14),0px 1px 18px 0px rgba(0,0,0,.12)}:host .mdc-fab .mdc-fab__icon{width:24px;height:24px;font-size:24px}:host .mdc-fab,:host .mdc-fab:not(:disabled) .mdc-fab__icon,:host .mdc-fab:not(:disabled) .mdc-fab__label,:host .mdc-fab:disabled .mdc-fab__icon,:host .mdc-fab:disabled .mdc-fab__label{color:#fff;color:var(--mdc-theme-on-secondary, #fff)}:host .mdc-fab:not(.mdc-fab--extended){border-radius:50%}:host .mdc-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:50%}:host .mdc-fab{position:relative;display:inline-flex;position:relative;align-items:center;justify-content:center;box-sizing:border-box;width:56px;height:56px;padding:0;border:none;fill:currentColor;text-decoration:none;cursor:pointer;user-select:none;-moz-appearance:none;-webkit-appearance:none;overflow:visible;transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1),opacity 15ms linear 30ms,transform 270ms 0ms cubic-bezier(0, 0, 0.2, 1)}:host .mdc-fab .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}:host .mdc-fab::-moz-focus-inner{padding:0;border:0}:host .mdc-fab:hover{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2),0px 8px 10px 1px rgba(0, 0, 0, 0.14),0px 3px 14px 2px rgba(0,0,0,.12)}:host .mdc-fab.mdc-ripple-upgraded--background-focused,:host .mdc-fab:not(.mdc-ripple-upgraded):focus{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2),0px 8px 10px 1px rgba(0, 0, 0, 0.14),0px 3px 14px 2px rgba(0,0,0,.12)}:host .mdc-fab .mdc-fab__focus-ring{position:absolute}:host .mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,:host .mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{pointer-events:none;border:2px solid transparent;border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc( 100% + 4px );width:calc( 100% + 4px )}@media screen and (forced-colors: active){:host .mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,:host .mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{border-color:CanvasText}}:host .mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,:host .mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{content:"";border:2px solid transparent;border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){:host .mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,:host .mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{border-color:CanvasText}}:host .mdc-fab:active,:host .mdc-fab:focus:active{box-shadow:0px 7px 8px -4px rgba(0, 0, 0, 0.2),0px 12px 17px 2px rgba(0, 0, 0, 0.14),0px 5px 22px 4px rgba(0,0,0,.12)}:host .mdc-fab:active,:host .mdc-fab:focus{outline:none}:host .mdc-fab:hover{cursor:pointer}:host .mdc-fab>svg{width:100%}:host .mdc-fab--mini{width:40px;height:40px}:host .mdc-fab--extended{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-button-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-button-font-size, 0.875rem);line-height:2.25rem;line-height:var(--mdc-typography-button-line-height, 2.25rem);font-weight:500;font-weight:var(--mdc-typography-button-font-weight, 500);letter-spacing:0.0892857143em;letter-spacing:var(--mdc-typography-button-letter-spacing, 0.0892857143em);text-decoration:none;text-decoration:var(--mdc-typography-button-text-decoration, none);text-transform:uppercase;text-transform:var(--mdc-typography-button-text-transform, uppercase);border-radius:24px;padding-left:20px;padding-right:20px;width:auto;max-width:100%;height:48px;line-height:normal}:host .mdc-fab--extended .mdc-fab__ripple{border-radius:24px}:host .mdc-fab--extended .mdc-fab__icon{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] :host .mdc-fab--extended .mdc-fab__icon,:host .mdc-fab--extended .mdc-fab__icon[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}:host .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] :host .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon,:host .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}:host .mdc-fab--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}:host .mdc-fab--touch .mdc-fab__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}:host .mdc-fab::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid transparent;border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){:host .mdc-fab::before{border-color:CanvasText}}:host .mdc-fab__label{justify-content:flex-start;text-overflow:ellipsis;white-space:nowrap;overflow-x:hidden;overflow-y:visible}:host .mdc-fab__icon{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}:host .mdc-fab .mdc-fab__icon{display:inline-flex;align-items:center;justify-content:center}:host .mdc-fab--exited{transform:scale(0);opacity:0;transition:opacity 15ms linear 150ms,transform 180ms 0ms cubic-bezier(0.4, 0, 1, 1)}:host .mdc-fab--exited .mdc-fab__icon{transform:scale(0);transition:transform 135ms 0ms cubic-bezier(0.4, 0, 1, 1)}:host .mdc-fab .ripple{overflow:hidden}:host .mdc-fab:not(.mdc-fab--extended) .ripple{border-radius:50%}:host .mdc-fab.mdc-fab--extended .ripple{border-radius:24px}:host .mdc-fab .mdc-fab__label{z-index:0}:host .mdc-fab .mdc-fab__icon ::slotted(*){width:inherit;height:inherit;font-size:inherit}:host .mdc-fab--extended.mdc-fab--exited .mdc-fab__icon ::slotted(*){transform:scale(0);transition:transform 135ms 0ms cubic-bezier(0.4, 0, 1, 1)}:host .mdc-fab{padding-top:0px;padding-top:max(0px, var(--mdc-fab-focus-outline-width, 0px));padding-right:0px;padding-right:max(0px, var(--mdc-fab-focus-outline-width, 0px));padding-bottom:0px;padding-bottom:max(0px, var(--mdc-fab-focus-outline-width, 0px));padding-left:0px;padding-left:max(0px, var(--mdc-fab-focus-outline-width, 0px));box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);box-shadow:var(--mdc-fab-box-shadow, 0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12))}:host .mdc-fab:not(:disabled).mdc-ripple-upgraded--background-focused,:host .mdc-fab:not(:disabled):not(.mdc-ripple-upgraded):focus{border-color:initial;border-color:var(--mdc-fab-focus-outline-color, initial)}:host .mdc-fab:not(:disabled).mdc-ripple-upgraded--background-focused,:host .mdc-fab:not(:disabled):not(.mdc-ripple-upgraded):focus{border-style:solid;border-width:var(--mdc-fab-focus-outline-width, 0px);padding-top:0px;padding-top:max(calc(0px - var(--mdc-fab-focus-outline-width, 0px)), calc(calc(0px - var(--mdc-fab-focus-outline-width, 0px)) * -1));padding-right:0px;padding-right:max(calc(0px - var(--mdc-fab-focus-outline-width, 0px)), calc(calc(0px - var(--mdc-fab-focus-outline-width, 0px)) * -1));padding-bottom:0px;padding-bottom:max(calc(0px - var(--mdc-fab-focus-outline-width, 0px)), calc(calc(0px - var(--mdc-fab-focus-outline-width, 0px)) * -1));padding-left:0px;padding-left:max(calc(0px - var(--mdc-fab-focus-outline-width, 0px)), calc(calc(0px - var(--mdc-fab-focus-outline-width, 0px)) * -1))}:host .mdc-fab:hover,:host .mdc-fab:focus{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);box-shadow:var(--mdc-fab-box-shadow, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}:host .mdc-fab:active{box-shadow:0px 7px 8px -4px rgba(0, 0, 0, 0.2), 0px 12px 17px 2px rgba(0, 0, 0, 0.14), 0px 5px 22px 4px rgba(0, 0, 0, 0.12);box-shadow:var(--mdc-fab-box-shadow, 0px 7px 8px -4px rgba(0, 0, 0, 0.2), 0px 12px 17px 2px rgba(0, 0, 0, 0.14), 0px 5px 22px 4px rgba(0, 0, 0, 0.12))}:host .mdc-fab .ripple{overflow:hidden}:host .mdc-fab .mdc-fab__label{z-index:0}:host .mdc-fab:not(.mdc-fab--extended) .ripple{border-radius:50%}:host .mdc-fab.mdc-fab--extended .ripple{border-radius:24px}:host .mdc-fab .mdc-fab__icon{width:24px;width:var(--mdc-icon-size, 24px);height:24px;height:var(--mdc-icon-size, 24px);font-size:24px;font-size:var(--mdc-icon-size, 24px);transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform;display:inline-flex;align-items:center;justify-content:center}:host .mdc-fab.mdc-fab--extended{padding-top:0px;padding-top:max(0px, var(--mdc-fab-focus-outline-width, 0px));padding-right:20px;padding-right:max(var(--mdc-fab-extended-label-padding, 20px), var(--mdc-fab-focus-outline-width, 0px));padding-bottom:0px;padding-bottom:max(0px, var(--mdc-fab-focus-outline-width, 0px));padding-left:20px;padding-left:max(var(--mdc-fab-extended-label-padding, 20px), var(--mdc-fab-focus-outline-width, 0px))}:host .mdc-fab.mdc-fab--extended:not(:disabled).mdc-ripple-upgraded--background-focused,:host .mdc-fab.mdc-fab--extended:not(:disabled):not(.mdc-ripple-upgraded):focus{border-style:solid;border-width:var(--mdc-fab-focus-outline-width, 0px);padding-top:0px;padding-top:max(calc(0px - var(--mdc-fab-focus-outline-width, 0px)), calc(calc(0px - var(--mdc-fab-focus-outline-width, 0px)) * -1));padding-right:20px;padding-right:max(calc(var(--mdc-fab-extended-label-padding, 20px) - var(--mdc-fab-focus-outline-width, 0px)), calc(calc(var(--mdc-fab-extended-label-padding, 20px) - var(--mdc-fab-focus-outline-width, 0px)) * -1));padding-bottom:0px;padding-bottom:max(calc(0px - var(--mdc-fab-focus-outline-width, 0px)), calc(calc(0px - var(--mdc-fab-focus-outline-width, 0px)) * -1));padding-left:20px;padding-left:max(calc(var(--mdc-fab-extended-label-padding, 20px) - var(--mdc-fab-focus-outline-width, 0px)), calc(calc(var(--mdc-fab-extended-label-padding, 20px) - var(--mdc-fab-focus-outline-width, 0px)) * -1))}:host .mdc-fab.mdc-fab--extended.icon-end .mdc-fab__icon{margin-left:12px;margin-left:var(--mdc-fab-extended-icon-padding, 12px);margin-right:calc(12px - 20px);margin-right:calc(var(--mdc-fab-extended-icon-padding, 12px) - var(--mdc-fab-extended-label-padding, 20px))}[dir=rtl] :host .mdc-fab.mdc-fab--extended.icon-end .mdc-fab__icon,:host .mdc-fab.mdc-fab--extended.icon-end .mdc-fab__icon[dir=rtl]{margin-left:calc(12px - 20px);margin-left:calc(var(--mdc-fab-extended-icon-padding, 12px) - var(--mdc-fab-extended-label-padding, 20px));margin-right:12px;margin-right:var(--mdc-fab-extended-icon-padding, 12px)}`;let Ed=class extends Sd{};Ed.styles=[Cd],Ed=it([at("mwc-fab")],Ed);class $d extends(al(K)){static get styles(){return[nl,n`
        :host {
          margin: 25px 40px;
          background-color: #ffffff;
          --mdc-list-side-padding: 16px;
        }

        @media (max-width: 768px) {
          :host {
            margin: 25px 25px;
            --mdc-list-side-padding: 8px;
          }
        }
      `]}shouldUpdate(){return this.active}static get properties(){return{active:{type:Boolean},loading:{type:Boolean},error:{type:Boolean},settings:{type:Object},_errorMessage:{type:String},_hasFirstUpdated:{type:Boolean}}}constructor(){super(),this.active=!1,this.loading=!1,this.error=!1,this.settings={},this._errorMessage="",this._hasFirstUpdated=!1}render(){return this.error&&this.dispatchEvent(new CustomEvent("grampsjs:error",{bubbles:!0,composed:!0,detail:{message:this._errorMessage}})),this.renderContent()}firstUpdated(){this._hasFirstUpdated=!0}update(t){super.update(t),t.has("loading")&&(this.loading&&this.active?this.dispatchEvent(new CustomEvent("progress:on",{bubbles:!0,composed:!0})):!this.loading&&this.active&&this.dispatchEvent(new CustomEvent("progress:off",{bubbles:!0,composed:!0}))),t.has("active")&&(this.active?this.loading&&this.dispatchEvent(new CustomEvent("progress:on",{bubbles:!0,composed:!0})):this.dispatchEvent(new CustomEvent("progress:off",{bubbles:!0,composed:!0})))}}class Ad extends(al(K)){static get styles(){return[nl,n`
        .paging {
          font-size: 14px;
          font-size: 14px;
          margin-top: 50px;
          text-align: center;
        }

        .span {
          color: rgba(0, 0, 0, 0.9);
          padding: 0 0.5em;
        }

        mwc-button {
          --mdc-ripple-focus-opacity: 0;
          --mdc-theme-primary: rgba(0, 0, 0, 0.7);
        }

        .pagebtn {
          --mdc-button-horizontal-padding: 0;
        }

        mwc-icon.more {
          color: rgba(0, 0, 0, 0.2);
          position: relative;
          top: 0.35em;
        }
      `]}static get properties(){return{page:{type:Number},pages:{type:Number},link:{type:String}}}constructor(){super(),this.page=1,this.pages=-1}render(){return this.pages<=0?M``:M`
      <div class="paging">
        ${this._renderPrevBtn()} ${this._renderPageBtn(1)}
        ${this.pages>1?this._renderPageBtn(2):""}
        ${this.page-1>3?M`<mwc-icon class="more">more_horiz</mwc-icon>`:""}
        ${this.page-1>2&&this.page-1<this.pages-1?this._renderPageBtn(this.page-1):""}
        ${this.page>2&&this.page<this.pages-1?this._renderPageBtn(this.page):""}
        ${this.page+1>2&&this.page+1<this.pages-1?this._renderPageBtn(this.page+1):""}
        ${this.page+1<this.pages-2?M`<mwc-icon class="more">more_horiz</mwc-icon>`:""}
        ${this.pages>3?this._renderPageBtn(this.pages-1):""}
        ${this.pages>2?this._renderPageBtn(this.pages):""}
        ${this._renderNextBtn()}
        <div></div>
      </div>
    `}_renderPageBtn(t){return M`
      <mwc-button
        width="30px"
        class="pagebtn"
        ?disabled=${this.page===t}
        ?unelevated=${this.page===t}
        @click="${()=>this._changePage(t)}"
        label="${t}"
      >
      </mwc-button>
    `}_renderPrevBtn(){return M`
      <mwc-button
        icon="navigate_before"
        ?disabled=${1===this.page}
        @click="${()=>this._changePage(this.page-1)}"
        label="${this._("Previous")}"
      >
      </mwc-button>
    `}_renderNextBtn(){return M`
      <mwc-button
        icon="navigate_next"
        ?disabled=${this.page===this.pages}
        @click="${()=>this._changePage(this.page+1)}"
        label="${this._("Next")}"
        trailingIcon
      >
      </mwc-button>
    `}_changePage(t){t!==this.page&&(this.page=t,this._fireEvent())}_fireEvent(){this.dispatchEvent(new CustomEvent("page:changed",{bubbles:!0,composed:!0,detail:{page:this.page}}))}}window.customElements.define("grampsjs-pagination",Ad);var Id=["input","button","textarea","select"],Md=function(t){var e=t.target;if(e){var i=(""+e.tagName).toLowerCase();-1===Id.indexOf(i)&&t.preventDefault()}};function Ld(t,e){for(var i=new Map,r=0;r<t;r++){var n=e(r).trim();if(n){var a=n[0].toLowerCase();i.has(a)||i.set(a,[]),i.get(a).push({text:n.toLowerCase(),index:r})}}return i.forEach((function(t){t.sort((function(t,e){return t.index-e.index}))})),i}function Pd(t,e){var i,r=t.nextChar,n=t.focusItemAtIndex,a=t.sortedIndexByFirstChar,s=t.focusedItemIndex,o=t.skipFocus,l=t.isItemAtIndexDisabled;return clearTimeout(e.bufferClearTimeout),e.bufferClearTimeout=setTimeout((function(){!function(t){t.typeaheadBuffer=""}(e)}),_r.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),e.typeaheadBuffer=e.typeaheadBuffer+r,i=1===e.typeaheadBuffer.length?function(t,e,i,r){var n=r.typeaheadBuffer[0],a=t.get(n);if(!a)return-1;if(n===r.currentFirstChar&&a[r.sortedIndexCursor].index===e){r.sortedIndexCursor=(r.sortedIndexCursor+1)%a.length;var s=a[r.sortedIndexCursor].index;if(!i(s))return s}r.currentFirstChar=n;var o,l=-1;for(o=0;o<a.length;o++)if(!i(a[o].index)){l=o;break}for(;o<a.length;o++)if(a[o].index>e&&!i(a[o].index)){l=o;break}if(-1!==l)return r.sortedIndexCursor=l,a[r.sortedIndexCursor].index;return-1}(a,s,l,e):function(t,e,i){var r=i.typeaheadBuffer[0],n=t.get(r);if(!n)return-1;var a=n[i.sortedIndexCursor];if(0===a.text.lastIndexOf(i.typeaheadBuffer,0)&&!e(a.index))return a.index;var s=(i.sortedIndexCursor+1)%n.length,o=-1;for(;s!==i.sortedIndexCursor;){var l=n[s],c=0===l.text.lastIndexOf(i.typeaheadBuffer,0),d=!e(l.index);if(c&&d){o=s;break}s=(s+1)%n.length}if(-1!==o)return i.sortedIndexCursor=o,n[i.sortedIndexCursor].index;return-1}(a,l,e),-1===i||o||n(i),i}function Rd(t){return t.typeaheadBuffer.length>0}var zd={ACTIVATED:"mdc-select--activated",DISABLED:"mdc-select--disabled",FOCUSED:"mdc-select--focused",INVALID:"mdc-select--invalid",MENU_INVALID:"mdc-select__menu--invalid",OUTLINED:"mdc-select--outlined",REQUIRED:"mdc-select--required",ROOT:"mdc-select",WITH_LEADING_ICON:"mdc-select--with-leading-icon"},Dd={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",ARIA_SELECTED_ATTR:"aria-selected",CHANGE_EVENT:"MDCSelect:change",HIDDEN_INPUT_SELECTOR:'input[type="hidden"]',LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-select__icon",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",MENU_SELECTOR:".mdc-select__menu",OUTLINE_SELECTOR:".mdc-notched-outline",SELECTED_TEXT_SELECTOR:".mdc-select__selected-text",SELECT_ANCHOR_SELECTOR:".mdc-select__anchor",VALUE_ATTR:"data-value"},jd={LABEL_SCALE:.75,UNSET_INDEX:-1,CLICK_DEBOUNCE_TIMEOUT_MS:330},Od=function(t){function e(i,r){void 0===r&&(r={});var n=t.call(this,et(et({},e.defaultAdapter),i))||this;return n.disabled=!1,n.isMenuOpen=!1,n.useDefaultValidation=!0,n.customValidity=!0,n.lastSelectedIndex=jd.UNSET_INDEX,n.clickDebounceTimeout=0,n.recentlyClicked=!1,n.leadingIcon=r.leadingIcon,n.helperText=r.helperText,n}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return zd},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return jd},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Dd},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},activateBottomLine:function(){},deactivateBottomLine:function(){},getSelectedIndex:function(){return-1},setSelectedIndex:function(){},hasLabel:function(){return!1},floatLabel:function(){},getLabelWidth:function(){return 0},setLabelRequired:function(){},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){},setRippleCenter:function(){},notifyChange:function(){},setSelectedText:function(){},isSelectAnchorFocused:function(){return!1},getSelectAnchorAttr:function(){return""},setSelectAnchorAttr:function(){},removeSelectAnchorAttr:function(){},addMenuClass:function(){},removeMenuClass:function(){},openMenu:function(){},closeMenu:function(){},getAnchorElement:function(){return null},setMenuAnchorElement:function(){},setMenuAnchorCorner:function(){},setMenuWrapFocus:function(){},focusMenuItemAtIndex:function(){},getMenuItemCount:function(){return 0},getMenuItemValues:function(){return[]},getMenuItemTextAtIndex:function(){return""},isTypeaheadInProgress:function(){return!1},typeaheadMatchItem:function(){return-1}}},enumerable:!1,configurable:!0}),e.prototype.getSelectedIndex=function(){return this.adapter.getSelectedIndex()},e.prototype.setSelectedIndex=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),t>=this.adapter.getMenuItemCount()||(t===jd.UNSET_INDEX?this.adapter.setSelectedText(""):this.adapter.setSelectedText(this.adapter.getMenuItemTextAtIndex(t).trim()),this.adapter.setSelectedIndex(t),e&&this.adapter.closeMenu(),i||this.lastSelectedIndex===t||this.handleChange(),this.lastSelectedIndex=t)},e.prototype.setValue=function(t,e){void 0===e&&(e=!1);var i=this.adapter.getMenuItemValues().indexOf(t);this.setSelectedIndex(i,!1,e)},e.prototype.getValue=function(){var t=this.adapter.getSelectedIndex(),e=this.adapter.getMenuItemValues();return t!==jd.UNSET_INDEX?e[t]:""},e.prototype.getDisabled=function(){return this.disabled},e.prototype.setDisabled=function(t){this.disabled=t,this.disabled?(this.adapter.addClass(zd.DISABLED),this.adapter.closeMenu()):this.adapter.removeClass(zd.DISABLED),this.leadingIcon&&this.leadingIcon.setDisabled(this.disabled),this.disabled?this.adapter.removeSelectAnchorAttr("tabindex"):this.adapter.setSelectAnchorAttr("tabindex","0"),this.adapter.setSelectAnchorAttr("aria-disabled",this.disabled.toString())},e.prototype.openMenu=function(){this.adapter.addClass(zd.ACTIVATED),this.adapter.openMenu(),this.isMenuOpen=!0,this.adapter.setSelectAnchorAttr("aria-expanded","true")},e.prototype.setHelperTextContent=function(t){this.helperText&&this.helperText.setContent(t)},e.prototype.layout=function(){if(this.adapter.hasLabel()){var t=this.getValue().length>0,e=this.adapter.hasClass(zd.FOCUSED),i=t||e,r=this.adapter.hasClass(zd.REQUIRED);this.notchOutline(i),this.adapter.floatLabel(i),this.adapter.setLabelRequired(r)}},e.prototype.layoutOptions=function(){var t=this.adapter.getMenuItemValues().indexOf(this.getValue());this.setSelectedIndex(t,!1,!0)},e.prototype.handleMenuOpened=function(){if(0!==this.adapter.getMenuItemValues().length){var t=this.getSelectedIndex(),e=t>=0?t:0;this.adapter.focusMenuItemAtIndex(e)}},e.prototype.handleMenuClosing=function(){this.adapter.setSelectAnchorAttr("aria-expanded","false")},e.prototype.handleMenuClosed=function(){this.adapter.removeClass(zd.ACTIVATED),this.isMenuOpen=!1,this.adapter.isSelectAnchorFocused()||this.blur()},e.prototype.handleChange=function(){this.layout(),this.adapter.notifyChange(this.getValue()),this.adapter.hasClass(zd.REQUIRED)&&this.useDefaultValidation&&this.setValid(this.isValid())},e.prototype.handleMenuItemAction=function(t){this.setSelectedIndex(t,!0)},e.prototype.handleFocus=function(){this.adapter.addClass(zd.FOCUSED),this.layout(),this.adapter.activateBottomLine()},e.prototype.handleBlur=function(){this.isMenuOpen||this.blur()},e.prototype.handleClick=function(t){this.disabled||this.recentlyClicked||(this.setClickDebounceTimeout(),this.isMenuOpen?this.adapter.closeMenu():(this.adapter.setRippleCenter(t),this.openMenu()))},e.prototype.handleKeydown=function(t){if(!this.isMenuOpen&&this.adapter.hasClass(zd.FOCUSED)){var e=or(t)===Ni.ENTER,i=or(t)===Ni.SPACEBAR,r=or(t)===Ni.ARROW_UP,n=or(t)===Ni.ARROW_DOWN;if(!(t.ctrlKey||t.metaKey)&&(!i&&t.key&&1===t.key.length||i&&this.adapter.isTypeaheadInProgress())){var a=i?" ":t.key,s=this.adapter.typeaheadMatchItem(a,this.getSelectedIndex());return s>=0&&this.setSelectedIndex(s),void t.preventDefault()}(e||i||r||n)&&(this.openMenu(),t.preventDefault())}},e.prototype.notchOutline=function(t){if(this.adapter.hasOutline()){var e=this.adapter.hasClass(zd.FOCUSED);if(t){var i=jd.LABEL_SCALE,r=this.adapter.getLabelWidth()*i;this.adapter.notchOutline(r)}else e||this.adapter.closeOutline()}},e.prototype.setLeadingIconAriaLabel=function(t){this.leadingIcon&&this.leadingIcon.setAriaLabel(t)},e.prototype.setLeadingIconContent=function(t){this.leadingIcon&&this.leadingIcon.setContent(t)},e.prototype.getUseDefaultValidation=function(){return this.useDefaultValidation},e.prototype.setUseDefaultValidation=function(t){this.useDefaultValidation=t},e.prototype.setValid=function(t){this.useDefaultValidation||(this.customValidity=t),this.adapter.setSelectAnchorAttr("aria-invalid",(!t).toString()),t?(this.adapter.removeClass(zd.INVALID),this.adapter.removeMenuClass(zd.MENU_INVALID)):(this.adapter.addClass(zd.INVALID),this.adapter.addMenuClass(zd.MENU_INVALID)),this.syncHelperTextValidity(t)},e.prototype.isValid=function(){return this.useDefaultValidation&&this.adapter.hasClass(zd.REQUIRED)&&!this.adapter.hasClass(zd.DISABLED)?this.getSelectedIndex()!==jd.UNSET_INDEX&&(0!==this.getSelectedIndex()||Boolean(this.getValue())):this.customValidity},e.prototype.setRequired=function(t){t?this.adapter.addClass(zd.REQUIRED):this.adapter.removeClass(zd.REQUIRED),this.adapter.setSelectAnchorAttr("aria-required",t.toString()),this.adapter.setLabelRequired(t)},e.prototype.getRequired=function(){return"true"===this.adapter.getSelectAnchorAttr("aria-required")},e.prototype.init=function(){var t=this.adapter.getAnchorElement();t&&(this.adapter.setMenuAnchorElement(t),this.adapter.setMenuAnchorCorner(Ar.BOTTOM_START)),this.adapter.setMenuWrapFocus(!1),this.setDisabled(this.adapter.hasClass(zd.DISABLED)),this.syncHelperTextValidity(!this.adapter.hasClass(zd.INVALID)),this.layout(),this.layoutOptions()},e.prototype.blur=function(){this.adapter.removeClass(zd.FOCUSED),this.layout(),this.adapter.deactivateBottomLine(),this.adapter.hasClass(zd.REQUIRED)&&this.useDefaultValidation&&this.setValid(this.isValid())},e.prototype.syncHelperTextValidity=function(t){if(this.helperText){this.helperText.setValidity(t);var e=this.helperText.isVisible(),i=this.helperText.getId();e&&i?this.adapter.setSelectAnchorAttr(Dd.ARIA_DESCRIBEDBY,i):this.adapter.removeSelectAnchorAttr(Dd.ARIA_DESCRIBEDBY)}},e.prototype.setClickDebounceTimeout=function(){var t=this;clearTimeout(this.clickDebounceTimeout),this.clickDebounceTimeout=setTimeout((function(){t.recentlyClicked=!1}),jd.CLICK_DEBOUNCE_TIMEOUT_MS),this.recentlyClicked=!0},e}(vt);const Bd=(t={})=>{const e={};for(const i in t)e[i]=t[i];return Object.assign({badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!0,valueMissing:!1},e)};class Fd extends hi{constructor(){super(...arguments),this.mdcFoundationClass=Od,this.disabled=!1,this.outlined=!1,this.label="",this.outlineOpen=!1,this.outlineWidth=0,this.value="",this.name="",this.selectedText="",this.icon="",this.menuOpen=!1,this.helper="",this.validateOnInitialRender=!1,this.validationMessage="",this.required=!1,this.naturalMenuWidth=!1,this.isUiValid=!0,this.fixedMenuPosition=!1,this.typeaheadState={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""},this.sortedIndexByFirstChar=new Map,this.menuElement_=null,this.listeners=[],this.onBodyClickBound=()=>{},this._menuUpdateComplete=null,this.valueSetDirectly=!1,this.validityTransform=null,this._validity=Bd()}get items(){return this.menuElement_||(this.menuElement_=this.menuElement),this.menuElement_?this.menuElement_.items:[]}get selected(){const t=this.menuElement;return t?t.selected:null}get index(){const t=this.menuElement;return t?t.index:-1}get shouldRenderHelperText(){return!!this.helper||!!this.validationMessage}get validity(){return this._checkValidity(this.value),this._validity}render(){const t={"mdc-select--disabled":this.disabled,"mdc-select--no-label":!this.label,"mdc-select--filled":!this.outlined,"mdc-select--outlined":this.outlined,"mdc-select--with-leading-icon":!!this.icon,"mdc-select--required":this.required,"mdc-select--invalid":!this.isUiValid},e=this.label?"label":void 0,i=this.shouldRenderHelperText?"helper-text":void 0;return M`
      <div
          class="mdc-select ${Ot(t)}">
        <input
            class="formElement"
            name="${this.name}"
            .value="${this.value}"
            hidden
            ?disabled="${this.disabled}"
            ?required=${this.required}>
        <!-- @ts-ignore -->
        <div class="mdc-select__anchor"
            aria-autocomplete="none"
            role="combobox"
            aria-expanded=${this.menuOpen}
            aria-invalid=${!this.isUiValid}
            aria-haspopup="listbox"
            aria-labelledby=${Ke(e)}
            aria-required=${this.required}
            aria-describedby=${Ke(i)}
            @click=${this.onClick}
            @focus=${this.onFocus}
            @blur=${this.onBlur}
            @keydown=${this.onKeydown}>
          ${this.renderRipple()}
          ${this.outlined?this.renderOutline():this.renderLabel()}
          ${this.renderLeadingIcon()}
          <span class="mdc-select__selected-text-container">
            <span class="mdc-select__selected-text">${this.selectedText}</span>
          </span>
          <span class="mdc-select__dropdown-icon">
            <svg
                class="mdc-select__dropdown-icon-graphic"
                viewBox="7 10 10 5"
                focusable="false">
              <polygon
                  class="mdc-select__dropdown-icon-inactive"
                  stroke="none"
                  fill-rule="evenodd"
                  points="7 10 12 15 17 10">
              </polygon>
              <polygon
                  class="mdc-select__dropdown-icon-active"
                  stroke="none"
                  fill-rule="evenodd"
                  points="7 15 12 10 17 15">
              </polygon>
            </svg>
          </span>
          ${this.renderLineRipple()}
        </div>
        ${this.renderMenu()}
      </div>
      ${this.renderHelperText()}`}renderMenu(){const t=this.getMenuClasses();return M`
      <mwc-menu
        innerRole="listbox"
        wrapFocus
        class=" ${Ot(t)}"
        activatable
        .fullwidth=${!this.fixedMenuPosition&&!this.naturalMenuWidth}
        .open=${this.menuOpen}
        .anchor=${this.anchorElement}
        .fixed=${this.fixedMenuPosition}
        @selected=${this.onSelected}
        @opened=${this.onOpened}
        @closed=${this.onClosed}
        @items-updated=${this.onItemsUpdated}
        @keydown=${this.handleTypeahead}>
      ${this.renderMenuContent()}
    </mwc-menu>`}getMenuClasses(){return{"mdc-select__menu":!0,"mdc-menu":!0,"mdc-menu-surface":!0,"mdc-select__menu--invalid":!this.isUiValid}}renderMenuContent(){return M`<slot></slot>`}renderRipple(){return this.outlined?R:M`
      <span class="mdc-select__ripple"></span>
    `}renderOutline(){return this.outlined?M`
      <mwc-notched-outline
          .width=${this.outlineWidth}
          .open=${this.outlineOpen}
          class="mdc-notched-outline">
        ${this.renderLabel()}
      </mwc-notched-outline>`:R}renderLabel(){return this.label?M`
      <span
          .floatingLabelFoundation=${mi(this.label)}
          id="label">${this.label}</span>
    `:R}renderLeadingIcon(){return this.icon?M`<mwc-icon class="mdc-select__icon"><div>${this.icon}</div></mwc-icon>`:R}renderLineRipple(){return this.outlined?R:M`
      <span .lineRippleFoundation=${_i()}></span>
    `}renderHelperText(){if(!this.shouldRenderHelperText)return R;const t=this.validationMessage&&!this.isUiValid;return M`
        <p
          class="mdc-select-helper-text ${Ot({"mdc-select-helper-text--validation-msg":t})}"
          id="helper-text">${t?this.validationMessage:this.helper}</p>`}createAdapter(){return Object.assign(Object.assign({},kt(this.mdcRoot)),{activateBottomLine:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.activate()},deactivateBottomLine:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.deactivate()},hasLabel:()=>!!this.label,floatLabel:t=>{this.labelElement&&this.labelElement.floatingLabelFoundation.float(t)},getLabelWidth:()=>this.labelElement?this.labelElement.floatingLabelFoundation.getWidth():0,setLabelRequired:t=>{this.labelElement&&this.labelElement.floatingLabelFoundation.setRequired(t)},hasOutline:()=>this.outlined,notchOutline:t=>{this.outlineElement&&!this.outlineOpen&&(this.outlineWidth=t,this.outlineOpen=!0)},closeOutline:()=>{this.outlineElement&&(this.outlineOpen=!1)},setRippleCenter:t=>{if(this.lineRippleElement){this.lineRippleElement.lineRippleFoundation.setRippleCenter(t)}},notifyChange:async t=>{if(!this.valueSetDirectly&&t===this.value)return;this.valueSetDirectly=!1,this.value=t,await this.updateComplete;const e=new Event("change",{bubbles:!0});this.dispatchEvent(e)},setSelectedText:t=>this.selectedText=t,isSelectAnchorFocused:()=>{const t=this.anchorElement;if(!t)return!1;return t.getRootNode().activeElement===t},getSelectAnchorAttr:t=>{const e=this.anchorElement;return e?e.getAttribute(t):null},setSelectAnchorAttr:(t,e)=>{const i=this.anchorElement;i&&i.setAttribute(t,e)},removeSelectAnchorAttr:t=>{const e=this.anchorElement;e&&e.removeAttribute(t)},openMenu:()=>{this.menuOpen=!0},closeMenu:()=>{this.menuOpen=!1},addMenuClass:()=>{},removeMenuClass:()=>{},getAnchorElement:()=>this.anchorElement,setMenuAnchorElement:()=>{},setMenuAnchorCorner:()=>{const t=this.menuElement;t&&(t.corner="BOTTOM_START")},setMenuWrapFocus:t=>{const e=this.menuElement;e&&(e.wrapFocus=t)},focusMenuItemAtIndex:t=>{const e=this.menuElement;if(!e)return;const i=e.items[t];i&&i.focus()},getMenuItemCount:()=>{const t=this.menuElement;return t?t.items.length:0},getMenuItemValues:()=>{const t=this.menuElement;if(!t)return[];return t.items.map((t=>t.value))},getMenuItemTextAtIndex:t=>{const e=this.menuElement;if(!e)return"";const i=e.items[t];return i?i.text:""},getSelectedIndex:()=>this.index,setSelectedIndex:()=>{},isTypeaheadInProgress:()=>Rd(this.typeaheadState),typeaheadMatchItem:(t,e)=>{if(!this.menuElement)return-1;const i={focusItemAtIndex:t=>{this.menuElement.focusItemAtIndex(t)},focusedItemIndex:e||this.menuElement.getFocusedItemIndex(),nextChar:t,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:!1,isItemAtIndexDisabled:t=>this.items[t].disabled},r=Pd(i,this.typeaheadState);return-1!==r&&this.select(r),r}})}checkValidity(){const t=this._checkValidity(this.value);if(!t){const t=new Event("invalid",{bubbles:!1,cancelable:!0});this.dispatchEvent(t)}return t}reportValidity(){const t=this.checkValidity();return this.isUiValid=t,t}_checkValidity(t){const e=this.formElement.validity;let i=Bd(e);if(this.validityTransform){const e=this.validityTransform(t,i);i=Object.assign(Object.assign({},i),e)}return this._validity=i,this._validity.valid}setCustomValidity(t){this.validationMessage=t,this.formElement.setCustomValidity(t)}async getUpdateComplete(){await this._menuUpdateComplete;return await super.getUpdateComplete()}async firstUpdated(){const t=this.menuElement;if(t&&(this._menuUpdateComplete=t.updateComplete,await this._menuUpdateComplete),super.firstUpdated(),this.mdcFoundation.isValid=()=>!0,this.mdcFoundation.setValid=()=>{},this.mdcFoundation.setDisabled(this.disabled),this.validateOnInitialRender&&this.reportValidity(),!this.selected){!this.items.length&&this.slotElement&&this.slotElement.assignedNodes({flatten:!0}).length&&(await new Promise((t=>requestAnimationFrame(t))),await this.layout());const t=this.items.length&&""===this.items[0].value;if(!this.value&&t)return void this.select(0);this.selectByValue(this.value)}this.sortedIndexByFirstChar=Ld(this.items.length,(t=>this.items[t].text))}onItemsUpdated(){this.sortedIndexByFirstChar=Ld(this.items.length,(t=>this.items[t].text))}select(t){const e=this.menuElement;e&&e.select(t)}selectByValue(t){let e=-1;for(let i=0;i<this.items.length;i++){if(this.items[i].value===t){e=i;break}}this.valueSetDirectly=!0,this.select(e),this.mdcFoundation.handleChange()}disconnectedCallback(){super.disconnectedCallback();for(const t of this.listeners)t.target.removeEventListener(t.name,t.cb)}focus(){const t=new CustomEvent("focus"),e=this.anchorElement;e&&(e.dispatchEvent(t),e.focus())}blur(){const t=new CustomEvent("blur"),e=this.anchorElement;e&&(e.dispatchEvent(t),e.blur())}onFocus(){this.mdcFoundation&&this.mdcFoundation.handleFocus()}onBlur(){this.mdcFoundation&&this.mdcFoundation.handleBlur();const t=this.menuElement;t&&!t.open&&this.reportValidity()}onClick(t){if(this.mdcFoundation){this.focus();const e=t.target.getBoundingClientRect();let i=0;i="touches"in t?t.touches[0].clientX:t.clientX;const r=i-e.left;this.mdcFoundation.handleClick(r)}}onKeydown(t){const e=or(t)===Ni.ARROW_UP,i=or(t)===Ni.ARROW_DOWN;if(i||e){const r=e&&this.index>0,n=i&&this.index<this.items.length-1;return r?this.select(this.index-1):n&&this.select(this.index+1),t.preventDefault(),void this.mdcFoundation.openMenu()}this.mdcFoundation.handleKeydown(t)}handleTypeahead(t){if(!this.menuElement)return;const e=this.menuElement.getFocusedItemIndex(),i=wt(t.target)?t.target:null;!function(t,e){var i=t.event,r=t.isTargetListItem,n=t.focusedItemIndex,a=t.focusItemAtIndex,s=t.sortedIndexByFirstChar,o=t.isItemAtIndexDisabled,l="ArrowLeft"===or(i),c="ArrowUp"===or(i),d="ArrowRight"===or(i),h="ArrowDown"===or(i),p="Home"===or(i),u="End"===or(i),m="Enter"===or(i),f="Spacebar"===or(i);i.altKey||i.ctrlKey||i.metaKey||l||c||d||h||p||u||m||(f||1!==i.key.length?f&&(r&&Md(i),r&&Rd(e)&&Pd({focusItemAtIndex:a,focusedItemIndex:n,nextChar:" ",sortedIndexByFirstChar:s,skipFocus:!1,isItemAtIndexDisabled:o},e)):(Md(i),Pd({focusItemAtIndex:a,focusedItemIndex:n,nextChar:i.key.toLowerCase(),sortedIndexByFirstChar:s,skipFocus:!1,isItemAtIndexDisabled:o},e)))}({event:t,focusItemAtIndex:t=>{this.menuElement.focusItemAtIndex(t)},focusedItemIndex:e,isTargetListItem:!!i&&i.hasAttribute("mwc-list-item"),sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:t=>this.items[t].disabled},this.typeaheadState)}async onSelected(t){this.mdcFoundation||await this.updateComplete,this.mdcFoundation.handleMenuItemAction(t.detail.index);const e=this.items[t.detail.index];e&&(this.value=e.value)}onOpened(){this.mdcFoundation&&(this.menuOpen=!0,this.mdcFoundation.handleMenuOpened())}onClosed(){this.mdcFoundation&&(this.menuOpen=!1,this.mdcFoundation.handleMenuClosed())}setFormData(t){this.name&&null!==this.selected&&t.append(this.name,this.value)}async layout(t=!0){this.mdcFoundation&&this.mdcFoundation.layout(),await this.updateComplete;const e=this.menuElement;e&&e.layout(t);const i=this.labelElement;if(!i)return void(this.outlineOpen=!1);const r=!!this.label&&!!this.value;if(i.floatingLabelFoundation.float(r),!this.outlined)return;this.outlineOpen=r,await this.updateComplete;const n=i.floatingLabelFoundation.getWidth();this.outlineOpen&&(this.outlineWidth=n)}async layoutOptions(){this.mdcFoundation&&this.mdcFoundation.layoutOptions()}}it([ht(".mdc-select")],Fd.prototype,"mdcRoot",void 0),it([ht(".formElement")],Fd.prototype,"formElement",void 0),it([ht("slot")],Fd.prototype,"slotElement",void 0),it([ht("select")],Fd.prototype,"nativeSelectElement",void 0),it([ht("input")],Fd.prototype,"nativeInputElement",void 0),it([ht(".mdc-line-ripple")],Fd.prototype,"lineRippleElement",void 0),it([ht(".mdc-floating-label")],Fd.prototype,"labelElement",void 0),it([ht("mwc-notched-outline")],Fd.prototype,"outlineElement",void 0),it([ht(".mdc-menu")],Fd.prototype,"menuElement",void 0),it([ht(".mdc-select__anchor")],Fd.prototype,"anchorElement",void 0),it([ot({type:Boolean,attribute:"disabled",reflect:!0}),Mt((function(t){this.mdcFoundation&&this.mdcFoundation.setDisabled(t)}))],Fd.prototype,"disabled",void 0),it([ot({type:Boolean}),Mt((function(t,e){void 0!==e&&this.outlined!==e&&this.layout(!1)}))],Fd.prototype,"outlined",void 0),it([ot({type:String}),Mt((function(t,e){void 0!==e&&this.label!==e&&this.layout(!1)}))],Fd.prototype,"label",void 0),it([lt()],Fd.prototype,"outlineOpen",void 0),it([lt()],Fd.prototype,"outlineWidth",void 0),it([ot({type:String}),Mt((function(t){if(this.mdcFoundation){const e=null===this.selected&&!!t,i=this.selected&&this.selected.value!==t;(e||i)&&this.selectByValue(t),this.reportValidity()}}))],Fd.prototype,"value",void 0),it([ot()],Fd.prototype,"name",void 0),it([lt()],Fd.prototype,"selectedText",void 0),it([ot({type:String})],Fd.prototype,"icon",void 0),it([lt()],Fd.prototype,"menuOpen",void 0),it([ot({type:String})],Fd.prototype,"helper",void 0),it([ot({type:Boolean})],Fd.prototype,"validateOnInitialRender",void 0),it([ot({type:String})],Fd.prototype,"validationMessage",void 0),it([ot({type:Boolean})],Fd.prototype,"required",void 0),it([ot({type:Boolean})],Fd.prototype,"naturalMenuWidth",void 0),it([lt()],Fd.prototype,"isUiValid",void 0),it([ot({type:Boolean})],Fd.prototype,"fixedMenuPosition",void 0),it([dt({capture:!0})],Fd.prototype,"handleTypeahead",null);const Nd=n`.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:0.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform;transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required::after,.mdc-floating-label--required[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-106%) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-106%) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transform:translate(var(--mdc-ripple-fg-translate-start, 0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity, 0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity, 0)}to{opacity:0}}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);border-bottom-width:2px;opacity:0;z-index:2}.mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(100% / 0.75)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-select{display:inline-flex;position:relative}.mdc-select:not(.mdc-select--disabled) .mdc-select__selected-text{color:rgba(0, 0, 0, 0.87)}.mdc-select.mdc-select--disabled .mdc-select__selected-text{color:rgba(0, 0, 0, 0.38)}.mdc-select:not(.mdc-select--disabled) .mdc-floating-label{color:rgba(0, 0, 0, 0.6)}.mdc-select:not(.mdc-select--disabled).mdc-select--focused .mdc-floating-label{color:rgba(98, 0, 238, 0.87)}.mdc-select.mdc-select--disabled .mdc-floating-label{color:rgba(0, 0, 0, 0.38)}.mdc-select:not(.mdc-select--disabled) .mdc-select__dropdown-icon{fill:rgba(0, 0, 0, 0.54)}.mdc-select:not(.mdc-select--disabled).mdc-select--focused .mdc-select__dropdown-icon{fill:#6200ee;fill:var(--mdc-theme-primary, #6200ee)}.mdc-select.mdc-select--disabled .mdc-select__dropdown-icon{fill:rgba(0, 0, 0, 0.38)}.mdc-select:not(.mdc-select--disabled)+.mdc-select-helper-text{color:rgba(0, 0, 0, 0.6)}.mdc-select.mdc-select--disabled+.mdc-select-helper-text{color:rgba(0, 0, 0, 0.38)}.mdc-select:not(.mdc-select--disabled) .mdc-select__icon{color:rgba(0, 0, 0, 0.54)}.mdc-select.mdc-select--disabled .mdc-select__icon{color:rgba(0, 0, 0, 0.38)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-select.mdc-select--disabled .mdc-select__selected-text{color:GrayText}.mdc-select.mdc-select--disabled .mdc-select__dropdown-icon{fill:red}.mdc-select.mdc-select--disabled .mdc-floating-label{color:GrayText}.mdc-select.mdc-select--disabled .mdc-line-ripple::before{border-bottom-color:GrayText}.mdc-select.mdc-select--disabled .mdc-notched-outline__leading,.mdc-select.mdc-select--disabled .mdc-notched-outline__notch,.mdc-select.mdc-select--disabled .mdc-notched-outline__trailing{border-color:GrayText}.mdc-select.mdc-select--disabled .mdc-select__icon{color:GrayText}.mdc-select.mdc-select--disabled+.mdc-select-helper-text{color:GrayText}}.mdc-select .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-select .mdc-select__anchor{padding-left:16px;padding-right:0}[dir=rtl] .mdc-select .mdc-select__anchor,.mdc-select .mdc-select__anchor[dir=rtl]{padding-left:0;padding-right:16px}.mdc-select.mdc-select--with-leading-icon .mdc-select__anchor{padding-left:0;padding-right:0}[dir=rtl] .mdc-select.mdc-select--with-leading-icon .mdc-select__anchor,.mdc-select.mdc-select--with-leading-icon .mdc-select__anchor[dir=rtl]{padding-left:0;padding-right:0}.mdc-select .mdc-select__icon{width:24px;height:24px;font-size:24px}.mdc-select .mdc-select__dropdown-icon{width:24px;height:24px}.mdc-select .mdc-select__menu .mdc-deprecated-list-item{padding-left:16px;padding-right:16px}[dir=rtl] .mdc-select .mdc-select__menu .mdc-deprecated-list-item,.mdc-select .mdc-select__menu .mdc-deprecated-list-item[dir=rtl]{padding-left:16px;padding-right:16px}.mdc-select .mdc-select__menu .mdc-deprecated-list-item__graphic{margin-left:0;margin-right:12px}[dir=rtl] .mdc-select .mdc-select__menu .mdc-deprecated-list-item__graphic,.mdc-select .mdc-select__menu .mdc-deprecated-list-item__graphic[dir=rtl]{margin-left:12px;margin-right:0}.mdc-select__dropdown-icon{margin-left:12px;margin-right:12px;display:inline-flex;position:relative;align-self:center;align-items:center;justify-content:center;flex-shrink:0;pointer-events:none}.mdc-select__dropdown-icon .mdc-select__dropdown-icon-active,.mdc-select__dropdown-icon .mdc-select__dropdown-icon-inactive{position:absolute;top:0;left:0}.mdc-select__dropdown-icon .mdc-select__dropdown-icon-graphic{width:41.6666666667%;height:20.8333333333%}.mdc-select__dropdown-icon .mdc-select__dropdown-icon-inactive{opacity:1;transition:opacity 75ms linear 75ms}.mdc-select__dropdown-icon .mdc-select__dropdown-icon-active{opacity:0;transition:opacity 75ms linear}[dir=rtl] .mdc-select__dropdown-icon,.mdc-select__dropdown-icon[dir=rtl]{margin-left:12px;margin-right:12px}.mdc-select--activated .mdc-select__dropdown-icon .mdc-select__dropdown-icon-inactive{opacity:0;transition:opacity 49.5ms linear}.mdc-select--activated .mdc-select__dropdown-icon .mdc-select__dropdown-icon-active{opacity:1;transition:opacity 100.5ms linear 49.5ms}.mdc-select__anchor{width:200px;min-width:0;flex:1 1 auto;position:relative;box-sizing:border-box;overflow:hidden;outline:none;cursor:pointer}.mdc-select__anchor .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-select__selected-text-container{display:flex;appearance:none;pointer-events:none;box-sizing:border-box;width:auto;min-width:0;flex-grow:1;height:28px;border:none;outline:none;padding:0;background-color:transparent;color:inherit}.mdc-select__selected-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size, 1rem);line-height:1.75rem;line-height:var(--mdc-typography-subtitle1-line-height, 1.75rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight, 400);letter-spacing:0.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing, 0.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform, inherit);text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;width:100%;text-align:left}[dir=rtl] .mdc-select__selected-text,.mdc-select__selected-text[dir=rtl]{text-align:right}.mdc-select--invalid:not(.mdc-select--disabled) .mdc-floating-label{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-floating-label{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--invalid+.mdc-select-helper-text--validation-msg{color:#b00020;color:var(--mdc-theme-error, #b00020)}.mdc-select--invalid:not(.mdc-select--disabled) .mdc-select__dropdown-icon{fill:#b00020;fill:var(--mdc-theme-error, #b00020)}.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-select__dropdown-icon{fill:#b00020;fill:var(--mdc-theme-error, #b00020)}.mdc-select--disabled{cursor:default;pointer-events:none}.mdc-select--with-leading-icon .mdc-select__menu .mdc-deprecated-list-item{padding-left:12px;padding-right:12px}[dir=rtl] .mdc-select--with-leading-icon .mdc-select__menu .mdc-deprecated-list-item,.mdc-select--with-leading-icon .mdc-select__menu .mdc-deprecated-list-item[dir=rtl]{padding-left:12px;padding-right:12px}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-select__menu::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid transparent;border-radius:inherit;content:"";pointer-events:none}}@media screen and (forced-colors: active)and (forced-colors: active),screen and (-ms-high-contrast: active)and (forced-colors: active){.mdc-select__menu::before{border-color:CanvasText}}.mdc-select__menu .mdc-deprecated-list .mdc-select__icon,.mdc-select__menu .mdc-list .mdc-select__icon{margin-left:0;margin-right:0}[dir=rtl] .mdc-select__menu .mdc-deprecated-list .mdc-select__icon,[dir=rtl] .mdc-select__menu .mdc-list .mdc-select__icon,.mdc-select__menu .mdc-deprecated-list .mdc-select__icon[dir=rtl],.mdc-select__menu .mdc-list .mdc-select__icon[dir=rtl]{margin-left:0;margin-right:0}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected,.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--activated,.mdc-select__menu .mdc-list .mdc-deprecated-list-item--selected,.mdc-select__menu .mdc-list .mdc-deprecated-list-item--activated{color:#000;color:var(--mdc-theme-on-surface, #000)}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected .mdc-deprecated-list-item__graphic,.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--activated .mdc-deprecated-list-item__graphic,.mdc-select__menu .mdc-list .mdc-deprecated-list-item--selected .mdc-deprecated-list-item__graphic,.mdc-select__menu .mdc-list .mdc-deprecated-list-item--activated .mdc-deprecated-list-item__graphic{color:#000;color:var(--mdc-theme-on-surface, #000)}.mdc-select__menu .mdc-list-item__start{display:inline-flex;align-items:center}.mdc-select__option{padding-left:16px;padding-right:16px}[dir=rtl] .mdc-select__option,.mdc-select__option[dir=rtl]{padding-left:16px;padding-right:16px}.mdc-select__one-line-option.mdc-list-item--with-one-line{height:48px}.mdc-select__two-line-option.mdc-list-item--with-two-lines{height:64px}.mdc-select__two-line-option.mdc-list-item--with-two-lines .mdc-list-item__start{margin-top:20px}.mdc-select__two-line-option.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-select__two-line-option.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-select__two-line-option.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-select__two-line-option.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-select__two-line-option.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:36px;content:"";vertical-align:0}.mdc-select__option-with-leading-content{padding-left:0;padding-right:12px}.mdc-select__option-with-leading-content.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-select__option-with-leading-content.mdc-list-item,.mdc-select__option-with-leading-content.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-select__option-with-leading-content .mdc-list-item__start{margin-left:12px;margin-right:0}[dir=rtl] .mdc-select__option-with-leading-content .mdc-list-item__start,.mdc-select__option-with-leading-content .mdc-list-item__start[dir=rtl]{margin-left:0;margin-right:12px}.mdc-select__option-with-leading-content .mdc-list-item__start{width:36px;height:24px}[dir=rtl] .mdc-select__option-with-leading-content,.mdc-select__option-with-leading-content[dir=rtl]{padding-left:12px;padding-right:0}.mdc-select__option-with-meta.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-select__option-with-meta.mdc-list-item,.mdc-select__option-with-meta.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-select__option-with-meta .mdc-list-item__end{margin-left:12px;margin-right:12px}[dir=rtl] .mdc-select__option-with-meta .mdc-list-item__end,.mdc-select__option-with-meta .mdc-list-item__end[dir=rtl]{margin-left:12px;margin-right:12px}.mdc-select--filled .mdc-select__anchor{height:56px;display:flex;align-items:baseline}.mdc-select--filled .mdc-select__anchor::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-select--filled.mdc-select--no-label .mdc-select__anchor .mdc-select__selected-text::before{content:""}.mdc-select--filled.mdc-select--no-label .mdc-select__anchor .mdc-select__selected-text-container{height:100%;display:inline-flex;align-items:center}.mdc-select--filled.mdc-select--no-label .mdc-select__anchor::before{display:none}.mdc-select--filled .mdc-select__anchor{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-select--filled:not(.mdc-select--disabled) .mdc-select__anchor{background-color:whitesmoke}.mdc-select--filled.mdc-select--disabled .mdc-select__anchor{background-color:#fafafa}.mdc-select--filled:not(.mdc-select--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0, 0, 0, 0.42)}.mdc-select--filled:not(.mdc-select--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0, 0, 0, 0.87)}.mdc-select--filled:not(.mdc-select--disabled) .mdc-line-ripple::after{border-bottom-color:#6200ee;border-bottom-color:var(--mdc-theme-primary, #6200ee)}.mdc-select--filled.mdc-select--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0, 0, 0, 0.06)}.mdc-select--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-select--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-select--filled .mdc-menu-surface--is-open-below{border-top-left-radius:0px;border-top-right-radius:0px}.mdc-select--filled.mdc-select--focused.mdc-line-ripple::after{transform:scale(1, 2);opacity:1}.mdc-select--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-select--filled .mdc-floating-label,.mdc-select--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-select--filled.mdc-select--with-leading-icon .mdc-floating-label{left:48px;right:initial}[dir=rtl] .mdc-select--filled.mdc-select--with-leading-icon .mdc-floating-label,.mdc-select--filled.mdc-select--with-leading-icon .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-select--filled.mdc-select--with-leading-icon .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-select--filled.mdc-select--with-leading-icon .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-select--invalid:not(.mdc-select--disabled) .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-select--invalid:not(.mdc-select--disabled):hover .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-select--invalid:not(.mdc-select--disabled) .mdc-line-ripple::after{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error, #b00020)}.mdc-select--outlined{border:none}.mdc-select--outlined .mdc-select__anchor{height:56px}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--float-above{font-size:.75rem}.mdc-select--outlined .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-select--outlined .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-select-outlined-56px 250ms 1}@keyframes mdc-floating-label-shake-float-above-select-outlined-56px{0%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}}.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-shape-small, 4px)) * 2)}}.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-select--outlined .mdc-select__anchor{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-select--outlined .mdc-select__anchor,.mdc-select--outlined .mdc-select__anchor[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-select--outlined .mdc-select__anchor,.mdc-select--outlined .mdc-select__anchor[dir=rtl]{padding-right:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-select--outlined+.mdc-select-helper-text{margin-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-select--outlined+.mdc-select-helper-text,.mdc-select--outlined+.mdc-select-helper-text[dir=rtl]{margin-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-select--outlined+.mdc-select-helper-text,.mdc-select--outlined+.mdc-select-helper-text[dir=rtl]{margin-right:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-select--outlined:not(.mdc-select--disabled) .mdc-select__anchor{background-color:transparent}.mdc-select--outlined.mdc-select--disabled .mdc-select__anchor{background-color:transparent}.mdc-select--outlined:not(.mdc-select--disabled) .mdc-notched-outline__leading,.mdc-select--outlined:not(.mdc-select--disabled) .mdc-notched-outline__notch,.mdc-select--outlined:not(.mdc-select--disabled) .mdc-notched-outline__trailing{border-color:rgba(0, 0, 0, 0.38)}.mdc-select--outlined:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:rgba(0, 0, 0, 0.87)}.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:2px}.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#6200ee;border-color:var(--mdc-theme-primary, #6200ee)}.mdc-select--outlined.mdc-select--disabled .mdc-notched-outline__leading,.mdc-select--outlined.mdc-select--disabled .mdc-notched-outline__notch,.mdc-select--outlined.mdc-select--disabled .mdc-notched-outline__trailing{border-color:rgba(0, 0, 0, 0.06)}.mdc-select--outlined .mdc-select__anchor :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-select--outlined .mdc-select__anchor{display:flex;align-items:baseline;overflow:visible}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-select-outlined 250ms 1}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--float-above{font-size:.75rem}.mdc-select--outlined .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-select--outlined .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-select--outlined .mdc-select__anchor .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-select--outlined .mdc-select__anchor .mdc-select__selected-text::before{content:""}.mdc-select--outlined .mdc-select__anchor .mdc-select__selected-text-container{height:100%;display:inline-flex;align-items:center}.mdc-select--outlined .mdc-select__anchor::before{display:none}.mdc-select--outlined .mdc-select__selected-text-container{display:flex;border:none;z-index:1;background-color:transparent}.mdc-select--outlined .mdc-select__icon{z-index:2}.mdc-select--outlined .mdc-floating-label{line-height:1.15rem;left:4px;right:initial}[dir=rtl] .mdc-select--outlined .mdc-floating-label,.mdc-select--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-select--outlined.mdc-select--focused .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled) .mdc-notched-outline__leading,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled) .mdc-notched-outline__notch,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled) .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:2px}.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error, #b00020)}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label,.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--float-above,.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--float-above{font-size:.75rem}.mdc-select--outlined.mdc-select--with-leading-icon.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined.mdc-select--with-leading-icon .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-select--outlined.mdc-select--with-leading-icon.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-select--outlined.mdc-select--with-leading-icon .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined.mdc-select--with-leading-icon.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-select--outlined.mdc-select--with-leading-icon .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-select--outlined.mdc-select--with-leading-icon.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined.mdc-select--with-leading-icon .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-select-outlined-leading-icon-56px 250ms 1}@keyframes mdc-floating-label-shake-float-above-select-outlined-leading-icon-56px{0%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}}[dir=rtl] .mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--shake,.mdc-select--outlined.mdc-select--with-leading-icon[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-select-outlined-leading-icon-56px 250ms 1}@keyframes mdc-floating-label-shake-float-above-select-outlined-leading-icon-56px-rtl{0%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-select__anchor :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 96px)}.mdc-select--outlined .mdc-menu-surface{margin-bottom:8px}.mdc-select--outlined.mdc-select--no-label .mdc-menu-surface,.mdc-select--outlined .mdc-menu-surface--is-open-below{margin-bottom:0}.mdc-select__anchor{--mdc-ripple-fg-size: 0;--mdc-ripple-left: 0;--mdc-ripple-top: 0;--mdc-ripple-fg-scale: 1;--mdc-ripple-fg-translate-end: 0;--mdc-ripple-fg-translate-start: 0;-webkit-tap-highlight-color:rgba(0,0,0,0);will-change:transform,opacity}.mdc-select__anchor .mdc-select__ripple::before,.mdc-select__anchor .mdc-select__ripple::after{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-select__anchor .mdc-select__ripple::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1;z-index:var(--mdc-ripple-z-index, 1)}.mdc-select__anchor .mdc-select__ripple::after{z-index:0;z-index:var(--mdc-ripple-z-index, 0)}.mdc-select__anchor.mdc-ripple-upgraded .mdc-select__ripple::before{transform:scale(var(--mdc-ripple-fg-scale, 1))}.mdc-select__anchor.mdc-ripple-upgraded .mdc-select__ripple::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-select__anchor.mdc-ripple-upgraded--unbounded .mdc-select__ripple::after{top:var(--mdc-ripple-top, 0);left:var(--mdc-ripple-left, 0)}.mdc-select__anchor.mdc-ripple-upgraded--foreground-activation .mdc-select__ripple::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-select__anchor.mdc-ripple-upgraded--foreground-deactivation .mdc-select__ripple::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end, 0)) scale(var(--mdc-ripple-fg-scale, 1))}.mdc-select__anchor .mdc-select__ripple::before,.mdc-select__anchor .mdc-select__ripple::after{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-select__anchor.mdc-ripple-upgraded .mdc-select__ripple::after{width:var(--mdc-ripple-fg-size, 100%);height:var(--mdc-ripple-fg-size, 100%)}.mdc-select__anchor .mdc-select__ripple::before,.mdc-select__anchor .mdc-select__ripple::after{background-color:rgba(0, 0, 0, 0.87);background-color:var(--mdc-ripple-color, rgba(0, 0, 0, 0.87))}.mdc-select__anchor:hover .mdc-select__ripple::before,.mdc-select__anchor.mdc-ripple-surface--hover .mdc-select__ripple::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-select__anchor.mdc-ripple-upgraded--background-focused .mdc-select__ripple::before,.mdc-select__anchor:not(.mdc-ripple-upgraded):focus .mdc-select__ripple::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-select__anchor .mdc-select__ripple{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected .mdc-deprecated-list-item__ripple::before,.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected .mdc-deprecated-list-item__ripple::after{background-color:#000;background-color:var(--mdc-ripple-color, var(--mdc-theme-on-surface, #000))}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected:hover .mdc-deprecated-list-item__ripple::before,.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected.mdc-ripple-surface--hover .mdc-deprecated-list-item__ripple::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected.mdc-ripple-upgraded--background-focused .mdc-deprecated-list-item__ripple::before,.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected:not(.mdc-ripple-upgraded):focus .mdc-deprecated-list-item__ripple::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected:not(.mdc-ripple-upgraded) .mdc-deprecated-list-item__ripple::after{transition:opacity 150ms linear}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected:not(.mdc-ripple-upgraded):active .mdc-deprecated-list-item__ripple::after{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected .mdc-list-item__ripple::before,.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected .mdc-list-item__ripple::after{background-color:#000;background-color:var(--mdc-ripple-color, var(--mdc-theme-on-surface, #000))}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected:hover .mdc-list-item__ripple::before,.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected.mdc-ripple-surface--hover .mdc-list-item__ripple::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected.mdc-ripple-upgraded--background-focused .mdc-list-item__ripple::before,.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected:not(.mdc-ripple-upgraded):focus .mdc-list-item__ripple::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected:not(.mdc-ripple-upgraded) .mdc-list-item__ripple::after{transition:opacity 150ms linear}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected:not(.mdc-ripple-upgraded):active .mdc-list-item__ripple::after{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-select__menu .mdc-deprecated-list .mdc-deprecated-list-item--selected.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-select-helper-text{margin:0;margin-left:16px;margin-right:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-caption-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.75rem;font-size:var(--mdc-typography-caption-font-size, 0.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight, 400);letter-spacing:0.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing, 0.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform, inherit);display:block;margin-top:0;line-height:normal}[dir=rtl] .mdc-select-helper-text,.mdc-select-helper-text[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-select-helper-text::before{display:inline-block;width:0;height:16px;content:"";vertical-align:0}.mdc-select-helper-text--validation-msg{opacity:0;transition:opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-select--invalid+.mdc-select-helper-text--validation-msg,.mdc-select-helper-text--validation-msg-persistent{opacity:1}.mdc-select--with-leading-icon .mdc-select__icon{display:inline-block;box-sizing:border-box;border:none;text-decoration:none;cursor:pointer;user-select:none;flex-shrink:0;align-self:center;background-color:transparent;fill:currentColor}.mdc-select--with-leading-icon .mdc-select__icon{margin-left:12px;margin-right:12px}[dir=rtl] .mdc-select--with-leading-icon .mdc-select__icon,.mdc-select--with-leading-icon .mdc-select__icon[dir=rtl]{margin-left:12px;margin-right:12px}.mdc-select__icon:not([tabindex]),.mdc-select__icon[tabindex="-1"]{cursor:default;pointer-events:none}.material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:normal;font-style:normal;font-size:var(--mdc-icon-size, 24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}:host{display:inline-block;vertical-align:top;outline:none}.mdc-select{width:100%}[hidden]{display:none}.mdc-select__icon{z-index:2}.mdc-select--with-leading-icon{--mdc-list-item-graphic-margin: calc( 48px - var(--mdc-list-item-graphic-size, 24px) - var(--mdc-list-side-padding, 16px) )}.mdc-select .mdc-select__anchor .mdc-select__selected-text{overflow:hidden}.mdc-select .mdc-select__anchor *{display:inline-flex}.mdc-select .mdc-select__anchor .mdc-floating-label{display:inline-block}mwc-notched-outline{--mdc-notched-outline-border-color: var( --mdc-select-outlined-idle-border-color, rgba(0, 0, 0, 0.38) );--mdc-notched-outline-notch-offset: 1px}:host(:not([disabled]):hover) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) mwc-notched-outline{--mdc-notched-outline-border-color: var( --mdc-select-outlined-hover-border-color, rgba(0, 0, 0, 0.87) )}:host(:not([disabled])) .mdc-select:not(.mdc-select--disabled) .mdc-select__selected-text{color:rgba(0, 0, 0, 0.87);color:var(--mdc-select-ink-color, rgba(0, 0, 0, 0.87))}:host(:not([disabled])) .mdc-select:not(.mdc-select--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0, 0, 0, 0.42);border-bottom-color:var(--mdc-select-idle-line-color, rgba(0, 0, 0, 0.42))}:host(:not([disabled])) .mdc-select:not(.mdc-select--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0, 0, 0, 0.87);border-bottom-color:var(--mdc-select-hover-line-color, rgba(0, 0, 0, 0.87))}:host(:not([disabled])) .mdc-select:not(.mdc-select--outlined):not(.mdc-select--disabled) .mdc-select__anchor{background-color:whitesmoke;background-color:var(--mdc-select-fill-color, whitesmoke)}:host(:not([disabled])) .mdc-select.mdc-select--invalid .mdc-select__dropdown-icon{fill:var(--mdc-select-error-dropdown-icon-color, var(--mdc-select-error-color, var(--mdc-theme-error, #b00020)))}:host(:not([disabled])) .mdc-select.mdc-select--invalid .mdc-floating-label,:host(:not([disabled])) .mdc-select.mdc-select--invalid .mdc-floating-label::after{color:var(--mdc-select-error-color, var(--mdc-theme-error, #b00020))}:host(:not([disabled])) .mdc-select.mdc-select--invalid mwc-notched-outline{--mdc-notched-outline-border-color: var(--mdc-select-error-color, var(--mdc-theme-error, #b00020))}.mdc-select__menu--invalid{--mdc-theme-primary: var(--mdc-select-error-color, var(--mdc-theme-error, #b00020))}:host(:not([disabled])) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) .mdc-floating-label,:host(:not([disabled])) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) .mdc-floating-label::after{color:rgba(0, 0, 0, 0.6);color:var(--mdc-select-label-ink-color, rgba(0, 0, 0, 0.6))}:host(:not([disabled])) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) .mdc-select__dropdown-icon{fill:rgba(0, 0, 0, 0.54);fill:var(--mdc-select-dropdown-icon-color, rgba(0, 0, 0, 0.54))}:host(:not([disabled])) .mdc-select.mdc-select--focused mwc-notched-outline{--mdc-notched-outline-stroke-width: 2px;--mdc-notched-outline-notch-offset: 2px}:host(:not([disabled])) .mdc-select.mdc-select--focused:not(.mdc-select--invalid) mwc-notched-outline{--mdc-notched-outline-border-color: var( --mdc-select-focused-label-color, var(--mdc-theme-primary, rgba(98, 0, 238, 0.87)) )}:host(:not([disabled])) .mdc-select.mdc-select--focused:not(.mdc-select--invalid) .mdc-select__dropdown-icon{fill:rgba(98,0,238,.87);fill:var(--mdc-select-focused-dropdown-icon-color, var(--mdc-theme-primary, rgba(98, 0, 238, 0.87)))}:host(:not([disabled])) .mdc-select.mdc-select--focused:not(.mdc-select--invalid) .mdc-floating-label{color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}:host(:not([disabled])) .mdc-select.mdc-select--focused:not(.mdc-select--invalid) .mdc-floating-label::after{color:#6200ee;color:var(--mdc-theme-primary, #6200ee)}:host(:not([disabled])) .mdc-select-helper-text:not(.mdc-select-helper-text--validation-msg){color:var(--mdc-select-label-ink-color, rgba(0, 0, 0, 0.6))}:host([disabled]){pointer-events:none}:host([disabled]) .mdc-select:not(.mdc-select--outlined).mdc-select--disabled .mdc-select__anchor{background-color:#fafafa;background-color:var(--mdc-select-disabled-fill-color, #fafafa)}:host([disabled]) .mdc-select.mdc-select--outlined mwc-notched-outline{--mdc-notched-outline-border-color: var( --mdc-select-outlined-disabled-border-color, rgba(0, 0, 0, 0.06) )}:host([disabled]) .mdc-select .mdc-select__dropdown-icon{fill:rgba(0, 0, 0, 0.38);fill:var(--mdc-select-disabled-dropdown-icon-color, rgba(0, 0, 0, 0.38))}:host([disabled]) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) .mdc-floating-label,:host([disabled]) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) .mdc-floating-label::after{color:rgba(0, 0, 0, 0.38);color:var(--mdc-select-disabled-ink-color, rgba(0, 0, 0, 0.38))}:host([disabled]) .mdc-select-helper-text{color:rgba(0, 0, 0, 0.38);color:var(--mdc-select-disabled-ink-color, rgba(0, 0, 0, 0.38))}:host([disabled]) .mdc-select__selected-text{color:rgba(0, 0, 0, 0.38);color:var(--mdc-select-disabled-ink-color, rgba(0, 0, 0, 0.38))}`;let Hd=class extends Fd{};Hd.styles=[Nd],Hd=it([at("mwc-select")],Hd);const Vd={fromAttribute:t=>null!==t&&(""===t||t),toAttribute:t=>"boolean"==typeof t?t?"":null:t};class Ud extends Li{constructor(){super(...arguments),this.rows=2,this.cols=20,this.charCounter=!1}render(){const t=this.charCounter&&-1!==this.maxLength,e=t&&"internal"===this.charCounter,i=t&&!e,r=!!this.helper||!!this.validationMessage||i,n={"mdc-text-field--disabled":this.disabled,"mdc-text-field--no-label":!this.label,"mdc-text-field--filled":!this.outlined,"mdc-text-field--outlined":this.outlined,"mdc-text-field--end-aligned":this.endAligned,"mdc-text-field--with-internal-counter":e};return M`
      <label class="mdc-text-field mdc-text-field--textarea ${Ot(n)}">
        ${this.renderRipple()}
        ${this.outlined?this.renderOutline():this.renderLabel()}
        ${this.renderInput()}
        ${this.renderCharCounter(e)}
        ${this.renderLineRipple()}
      </label>
      ${this.renderHelperText(r,i)}
    `}renderInput(){const t=this.label?"label":void 0,e=-1===this.minLength?void 0:this.minLength,i=-1===this.maxLength?void 0:this.maxLength,r=this.autocapitalize?this.autocapitalize:void 0;return M`
      <textarea
          aria-labelledby=${Ke(t)}
          class="mdc-text-field__input"
          .value="${Ai(this.value)}"
          rows="${this.rows}"
          cols="${this.cols}"
          ?disabled="${this.disabled}"
          placeholder="${this.placeholder}"
          ?required="${this.required}"
          ?readonly="${this.readOnly}"
          minlength="${Ke(e)}"
          maxlength="${Ke(i)}"
          name="${Ke(""===this.name?void 0:this.name)}"
          inputmode="${Ke(this.inputMode)}"
          autocapitalize="${Ke(r)}"
          @input="${this.handleInputChange}"
          @blur="${this.onInputBlur}">
      </textarea>`}}it([ht("textarea")],Ud.prototype,"formElement",void 0),it([ot({type:Number})],Ud.prototype,"rows",void 0),it([ot({type:Number})],Ud.prototype,"cols",void 0),it([ot({converter:Vd})],Ud.prototype,"charCounter",void 0);const Yd=n`.mdc-text-field{height:100%}.mdc-text-field__input{resize:none}`;let Zd=class extends Ud{};function qd(t,e,i){var r=function(t,e){var i=new Map;Wd.has(t)||Wd.set(t,{isEnabled:!0,getObservers:function(t){var e=i.get(t)||[];return i.has(t)||i.set(t,e),e},installedProperties:new Set});var r=Wd.get(t);if(r.installedProperties.has(e))return r;var n=function(t,e){var i,r=t;for(;r&&!(i=Object.getOwnPropertyDescriptor(r,e));)r=Object.getPrototypeOf(r);return i}(t,e)||{configurable:!0,enumerable:!0,value:t[e],writable:!0},a=et({},n),s=n.get,o=n.set;if("value"in n){delete a.value,delete a.writable;var l=n.value;s=function(){return l},n.writable&&(o=function(t){l=t})}s&&(a.get=function(){return s.call(this)});o&&(a.set=function(t){var i,n,a=s?s.call(this):t;if(o.call(this,t),r.isEnabled&&(!s||t!==a))try{for(var l=rt(r.getObservers(e)),c=l.next();!c.done;c=l.next()){(0,c.value)(t,a)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}});return r.installedProperties.add(e),Object.defineProperty(t,e,a),r}(t,e),n=r.getObservers(e);return n.push(i),function(){n.splice(n.indexOf(i),1)}}Zd.styles=[Pi,Yd],Zd=it([at("mwc-textarea")],Zd);var Wd=new WeakMap;var Gd,Xd,Kd=function(t){function e(e){var i=t.call(this,e)||this;return i.unobserves=new Set,i}return tt(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.unobserve()},e.prototype.observe=function(t,e){var i,r,n=this,a=[];try{for(var s=rt(Object.keys(e)),o=s.next();!o.done;o=s.next()){var l=o.value,c=e[l].bind(this);a.push(this.observeProperty(t,l,c))}}catch(t){i={error:t}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}var d=function(){var t,e;try{for(var i=rt(a),r=i.next();!r.done;r=i.next()){(0,r.value)()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}n.unobserves.delete(d)};return this.unobserves.add(d),d},e.prototype.observeProperty=function(t,e,i){return qd(t,e,i)},e.prototype.setObserversEnabled=function(t,e){!function(t,e){var i=Wd.get(t);i&&(i.isEnabled=e)}(t,e)},e.prototype.unobserve=function(){var t,e;try{for(var i=rt(function(t,e,i){if(i||2===arguments.length)for(var r,n=0,a=e.length;n<a;n++)!r&&n in e||(r||(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))}([],nt(this.unobserves))),r=i.next();!r.done;r=i.next()){(0,r.value)()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e}(vt);!function(t){t.PROCESSING="mdc-switch--processing",t.SELECTED="mdc-switch--selected",t.UNSELECTED="mdc-switch--unselected"}(Gd||(Gd={})),function(t){t.RIPPLE=".mdc-switch__ripple"}(Xd||(Xd={}));var Jd=function(t){function e(e){var i=t.call(this,e)||this;return i.handleClick=i.handleClick.bind(i),i}return tt(e,t),e.prototype.init=function(){this.observe(this.adapter.state,{disabled:this.stopProcessingIfDisabled,processing:this.stopProcessingIfDisabled})},e.prototype.handleClick=function(){this.adapter.state.disabled||(this.adapter.state.selected=!this.adapter.state.selected)},e.prototype.stopProcessingIfDisabled=function(){this.adapter.state.disabled&&(this.adapter.state.processing=!1)},e}(Kd);!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}tt(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.observe(this.adapter.state,{disabled:this.onDisabledChange,processing:this.onProcessingChange,selected:this.onSelectedChange})},e.prototype.initFromDOM=function(){this.setObserversEnabled(this.adapter.state,!1),this.adapter.state.selected=this.adapter.hasClass(Gd.SELECTED),this.onSelectedChange(),this.adapter.state.disabled=this.adapter.isDisabled(),this.adapter.state.processing=this.adapter.hasClass(Gd.PROCESSING),this.setObserversEnabled(this.adapter.state,!0),this.stopProcessingIfDisabled()},e.prototype.onDisabledChange=function(){this.adapter.setDisabled(this.adapter.state.disabled)},e.prototype.onProcessingChange=function(){this.toggleClass(this.adapter.state.processing,Gd.PROCESSING)},e.prototype.onSelectedChange=function(){this.adapter.setAriaChecked(String(this.adapter.state.selected)),this.toggleClass(this.adapter.state.selected,Gd.SELECTED),this.toggleClass(!this.adapter.state.selected,Gd.UNSELECTED)},e.prototype.toggleClass=function(t,e){t?this.adapter.addClass(e):this.adapter.removeClass(e)}}(Jd);class Qd extends hi{constructor(){super(...arguments),this.processing=!1,this.selected=!1,this.ariaLabel="",this.ariaLabelledBy="",this.shouldRenderRipple=!1,this.rippleHandlers=new de((()=>(this.shouldRenderRipple=!0,this.ripple))),this.name="",this.value="on",this.mdcFoundationClass=Jd}setFormData(t){this.name&&this.selected&&t.append(this.name,this.value)}click(){var t,e;this.disabled||(null===(t=this.mdcRoot)||void 0===t||t.focus(),null===(e=this.mdcRoot)||void 0===e||e.click())}render(){return M`
      <button
        type="button"
        class="mdc-switch ${Ot(this.getRenderClasses())}"
        role="switch"
        aria-checked="${this.selected}"
        aria-label="${Ke(this.ariaLabel||void 0)}"
        aria-labelledby="${Ke(this.ariaLabelledBy||void 0)}"
        .disabled=${this.disabled}
        @click=${this.handleClick}
        @focus="${this.handleFocus}"
        @blur="${this.handleBlur}"
        @pointerdown="${this.handlePointerDown}"
        @pointerup="${this.handlePointerUp}"
        @pointerenter="${this.handlePointerEnter}"
        @pointerleave="${this.handlePointerLeave}"
      >
        <div class="mdc-switch__track"></div>
        <div class="mdc-switch__handle-track">
          ${this.renderHandle()}
        </div>
      </button>

      <input
        type="checkbox"
        aria-hidden="true"
        name="${this.name}"
        .checked=${this.selected}
        .value=${this.value}
      >
    `}getRenderClasses(){return{"mdc-switch--processing":this.processing,"mdc-switch--selected":this.selected,"mdc-switch--unselected":!this.selected}}renderHandle(){return M`
      <div class="mdc-switch__handle">
        ${this.renderShadow()}
        ${this.renderRipple()}
        <div class="mdc-switch__icons">
          ${this.renderOnIcon()}
          ${this.renderOffIcon()}
        </div>
      </div>
    `}renderShadow(){return M`
      <div class="mdc-switch__shadow">
        <div class="mdc-elevation-overlay"></div>
      </div>
    `}renderRipple(){return this.shouldRenderRipple?M`
        <div class="mdc-switch__ripple">
          <mwc-ripple
            internalUseStateLayerCustomProperties
            .disabled="${this.disabled}"
            unbounded>
          </mwc-ripple>
        </div>
      `:M``}renderOnIcon(){return M`
      <svg class="mdc-switch__icon mdc-switch__icon--on" viewBox="0 0 24 24">
        <path d="M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z" />
      </svg>
    `}renderOffIcon(){return M`
      <svg class="mdc-switch__icon mdc-switch__icon--off" viewBox="0 0 24 24">
        <path d="M20 13H4v-2h16v2z" />
      </svg>
    `}handleClick(){var t;null===(t=this.mdcFoundation)||void 0===t||t.handleClick()}handleFocus(){this.rippleHandlers.startFocus()}handleBlur(){this.rippleHandlers.endFocus()}handlePointerDown(t){t.target.setPointerCapture(t.pointerId),this.rippleHandlers.startPress(t)}handlePointerUp(){this.rippleHandlers.endPress()}handlePointerEnter(){this.rippleHandlers.startHover()}handlePointerLeave(){this.rippleHandlers.endHover()}createAdapter(){return{state:this}}}it([ot({type:Boolean})],Qd.prototype,"processing",void 0),it([ot({type:Boolean})],Qd.prototype,"selected",void 0),it([Xe,ot({type:String,attribute:"aria-label"})],Qd.prototype,"ariaLabel",void 0),it([Xe,ot({type:String,attribute:"aria-labelledby"})],Qd.prototype,"ariaLabelledBy",void 0),it([pt("mwc-ripple")],Qd.prototype,"ripple",void 0),it([lt()],Qd.prototype,"shouldRenderRipple",void 0),it([ot({type:String,reflect:!0})],Qd.prototype,"name",void 0),it([ot({type:String})],Qd.prototype,"value",void 0),it([ht("input")],Qd.prototype,"formElement",void 0),it([ht(".mdc-switch")],Qd.prototype,"mdcRoot",void 0),it([dt({passive:!0})],Qd.prototype,"handlePointerDown",null);const th=n`.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:0;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:#fff;background-color:var(--mdc-elevation-overlay-color, #fff)}.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative}.mdc-switch:disabled{cursor:default;pointer-events:none}.mdc-switch__track{overflow:hidden;position:relative;width:100%}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid transparent;border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%}@media screen and (forced-colors: active){.mdc-switch__track::before,.mdc-switch__track::after{border-color:currentColor}}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(-100%)}[dir=rtl] .mdc-switch__track::after,.mdc-switch__track[dir=rtl]::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track[dir=rtl]::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0)}[dir=rtl] .mdc-switch__handle-track,.mdc-switch__handle-track[dir=rtl]{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track,.mdc-switch--selected .mdc-switch__handle-track[dir=rtl]{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto}[dir=rtl] .mdc-switch__handle,.mdc-switch__handle[dir=rtl]{left:auto;right:0}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid transparent;border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}@media screen and (forced-colors: active){.mdc-switch__handle::before,.mdc-switch__handle::after{border-color:currentColor}}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-elevation-overlay{bottom:0;left:0;right:0;top:0}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1}.mdc-switch:disabled .mdc-switch__ripple{display:none}.mdc-switch__icons{height:100%;position:relative;width:100%;z-index:1}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}:host{display:inline-flex;outline:none}input{display:none}.mdc-switch{width:36px;width:var(--mdc-switch-track-width, 36px)}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__handle::after{background:#6200ee;background:var(--mdc-switch-selected-handle-color, var(--mdc-theme-primary, #6200ee))}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:#310077;background:var(--mdc-switch-selected-hover-handle-color, #310077)}.mdc-switch.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:#310077;background:var(--mdc-switch-selected-focus-handle-color, #310077)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:#310077;background:var(--mdc-switch-selected-pressed-handle-color, #310077)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__handle::after{background:#424242;background:var(--mdc-switch-disabled-selected-handle-color, #424242)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:#616161;background:var(--mdc-switch-unselected-handle-color, #616161)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:#212121;background:var(--mdc-switch-unselected-hover-handle-color, #212121)}.mdc-switch.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:#212121;background:var(--mdc-switch-unselected-focus-handle-color, #212121)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:#212121;background:var(--mdc-switch-unselected-pressed-handle-color, #212121)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__handle::after{background:#424242;background:var(--mdc-switch-disabled-unselected-handle-color, #424242)}.mdc-switch .mdc-switch__handle::before{background:#fff;background:var(--mdc-switch-handle-surface-color, var(--mdc-theme-surface, #fff))}.mdc-switch:enabled .mdc-switch__shadow{--mdc-elevation-box-shadow-for-gss:0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12);box-shadow:0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12);box-shadow:var(--mdc-switch-handle-elevation, var(--mdc-elevation-box-shadow-for-gss))}.mdc-switch:disabled .mdc-switch__shadow{--mdc-elevation-box-shadow-for-gss:0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12);box-shadow:0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12);box-shadow:var(--mdc-switch-disabled-handle-elevation, var(--mdc-elevation-box-shadow-for-gss))}.mdc-switch .mdc-switch__focus-ring-wrapper,.mdc-switch .mdc-switch__handle{height:20px;height:var(--mdc-switch-handle-height, 20px)}.mdc-switch:disabled .mdc-switch__handle::after{opacity:0.38;opacity:var(--mdc-switch-disabled-handle-opacity, 0.38)}.mdc-switch .mdc-switch__handle{border-radius:10px;border-radius:var(--mdc-switch-handle-shape, 10px)}.mdc-switch .mdc-switch__handle{width:20px;width:var(--mdc-switch-handle-width, 20px)}.mdc-switch .mdc-switch__handle-track{width:calc(100% - 20px);width:calc(100% - var(--mdc-switch-handle-width, 20px))}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__icon{fill:#fff;fill:var(--mdc-switch-selected-icon-color, var(--mdc-theme-on-primary, #fff))}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icon{fill:#fff;fill:var(--mdc-switch-disabled-selected-icon-color, var(--mdc-theme-on-primary, #fff))}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__icon{fill:#fff;fill:var(--mdc-switch-unselected-icon-color, var(--mdc-theme-on-primary, #fff))}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icon{fill:#fff;fill:var(--mdc-switch-disabled-unselected-icon-color, var(--mdc-theme-on-primary, #fff))}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icons{opacity:0.38;opacity:var(--mdc-switch-disabled-selected-icon-opacity, 0.38)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icons{opacity:0.38;opacity:var(--mdc-switch-disabled-unselected-icon-opacity, 0.38)}.mdc-switch.mdc-switch--selected .mdc-switch__icon{width:18px;width:var(--mdc-switch-selected-icon-size, 18px);height:18px;height:var(--mdc-switch-selected-icon-size, 18px)}.mdc-switch.mdc-switch--unselected .mdc-switch__icon{width:18px;width:var(--mdc-switch-unselected-icon-size, 18px);height:18px;height:var(--mdc-switch-unselected-icon-size, 18px)}.mdc-switch .mdc-switch__ripple{height:48px;height:var(--mdc-switch-state-layer-size, 48px);width:48px;width:var(--mdc-switch-state-layer-size, 48px)}.mdc-switch .mdc-switch__track{height:14px;height:var(--mdc-switch-track-height, 14px)}.mdc-switch:disabled .mdc-switch__track{opacity:0.12;opacity:var(--mdc-switch-disabled-track-opacity, 0.12)}.mdc-switch:enabled .mdc-switch__track::after{background:#d7bbff;background:var(--mdc-switch-selected-track-color, #d7bbff)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:#d7bbff;background:var(--mdc-switch-selected-hover-track-color, #d7bbff)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:#d7bbff;background:var(--mdc-switch-selected-focus-track-color, #d7bbff)}.mdc-switch:enabled:active .mdc-switch__track::after{background:#d7bbff;background:var(--mdc-switch-selected-pressed-track-color, #d7bbff)}.mdc-switch:disabled .mdc-switch__track::after{background:#424242;background:var(--mdc-switch-disabled-selected-track-color, #424242)}.mdc-switch:enabled .mdc-switch__track::before{background:#e0e0e0;background:var(--mdc-switch-unselected-track-color, #e0e0e0)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:#e0e0e0;background:var(--mdc-switch-unselected-hover-track-color, #e0e0e0)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:#e0e0e0;background:var(--mdc-switch-unselected-focus-track-color, #e0e0e0)}.mdc-switch:enabled:active .mdc-switch__track::before{background:#e0e0e0;background:var(--mdc-switch-unselected-pressed-track-color, #e0e0e0)}.mdc-switch:disabled .mdc-switch__track::before{background:#424242;background:var(--mdc-switch-disabled-unselected-track-color, #424242)}.mdc-switch .mdc-switch__track{border-radius:7px;border-radius:var(--mdc-switch-track-shape, 7px)}.mdc-switch.mdc-switch--selected{--mdc-ripple-focus-state-layer-color:var(--mdc-switch-selected-focus-state-layer-color, var(--mdc-theme-primary, #6200ee));--mdc-ripple-focus-state-layer-opacity:var(--mdc-switch-selected-focus-state-layer-opacity, 0.12);--mdc-ripple-hover-state-layer-color:var(--mdc-switch-selected-hover-state-layer-color, var(--mdc-theme-primary, #6200ee));--mdc-ripple-hover-state-layer-opacity:var(--mdc-switch-selected-hover-state-layer-opacity, 0.04);--mdc-ripple-pressed-state-layer-color:var(--mdc-switch-selected-pressed-state-layer-color, var(--mdc-theme-primary, #6200ee));--mdc-ripple-pressed-state-layer-opacity:var(--mdc-switch-selected-pressed-state-layer-opacity, 0.1)}.mdc-switch.mdc-switch--selected:enabled:focus:not(:active){--mdc-ripple-hover-state-layer-color:var(--mdc-switch-selected-focus-state-layer-color, var(--mdc-theme-primary, #6200ee))}.mdc-switch.mdc-switch--selected:enabled:active{--mdc-ripple-hover-state-layer-color:var(--mdc-switch-selected-pressed-state-layer-color, var(--mdc-theme-primary, #6200ee))}.mdc-switch.mdc-switch--unselected{--mdc-ripple-focus-state-layer-color:var(--mdc-switch-unselected-focus-state-layer-color, #424242);--mdc-ripple-focus-state-layer-opacity:var(--mdc-switch-unselected-focus-state-layer-opacity, 0.12);--mdc-ripple-hover-state-layer-color:var(--mdc-switch-unselected-hover-state-layer-color, #424242);--mdc-ripple-hover-state-layer-opacity:var(--mdc-switch-unselected-hover-state-layer-opacity, 0.04);--mdc-ripple-pressed-state-layer-color:var(--mdc-switch-unselected-pressed-state-layer-color, #424242);--mdc-ripple-pressed-state-layer-opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity, 0.1)}.mdc-switch.mdc-switch--unselected:enabled:focus:not(:active){--mdc-ripple-hover-state-layer-color:var(--mdc-switch-unselected-focus-state-layer-color, #424242)}.mdc-switch.mdc-switch--unselected:enabled:active{--mdc-ripple-hover-state-layer-color:var(--mdc-switch-unselected-pressed-state-layer-color, #424242)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-switch:disabled .mdc-switch__handle::after{opacity:1;opacity:var(--mdc-switch-disabled-handle-opacity, 1)}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__icon{fill:ButtonText;fill:var(--mdc-switch-selected-icon-color, ButtonText)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icon{fill:GrayText;fill:var(--mdc-switch-disabled-selected-icon-color, GrayText)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__icon{fill:ButtonText;fill:var(--mdc-switch-unselected-icon-color, ButtonText)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icon{fill:GrayText;fill:var(--mdc-switch-disabled-unselected-icon-color, GrayText)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icons{opacity:1;opacity:var(--mdc-switch-disabled-selected-icon-opacity, 1)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icons{opacity:1;opacity:var(--mdc-switch-disabled-unselected-icon-opacity, 1)}.mdc-switch:disabled .mdc-switch__track{opacity:1;opacity:var(--mdc-switch-disabled-track-opacity, 1)}}`;let eh=class extends Qd{};eh.styles=[th],eh=it([at("mwc-switch")],eh);var ih={ROOT:"mdc-form-field"},rh={LABEL_SELECTOR:".mdc-form-field > label"},nh=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.click=function(){r.handleClick()},r}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return ih},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return rh},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{activateInputRipple:function(){},deactivateInputRipple:function(){},deregisterInteractionHandler:function(){},registerInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.adapter.registerInteractionHandler("click",this.click)},e.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("click",this.click)},e.prototype.handleClick=function(){var t=this;this.adapter.activateInputRipple(),requestAnimationFrame((function(){t.adapter.deactivateInputRipple()}))},e}(vt);class ah extends It{constructor(){super(...arguments),this.alignEnd=!1,this.spaceBetween=!1,this.nowrap=!1,this.label="",this.mdcFoundationClass=nh}createAdapter(){return{registerInteractionHandler:(t,e)=>{this.labelEl.addEventListener(t,e)},deregisterInteractionHandler:(t,e)=>{this.labelEl.removeEventListener(t,e)},activateInputRipple:async()=>{const t=this.input;if(t instanceof hi){const e=await t.ripple;e&&e.startPress()}},deactivateInputRipple:async()=>{const t=this.input;if(t instanceof hi){const e=await t.ripple;e&&e.endPress()}}}}get input(){var t,e;return null!==(e=null===(t=this.slottedInputs)||void 0===t?void 0:t[0])&&void 0!==e?e:null}render(){const t={"mdc-form-field--align-end":this.alignEnd,"mdc-form-field--space-between":this.spaceBetween,"mdc-form-field--nowrap":this.nowrap};return M`
      <div class="mdc-form-field ${Ot(t)}">
        <slot></slot>
        <label class="mdc-label"
               @click="${this._labelClick}">${this.label}</label>
      </div>`}click(){this._labelClick()}_labelClick(){const t=this.input;t&&(t.focus(),t.click())}}it([ot({type:Boolean})],ah.prototype,"alignEnd",void 0),it([ot({type:Boolean})],ah.prototype,"spaceBetween",void 0),it([ot({type:Boolean})],ah.prototype,"nowrap",void 0),it([ot({type:String}),Mt((async function(t){var e;null===(e=this.input)||void 0===e||e.setAttribute("aria-label",t)}))],ah.prototype,"label",void 0),it([ht(".mdc-form-field")],ah.prototype,"mdcRoot",void 0),it([ut("",!0,"*")],ah.prototype,"slottedInputs",void 0),it([ht("label")],ah.prototype,"labelEl",void 0);const sh=n`.mdc-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-body2-font-size, 0.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:0.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, 0.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit);color:rgba(0, 0, 0, 0.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87));display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}:host{display:inline-flex}.mdc-form-field{width:100%}::slotted(*){-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-body2-font-size, 0.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:0.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, 0.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit);color:rgba(0, 0, 0, 0.87);color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, 0.87))}::slotted(mwc-switch){margin-right:10px}[dir=rtl] ::slotted(mwc-switch),::slotted(mwc-switch[dir=rtl]){margin-left:10px}`;let oh=class extends ah{};oh.styles=[sh],oh=it([at("mwc-formfield")],oh);class lh extends(al(K)){static get styles(){return[nl,n`
        :host {
        }

        div.spacer {
          margin-top: 2em;
        }

        p.right {
          text-align: right;
        }

        mwc-textfield.fullwidth {
          width: 100%;
        }

        .hide {
          display: none;
        }

        mwc-icon-button {
          color: rgba(0, 0, 0, 0.5);
        }

        mwc-dialog {
          --mdc-dialog-max-width: 100vw;
          --mdc-dialog-min-width: 50vw;
        }
      `]}static get properties(){return{data:{type:Object},types:{type:Object},typesLocale:{type:Object},loadingTypes:{type:Boolean},isFormValid:{type:Boolean},new:{type:Boolean},dialogTitle:{type:String}}}constructor(){super(),this.data={},this.types={},this.typesLocale={},this.loadingTypes=!1,this.isFormValid=!1,this.new=!1,this.dialogTitle=""}_reset(){this.shadowRoot.querySelectorAll(["grampsjs-form-select-type","grampsjs-form-private","grampsjs-form-object-list","grampsjs-form-select-object","grampsjs-form-select-object-list","grampsjs-form-select-date","grampsjs-form-string","grampsjs-form-upload","grampsjs-form-name"].join(", ")).forEach((t=>t.reset())),this.shadowRoot.querySelectorAll("mwc-textfield").forEach((t=>{t.value=""}))}get isValid(){return!0}_areDateSelectValid(){let t=!0;return this.shadowRoot.querySelectorAll("grampsjs-form-select-date").forEach((e=>{e.isValid()||(t=!1)})),t}render(){return M`
      <mwc-dialog
        scrimClickAction=""
        escapeKeyAction=""
        heading="${this.dialogTitle}"
        open
      >
        <div @formdata:changed="${this._handleFormData}">
          ${this.renderForm()}
        </div>

        <mwc-button
          raised
          class="edit"
          style="margin:8px 16px 8px 8px"
          slot="primaryAction"
          dialogAction="ok"
          ?disabled="${!this.isValid}"
          @click="${this._handleDialogSave}"
        >
          ${this._("_Save")}
        </mwc-button>
        <mwc-button
          class="edit"
          style="margin:8px"
          slot="secondaryAction"
          dialogAction="cancel"
          @click="${this._handleDialogCancel}"
        >
          ${this._("Cancel")}
        </mwc-button>
      </mwc-dialog>
    `}_handleDialogSave(){os(this,"object:save",{data:this.data}),this._reset()}_handleDialogCancel(){os(this,"object:cancel"),this._reset()}_openDialog(){const t=this.shadowRoot.querySelector("mwc-dialog");null!==t&&(t.open=!0)}open(){this._openDialog()}updateTypeData(){this.loadingTypes=!0,On("/api/types/").then((t=>{"data"in t?this.types=t.data||{}:"error"in t&&os(this,"grampsjs:error",{message:t.error})})).then((()=>{On("/api/types/?locale=1").then((t=>{this.loadingTypes=!1,"data"in t?(this.typesLocale=t.data||{},this.error=!1):"error"in t&&os(this,"grampsjs:error",{message:t.error})}))}))}firstUpdated(){this.updateTypeData()}translateTypeName(t,e,i){const r=((this.types[t?"custom":"default"]||{})[e]||[]).indexOf(i);try{return this.typesLocale[t?"custom":"default"][e][r]}catch{return i}}_handleFormData(t){const e=t.composedPath()[0];if("private"===e.id&&(this.data={...this.data,private:t.detail.checked}),["author","pubinfo","abbrev","page","desc","title","description","path","value","lat","long","call_number","rel"].includes(e.id)&&(this.data={...this.data,[e.id]:t.detail.data}),["event-select-list","media-select-list","child-select-list","place-select-list","person-select-list","repository-select-list"].includes(e.id)){const[e]=t.detail.data;if(e)this.data={...this.data,ref:e};else{const{ref:t,...e}=this.data;this.data=e}}"source-list"===e.id&&(this.data={...this.data,source_handle:t.detail.data[0]}),"place-list"===e.id&&(this.data={...this.data,place:t.detail.data[0]}),"father-list"===e.id&&(this.data={...this.data,father_handle:t.detail.data[0]}),"mother-list"===e.id&&(this.data={...this.data,mother_handle:t.detail.data[0]}),"date"===e.id&&(this.data={...this.data,date:t.detail.data}),"event-role-type"===e.id&&(this.data={...this.data,role:{_class:"EventRoleType",string:t.detail.data}}),"source-media-type"===e.id&&(this.data={...this.data,media_type:{_class:"SourceMediaType",string:t.detail.data}}),"name-type"===e.id&&(this.data={...this.data,type:{_class:"NameType",string:t.detail.data}}),"note-type"===e.id&&(this.data={...this.data,type:{_class:"NoteType",string:t.detail.data}}),"place-type"===e.id&&(this.data={...this.data,place_type:{_class:"PlaceType",string:t.detail.data}}),"event-type"===e.id&&(this.data={...this.data,type:{_class:"EventType",string:t.detail.data}}),"child-frel"===e.id&&(this.data={...this.data,frel:{_class:"ChildRefType",string:t.detail.data}}),"child-mrel"===e.id&&(this.data={...this.data,mrel:{_class:"ChildRefType",string:t.detail.data}}),"child-mrel"===e.id&&(this.data={...this.data,mrel:{_class:"ChildRefType",string:t.detail.data}}),"note-select-list"===e.id&&(this.data=t.detail),"object-citation-list"===e.id&&(this.data={...this.data,citation_list:t.detail.data??[]}),"citation-select-list"===e.id&&(this.data=t.detail),"personref-citation-select-list"===e.id&&(this.data={...this.data,citation_list:t.detail.data}),"personref-note-select-list"===e.id&&(this.data={...this.data,note_list:t.detail.data}),"name"===e.id&&(this.data=t.detail.data),"srcattrtype"===e.id&&(this.data={...this.data,type:{_class:"SrcAttributeType",string:t.detail.data}}),"attrtype"===e.id&&(this.data={...this.data,type:{_class:"AttributeType",string:t.detail.data}}),"family-rel-type"===e.id&&(this.data={...this.data,type:{_class:"FamilyRelType",string:t.detail.data}}),"urltype"===e.id&&(this.data={...this.data,type:{_class:"UrlType",string:t.detail.data}}),"place-name-value"===e.id&&(this.data={...this.data,value:t.detail.data}),"attrvalue"===e.id&&(this.data={...this.data,value:t.detail.data}),t.preventDefault(),t.stopPropagation()}}window.customElements.define("grampsjs-img",class extends K{static get styles(){return[nl,n`
        img {
          max-width: 100%;
          max-height: 100vh;
        }

        .round {
          border-radius: 50%;
        }

        .bordered {
          box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0.2);
        }

        .file-placeholder {
          width: 200px;
          height: 200px;
          background-color: rgba(200, 200, 200, 0.5);
          color: rgba(0, 0, 0, 0.3);
          display: flex;
          align-items: center;
          justify-content: center;
          --mdc-icon-size: 130px;
        }
      `]}static get properties(){return{handle:{type:String},size:{type:Number},rect:{type:Array},circle:{type:Boolean},square:{type:Boolean},mime:{type:String},displayHeight:{type:Number},border:{type:Boolean},radius:{type:Number},_error:{type:Boolean}}}constructor(){super(),this.rect=[],this.circle=!1,this.square=!1,this.mime="",this.displayHeight=0,this.border=!1,this.radius=0,this._error=!1}_renderImageFull(){const t=this.displayHeight||"";return M`
      <img
        src="${Vn(this.handle)}"
        class=${Ot({round:this.circle,bordered:this.border})}
        @error=${this._errorHandler}
        alt=""
        height="${t}"
        style="${this.circle?"":`border-radius:${this.radius}px`}"
      />
    `}async reload(){this.mime.startsWith("image")&&(this._reloadImageUrl(Vn(this.handle)),this._reloadImageUrl(Un(this.handle,3*this.size,this.square)))}async _reloadImageUrl(t){await fetch(t,{cache:"reload",mode:"no-cors"}),this.renderRoot.querySelectorAll(`img[src='${t}']`).forEach((e=>{e.src=t}))}getBBox(){const t=this.shadowRoot.querySelector("img");return null===t?null:t.getBoundingClientRect()}_renderImage(){const t=this.displayHeight||"";return M`
      <img
        srcset="
          ${Un(this.handle,this.size,this.square)},
          ${Un(this.handle,1.5*this.size,this.square)} 1.5x,
          ${Un(this.handle,2*this.size,this.square)} 2x,
          ${Un(this.handle,3*this.size,this.square)} 3x
        "
        src="${Un(this.handle,3*this.size,this.square)}"
        class=${Ot({round:this.circle,bordered:this.border})}
        @error=${this._errorHandler}
        alt=""
        style="${this.circle?"":`border-radius:${this.radius}px`}"
        height="${t}"
      />
    `}_renderImageCropped(){const t=this.displayHeight||"";return M`<img
      srcset="
        ${Yn(this.handle,this.rect,this.size,this.square)},
        ${Yn(this.handle,this.rect,1.5*this.size,this.square)} 1.5x,
        ${Yn(this.handle,this.rect,2*this.size,this.square)} 2x,
        ${Yn(this.handle,this.rect,3*this.size,this.square)} 3x
      "
      src="${Yn(this.handle,this.rect,3*this.size,this.square)}"
      class="${this.circle?"round":""}"
      style="${this.circle?"":`border-radius:${this.radius}px`}"
      @error=${this._errorHandler}
      alt=""
      height="${t}"
    />`}renderBrokenImage(){return M`<img
      class=${Ot({round:this.circle,bordered:this.border})}
      height="${this.displayHeight||""}"
      style="${this.circle?"":`border-radius:${this.radius}px`}"
      src="data:image/svg+xml;base64,${"PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcng9IjAiIHJ5PSIwIiBmaWxsLW9wYWNpdHk9Ii4xIiBmaWxsPSIjMDAwIi8+PHBhdGggZD0ibTE4Ljg4IDYuNjQ4OHY1LjAzNzdsLTIuMjkzNC0yLjMwMS0zLjA1NzggMy4wNjU1LTMuMDU3OC0zLjA1NzgtMy4wNTc4IDMuMDU3OC0yLjI5MzQtMi4zMDF2LTMuNTAxMmExLjUyODkgMS41Mjg5IDAgMCAxIDEuNTI4OS0xLjUyODloMTAuNzAyYTEuNTI4OSAxLjUyODkgMCAwIDEgMS41Mjg5IDEuNTI4OW0tMi4yOTM0IDQuOTA3OCAyLjI5MzQgMi4zMDF2My40OTM1YTEuNTI4OSAxLjUyODkgMCAwIDEtMS41Mjg5IDEuNTI4OWgtMTAuNzAyYTEuNTI4OSAxLjUyODkgMCAwIDEtMS41Mjg5LTEuNTI4OXYtNS4wMzAxbDIuMjkzNCAyLjI4NTcgMy4wNTc4LTMuMDU3OCAzLjA1NzggMy4wNTc4IiBmaWxsLW9wYWNpdHk9Ii4yNSIgIGZpbGw9IiMwMDAiLz48L3N2Zz4K"}"
      alt="Error"
    /> `}render(){return this._error?this.renderBrokenImage():this.mime.startsWith("audio")?this.displayHeight>0?M`
        <div class="file-placeholder">
          <mwc-icon>audio_file<mwc-icon>
        </div>`:this._renderAudio():this.mime.startsWith("video")?this._renderVideo():""===this.mime||this.mime.startsWith("image")||"application/pdf"===this.mime?0===this.size?this._renderFull():this._renderThumb():M`
      <div class="file-placeholder">
        <mwc-icon>insert_drive_file<mwc-icon>
      </div>`}_renderAudio(){return M`
      <audio controls>
        <source src="${Vn(this.handle)}" type="${this.mime}" />
        Your browser does not support the audio element.
      </audio>
    `}_renderVideo(){return M`
      <video
        ?controls=${0===this.displayHeight}
        height="${this.displayHeight>0?this.displayHeight:"auto"}"
      >
        <source src="${Vn(this.handle)}" type="${this.mime}" />
        Your browser does not support the video element.
      </video>
    `}_renderThumb(){return 0===this.rect.length?this._renderImage():this._renderImageCropped()}_renderFull(){return this.rect.length,this._renderImageFull()}_errorHandler(){this._error=!0}});class ch extends(al(K)){static get styles(){return[nl,n`
        mwc-icon-button {
          position: relative;
          top: -14px;
          left: -16px;
          --mdc-icon-size: 20px;
        }

        mwc-icon {
          background-color: rgba(0, 0, 0, 0.25);
          color: white;
        }

        mwc-icon.placeholder {
          width: 40px;
          height: 40px;
          line-height: 40px;
          border-radius: 50%;
        }
      `]}static get properties(){return{data:{type:Array},textEmpty:{type:String},activatable:{type:Boolean},selectable:{type:Boolean},linked:{type:Boolean},metaIcon:{type:String},date:{type:Boolean},noSep:{type:Boolean},loading:{type:Boolean},numberLoading:{type:Number},large:{type:Boolean}}}constructor(){super(),this.data=[],this.textEmpty="",this.activatable=!1,this.selectable=!1,this.linked=!1,this.metaIcon="",this.date=!1,this.noSep=!1,this.loading=!1,this.numberLoading=2,this.large=!1}render(){return this.loading?this.renderLoading():M`
      <mwc-list
        id="search-results"
        ?activatable="${this.activatable}"
        class="${Ot({large:this.large})}"
      >
        ${0===this.data.length&&this.textEmpty?M`
              <mwc-list-item noninteractive>
                <span>${this.textEmpty}</span>
              </mwc-list-item>
            `:""}
        ${this.data.map(((t,e,i)=>{const r=function(t,e,i){switch(t){case"person":return Ga(e);case"family":return M`${Xa(e.profile||{})||Za(i,"Family")}`;case"event":return M`${Ja(e.profile||{},i)||Za(i,e.type.string??e.type)}`;case"place":return M`${e?.profile?.name||e?.name?.value||e.title||t}`;case"source":case"repository":return M`${ts(e,t)||t}`;case"citation":return M`${Ka(e.profile||{})||Za(i,"Citation")}`;case"note":return M`${Za(i,e.type.string??e.type)||t}`;case"media":return M`${ts(e,t)||Za(i,"Media Object")}`;case"tag":return M`${e.name}`;default:return`unknown type: ${t}`}}(t.object_type,t.object,this.strings);return M`
            <mwc-list-item
              ?noninteractive="${!this.selectable&&!this.linked}"
              twoline
              graphic="avatar"
              @click="${()=>this._handleClick(t)}"
              @keydown="${this._handleKeyDown}"
              ?hasMeta=${""!==this.metaIcon}
            >
              ${fs(t)}
              <mwc-icon-button
                @click="${e=>this._handleMetaClick(e,t)}"
                icon="${this.metaIcon}"
                slot="meta"
              ></mwc-icon-button>
              ${t.loading?M`<span style="width:10em;" class="skeleton">&nbsp;</span>`:M`<span>${r}</span>`}
              ${t.loading?M`<span
                    slot="secondary"
                    style="width:10em;"
                    class="skeleton"
                    >&nbsp;</span
                  >`:M`<span slot="secondary"
                    >${this._renderSecondary(t)}</span
                  >`}
            </mwc-list-item>
            ${this.noSep||i.length-1===e?"":M`<li divider padded role="separator"></li>`}
          `}),this)}
      </mwc-list>
    `}renderLoading(){return M` <mwc-list>
      ${Array(this.numberLoading).fill(M`
          <mwc-list-item noninteractive twoline graphic="avatar">
            <span class="skeleton" style="width:15em;">&nbsp;</span>
            <span slot="secondary" class="skeleton" style="width:10em;"
              >&nbsp;</span
            >
            <span slot="graphic" class="skeleton avatar">&nbsp;</span>
          </mwc-list-item>
        `)}
    </mwc-list>`}_renderSecondary(t){if(this.date&&t.object?.change)return M`<grampsjs-timedelta
        timestamp="${t.object.change}"
        locale="${this.strings.__lang__}"
      ></grampsjs-timedelta>`;const e=rs(t.object_type,t.object,this.strings).trim();return e?.length?e:"tag"===t.object_type?this._("Tag"):t.object?.gramps_id||"..."}_handleMetaClick(t,e){t.preventDefault(),t.stopPropagation(),os(this,"search-result:metaClicked",e)}_handleClick(t){if(this.linked&&t.object_type&&t.object?.gramps_id){os(this,"nav",{path:`${t.object_type}/${t.object?.gramps_id}`})}os(this,"search-result:clicked",t)}_handleKeyDown(t){"Enter"===t.code&&(t.target.click(),t.preventDefault(),t.stopPropagation())}}window.customElements.define("grampsjs-search-result-list",ch);class dh extends(al(K)){static get styles(){return[nl,n`
        mwc-textfield.fullwidth {
          width: 100%;
        }
      `]}static get properties(){return{value:{type:String},label:{type:String},disabled:{type:Boolean},fullwidth:{type:Boolean},required:{type:Boolean},type:{type:String}}}constructor(){super(),this.value="",this.label="",this.disabled=!1,this.fullwidth=!1,this.required=!1,this.type="text"}render(){return M`
      <mwc-textfield
        @input="${this.handleChange}"
        label="${this.label}"
        value="${this.value}"
        type="${this.type}"
        ?disabled="${this.disabled}"
        ?required="${this.required}"
        class="${this.fullwidth?"fullwidth":""}"
      ></mwc-textfield>
    `}reset(){this.shadowRoot.querySelector("mwc-textfield").value=""}handleChange(){const t=this.shadowRoot.querySelector("mwc-textfield");null!==t&&os(this,"formdata:changed",{data:t.value})}isValid(){const t=this.shadowRoot.querySelector("mwc-textfield");return null===t||!!t?.validity?.valid}}window.customElements.define("grampsjs-form-string",dh);window.customElements.define("grampsjs-form-new-tag",class extends lh{static get properties(){return{searchRes:{type:Array},disableString:{type:Boolean},disableField:{type:Boolean},_selectedTag:{type:String},_tagName:{type:String},_tagColor:{type:String}}}constructor(){super(),this.searchRes=[],this.disableString=!1,this._selectedTag="",this._tagName="",this._tagColor=""}renderForm(){return M`
      <grampsjs-form-string
        @formdata:changed="${this._handleString}"
        ?disabled="${this.disableString}"
        fullwidth
        id="create"
        label="${this._("New Tag")}"
      >
      </grampsjs-form-string>
      <input
        type="color"
        id="color"
        @change="${this._handleColor}"
        list="presetColors"
      />
      <datalist id="presetColors">
        <option>#1f77b4</option>
        <option>#ff7f0e</option>
        <option>#2ca02c</option>
        <option>#d62728</option>
        <option>#9467bd</option>
        <option>#8c564b</option>
        <option>#e377c2</option>
        <option>#7f7f7f</option>
        <option>#bcbd22</option>
        <option>#17becf</option>
      </datalist>
      <grampsjs-search-result-list
        selectable
        activatable
        .data="${this.searchRes}"
        .strings="${this.strings}"
        @search-result:clicked="${this._handleSelected}"
      ></grampsjs-search-result-list>
    `}firstUpdated(){this._fetchData()}async _fetchData(){const t=`/api/tags/?locale=${this.strings?.__lang__||"en"}&profile=all&pagesize=100`,e=await On(t);"data"in e?this.searchRes=e.data?.map((t=>({object_type:"tag",object:t,handle:t.handle})))?.filter((t=>!this.data.includes(t.handle)))??[]:"error"in e&&(this.searchRes=[])}_handleString(t){this._tagName=t.detail.data}_handleColor(){const t=this.shadowRoot.getElementById("color");this._tagColor=t.value}async _handleDialogSave(){if(!this.disableString&&this._tagName){const t=await this._createNewTag();this.data=[...this.data,t]}else this._selectedTag&&!this.data.includes(this._selectedTag)&&(this.data=[...this.data,this._selectedTag]);super._handleDialogSave()}async _createNewTag(){const t={_class:"Tag",handle:ls(),name:this._tagName};return this._tagColor&&(t.color=this._tagColor),await Nn("/api/tags/",t),t.handle}_handleSelected(t){this.disableString=!0;const e=t.detail;this._selectedTag=e.handle}});class hh extends(al(K)){static get styles(){return[nl,n`
        :host {
          align-items: center;
          display: inline-flex;
        }

        .chip {
          font-size: 13px;
          font-weight: 400;
          font-family: var(--grampsjs-body-font-family);
          padding: 6px 14px;
          border-radius: 9999px;
          margin: 5px 5px;
          background-color: var(--mdc-theme-primary);
          color: rgba(255, 255, 255, 0.9);
          line-height: 18px;
        }

        .chip mwc-icon-button {
          margin-left: 4px;
          --mdc-icon-size: 14px;
          --mdc-icon-button-size: 18px;
        }

        .monospace {
          font-family: 'Commit Mono';
        }
      `]}static get properties(){return{label:{type:String},monospace:{type:Boolean}}}constructor(){super(),this.label="",this.monospace=!1}render(){return M`
      <span
        class="${Ot({monospace:this.monospace,chip:!0})}"
        id="filter-label"
        >${this.monospace&&this.label.length>20?M`${this.label.substring(0,20)}&hellip;`:this.label}<mwc-icon-button
          icon="clear"
          @click=${this._handleClear}
        ></mwc-icon-button
      ></span>
      ${this.monospace?M`<grampsjs-tooltip
            for="filter-label"
            content="${this.label}"
            theme="monospace"
          ></grampsjs-tooltip>`:""}
    `}_handleClear(){os(this,"filter-chip:clear")}}window.customElements.define("grampsjs-filter-chip",hh);const ph=t=>(e,i)=>{void 0!==i?i.addInitializer((()=>{customElements.define(t,e)})):customElements.define(t,e)},uh=globalThis,mh=uh.ShadowRoot&&(void 0===uh.ShadyCSS||uh.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,fh=Symbol(),gh=new WeakMap;class _h{constructor(t,e,i){if(this._$cssResult$=!0,i!==fh)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(mh&&void 0===t){const i=void 0!==e&&1===e.length;i&&(t=gh.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&gh.set(e,t))}return t}toString(){return this.cssText}}const vh=(t,...e)=>{const i=1===t.length?t[0]:e.reduce(((e,i,r)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[r+1]),t[0]);return new _h(i,t,fh)},yh=mh?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const i of t.cssRules)e+=i.cssText;return(t=>new _h("string"==typeof t?t:t+"",void 0,fh))(e)})(t):t,{is:bh,defineProperty:xh,getOwnPropertyDescriptor:wh,getOwnPropertyNames:kh,getOwnPropertySymbols:Th,getPrototypeOf:Sh}=Object,Ch=globalThis,Eh=Ch.trustedTypes,$h=Eh?Eh.emptyScript:"",Ah=Ch.reactiveElementPolyfillSupport,Ih=(t,e)=>t,Mh={toAttribute(t,e){switch(e){case Boolean:t=t?$h:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},Lh=(t,e)=>!bh(t,e),Ph={attribute:!0,type:String,converter:Mh,reflect:!1,hasChanged:Lh};Symbol.metadata??=Symbol("metadata"),Ch.litPropertyMetadata??=new WeakMap;class Rh extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=Ph){if(e.state&&(e.attribute=!1),this._$Ei(),this.elementProperties.set(t,e),!e.noAccessor){const i=Symbol(),r=this.getPropertyDescriptor(t,i,e);void 0!==r&&xh(this.prototype,t,r)}}static getPropertyDescriptor(t,e,i){const{get:r,set:n}=wh(this.prototype,t)??{get(){return this[e]},set(t){this[e]=t}};return{get(){return r?.call(this)},set(e){const a=r?.call(this);n.call(this,e),this.requestUpdate(t,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??Ph}static _$Ei(){if(this.hasOwnProperty(Ih("elementProperties")))return;const t=Sh(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(Ih("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Ih("properties"))){const t=this.properties,e=[...kh(t),...Th(t)];for(const i of e)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const e=litPropertyMetadata.get(t);if(void 0!==e)for(const[t,i]of e)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,e]of this.elementProperties){const i=this._$Eu(t,e);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)e.unshift(yh(t))}else void 0!==t&&e.push(yh(t));return e}static _$Eu(t,e){const i=e.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$Eg=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$ES(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$E_??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$E_?.delete(t)}_$ES(){const t=new Map,e=this.constructor.elementProperties;for(const i of e.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return((t,e)=>{if(mh)t.adoptedStyleSheets=e.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const i of e){const e=document.createElement("style"),r=uh.litNonce;void 0!==r&&e.setAttribute("nonce",r),e.textContent=i.cssText,t.appendChild(e)}})(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$E_?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$E_?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$EO(t,e){const i=this.constructor.elementProperties.get(t),r=this.constructor._$Eu(t,i);if(void 0!==r&&!0===i.reflect){const n=(void 0!==i.converter?.toAttribute?i.converter:Mh).toAttribute(e,i.type);this._$Em=t,null==n?this.removeAttribute(r):this.setAttribute(r,n),this._$Em=null}}_$AK(t,e){const i=this.constructor,r=i._$Eh.get(t);if(void 0!==r&&this._$Em!==r){const t=i.getPropertyOptions(r),n="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:Mh;this._$Em=r,this[r]=n.fromAttribute(e,t.type),this._$Em=null}}requestUpdate(t,e,i,r=!1,n){if(void 0!==t){if(i??=this.constructor.getPropertyOptions(t),!(i.hasChanged??Lh)(r?n:this[t],e))return;this.C(t,e,i)}!1===this.isUpdatePending&&(this._$Eg=this._$EP())}C(t,e,i){this._$AL.has(t)||this._$AL.set(t,e),!0===i.reflect&&this._$Em!==t&&(this._$Ej??=new Set).add(t)}async _$EP(){this.isUpdatePending=!0;try{await this._$Eg}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,e]of this._$Ep)this[t]=e;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[e,i]of t)!0!==i.wrapped||this._$AL.has(e)||void 0===this[e]||this.C(e,this[e],i)}let t=!1;const e=this._$AL;try{t=this.shouldUpdate(e),t?(this.willUpdate(e),this._$E_?.forEach((t=>t.hostUpdate?.())),this.update(e)):this._$ET()}catch(e){throw t=!1,this._$ET(),e}t&&this._$AE(e)}willUpdate(t){}_$AE(t){this._$E_?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$ET(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Eg}shouldUpdate(t){return!0}update(t){this._$Ej&&=this._$Ej.forEach((t=>this._$EO(t,this[t]))),this._$ET()}updated(t){}firstUpdated(t){}}Rh.elementStyles=[],Rh.shadowRootOptions={mode:"open"},Rh[Ih("elementProperties")]=new Map,Rh[Ih("finalized")]=new Map,Ah?.({ReactiveElement:Rh}),(Ch.reactiveElementVersions??=[]).push("2.0.2");const zh={attribute:!0,type:String,converter:Mh,reflect:!1,hasChanged:Lh},Dh=(t=zh,e,i)=>{const{kind:r,metadata:n}=i;let a=globalThis.litPropertyMetadata.get(n);if(void 0===a&&globalThis.litPropertyMetadata.set(n,a=new Map),a.set(i.name,t),"accessor"===r){const{name:r}=i;return{set(i){const n=e.get.call(this);e.set.call(this,i),this.requestUpdate(r,n,t)},init(e){return void 0!==e&&this.C(r,void 0,t),e}}}if("setter"===r){const{name:r}=i;return function(i){const n=this[r];e.call(this,i),this.requestUpdate(r,n,t)}}throw Error("Unsupported decorator location: "+r)};function jh(t){return(e,i)=>"object"==typeof i?Dh(t,e,i):((t,e,i)=>{const r=e.hasOwnProperty(i);return e.constructor.createProperty(i,r?{...t,wrapped:!0}:t),r?Object.getOwnPropertyDescriptor(e,i):void 0})(t,e,i)}function Oh(t){return jh({...t,state:!0,attribute:!1})}const Bh=(t,e,i)=>(i.configurable=!0,i.enumerable=!0,Reflect.decorate&&"object"!=typeof e&&Object.defineProperty(t,e,i),i);function Fh(t,e){return(i,r,n)=>{const a=e=>e.renderRoot?.querySelector(t)??null;if(e){const{get:t,set:e}="object"==typeof r?i:n??(()=>{const t=Symbol();return{get(){return this[t]},set(e){this[t]=e}}})();return Bh(i,r,{get(){let i=t.call(this);return void 0===i&&(i=a(this),(null!==i||this.hasUpdated)&&e.call(this,i)),i}})}return Bh(i,r,{get(){return a(this)}})}}let Nh;function Hh(t){return(e,i)=>Bh(e,i,{async get(){return await this.updateComplete,this.renderRoot?.querySelector(t)??null}})}function Vh(t){return(e,i)=>{const{slot:r,selector:n}=t??{},a="slot"+(r?`[name=${r}]`:":not([name])");return Bh(e,i,{get(){const e=this.renderRoot?.querySelector(a),i=e?.assignedElements(t)??[];return void 0===n?i:i.filter((t=>t.matches(n)))}})}}function Uh(t){return(e,i)=>{const{slot:r}=t??{},n="slot"+(r?`[name=${r}]`:":not([name])");return Bh(e,i,{get(){const e=this.renderRoot?.querySelector(n);return e?.assignedNodes(t)??[]}})}}const Yh=globalThis,Zh=Yh.trustedTypes,qh=Zh?Zh.createPolicy("lit-html",{createHTML:t=>t}):void 0,Wh="$lit$",Gh=`lit$${(Math.random()+"").slice(9)}$`,Xh="?"+Gh,Kh=`<${Xh}>`,Jh=document,Qh=()=>Jh.createComment(""),tp=t=>null===t||"object"!=typeof t&&"function"!=typeof t,ep=Array.isArray,ip="[ \t\n\f\r]",rp=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,np=/-->/g,ap=/>/g,sp=RegExp(`>|${ip}(?:([^\\s"'>=/]+)(${ip}*=${ip}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),op=/'/g,lp=/"/g,cp=/^(?:script|style|textarea|title)$/i,dp=(t=>(e,...i)=>({_$litType$:t,strings:e,values:i}))(1),hp=Symbol.for("lit-noChange"),pp=Symbol.for("lit-nothing"),up=new WeakMap,mp=Jh.createTreeWalker(Jh,129);function fp(t,e){if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==qh?qh.createHTML(e):e}const gp=(t,e)=>{const i=t.length-1,r=[];let n,a=2===e?"<svg>":"",s=rp;for(let e=0;e<i;e++){const i=t[e];let o,l,c=-1,d=0;for(;d<i.length&&(s.lastIndex=d,l=s.exec(i),null!==l);)d=s.lastIndex,s===rp?"!--"===l[1]?s=np:void 0!==l[1]?s=ap:void 0!==l[2]?(cp.test(l[2])&&(n=RegExp("</"+l[2],"g")),s=sp):void 0!==l[3]&&(s=sp):s===sp?">"===l[0]?(s=n??rp,c=-1):void 0===l[1]?c=-2:(c=s.lastIndex-l[2].length,o=l[1],s=void 0===l[3]?sp:'"'===l[3]?lp:op):s===lp||s===op?s=sp:s===np||s===ap?s=rp:(s=sp,n=void 0);const h=s===sp&&t[e+1].startsWith("/>")?" ":"";a+=s===rp?i+Kh:c>=0?(r.push(o),i.slice(0,c)+Wh+i.slice(c)+Gh+h):i+Gh+(-2===c?e:h)}return[fp(t,a+(t[i]||"<?>")+(2===e?"</svg>":"")),r]};class _p{constructor({strings:t,_$litType$:e},i){let r;this.parts=[];let n=0,a=0;const s=t.length-1,o=this.parts,[l,c]=gp(t,e);if(this.el=_p.createElement(l,i),mp.currentNode=this.el.content,2===e){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(r=mp.nextNode())&&o.length<s;){if(1===r.nodeType){if(r.hasAttributes())for(const t of r.getAttributeNames())if(t.endsWith(Wh)){const e=c[a++],i=r.getAttribute(t).split(Gh),s=/([.?@])?(.*)/.exec(e);o.push({type:1,index:n,name:s[2],strings:i,ctor:"."===s[1]?wp:"?"===s[1]?kp:"@"===s[1]?Tp:xp}),r.removeAttribute(t)}else t.startsWith(Gh)&&(o.push({type:6,index:n}),r.removeAttribute(t));if(cp.test(r.tagName)){const t=r.textContent.split(Gh),e=t.length-1;if(e>0){r.textContent=Zh?Zh.emptyScript:"";for(let i=0;i<e;i++)r.append(t[i],Qh()),mp.nextNode(),o.push({type:2,index:++n});r.append(t[e],Qh())}}}else if(8===r.nodeType)if(r.data===Xh)o.push({type:2,index:n});else{let t=-1;for(;-1!==(t=r.data.indexOf(Gh,t+1));)o.push({type:7,index:n}),t+=Gh.length-1}n++}}static createElement(t,e){const i=Jh.createElement("template");return i.innerHTML=t,i}}function vp(t,e,i=t,r){if(e===hp)return e;let n=void 0!==r?i._$Co?.[r]:i._$Cl;const a=tp(e)?void 0:e._$litDirective$;return n?.constructor!==a&&(n?._$AO?.(!1),void 0===a?n=void 0:(n=new a(t),n._$AT(t,i,r)),void 0!==r?(i._$Co??=[])[r]=n:i._$Cl=n),void 0!==n&&(e=vp(t,n._$AS(t,e.values),n,r)),e}class yp{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:e},parts:i}=this._$AD,r=(t?.creationScope??Jh).importNode(e,!0);mp.currentNode=r;let n=mp.nextNode(),a=0,s=0,o=i[0];for(;void 0!==o;){if(a===o.index){let e;2===o.type?e=new bp(n,n.nextSibling,this,t):1===o.type?e=new o.ctor(n,o.name,o.strings,this,t):6===o.type&&(e=new Sp(n,this,t)),this._$AV.push(e),o=i[++s]}a!==o?.index&&(n=mp.nextNode(),a++)}return mp.currentNode=Jh,r}p(t){let e=0;for(const i of this._$AV)void 0!==i&&(void 0!==i.strings?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class bp{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,e,i,r){this.type=2,this._$AH=pp,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=r,this._$Cv=r?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===t?.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=vp(this,t,e),tp(t)?t===pp||null==t||""===t?(this._$AH!==pp&&this._$AR(),this._$AH=pp):t!==this._$AH&&t!==hp&&this._(t):void 0!==t._$litType$?this.g(t):void 0!==t.nodeType?this.$(t):(t=>ep(t)||"function"==typeof t?.[Symbol.iterator])(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==pp&&tp(this._$AH)?this._$AA.nextSibling.data=t:this.$(Jh.createTextNode(t)),this._$AH=t}g(t){const{values:e,_$litType$:i}=t,r="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=_p.createElement(fp(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===r)this._$AH.p(e);else{const t=new yp(r,this),i=t.u(this.options);t.p(e),this.$(i),this._$AH=t}}_$AC(t){let e=up.get(t.strings);return void 0===e&&up.set(t.strings,e=new _p(t)),e}T(t){ep(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,r=0;for(const n of t)r===e.length?e.push(i=new bp(this.k(Qh()),this.k(Qh()),this,this.options)):i=e[r],i._$AI(n),r++;r<e.length&&(this._$AR(i&&i._$AB.nextSibling,r),e.length=r)}_$AR(t=this._$AA.nextSibling,e){for(this._$AP?.(!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class xp{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,i,r,n){this.type=1,this._$AH=pp,this._$AN=void 0,this.element=t,this.name=e,this._$AM=r,this.options=n,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=pp}_$AI(t,e=this,i,r){const n=this.strings;let a=!1;if(void 0===n)t=vp(this,t,e,0),a=!tp(t)||t!==this._$AH&&t!==hp,a&&(this._$AH=t);else{const r=t;let s,o;for(t=n[0],s=0;s<n.length-1;s++)o=vp(this,r[i+s],e,s),o===hp&&(o=this._$AH[s]),a||=!tp(o)||o!==this._$AH[s],o===pp?t=pp:t!==pp&&(t+=(o??"")+n[s+1]),this._$AH[s]=o}a&&!r&&this.O(t)}O(t){t===pp?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class wp extends xp{constructor(){super(...arguments),this.type=3}O(t){this.element[this.name]=t===pp?void 0:t}}class kp extends xp{constructor(){super(...arguments),this.type=4}O(t){this.element.toggleAttribute(this.name,!!t&&t!==pp)}}class Tp extends xp{constructor(t,e,i,r,n){super(t,e,i,r,n),this.type=5}_$AI(t,e=this){if((t=vp(this,t,e,0)??pp)===hp)return;const i=this._$AH,r=t===pp&&i!==pp||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,n=t!==pp&&(i===pp||r);r&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class Sp{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){vp(this,t)}}const Cp=Yh.litHtmlPolyfillSupport;Cp?.(_p,bp),(Yh.litHtmlVersions??=[]).push("3.1.0");const Ep=(t,e,i)=>{const r=i?.renderBefore??e;let n=r._$litPart$;if(void 0===n){const t=i?.renderBefore??null;r._$litPart$=n=new bp(e.insertBefore(Qh(),t),t,void 0,i??{})}return n._$AI(t),n};class $p extends Rh{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=Ep(e,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return hp}}$p._$litElement$=!0,$p.finalized=!0,globalThis.litElementHydrateSupport?.({LitElement:$p});const Ap=globalThis.litElementPolyfillSupport;Ap?.({LitElement:$p}),(globalThis.litElementVersions??=[]).push("4.0.2");const Ip=1,Mp=3,Lp=4,Pp=t=>(...e)=>({_$litDirective$:t,values:e});class Rp{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}const zp=Pp(class extends Rp{constructor(t){if(super(t),t.type!==Ip||"class"!==t.name||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((e=>t[e])).join(" ")+" "}update(t,[e]){if(void 0===this.it){this.it=new Set,void 0!==t.strings&&(this.st=new Set(t.strings.join(" ").split(/\s/).filter((t=>""!==t))));for(const t in e)e[t]&&!this.st?.has(t)&&this.it.add(t);return this.render(e)}const i=t.element.classList;for(const t of this.it)t in e||(i.remove(t),this.it.delete(t));for(const t in e){const r=!!e[t];r===this.it.has(t)||this.st?.has(t)||(r?(i.add(t),this.it.add(t)):(i.remove(t),this.it.delete(t)))}return hp}}),Dp="cubic-bezier(0.2, 0, 0, 1)",jp="cubic-bezier(.3,0,0,1)",Op="cubic-bezier(.3,0,.8,.15)";class Bp extends $p{constructor(){super(...arguments),this.disabled=!1,this.error=!1,this.focused=!1,this.label="",this.populated=!1,this.required=!1,this.resizable=!1,this.supportingText="",this.errorText="",this.count=-1,this.max=-1,this.hasStart=!1,this.hasEnd=!1,this.isAnimating=!1,this.refreshErrorAlert=!1,this.disableTransitions=!1}get counterText(){const t=this.count??-1,e=this.max??-1;return t<0||e<=0?"":`${t} / ${e}`}get supportingOrErrorText(){return this.error&&this.errorText?this.errorText:this.supportingText}reannounceError(){this.refreshErrorAlert=!0}update(t){t.has("disabled")&&void 0!==t.get("disabled")&&(this.disableTransitions=!0),this.disabled&&this.focused&&(t.set("focused",!0),this.focused=!1),this.animateLabelIfNeeded({wasFocused:t.get("focused"),wasPopulated:t.get("populated")}),super.update(t)}render(){const t=this.renderLabel(!0),e=this.renderLabel(!1),i=this.renderOutline?.(t),r={disabled:this.disabled,"disable-transitions":this.disableTransitions,error:this.error&&!this.disabled,focused:this.focused,"with-start":this.hasStart,"with-end":this.hasEnd,populated:this.populated,resizable:this.resizable,required:this.required,"no-label":!this.label};return dp`
      <div class="field ${zp(r)}">
        <div class="container-overflow">
          ${this.renderBackground?.()} ${this.renderIndicator?.()} ${i}
          <div class="container">
            <div class="start">
              <slot name="start"></slot>
            </div>
            <div class="middle">
              <div class="label-wrapper">
                ${e} ${i?pp:t}
              </div>
              <div class="content">
                <slot></slot>
              </div>
            </div>
            <div class="end">
              <slot name="end"></slot>
            </div>
          </div>
        </div>
        ${this.renderSupportingText()}
      </div>
    `}updated(t){(t.has("supportingText")||t.has("errorText")||t.has("count")||t.has("max"))&&this.updateSlottedAriaDescribedBy(),this.refreshErrorAlert&&requestAnimationFrame((()=>{this.refreshErrorAlert=!1})),this.disableTransitions&&requestAnimationFrame((()=>{this.disableTransitions=!1}))}renderSupportingText(){const{supportingOrErrorText:t,counterText:e}=this;if(!t&&!e)return pp;const i=dp`<span>${t}</span>`,r=e?dp`<span class="counter">${e}</span>`:pp,n=this.error&&this.errorText&&!this.refreshErrorAlert;return dp`
      <div class="supporting-text" role=${n?"alert":pp}>${i}${r}</div>
      <slot
        name="aria-describedby"
        @slotchange=${this.updateSlottedAriaDescribedBy}></slot>
    `}updateSlottedAriaDescribedBy(){for(const t of this.slottedAriaDescribedBy)Ep(dp`${this.supportingOrErrorText} ${this.counterText}`,t),t.setAttribute("hidden","")}renderLabel(t){if(!this.label)return pp;let e;e=t?this.focused||this.populated||this.isAnimating:!this.focused&&!this.populated&&!this.isAnimating;const i={hidden:!e,floating:t,resting:!t},r=`${this.label}${this.required?"*":""}`;return dp`
      <span class="label ${zp(i)}" aria-hidden=${!e}
        >${r}</span
      >
    `}animateLabelIfNeeded({wasFocused:t,wasPopulated:e}){if(!this.label)return;t??(t=this.focused),e??(e=this.populated);(t||e)!==(this.focused||this.populated)&&(this.isAnimating=!0,this.labelAnimation?.cancel(),this.labelAnimation=this.floatingLabelEl?.animate(this.getLabelKeyframes(),{duration:150,easing:Dp}),this.labelAnimation?.addEventListener("finish",(()=>{this.isAnimating=!1})))}getLabelKeyframes(){const{floatingLabelEl:t,restingLabelEl:e}=this;if(!t||!e)return[];const{x:i,y:r,height:n}=t.getBoundingClientRect(),{x:a,y:s,height:o}=e.getBoundingClientRect(),l=t.scrollWidth,c=e.scrollWidth,d=c/l,h=`translateX(${a-i}px) translateY(${s-r+Math.round((o-n*d)/2)}px) scale(${d})`,p="translateX(0) translateY(0) scale(1)",u=e.clientWidth,m=c>u?u/d+"px":"";return this.focused||this.populated?[{transform:h,width:m},{transform:p,width:m}]:[{transform:p,width:m},{transform:h,width:m}]}getSurfacePositionClientRect(){return this.containerEl.getBoundingClientRect()}}it([jh({type:Boolean})],Bp.prototype,"disabled",void 0),it([jh({type:Boolean})],Bp.prototype,"error",void 0),it([jh({type:Boolean})],Bp.prototype,"focused",void 0),it([jh()],Bp.prototype,"label",void 0),it([jh({type:Boolean})],Bp.prototype,"populated",void 0),it([jh({type:Boolean})],Bp.prototype,"required",void 0),it([jh({type:Boolean})],Bp.prototype,"resizable",void 0),it([jh({attribute:"supporting-text"})],Bp.prototype,"supportingText",void 0),it([jh({attribute:"error-text"})],Bp.prototype,"errorText",void 0),it([jh({type:Number})],Bp.prototype,"count",void 0),it([jh({type:Number})],Bp.prototype,"max",void 0),it([jh({type:Boolean,attribute:"has-start"})],Bp.prototype,"hasStart",void 0),it([jh({type:Boolean,attribute:"has-end"})],Bp.prototype,"hasEnd",void 0),it([Vh({slot:"aria-describedby"})],Bp.prototype,"slottedAriaDescribedBy",void 0),it([Oh()],Bp.prototype,"isAnimating",void 0),it([Oh()],Bp.prototype,"refreshErrorAlert",void 0),it([Oh()],Bp.prototype,"disableTransitions",void 0),it([Fh(".label.floating")],Bp.prototype,"floatingLabelEl",void 0),it([Fh(".label.resting")],Bp.prototype,"restingLabelEl",void 0),it([Fh(".container")],Bp.prototype,"containerEl",void 0);class Fp extends Bp{renderOutline(t){return dp`
      <div class="outline">
        <div class="outline-start"></div>
        <div class="outline-notch">
          <div class="outline-panel-inactive"></div>
          <div class="outline-panel-active"></div>
          <div class="outline-label">${t}</div>
        </div>
        <div class="outline-end"></div>
      </div>
    `}}const Np=vh`@layer styles{:host{--_bottom-space: var(--md-outlined-field-bottom-space, 16px);--_content-color: var(--md-outlined-field-content-color, var(--md-sys-color-on-surface, #1d1b20));--_content-font: var(--md-outlined-field-content-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_content-line-height: var(--md-outlined-field-content-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_content-size: var(--md-outlined-field-content-size, var(--md-sys-typescale-body-large-size, 1rem));--_content-weight: var(--md-outlined-field-content-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_disabled-content-color: var(--md-outlined-field-disabled-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-content-opacity: var(--md-outlined-field-disabled-content-opacity, 0.38);--_disabled-label-text-color: var(--md-outlined-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-outlined-field-disabled-label-text-opacity, 0.38);--_disabled-leading-content-color: var(--md-outlined-field-disabled-leading-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-content-opacity: var(--md-outlined-field-disabled-leading-content-opacity, 0.38);--_disabled-outline-color: var(--md-outlined-field-disabled-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-outline-opacity: var(--md-outlined-field-disabled-outline-opacity, 0.12);--_disabled-outline-width: var(--md-outlined-field-disabled-outline-width, 1px);--_disabled-supporting-text-color: var(--md-outlined-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-supporting-text-opacity: var(--md-outlined-field-disabled-supporting-text-opacity, 0.38);--_disabled-trailing-content-color: var(--md-outlined-field-disabled-trailing-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-content-opacity: var(--md-outlined-field-disabled-trailing-content-opacity, 0.38);--_error-content-color: var(--md-outlined-field-error-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-content-color: var(--md-outlined-field-error-focus-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-label-text-color: var(--md-outlined-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-leading-content-color: var(--md-outlined-field-error-focus-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-outline-color: var(--md-outlined-field-error-focus-outline-color, var(--md-sys-color-error, #b3261e));--_error-focus-supporting-text-color: var(--md-outlined-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-trailing-content-color: var(--md-outlined-field-error-focus-trailing-content-color, var(--md-sys-color-error, #b3261e));--_error-hover-content-color: var(--md-outlined-field-error-hover-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-label-text-color: var(--md-outlined-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-leading-content-color: var(--md-outlined-field-error-hover-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-hover-outline-color: var(--md-outlined-field-error-hover-outline-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-supporting-text-color: var(--md-outlined-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-hover-trailing-content-color: var(--md-outlined-field-error-hover-trailing-content-color, var(--md-sys-color-on-error-container, #410e0b));--_error-label-text-color: var(--md-outlined-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_error-leading-content-color: var(--md-outlined-field-error-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-outline-color: var(--md-outlined-field-error-outline-color, var(--md-sys-color-error, #b3261e));--_error-supporting-text-color: var(--md-outlined-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-trailing-content-color: var(--md-outlined-field-error-trailing-content-color, var(--md-sys-color-error, #b3261e));--_focus-content-color: var(--md-outlined-field-focus-content-color, var(--md-sys-color-on-surface, #1d1b20));--_focus-label-text-color: var(--md-outlined-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_focus-leading-content-color: var(--md-outlined-field-focus-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-outline-color: var(--md-outlined-field-focus-outline-color, var(--md-sys-color-primary, #6750a4));--_focus-outline-width: var(--md-outlined-field-focus-outline-width, 3px);--_focus-supporting-text-color: var(--md-outlined-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-trailing-content-color: var(--md-outlined-field-focus-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-content-color: var(--md-outlined-field-hover-content-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-outlined-field-hover-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-leading-content-color: var(--md-outlined-field-hover-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-outline-color: var(--md-outlined-field-hover-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-outline-width: var(--md-outlined-field-hover-outline-width, 1px);--_hover-supporting-text-color: var(--md-outlined-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-content-color: var(--md-outlined-field-hover-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-color: var(--md-outlined-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-font: var(--md-outlined-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-outlined-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_label-text-padding-bottom: var(--md-outlined-field-label-text-padding-bottom, 8px);--_label-text-populated-line-height: var(--md-outlined-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_label-text-populated-size: var(--md-outlined-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_label-text-size: var(--md-outlined-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_label-text-weight: var(--md-outlined-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_leading-content-color: var(--md-outlined-field-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_leading-space: var(--md-outlined-field-leading-space, 16px);--_outline-color: var(--md-outlined-field-outline-color, var(--md-sys-color-outline, #79747e));--_outline-label-padding: var(--md-outlined-field-outline-label-padding, 4px);--_outline-width: var(--md-outlined-field-outline-width, 1px);--_supporting-text-color: var(--md-outlined-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_supporting-text-font: var(--md-outlined-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_supporting-text-leading-space: var(--md-outlined-field-supporting-text-leading-space, 16px);--_supporting-text-line-height: var(--md-outlined-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_supporting-text-size: var(--md-outlined-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_supporting-text-top-space: var(--md-outlined-field-supporting-text-top-space, 4px);--_supporting-text-trailing-space: var(--md-outlined-field-supporting-text-trailing-space, 16px);--_supporting-text-weight: var(--md-outlined-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_top-space: var(--md-outlined-field-top-space, 16px);--_trailing-content-color: var(--md-outlined-field-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-space: var(--md-outlined-field-trailing-space, 16px);--_container-shape-start-start: var(--md-outlined-field-container-shape-start-start, var(--md-outlined-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-start-end: var(--md-outlined-field-container-shape-start-end, var(--md-outlined-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-end: var(--md-outlined-field-container-shape-end-end, var(--md-outlined-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-start: var(--md-outlined-field-container-shape-end-start, var(--md-outlined-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)))}.outline{border-color:var(--_outline-color);border-radius:inherit;display:flex;pointer-events:none;height:100%;position:absolute;width:100%;z-index:1}.outline-start::before,.outline-start::after,.outline-panel-inactive::before,.outline-panel-inactive::after,.outline-panel-active::before,.outline-panel-active::after,.outline-end::before,.outline-end::after{border:inherit;content:"";inset:0;position:absolute}.outline-start,.outline-end{border:inherit;border-radius:inherit;box-sizing:border-box;position:relative}.outline-start::before,.outline-start::after,.outline-end::before,.outline-end::after{border-bottom-style:solid;border-top-style:solid}.outline-start::after,.outline-end::after{opacity:0;transition:opacity 150ms cubic-bezier(0.2, 0, 0, 1)}.focused .outline-start::after,.focused .outline-end::after{opacity:1}.outline-start::before,.outline-start::after{border-inline-start-style:solid;border-inline-end-style:none;border-start-start-radius:inherit;border-start-end-radius:0;border-end-start-radius:inherit;border-end-end-radius:0;margin-inline-end:var(--_outline-label-padding)}.outline-end{flex-grow:1;margin-inline-start:calc(-1*var(--_outline-label-padding))}.outline-end::before,.outline-end::after{border-inline-start-style:none;border-inline-end-style:solid;border-start-start-radius:0;border-start-end-radius:inherit;border-end-start-radius:0;border-end-end-radius:inherit}.outline-notch{align-items:flex-start;border:inherit;display:flex;margin-inline-start:calc(-1*var(--_outline-label-padding));margin-inline-end:var(--_outline-label-padding);max-width:calc(100% - var(--_leading-space) - var(--_trailing-space));padding:0 var(--_outline-label-padding);position:relative}.no-label .outline-notch{display:none}.outline-panel-inactive,.outline-panel-active{border:inherit;border-bottom-style:solid;inset:0;position:absolute}.outline-panel-inactive::before,.outline-panel-inactive::after,.outline-panel-active::before,.outline-panel-active::after{border-top-style:solid;border-bottom:none;bottom:auto;transform:scaleX(1);transition:transform 150ms cubic-bezier(0.2, 0, 0, 1)}.outline-panel-inactive::before,.outline-panel-active::before{right:50%;transform-origin:top left}.outline-panel-inactive::after,.outline-panel-active::after{left:50%;transform-origin:top right}.populated .outline-panel-inactive::before,.populated .outline-panel-inactive::after,.populated .outline-panel-active::before,.populated .outline-panel-active::after,.focused .outline-panel-inactive::before,.focused .outline-panel-inactive::after,.focused .outline-panel-active::before,.focused .outline-panel-active::after{transform:scaleX(0)}.outline-panel-active{opacity:0;transition:opacity 150ms cubic-bezier(0.2, 0, 0, 1)}.focused .outline-panel-active{opacity:1}.outline-label{display:flex;max-width:100%;transform:translateY(calc(-100% + var(--_label-text-padding-bottom)))}.outline-start,.field:not(.with-start) .content ::slotted(*){padding-inline-start:max(var(--_leading-space),max(var(--_container-shape-start-start),var(--_container-shape-end-start)) + var(--_outline-label-padding))}.field:not(.with-start) .label-wrapper{margin-inline-start:max(var(--_leading-space),max(var(--_container-shape-start-start),var(--_container-shape-end-start)) + var(--_outline-label-padding))}.field:not(.with-end) .content ::slotted(*){padding-inline-end:max(var(--_trailing-space),max(var(--_container-shape-start-end),var(--_container-shape-end-end)))}.field:not(.with-end) .label-wrapper{margin-inline-end:max(var(--_trailing-space),max(var(--_container-shape-start-end),var(--_container-shape-end-end)))}.outline-start::before,.outline-end::before,.outline-panel-inactive,.outline-panel-inactive::before,.outline-panel-inactive::after{border-width:var(--_outline-width)}:hover .outline{border-color:var(--_hover-outline-color);color:var(--_hover-outline-color)}:hover .outline-start::before,:hover .outline-end::before,:hover .outline-panel-inactive,:hover .outline-panel-inactive::before,:hover .outline-panel-inactive::after{border-width:var(--_hover-outline-width)}.focused .outline{border-color:var(--_focus-outline-color);color:var(--_focus-outline-color)}.outline-start::after,.outline-end::after,.outline-panel-active,.outline-panel-active::before,.outline-panel-active::after{border-width:var(--_focus-outline-width)}.disabled .outline{border-color:var(--_disabled-outline-color);color:var(--_disabled-outline-color)}.disabled .outline-start,.disabled .outline-end,.disabled .outline-panel-inactive{opacity:var(--_disabled-outline-opacity)}.disabled .outline-start::before,.disabled .outline-end::before,.disabled .outline-panel-inactive,.disabled .outline-panel-inactive::before,.disabled .outline-panel-inactive::after{border-width:var(--_disabled-outline-width)}.error .outline{border-color:var(--_error-outline-color);color:var(--_error-outline-color)}.error:hover .outline{border-color:var(--_error-hover-outline-color);color:var(--_error-hover-outline-color)}.error.focused .outline{border-color:var(--_error-focus-outline-color);color:var(--_error-focus-outline-color)}.resizable .container{bottom:var(--_focus-outline-width);inset-inline-end:var(--_focus-outline-width);clip-path:inset(var(--_focus-outline-width) 0 0 var(--_focus-outline-width))}.resizable .container>*{top:var(--_focus-outline-width);inset-inline-start:var(--_focus-outline-width)}.resizable .container:dir(rtl){clip-path:inset(var(--_focus-outline-width) var(--_focus-outline-width) 0 0)}}@layer hcm{@media(forced-colors: active){.disabled .outline{border-color:GrayText;color:GrayText}.disabled :is(.outline-start,.outline-end,.outline-panel-inactive){opacity:1}}}
`,Hp=vh`:host{display:inline-flex;resize:both}.field{display:flex;flex:1;flex-direction:column;writing-mode:horizontal-tb;max-width:100%}.container-overflow{border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-end-radius:var(--_container-shape-end-end);border-end-start-radius:var(--_container-shape-end-start);display:flex;height:100%;position:relative}.container{align-items:center;border-radius:inherit;display:flex;flex:1;max-height:100%;min-height:100%;min-width:min-content;position:relative}.field,.container-overflow{resize:inherit}.resizable:not(.disabled) .container{resize:inherit;overflow:hidden}.disabled{pointer-events:none}@layer styles{.start,.middle,.end{display:flex;box-sizing:border-box;height:100%;position:relative}.start{color:var(--_leading-content-color)}.end{color:var(--_trailing-content-color)}.start,.end{align-items:center;justify-content:center}.with-start .start,.with-end .end{min-width:48px}.with-start .start{margin-inline-end:4px}.with-end .end{margin-inline-start:4px}.middle{align-items:stretch;align-self:baseline;flex:1}.content{color:var(--_content-color);display:flex;flex:1;opacity:0;transition:opacity 83ms cubic-bezier(0.2, 0, 0, 1)}.no-label .content,.focused .content,.populated .content{opacity:1;transition-delay:67ms}:is(.disabled,.disable-transitions) .content{transition:none}.content ::slotted(*){all:unset;color:currentColor;font-family:var(--_content-font);font-size:var(--_content-size);line-height:var(--_content-line-height);font-weight:var(--_content-weight);width:100%;overflow-wrap:revert;white-space:revert}.content ::slotted(:not(textarea)){padding-top:var(--_top-space);padding-bottom:var(--_bottom-space)}.content ::slotted(textarea){margin-top:var(--_top-space);margin-bottom:var(--_bottom-space)}:hover .content{color:var(--_hover-content-color)}:hover .start{color:var(--_hover-leading-content-color)}:hover .end{color:var(--_hover-trailing-content-color)}.focused .content{color:var(--_focus-content-color)}.focused .start{color:var(--_focus-leading-content-color)}.focused .end{color:var(--_focus-trailing-content-color)}.disabled .content{color:var(--_disabled-content-color)}.disabled.no-label .content,.disabled.focused .content,.disabled.populated .content{opacity:var(--_disabled-content-opacity)}.disabled .start{color:var(--_disabled-leading-content-color);opacity:var(--_disabled-leading-content-opacity)}.disabled .end{color:var(--_disabled-trailing-content-color);opacity:var(--_disabled-trailing-content-opacity)}.error .content{color:var(--_error-content-color)}.error .start{color:var(--_error-leading-content-color)}.error .end{color:var(--_error-trailing-content-color)}.error:hover .content{color:var(--_error-hover-content-color)}.error:hover .start{color:var(--_error-hover-leading-content-color)}.error:hover .end{color:var(--_error-hover-trailing-content-color)}.error.focused .content{color:var(--_error-focus-content-color)}.error.focused .start{color:var(--_error-focus-leading-content-color)}.error.focused .end{color:var(--_error-focus-trailing-content-color)}}@layer hcm{@media(forced-colors: active){.disabled :is(.start,.content,.end){color:GrayText;opacity:1}}}@layer styles{.label{box-sizing:border-box;color:var(--_label-text-color);overflow:hidden;max-width:100%;text-overflow:ellipsis;white-space:nowrap;z-index:1;font-family:var(--_label-text-font);font-size:var(--_label-text-size);line-height:var(--_label-text-line-height);font-weight:var(--_label-text-weight);width:min-content}.label-wrapper{inset:0;pointer-events:none;position:absolute}.label.resting{position:absolute;top:var(--_top-space)}.label.floating{font-size:var(--_label-text-populated-size);line-height:var(--_label-text-populated-line-height);transform-origin:top left}.label.hidden{opacity:0}.no-label .label{display:none}.label-wrapper{inset:0;position:absolute;text-align:initial}:hover .label{color:var(--_hover-label-text-color)}.focused .label{color:var(--_focus-label-text-color)}.disabled .label{color:var(--_disabled-label-text-color)}.disabled .label:not(.hidden){opacity:var(--_disabled-label-text-opacity)}.error .label{color:var(--_error-label-text-color)}.error:hover .label{color:var(--_error-hover-label-text-color)}.error.focused .label{color:var(--_error-focus-label-text-color)}}@layer hcm{@media(forced-colors: active){.disabled .label:not(.hidden){color:GrayText;opacity:1}}}@layer styles{.supporting-text{color:var(--_supporting-text-color);display:flex;font-family:var(--_supporting-text-font);font-size:var(--_supporting-text-size);line-height:var(--_supporting-text-line-height);font-weight:var(--_supporting-text-weight);gap:16px;justify-content:space-between;padding-inline-start:var(--_supporting-text-leading-space);padding-inline-end:var(--_supporting-text-trailing-space);padding-top:var(--_supporting-text-top-space)}.supporting-text :nth-child(2){flex-shrink:0}:hover .supporting-text{color:var(--_hover-supporting-text-color)}.focus .supporting-text{color:var(--_focus-supporting-text-color)}.disabled .supporting-text{color:var(--_disabled-supporting-text-color);opacity:var(--_disabled-supporting-text-opacity)}.error .supporting-text{color:var(--_error-supporting-text-color)}.error:hover .supporting-text{color:var(--_error-hover-supporting-text-color)}.error.focus .supporting-text{color:var(--_error-focus-supporting-text-color)}}@layer hcm{@media(forced-colors: active){.disabled .supporting-text{color:GrayText;opacity:1}}}
`;let Vp=class extends Fp{};Vp.styles=[Hp,Np],Vp=it([ph("md-outlined-field")],Vp);const Up=Symbol.for(""),Yp=t=>{if(t?.r===Up)return t?._$litStatic$},Zp=(t,...e)=>({_$litStatic$:e.reduce(((e,i,r)=>e+(t=>{if(void 0!==t._$litStatic$)return t._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${t}. Use 'unsafeStatic' to pass non-literal values, but\n            take care to ensure page security.`)})(i)+t[r+1]),t[0]),r:Up}),qp=new Map,Wp=(t=>(e,...i)=>{const r=i.length;let n,a;const s=[],o=[];let l,c=0,d=!1;for(;c<r;){for(l=e[c];c<r&&void 0!==(a=i[c],n=Yp(a));)l+=n+e[++c],d=!0;c!==r&&o.push(a),s.push(l),c++}if(c===r&&s.push(e[r]),d){const t=s.join("$$lit$$");void 0===(e=qp.get(t))&&(s.raw=s,qp.set(t,e=s)),i=o}return t(e,...i)})(dp),Gp=vh`:host{--_caret-color: var(--md-outlined-text-field-caret-color, var(--md-sys-color-primary, #6750a4));--_disabled-input-text-color: var(--md-outlined-text-field-disabled-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-input-text-opacity: var(--md-outlined-text-field-disabled-input-text-opacity, 0.38);--_disabled-label-text-color: var(--md-outlined-text-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-outlined-text-field-disabled-label-text-opacity, 0.38);--_disabled-leading-icon-color: var(--md-outlined-text-field-disabled-leading-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-icon-opacity: var(--md-outlined-text-field-disabled-leading-icon-opacity, 0.38);--_disabled-outline-color: var(--md-outlined-text-field-disabled-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-outline-opacity: var(--md-outlined-text-field-disabled-outline-opacity, 0.12);--_disabled-outline-width: var(--md-outlined-text-field-disabled-outline-width, 1px);--_disabled-supporting-text-color: var(--md-outlined-text-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-supporting-text-opacity: var(--md-outlined-text-field-disabled-supporting-text-opacity, 0.38);--_disabled-trailing-icon-color: var(--md-outlined-text-field-disabled-trailing-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-icon-opacity: var(--md-outlined-text-field-disabled-trailing-icon-opacity, 0.38);--_error-focus-caret-color: var(--md-outlined-text-field-error-focus-caret-color, var(--md-sys-color-error, #b3261e));--_error-focus-input-text-color: var(--md-outlined-text-field-error-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-label-text-color: var(--md-outlined-text-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-leading-icon-color: var(--md-outlined-text-field-error-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-outline-color: var(--md-outlined-text-field-error-focus-outline-color, var(--md-sys-color-error, #b3261e));--_error-focus-supporting-text-color: var(--md-outlined-text-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-trailing-icon-color: var(--md-outlined-text-field-error-focus-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_error-hover-input-text-color: var(--md-outlined-text-field-error-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-label-text-color: var(--md-outlined-text-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-leading-icon-color: var(--md-outlined-text-field-error-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-hover-outline-color: var(--md-outlined-text-field-error-hover-outline-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-supporting-text-color: var(--md-outlined-text-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-hover-trailing-icon-color: var(--md-outlined-text-field-error-hover-trailing-icon-color, var(--md-sys-color-on-error-container, #410e0b));--_error-input-text-color: var(--md-outlined-text-field-error-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-label-text-color: var(--md-outlined-text-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_error-leading-icon-color: var(--md-outlined-text-field-error-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-outline-color: var(--md-outlined-text-field-error-outline-color, var(--md-sys-color-error, #b3261e));--_error-supporting-text-color: var(--md-outlined-text-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-trailing-icon-color: var(--md-outlined-text-field-error-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_focus-input-text-color: var(--md-outlined-text-field-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_focus-label-text-color: var(--md-outlined-text-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_focus-leading-icon-color: var(--md-outlined-text-field-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-outline-color: var(--md-outlined-text-field-focus-outline-color, var(--md-sys-color-primary, #6750a4));--_focus-outline-width: var(--md-outlined-text-field-focus-outline-width, 3px);--_focus-supporting-text-color: var(--md-outlined-text-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-trailing-icon-color: var(--md-outlined-text-field-focus-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-input-text-color: var(--md-outlined-text-field-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-outlined-text-field-hover-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-leading-icon-color: var(--md-outlined-text-field-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-outline-color: var(--md-outlined-text-field-hover-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-outline-width: var(--md-outlined-text-field-hover-outline-width, 1px);--_hover-supporting-text-color: var(--md-outlined-text-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-icon-color: var(--md-outlined-text-field-hover-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-color: var(--md-outlined-text-field-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_input-text-font: var(--md-outlined-text-field-input-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_input-text-line-height: var(--md-outlined-text-field-input-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_input-text-placeholder-color: var(--md-outlined-text-field-input-text-placeholder-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-prefix-color: var(--md-outlined-text-field-input-text-prefix-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-size: var(--md-outlined-text-field-input-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_input-text-suffix-color: var(--md-outlined-text-field-input-text-suffix-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-weight: var(--md-outlined-text-field-input-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_label-text-color: var(--md-outlined-text-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-font: var(--md-outlined-text-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-outlined-text-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_label-text-populated-line-height: var(--md-outlined-text-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_label-text-populated-size: var(--md-outlined-text-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_label-text-size: var(--md-outlined-text-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_label-text-weight: var(--md-outlined-text-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_leading-icon-color: var(--md-outlined-text-field-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_leading-icon-size: var(--md-outlined-text-field-leading-icon-size, 24px);--_outline-color: var(--md-outlined-text-field-outline-color, var(--md-sys-color-outline, #79747e));--_outline-width: var(--md-outlined-text-field-outline-width, 1px);--_supporting-text-color: var(--md-outlined-text-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_supporting-text-font: var(--md-outlined-text-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_supporting-text-line-height: var(--md-outlined-text-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_supporting-text-size: var(--md-outlined-text-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_supporting-text-weight: var(--md-outlined-text-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_trailing-icon-color: var(--md-outlined-text-field-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-icon-size: var(--md-outlined-text-field-trailing-icon-size, 24px);--_container-shape-start-start: var(--md-outlined-text-field-container-shape-start-start, var(--md-outlined-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-start-end: var(--md-outlined-text-field-container-shape-start-end, var(--md-outlined-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-end: var(--md-outlined-text-field-container-shape-end-end, var(--md-outlined-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-start: var(--md-outlined-text-field-container-shape-end-start, var(--md-outlined-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_leading-space: var(--md-outlined-text-field-leading-space, 16px);--_trailing-space: var(--md-outlined-text-field-trailing-space, 16px);--_top-space: var(--md-outlined-text-field-top-space, 16px);--_bottom-space: var(--md-outlined-text-field-bottom-space, 16px);--_input-text-prefix-trailing-space: var(--md-outlined-text-field-input-text-prefix-trailing-space, 2px);--_input-text-suffix-leading-space: var(--md-outlined-text-field-input-text-suffix-leading-space, 2px);--_focus-caret-color: var(--md-outlined-text-field-focus-caret-color, var(--md-sys-color-primary, #6750a4));--md-outlined-field-bottom-space: var(--_bottom-space);--md-outlined-field-container-shape-end-end: var(--_container-shape-end-end);--md-outlined-field-container-shape-end-start: var(--_container-shape-end-start);--md-outlined-field-container-shape-start-end: var(--_container-shape-start-end);--md-outlined-field-container-shape-start-start: var(--_container-shape-start-start);--md-outlined-field-content-color: var(--_input-text-color);--md-outlined-field-content-font: var(--_input-text-font);--md-outlined-field-content-line-height: var(--_input-text-line-height);--md-outlined-field-content-size: var(--_input-text-size);--md-outlined-field-content-weight: var(--_input-text-weight);--md-outlined-field-disabled-content-color: var(--_disabled-input-text-color);--md-outlined-field-disabled-content-opacity: var(--_disabled-input-text-opacity);--md-outlined-field-disabled-label-text-color: var(--_disabled-label-text-color);--md-outlined-field-disabled-label-text-opacity: var(--_disabled-label-text-opacity);--md-outlined-field-disabled-leading-content-color: var(--_disabled-leading-icon-color);--md-outlined-field-disabled-leading-content-opacity: var(--_disabled-leading-icon-opacity);--md-outlined-field-disabled-outline-color: var(--_disabled-outline-color);--md-outlined-field-disabled-outline-opacity: var(--_disabled-outline-opacity);--md-outlined-field-disabled-outline-width: var(--_disabled-outline-width);--md-outlined-field-disabled-supporting-text-color: var(--_disabled-supporting-text-color);--md-outlined-field-disabled-supporting-text-opacity: var(--_disabled-supporting-text-opacity);--md-outlined-field-disabled-trailing-content-color: var(--_disabled-trailing-icon-color);--md-outlined-field-disabled-trailing-content-opacity: var(--_disabled-trailing-icon-opacity);--md-outlined-field-error-content-color: var(--_error-input-text-color);--md-outlined-field-error-focus-content-color: var(--_error-focus-input-text-color);--md-outlined-field-error-focus-label-text-color: var(--_error-focus-label-text-color);--md-outlined-field-error-focus-leading-content-color: var(--_error-focus-leading-icon-color);--md-outlined-field-error-focus-outline-color: var(--_error-focus-outline-color);--md-outlined-field-error-focus-supporting-text-color: var(--_error-focus-supporting-text-color);--md-outlined-field-error-focus-trailing-content-color: var(--_error-focus-trailing-icon-color);--md-outlined-field-error-hover-content-color: var(--_error-hover-input-text-color);--md-outlined-field-error-hover-label-text-color: var(--_error-hover-label-text-color);--md-outlined-field-error-hover-leading-content-color: var(--_error-hover-leading-icon-color);--md-outlined-field-error-hover-outline-color: var(--_error-hover-outline-color);--md-outlined-field-error-hover-supporting-text-color: var(--_error-hover-supporting-text-color);--md-outlined-field-error-hover-trailing-content-color: var(--_error-hover-trailing-icon-color);--md-outlined-field-error-label-text-color: var(--_error-label-text-color);--md-outlined-field-error-leading-content-color: var(--_error-leading-icon-color);--md-outlined-field-error-outline-color: var(--_error-outline-color);--md-outlined-field-error-supporting-text-color: var(--_error-supporting-text-color);--md-outlined-field-error-trailing-content-color: var(--_error-trailing-icon-color);--md-outlined-field-focus-content-color: var(--_focus-input-text-color);--md-outlined-field-focus-label-text-color: var(--_focus-label-text-color);--md-outlined-field-focus-leading-content-color: var(--_focus-leading-icon-color);--md-outlined-field-focus-outline-color: var(--_focus-outline-color);--md-outlined-field-focus-outline-width: var(--_focus-outline-width);--md-outlined-field-focus-supporting-text-color: var(--_focus-supporting-text-color);--md-outlined-field-focus-trailing-content-color: var(--_focus-trailing-icon-color);--md-outlined-field-hover-content-color: var(--_hover-input-text-color);--md-outlined-field-hover-label-text-color: var(--_hover-label-text-color);--md-outlined-field-hover-leading-content-color: var(--_hover-leading-icon-color);--md-outlined-field-hover-outline-color: var(--_hover-outline-color);--md-outlined-field-hover-outline-width: var(--_hover-outline-width);--md-outlined-field-hover-supporting-text-color: var(--_hover-supporting-text-color);--md-outlined-field-hover-trailing-content-color: var(--_hover-trailing-icon-color);--md-outlined-field-label-text-color: var(--_label-text-color);--md-outlined-field-label-text-font: var(--_label-text-font);--md-outlined-field-label-text-line-height: var(--_label-text-line-height);--md-outlined-field-label-text-populated-line-height: var(--_label-text-populated-line-height);--md-outlined-field-label-text-populated-size: var(--_label-text-populated-size);--md-outlined-field-label-text-size: var(--_label-text-size);--md-outlined-field-label-text-weight: var(--_label-text-weight);--md-outlined-field-leading-content-color: var(--_leading-icon-color);--md-outlined-field-leading-space: var(--_leading-space);--md-outlined-field-outline-color: var(--_outline-color);--md-outlined-field-outline-width: var(--_outline-width);--md-outlined-field-supporting-text-color: var(--_supporting-text-color);--md-outlined-field-supporting-text-font: var(--_supporting-text-font);--md-outlined-field-supporting-text-line-height: var(--_supporting-text-line-height);--md-outlined-field-supporting-text-size: var(--_supporting-text-size);--md-outlined-field-supporting-text-weight: var(--_supporting-text-weight);--md-outlined-field-top-space: var(--_top-space);--md-outlined-field-trailing-content-color: var(--_trailing-icon-color);--md-outlined-field-trailing-space: var(--_trailing-space)}
`,Xp={},Kp=Pp(class extends Rp{constructor(t){if(super(t),t.type!==Mp&&t.type!==Ip&&t.type!==Lp)throw Error("The `live` directive is not allowed on child or event bindings");if(!(t=>void 0===t.strings)(t))throw Error("`live` bindings can only contain a single expression")}render(t){return t}update(t,[e]){if(e===hp||e===pp)return e;const i=t.element,r=t.name;if(t.type===Mp){if(e===i[r])return hp}else if(t.type===Lp){if(!!e===i.hasAttribute(r))return hp}else if(t.type===Ip&&i.getAttribute(r)===e+"")return hp;return((t,e=Xp)=>{t._$AH=e})(t),e}}),Jp="important",Qp=" !"+Jp,tu=Pp(class extends Rp{constructor(t){if(super(t),t.type!==Ip||"style"!==t.name||t.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce(((e,i)=>{const r=t[i];return null==r?e:e+`${i=i.includes("-")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`}),"")}update(t,[e]){const{style:i}=t.element;if(void 0===this.ut)return this.ut=new Set(Object.keys(e)),this.render(e);for(const t of this.ut)null==e[t]&&(this.ut.delete(t),t.includes("-")?i.removeProperty(t):i[t]=null);for(const t in e){const r=e[t];if(null!=r){this.ut.add(t);const e="string"==typeof r&&r.endsWith(Qp);t.includes("-")||e?i.setProperty(t,e?r.slice(0,-11):r,e?Jp:""):i[t]=r}}return hp}}),eu=["ariaAtomic","ariaAutoComplete","ariaBusy","ariaChecked","ariaColCount","ariaColIndex","ariaColSpan","ariaCurrent","ariaDisabled","ariaExpanded","ariaHasPopup","ariaHidden","ariaInvalid","ariaKeyShortcuts","ariaLabel","ariaLevel","ariaLive","ariaModal","ariaMultiLine","ariaMultiSelectable","ariaOrientation","ariaPlaceholder","ariaPosInSet","ariaPressed","ariaReadOnly","ariaRequired","ariaRoleDescription","ariaRowCount","ariaRowIndex","ariaRowSpan","ariaSelected","ariaSetSize","ariaSort","ariaValueMax","ariaValueMin","ariaValueNow","ariaValueText"];function iu(t){return t.replace("aria","aria-").replace(/Elements?/g,"").toLowerCase()}function ru(t){for(const e of eu)t.createProperty(e,{attribute:iu(e),reflect:!0});t.addInitializer((t=>{const e={hostConnected(){t.setAttribute("role","presentation")}};t.addController(e)}))}eu.map(iu);const nu={fromAttribute:t=>t??"",toAttribute:t=>t||null};function au(t,e){!e.bubbles||t.shadowRoot&&!e.composed||e.stopPropagation();const i=Reflect.construct(e.constructor,[e.type,e]),r=t.dispatchEvent(i);return r||e.preventDefault(),r}const su=Symbol("internals"),ou=Symbol("privateInternals");function lu(t){return class extends t{get[su](){return this[ou]||(this[ou]=this.attachInternals()),this[ou]}}}const cu=Symbol("createValidator"),du=Symbol("getValidityAnchor"),hu=Symbol("privateValidator"),pu=Symbol("privateSyncValidity"),uu=Symbol("privateCustomValidationMessage");function mu(t){var e;class i extends t{constructor(){super(...arguments),this[e]=""}get validity(){return this[pu](),this[su].validity}get validationMessage(){return this[pu](),this[su].validationMessage}get willValidate(){return this[pu](),this[su].willValidate}checkValidity(){return this[pu](),this[su].checkValidity()}reportValidity(){return this[pu](),this[su].reportValidity()}setCustomValidity(t){this[uu]=t,this[pu]()}requestUpdate(t,e,i){super.requestUpdate(t,e,i),this[pu]()}firstUpdated(t){super.firstUpdated(t),this[pu]()}[(e=uu,pu)](){this[hu]||(this[hu]=this[cu]());const{validity:t,validationMessage:e}=this[hu].getValidity(),i=!!this[uu],r=this[uu]||e;this[su].setValidity({...t,customError:i},r,this[du]()??void 0)}[cu](){throw new Error("Implement [createValidator]")}[du](){throw new Error("Implement [getValidityAnchor]")}}return i}const fu=Symbol("getFormValue"),gu=Symbol("getFormState");function _u(t){class e extends t{get form(){return this[su].form}get labels(){return this[su].labels}get name(){return this.getAttribute("name")??""}set name(t){this.setAttribute("name",t)}get disabled(){return this.hasAttribute("disabled")}set disabled(t){this.toggleAttribute("disabled",t)}attributeChangedCallback(t,e,i){if("name"!==t&&"disabled"!==t)super.attributeChangedCallback(t,e,i);else{const i="disabled"===t?null!==e:e;this.requestUpdate(t,i)}}requestUpdate(t,e,i){super.requestUpdate(t,e,i),this[su].setFormValue(this[fu](),this[gu]())}[fu](){throw new Error("Implement [getFormValue]")}[gu](){return this[fu]()}formDisabledCallback(t){this.disabled=t}}return e.formAssociated=!0,it([jh({noAccessor:!0})],e.prototype,"name",null),it([jh({type:Boolean,noAccessor:!0})],e.prototype,"disabled",null),e}const vu=Symbol("onReportValidity"),yu=Symbol("privateCleanupFormListeners"),bu=Symbol("privateDoNotReportInvalid"),xu=Symbol("privateIsSelfReportingValidity"),wu=Symbol("privateCallOnReportValidity");function ku(t){var e,i,r;class n extends t{constructor(...t){super(...t),this[e]=new AbortController,this[i]=!1,this[r]=!1,this.addEventListener("invalid",(t=>{!this[bu]&&t.isTrusted&&this.addEventListener("invalid",(()=>{this[wu](t)}),{once:!0})}),{capture:!0})}checkValidity(){this[bu]=!0;const t=super.checkValidity();return this[bu]=!1,t}reportValidity(){this[xu]=!0;const t=super.reportValidity();return t&&this[wu](null),this[xu]=!1,t}[(e=yu,i=bu,r=xu,wu)](t){const e=t?.defaultPrevented;if(e)return;this[vu](t);!e&&t?.defaultPrevented&&(this[xu]||function(t,e){if(!t)return!0;let i;for(const e of t.elements)if(e.matches(":invalid")){i=e;break}return i===e}(this[su].form,this))&&this.focus()}[vu](t){throw new Error("Implement [onReportValidity]")}formAssociatedCallback(t){super.formAssociatedCallback&&super.formAssociatedCallback(t),this[yu].abort(),t&&(this[yu]=new AbortController,function(t,e,i,r){const n=function(t){if(!Tu.has(t)){const e=new EventTarget;Tu.set(t,e);for(const i of["reportValidity","requestSubmit"]){const r=t[i];t[i]=function(){e.dispatchEvent(new Event("before"));const t=Reflect.apply(r,this,arguments);return e.dispatchEvent(new Event("after")),t}}}return Tu.get(t)}(e);let a,s=!1,o=!1;n.addEventListener("before",(()=>{o=!0,a=new AbortController,s=!1,t.addEventListener("invalid",(()=>{s=!0}),{signal:a.signal})}),{signal:r}),n.addEventListener("after",(()=>{o=!1,a?.abort(),s||i()}),{signal:r}),e.addEventListener("submit",(()=>{o||i()}),{signal:r})}(this,t,(()=>{this[wu](null)}),this[yu].signal))}}return n}const Tu=new WeakMap;class Su{constructor(t){this.getCurrentState=t,this.currentValidity={validity:{},validationMessage:""}}getValidity(){const t=this.getCurrentState();if(!(!this.prevState||!this.equals(this.prevState,t)))return this.currentValidity;const{validity:e,validationMessage:i}=this.computeValidity(t);return this.prevState=this.copy(t),this.currentValidity={validationMessage:i,validity:{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing}},this.currentValidity}}class Cu extends Su{computeValidity({state:t,renderedControl:e}){let i=e;Eu(t)&&!i?(i=this.inputControl||document.createElement("input"),this.inputControl=i):i||(i=this.textAreaControl||document.createElement("textarea"),this.textAreaControl=i);const r=Eu(t)?i:null;if(r&&(r.type=t.type),i.value!==t.value&&(i.value=t.value),i.required=t.required,r){const e=t;e.pattern?r.pattern=e.pattern:r.removeAttribute("pattern"),e.min?r.min=e.min:r.removeAttribute("min"),e.max?r.max=e.max:r.removeAttribute("max"),e.step?r.step=e.step:r.removeAttribute("step")}return(t.minLength??-1)>-1?i.setAttribute("minlength",String(t.minLength)):i.removeAttribute("minlength"),(t.maxLength??-1)>-1?i.setAttribute("maxlength",String(t.maxLength)):i.removeAttribute("maxlength"),{validity:i.validity,validationMessage:i.validationMessage}}equals({state:t},{state:e}){const i=t.type===e.type&&t.value===e.value&&t.required===e.required&&t.minLength===e.minLength&&t.maxLength===e.maxLength;return Eu(t)&&Eu(e)?i&&t.pattern===e.pattern&&t.min===e.min&&t.max===e.max&&t.step===e.step:i}copy({state:t}){return{state:Eu(t)?this.copyInput(t):this.copyTextArea(t),renderedControl:null}}copyInput(t){const{type:e,pattern:i,min:r,max:n,step:a}=t;return{...this.copySharedState(t),type:e,pattern:i,min:r,max:n,step:a}}copyTextArea(t){return{...this.copySharedState(t),type:t.type}}copySharedState({value:t,required:e,minLength:i,maxLength:r}){return{value:t,required:e,minLength:i,maxLength:r}}}function Eu(t){return"textarea"!==t.type}const $u=ku(mu(_u(lu($p))));class Au extends $u{constructor(){super(...arguments),this.error=!1,this.errorText="",this.label="",this.required=!1,this.value="",this.prefixText="",this.suffixText="",this.hasLeadingIcon=!1,this.hasTrailingIcon=!1,this.supportingText="",this.textDirection="",this.rows=2,this.cols=20,this.inputMode="",this.max="",this.maxLength=-1,this.min="",this.minLength=-1,this.noSpinner=!1,this.pattern="",this.placeholder="",this.readOnly=!1,this.multiple=!1,this.step="",this.type="text",this.autocomplete="",this.dirty=!1,this.focused=!1,this.nativeError=!1,this.nativeErrorText=""}get selectionDirection(){return this.getInputOrTextarea().selectionDirection}set selectionDirection(t){this.getInputOrTextarea().selectionDirection=t}get selectionEnd(){return this.getInputOrTextarea().selectionEnd}set selectionEnd(t){this.getInputOrTextarea().selectionEnd=t}get selectionStart(){return this.getInputOrTextarea().selectionStart}set selectionStart(t){this.getInputOrTextarea().selectionStart=t}get valueAsNumber(){const t=this.getInput();return t?t.valueAsNumber:NaN}set valueAsNumber(t){const e=this.getInput();e&&(e.valueAsNumber=t,this.value=e.value)}get valueAsDate(){const t=this.getInput();return t?t.valueAsDate:null}set valueAsDate(t){const e=this.getInput();e&&(e.valueAsDate=t,this.value=e.value)}get hasError(){return this.error||this.nativeError}select(){this.getInputOrTextarea().select()}setRangeText(...t){this.getInputOrTextarea().setRangeText(...t),this.value=this.getInputOrTextarea().value}setSelectionRange(t,e,i){this.getInputOrTextarea().setSelectionRange(t,e,i)}stepDown(t){const e=this.getInput();e&&(e.stepDown(t),this.value=e.value)}stepUp(t){const e=this.getInput();e&&(e.stepUp(t),this.value=e.value)}reset(){this.dirty=!1,this.value=this.getAttribute("value")??"",this.nativeError=!1,this.nativeErrorText=""}attributeChangedCallback(t,e,i){"value"===t&&this.dirty||super.attributeChangedCallback(t,e,i)}render(){const t={disabled:this.disabled,error:!this.disabled&&this.hasError,textarea:"textarea"===this.type,"no-spinner":this.noSpinner};return dp`
      <span class="text-field ${zp(t)}">
        ${this.renderField()}
      </span>
    `}updated(t){const e=this.getInputOrTextarea().value;this.value!==e&&(this.value=e)}renderField(){return Wp`<${this.fieldTag}
      class="field"
      count=${this.value.length}
      ?disabled=${this.disabled}
      ?error=${this.hasError}
      error-text=${this.getErrorText()}
      ?focused=${this.focused}
      ?has-end=${this.hasTrailingIcon}
      ?has-start=${this.hasLeadingIcon}
      label=${this.label}
      max=${this.maxLength}
      ?populated=${!!this.value}
      ?required=${this.required}
      ?resizable=${"textarea"===this.type}
      supporting-text=${this.supportingText}
    >
      ${this.renderLeadingIcon()}
      ${this.renderInputOrTextarea()}
      ${this.renderTrailingIcon()}
      <div id="description" slot="aria-describedby"></div>
    </${this.fieldTag}>`}renderLeadingIcon(){return dp`
      <span class="icon leading" slot="start">
        <slot name="leading-icon" @slotchange=${this.handleIconChange}></slot>
      </span>
    `}renderTrailingIcon(){return dp`
      <span class="icon trailing" slot="end">
        <slot name="trailing-icon" @slotchange=${this.handleIconChange}></slot>
      </span>
    `}renderInputOrTextarea(){const t={direction:this.textDirection},e=this.ariaLabel||this.label||pp,i=this.autocomplete,r=(this.maxLength??-1)>-1,n=(this.minLength??-1)>-1;if("textarea"===this.type)return dp`
        <textarea
          class="input"
          style=${tu(t)}
          aria-describedby="description"
          aria-invalid=${this.hasError}
          aria-label=${e}
          autocomplete=${i||pp}
          ?disabled=${this.disabled}
          maxlength=${r?this.maxLength:pp}
          minlength=${n?this.minLength:pp}
          placeholder=${this.placeholder||pp}
          ?readonly=${this.readOnly}
          ?required=${this.required}
          rows=${this.rows}
          cols=${this.cols}
          .value=${Kp(this.value)}
          @change=${this.redispatchEvent}
          @focus=${this.handleFocusChange}
          @blur=${this.handleFocusChange}
          @input=${this.handleInput}
          @select=${this.redispatchEvent}></textarea>
      `;const a=this.renderPrefix(),s=this.renderSuffix(),o=this.inputMode;return dp`
      <div class="input-wrapper">
        ${a}
        <input
          class="input"
          style=${tu(t)}
          aria-describedby="description"
          aria-invalid=${this.hasError}
          aria-label=${e}
          autocomplete=${i||pp}
          ?disabled=${this.disabled}
          inputmode=${o||pp}
          max=${this.max||pp}
          maxlength=${r?this.maxLength:pp}
          min=${this.min||pp}
          minlength=${n?this.minLength:pp}
          pattern=${this.pattern||pp}
          placeholder=${this.placeholder||pp}
          ?readonly=${this.readOnly}
          ?required=${this.required}
          ?multiple=${this.multiple}
          step=${this.step||pp}
          type=${this.type}
          .value=${Kp(this.value)}
          @change=${this.redispatchEvent}
          @focus=${this.handleFocusChange}
          @blur=${this.handleFocusChange}
          @input=${this.handleInput}
          @select=${this.redispatchEvent} />
        ${s}
      </div>
    `}renderPrefix(){return this.renderAffix(this.prefixText,!1)}renderSuffix(){return this.renderAffix(this.suffixText,!0)}renderAffix(t,e){if(!t)return pp;return dp`<span class="${zp({suffix:e,prefix:!e})}">${t}</span>`}getErrorText(){return this.error?this.errorText:this.nativeErrorText}handleFocusChange(){this.focused=this.inputOrTextarea?.matches(":focus")??!1}handleInput(t){this.dirty=!0,this.value=t.target.value}redispatchEvent(t){au(this,t)}getInputOrTextarea(){return this.inputOrTextarea||(this.connectedCallback(),this.scheduleUpdate()),this.isUpdatePending&&this.scheduleUpdate(),this.inputOrTextarea}getInput(){return"textarea"===this.type?null:this.getInputOrTextarea()}handleIconChange(){this.hasLeadingIcon=this.leadingIcons.length>0,this.hasTrailingIcon=this.trailingIcons.length>0}[fu](){return this.value}formResetCallback(){this.reset()}formStateRestoreCallback(t){this.value=t}focus(){this.getInputOrTextarea().focus()}[cu](){return new Cu((()=>({state:this,renderedControl:this.inputOrTextarea})))}[du](){return this.inputOrTextarea}[vu](t){t?.preventDefault();const e=this.getErrorText();this.nativeError=!!t,this.nativeErrorText=this.validationMessage,e===this.getErrorText()&&this.field?.reannounceError()}}ru(Au),Au.shadowRootOptions={...$p.shadowRootOptions,delegatesFocus:!0},it([jh({type:Boolean,reflect:!0})],Au.prototype,"error",void 0),it([jh({attribute:"error-text"})],Au.prototype,"errorText",void 0),it([jh()],Au.prototype,"label",void 0),it([jh({type:Boolean,reflect:!0})],Au.prototype,"required",void 0),it([jh()],Au.prototype,"value",void 0),it([jh({attribute:"prefix-text"})],Au.prototype,"prefixText",void 0),it([jh({attribute:"suffix-text"})],Au.prototype,"suffixText",void 0),it([jh({type:Boolean,attribute:"has-leading-icon"})],Au.prototype,"hasLeadingIcon",void 0),it([jh({type:Boolean,attribute:"has-trailing-icon"})],Au.prototype,"hasTrailingIcon",void 0),it([jh({attribute:"supporting-text"})],Au.prototype,"supportingText",void 0),it([jh({attribute:"text-direction"})],Au.prototype,"textDirection",void 0),it([jh({type:Number})],Au.prototype,"rows",void 0),it([jh({type:Number})],Au.prototype,"cols",void 0),it([jh({reflect:!0})],Au.prototype,"inputMode",void 0),it([jh()],Au.prototype,"max",void 0),it([jh({type:Number})],Au.prototype,"maxLength",void 0),it([jh()],Au.prototype,"min",void 0),it([jh({type:Number})],Au.prototype,"minLength",void 0),it([jh({type:Boolean,attribute:"no-spinner"})],Au.prototype,"noSpinner",void 0),it([jh()],Au.prototype,"pattern",void 0),it([jh({reflect:!0,converter:nu})],Au.prototype,"placeholder",void 0),it([jh({type:Boolean,reflect:!0})],Au.prototype,"readOnly",void 0),it([jh({type:Boolean,reflect:!0})],Au.prototype,"multiple",void 0),it([jh()],Au.prototype,"step",void 0),it([jh({reflect:!0})],Au.prototype,"type",void 0),it([jh({reflect:!0})],Au.prototype,"autocomplete",void 0),it([Oh()],Au.prototype,"dirty",void 0),it([Oh()],Au.prototype,"focused",void 0),it([Oh()],Au.prototype,"nativeError",void 0),it([Oh()],Au.prototype,"nativeErrorText",void 0),it([Fh(".input")],Au.prototype,"inputOrTextarea",void 0),it([Fh(".field")],Au.prototype,"field",void 0),it([Vh({slot:"leading-icon"})],Au.prototype,"leadingIcons",void 0),it([Vh({slot:"trailing-icon"})],Au.prototype,"trailingIcons",void 0);class Iu extends Au{constructor(){super(...arguments),this.fieldTag=Zp`md-outlined-field`}}const Mu=vh`:host{display:inline-flex;outline:none;resize:both;text-align:start;-webkit-tap-highlight-color:rgba(0,0,0,0)}.text-field,.field{width:100%}.text-field{display:inline-flex}.field{cursor:text}.disabled .field{cursor:default}.text-field,.textarea .field{resize:inherit}.icon{color:currentColor;display:flex;fill:currentColor}.icon ::slotted(*){display:flex}[hasstart] .icon.leading{font-size:var(--_leading-icon-size);height:var(--_leading-icon-size);width:var(--_leading-icon-size)}[hasend] .icon.trailing{font-size:var(--_trailing-icon-size);height:var(--_trailing-icon-size);width:var(--_trailing-icon-size)}.input-wrapper{display:flex}.input-wrapper>*{all:inherit;padding:0}.input{caret-color:var(--_caret-color);overflow-x:hidden;text-align:inherit}.input::placeholder{color:currentColor;opacity:1}.input::-webkit-calendar-picker-indicator{display:none}.input::-webkit-search-decoration,.input::-webkit-search-cancel-button{display:none}@media(forced-colors: active){.input{background:none}}.no-spinner .input::-webkit-inner-spin-button,.no-spinner .input::-webkit-outer-spin-button{display:none}.no-spinner .input[type=number]{-moz-appearance:textfield}:focus-within .input{caret-color:var(--_focus-caret-color)}.error:focus-within .input{caret-color:var(--_error-focus-caret-color)}.text-field:not(.disabled) .prefix{color:var(--_input-text-prefix-color)}.text-field:not(.disabled) .suffix{color:var(--_input-text-suffix-color)}.text-field:not(.disabled) .input::placeholder{color:var(--_input-text-placeholder-color)}.prefix,.suffix{text-wrap:nowrap;width:min-content}.prefix{padding-inline-end:var(--_input-text-prefix-trailing-space)}.suffix{padding-inline-start:var(--_input-text-suffix-leading-space)}
`;let Lu=class extends Iu{constructor(){super(...arguments),this.fieldTag=Zp`md-outlined-field`}};Lu.styles=[Mu,Gp],Lu=it([ph("md-outlined-text-field")],Lu);class Pu extends $p{connectedCallback(){super.connectedCallback(),this.setAttribute("aria-hidden","true")}render(){return dp`<span class="shadow"></span>`}}const Ru=vh`:host,.shadow,.shadow::before,.shadow::after{border-radius:inherit;inset:0;position:absolute;transition-duration:inherit;transition-property:inherit;transition-timing-function:inherit}:host{display:flex;pointer-events:none;transition-property:box-shadow,opacity}.shadow::before,.shadow::after{content:"";transition-property:box-shadow,opacity;--_level: var(--md-elevation-level, 0);--_shadow-color: var(--md-elevation-shadow-color, var(--md-sys-color-shadow, #000))}.shadow::before{box-shadow:0px calc(1px*(clamp(0,var(--_level),1) + clamp(0,var(--_level) - 3,1) + 2*clamp(0,var(--_level) - 4,1))) calc(1px*(2*clamp(0,var(--_level),1) + clamp(0,var(--_level) - 2,1) + clamp(0,var(--_level) - 4,1))) 0px var(--_shadow-color);opacity:.3}.shadow::after{box-shadow:0px calc(1px*(clamp(0,var(--_level),1) + clamp(0,var(--_level) - 1,1) + 2*clamp(0,var(--_level) - 2,3))) calc(1px*(3*clamp(0,var(--_level),2) + 2*clamp(0,var(--_level) - 2,3))) calc(1px*(clamp(0,var(--_level),4) + 2*clamp(0,var(--_level) - 4,1))) var(--_shadow-color);opacity:.15}
`;let zu=class extends Pu{};zu.styles=[Ru],zu=it([ph("md-elevation")],zu);const Du=Symbol("attachableController");let ju;ju=new MutationObserver((t=>{for(const e of t)e.target[Du]?.hostConnected()}));class Ou{get htmlFor(){return this.host.getAttribute("for")}set htmlFor(t){null===t?this.host.removeAttribute("for"):this.host.setAttribute("for",t)}get control(){return this.host.hasAttribute("for")?this.htmlFor&&this.host.isConnected?this.host.getRootNode().querySelector(`#${this.htmlFor}`):null:this.currentControl||this.host.parentElement}set control(t){t?this.attach(t):this.detach()}constructor(t,e){this.host=t,this.onControlChange=e,this.currentControl=null,t.addController(this),t[Du]=this,ju?.observe(t,{attributeFilter:["for"]})}attach(t){t!==this.currentControl&&(this.setCurrentControl(t),this.host.removeAttribute("for"))}detach(){this.setCurrentControl(null),this.host.setAttribute("for","")}hostConnected(){this.setCurrentControl(this.control)}hostDisconnected(){this.setCurrentControl(null)}setCurrentControl(t){this.onControlChange(this.currentControl,t),this.currentControl=t}}const Bu=["focusin","focusout","pointerdown"];class Fu extends $p{constructor(){super(...arguments),this.visible=!1,this.inward=!1,this.attachableController=new Ou(this,this.onControlChange.bind(this))}get htmlFor(){return this.attachableController.htmlFor}set htmlFor(t){this.attachableController.htmlFor=t}get control(){return this.attachableController.control}set control(t){this.attachableController.control=t}attach(t){this.attachableController.attach(t)}detach(){this.attachableController.detach()}connectedCallback(){super.connectedCallback(),this.setAttribute("aria-hidden","true")}handleEvent(t){if(!t[Nu]){switch(t.type){default:return;case"focusin":this.visible=this.control?.matches(":focus-visible")??!1;break;case"focusout":case"pointerdown":this.visible=!1}t[Nu]=!0}}onControlChange(t,e){for(const i of Bu)t?.removeEventListener(i,this),e?.addEventListener(i,this)}update(t){t.has("visible")&&this.dispatchEvent(new Event("visibility-changed")),super.update(t)}}it([jh({type:Boolean,reflect:!0})],Fu.prototype,"visible",void 0),it([jh({type:Boolean,reflect:!0})],Fu.prototype,"inward",void 0);const Nu=Symbol("handledByFocusRing"),Hu=vh`:host{animation-delay:0s,calc(var(--md-focus-ring-duration, 600ms)*.25);animation-duration:calc(var(--md-focus-ring-duration, 600ms)*.25),calc(var(--md-focus-ring-duration, 600ms)*.75);animation-timing-function:cubic-bezier(0.2, 0, 0, 1);box-sizing:border-box;color:var(--md-focus-ring-color, var(--md-sys-color-secondary, #625b71));display:none;pointer-events:none;position:absolute}:host([visible]){display:flex}:host(:not([inward])){animation-name:outward-grow,outward-shrink;border-end-end-radius:calc(var(--md-focus-ring-shape-end-end, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) + var(--md-focus-ring-outward-offset, 2px));border-end-start-radius:calc(var(--md-focus-ring-shape-end-start, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) + var(--md-focus-ring-outward-offset, 2px));border-start-end-radius:calc(var(--md-focus-ring-shape-start-end, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) + var(--md-focus-ring-outward-offset, 2px));border-start-start-radius:calc(var(--md-focus-ring-shape-start-start, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) + var(--md-focus-ring-outward-offset, 2px));inset:calc(-1*var(--md-focus-ring-outward-offset, 2px));outline:var(--md-focus-ring-width, 3px) solid currentColor}:host([inward]){animation-name:inward-grow,inward-shrink;border-end-end-radius:calc(var(--md-focus-ring-shape-end-end, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) - var(--md-focus-ring-inward-offset, 0px));border-end-start-radius:calc(var(--md-focus-ring-shape-end-start, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) - var(--md-focus-ring-inward-offset, 0px));border-start-end-radius:calc(var(--md-focus-ring-shape-start-end, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) - var(--md-focus-ring-inward-offset, 0px));border-start-start-radius:calc(var(--md-focus-ring-shape-start-start, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) - var(--md-focus-ring-inward-offset, 0px));border:var(--md-focus-ring-width, 3px) solid currentColor;inset:var(--md-focus-ring-inward-offset, 0px)}@keyframes outward-grow{from{outline-width:0}to{outline-width:var(--md-focus-ring-active-width, 8px)}}@keyframes outward-shrink{from{outline-width:var(--md-focus-ring-active-width, 8px)}}@keyframes inward-grow{from{border-width:0}to{border-width:var(--md-focus-ring-active-width, 8px)}}@keyframes inward-shrink{from{border-width:var(--md-focus-ring-active-width, 8px)}}@media(prefers-reduced-motion){:host{animation:none}}
`;let Vu=class extends Fu{};Vu.styles=[Hu],Vu=it([ph("md-focus-ring")],Vu);var Uu;!function(t){t[t.INACTIVE=0]="INACTIVE",t[t.TOUCH_DELAY=1]="TOUCH_DELAY",t[t.HOLDING=2]="HOLDING",t[t.WAITING_FOR_CLICK=3]="WAITING_FOR_CLICK"}(Uu||(Uu={}));const Yu=["click","contextmenu","pointercancel","pointerdown","pointerenter","pointerleave","pointerup"],Zu=window.matchMedia("(forced-colors: active)");class qu extends $p{constructor(){super(...arguments),this.disabled=!1,this.hovered=!1,this.pressed=!1,this.rippleSize="",this.rippleScale="",this.initialSize=0,this.state=Uu.INACTIVE,this.checkBoundsAfterContextMenu=!1,this.attachableController=new Ou(this,this.onControlChange.bind(this))}get htmlFor(){return this.attachableController.htmlFor}set htmlFor(t){this.attachableController.htmlFor=t}get control(){return this.attachableController.control}set control(t){this.attachableController.control=t}attach(t){this.attachableController.attach(t)}detach(){this.attachableController.detach()}connectedCallback(){super.connectedCallback(),this.setAttribute("aria-hidden","true")}render(){const t={hovered:this.hovered,pressed:this.pressed};return dp`<div class="surface ${zp(t)}"></div>`}update(t){t.has("disabled")&&this.disabled&&(this.hovered=!1,this.pressed=!1),super.update(t)}handlePointerenter(t){this.shouldReactToEvent(t)&&(this.hovered=!0)}handlePointerleave(t){this.shouldReactToEvent(t)&&(this.hovered=!1,this.state!==Uu.INACTIVE&&this.endPressAnimation())}handlePointerup(t){if(this.shouldReactToEvent(t)){if(this.state!==Uu.HOLDING)return this.state===Uu.TOUCH_DELAY?(this.state=Uu.WAITING_FOR_CLICK,void this.startPressAnimation(this.rippleStartEvent)):void 0;this.state=Uu.WAITING_FOR_CLICK}}async handlePointerdown(t){if(this.shouldReactToEvent(t)){if(this.rippleStartEvent=t,!this.isTouch(t))return this.state=Uu.WAITING_FOR_CLICK,void this.startPressAnimation(t);this.checkBoundsAfterContextMenu&&!this.inBounds(t)||(this.checkBoundsAfterContextMenu=!1,this.state=Uu.TOUCH_DELAY,await new Promise((t=>{setTimeout(t,150)})),this.state===Uu.TOUCH_DELAY&&(this.state=Uu.HOLDING,this.startPressAnimation(t)))}}handleClick(){this.disabled||(this.state!==Uu.WAITING_FOR_CLICK?this.state===Uu.INACTIVE&&(this.startPressAnimation(),this.endPressAnimation()):this.endPressAnimation())}handlePointercancel(t){this.shouldReactToEvent(t)&&this.endPressAnimation()}handleContextmenu(){this.disabled||(this.checkBoundsAfterContextMenu=!0,this.endPressAnimation())}determineRippleSize(){const{height:t,width:e}=this.getBoundingClientRect(),i=Math.max(t,e),r=Math.max(.35*i,75),n=Math.floor(.2*i),a=Math.sqrt(e**2+t**2)+10;this.initialSize=n,this.rippleScale=""+(a+r)/n,this.rippleSize=`${n}px`}getNormalizedPointerEventCoords(t){const{scrollX:e,scrollY:i}=window,{left:r,top:n}=this.getBoundingClientRect(),a=e+r,s=i+n,{pageX:o,pageY:l}=t;return{x:o-a,y:l-s}}getTranslationCoordinates(t){const{height:e,width:i}=this.getBoundingClientRect(),r={x:(i-this.initialSize)/2,y:(e-this.initialSize)/2};let n;return n=t instanceof PointerEvent?this.getNormalizedPointerEventCoords(t):{x:i/2,y:e/2},n={x:n.x-this.initialSize/2,y:n.y-this.initialSize/2},{startPoint:n,endPoint:r}}startPressAnimation(t){if(!this.mdRoot)return;this.pressed=!0,this.growAnimation?.cancel(),this.determineRippleSize();const{startPoint:e,endPoint:i}=this.getTranslationCoordinates(t),r=`${e.x}px, ${e.y}px`,n=`${i.x}px, ${i.y}px`;this.growAnimation=this.mdRoot.animate({top:[0,0],left:[0,0],height:[this.rippleSize,this.rippleSize],width:[this.rippleSize,this.rippleSize],transform:[`translate(${r}) scale(1)`,`translate(${n}) scale(${this.rippleScale})`]},{pseudoElement:"::after",duration:450,easing:Dp,fill:"forwards"})}async endPressAnimation(){this.rippleStartEvent=void 0,this.state=Uu.INACTIVE;const t=this.growAnimation;let e=1/0;"number"==typeof t?.currentTime?e=t.currentTime:t?.currentTime&&(e=t.currentTime.to("ms").value),e>=225?this.pressed=!1:(await new Promise((t=>{setTimeout(t,225-e)})),this.growAnimation===t&&(this.pressed=!1))}shouldReactToEvent(t){if(this.disabled||!t.isPrimary)return!1;if(this.rippleStartEvent&&this.rippleStartEvent.pointerId!==t.pointerId)return!1;if("pointerenter"===t.type||"pointerleave"===t.type)return!this.isTouch(t);const e=1===t.buttons;return this.isTouch(t)||e}inBounds({x:t,y:e}){const{top:i,left:r,bottom:n,right:a}=this.getBoundingClientRect();return t>=r&&t<=a&&e>=i&&e<=n}isTouch({pointerType:t}){return"touch"===t}async handleEvent(t){if(!Zu?.matches)switch(t.type){case"click":this.handleClick();break;case"contextmenu":this.handleContextmenu();break;case"pointercancel":this.handlePointercancel(t);break;case"pointerdown":await this.handlePointerdown(t);break;case"pointerenter":this.handlePointerenter(t);break;case"pointerleave":this.handlePointerleave(t);break;case"pointerup":this.handlePointerup(t)}}onControlChange(t,e){for(const i of Yu)t?.removeEventListener(i,this),e?.addEventListener(i,this)}}it([jh({type:Boolean,reflect:!0})],qu.prototype,"disabled",void 0),it([Oh()],qu.prototype,"hovered",void 0),it([Oh()],qu.prototype,"pressed",void 0),it([Fh(".surface")],qu.prototype,"mdRoot",void 0);const Wu=vh`:host{display:flex;margin:auto;pointer-events:none}:host([disabled]){display:none}@media(forced-colors: active){:host{display:none}}:host,.surface{border-radius:inherit;position:absolute;inset:0;overflow:hidden}.surface{-webkit-tap-highlight-color:rgba(0,0,0,0)}.surface::before,.surface::after{content:"";opacity:0;position:absolute}.surface::before{background-color:var(--md-ripple-hover-color, var(--md-sys-color-on-surface, #1d1b20));inset:0;transition:opacity 15ms linear,background-color 15ms linear}.surface::after{background:radial-gradient(closest-side, var(--md-ripple-pressed-color, var(--md-sys-color-on-surface, #1d1b20)) max(100% - 70px, 65%), transparent 100%);transform-origin:center center;transition:opacity 375ms linear}.hovered::before{background-color:var(--md-ripple-hover-color, var(--md-sys-color-on-surface, #1d1b20));opacity:var(--md-ripple-hover-opacity, 0.08)}.pressed::after{opacity:var(--md-ripple-pressed-opacity, 0.12);transition-duration:105ms}
`;let Gu=class extends qu{};function Xu(t){t.addInitializer((t=>{const e=t;e.addEventListener("click",(async t=>{const{type:i,[su]:r}=e,{form:n}=r;n&&"button"!==i&&(await new Promise((t=>{setTimeout(t)})),t.defaultPrevented||("reset"!==i?(n.addEventListener("submit",(t=>{Object.defineProperty(t,"submitter",{configurable:!0,enumerable:!0,get:()=>e})}),{capture:!0,once:!0}),r.setFormValue(e.value),n.requestSubmit()):n.reset()))}))}))}function Ku(t){const e=new MouseEvent("click",{bubbles:!0});return t.dispatchEvent(e),e}function Ju(t){return t.currentTarget===t.target&&(t.composedPath()[0]===t.target&&(!t.target.disabled&&!function(t){const e=Qu;e&&(t.preventDefault(),t.stopImmediatePropagation());return async function(){Qu=!0,await null,Qu=!1}(),e}(t)))}Gu.styles=[Wu],Gu=it([ph("md-ripple")],Gu);let Qu=!1;const tm=lu($p);class em extends tm{get name(){return this.getAttribute("name")??""}set name(t){this.setAttribute("name",t)}get form(){return this[su].form}constructor(){super(),this.disabled=!1,this.href="",this.target="",this.trailingIcon=!1,this.hasIcon=!1,this.type="submit",this.value="",this.handleActivationClick=t=>{Ju(t)&&this.buttonElement&&(this.focus(),Ku(this.buttonElement))},this.addEventListener("click",this.handleActivationClick)}focus(){this.buttonElement?.focus()}blur(){this.buttonElement?.blur()}render(){const t=this.disabled&&!this.href,e=this.href?this.renderLink():this.renderButton(),i=this.href?"link":"button";return dp`
      ${this.renderElevationOrOutline?.()}
      <div class="background"></div>
      <md-focus-ring part="focus-ring" for=${i}></md-focus-ring>
      <md-ripple for=${i} ?disabled="${t}"></md-ripple>
      ${e}
    `}renderButton(){const{ariaLabel:t,ariaHasPopup:e,ariaExpanded:i}=this;return dp`<button
      id="button"
      class="button"
      ?disabled=${this.disabled}
      aria-label="${t||pp}"
      aria-haspopup="${e||pp}"
      aria-expanded="${i||pp}">
      ${this.renderContent()}
    </button>`}renderLink(){const{ariaLabel:t,ariaHasPopup:e,ariaExpanded:i}=this;return dp`<a
      id="link"
      class="button"
      aria-label="${t||pp}"
      aria-haspopup="${e||pp}"
      aria-expanded="${i||pp}"
      href=${this.href}
      target=${this.target||pp}
      >${this.renderContent()}
    </a>`}renderContent(){const t=dp`<slot
      name="icon"
      @slotchange="${this.handleSlotChange}"></slot>`;return dp`
      <span class="touch"></span>
      ${this.trailingIcon?pp:t}
      <span class="label"><slot></slot></span>
      ${this.trailingIcon?t:pp}
    `}handleSlotChange(){this.hasIcon=this.assignedIcons.length>0}}ru(em),Xu(em),em.formAssociated=!0,em.shadowRootOptions={mode:"open",delegatesFocus:!0},it([jh({type:Boolean,reflect:!0})],em.prototype,"disabled",void 0),it([jh()],em.prototype,"href",void 0),it([jh()],em.prototype,"target",void 0),it([jh({type:Boolean,attribute:"trailing-icon",reflect:!0})],em.prototype,"trailingIcon",void 0),it([jh({type:Boolean,attribute:"has-icon",reflect:!0})],em.prototype,"hasIcon",void 0),it([jh()],em.prototype,"type",void 0),it([jh({reflect:!0})],em.prototype,"value",void 0),it([Fh(".button")],em.prototype,"buttonElement",void 0),it([Vh({slot:"icon",flatten:!0})],em.prototype,"assignedIcons",void 0);class im extends em{renderElevationOrOutline(){return dp`<md-elevation part="elevation"></md-elevation>`}}const rm=vh`:host{--_container-color: var(--md-filled-button-container-color, var(--md-sys-color-primary, #6750a4));--_container-elevation: var(--md-filled-button-container-elevation, 0);--_container-height: var(--md-filled-button-container-height, 40px);--_container-shadow-color: var(--md-filled-button-container-shadow-color, var(--md-sys-color-shadow, #000));--_disabled-container-color: var(--md-filled-button-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-container-elevation: var(--md-filled-button-disabled-container-elevation, 0);--_disabled-container-opacity: var(--md-filled-button-disabled-container-opacity, 0.12);--_disabled-label-text-color: var(--md-filled-button-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-filled-button-disabled-label-text-opacity, 0.38);--_focus-container-elevation: var(--md-filled-button-focus-container-elevation, 0);--_focus-label-text-color: var(--md-filled-button-focus-label-text-color, var(--md-sys-color-on-primary, #fff));--_hover-container-elevation: var(--md-filled-button-hover-container-elevation, 1);--_hover-label-text-color: var(--md-filled-button-hover-label-text-color, var(--md-sys-color-on-primary, #fff));--_hover-state-layer-color: var(--md-filled-button-hover-state-layer-color, var(--md-sys-color-on-primary, #fff));--_hover-state-layer-opacity: var(--md-filled-button-hover-state-layer-opacity, 0.08);--_label-text-color: var(--md-filled-button-label-text-color, var(--md-sys-color-on-primary, #fff));--_label-text-font: var(--md-filled-button-label-text-font, var(--md-sys-typescale-label-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-filled-button-label-text-line-height, var(--md-sys-typescale-label-large-line-height, 1.25rem));--_label-text-size: var(--md-filled-button-label-text-size, var(--md-sys-typescale-label-large-size, 0.875rem));--_label-text-weight: var(--md-filled-button-label-text-weight, var(--md-sys-typescale-label-large-weight, var(--md-ref-typeface-weight-medium, 500)));--_pressed-container-elevation: var(--md-filled-button-pressed-container-elevation, 0);--_pressed-label-text-color: var(--md-filled-button-pressed-label-text-color, var(--md-sys-color-on-primary, #fff));--_pressed-state-layer-color: var(--md-filled-button-pressed-state-layer-color, var(--md-sys-color-on-primary, #fff));--_pressed-state-layer-opacity: var(--md-filled-button-pressed-state-layer-opacity, 0.12);--_disabled-icon-color: var(--md-filled-button-disabled-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-icon-opacity: var(--md-filled-button-disabled-icon-opacity, 0.38);--_focus-icon-color: var(--md-filled-button-focus-icon-color, var(--md-sys-color-on-primary, #fff));--_hover-icon-color: var(--md-filled-button-hover-icon-color, var(--md-sys-color-on-primary, #fff));--_icon-color: var(--md-filled-button-icon-color, var(--md-sys-color-on-primary, #fff));--_icon-size: var(--md-filled-button-icon-size, 18px);--_pressed-icon-color: var(--md-filled-button-pressed-icon-color, var(--md-sys-color-on-primary, #fff));--_container-shape-start-start: var(--md-filled-button-container-shape-start-start, var(--md-filled-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-start-end: var(--md-filled-button-container-shape-start-end, var(--md-filled-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-end: var(--md-filled-button-container-shape-end-end, var(--md-filled-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-start: var(--md-filled-button-container-shape-end-start, var(--md-filled-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_leading-space: var(--md-filled-button-leading-space, 24px);--_trailing-space: var(--md-filled-button-trailing-space, 24px);--_with-leading-icon-leading-space: var(--md-filled-button-with-leading-icon-leading-space, 16px);--_with-leading-icon-trailing-space: var(--md-filled-button-with-leading-icon-trailing-space, 24px);--_with-trailing-icon-leading-space: var(--md-filled-button-with-trailing-icon-leading-space, 24px);--_with-trailing-icon-trailing-space: var(--md-filled-button-with-trailing-icon-trailing-space, 16px)}
`,nm=vh`md-elevation{transition-duration:280ms}:host([disabled]) md-elevation{transition:none}md-elevation{--md-elevation-level: var(--_container-elevation);--md-elevation-shadow-color: var(--_container-shadow-color)}:host(:focus-within) md-elevation{--md-elevation-level: var(--_focus-container-elevation)}:host(:hover) md-elevation{--md-elevation-level: var(--_hover-container-elevation)}:host(:active) md-elevation{--md-elevation-level: var(--_pressed-container-elevation)}:host([disabled]) md-elevation{--md-elevation-level: var(--_disabled-container-elevation)}
`,am=vh`:host{border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-start-radius:var(--_container-shape-end-start);border-end-end-radius:var(--_container-shape-end-end);box-sizing:border-box;cursor:pointer;display:inline-flex;gap:8px;min-height:var(--_container-height);outline:none;padding-block:calc((var(--_container-height) - max(var(--_label-text-line-height),var(--_icon-size)))/2);padding-inline-start:var(--_leading-space);padding-inline-end:var(--_trailing-space);place-content:center;place-items:center;position:relative;font-family:var(--_label-text-font);font-size:var(--_label-text-size);line-height:var(--_label-text-line-height);font-weight:var(--_label-text-weight);text-overflow:ellipsis;text-wrap:nowrap;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);vertical-align:top;--md-ripple-hover-color: var(--_hover-state-layer-color);--md-ripple-pressed-color: var(--_pressed-state-layer-color);--md-ripple-hover-opacity: var(--_hover-state-layer-opacity);--md-ripple-pressed-opacity: var(--_pressed-state-layer-opacity)}md-focus-ring{--md-focus-ring-shape-start-start: var(--_container-shape-start-start);--md-focus-ring-shape-start-end: var(--_container-shape-start-end);--md-focus-ring-shape-end-end: var(--_container-shape-end-end);--md-focus-ring-shape-end-start: var(--_container-shape-end-start)}:host([disabled]){cursor:default;pointer-events:none}.button{border-radius:inherit;cursor:inherit;display:inline-flex;align-items:center;justify-content:center;border:none;outline:none;-webkit-appearance:none;vertical-align:middle;background:rgba(0,0,0,0);text-decoration:none;min-width:calc(64px - var(--_leading-space) - var(--_trailing-space));width:100%;z-index:0;height:100%;font:inherit;color:var(--_label-text-color);padding:0;gap:inherit;text-transform:inherit}.button::-moz-focus-inner{padding:0;border:0}:host(:hover) .button{color:var(--_hover-label-text-color)}:host(:focus-within) .button{color:var(--_focus-label-text-color)}:host(:active) .button{color:var(--_pressed-label-text-color)}.background{background-color:var(--_container-color);border-radius:inherit;inset:0;position:absolute}.label{overflow:hidden}:is(.button,.label,.label slot),.label ::slotted(*){text-overflow:inherit}:host([disabled]) .label{color:var(--_disabled-label-text-color);opacity:var(--_disabled-label-text-opacity)}:host([disabled]) .background{background-color:var(--_disabled-container-color);opacity:var(--_disabled-container-opacity)}@media(forced-colors: active){.background{border:1px solid CanvasText}:host([disabled]){--_disabled-icon-color: GrayText;--_disabled-icon-opacity: 1;--_disabled-container-opacity: 1;--_disabled-label-text-color: GrayText;--_disabled-label-text-opacity: 1}}:host([has-icon]:not([trailing-icon])){padding-inline-start:var(--_with-leading-icon-leading-space);padding-inline-end:var(--_with-leading-icon-trailing-space)}:host([has-icon][trailing-icon]){padding-inline-start:var(--_with-trailing-icon-leading-space);padding-inline-end:var(--_with-trailing-icon-trailing-space)}::slotted([slot=icon]){display:inline-flex;position:relative;writing-mode:horizontal-tb;fill:currentColor;flex-shrink:0;color:var(--_icon-color);font-size:var(--_icon-size);inline-size:var(--_icon-size);block-size:var(--_icon-size)}:host(:hover) ::slotted([slot=icon]){color:var(--_hover-icon-color)}:host(:focus-within) ::slotted([slot=icon]){color:var(--_focus-icon-color)}:host(:active) ::slotted([slot=icon]){color:var(--_pressed-icon-color)}:host([disabled]) ::slotted([slot=icon]){color:var(--_disabled-icon-color);opacity:var(--_disabled-icon-opacity)}.touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--_container-height))/2) 0}:host([touch-target=none]) .touch{display:none}
`;let sm=class extends im{};sm.styles=[am,nm,rm],sm=it([ph("md-filled-button")],sm);class om extends(al(K)){static get styles(){return[nl,n`
        #button-container {
          --mdc-typography-button-font-size: 12px;
          margin: 12px 0;
        }

        #button-container div {
          border: 1px solid var(--mdc-theme-primary);
          opacity: 0.9;
          border-radius: 8px;
          display: inline-block;
          padding: 4px;
        }
      `]}render(){return M`
      <div id="button-container">
        <div>
          <slot></slot>
        </div>
      </div>
    `}}window.customElements.define("grampsjs-button-group",om);class lm extends(al(K)){static get styles(){return[nl,n`
        .filtermenu {
          display: inline;
        }

        .filtermenu > * {
          vertical-align: middle;
        }

        #filteroff {
          --mdc-icon-size: 20px;
          color: var(--mdc-theme-primary);
          margin-left: 10px;
          margin-right: 10px;
        }

        #input-gql-container {
          align-items: center;
          margin: 20px 0 30px 0;
          width: 100%;
        }

        #input-gql {
          --md-sys-color-surface-container-highest: #f5f5f5;
          --md-outlined-text-field-input-text-font: 'Commit Mono';
          --md-outlined-text-field-input-text-size: 15px;
          --md-outlined-text-field-container-shape: 8px;
          --md-outlined-text-field-top-space: 9px;
          --md-outlined-text-field-bottom-space: 9px;
          flex: 1;
          margin-right: 12px;
        }

        #input-gql-container span {
          align-self: flex-start;
          display: flex;
          align-items: center;
        }

        #input-gql-container md-filled-button {
          --md-filled-button-container-shape: 8px;
        }

        .hidden {
          display: none;
        }

        .flex {
          display: flex;
        }
      `]}static get properties(){return{filters:{type:Array},open:{type:Boolean},objectType:{type:String},query:{type:String},useGql:{type:Boolean},errorGql:{type:Boolean}}}constructor(){super(),this.filters=[],this.open=!1,this.objectType="",this.query="",this.useGql=!1,this.errorGql=!1}render(){return M`
      <div class="filtermenu">
        <mwc-button
          icon="filter_list"
          ?unelevated="${this.open}"
          @click="${this._handleFilterButton}"
          >${this._("filter")}</mwc-button
        >
        <mwc-icon-button
          id="filteroff"
          ?disabled="${0===this.filters.length&&""===this.query}"
          icon="filter_list_off"
          @click="${this._handleFilterOff}"
        ></mwc-icon-button>
        <grampsjs-tooltip for="filteroff" .strings="${this.strings}"
          >${this._("Clear all filters")}</grampsjs-tooltip
        >
        ${this._renderFilterChips()}
      </div>
      <div
        class="${Ot({hidden:!this.open})}"
        @filter:changed="${this._handleFilterChanged}"
      >
        <grampsjs-button-group>
          <mwc-button
            dense
            ?unelevated="${!this.useGql}"
            @click="${this._handleGqlClick}"
            >${this._("simple")}</mwc-button
          >
          <mwc-button
            dense
            ?unelevated="${this.useGql}"
            @click="${this._handleGqlClick}"
            >GQL</mwc-button
          >
        </grampsjs-button-group>

        <div
          class="${Ot({hidden:!this.useGql,flex:this.useGql})}"
          id="input-gql-container"
        >
          ${this._renderGql()}
        </div>

        <div class="${Ot({hidden:this.useGql})}">
          <slot></slot>
        </div>
      </div>
    `}_renderFilterChips(){return this.query?M`
        <grampsjs-filter-chip
          @filter-chip:clear="${this._handleFilterOff}"
          monospace
          label="${this.query}"
        ></grampsjs-filter-chip>
      `:this.filters.map(((t,e)=>M`
        <grampsjs-filter-chip
          label="${this.ruleToLabel(t)}"
          @filter-chip:clear="${()=>this._clearFilter(e)}"
        ></grampsjs-filter-chip>
      `))}_renderGql(){return M`
      <md-outlined-text-field
        id="input-gql"
        @keydown="${this._handleGqlKey}"
        @input="${this._handleGqlChange}"
        value="${this.query}"
        ?error="${this.errorGql}"
      >
        ${this.errorGql?Ha("M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z",null,0,"trailing-icon"):""}
        ></md-outlined-text-field
      >
      <span
        ><md-filled-button
          @click="${this._applyGql}"
          @keydown="${gs}"
          >${this._("Apply")}</md-filled-button
        ></span
      >
    `}_handleGqlKey(t){"Enter"===t.code?this._applyGql():"Escape"===t.code&&(this._clearGqlForm(),this._clearGqlError())}_clearGqlForm(){const t=this.renderRoot.querySelector("#input-gql");null!==t&&(t.value="")}_handleGqlChange(){this._clearGqlError()}_applyGql(){this._clearGqlError();const t=this.renderRoot.querySelector("#input-gql");null!==t&&(this.query=t.value,this._fireFiltersChanged())}_clearGqlError(){this.errorGql=!1}_clearFilter(t){this.filters=[...this.filters.slice(0,t),...this.filters.slice(t+1)],this._fireFiltersChanged()}_handleFilterButton(){this.open=!this.open}_handleFilterOff(){this.filters=[],this.query="",this._clearGqlError(),this._fireFiltersChanged()}_fireFiltersChanged(){os(this,"filters:changed",{filters:this.filters,query:this.query})}updated(t){t.has("filters")&&this.broadcastToChildren()}get _slottedChildren(){const t=this.shadowRoot.querySelector("slot");return t?t.assignedElements({flatten:!0}):[]}broadcastToChildren(){this._slottedChildren.forEach((t=>{t.filters=this.filters}))}async _handleGqlClick(){this.useGql=!this.useGql,(this.filters.length||this.query)&&(this.filters=[],this.query="",this._fireFiltersChanged()),this.filters=[],this.query="",this.useGql&&(await this.updateComplete,this.renderRoot.getElementById("input-gql").focus())}_handleFilterChanged(t){t.preventDefault(),t.stopPropagation();const e=t.detail?.filters?.rules,i=t.detail?.replace,r=i?this.filters.filter((t=>t.name!==i)):this.filters;e&&(this.filters=[...r,...e],this._fireFiltersChanged())}ruleToLabel(t){return"HasTag"===t.name?`${this._("Tag")}: ${t.values[0]}`:"HasMedia"===t.name&&""!==t.values[1]?`${this._("_Media Type:").replace(":","")}: ${this._(ps[t.values[1]])}`:"HasBirth"===t.name&&""!==t.values[0]?this._ruleToLabelSpan(t,"Birth year",0):"HasDeath"===t.name&&""!==t.values[0]?this._ruleToLabelSpan(t,"Death year",0):"HasData"===t.name&&""!==t.values[1]?this._ruleToLabelSpan(t,"Date",1):"HasType"===t.name?`${this._("Type")}: ${this._(t.values[0])}`:"HasRelType"===t.name?`${this._("Relationship type:")} ${this._(t.values[0])}`:t.name in ds?this._(ds[t.name]):t.name in hs[this.objectType]?this._(hs[this.objectType][t.name]).replace(/<[^>]+>/,""):JSON.stringify(t)}_ruleToLabelSpan(t,e,i){const r=t.values[i].match(/(\d+)[^\d]+(\d+)/);return 3===r.length?r[1]===r[2]?`${this._(e)}: ${r[1]}`:`${this._(e)}: ${r[1]}-${r[2]}`:JSON.stringify(t)}}window.customElements.define("grampsjs-filters",lm);class cm extends $d{static get styles(){return[super.styles,n`
        table {
          border-collapse: collapse;
          border-spacing: 0;
          font-size: 14px;
          margin-top: 20px;
          width: 100%;
        }

        th {
          padding: 12px 20px;
          font-size: 13px;
          color: #666;
          font-weight: 400;
          vertical-align: top;
          line-height: 24px;
        }

        td {
          padding: 12px 20px;
          height: 17px;
          line-height: 17px;
        }

        td > div {
          width: 100%;
          height: 100%;
          overflow: hidden;
        }

        th,
        td {
          border-bottom: 1px solid #e0e0e0;
          text-align: left;
          margin: 0;
        }

        table.linked tr:hover td {
          background-color: #f0f0f0;
          cursor: pointer;
        }

        table.linked tr.highlight td {
          font-weight: 400;
        }

        table.linked tr.highlight:hover td {
          background-color: white;
          cursor: auto;
        }

        td mwc-icon.inline {
          color: rgba(0, 0, 0, 0.25);
          font-size: 16px;
        }

        .sortbtn {
          margin-left: 1em;
          display: inline-block;
        }

        .sortbtn mwc-icon-button {
          --mdc-icon-button-size: 32px;
          position: relative;
          top: -4px;
        }

        .sortbtn mwc-icon-button svg {
          height: 20px;
          position: relative;
          top: -4px;
        }

        mwc-fab {
          position: fixed;
          bottom: 32px;
          right: 32px;
        }

        .hidden {
          display: none;
        }

        .viewbtn {
          float: right;
        }

        .viewbtn mwc-icon-button {
          color: var(--mdc-theme-primary);
        }
      `]}static get properties(){return{_data:{type:Array},_rawData:{type:Array},_columns:{type:Object},_totalCount:{type:Number},_page:{type:Number},_pages:{type:Number},_pageSize:{type:Number},_sort:{type:String},canAdd:{type:Boolean},_objectsName:{type:String},altView:{type:Boolean},_oldUrl:{type:String}}}constructor(){super(),this._data=[],this._rawData=[],this._totalCount=-1,this._page=1,this._pages=-1,this._pageSize=20,this._sort="",this.canAdd=!1,this._objectsName="",this.altView=!1,this._oldUrl=""}renderContent(){return M`
      ${this._renderFilter()}
      ${this.altView?this.renderAltView():M`
            <table class="linked">
              <tr>
                ${Object.keys(this._columns).map((t=>M`
                    <th>
                      ${this._(this._columns[t].title)}
                      ${this._renderSortBtn(t)}
                    </th>
                  `),this)}
              </tr>
              ${this._data.map((t=>M`
                  <tr @click=${()=>this._handleClick(t)}>
                    ${Object.keys(this._columns).map((e=>M` <td><div>${t[e]}</div></td> `),this)}
                  </tr>
                `))}
            </table>
          `}
      <grampsjs-pagination
        page="${this._page}"
        pages="${this._pages}"
        @page:changed="${this._handlePageChanged}"
        .strings="${this.strings}"
      ></grampsjs-pagination>

      ${this.canAdd?this.renderFab():""}
    `}renderAltView(){return""}_renderFilter(){return M`
      <grampsjs-filters
        @filters:changed="${this._handleFiltersChanged}"
        .strings="${this.strings}"
        objectType="${this._objectsName}"
        ?errorGql="${this.error}"
      >
        ${this.renderFilters()}
      </grampsjs-filters>
      <div class="viewbtn">${this._renderViewButton()}</div>

      <div
        class="${Ot({hidden:!this.filterOpen})}"
        @filter:changed="${this._handleFilterChanged}"
      ></div>
    `}_renderViewButton(){return""}renderFilters(){return M`
      <grampsjs-filter-tags .strings="${this.strings}"></grampsjs-filter-tags>
    `}renderFab(){return M` <mwc-fab icon="add" @click=${this._handleClickAdd}></mwc-fab> `}_handleFiltersChanged(){this._fetchData()}_handlePageChanged(t){this._page=t.detail.page}_handleClick(t){os(this,"nav",{path:this._getItemPath(t)})}_handleClickAdd(){os(this,"nav",{path:this._getAddPath()})}_renderSortBtn(t){const e=this._columns[t].sort;if(!e)return"";const i=this._sort.substring(1)===e,r=i&&"+"===this._sort.substring(0,1);return M` <div class="sortbtn ${i?"current-sort":""}">
      <mwc-icon-button
        @click="${()=>this._toggleSort(e,i,r)}"
        id="btn-sort-${t}"
      >
        ${this._renderSortIcon(i,r)}
      </mwc-icon-button>
      <grampsjs-tooltip for="btn-sort-${t}" .strings="${this.strings}"
        >${this._("Sort")}</grampsjs-tooltip
      >
    </div>`}_renderSortIcon(t,e){return t?Na(e?"M19 17H22L18 21L14 17H17V3H19M2 17H12V19H2M6 5V7H2V5M2 11H9V13H2V11Z":"M19 7H22L18 3L14 7H17V21H19M2 17H12V19H2M6 5V7H2V5M2 11H9V13H2V11Z","rgba(0, 0, 0, 0.6)"):Na("M18 21L14 17H17V7H14L18 3L22 7H19V17H22M2 19V17H12V19M2 13V11H9V13M2 7V5H6V7H2Z","rgba(0, 0, 0, 0.2)")}_toggleSort(t,e,i){this._sort=e&&i?`-${t}`:`+${t}`}get _filters(){return this.renderRoot.querySelector("grampsjs-filters")}get _fullUrl(){let t=`${this._fetchUrl}&page=${this._page}&pagesize=${this._pageSize}`;this._sort&&(t=`${t}&sort=${this._sort}`);const e=Object.values(this._filters.filters);e.length>0&&(t=`${t}&rules=${encodeURIComponent(JSON.stringify({rules:e}))}`);const i=this._filters.query;return i&&(t=`${t}&gql=${encodeURIComponent(i)}`),t}update(t){super.update(t),t.has("active")&&(this.filterOpen=!1),this._fullUrl!==this._oldUrl&&this._fetchData()}_fetchData(){this.loading=!0;const t=this._fullUrl;this._oldUrl=t,On(t).then((t=>{this.loading=!1,"data"in t?(this._errorMessage="",this.error=!1,this._rawData=t.data,this._data=t.data.map((t=>this._formatRow(t,this))),this._totalCount=t.total_count,this._pages=Math.ceil(this._totalCount/this._pageSize)):"error"in t&&(this.error=!0,this._errorMessage=t.error)}))}_formatRow(){return{}}_getItemPath(){return""}_getAddPath(){return""}}class dm extends(al(K)){static get styles(){return[nl,n`
        h3 {
          font-size: 14px;
          text-transform: uppercase;
          font-family: var(--grampsjs-body-font-family);
          font-weight: 500;
          color: var(--mdc-theme-primary);
          border-color: var(--mdc-theme-primary);
          border-bottom-width: 1px;
        }
      `]}static get properties(){return{filters:{type:Object},open:{type:Boolean},label:{type:String},rule:{type:String},dateIndex:{type:Number},numArgs:{type:Number},_yearFrom:{type:String},_yearUntil:{type:String},_serverLang:{type:String}}}constructor(){super(),this.filters=[],this.label="",this.rule="",this.open=!1,this.dateIndex=0,this.numArgs=3,this._yearFrom=null,this._yearUntil=(new Date).getFullYear(),this._serverLang=Mn().serverLang}render(){return M`
      <h3>${this._(this.label)}</h3>
      <mwc-textfield
        type="number"
        max="${(new Date).getFullYear()}"
        label="${this._("between")}"
        id="year_from"
        value="${this._yearFrom}"
        @input="${as((()=>this._handleYearFrom()),1e3)}"
      ></mwc-textfield>
      <mwc-textfield
        type="number"
        max="${(new Date).getFullYear()}"
        label="${this._("and")}"
        id="year_until"
        value="${this._yearUntil}"
        @input="${as((()=>this._handleYearUntil()),1e3)}"
      ></mwc-textfield>
    `}_handleYearFrom(){const t=this.renderRoot.querySelector("#year_from");t&&(this._yearFrom=t.value,this._checkValid())}_handleYearUntil(){const t=this.renderRoot.querySelector("#year_until");t&&(this._yearUntil=t.value,this._checkValid())}_checkValid(){!!this._yearFrom&&!!this._yearUntil&&this._yearUntil>=this._yearFrom&&this.applyFilter()}applyFilter(){const t=this.renderRoot.querySelector("#year_from")?.value,e=this.renderRoot.querySelector("#year_until")?.value;if(t&&e){const i=this._serverLang?function(t,e,i){const r={ar:" 1111  2222",bg:" 1111  2222",ca:"entre 1111 i 2222",cs:"mezi 1111 a 2222",da:"mellem 1111 og 2222",de:"zwischen 1111 und 2222",el:" 1111  2222",en:"between 1111 and 2222",en_GB:"between 1111 and 2222",es:"entre 1111 y 2222",fi:"1111 ja 2222 vlill",fr:"entre 1111 et 2222",hr:"izmeu 1111 i 2222",hu:"1111 s 2222 kztt",is:"milli 1111 og 2222",it:"tra 1111 e 2222",ja:"11112222",lt:"tarp 1111 ir 2222",nb:"mellom 1111 og 2222",nl:"tussen 1111 en 2222",nn:"mellom 1111 og 2222",pl:"midzy 1111 a 2222",pt_BR:"entre 1111 e 2222",pt_PT:"entre 1111 e 2222",ru:" 1111  2222",sk:"medzi 1111 a 2222",sl:"med 1111 in 2222",sr:" 1111  2222",sv:"mellan 1111 och 2222",uk:" 1111  2222",zh_CN:"  1111  2222 ",zh_HK:"  1111  2222 ",zh_TW:"  1111  2222 "};let n=r[i];if(!n){const t=Object.keys(r).filter((t=>t.startsWith(i)));if(0===t.length)return null;n=r[t[0]]}return n.replace("1111",t).replace("2222",e)}(t,e,this._serverLang):`from ${t} until ${e}`,r=Array(this.numArgs).fill("");r[this.dateIndex]=i;os(this,"filter:changed",{filters:{rules:[{name:this.rule,values:r}]},replace:this.rule})}}}window.customElements.define("grampsjs-filter-years",dm);class hm extends hi{constructor(){super(...arguments),this.checked=!1,this.indeterminate=!1,this.disabled=!1,this.name="",this.value="on",this.reducedTouchTarget=!1,this.animationClass="",this.shouldRenderRipple=!1,this.focused=!1,this.mdcFoundationClass=void 0,this.mdcFoundation=void 0,this.rippleElement=null,this.rippleHandlers=new de((()=>(this.shouldRenderRipple=!0,this.ripple.then((t=>this.rippleElement=t)),this.ripple)))}createAdapter(){return{}}update(t){const e=t.get("indeterminate"),i=t.get("checked"),r=t.get("disabled");if(void 0!==e||void 0!==i||void 0!==r){const t=this.calculateAnimationStateName(!!i,!!e,!!r),n=this.calculateAnimationStateName(this.checked,this.indeterminate,this.disabled);this.animationClass=`${t}-${n}`}super.update(t)}calculateAnimationStateName(t,e,i){return i?"disabled":e?"indeterminate":t?"checked":"unchecked"}renderRipple(){return this.shouldRenderRipple?this.renderRippleTemplate():""}renderRippleTemplate(){return M`<mwc-ripple
        .disabled="${this.disabled}"
        unbounded></mwc-ripple>`}render(){const t=this.indeterminate||this.checked,e={"mdc-checkbox--disabled":this.disabled,"mdc-checkbox--selected":t,"mdc-checkbox--touch":!this.reducedTouchTarget,"mdc-ripple-upgraded--background-focused":this.focused,"mdc-checkbox--anim-checked-indeterminate":"checked-indeterminate"==this.animationClass,"mdc-checkbox--anim-checked-unchecked":"checked-unchecked"==this.animationClass,"mdc-checkbox--anim-indeterminate-checked":"indeterminate-checked"==this.animationClass,"mdc-checkbox--anim-indeterminate-unchecked":"indeterminate-unchecked"==this.animationClass,"mdc-checkbox--anim-unchecked-checked":"unchecked-checked"==this.animationClass,"mdc-checkbox--anim-unchecked-indeterminate":"unchecked-indeterminate"==this.animationClass},i=this.indeterminate?"mixed":void 0;return M`
      <div class="mdc-checkbox mdc-checkbox--upgraded ${Ot(e)}">
        <input type="checkbox"
              class="mdc-checkbox__native-control"
              name="${Ke(this.name)}"
              aria-checked="${Ke(i)}"
              aria-label="${Ke(this.ariaLabel)}"
              aria-labelledby="${Ke(this.ariaLabelledBy)}"
              aria-describedby="${Ke(this.ariaDescribedBy)}"
              data-indeterminate="${this.indeterminate?"true":"false"}"
              ?disabled="${this.disabled}"
              .indeterminate="${this.indeterminate}"
              .checked="${this.checked}"
              .value="${this.value}"
              @change="${this.handleChange}"
              @focus="${this.handleFocus}"
              @blur="${this.handleBlur}"
              @mousedown="${this.handleRippleMouseDown}"
              @mouseenter="${this.handleRippleMouseEnter}"
              @mouseleave="${this.handleRippleMouseLeave}"
              @touchstart="${this.handleRippleTouchStart}"
              @touchend="${this.handleRippleDeactivate}"
              @touchcancel="${this.handleRippleDeactivate}">
        <div class="mdc-checkbox__background"
          @animationend="${this.resetAnimationClass}">
          <svg class="mdc-checkbox__checkmark"
              viewBox="0 0 24 24">
            <path class="mdc-checkbox__checkmark-path"
                  fill="none"
                  d="M1.73,12.91 8.1,19.28 22.79,4.59"></path>
          </svg>
          <div class="mdc-checkbox__mixedmark"></div>
        </div>
        ${this.renderRipple()}
      </div>`}setFormData(t){this.name&&this.checked&&t.append(this.name,this.value)}handleFocus(){this.focused=!0,this.handleRippleFocus()}handleBlur(){this.focused=!1,this.handleRippleBlur()}handleRippleMouseDown(t){const e=()=>{window.removeEventListener("mouseup",e),this.handleRippleDeactivate()};window.addEventListener("mouseup",e),this.rippleHandlers.startPress(t)}handleRippleTouchStart(t){this.rippleHandlers.startPress(t)}handleRippleDeactivate(){this.rippleHandlers.endPress()}handleRippleMouseEnter(){this.rippleHandlers.startHover()}handleRippleMouseLeave(){this.rippleHandlers.endHover()}handleRippleFocus(){this.rippleHandlers.startFocus()}handleRippleBlur(){this.rippleHandlers.endFocus()}handleChange(){this.checked=this.formElement.checked,this.indeterminate=this.formElement.indeterminate}resetAnimationClass(){this.animationClass=""}get isRippleActive(){var t;return(null===(t=this.rippleElement)||void 0===t?void 0:t.isActive)||!1}}it([ht(".mdc-checkbox")],hm.prototype,"mdcRoot",void 0),it([ht("input")],hm.prototype,"formElement",void 0),it([ot({type:Boolean,reflect:!0})],hm.prototype,"checked",void 0),it([ot({type:Boolean})],hm.prototype,"indeterminate",void 0),it([ot({type:Boolean,reflect:!0})],hm.prototype,"disabled",void 0),it([ot({type:String,reflect:!0})],hm.prototype,"name",void 0),it([ot({type:String})],hm.prototype,"value",void 0),it([Xe,ot({type:String,attribute:"aria-label"})],hm.prototype,"ariaLabel",void 0),it([Xe,ot({type:String,attribute:"aria-labelledby"})],hm.prototype,"ariaLabelledBy",void 0),it([Xe,ot({type:String,attribute:"aria-describedby"})],hm.prototype,"ariaDescribedBy",void 0),it([ot({type:Boolean})],hm.prototype,"reducedTouchTarget",void 0),it([lt()],hm.prototype,"animationClass",void 0),it([lt()],hm.prototype,"shouldRenderRipple",void 0),it([lt()],hm.prototype,"focused",void 0),it([pt("mwc-ripple")],hm.prototype,"ripple",void 0),it([dt({passive:!0})],hm.prototype,"handleRippleTouchStart",null);const pm=n`.mdc-checkbox{padding:calc((40px - 18px) / 2);padding:calc((var(--mdc-checkbox-ripple-size, 40px) - 18px) / 2);margin:calc((40px - 40px) / 2);margin:calc((var(--mdc-checkbox-touch-target-size, 40px) - 40px) / 2)}.mdc-checkbox .mdc-checkbox__ripple::before,.mdc-checkbox .mdc-checkbox__ripple::after{background-color:#000;background-color:var(--mdc-ripple-color, #000)}.mdc-checkbox:hover .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-ripple-surface--hover .mdc-checkbox__ripple::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__ripple::before,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__ripple::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-checkbox:not(.mdc-ripple-upgraded) .mdc-checkbox__ripple::after{transition:opacity 150ms linear}.mdc-checkbox:not(.mdc-ripple-upgraded):active .mdc-checkbox__ripple::after{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-checkbox.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-checkbox.mdc-checkbox--selected .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-checkbox--selected .mdc-checkbox__ripple::after{background-color:#018786;background-color:var(--mdc-ripple-color, var(--mdc-theme-secondary, #018786))}.mdc-checkbox.mdc-checkbox--selected:hover .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-checkbox--selected.mdc-ripple-surface--hover .mdc-checkbox__ripple::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-checkbox.mdc-checkbox--selected.mdc-ripple-upgraded--background-focused .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded):focus .mdc-checkbox__ripple::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded) .mdc-checkbox__ripple::after{transition:opacity 150ms linear}.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded):active .mdc-checkbox__ripple::after{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-checkbox.mdc-checkbox--selected.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--selected .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--selected .mdc-checkbox__ripple::after{background-color:#018786;background-color:var(--mdc-ripple-color, var(--mdc-theme-secondary, #018786))}.mdc-checkbox .mdc-checkbox__background{top:calc((40px - 18px) / 2);top:calc((var(--mdc-checkbox-ripple-size, 40px) - 18px) / 2);left:calc((40px - 18px) / 2);left:calc((var(--mdc-checkbox-ripple-size, 40px) - 18px) / 2)}.mdc-checkbox .mdc-checkbox__native-control{top:calc((40px - 40px) / 2);top:calc((40px - var(--mdc-checkbox-touch-target-size, 40px)) / 2);right:calc((40px - 40px) / 2);right:calc((40px - var(--mdc-checkbox-touch-target-size, 40px)) / 2);left:calc((40px - 40px) / 2);left:calc((40px - var(--mdc-checkbox-touch-target-size, 40px)) / 2);width:40px;width:var(--mdc-checkbox-touch-target-size, 40px);height:40px;height:var(--mdc-checkbox-touch-target-size, 40px)}.mdc-checkbox .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:rgba(0, 0, 0, 0.54);border-color:var(--mdc-checkbox-unchecked-color, rgba(0, 0, 0, 0.54));background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:#018786;border-color:var(--mdc-checkbox-checked-color, var(--mdc-theme-secondary, #018786));background-color:#018786;background-color:var(--mdc-checkbox-checked-color, var(--mdc-theme-secondary, #018786))}@keyframes mdc-checkbox-fade-in-background-8A000000FF01878600000000FF018786{0%{border-color:rgba(0, 0, 0, 0.54);border-color:var(--mdc-checkbox-unchecked-color, rgba(0, 0, 0, 0.54));background-color:transparent}50%{border-color:#018786;border-color:var(--mdc-checkbox-checked-color, var(--mdc-theme-secondary, #018786));background-color:#018786;background-color:var(--mdc-checkbox-checked-color, var(--mdc-theme-secondary, #018786))}}@keyframes mdc-checkbox-fade-out-background-8A000000FF01878600000000FF018786{0%,80%{border-color:#018786;border-color:var(--mdc-checkbox-checked-color, var(--mdc-theme-secondary, #018786));background-color:#018786;background-color:var(--mdc-checkbox-checked-color, var(--mdc-theme-secondary, #018786))}100%{border-color:rgba(0, 0, 0, 0.54);border-color:var(--mdc-checkbox-unchecked-color, rgba(0, 0, 0, 0.54));background-color:transparent}}.mdc-checkbox.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FF01878600000000FF018786}.mdc-checkbox.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FF01878600000000FF018786}.mdc-checkbox .mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:rgba(0, 0, 0, 0.38);border-color:var(--mdc-checkbox-disabled-color, rgba(0, 0, 0, 0.38));background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:rgba(0, 0, 0, 0.38);background-color:var(--mdc-checkbox-disabled-color, rgba(0, 0, 0, 0.38))}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:#fff;color:var(--mdc-checkbox-ink-color, #fff)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:#fff;border-color:var(--mdc-checkbox-ink-color, #fff)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:#fff;color:var(--mdc-checkbox-ink-color, #fff)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:#fff;border-color:var(--mdc-checkbox-ink-color, #fff)}.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{pointer-events:none;border:2px solid transparent;border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{border-color:CanvasText}}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{content:"";border:2px solid transparent;border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{border-color:CanvasText}}@media all and (-ms-high-contrast: none){.mdc-checkbox .mdc-checkbox__focus-ring{display:none}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:transparent;pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin:calc((48px - 40px) / 2);margin:calc((var(--mdc-checkbox-state-layer-size, 48px) - var(--mdc-checkbox-state-layer-size, 40px)) / 2)}.mdc-checkbox--touch .mdc-checkbox__native-control{top:calc((40px - 48px) / 2);top:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 48px)) / 2);right:calc((40px - 48px) / 2);right:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 48px)) / 2);left:calc((40px - 48px) / 2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 48px)) / 2);width:48px;width:var(--mdc-checkbox-state-layer-size, 48px);height:48px;height:var(--mdc-checkbox-state-layer-size, 48px)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 180ms 0ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none}:host{outline:none;display:inline-flex;-webkit-tap-highlight-color:transparent}:host([checked]),:host([indeterminate]){--mdc-ripple-color:var(--mdc-theme-secondary, #018786)}.mdc-checkbox .mdc-checkbox__background::before{content:none}`;let um=class extends hm{};um.styles=[pm],um=it([at("mwc-checkbox")],um);class mm extends(al(K)){static get styles(){return[nl,n`
        h3 {
          font-size: 14px;
          text-transform: uppercase;
          font-family: var(--grampsjs-body-font-family);
          font-weight: 500;
          color: var(--mdc-theme-primary);
          border-color: var(--mdc-theme-primary);
          border-bottom-width: 1px;
        }
      `]}static get properties(){return{filters:{type:Array},props:{type:Object},hasCount:{type:Boolean},label:{type:String}}}constructor(){super(),this.filters=[],this.props={},this.hasCount=!1,this.label="Properties"}render(){return M`
      <h3>${this._(this.label)}</h3>
      ${Object.keys(this.props).map((t=>M`
          <mwc-formfield
            label="${this._(this.props[t]||"").replace(/<[^>]+>/,"")}"
          >
            <mwc-checkbox
              id="${t}"
              @change="${this._handleChange}"
              ?checked="${this.filters.filter((e=>e.name===t)).length>0}"
            ></mwc-checkbox>
          </mwc-formfield>
        `))}
    `}_handleChange(t){const e=t.target.id,i=this.hasCount?{name:e,values:["0","greater than"]}:{name:e};os(this,"filter:changed",{filters:{rules:t.target.checked?[i]:[]},replace:e})}}window.customElements.define("grampsjs-filter-properties",mm);class fm extends(al(K)){static get styles(){return[nl]}static get properties(){return{loading:{type:Boolean},error:{type:Boolean},loadWithoutLocale:{type:Boolean},_errorMessage:{type:String},_data:{type:Object},_oldUrl:{type:String}}}constructor(){super(),this.loading=!0,this.error=!1,this.renderOnError=!1,this.loadWithoutLocale=!1,this._errorMessage="",this._data={},this._oldUrl="",this._boundUpdateData=this._updateData.bind(this),this._boundsHandleOnline=this._handleOnline.bind(this)}render(){return this.error&&(this.dispatchEvent(new CustomEvent("grampsjs:error",{bubbles:!0,composed:!0,detail:{message:this._errorMessage}})),!this.renderOnError)?"":this.loading?this.renderLoading():this.renderContent()}renderLoading(){return""}getUrl(){return""}update(t){super.update(t),this.getUrl()!==this._oldUrl&&this._updateData()}_updateData(t=!0){const e=this.getUrl();this._oldUrl=e,""!==e&&(t&&this._clearData(),this.loading=!0,On(e).then((t=>{this.loading=!1,"data"in t?(this._data={data:t.data},this.error=!1):"error"in t&&(this.error=!0,this._errorMessage=t.error)})))}_clearData(){this._data={}}_handleOnline(){this.error&&this._updateData()}connectedCallback(){super.connectedCallback(),window.addEventListener("db:changed",this._boundUpdateData),window.addEventListener("online",this._boundHandleOnline)}disconnectedCallback(){window.removeEventListener("online",this._boundHandleOnline),window.removeEventListener("db:changed",this._boundUpdateData),super.disconnectedCallback()}}window.customElements.define("grampsjs-filter-tags",class extends fm{static get styles(){return[nl,n`
        h3 {
          font-size: 14px;
          text-transform: uppercase;
          font-family: var(--grampsjs-body-font-family);
          font-weight: 500;
          color: var(--mdc-theme-primary);
          border-color: var(--mdc-theme-primary);
          border-bottom-width: 1px;
        }
      `]}static get properties(){return{filters:{type:Array}}}constructor(){super(),this.filters=[]}renderContent(){return M`
      <h3>${this._("Tags")}</h3>
      ${this._data.data.map((t=>M`
          <mwc-formfield label="${t.name}">
            <mwc-checkbox
              id="${t.handle}"
              @change="${this._handleChange}"
              ?checked="${this.filters.filter((t=>"HasTag"===t.name)).filter((e=>e.values[0]===t.name)).length>0}"
            ></mwc-checkbox>
          </mwc-formfield>
        `))}
    `}getUrl(){return"/api/tags/"}_handleChange(){os(this,"filter:changed",{filters:{rules:[...this.renderRoot.querySelectorAll("mwc-checkbox")].map((t=>this._checkboxToTag(t))).filter((t=>t.checked)).map((t=>({name:"HasTag",values:t.values})))},replace:"HasTag"})}_checkboxToTag(t){const e=t.id,[i]=this._data.data.filter((t=>t.handle===e));return{values:[i.name],checked:t.checked}}});window.customElements.define("grampsjs-view-people",class extends cm{constructor(){super(),this._columns={grampsId:{title:"Gramps ID",sort:"gramps_id"},surname:{title:"Surname",sort:"surname"},given:{title:"Given name",sort:""},birth:{title:"Birth Date",sort:"birth"},death:{title:"Death Date",sort:"death"},change:{title:"Last changed",sort:"change"}},this._objectsName="people"}get _fetchUrl(){return`/api/people/?locale=${this.strings?.__lang__||"en"}&profile=self&keys=gramps_id,profile,change`}_getItemPath(t){return`person/${t.grampsId}`}_getAddPath(){return"new_person"}_formatRow(t){return{grampsId:t.gramps_id,surname:t?.profile?.name_surname,given:t?.profile?.name_given,birth:t?.profile?.birth?.date,death:t?.profile?.death?.date,change:ns(t.change,this.strings.__lang__)}}renderFilters(){return M`
      <grampsjs-filter-years
        .strings="${this.strings}"
        label="Birth year"
        rule="HasBirth"
      >
      </grampsjs-filter-years>
      <grampsjs-filter-years
        .strings="${this.strings}"
        label="Death year"
        rule="HasDeath"
      >
      </grampsjs-filter-years>

      <grampsjs-filter-properties
        .strings="${this.strings}"
        .props="${ds}"
      ></grampsjs-filter-properties>

      <grampsjs-filter-properties
        hasCount
        .strings="${this.strings}"
        .props="${hs.people}"
        label="${this._("Associations")}"
      ></grampsjs-filter-properties>

      <grampsjs-filter-tags .strings="${this.strings}"></grampsjs-filter-tags>
    `}});window.customElements.define("grampsjs-view-families",class extends cm{constructor(){super(),this._columns={grampsId:{title:"Gramps ID",sort:"gramps_id"},father:{title:"Father",sort:"surname"},mother:{title:"Mother",sort:""},change:{title:"Last changed",sort:"change"}},this._objectsName="families"}get _fetchUrl(){return`/api/families/?locale=${this.strings?.__lang__||"en"}&profile=self&keys=gramps_id,profile,change`}_getItemPath(t){return`family/${t.grampsId}`}_getAddPath(){return"new_family"}renderFilters(){return M`
      <grampsjs-filter-type
        .strings="${this.strings}"
        label="${this._("Relationship type:").replace(":","")}"
        typeName="family_relation_types"
        rule="HasRelType"
      ></grampsjs-filter-type>

      <grampsjs-filter-properties
        hasCount
        .strings="${this.strings}"
        .props="${hs.families}"
        label="${this._("Associations")}"
      ></grampsjs-filter-properties>

      <grampsjs-filter-tags .strings="${this.strings}"></grampsjs-filter-tags>
    `}_formatRow(t){return{grampsId:t.gramps_id,father:`${t?.profile?.father?.name_surname||""}, ${t?.profile?.father?.name_given||""}`,mother:`${t?.profile?.mother?.name_surname||""}, ${t?.profile?.mother?.name_given||""}`,change:ns(t.change,this.strings.__lang__)}}});window.customElements.define("grampsjs-view-places",class extends cm{constructor(){super(),this._columns={grampsId:{title:"Gramps ID",sort:"gramps_id"},title:{title:"Name",sort:"title"},change:{title:"Last changed",sort:"change"}},this._objectsName="places"}get _fetchUrl(){return"/api/places/?keys=gramps_id,name,change"}_getItemPath(t){return`place/${t.grampsId}`}_getAddPath(){return"new_place"}renderFilters(){return M`
      <grampsjs-filter-properties
        hasCount
        .strings="${this.strings}"
        .props="${hs.places}"
        label="${this._("Associations")}"
      ></grampsjs-filter-properties>

      <grampsjs-filter-tags .strings="${this.strings}"></grampsjs-filter-tags>
    `}_formatRow(t){return{grampsId:t.gramps_id,title:t.name.value,change:ns(t.change,this.strings.__lang__)}}});const gm=Symbol("selection controller");class _m{constructor(){this.selected=null,this.ordered=null,this.set=new Set}}class vm{constructor(t){this.sets={},this.focusedSet=null,this.mouseIsDown=!1,this.updating=!1,t.addEventListener("keydown",(t=>{this.keyDownHandler(t)})),t.addEventListener("mousedown",(()=>{this.mousedownHandler()})),t.addEventListener("mouseup",(()=>{this.mouseupHandler()}))}static getController(t){const e=!("global"in t)||"global"in t&&t.global?document:t.getRootNode();let i=e[gm];return void 0===i&&(i=new vm(e),e[gm]=i),i}keyDownHandler(t){const e=t.target;"checked"in e&&this.has(e)&&("ArrowRight"==t.key||"ArrowDown"==t.key?this.selectNext(e):"ArrowLeft"!=t.key&&"ArrowUp"!=t.key||this.selectPrevious(e))}mousedownHandler(){this.mouseIsDown=!0}mouseupHandler(){this.mouseIsDown=!1}has(t){return this.getSet(t.name).set.has(t)}selectPrevious(t){const e=this.getOrdered(t),i=e.indexOf(t),r=e[i-1]||e[e.length-1];return this.select(r),r}selectNext(t){const e=this.getOrdered(t),i=e.indexOf(t),r=e[i+1]||e[0];return this.select(r),r}select(t){t.click()}focus(t){if(this.mouseIsDown)return;const e=this.getSet(t.name),i=this.focusedSet;this.focusedSet=e,i!=e&&e.selected&&e.selected!=t&&e.selected.focus()}isAnySelected(t){const e=this.getSet(t.name);for(const t of e.set)if(t.checked)return!0;return!1}getOrdered(t){const e=this.getSet(t.name);return e.ordered||(e.ordered=Array.from(e.set),e.ordered.sort(((t,e)=>t.compareDocumentPosition(e)==Node.DOCUMENT_POSITION_PRECEDING?1:0))),e.ordered}getSet(t){return this.sets[t]||(this.sets[t]=new _m),this.sets[t]}register(t){const e=t.name||t.getAttribute("name")||"",i=this.getSet(e);i.set.add(t),i.ordered=null}unregister(t){const e=this.getSet(t.name);e.set.delete(t),e.ordered=null,e.selected==t&&(e.selected=null)}update(t){if(this.updating)return;this.updating=!0;const e=this.getSet(t.name);if(t.checked){for(const i of e.set)i!=t&&(i.checked=!1);e.selected=t}if(this.isAnySelected(t))for(const t of e.set){if(void 0===t.formElementTabIndex)break;t.formElementTabIndex=t.checked?0:-1}this.updating=!1}}var ym={NATIVE_CONTROL_SELECTOR:".mdc-radio__native-control"},bm={DISABLED:"mdc-radio--disabled",ROOT:"mdc-radio"},xm=function(t){function e(i){return t.call(this,et(et({},e.defaultAdapter),i))||this}return tt(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return bm},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return ym},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNativeControlDisabled:function(){}}},enumerable:!1,configurable:!0}),e.prototype.setDisabled=function(t){var i=e.cssClasses.DISABLED;this.adapter.setNativeControlDisabled(t),t?this.adapter.addClass(i):this.adapter.removeClass(i)},e}(vt);class wm extends hi{constructor(){super(...arguments),this._checked=!1,this.useStateLayerCustomProperties=!1,this.global=!1,this.disabled=!1,this.value="on",this.name="",this.reducedTouchTarget=!1,this.mdcFoundationClass=xm,this.formElementTabIndex=0,this.focused=!1,this.shouldRenderRipple=!1,this.rippleElement=null,this.rippleHandlers=new de((()=>(this.shouldRenderRipple=!0,this.ripple.then((t=>{this.rippleElement=t})),this.ripple)))}get checked(){return this._checked}set checked(t){var e,i;const r=this._checked;t!==r&&(this._checked=t,this.formElement&&(this.formElement.checked=t),null===(e=this._selectionController)||void 0===e||e.update(this),!1===t&&(null===(i=this.formElement)||void 0===i||i.blur()),this.requestUpdate("checked",r),this.dispatchEvent(new Event("checked",{bubbles:!0,composed:!0})))}_handleUpdatedValue(t){this.formElement.value=t}renderRipple(){return this.shouldRenderRipple?M`<mwc-ripple unbounded accent
        .internalUseStateLayerCustomProperties="${this.useStateLayerCustomProperties}"
        .disabled="${this.disabled}"></mwc-ripple>`:""}get isRippleActive(){var t;return(null===(t=this.rippleElement)||void 0===t?void 0:t.isActive)||!1}connectedCallback(){super.connectedCallback(),this._selectionController=vm.getController(this),this._selectionController.register(this),this._selectionController.update(this)}disconnectedCallback(){this._selectionController.unregister(this),this._selectionController=void 0}focus(){this.formElement.focus()}createAdapter(){return Object.assign(Object.assign({},kt(this.mdcRoot)),{setNativeControlDisabled:t=>{this.formElement.disabled=t}})}handleFocus(){this.focused=!0,this.handleRippleFocus()}handleClick(){this.formElement.focus()}handleBlur(){this.focused=!1,this.formElement.blur(),this.rippleHandlers.endFocus()}setFormData(t){this.name&&this.checked&&t.append(this.name,this.value)}render(){const t={"mdc-radio--touch":!this.reducedTouchTarget,"mdc-ripple-upgraded--background-focused":this.focused,"mdc-radio--disabled":this.disabled};return M`
      <div class="mdc-radio ${Ot(t)}">
        <input
          tabindex="${this.formElementTabIndex}"
          class="mdc-radio__native-control"
          type="radio"
          name="${this.name}"
          aria-label="${Ke(this.ariaLabel)}"
          aria-labelledby="${Ke(this.ariaLabelledBy)}"
          .checked="${this.checked}"
          .value="${this.value}"
          ?disabled="${this.disabled}"
          @change="${this.changeHandler}"
          @focus="${this.handleFocus}"
          @click="${this.handleClick}"
          @blur="${this.handleBlur}"
          @mousedown="${this.handleRippleMouseDown}"
          @mouseenter="${this.handleRippleMouseEnter}"
          @mouseleave="${this.handleRippleMouseLeave}"
          @touchstart="${this.handleRippleTouchStart}"
          @touchend="${this.handleRippleDeactivate}"
          @touchcancel="${this.handleRippleDeactivate}">
        <div class="mdc-radio__background">
          <div class="mdc-radio__outer-circle"></div>
          <div class="mdc-radio__inner-circle"></div>
        </div>
        ${this.renderRipple()}
      </div>`}handleRippleMouseDown(t){const e=()=>{window.removeEventListener("mouseup",e),this.handleRippleDeactivate()};window.addEventListener("mouseup",e),this.rippleHandlers.startPress(t)}handleRippleTouchStart(t){this.rippleHandlers.startPress(t)}handleRippleDeactivate(){this.rippleHandlers.endPress()}handleRippleMouseEnter(){this.rippleHandlers.startHover()}handleRippleMouseLeave(){this.rippleHandlers.endHover()}handleRippleFocus(){this.rippleHandlers.startFocus()}changeHandler(){this.checked=this.formElement.checked}}it([ht(".mdc-radio")],wm.prototype,"mdcRoot",void 0),it([ht("input")],wm.prototype,"formElement",void 0),it([lt()],wm.prototype,"useStateLayerCustomProperties",void 0),it([ot({type:Boolean})],wm.prototype,"global",void 0),it([ot({type:Boolean,reflect:!0})],wm.prototype,"checked",null),it([ot({type:Boolean}),Mt((function(t){this.mdcFoundation.setDisabled(t)}))],wm.prototype,"disabled",void 0),it([ot({type:String}),Mt((function(t){this._handleUpdatedValue(t)}))],wm.prototype,"value",void 0),it([ot({type:String})],wm.prototype,"name",void 0),it([ot({type:Boolean})],wm.prototype,"reducedTouchTarget",void 0),it([ot({type:Number})],wm.prototype,"formElementTabIndex",void 0),it([lt()],wm.prototype,"focused",void 0),it([lt()],wm.prototype,"shouldRenderRipple",void 0),it([pt("mwc-ripple")],wm.prototype,"ripple",void 0),it([Xe,ot({attribute:"aria-label"})],wm.prototype,"ariaLabel",void 0),it([Xe,ot({attribute:"aria-labelledby"})],wm.prototype,"ariaLabelledBy",void 0),it([dt({passive:!0})],wm.prototype,"handleRippleTouchStart",null);const km=n`.mdc-touch-target-wrapper{display:inline}.mdc-radio{padding:calc((40px - 20px) / 2)}.mdc-radio .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:rgba(0, 0, 0, 0.54)}.mdc-radio .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786)}.mdc-radio .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:#018786;border-color:var(--mdc-theme-secondary, #018786)}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:rgba(0, 0, 0, 0.38)}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:rgba(0, 0, 0, 0.38)}.mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:rgba(0, 0, 0, 0.38)}.mdc-radio .mdc-radio__background::before{background-color:#018786;background-color:var(--mdc-theme-secondary, #018786)}.mdc-radio .mdc-radio__background::before{top:calc(-1 * (40px - 20px) / 2);left:calc(-1 * (40px - 20px) / 2);width:40px;height:40px}.mdc-radio .mdc-radio__native-control{top:calc((40px - 40px) / 2);right:calc((40px - 40px) / 2);left:calc((40px - 40px) / 2);width:40px;height:40px}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-radio.mdc-radio--disabled [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio.mdc-radio--disabled .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:GrayText}.mdc-radio.mdc-radio--disabled [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio.mdc-radio--disabled .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:GrayText}.mdc-radio.mdc-radio--disabled [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio.mdc-radio--disabled .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:GrayText}}.mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color}.mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;z-index:1}.mdc-radio--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-radio--touch .mdc-radio__native-control{top:calc((40px - 48px) / 2);right:calc((40px - 48px) / 2);left:calc((40px - 48px) / 2);width:48px;height:48px}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{pointer-events:none;border:2px solid transparent;border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{border-color:CanvasText}}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{content:"";border:2px solid transparent;border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{border-color:CanvasText}}.mdc-radio__native-control:checked+.mdc-radio__background,.mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{transition:border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio--disabled{cursor:default;pointer-events:none}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle{transform:scale(0.5);transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:disabled+.mdc-radio__background,[aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background{cursor:default}.mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}:host{display:inline-block;outline:none}.mdc-radio{vertical-align:bottom}.mdc-radio .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unchecked-color, rgba(0, 0, 0, 0.54))}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-color, rgba(0, 0, 0, 0.38))}.mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-color, rgba(0, 0, 0, 0.38))}.mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-disabled-color, rgba(0, 0, 0, 0.38))}`;let Tm=class extends wm{};Tm.styles=[km],Tm=it([at("mwc-radio")],Tm);class Sm extends(al(K)){static get styles(){return[nl,n`
        h3 {
          font-size: 14px;
          text-transform: uppercase;
          font-family: var(--grampsjs-body-font-family);
          font-weight: 500;
          color: var(--mdc-theme-primary);
          border-color: var(--mdc-theme-primary);
          border-bottom-width: 1px;
        }
      `]}static get properties(){return{filters:{type:Array},label:{type:String},types:{type:Object},loadingTypes:{type:Boolean},typesLocale:{type:Object},typeName:{type:String},rule:{type:String}}}constructor(){super(),this.filters=[],this.label="",this.types={},this.typesLocale={},this.typeName="",this.loadingTypes=!1,this.rule="HasType"}render(){return M`
      <h3>${this.label||this._("Type")}</h3>
      <grampsjs-form-select-type
        id="type"
        noheading
        nocustom
        valueNonLocal
        label="${this.label||this._("Type")}"
        .strings="${this.strings}"
        typeName="${this.typeName}"
        defaultTypeName=""
        ?loadingTypes=${this.loadingTypes}
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
        @formdata:changed="${this._handleChange}"
      >
      </grampsjs-form-select-type>
    `}updateTypeData(){this.loadingTypes=!0,On("/api/types/").then((t=>{"data"in t?this.types=t.data||{}:"error"in t&&os(this,"grampsjs:error",{message:t.error})})).then((()=>{On("/api/types/?locale=1").then((t=>{this.loadingTypes=!1,"data"in t?(this.typesLocale=t.data||{},this.error=!1):"error"in t&&os(this,"grampsjs:error",{message:t.error})}))}))}firstUpdated(){this.updateTypeData()}_handleChange(t){const e=t.detail.data;os(this,"filter:changed",{filters:{rules:[{name:this.rule,values:[e]}]},replace:this.rule})}}window.customElements.define("grampsjs-filter-type",Sm);window.customElements.define("grampsjs-view-events",class extends cm{constructor(){super(),this._columns={grampsId:{title:"Gramps ID",sort:"gramps_id"},type:{title:"Event Type",sort:"type"},date:{title:"Date",sort:"date"},place:{title:"Place",sort:"place"},change:{title:"Last changed",sort:"change"}},this._objectsName="events"}get _fetchUrl(){return`/api/events/?locale=${this.strings?.__lang__||"en"}&profile=self&keys=gramps_id,profile,change`}_getItemPath(t){return`event/${t.grampsId}`}_getAddPath(){return"new_event"}renderFilters(){return M`
      <grampsjs-filter-years
        .strings="${this.strings}"
        dateIndex="1"
        numArgs="4"
        label="${this._("Event Year")}"
        rule="HasData"
      ></grampsjs-filter-years>

      <grampsjs-filter-type
        .strings="${this.strings}"
        label="${this._("Event Type")}"
        typeName="event_types"
      ></grampsjs-filter-type>

      <grampsjs-filter-properties
        hasCount
        .strings="${this.strings}"
        .props="${hs.events}"
        label="${this._("Associations")}"
      ></grampsjs-filter-properties>

      <grampsjs-filter-tags .strings="${this.strings}"></grampsjs-filter-tags>
    `}_formatRow(t){return{grampsId:t.gramps_id,type:t?.profile?.type,date:t?.profile?.date,place:t?.profile?.place,change:ns(t.change,this.strings.__lang__)}}});const Cm=["css","of","style"];class Em extends(al(K)){static get styles(){return[nl,n`
        .option {
          margin-bottom: 1em;
        }

        .label {
          margin-right: 1em;
          width: 20em;
          display: inline-block;
          font-size: 16px;
          line-height: 24px;
          vertical-align: middle;
          margin-bottom: 0.5em;
        }

        .form {
          vertical-align: middle;
        }

        mwc-textfield,
        mwc-select {
          min-width: 20em;
          max-width: 100%;
        }

        mwc-switch {
          --mdc-switch-selected-track-color: rgba(109, 76, 65, 0.3);
        }
      `]}static get properties(){return{optionsDict:{type:Array},optionsHelp:{type:Array},_options:{type:Object}}}constructor(){super(),this.optionsDict=[],this.optionsHelp=[],this._options={}}render(){return M`
      ${Object.keys(this.optionsDict).filter((t=>!Cm.includes(t))).map((t=>this._renderOption(t)))}
    `}_renderOption(t){const e=this.optionsHelp[t][2];return"Array"===e.constructor.name?2===e.length&&"False"===e.sort()[0]&&"True"===e.sort()[1]?this._renderBooleanOption(t):this._renderArrayOption(t):this._renderStringOption(t)}_renderBooleanOption(t){return M`
      <div class="option">
        <span class="label">${this._(this.optionsHelp[t][1])||t}</span>
        <span class="form">
          <mwc-switch
            id="${t}"
            ?selected="${"true"===this.optionsDict[t]}"
            @click="${this._handleSwitch}"
          >
          </mwc-switch>
        </span>
      </div>
    `}_renderArrayOption(t){return M`
      <div class="option">
        <span class="label">${this._(this.optionsHelp[t][1])||t}</span>
        <span class="form">
          <mwc-select id="${t}" @change="${this._handleSelect}">
            ${this.optionsHelp[t][2].map((e=>this._renderSelectItem(e,this.optionsDict[t])))}
          </mwc-select>
        </span>
      </div>
    `}_renderStringOption(t){const e=this._(this.optionsHelp[t][1])||t,i=this.optionsHelp[t][2];return M`
      <div class="option">
        <span class="label">${e}</span>
        <span class="form">
          <mwc-textfield
            @input="${this._handleText}"
            id="${t}"
            helper="${this._(i)}"
            helperPersistent
            type="${i.includes("A number")?"number":"text"}"
          ></mwc-textfield>
        </span>
      </div>
    `}_renderSelectItem(t,e){const i=t.split("\t"),r=i[0]===`${e}`||"pdf"===i[0];return M`
      <mwc-list-item value="${i[0]}" ?selected=${r}
        >${this._(1===i.length?i[0]:i[1])}</mwc-list-item
      >
    `}_handleSwitch(t){this._options={...this._options,[t.target.id]:t.target.selected?"True":"False"},os(this,"report-options:changed",this._options)}_handleSelect(t){this._options={...this._options,[t.target.id]:t.target.value},os(this,"report-options:changed",this._options)}_handleText(t){this._options={...this._options,[t.target.id]:t.target.value},os(this,"report-options:changed",this._options)}}window.customElements.define("grampsjs-report-options",Em);window.customElements.define("grampsjs-view-report",class extends $d{static get styles(){return[super.styles,n`
        :host {
          padding-bottom: 2em;
        }

        h2 mwc-icon-button {
          color: var(--mdc-theme-primary);
        }
      `]}static get properties(){return{reportId:{type:String},data:{type:Object},_queryUrl:{type:String},_options:{type:Object}}}constructor(){super(),this.reportId="",this.data={},this._queryUrl="",this._options={}}renderContent(){return"id"in this.data?M`
      <h2>
        <mwc-icon-button
          icon="arrow_back"
          @click="${this._handleBack}"
        ></mwc-icon-button>
        ${this._(this.data.name)}
      </h2>
      <dl style="clear:left;">
        <div>
          <dt>${this._("Description")}</dt>
          <dd>${this._(this.data.description)}</dd>
        </div>
        <div>
          <dt>${this._("Author")}</dt>
          <dd>${this.data.authors.join("")}</dd>
        </div>
        <div>
          <dt>${this._("Version")}</dt>
          <dd>${this.data.version}</dd>
        </div>
      </dl>
      <div style="clear:left;"></div>

      <h3>${this._("Options")}</h3>

      <grampsjs-report-options
        .optionsDict="${this.data.options_dict}"
        .optionsHelp="${this.data.options_help}"
        @report-options:changed="${this._handleOptionsChanged}"
        .strings="${this.strings}"
      ></grampsjs-report-options>

      <mwc-button unelevated @click="${this._handleSubmit}"
        >${this._("_Generate").replace("_","")}</mwc-button
      >
      <a download href="${this._queryUrl}" id="submitanchor" target="_blank"
        >&nbsp;</a
      >
    `:""}async _fetchData(){this.loading=!0;const t=await On(`/api/reports/${this.reportId}`);this.loading=!1,"data"in t?(this.error=!1,this.data=t.data):"error"in t&&(this.error=!0,this._errorMessage=t.error)}firstUpdated(){"__lang__"in this.strings&&this._fetchData(this.strings.__lang__),this._updateQueryUrl()}update(t){super.update(t),t.has("reportId")&&(this.data={},this._fetchData())}_updateQueryUrl(){const t=Object.keys(this._options).reduce(((t,e)=>(""!==this._options[e]&&(t[e]=`${this._options[e]}`),t)),{});this._queryUrl=function(t,e){const i=localStorage.getItem("access_token"),r=`options=${encodeURIComponent(JSON.stringify(e))}`;return null===i?`${Cn}/api/reports/${t}/file?${r}`:`${Cn}/api/reports/${t}/file?jwt=${i}&${r}`}(this.reportId,t)}_handleSubmit(){this.shadowRoot.querySelector("#submitanchor").click()}_handleOptionsChanged(t){this._options={...t.detail},this._updateQueryUrl()}_handleBack(){os(this,"nav",{path:"reports"})}});window.customElements.define("grampsjs-view-reports",class extends $d{static get styles(){return[super.styles,n`
        .hidden {
          display: none;
        }
      `]}static get properties(){return{data:{type:Array},_formData:{type:Object},_queryUrl:{type:String}}}constructor(){super(),this.data=[],this._formData={exporter:"gramps",options:{compress:!0}},this._queryUrl=""}renderContent(){return M`
      <h2>${this._("_Reports").replace("_","")}</h2>
      <mwc-list>
        ${this.data.map((t=>this._selectListItem(t)))}
      </mwc-list>
    `}_selectListItem(t){return M`
      <li divider role="separator" padded></li>
      <mwc-list-item
        twoline
        graphic="icon"
        @click="${()=>this._handleItemClick(t.id)}"
      >
        <mwc-icon slot="graphic"
          >${us[t.category]||"menu_book"}</mwc-icon
        >
        <span>${this._(t.name)}</span>
        <span slot="secondary">${this._(t.description)}</span>
      </mwc-list-item>
    `}_handleItemClick(t){os(this,"nav",{path:`report/${t}`})}async _fetchData(){this.loading=!0;const t=await On("/api/reports/");this.loading=!1,"data"in t?(this.error=!1,this.data=t.data):"error"in t&&(this.error=!0,this._errorMessage=t.error)}firstUpdated(){"__lang__"in this.strings&&this._fetchData(this.strings.__lang__)}connectedCallback(){super.connectedCallback(),window.addEventListener("language:changed",(t=>this._handleLanguageChanged(t)))}_handleLanguageChanged(t){this._hasFirstUpdated&&this._fetchData(t.detail.lang)}});window.customElements.define("grampsjs-view-sources",class extends cm{constructor(){super(),this._columns={grampsId:{title:"Gramps ID",sort:"gramps_id"},title:{title:"Title",sort:"title"},author:{title:"Author",sort:"author"},pubinfo:{title:"Publication info",sort:"pubinfo"},change:{title:"Last changed",sort:"change"}},this._objectsName="sources"}get _fetchUrl(){return"/api/sources/?keys=gramps_id,title,author,pubinfo,change"}_getItemPath(t){return`source/${t.grampsId}`}_getAddPath(){return"new_source"}renderFilters(){return M`
      <grampsjs-filter-properties
        hasCount
        .strings="${this.strings}"
        .props="${hs.sources}"
        label="${this._("Associations")}"
      ></grampsjs-filter-properties>

      <grampsjs-filter-tags .strings="${this.strings}"></grampsjs-filter-tags>
    `}_formatRow(t){return{grampsId:t.gramps_id,title:t.title,author:t.author,pubinfo:t.pubinfo,change:ns(t.change,this.strings.__lang__)}}});window.customElements.define("grampsjs-view-citations",class extends cm{constructor(){super(),this._columns={grampsId:{title:"Gramps ID",sort:"gramps_id"},sourceTitle:{title:"Source: Title",sort:""},page:{title:"Page",sort:""},change:{title:"Last changed",sort:"change"}},this._objectsName="citations"}get _fetchUrl(){return"/api/citations/?extend=source_handle&keys=gramps_id,extended,page,change"}_getItemPath(t){return`citation/${t.grampsId}`}_getAddPath(){return"new_citation"}renderFilters(){return M`
      <grampsjs-filter-properties
        hasCount
        .strings="${this.strings}"
        .props="${hs.citations}"
        label="${this._("Associations")}"
      ></grampsjs-filter-properties>

      <grampsjs-filter-tags .strings="${this.strings}"></grampsjs-filter-tags>
    `}_formatRow(t){return{grampsId:t.gramps_id,sourceTitle:t.extended.source?.title,page:t.page,change:ns(t.change,this.strings.__lang__)}}});window.customElements.define("grampsjs-view-repositories",class extends cm{constructor(){super(),this._columns={grampsId:{title:"Gramps ID",sort:"gramps_id"},name:{title:"Name",sort:"name"},type:{title:"Type",sort:"type"},change:{title:"Last changed",sort:"change"}}}get _fetchUrl(){return"/api/repositories/?keys=gramps_id,name,type,change"}_getItemPath(t){return`repository/${t.grampsId}`}_getAddPath(){return"new_repository"}_formatRow(t){return{grampsId:t.gramps_id,name:t.name,type:this._(t.type),change:ns(t.change,this.strings.__lang__)}}});window.customElements.define("grampsjs-view-notes",class extends cm{constructor(){super(),this._columns={grampsId:{title:"Gramps ID",sort:"gramps_id"},type:{title:"Type",sort:"type"},text:{title:"Text",sort:"text"},change:{title:"Last changed",sort:"change"}}}get _fetchUrl(){return"/api/notes/?keys=gramps_id,type,text,change"}_getItemPath(t){return`note/${t.grampsId}`}_getAddPath(){return"new_note"}_formatRow(t,e){return{grampsId:t.gramps_id,type:e._(t.type),text:t?.text?.string,change:ns(t.change,this.strings.__lang__)}}renderFilters(){return M`
      <grampsjs-filter-type
        .strings="${this.strings}"
        label="${this._("Note type:").replace(":","")}"
        typeName="note_types"
      ></grampsjs-filter-type>
    `}});class $m extends(al(K)){static get styles(){return[nl,n`
        h3 {
          font-size: 14px;
          text-transform: uppercase;
          font-family: var(--grampsjs-body-font-family);
          font-weight: 500;
          color: var(--mdc-theme-primary);
          border-color: var(--mdc-theme-primary);
          border-bottom-width: 1px;
        }
      `]}static get properties(){return{filters:{type:Array}}}constructor(){super(),this.filters=[]}render(){return M`
      <h3>${this._("_Media Type:").replace(":","")}</h3>
      ${Object.keys(ps).map((t=>M`
          <mwc-formfield label="${this._(ps[t])}">
            <mwc-radio
              id="${t}"
              @change="${this._handleChange}"
              ?checked="${this.filters.filter((e=>"HasMedia"===e.name&&e.values[1]===t)).length>0}"
            ></mwc-radio>
          </mwc-formfield>
        `))}
    `}_handleChange(t){os(this,"filter:changed",{filters:{rules:[{name:"HasMedia",values:["",t.target.id,"",""]}]},replace:"HasMedia"})}}window.customElements.define("grampsjs-filter-mime",$m);window.customElements.define("grampsjs-view-media-objects",class extends cm{static get styles(){return[super.styles,n`
        .tile {
          margin: 15px 5px;
          float: left;
          cursor: pointer;
          padding: 5px;
          width: 200px;
          height: 230px;
          white-space: nowrap;
          text-overflow: ellipsis;
          overflow: hidden;
          position: relative;
        }

        .clear {
          clear: both;
          padding-bottom: 2em;
        }

        .tile span {
          color: #666;
          font-size: 15px;
          position: absolute;
          bottom: 0px;
          width: 200px;
          text-overflow: ellipsis;
          overflow: hidden;
        }
      `]}constructor(){super(),this._columns={grampsId:{title:"Gramps ID",sort:"gramps_id"},mime:{title:"Type",sort:"mime"},desc:{title:"Description",sort:"title"},change:{title:"Last changed",sort:"change"}},this._objectsName="media"}get _fetchUrl(){return"/api/media/?keys=gramps_id,mime,desc,change,handle"}_getItemPath(t){return`media/${t.grampsId}`}_getAddPath(){return"new_media"}renderFilters(){return M`
      <grampsjs-filter-mime .strings="${this.strings}"></grampsjs-filter-mime>

      <grampsjs-filter-properties
        hasCount
        .strings="${this.strings}"
        .props="${hs.media}"
        label="${this._("Associations")}"
      ></grampsjs-filter-properties>

      <grampsjs-filter-tags .strings="${this.strings}"></grampsjs-filter-tags>
    `}renderAltView(){return M`
      <div class="clear"></div>
      ${this._rawData.map((t=>this._renderTile(t)))}
      <div class="clear"></div>
    `}_renderTile(t){return t?M`<div class="tile">
      <grampsjs-img
        handle="${t.handle}"
        size="200"
        displayHeight="200"
        square
        mime="${t.mime}"
        @click="${()=>this._handleImageClick(t)}"
      ></grampsjs-img
      ><br /><span>${t.desc}</span>
    </div>`:""}_handleImageClick(t){os(this,"nav",{path:`media/${t.gramps_id}`})}_renderViewButton(){return M`
      <mwc-icon-button
        icon="${this.altView?"list":"grid_view"}"
        @click="${this._handleViewBtn}"
      ></mwc-icon-button>
    `}_handleViewBtn(){this.altView=!this.altView}_formatRow(t){return{grampsId:t.gramps_id,mime:t.mime,desc:t.desc,change:ns(t.change,this.strings.__lang__)}}});const Am=vh`:host{--_container-color: var(--md-filled-icon-button-container-color, var(--md-sys-color-primary, #6750a4));--_container-height: var(--md-filled-icon-button-container-height, 40px);--_container-width: var(--md-filled-icon-button-container-width, 40px);--_disabled-container-color: var(--md-filled-icon-button-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-container-opacity: var(--md-filled-icon-button-disabled-container-opacity, 0.12);--_disabled-icon-color: var(--md-filled-icon-button-disabled-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-icon-opacity: var(--md-filled-icon-button-disabled-icon-opacity, 0.38);--_focus-icon-color: var(--md-filled-icon-button-focus-icon-color, var(--md-sys-color-on-primary, #fff));--_hover-icon-color: var(--md-filled-icon-button-hover-icon-color, var(--md-sys-color-on-primary, #fff));--_hover-state-layer-color: var(--md-filled-icon-button-hover-state-layer-color, var(--md-sys-color-on-primary, #fff));--_hover-state-layer-opacity: var(--md-filled-icon-button-hover-state-layer-opacity, 0.08);--_icon-color: var(--md-filled-icon-button-icon-color, var(--md-sys-color-on-primary, #fff));--_icon-size: var(--md-filled-icon-button-icon-size, 24px);--_pressed-icon-color: var(--md-filled-icon-button-pressed-icon-color, var(--md-sys-color-on-primary, #fff));--_pressed-state-layer-color: var(--md-filled-icon-button-pressed-state-layer-color, var(--md-sys-color-on-primary, #fff));--_pressed-state-layer-opacity: var(--md-filled-icon-button-pressed-state-layer-opacity, 0.12);--_selected-container-color: var(--md-filled-icon-button-selected-container-color, var(--md-sys-color-primary, #6750a4));--_toggle-selected-focus-icon-color: var(--md-filled-icon-button-toggle-selected-focus-icon-color, var(--md-sys-color-on-primary, #fff));--_toggle-selected-hover-icon-color: var(--md-filled-icon-button-toggle-selected-hover-icon-color, var(--md-sys-color-on-primary, #fff));--_toggle-selected-hover-state-layer-color: var(--md-filled-icon-button-toggle-selected-hover-state-layer-color, var(--md-sys-color-on-primary, #fff));--_toggle-selected-icon-color: var(--md-filled-icon-button-toggle-selected-icon-color, var(--md-sys-color-on-primary, #fff));--_toggle-selected-pressed-icon-color: var(--md-filled-icon-button-toggle-selected-pressed-icon-color, var(--md-sys-color-on-primary, #fff));--_toggle-selected-pressed-state-layer-color: var(--md-filled-icon-button-toggle-selected-pressed-state-layer-color, var(--md-sys-color-on-primary, #fff));--_unselected-container-color: var(--md-filled-icon-button-unselected-container-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_toggle-focus-icon-color: var(--md-filled-icon-button-toggle-focus-icon-color, var(--md-sys-color-primary, #6750a4));--_toggle-hover-icon-color: var(--md-filled-icon-button-toggle-hover-icon-color, var(--md-sys-color-primary, #6750a4));--_toggle-hover-state-layer-color: var(--md-filled-icon-button-toggle-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--_toggle-icon-color: var(--md-filled-icon-button-toggle-icon-color, var(--md-sys-color-primary, #6750a4));--_toggle-pressed-icon-color: var(--md-filled-icon-button-toggle-pressed-icon-color, var(--md-sys-color-primary, #6750a4));--_toggle-pressed-state-layer-color: var(--md-filled-icon-button-toggle-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--_container-shape-start-start: var(--md-filled-icon-button-container-shape-start-start, var(--md-filled-icon-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-start-end: var(--md-filled-icon-button-container-shape-start-end, var(--md-filled-icon-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-end: var(--md-filled-icon-button-container-shape-end-end, var(--md-filled-icon-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-start: var(--md-filled-icon-button-container-shape-end-start, var(--md-filled-icon-button-container-shape, var(--md-sys-shape-corner-full, 9999px)))}.icon-button{color:var(--_icon-color);--md-ripple-hover-color: var(--_hover-state-layer-color);--md-ripple-hover-opacity: var(--_hover-state-layer-opacity);--md-ripple-pressed-color: var(--_pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_pressed-state-layer-opacity)}.icon-button:hover{color:var(--_hover-icon-color)}.icon-button:focus{color:var(--_focus-icon-color)}.icon-button:active{color:var(--_pressed-icon-color)}.icon-button:disabled{color:var(--_disabled-icon-color)}.icon-button::before{background-color:var(--_container-color);border-radius:inherit;content:"";inset:0;position:absolute;z-index:-1}.icon-button:disabled::before{background-color:var(--_disabled-container-color);opacity:var(--_disabled-container-opacity)}.icon-button:disabled .icon{opacity:var(--_disabled-icon-opacity)}.toggle-filled{--md-ripple-hover-color: var(--_toggle-hover-state-layer-color);--md-ripple-pressed-color: var(--_toggle-pressed-state-layer-color)}.toggle-filled:not(:disabled){color:var(--_toggle-icon-color)}.toggle-filled:not(:disabled):hover{color:var(--_toggle-hover-icon-color)}.toggle-filled:not(:disabled):focus{color:var(--_toggle-focus-icon-color)}.toggle-filled:not(:disabled):active{color:var(--_toggle-pressed-icon-color)}.toggle-filled:not(:disabled)::before{background-color:var(--_unselected-container-color)}.selected{--md-ripple-hover-color: var(--_toggle-selected-hover-state-layer-color);--md-ripple-pressed-color: var(--_toggle-selected-pressed-state-layer-color)}.selected:not(:disabled){color:var(--_toggle-selected-icon-color)}.selected:not(:disabled):hover{color:var(--_toggle-selected-hover-icon-color)}.selected:not(:disabled):focus{color:var(--_toggle-selected-focus-icon-color)}.selected:not(:disabled):active{color:var(--_toggle-selected-pressed-icon-color)}.selected:not(:disabled)::before{background-color:var(--_selected-container-color)}
`;function Im(t,e=!0){return e&&"rtl"===getComputedStyle(t).getPropertyValue("direction").trim()}const Mm=lu($p);class Lm extends Mm{constructor(){super(...arguments),this.disabled=!1,this.flipIconInRtl=!1,this.href="",this.target="",this.ariaLabelSelected="",this.toggle=!1,this.selected=!1,this.type="submit",this.value="",this.flipIcon=Im(this,this.flipIconInRtl)}get name(){return this.getAttribute("name")??""}set name(t){this.setAttribute("name",t)}get form(){return this[su].form}get labels(){return this[su].labels}willUpdate(){this.href&&(this.disabled=!1)}render(){const t=this.href?Zp`div`:Zp`button`,{ariaLabel:e,ariaHasPopup:i,ariaExpanded:r}=this,n=e&&this.ariaLabelSelected,a=this.toggle?this.selected:pp;let s=pp;return this.href||(s=n&&this.selected?this.ariaLabelSelected:e),Wp`<${t}
        class="icon-button ${zp(this.getRenderClasses())}"
        id="button"
        aria-label="${s||pp}"
        aria-haspopup="${!this.href&&i||pp}"
        aria-expanded="${!this.href&&r||pp}"
        aria-pressed="${a}"
        ?disabled="${!this.href&&this.disabled}"
        @click="${this.handleClick}">
        ${this.renderFocusRing()}
        ${this.renderRipple()}
        ${this.selected?pp:this.renderIcon()}
        ${this.selected?this.renderSelectedIcon():pp}
        ${this.renderTouchTarget()}
        ${this.href&&this.renderLink()}
  </${t}>`}renderLink(){const{ariaLabel:t}=this;return dp`
      <a
        class="link"
        id="link"
        href="${this.href}"
        target="${this.target||pp}"
        aria-label="${t||pp}"></a>
    `}getRenderClasses(){return{"flip-icon":this.flipIcon,selected:this.toggle&&this.selected}}renderIcon(){return dp`<span class="icon"><slot></slot></span>`}renderSelectedIcon(){return dp`<span class="icon icon--selected"
      ><slot name="selected"><slot></slot></slot
    ></span>`}renderTouchTarget(){return dp`<span class="touch"></span>`}renderFocusRing(){return dp`<md-focus-ring
      part="focus-ring"
      for=${this.href?"link":"button"}></md-focus-ring>`}renderRipple(){return dp`<md-ripple
      for=${this.href?"link":pp}
      ?disabled="${!this.href&&this.disabled}"></md-ripple>`}connectedCallback(){this.flipIcon=Im(this,this.flipIconInRtl),super.connectedCallback()}async handleClick(t){await 0,!this.toggle||this.disabled||t.defaultPrevented||(this.selected=!this.selected,this.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0})))}}ru(Lm),Xu(Lm),Lm.formAssociated=!0,Lm.shadowRootOptions={mode:"open",delegatesFocus:!0},it([jh({type:Boolean,reflect:!0})],Lm.prototype,"disabled",void 0),it([jh({type:Boolean,attribute:"flip-icon-in-rtl"})],Lm.prototype,"flipIconInRtl",void 0),it([jh()],Lm.prototype,"href",void 0),it([jh()],Lm.prototype,"target",void 0),it([jh({attribute:"aria-label-selected"})],Lm.prototype,"ariaLabelSelected",void 0),it([jh({type:Boolean})],Lm.prototype,"toggle",void 0),it([jh({type:Boolean,reflect:!0})],Lm.prototype,"selected",void 0),it([jh()],Lm.prototype,"type",void 0),it([jh({reflect:!0})],Lm.prototype,"value",void 0),it([Oh()],Lm.prototype,"flipIcon",void 0);const Pm=vh`:host{display:inline-flex;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0);height:var(--_container-height);width:var(--_container-width);justify-content:center}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--_container-height))/2) max(0px,(48px - var(--_container-width))/2)}md-focus-ring{--md-focus-ring-shape-start-start: var(--_container-shape-start-start);--md-focus-ring-shape-start-end: var(--_container-shape-start-end);--md-focus-ring-shape-end-end: var(--_container-shape-end-end);--md-focus-ring-shape-end-start: var(--_container-shape-end-start)}:host([disabled]){pointer-events:none}.icon-button{place-items:center;background:none;border:none;box-sizing:border-box;cursor:pointer;display:flex;place-content:center;outline:none;padding:0;position:relative;text-decoration:none;user-select:none;z-index:0;flex:1;border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-start-radius:var(--_container-shape-end-start);border-end-end-radius:var(--_container-shape-end-end)}.icon ::slotted(*){font-size:var(--_icon-size);height:var(--_icon-size);width:var(--_icon-size);font-weight:inherit}md-ripple{z-index:-1;border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-start-radius:var(--_container-shape-end-start);border-end-end-radius:var(--_container-shape-end-end)}.flip-icon .icon{transform:scaleX(-1)}.icon{display:inline-flex}.link{height:100%;outline:none;position:absolute;width:100%}.touch{position:absolute;height:max(48px,100%);width:max(48px,100%)}:host([touch-target=none]) .touch{display:none}@media(forced-colors: active){:host([disabled]){--_disabled-icon-opacity: 1}}
`;let Rm=class extends Lm{getRenderClasses(){return{...super.getRenderClasses(),filled:!0,"toggle-filled":this.toggle}}};Rm.styles=[Pm,Am],Rm=it([ph("md-filled-icon-button")],Rm);class zm extends $p{render(){return dp`<slot></slot>`}connectedCallback(){super.connectedCallback();"false"!==this.getAttribute("aria-hidden")?this.setAttribute("aria-hidden","true"):this.removeAttribute("aria-hidden")}}const Dm=vh`:host{font-size:var(--md-icon-size, 24px);width:var(--md-icon-size, 24px);height:var(--md-icon-size, 24px);color:inherit;font-variation-settings:inherit;font-weight:400;font-family:var(--md-icon-font, Material Symbols Outlined);display:inline-flex;font-style:normal;place-items:center;place-content:center;line-height:1;overflow:hidden;letter-spacing:normal;text-transform:none;user-select:none;white-space:nowrap;word-wrap:normal;flex-shrink:0;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale}::slotted(svg){fill:currentColor}::slotted(*){height:100%;width:100%}
`;let jm=class extends zm{};jm.styles=[Dm],jm=it([ph("md-icon")],jm);class Om extends(al(K)){static get styles(){return[nl,n`
        .container {
          display: flex;
          align-items: end;
          justify-content: center;
        }

        md-outlined-text-field {
          flex: 1;
          --md-outlined-text-field-container-shape: 28px;
          --md-outlined-text-field-input-text-placeholder-color: #777;
          resize: none;
        }

        md-filled-icon-button.send {
          --md-filled-icon-button-container-color: rgba(109, 76, 65, 1);
          position: relative;
          margin-left: 16px;
          margin-top: 9px;
          margin-bottom: 9px;
          margin-right: 0;
          --md-filled-icon-button-icon-size: 22px;
          --md-filled-icon-button-state-layer-height: 66px;
          --md-filled-icon-button-state-layer-width: 66px;
        }
      `]}static get properties(){return{value:{type:String},maxRows:{type:Number},nRows:{type:Number},loading:{type:Boolean}}}constructor(){super(),this.value="",this.maxRows=5,this.nRows=1,this.loading=!1}render(){return M`
      <div class="container">
        <md-outlined-text-field
          type="textarea"
          rows="${this.nRows}"
          placeholder="${this._("Ask something about your ancestors")}"
          value="${this.value}"
          @input="${this._handleInput}"
          @keydown="${this._handleKey}"
        >
        </md-outlined-text-field>
        <md-filled-icon-button
          @click="${this._handleBtnClick}"
          class="send"
          ?disabled="${this.loading}"
        >
          <md-icon>${Ha("M2,21L23,12L2,3V10L17,12L2,14V21Z","#ffffff")}</md-icon>
        </md-filled-icon-button>
      </div>
    `}_handleBtnClick(){this._submit()}_handleKey(t){"Enter"!==t.code||t.shiftKey?"Escape"===t.code&&this._clear():(t.preventDefault(),t.stopPropagation(),this._submit())}_handleInput(){this.value=this.renderRoot.querySelector("md-outlined-text-field").value,this._updateNRows()}_clear(){const t=this.renderRoot.querySelector("md-outlined-text-field");null!==t&&(t.value="",this.value=""),this._updateNRows()}_submit(){this.value.trim()&&!this.loading&&(os(this,"chat:prompt",{message:this.value.trim()}),this._clear())}_updateNRows(){this.value||(this.nRows=1),this.nRows=Math.min(this.maxRows,this.value.split("\n").length)}focusInput(){const t=this.renderRoot.querySelector("md-outlined-text-field");null!==t&&t.focus()}}window.customElements.define("grampsjs-chat-prompt",Om);class Bm extends(al(K)){static get styles(){return[nl,n`
        .container {
          margin: 15px 0;
          font-size: 16px;
          line-height: 26px;
          font-weight: 340;
          clear: right;
          max-width: 90%;
          display: flex;
          align-items: flex-start;
        }

        .container.human {
          background-color: rgba(109, 76, 65, 0.12);
          color: rgba(27, 19, 16);
          padding: 10px 20px;
          border-radius: 16px;
          float: right;
          max-width: 70%;
          margin-right: 10px;
        }

        .container.alert {
          max-width: 70%;
          margin-left: auto;
          margin-right: auto;
          width: fit-content;
          border-radius: 16px;
          border: 0;
        }

        .slot-wrap {
          white-space: pre-wrap;
          flex-grow: 1;
          overflow: hidden;
        }

        .avatar {
          width: 35px;
          height: 35px;
          flex-shrink: 0;
        }

        .avatar md-icon {
          --md-icon-size: 20px;
          position: relative;
          top: 3px;
        }
      `]}static get properties(){return{type:{type:String}}}constructor(){super(),this.type="human"}render(){return M`
      <div
        class="${Ot({container:!0,human:"human"===this.type,ai:"ai"===this.type,alert:"error"===this.type,error:"error"===this.type})}"
      >
        ${"ai"===this.type?M`
              <div class="avatar">
                <md-icon>${Ha(La,"#999",270)}</md-icon>
              </div>
            `:""}
        <slot name="no-wrap"></slot>
        <!-- prettier-ignore -->
        <div class="slot-wrap"><slot></slot></div>
      </div>
    `}}function Fm(t){return new Promise((e=>setTimeout(e,t)))}window.customElements.define("grampsjs-chat-message",Bm);class Nm extends(al(K)){static get styles(){return[nl,n`
        :host {
          height: 100%;
          display: flex;
          flex-direction: column;
        }

        .outer {
          height: 100%;
          display: flex;
          flex-direction: column;
        }

        .container {
          height: 100%;
          display: flex;
          flex-direction: column;
          justify-content: flex-end;
          overflow: hidden;
          clear: left;
        }

        .conversation {
          flex: 1;
          overflow-y: auto;
          display: flex;
          flex-direction: column-reverse;
          padding: 0 10px 20px 10px;
        }

        .prompt {
          padding: 10px;
          flex-shrink: 0;
        }

        .loading {
          display: flex;
          align-items: center;
          justify-content: center;
          height: 24px;
          width: 48px;
          font-size: 24px;
        }

        .dot {
          width: 8px;
          height: 8px;
          margin: 0 4px;
          background-color: #888;
          border-radius: 50%;
          animation: flash 1.4s infinite ease-in-out both;
        }

        .dot:nth-child(1) {
          animation-delay: -0.32s;
        }

        .dot:nth-child(2) {
          animation-delay: -0.16s;
        }

        @keyframes flash {
          0%,
          80%,
          100% {
            opacity: 0;
          }
          40% {
            opacity: 1;
          }
        }

        .clear-btn {
          position: relative;
          float: left;
          top: 20px;
          left: 0px;
          margin: 1px solid red;
        }
      `]}static get properties(){return{messages:{type:Array},loading:{type:Boolean}}}constructor(){super(),this.messages=Rn()||[],this.loading=!1}render(){return M`
    <div class="clear-btn">
        <mwc-button
          raised
          label="${this._("New")}"
          icon="clear_all"
          @click="${this._handleClear}"
          ?disabled=${0===this.messages.length}
        ></mwc-button>
        </div>
        <div class="outer">
          <div class="container">
            <div class="conversation">
              ${this.loading?M` <grampsjs-chat-message
                      type="ai"
                      .strings="${this.strings}"
                    >
                      <div class="loading" slot="no-wrap">
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div></div
                    ></grampsjs-chat-message>`:""}
              ${this.messages.toReversed().map((t=>M`
                    <grampsjs-chat-message
                      type="${t.role}"
                      .strings="${this.strings}"
                      >${function(t){const e=/\[([^\]]+)\]\(([^)]+)\)/g,i=[];let r,n=0;for(;null!==(r=e.exec(t));)r.index>n&&i.push(t.substring(n,r.index)),i.push(M`<a href="${r[2]}">${r[1]}</a>`),n=e.lastIndex;return n<t.length&&i.push(t.substring(n)),i}(t.message)}</grampsjs-chat-message
                    >
                  `))}
            </div>
            <div class="prompt">
              <grampsjs-chat-prompt
                ?loading="${this.loading}"
                @chat:prompt="${this._handlePrompt}"
                .strings="${this.strings}"
              ></grampsjs-chat-prompt>
            </div>
          </div>
        </div>
      </div>
    `}async _addMessage(t,e){if(!t.message)return;const{messages:i}=this;if("ai"===t.role){const r=t.message.split(" "),n=r.length;for(let t=1;t<=n;t+=1)this.messages=[...i.slice(-(e-1)),{role:"ai",message:r.slice(0,t).join(" ")}],await Fm(Math.ceil(1e3/n))}else this.messages=[...i.slice(-(e-1)),t]}_handlePrompt(t){const e={role:"human",message:t.detail.message};this._addMessage(e,7),zn(this.messages),this._generateResponse()}async _generateResponse(){this.loading=!0;const t={query:this.messages[this.messages.length-1].message};this.messages.length>1&&(t.history=this.messages.slice(0,this.messages.length-1));const e=await Nn("/api/chat/",t);let i;i="error"in e||!e?.data?.response?{role:"error",message:this._(e.error)}:{role:"ai",message:e.data.response},this.loading=!1,await this._addMessage(i,6),zn(this.messages)}_handleClear(){this.messages=[],zn(this.messages)}_scrollToLastMessage(){const t=this.renderRoot.querySelector(".conversation");null!=t&&(t.scrollTop=t.scrollHeight)}focusInput(t=!0){const e=this.renderRoot.querySelector("grampsjs-chat-prompt");null!==e?e.focusInput():t&&setTimeout((()=>this.focusInput(!1)),500),this._scrollToLastMessage()}_handleStorage(){this.messages=Rn()}connectedCallback(){super.connectedCallback(),window.addEventListener("storage",(t=>this._handleStorage(t)))}}window.customElements.define("grampsjs-chat",Nm);window.customElements.define("grampsjs-view-chat",class extends $d{static get styles(){return[super.styles,n`
        :host {
          height: calc(100vh - 85px);
          margin-top: 0;
          margin-bottom: 0;
          display: flex;
          overflow: hidden;
        }
      `]}update(t){super.update(t),t.has("active")&&this._focus()}_focus(){this.active&&this.renderRoot.querySelector("grampsjs-chat").focusInput()}renderContent(){return M` <grampsjs-chat .strings="${this.strings}"></grampsjs-chat> `}firstUpdated(){this._focus()}});window.customElements.define("grampsjs-view-export",class extends $d{static get styles(){return[super.styles,n`
        .hidden {
          display: none;
        }

        p {
          line-height: 1.6em;
        }

        mwc-icon.inline {
          --mdc-icon-size: 1em;
          color: rgba(0, 0, 0, 0.5);
        }
      `]}static get properties(){return{data:{type:Array},_formData:{type:Object},_downloadUrl:{type:String},_mediaDownloadUrl:{type:String},_viewPrivate:{type:Boolean}}}constructor(){super(),this.data=[],this._formData={exporter:"gramps",options:{}},this._downloadUrl="",this._mediaDownloadUrl="",this._viewPrivate=!0}renderContent(){return M`
      <h2>${this._("Export")}</h2>
      <h3>${this._("Export your family tree")}</h3>

      <mwc-select @change=${this._handleSelect} style="min-width:30em;">
        ${this.data.map((t=>M`
            <mwc-list-item
              value="${t.extension}"
              ?selected="${"gramps"===t.extension}"
              >${t.name.replace("_","")}</mwc-list-item
            >
          `))}
      </mwc-select>
      ${this._getDescription()} ${this._renderWarning()}
      <p>
        <mwc-button
          raised
          @click="${this._generateExport}"
          ?disabled="${!this._formData.exporter}"
          >${this._("_Generate")}</mwc-button
        >
        <grampsjs-task-progress-indicator
          id="indicator-export"
          taskName="exportFile"
          class="button"
          size="20"
          pollInterval="0.2"
          @task:complete="${this._handleTaskComplete}"
        ></grampsjs-task-progress-indicator>
        <a
          download="${this._getFileName()}"
          href="${this._downloadUrl?Hn(this._downloadUrl):""}"
          id="downloadanchor"
          >&nbsp;</a
        >
      </p>

      <h3>${this._("Export your media files")}</h3>

      <p>${this._("Generate a ZIP archive with all media files.")}</p>

      ${this._renderWarning()}
      <p>
        <mwc-button raised @click="${this._generateMediaArchive}"
          >${this._("_Generate")}</mwc-button
        >
        <grampsjs-task-progress-indicator
          id="indicator-media"
          taskName="exportMedia"
          class="button"
          size="20"
          pollInterval="0.2"
          @task:complete="${this._handleMediaTaskComplete}"
        ></grampsjs-task-progress-indicator>
        <a
          download="grampsweb-media-export.zip"
          href="${this._mediaDownloadUrl?Hn(this._mediaDownloadUrl):""}"
          id="downloadanchor-media"
          >&nbsp;</a
        >
      </p>
    `}_renderWarning(){return this._viewPrivate?"":M`
      <p class="warn">
        <mwc-icon class="inline">warning</mwc-icon> ${this._("You do not have permissions to view private records, so the export will be incomplete.")}
      </p>
    `}_getFileName(){const t=this._formData.exporter;return t?`grampsweb-export.${t}`:"file"}_getDescription(){if(0===this.data.length)return"";const[t]=this.data.filter((t=>t.extension===this._formData.exporter));return t?M`<p>${t.description}</p>`:""}_handleSelect(t){this._formData={...this._formData,exporter:t.target.value}}_startDownload(){this.shadowRoot.querySelector("#downloadanchor").click()}_startMediaDownload(){this.shadowRoot.querySelector("#downloadanchor-media").click()}_getQueryUrl(){const t=this._formData.exporter,e=this._formData.options||{};return`/api/exporters/${t}/file?${new URLSearchParams(e).toString()}`}async _generateExport(){this._downloadUrl="";const t=this.renderRoot.querySelector("#indicator-export");t.reset(),t.open=!0;const e=this._getQueryUrl(),i=await Nn(e);"error"in i?(t.setError(),t.errorMessage=i.error):"task"in i?t.taskId=i.task?.id||"":(this._downloadUrl=i?.data?.url||"",t.setComplete())}async _generateMediaArchive(){this._mediaDownloadUrl="";const t=this.renderRoot.querySelector("#indicator-media");t.reset(),t.open=!0;const e=await Nn("/api/media/archive/");"error"in e?(t.setError(),t.errorMessage=e.error):"task"in e?t.taskId=e.task?.id||"":(this._downloadUrl=e?.data?.url||"",t.setComplete())}_handleTaskComplete(t){const{status:e}=t.detail,i=JSON.parse(e.result||{});this._downloadUrl=i?.url||""}_handleMediaTaskComplete(t){const{status:e}=t.detail,i=JSON.parse(e.result||{});this._mediaDownloadUrl=i?.url||""}async _fetchData(){this.loading=!0;const t=await On("/api/exporters/");this.loading=!1,"data"in t?(this.error=!1,this.data=t.data):"error"in t&&(this.error=!0,this._errorMessage=t.error)}firstUpdated(){"__lang__"in this.strings&&this._fetchData(this.strings.__lang__);const t=In();this._viewPrivate=t.includes("ViewPrivate")}updated(t){t.has("_downloadUrl")&&this._downloadUrl&&this._startDownload(),t.has("_mediaDownloadUrl")&&this._mediaDownloadUrl&&this._startMediaDownload()}connectedCallback(){super.connectedCallback(),window.addEventListener("language:changed",(t=>this._handleLanguageChanged(t)))}_handleLanguageChanged(t){this._hasFirstUpdated&&this._fetchData(t.detail.lang)}});const Hm={person:"Edit Person",family:"Edit Family",event:"Edit Event",place:"Edit Place",citation:"Edit Citation",source:"Edit Source",repository:"Edit Repository",media:"Edit Media Object",note:"Edit Note"};function Vm(t,e){return e<=0?t:[...t.slice(0,e-1),t[e],t[e-1],...t.slice(e+1)]}function Um(t,e){return e>=t.length-1?t:[...t.slice(0,e),t[e+1],t[e],...t.slice(e+2)]}class Ym extends $d{static get styles(){return[super.styles,n`
        :host {
        }

        mwc-fab {
          position: fixed;
          bottom: 32px;
          right: 32px;
        }
      `]}static get properties(){return{grampsId:{type:String},canEdit:{type:Boolean},edit:{type:Boolean},editDialogContent:{type:String},_data:{type:Object},_className:{type:String},_saveButton:{type:Boolean}}}constructor(){super(),this.canEdit=!1,this.edit=!1,this.editDialogContent="",this._data={},this._className="",this._saveButton=!1,this._boundDisableEditMode=this._disableEditMode.bind(this),this._boundDeleteSelf=this._deleteSelf.bind(this)}getUrl(){return""}renderContent(){return 0===Object.keys(this._data).length?(this.loading,M``):M`
      ${this.renderElement()}
      ${this.canEdit&&!this.edit?this.renderFab():""}
      ${this.editDialogContent}
    `}renderFab(){return M` <mwc-fab icon="edit" @click="${this._handleFab}"></mwc-fab> `}_handleFab(){this.edit=!0,os(this,"edit-mode:on",{title:this._(Hm[this._className]||"Edit"),saveButton:this._saveButton})}_disableEditMode(){this.edit=!1}renderElement(){return M``}connectedCallback(){super.connectedCallback(),window.addEventListener("edit-mode:off",this._boundDisableEditMode),window.addEventListener("edit-mode:delete",this._boundDeleteSelf),window.addEventListener("language:changed",this._handleLangChange.bind(this)),this.addEventListener("edit:action",this.handleEditAction.bind(this))}disconnectedCallback(){this.removeEventListener("edit:action",this.handleEditAction.bind(this)),window.removeEventListener("edit-mode:off",this._boundDisableEditMode),window.removeEventListener("edit-mode:delete",this._boundDeleteSelf),super.disconnectedCallback()}update(t){super.update(t),this.active&&t.has("grampsId")&&this._updateData(),!t.has("active")||!this.active||0!==Object.keys(this._data).length&&this._data.gramps_id===this.grampsId||this.loading||this._updateData()}_updateData(t=!0){""!==this._url&&void 0!==this.grampsId&&this.grampsId&&(t&&this._clearData(),this.loading=!0,On(this.getUrl()).then((t=>{this.loading=!1,"data"in t?([this._data]=t.data,this.error=!1,""!==this._className&&(this.dispatchEvent(new CustomEvent("object:loaded",{bubbles:!0,composed:!0,detail:{grampsId:this.grampsId,className:this._className}})),this._handleObjectLoaded(this._data))):"error"in t&&(this.error=!0,this._errorMessage=t.error)})))}_handleLangChange(t){this.active&&t.detail.lang===this.strings.__lang__&&this._updateData(!1)}_clearData(){this._data={}}_handleObjectLoaded(){}async _deleteSelf(){const{handle:t}=this._data,e=this._data.gramps_id,i=is[this._className];if(this.active&&i&&t){const r=`/api/${i}/${t}`,n=await async function(t,e=!0){return Bn("DELETE",t,null,!1,e)}(r,!1);"data"in n?(this.grampsId="",this._data={},os(this,"db:changed"),os(this,"nav",{path:""}),os(this,"transaction:undo",{message:this._("Object %s deleted.",e),transaction:n.data,redirect:`${this._className}/${e}`})):"error"in n&&os(this,"grampsjs:error",{message:n.error})}}handleEditAction(t){if("delEvent"===t.detail.action)this.delObjectByIndex(t.detail.index,this._data,this._className,"event_ref_list");else if("addEventRef"===t.detail.action)this.addObject(t.detail.data,this._data,this._className,"event_ref_list");else if("updateEventRef"===t.detail.action)this.updateObjectByIndex(t.detail.index,t.detail.data,this._data,this._className,"event_ref_list");else if("addPlaceRef"===t.detail.action)this.addObject(t.detail.data,this._data,this._className,"placeref_list");else if("addChildRef"===t.detail.action)this.addObject(t.detail.data,this._data,this._className,"child_ref_list");else if("addNoteRef"===t.detail.action)this.addHandle(t.detail.data.data[0],this._data,this._className,"note_list");else if("newCitation"===t.detail.action)this._postObject(t.detail.data,"citation").then((e=>{"data"in e&&this.addHandle(t.detail.data.handle,this._data,this._className,"citation_list")}));else if("newNote"===t.detail.action)this._postObject(t.detail.data,"note").then((e=>{"data"in e&&this.addHandle(t.detail.data.handle,this._data,this._className,"note_list")}));else if("newEvent"===t.detail.action){const{role:e,...i}=t.detail.data;this._postObject(i,"event").then((i=>{if("data"in i){const i={_class:"EventRef",ref:t.detail.data.handle,role:e};this.addObject(i,this._data,this._className,"event_ref_list")}}))}else"addCitation"===t.detail.action?this.addHandle(t.detail.data.data[0],this._data,this._className,"citation_list"):"addAttribute"===t.detail.action?this.addObject(t.detail.data,this._data,this._className,"attribute_list"):"addURL"===t.detail.action?this.addObject(t.detail.data,this._data,this._className,"urls"):"addAssociation"===t.detail.action?this.addObject(t.detail.data,this._data,this._className,"person_ref_list"):"delRepository"===t.detail.action?this.delObject(t.detail.handle,this._data,this._className,"reporef_list"):"addRepoRef"===t.detail.action?this.addObject(t.detail.data,this._data,this._className,"reporef_list"):"upRepository"===t.detail.action?this.moveObject(t.detail.handle,this._data,this._className,"reporef_list","up"):"downRepository"===t.detail.action?this.moveObject(t.detail.handle,this._data,this._className,"reporef_list","down"):"addMediaRef"===t.detail.action?this.addObject(t.detail.data,this._data,this._className,"media_list"):"updateMediaRef"===t.detail.action?this.updateObject(t.detail.data,this._data,this._className,"media_list"):"updateAttribute"===t.detail.action?this.updateObjectByIndex(t.detail.index,t.detail.data,this._data,this._className,"attribute_list"):"updateURL"===t.detail.action?this.updateObjectByIndex(t.detail.index,t.detail.data,this._data,this._className,"urls"):"updateAssociation"===t.detail.action?this.updateObjectByIndex(t.detail.index,t.detail.data,this._data,this._className,"person_ref_list"):"delNoteRef"===t.detail.action?this.delHandle(t.detail.handle,this._data,this._className,"note_list"):"delMediaRef"===t.detail.action?this.delObject(t.detail.handle,this._data,this._className,"media_list"):"delPlace"===t.detail.action?this.delObject(t.detail.handle,this._data,this._className,"placeref_list"):"delAttr"===t.detail.action?this.delObjectByIndex(t.detail.index,this._data,this._className,"attribute_list"):"delURL"===t.detail.action?this.delObjectByIndex(t.detail.index,this._data,this._className,"urls"):"delAssociation"===t.detail.action?this.delObjectByIndex(t.detail.index,this._data,this._className,"person_ref_list"):"upMediaRef"===t.detail.action?this.moveObject(t.detail.handle,this._data,this._className,"media_list","up"):"downMediaRef"===t.detail.action?this.moveObject(t.detail.handle,this._data,this._className,"media_list","down"):"upName"===t.detail.action?this.moveName(t.detail.handle,this._data,"up"):"downName"===t.detail.action?this.moveName(t.detail.handle,this._data,"down"):"delName"===t.detail.action?this.delName(t.detail.data,this._data):"addName"===t.detail.action?this.addObject(t.detail.data,this._data,this._className,"alternate_names"):"updateName"===t.detail.action?this.updateName(t.detail.data,this._data):"delChildRef"===t.detail.action?this.delObject(t.detail.handle,this._data,this._className,"child_ref_list"):"delCitation"===t.detail.action?this.delObjectByIndex(t.detail.index,this._data,this._className,"citation_list"):"upEvent"===t.detail.action?this.moveObject(t.detail.handle,this._data,this._className,"event_ref_list","up"):"downEvent"===t.detail.action?this.moveObject(t.detail.handle,this._data,this._className,"event_ref_list","down"):"upPlace"===t.detail.action?this.moveObject(t.detail.handle,this._data,this._className,"placeref_list","up"):"downPlace"===t.detail.action?this.moveObject(t.detail.handle,this._data,this._className,"placeref_list","down"):"upChildRef"===t.detail.action?this.moveObject(t.detail.handle,this._data,this._className,"child_ref_list","up"):"downChildRef"===t.detail.action?this.moveObject(t.detail.handle,this._data,this._className,"child_ref_list","down"):"upCitation"===t.detail.action?this.moveHandle(t.detail.handle,this._data,this._className,"citation_list","up"):"downCitation"===t.detail.action?this.moveHandle(t.detail.handle,this._data,this._className,"citation_list","down"):"updateProp"===t.detail.action?this.updateProp(this._data,this._className,t.detail.data):alert(JSON.stringify(t.detail))}delObject(t,e,i,r){return this._updateObject(e,i,(e=>(e[r]=e[r].filter((e=>e.ref!==t)),e)))}delObjectByIndex(t,e,i,r){return this._updateObject(e,i,(e=>(e[r]=e[r].filter(((e,i)=>i!==t)),e)))}delHandle(t,e,i,r){return this._updateObject(e,i,(e=>(e[r]=e[r].filter((e=>e!==t)),e)))}moveObject(t,e,i,r,n){return this._updateObject(e,i,(e=>{const i=(e[r].map((t=>t.ref))||[]).indexOf(t);return"up"===n?e[r]=Vm(e[r],i):"down"===n&&(e[r]=Um(e[r],i)),e}))}moveName(t,e,i){return this._updateObject(e,"person",(e=>{if(0===t&&"down"===i||1===t&&"up"===i){const t=e.primary_name;[e.primary_name]=e.alternate_names,e.alternate_names=[t,...e.alternate_names.slice(1)]}else t>=1&&("up"===i?e.alternate_names=Vm(e.alternate_names,t-1):"down"===i&&(e.alternate_names=Um(e.alternate_names,t-1)));return e}))}delName(t,e){const{index:i}=t;return this._updateObject(e,"person",(t=>(0===i?Object.keys(t.primary_name).filter((t=>"type"!==t)).forEach((e=>delete t.primary_name[e])):1===i?t.alternate_names=[...t.alternate_names.slice(1)]:i>1&&(t.alternate_names=[...t.alternate_names.slice(0,i-1),...t.alternate_names.slice(i)]),t)))}updateName(t,e){return this._updateObject(e,"person",(e=>(0===t.index?e.primary_name=t.name:1===t.index?e.alternate_names=[t.name,...e.alternate_names.slice(1)]:e.alternate_names=[...e.alternate_names.slice(0,t.index-1),t.name,...e.alternate_names.slice(t.index)],e)))}addObject(t,e,i,r){return this._updateObject(e,i,(e=>(e[r]=[...e[r],t],e)))}updateObject(t,e,i,r){return this._updateObject(e,i,(e=>{const i=e[r].map(((t,e)=>({ref:t.ref,index:e}))).filter((e=>e.ref===t.ref));return 0===i.length||(e[r]=e[r].map(((e,r)=>r===i[0].index?{...e,...t}:e))),e}))}updateObjectByIndex(t,e,i,r,n){return this._updateObject(i,r,(i=>(i[n]=i[n].map(((i,r)=>r===t?{...i,...e}:i)),i)))}addHandle(t,e,i,r){return this._updateObject(e,i,(e=>(e[r]=[...e[r],t],e)))}updateProp(t,e,i){return this._updateObject(t,e,(t=>({...t,...i})))}moveHandle(t,e,i,r,n){return this._updateObject(e,i,(e=>{const i=(e[r]||[]).indexOf(t);return"up"===n?e[r]=Vm(e[r],i):"down"===n&&(e[r]=Um(e[r],i)),e}))}async _postObject(t,e){return Nn(`/api/${is[e]}/`,t)}_updateObject(t,e,i){let{extended:r,profile:n,backlinks:a,formatted:s,...o}=t;var l;o={_class:(l=e,l.charAt(0).toUpperCase()+l.slice(1)),...o};Fn(`/api/${is[e]}/${t.handle}`,i(o)).then((()=>this._updateData(!1)))}}class Zm extends $d{static get styles(){return[super.styles,n`
        :host {
        }
      `]}static get properties(){return{grampsIds:{type:Array},dialogContent:{type:String},_data:{type:Array},edit:{type:Boolean}}}constructor(){super(),this.grampsIds=[],this.dialogContent="",this._data=[],this.edit=!1}getUrl(){return""}renderContent(){return 0===this._data.length?M`${this.edit?this.renderEdit():""}`:M`
      ${this.edit?this.renderEdit():""} ${this.renderElements()}
      ${this.dialogContent}
    `}renderEdit(){}renderElements(){return M``}update(t){super.update(t),this.active&&t.has("grampsIds")&&this._updateData()}_updateData(){""!==this._url&&(0===this.grampsIds.length?this._data=[]:(this._data=[],this.loading=!0,On(this.getUrl()).then((t=>{this.loading=!1,"data"in t?(this.error=!1,this._data=t.data.sort(((t,e)=>this.grampsIds.indexOf(t.gramps_id)-this.grampsIds.indexOf(e.gramps_id)))):"error"in t&&(this.error=!0,this._errorMessage=t.error)}))))}}window.customElements.define("grampsjs-note-content",class extends K{static get styles(){return[nl,n`
        :host {
          font-family: var(
            --grampsjs-note-font-family,
            var(--grampsjs-body-font-family)
          );
          font-size: var(--grampsjs-note-font-size, 17px);
          line-height: var(--grampsjs-note-line-height, 1.5em);
          color: var(--grampsjs-note-color, #000000);
        }

        .note {
          font-weight: 300;
          column-width: 30em;
          column-gap: 2em;
        }

        .note.frame {
          border: 1px solid rgba(0, 0, 0, 0.15);
          border-radius: 8px;
          padding: 20px 25px;
        }

        .note.frame p {
          margin: 2em 0em;
        }

        .note.frame p:first-child {
          margin-top: 0;
        }

        .note.frame p:last-child {
          margin-bottom: 0;
        }
      `]}static get properties(){return{grampsId:{type:String},content:{type:String},framed:{type:Boolean}}}constructor(){super(),this.framed=!1}render(){return M`
      <div class="note ${this.framed?"frame":""}" id="note-content"></div>
    `}updated(){this.shadowRoot.getElementById("note-content").innerHTML=ys(this.content)}});class qm extends(al(K)){static get styles(){return[nl,n`
        .hide {
          display: none;
        }
      `]}static get properties(){return{heading:{type:String},label:{type:String},typeName:{type:String},defaultTypeName:{type:String},types:{type:Object},typesLocale:{type:Object},disabled:{type:Boolean},loadingTypes:{type:Boolean},required:{type:Boolean},initialValue:{type:String},noheading:{type:Boolean},nocustom:{type:Boolean},valueNonLocal:{type:Boolean},_hasCustomType:{type:Boolean}}}constructor(){super(),this.types={},this.typesLocale={},this.typeName="",this.heading="",this.label="",this.defaultTypeName="General",this.disabled=!1,this.loadingTypes=!1,this.required=!1,this.initialValue="",this.noheading=!1,this.nocustom=!1,this._hasCustomType=!1}getTypes(t){const e=t?.default||{},i=t?.custom||{},r=this.typeName in e?e[this.typeName]:[],n=this.typeName in i?i[this.typeName]:[];return r.concat(n)}render(){const t=this.getTypes(this.types),e=this.getTypes(this.typesLocale);return M`
      ${this.noheading?"":M`<h4 class="label">${this.heading||this._("Type")}</h4>`}
      <p style="display: flex">
        <mwc-select
          style="width:100%"
          class="${Ot({hide:this._hasCustomType})}"
          ?required=${this.required&&!this._hasCustomType&&!this.nocustom}
          ?disabled=${this.loadingTypes||this._hasCustomType||this.disabled}
          validationMessage="${this._("This field is mandatory")}"
          @change="${this.handleChange}"
          label="${this.loadingTypes?this._("Loading items..."):this.label}"
          id="select-type"
        >
          ${t.includes(this.defaultTypeName)||t.includes(this.initialValue)?"":M`<mwc-list-item value="" selected></mwc-list-item>`}
          ${this.loadingTypes?"":t.map(((i,r)=>M`
                  <mwc-list-item
                    value="${this.valueNonLocal?t[r]:e[r]}"
                    ?selected="${this.initialValue&&i===this.initialValue||!this.initialValue&&i===this.defaultTypeName}"
                    >${this._(i)}</mwc-list-item
                  >
                `))}
        </mwc-select>
        ${this.nocustom||!this._hasCustomType?"":M`
              <mwc-textfield
                ?disabled="${this.disabled}"
                style="width:100%"
                ?required=${this.required}
                validationMessage="${this._("This field is mandatory")}"
                @input="${this.handleChange}"
                label="${this.loadingTypes?this._("Loading items..."):`${this.label} ${this._("Custom")}`}"
                id="custom-type"
              >
              </mwc-textfield>
            `}
        ${this.nocustom?"":M`
              <mwc-icon-button
                style="margin-left: 8px"
                icon="${this._hasCustomType?"remove":"add"}"
                id="button-switch-type"
                @click="${this.switchTypeInput}"
                ?disabled="${this.disabled}"
              ></mwc-icon-button>
              <grampsjs-tooltip
                for="button-switch-type"
                content="${this._hasCustomType?this._("Switch to default type"):this._("Add custom type")}"
                .strings="${this.strings}"
              ></grampsjs-tooltip>
            `}
      </p>
    `}switchTypeInput(){if(!this._hasCustomType){this.shadowRoot.getElementById("select-type").value=null}this._hasCustomType=!this._hasCustomType}reset(){const t=this.getTypes(this.types),e=this.getTypes(this.typesLocale),i=t.indexOf("General"),r=this.shadowRoot.getElementById("select-type"),n=this.valueNonLocal?t[i]:e[i];r.value=-1===i?null:n,this._hasCustomType=!1}handleChange(t){const e=t.target.value;this.dispatchEvent(new CustomEvent("formdata:changed",{bubbles:!0,composed:!0,detail:{data:e}}))}isValid(){const t=this.shadowRoot.getElementById("select-type"),e=this.shadowRoot.getElementById("custom-type");if(null===t||this._hasCustomType&&null===e)return!1;try{return this._hasCustomType?e?.validity?.valid:t?.validity?.valid}catch{return!1}}}window.customElements.define("grampsjs-form-select-type",qm);const Wm={place:"Select an existing place",source:"Select an existing source",media:"Select an existing media object",event:"Share an existing event",note:"Select an existing note"};class Gm extends(al(K)){static get styles(){return[nl,n`
        mwc-menu {
          --mdc-menu-min-width: 200px;
          --mdc-menu-max-width: 400px;
        }

        .container {
          padding: 8px 16px;
        }

        mwc-textfield.rounded {
          --mdc-shape-small: 28px;
        }
      `]}static get properties(){return{objectType:{type:String},objects:{type:Array},data:{type:Array},multiple:{type:Boolean},fixedMenuPosition:{type:Boolean},label:{type:String},disabled:{type:Boolean}}}constructor(){super(),this.objectType="",this.objects=[],this.data=[],this.multiple=!1,this.fixedMenuPosition=!1,this.label="",this.disabled=!1}render(){return M`
      <div style="position:relative;">
        <mwc-button
          raised
          ?disabled="${this.disabled}"
          label="${this.label||this._(Wm[this.objectType])||this._("Select")}"
          id="button"
          @click="${this._handleBtnClick}"
          icon="add_link"
        ></mwc-button>

        <mwc-menu
          ?fixed="${this.fixedMenuPosition}"
          id="menu-search-results"
          corner="BOTTOM_LEFT"
          menuCorner="START"
          x="0"
          y="0"
          defaultFocus="NONE"
        >
          <div class="container">
            <mwc-textfield
              outlined
              icon="search"
              id="textfield"
              class="rounded"
              @input="${as((()=>this._handleInput()),500)}"
              style="width:100%;"
            ></mwc-textfield>
          </div>
          <grampsjs-search-result-list
            selectable
            .data="${this.data}"
            .strings="${this.strings}"
            @search-result:clicked="${this._handleSelected}"
          ></grampsjs-search-result-list>
        </mwc-menu>
      </div>
    `}reset(){this.objects=[],this._clearBox(),this.data=[]}_handleInput(){this._fetchData()}_handleList(){return this.objects.map((t=>t.handle))}_handleSelected(t){const e=t.detail,i=this._handleList();this.multiple?i.includes(e.handle)||(this.objects=[...this.objects,e],this._closeMenu(),os(this,"select-object:changed",{objects:this.objects})):(this.objects=[e],this._closeMenu(),os(this,"select-object:changed",{objects:this.objects}))}async _handleBtnClick(){this._fetchData(),this.shadowRoot.getElementById("menu-search-results").open=!0;const t=this.shadowRoot.getElementById("textfield");t.value="",t.disabled=!1,await t.updateComplete,t.focus()}async _fetchData(){const t=this.shadowRoot.getElementById("textfield"),e=this.shadowRoot.querySelector("grampsjs-search-result-list");e.textEmpty=M`<mwc-circular-progress
      indeterminate
      density="-3"
    ></mwc-circular-progress>`;const i=this._getFetchUrl(t.value),r=await On(i);"data"in r?(this.data=r.data.filter((t=>!this._handleList().includes(t.handle))),this.shadowRoot.getElementById("menu-search-results").open=!0,e.textEmpty=this._("Not found")):"error"in r&&(this.data=[],e.textEmpty=this._("Error"))}_getFetchUrl(t){if(window._oldSearchBackend)return t?`/api/search/?locale=${this.strings?.__lang__||"en"}&profile=all&query=${encodeURIComponent(`${t}* AND type:${this.objectType||"*"}`)}&profile=all&page=1&pagesize=20`:`/api/search/?sort=-change&locale=${this.strings?.__lang__||"en"}&profile=all&query=${encodeURIComponent(`type:${this.objectType||"*"}`)}&profile=all&page=1&pagesize=20`;let e=`/api/search/?locale=${this.strings?.__lang__||"en"}&profile=all&page=1&pagesize=20`;return e=t?`${e}&query=${encodeURIComponent(`${t}*`)}`:`${e}&sort=-change&query=${encodeURIComponent("*")}`,this.objectType&&(e=`${e}&type=${this.objectType}`),e}firstUpdated(){const t=this.shadowRoot.getElementById("button");this.shadowRoot.getElementById("menu-search-results").anchor=t}_closeMenu(){this.shadowRoot.getElementById("menu-search-results").open=!1}_clearBox(){this.shadowRoot.getElementById("textfield").value=""}}window.customElements.define("grampsjs-form-select-object",Gm);class Xm extends(al(K)){static get styles(){return[nl,n`
        mwc-icon-button {
          vertical-align: middle;
          color: rgba(0, 0, 0, 0.4);
          --mdc-theme-text-disabled-on-light: rgba(0, 0, 0, 0.15);
        }
      `]}static get properties(){return{objects:{type:Array},selectedIndex:{type:Number},reorder:{type:Boolean},deletable:{type:Boolean}}}constructor(){super(),this.objectType=!1,this.objects=[],this.selectedIndex=-1,this.reorder=!1,this.deletable=!1}render(){const t=0===this.objects.length,e=1===this.objects.length,i=this.selectedIndex<0;return t?M``:M`
      <div class="buttons">
        ${this.deletable?M`
              <mwc-icon-button
                icon="delete"
                ?disabled="${i}"
                @click="${this._handleDelete}"
              ></mwc-icon-button>
            `:""}
        ${this.reorder?M`<mwc-icon-button
                icon="arrow_upward"
                ?disabled="${i||e||0===this.selectedIndex}"
                @click="${this._handleUp}"
              ></mwc-icon-button>
              <mwc-icon-button
                icon="arrow_downward"
                ?disabled="${i||e||this.selectedIndex===this.objects.length-1}"
                @click="${this._handleDown}"
              ></mwc-icon-button>`:""}
      </div>
      <grampsjs-search-result-list
        ?activatable="${this.deletable||this.reorder}"
        ?selectable="${this.deletable||this.reorder}"
        @action="${this._handleSelected}"
        .data="${this.objects}"
        .strings="${this.strings}"
      ></grampsjs-search-result-list>
    `}_handleSelected(t){this.selectedIndex=t.detail.index}_handleDelete(){this.objects=[...this.objects].filter(((t,e)=>e!==this.selectedIndex)),this.selectedIndex+1>this.objects.length&&(this.selectedIndex=-1),this._handleChange()}_handleUp(){const t=this.selectedIndex;1===t?this.objects=[this.objects[1],this.objects[0],...this.objects.slice(2)]:t>1&&(this.objects=[...this.objects.slice(0,t-1),this.objects[t],this.objects[t-1],...this.objects.slice(t+1)]),this._handleChange()}_handleDown(){const t=this.objects.length,e=this.selectedIndex;0===e?this.objects=[this.objects[1],this.objects[0],...this.objects.slice(2)]:e<t-1&&(this.objects=[...this.objects.slice(0,e),this.objects[e+1],this.objects[e],...this.objects.slice(e+2)])}_handleChange(){os(this,"object-list:changed",{objects:this.objects})}reset(){this.objects=[]}_handleList(){return this.objects.map((t=>t.handle))}update(t){super.update(t),t.has("objects")&&os(this,"formdata:changed",{data:this._handleList()})}}window.customElements.define("grampsjs-form-object-list",Xm);class Km extends(al(K)){static get styles(){return[nl]}static get properties(){return{objectType:{type:String},objectsInitial:{type:Array},label:{type:String},multiple:{type:Boolean},notDeletable:{type:Boolean},fixedMenuPosition:{type:Boolean}}}constructor(){super(),this.objectType="",this.objectsInitial=[],this.label="",this.multiple=!1,this.notDeletable=!1,this.fixedMenuPosition=!1}render(){return M`
      <p>
        <grampsjs-form-object-list
          @object-list:changed="${this._handleObjectListChanged}"
          .strings="${this.strings}"
          id="${this.id}-list"
          ?reorder="${this.multiple}"
          ?deletable="${!this.notDeletable}"
        ></grampsjs-form-object-list>
      </p>
      <p>
        <grampsjs-form-select-object
          ?fixedMenuPosition="${this.fixedMenuPosition}"
          @select-object:changed="${this._handleSelectObjectsChanged}"
          objectType="${this.objectType}"
          .strings="${this.strings}"
          id="${this.id}-select"
          label="${this.label}"
          ?multiple="${this.multiple}"
        ></grampsjs-form-select-object>
      </p>
    `}firstUpdated(){const t=this.shadowRoot.querySelector("grampsjs-form-object-list"),e=this.shadowRoot.querySelector("grampsjs-form-select-object");this.objectsInitial.length>0&&(t.objects=this.objectsInitial,e.objects=this.objectsInitial,this.objectsInitial.map(((t,e)=>this._fetchObjectIfNeeded(t,e))))}async _fetchObjectIfNeeded(t,e){if(!t.object||!Object.keys(t.object).length){On(`/api/${is[this.objectType]}/${t.handle}?extend=all&profile=all&locale=${this.strings?.__lang__||"en"}`).then((i=>{if("data"in i){const r=this.shadowRoot.querySelector("grampsjs-form-object-list"),n=this.shadowRoot.querySelector("grampsjs-form-select-object"),a=[...r.objects];a[e]={...t,object:i.data},r.objects=[...a],n.objects=[...a]}}))}}_handleSelectObjectsChanged(t){this.shadowRoot.querySelector("grampsjs-form-object-list").objects=t.detail.objects}_handleObjectListChanged(t){this.shadowRoot.querySelector("grampsjs-form-select-object").objects=t.detail.objects}reset(){this.shadowRoot.querySelectorAll("grampsjs-form-object-list, grampsjs-form-select-object").forEach((t=>t.reset()))}}window.customElements.define("grampsjs-form-select-object-list",Km);window.customElements.define("grampsjs-form-noteref",class extends lh{renderForm(){return M`
      <grampsjs-form-select-object-list
        fixedMenuPosition
        style="min-height: 300px;"
        objectType="note"
        .strings="${this.strings}"
        id="note-select"
        label="${this._("Select")}"
        class="edit"
      ></grampsjs-form-select-object-list>
    `}});class Jm extends Su{computeValidity(t){return this.checkboxControl||(this.checkboxControl=document.createElement("input"),this.checkboxControl.type="checkbox"),this.checkboxControl.checked=t.checked,this.checkboxControl.required=t.required,{validity:this.checkboxControl.validity,validationMessage:this.checkboxControl.validationMessage}}equals(t,e){return t.checked===e.checked&&t.required===e.required}copy({checked:t,required:e}){return{checked:t,required:e}}}const Qm=mu(_u(lu($p)));class tf extends Qm{constructor(){super(),this.selected=!1,this.icons=!1,this.showOnlySelectedIcon=!1,this.required=!1,this.value="on",this.addEventListener("click",(t=>{Ju(t)&&this.input&&(this.focus(),Ku(this.input))}))}render(){return dp`
      <div class="switch ${zp(this.getRenderClasses())}">
        <input
          id="switch"
          class="touch"
          type="checkbox"
          role="switch"
          aria-label=${this.ariaLabel||pp}
          ?checked=${this.selected}
          ?disabled=${this.disabled}
          ?required=${this.required}
          @input=${this.handleInput}
          @change=${this.handleChange} />

        <md-focus-ring part="focus-ring" for="switch"></md-focus-ring>
        <span class="track"> ${this.renderHandle()} </span>
      </div>
    `}getRenderClasses(){return{selected:this.selected,unselected:!this.selected,disabled:this.disabled}}renderHandle(){const t={"with-icon":this.showOnlySelectedIcon?this.selected:this.icons};return dp`
      ${this.renderTouchTarget()}
      <span class="handle-container">
        <md-ripple for="switch" ?disabled="${this.disabled}"></md-ripple>
        <span class="handle ${zp(t)}">
          ${this.shouldShowIcons()?this.renderIcons():dp``}
        </span>
      </span>
    `}renderIcons(){return dp`
      <div class="icons">
        ${this.renderOnIcon()}
        ${this.showOnlySelectedIcon?dp``:this.renderOffIcon()}
      </div>
    `}renderOnIcon(){return dp`
      <slot class="icon icon--on" name="on-icon">
        <svg viewBox="0 0 24 24">
          <path
            d="M9.55 18.2 3.65 12.3 5.275 10.675 9.55 14.95 18.725 5.775 20.35 7.4Z" />
        </svg>
      </slot>
    `}renderOffIcon(){return dp`
      <slot class="icon icon--off" name="off-icon">
        <svg viewBox="0 0 24 24">
          <path
            d="M6.4 19.2 4.8 17.6 10.4 12 4.8 6.4 6.4 4.8 12 10.4 17.6 4.8 19.2 6.4 13.6 12 19.2 17.6 17.6 19.2 12 13.6Z" />
        </svg>
      </slot>
    `}renderTouchTarget(){return dp`<span class="touch"></span>`}shouldShowIcons(){return this.icons||this.showOnlySelectedIcon}handleInput(t){const e=t.target;this.selected=e.checked}handleChange(t){au(this,t)}[fu](){return this.selected?this.value:null}[gu](){return String(this.selected)}formResetCallback(){this.selected=this.hasAttribute("selected")}formStateRestoreCallback(t){this.selected="true"===t}[cu](){return new Jm((()=>({checked:this.selected,required:this.required})))}[du](){return this.input}}ru(tf),tf.shadowRootOptions={mode:"open",delegatesFocus:!0},it([jh({type:Boolean})],tf.prototype,"selected",void 0),it([jh({type:Boolean})],tf.prototype,"icons",void 0),it([jh({type:Boolean,attribute:"show-only-selected-icon"})],tf.prototype,"showOnlySelectedIcon",void 0),it([jh({type:Boolean})],tf.prototype,"required",void 0),it([jh()],tf.prototype,"value",void 0),it([Fh("input")],tf.prototype,"input",void 0);const ef=vh`@layer styles, hcm;@layer styles{:host{display:inline-flex;outline:none;vertical-align:top;-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer}:host([disabled]){cursor:default}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--md-switch-track-height, 32px))/2) 0px}md-focus-ring{--md-focus-ring-shape-start-start: var(--md-switch-track-shape-start-start, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));--md-focus-ring-shape-start-end: var(--md-switch-track-shape-start-end, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));--md-focus-ring-shape-end-end: var(--md-switch-track-shape-end-end, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));--md-focus-ring-shape-end-start: var(--md-switch-track-shape-end-start, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)))}.switch{align-items:center;display:inline-flex;flex-shrink:0;position:relative;width:var(--md-switch-track-width, 52px);height:var(--md-switch-track-height, 32px);border-start-start-radius:var(--md-switch-track-shape-start-start, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));border-start-end-radius:var(--md-switch-track-shape-start-end, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));border-end-end-radius:var(--md-switch-track-shape-end-end, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));border-end-start-radius:var(--md-switch-track-shape-end-start, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)))}input{appearance:none;height:48px;outline:none;margin:0;position:absolute;width:100%;z-index:1;cursor:inherit}:host([touch-target=none]) input{display:none}}@layer styles{.track{position:absolute;width:100%;height:100%;box-sizing:border-box;border-radius:inherit;display:flex;justify-content:center;align-items:center}.track::before{content:"";display:flex;position:absolute;height:100%;width:100%;border-radius:inherit;box-sizing:border-box;transition-property:opacity,background-color;transition-timing-function:linear;transition-duration:67ms}.disabled .track{background-color:rgba(0,0,0,0);border-color:rgba(0,0,0,0)}.disabled .track::before,.disabled .track::after{transition:none;opacity:var(--md-switch-disabled-track-opacity, 0.12)}.disabled .track::before{background-clip:content-box}.selected .track::before{background-color:var(--md-switch-selected-track-color, var(--md-sys-color-primary, #6750a4))}.selected:hover .track::before{background-color:var(--md-switch-selected-hover-track-color, var(--md-sys-color-primary, #6750a4))}.selected:focus-within .track::before{background-color:var(--md-switch-selected-focus-track-color, var(--md-sys-color-primary, #6750a4))}.selected:active .track::before{background-color:var(--md-switch-selected-pressed-track-color, var(--md-sys-color-primary, #6750a4))}.selected.disabled .track{background-clip:border-box}.selected.disabled .track::before{background-color:var(--md-switch-disabled-selected-track-color, var(--md-sys-color-on-surface, #1d1b20))}.unselected .track::before{background-color:var(--md-switch-track-color, var(--md-sys-color-surface-container-highest, #e6e0e9));border-color:var(--md-switch-track-outline-color, var(--md-sys-color-outline, #79747e));border-style:solid;border-width:var(--md-switch-track-outline-width, 2px)}.unselected:hover .track::before{background-color:var(--md-switch-hover-track-color, var(--md-sys-color-surface-container-highest, #e6e0e9));border-color:var(--md-switch-hover-track-outline-color, var(--md-sys-color-outline, #79747e))}.unselected:focus-visible .track::before{background-color:var(--md-switch-focus-track-color, var(--md-sys-color-surface-container-highest, #e6e0e9));border-color:var(--md-switch-focus-track-outline-color, var(--md-sys-color-outline, #79747e))}.unselected:active .track::before{background-color:var(--md-switch-pressed-track-color, var(--md-sys-color-surface-container-highest, #e6e0e9));border-color:var(--md-switch-pressed-track-outline-color, var(--md-sys-color-outline, #79747e))}.unselected.disabled .track::before{background-color:var(--md-switch-disabled-track-color, var(--md-sys-color-surface-container-highest, #e6e0e9));border-color:var(--md-switch-disabled-track-outline-color, var(--md-sys-color-on-surface, #1d1b20))}}@layer hcm{@media(forced-colors: active){.selected .track::before{background:ButtonText;border-color:ButtonText}.disabled .track::before{border-color:GrayText;opacity:1}.disabled.selected .track::before{background:GrayText}}}@layer styles{.handle-container{display:flex;place-content:center;place-items:center;position:relative;transition:margin 300ms cubic-bezier(0.175, 0.885, 0.32, 1.275)}.selected .handle-container{margin-inline-start:calc(var(--md-switch-track-width, 52px) - var(--md-switch-track-height, 32px))}.unselected .handle-container{margin-inline-end:calc(var(--md-switch-track-width, 52px) - var(--md-switch-track-height, 32px))}.disabled .handle-container{transition:none}.handle{border-start-start-radius:var(--md-switch-handle-shape-start-start, var(--md-switch-handle-shape, var(--md-sys-shape-corner-full, 9999px)));border-start-end-radius:var(--md-switch-handle-shape-start-end, var(--md-switch-handle-shape, var(--md-sys-shape-corner-full, 9999px)));border-end-end-radius:var(--md-switch-handle-shape-end-end, var(--md-switch-handle-shape, var(--md-sys-shape-corner-full, 9999px)));border-end-start-radius:var(--md-switch-handle-shape-end-start, var(--md-switch-handle-shape, var(--md-sys-shape-corner-full, 9999px)));height:var(--md-switch-handle-height, 16px);width:var(--md-switch-handle-width, 16px);transform-origin:center;transition-property:height,width;transition-duration:250ms,250ms;transition-timing-function:cubic-bezier(0.2, 0, 0, 1),cubic-bezier(0.2, 0, 0, 1);z-index:0}.handle::before{content:"";display:flex;inset:0;position:absolute;border-radius:inherit;box-sizing:border-box;transition:background-color 67ms linear}.disabled .handle,.disabled .handle::before{transition:none}.selected .handle{height:var(--md-switch-selected-handle-height, 24px);width:var(--md-switch-selected-handle-width, 24px)}.handle.with-icon{height:var(--md-switch-with-icon-handle-height, 24px);width:var(--md-switch-with-icon-handle-width, 24px)}.selected:not(.disabled):active .handle,.unselected:not(.disabled):active .handle{height:var(--md-switch-pressed-handle-height, 28px);width:var(--md-switch-pressed-handle-width, 28px);transition-timing-function:linear;transition-duration:100ms}.selected .handle::before{background-color:var(--md-switch-selected-handle-color, var(--md-sys-color-on-primary, #fff))}.selected:hover .handle::before{background-color:var(--md-switch-selected-hover-handle-color, var(--md-sys-color-primary-container, #eaddff))}.selected:focus-within .handle::before{background-color:var(--md-switch-selected-focus-handle-color, var(--md-sys-color-primary-container, #eaddff))}.selected:active .handle::before{background-color:var(--md-switch-selected-pressed-handle-color, var(--md-sys-color-primary-container, #eaddff))}.selected.disabled .handle::before{background-color:var(--md-switch-disabled-selected-handle-color, var(--md-sys-color-surface, #fef7ff));opacity:var(--md-switch-disabled-selected-handle-opacity, 1)}.unselected .handle::before{background-color:var(--md-switch-handle-color, var(--md-sys-color-outline, #79747e))}.unselected:hover .handle::before{background-color:var(--md-switch-hover-handle-color, var(--md-sys-color-on-surface-variant, #49454f))}.unselected:focus-within .handle::before{background-color:var(--md-switch-focus-handle-color, var(--md-sys-color-on-surface-variant, #49454f))}.unselected:active .handle::before{background-color:var(--md-switch-pressed-handle-color, var(--md-sys-color-on-surface-variant, #49454f))}.unselected.disabled .handle::before{background-color:var(--md-switch-disabled-handle-color, var(--md-sys-color-on-surface, #1d1b20));opacity:var(--md-switch-disabled-handle-opacity, 0.38)}md-ripple{border-radius:var(--md-switch-state-layer-shape, var(--md-sys-shape-corner-full, 9999px));height:var(--md-switch-state-layer-size, 40px);inset:unset;width:var(--md-switch-state-layer-size, 40px)}.selected md-ripple{--md-ripple-hover-color: var(--md-switch-selected-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--md-ripple-pressed-color: var(--md-switch-selected-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--md-ripple-hover-opacity: var(--md-switch-selected-hover-state-layer-opacity, 0.08);--md-ripple-pressed-opacity: var(--md-switch-selected-pressed-state-layer-opacity, 0.12)}.unselected md-ripple{--md-ripple-hover-color: var(--md-switch-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-pressed-color: var(--md-switch-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-hover-opacity: var(--md-switch-hover-state-layer-opacity, 0.08);--md-ripple-pressed-opacity: var(--md-switch-pressed-state-layer-opacity, 0.12)}}@layer hcm{@media(forced-colors: active){.unselected .handle::before{background:ButtonText}.disabled .handle::before{opacity:1}.disabled.unselected .handle::before{background:GrayText}}}@layer styles{.icons{position:relative;height:100%;width:100%}.icon{position:absolute;inset:0;margin:auto;display:flex;align-items:center;justify-content:center;fill:currentColor;transition:fill 67ms linear,opacity 33ms linear,transform 167ms cubic-bezier(0.2, 0, 0, 1);opacity:0}.disabled .icon{transition:none}.selected .icon--on,.unselected .icon--off{opacity:1}.unselected .handle:not(.with-icon) .icon--on{transform:rotate(-45deg)}.icon--off{width:var(--md-switch-icon-size, 16px);height:var(--md-switch-icon-size, 16px);color:var(--md-switch-icon-color, var(--md-sys-color-surface-container-highest, #e6e0e9))}.unselected:hover .icon--off{color:var(--md-switch-hover-icon-color, var(--md-sys-color-surface-container-highest, #e6e0e9))}.unselected:focus-within .icon--off{color:var(--md-switch-focus-icon-color, var(--md-sys-color-surface-container-highest, #e6e0e9))}.unselected:active .icon--off{color:var(--md-switch-pressed-icon-color, var(--md-sys-color-surface-container-highest, #e6e0e9))}.unselected.disabled .icon--off{color:var(--md-switch-disabled-icon-color, var(--md-sys-color-surface-container-highest, #e6e0e9));opacity:var(--md-switch-disabled-icon-opacity, 0.38)}.icon--on{width:var(--md-switch-selected-icon-size, 16px);height:var(--md-switch-selected-icon-size, 16px);color:var(--md-switch-selected-icon-color, var(--md-sys-color-on-primary-container, #21005d))}.selected:hover .icon--on{color:var(--md-switch-selected-hover-icon-color, var(--md-sys-color-on-primary-container, #21005d))}.selected:focus-within .icon--on{color:var(--md-switch-selected-focus-icon-color, var(--md-sys-color-on-primary-container, #21005d))}.selected:active .icon--on{color:var(--md-switch-selected-pressed-icon-color, var(--md-sys-color-on-primary-container, #21005d))}.selected.disabled .icon--on{color:var(--md-switch-disabled-selected-icon-color, var(--md-sys-color-on-surface, #1d1b20));opacity:var(--md-switch-disabled-selected-icon-opacity, 0.38)}}@layer hcm{@media(forced-colors: active){.icon--off{fill:Canvas}.icon--on{fill:ButtonText}.disabled.unselected .icon--off,.disabled.selected .icon--on{opacity:1}.disabled .icon--on{fill:GrayText}}}
`;let rf=class extends tf{};rf.styles=[ef],rf=it([ph("md-switch")],rf);class nf extends(al(K)){static get styles(){return[nl,n``]}static get properties(){return{checked:{type:Boolean},disabled:{type:Boolean}}}constructor(){super(),this.checked=!1,this.disabled=!1}render(){return M`
      <label>
        ${this._("Private")}
        <md-switch
          icons
          @change="${this.handleChange}"
          ?selected="${this.checked}"
          ?disabled="${this.disabled}"
        >
          <svg viewBox="0 0 24 24" slot="on-icon">
            <path d="${"M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"}" />
          </svg>
          <svg viewBox="0 0 24 24" slot="off-icon">
            <path d="${"M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V10A2,2 0 0,1 6,8H15V6A3,3 0 0,0 12,3A3,3 0 0,0 9,6H7A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,17A2,2 0 0,0 14,15A2,2 0 0,0 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17Z"}" />
          </svg>
        </md-switch>
      </label>
    `}reset(){this.checked=!1}handleChange(t){this.checked=t.target.selected,this.dispatchEvent(new CustomEvent("formdata:changed",{bubbles:!0,composed:!0,detail:{checked:this.checked}}))}}function af(t){return!!["bold","italic","underline","superscript"].includes(t)}function sf(t,e){let i=`${t}`;return e.forEach((t=>{i=function(t,e){const[i,r]=e;return"bold"===i?`<b>${t}</b>`:"italic"===i?`<i>${t}</i>`:"underline"===i?`<u>${t}</u>`:"fontface"===i?`<span style="font-family:${r}">${t}</span>`:"fontsize"===i?`<span style="font-size:${r}px;">${t}</span>`:"fontcolor"===i?`<span style="color:${r}">${t}</span>`:"highlight"===i?`<span style="background-color:${r}">${t}</span>`:"superscript"===i?`<sup>${t}</sup>`:"link"===i?`<a href="${r}">${t}</a>`:`[${i} ${r}]${t}[/${i}]`}(i,t)})),i}function of(t,e){let i=0,r=!1;return e.childNodes.forEach((e=>{if(e===t&&(r=!0),!r)if(e.hasChildNodes()){const[n,a]=of(t,e);i+=n,r=a}else e.nodeType!==Node.COMMENT_NODE&&(i+=e.textContent.length)})),[i,r]}function lf(t,e){let i=0,r=!1,n=null;return t.childNodes.forEach((t=>{r||t.nodeType!==Node.COMMENT_NODE&&(i+=t.textContent.length,i>=e&&(r=!0,n=t))})),null!==n&&n.hasChildNodes()?lf(n,e-(i-n.textContent.length)):n}window.customElements.define("grampsjs-form-private",nf);class cf extends(al(K)){static get styles(){return[nl,n`
        .note {
          font-family: var(
            --grampsjs-note-font-family,
            var(--grampsjs-body-font-family)
          );
          font-size: var(--grampsjs-note-font-size, 17px);
          line-height: var(--grampsjs-note-line-height, 1.5em);
          color: var(--grampsjs-note-color, #000000);
          white-space: pre-wrap;
        }

        .framed {
          border: 1px solid var(--mdc-theme-secondary);
          border-radius: 8px;
          padding: 20px 25px;
        }

        mwc-icon-button {
          color: rgba(0, 0, 0, 0.5);
        }

        #controls {
          margin: 0.7em 0;
        }

        a {
          pointer-events: none;
        }
      `]}static get properties(){return{data:{type:Object},cursorPosition:{type:Array},_dialogContent:{type:String},_html:{type:String}}}constructor(){super(),this.data={_class:"StyledText",string:"",tags:[]},this.cursorPosition=[0],this._dialogContent="",this._html=""}reset(){this.data={_class:"StyledText",string:"",tags:[]},this.cursorPosition=[0]}render(){return M`
      <div id="controls">
        <mwc-icon-button
          id="btn-bold"
          icon="format_bold"
          @click="${()=>this._handleFormat("bold")}"
        ></mwc-icon-button>
        <grampsjs-tooltip for="btn-bold" .strings="${this.strings}"
          >${this._("Bold")}</grampsjs-tooltip
        >
        <mwc-icon-button
          id="btn-italic"
          icon="format_italic"
          @click="${()=>this._handleFormat("italic")}"
        ></mwc-icon-button>
        <grampsjs-tooltip for="btn-italic" .strings="${this.strings}"
          >${this._("Italic")}</grampsjs-tooltip
        >
        <mwc-icon-button
          id="btn-underline"
          icon="format_underlined"
          @click="${()=>this._handleFormat("underline")}"
        ></mwc-icon-button>
        <grampsjs-tooltip for="btn-underline" .strings="${this.strings}"
          >${this._("Underline")}</grampsjs-tooltip
        >
        <mwc-icon-button
          id="btn-link"
          icon="link"
          @click="${()=>this._handleFormat("link")}"
        ></mwc-icon-button>
        <grampsjs-tooltip for="btn-link" .strings="${this.strings}"
          >${this._("Link")}</grampsjs-tooltip
        >
      </div>
      <!-- display: inline -->
      <div
        id="editor-content"
        class="note framed"
        contenteditable="true"
        @beforeinput="${this._handleBeforeInput}"
        @compositionend="${this._handleCompositionEnd}"
        .innerHTML="${Ai(this._html)}"
      ></div>
      ${this._renderLinkDialog()}
    `}get _editorDiv(){return this.renderRoot.getElementById("editor-content")}_handleBeforeInput(t){if(t.preventDefault(),t.stopPropagation(),["insertText","insertParagraph","insertLineBreak","deleteContentBackward","deleteContentForward","insertFromPaste","deleteByCut","formatBold","formatItalic","formatUnderline"].includes(t.inputType)){const i=this.shadowRoot.querySelector("div.note"),[r]=t.getTargetRanges(),n=of(r.startContainer,i)[0];if("insertText"===t.inputType){if(r.startOffset!==r.endOffset){const t=of(r.endContainer,i)[0];this._deleteText(n+r.startOffset,t+r.endOffset),this.cursorPosition=[n+r.startOffset]}this._insertText(t.data,n+r.startOffset),this.cursorPosition=[n+r.startOffset+t.data.length]}if("insertFromPaste"===t.inputType){const i=(e=t.dataTransfer.getData("text/plain"),(new DOMParser).parseFromString(e,"text/html").body.textContent||"");this._insertText(i,n+r.startOffset),this.cursorPosition=[n+r.startOffset+i.length]}else if("insertParagraph"===t.inputType)this._insertText("\n\n",n+r.startOffset),this.cursorPosition=[n+r.startOffset+2];else if("insertLineBreak"===t.inputType)this._insertText("\n",n+r.startOffset),this.cursorPosition=[n+r.startOffset+1];else if(["deleteContentBackward","deleteContentForward","deleteByCut"].includes(t.inputType)){const t=of(r.endContainer,i)[0];this._deleteText(n+r.startOffset,t+r.endOffset),this.cursorPosition=[n+r.startOffset]}else"formatBold"===t.inputType?this._handleFormat("bold"):"formatItalic"===t.inputType?this._handleFormat("italic"):"formatUnderline"===t.inputType&&this._handleFormat("underline")}else console.log(t);var e;this.handleChange()}_handleCompositionEnd(t){t.preventDefault(),t.stopPropagation();const e=this.shadowRoot.getSelection?this.shadowRoot.getSelection().getRangeAt(0):document.getSelection().getRangeAt(0),i=of(e.startContainer,this._editorDiv)[0];this._insertText(t.data,i+e.startOffset),this.cursorPosition=[i+e.startOffset]}_handleLink(t){this._dialogContent=M`
      <p>
        <mwc-textfield
          id="linkurl"
          label="URL"
          style="width:100%"
        ></mwc-textfield>
      </p>
      <p>
        <grampsjs-form-select-object
          fixedMenuPosition
          @select-object:changed="${this._handleSelectObjectsChanged}"
          .strings="${this.strings}"
          id="link-select"
          label="${this._("Select")}"
        ></grampsjs-form-select-object>
      </p>

      <mwc-button
        slot="primaryAction"
        dialogAction="ok"
        @click="${()=>this._handleDialogSave(t)}"
      >
        ${this._("_Save")}
      </mwc-button>
      <mwc-button
        slot="secondaryAction"
        dialogAction="cancel"
        @click="${this._handleDialogCancel}"
      >
        ${this._("Cancel")}
      </mwc-button>
    `,this._openDialog()}_handleSelectObjectsChanged(t){const e=this.shadowRoot.querySelector("#linkurl");if(null===e)return;const[i]=t.detail.objects;var r;i.handle&&(e.value=`gramps://${r=i.object_type,`${r.charAt(0).toUpperCase()}${r.slice(1)}`}/handle/${i.handle}`)}_handleDialogSave(t){const e=this.shadowRoot.querySelector("#linkurl");if(null===e)return;const{value:i}=e;i&&(this._removeTag("link",t),this._insertTag("link",t,i),this.handleChange()),this._dialogContent=""}_handleDialogCancel(){this._dialogContent=""}_renderLinkDialog(){return M` <mwc-dialog> ${this._dialogContent} </mwc-dialog> `}_openDialog(){const t=this.shadowRoot.querySelector("mwc-dialog");null!==t&&(t.open=!0)}_handleFormat(t){const e=this.shadowRoot.querySelector("div.note"),i=this.shadowRoot.getSelection?this.shadowRoot.getSelection().getRangeAt(0):document.getSelection().getRangeAt(0),r=of(i.startContainer,e)[0],n=of(i.endContainer,e)[0],a=[r+i.startOffset,n+i.endOffset];af(t)?this._hasTag(t,a)?this._removeTag(t,a):this._insertTag(t,a):"link"===t&&(this._hasTag(t,a)?this._removeTag(t,a):this._handleLink(a)),this.cursorPosition=a,this.handleChange()}handleChange(){os(this,"formdata:changed",{data:this.data})}_insertTag(t,e,i=null){this.data={...this.data,tags:this._cleanTags([...this.data.tags,{name:t,ranges:[e],value:i}])}}_hasTag(t,e){const i=this._cleanTags(this.data.tags).filter((e=>e.name===t));if(void 0===i||0===i.length)return!1;const r=[].concat.apply([],i.map((t=>t.ranges||[]))).sort(((t,e)=>t[0]-e[0]));let n=0;for(let t=0;t<r.length;t+=1)if(r[t][1]<=e[0]);else if(n+=Math.max(0,Math.min(r[t][1],e[1])-Math.max(r[t][0],e[0])),r[t][0]>=e[1])break;return n===e[1]-e[0]}_removeTag(t,e){e[1]<=e[0]||(this.data={...this.data,tags:this._cleanTags([...this.data.tags.filter((e=>e.name!==t)),...this.data.tags.filter((e=>e.name===t)).map((t=>({...t,ranges:t.ranges.reduce(((t,i)=>i[0]>=e[1]||i[1]<=e[0]?[...t,i]:i[0]>=e[0]&&i[1]<=e[1]?t:i[0]<e[0]&&i[1]>e[1]?[...t,[i[0],e[0]],[e[1],i[1]]]:i[0]>=e[0]?[...t,[e[1],i[1]]]:i[1]<=e[1]?[...t,[i[0],e[0]]]:t),[])})))])})}_cleanTags(t){let e=[];return[...new Set(t.map((t=>t.name)))].forEach((i=>{const r=t.filter((t=>t.name===i));e=af(i)?[...e,...this._cleanTagsBool(r)]:[...e,...this._cleanTagsNonBool(r)]})),e}_cleanTagsBool(t){if(0===t.length)return[];const{name:e}=t[0],i=t.reduce(((t,e)=>[...t,...e.ranges]),[]).sort(((t,e)=>t[0]-e[0])).filter((t=>t[1]>t[0])).reduce(((t,e)=>{const i=t.length;if(i>0&&e[0]<=t[i-1][1]){const r=[t[i-1][0],Math.max(e[1],t[i-1][1])];return[...t.slice(0,-1),r]}return[...t,e]}),[]);return[{name:e,ranges:i,value:null}]}_cleanTagsNonBool(t){return 0===t.length?[]:t.map((t=>({...t,ranges:t.ranges.filter((t=>t[0]<t[1]))}))).filter((t=>t.ranges.length>0))}_insertText(t,e){this.data={...this.data,string:this.data.string.slice(0,e)+t+this.data.string.slice(e),tags:this._cleanTags(this.data.tags.map((i=>({...i,ranges:i.ranges.map((i=>i.map((i=>i<e?i:i+t.length))))}))))}}_deleteText(t,e){const i=e-t;i<=0||(this.data={...this.data,string:this.data.string.slice(0,t)+this.data.string.slice(e),tags:this._cleanTags(this.data.tags.map((r=>({...r,ranges:r.ranges.map((r=>r.map((r=>r<t?r:r>e?r-i:t))))}))))})}updated(t){t.has("data")&&(this._html=this._getHtml());const e=this.shadowRoot.querySelector("div.note"),i=lf(e,this.cursorPosition[0]);if(null!==i){const t=of(i,e)[0];if(1===this.cursorPosition.length)this._setCursor(i,this.cursorPosition[0]-t);else{const r=lf(e,this.cursorPosition[1]);if(null!==r){const n=of(r,e)[0];this._setSelection(i,this.cursorPosition[0]-t,r,this.cursorPosition[1]-n)}}}}_setCursor(t,e){document.getSelection().collapse(t,e)}_setSelection(t,e,i,r){const n=window.getSelection();n.rangeCount>0&&n.removeAllRanges();const a=document.createRange();a.setStart(t,e),a.setEnd(i,r),n.addRange(a)}_getTagArray(){const t=this.data.tags||[],e=[];return t.forEach((t=>{t.ranges.forEach((i=>{e.push([i[0],"start",t.name,t.value]),e.push([i[1],"end",t.name,t.value])}))})),e.sort(((t,e)=>t[0]-e[0])),e}_getHtml(){let t="";const e=this._getTagArray();let i=[],r=0;return e.forEach((e=>{const[n,a,s,o]=e;t=`${t}${n>r?sf(this.data.string.slice(r,n),i):""}`,"start"===a?i.push([s,o]):i=i.filter((t=>t[0]!==s)),r=n})),t=`${t}${sf(this.data.string.slice(r),i)}`,t}_handleSaveButton(){os(this,"edit:action",{action:"updateProp",data:{text:this.data}}),os(this,"edit-mode:off")}connectedCallback(){super.connectedCallback(),window.addEventListener("edit-mode:save",this._handleSaveButton.bind(this))}disconnectedCallback(){window.removeEventListener("edit-mode:save",this._handleSaveButton.bind(this)),super.disconnectedCallback()}}window.customElements.define("grampsjs-editor",cf);const df=t=>class extends t{renderForm(){return M`
        <p>
          <grampsjs-editor
            @formdata:changed="${this.handleEditor}"
            @keydown="${t=>t.stopImmediatePropagation()}"
            id="note-editor"
          ></grampsjs-editor>
        </p>

        <grampsjs-form-select-type
          id="select-note-type"
          .strings="${this.strings}"
          ?loadingTypes="${this.loadingTypes}"
          typeName="note_types"
          defaultTypeName="General"
          .types="${this.types}"
          .typesLocale="${this.typesLocale}"
        >
        </grampsjs-form-select-type>

        <div class="spacer"></div>
        <grampsjs-form-private
          id="private"
          .strings="${this.strings}"
        ></grampsjs-form-private>
      `}};class hf extends(df(lh)){static get styles(){return[super.styles,n`
        mwc-dialog {
          --mdc-dialog-max-width: min(1200px, 95vw);
          --mdc-dialog-min-width: min(1200px, 95vw);
          --mdc-dialog-max-height: 95vh;
        }
      `]}constructor(){super(),this.data={_class:"Note",text:{_class:"StyledText",string:""}}}checkFormValidity(){const t=this.shadowRoot.querySelector("grampsjs-editor");this.isFormValid=""!==t.data.string.trim()}handleEditor(t){this.checkFormValidity(),this.data={...this.data,text:t.detail.data}}_handleFormData(t){this.checkFormValidity();const e=t.composedPath()[0];"select-note-type"===e.id&&(this.data={...this.data,type:{_class:"NoteType",string:t.detail.data}}),"private"===e.id&&(this.data={...this.data,private:t.detail.checked})}}window.customElements.define("grampsjs-form-new-note",hf);window.customElements.define("grampsjs-view-object-notes",class extends Zm{static get styles(){return[super.styles,n`
        :host {
          margin: 0;
        }

        mwc-button {
          margin-top: 1em;
          margin-bottom: 2em;
        }
      `]}getUrl(){if(0===this.grampsIds.length)return"";const t={function:"or",rules:this.grampsIds.map((t=>({name:"HasIdOf",values:[t]})))},e={link_format:"/{obj_class}/{gramps_id}"};return`/api/notes/?locale=${this.strings?.__lang__||"en"}&profile=all&extend=all&formats=html&rules=${encodeURIComponent(JSON.stringify(t))}&format_options=${encodeURIComponent(JSON.stringify(e))}`}renderElements(){return M` ${this._data.map((t=>this.renderNote(t)))} `}renderEdit(){return M`
      <div>
        <mwc-icon-button
          class="edit"
          icon="add_link"
          @click="${this._handleShareClick}"
        ></mwc-icon-button>
        <mwc-icon-button
          class="edit"
          icon="add"
          @click="${this._handleAddClick}"
        ></mwc-icon-button>
        ${this.dialogContent}
      </div>
    `}_handleAddClick(){this.dialogContent=M`
      <grampsjs-form-new-note
        @object:save="${this._handleNewNoteSave}"
        @object:cancel="${this._handleNoteCancel}"
        .strings="${this.strings}"
        dialogTitle="${this._("Create and add a new note")}"
      >
      </grampsjs-form-new-note>
    `}_handleShareClick(){this.dialogContent=M`
      <grampsjs-form-noteref
        new
        @object:save="${this._handleNoteRefSave}"
        @object:cancel="${this._handleNoteCancel}"
        .strings="${this.strings}"
        objType="${this.objType}"
        dialogTitle=${this._("Select an existing note")}
      >
      </grampsjs-form-noteref>
    `}renderNote(t){return M`
      <grampsjs-note-content
        framed
        grampsId="${t.gramps_id}"
        content="${t?.formatted?.html||t?.text?.string}"
      ></grampsjs-note-content>

      ${this.edit?M`
            <mwc-icon-button
              class="edit"
              icon="delete"
              @click="${()=>this._handleNoteRefDel(t.handle)}"
            ></mwc-icon-button>
          `:M`<mwc-button
            outlined
            label="${this._("Details")}"
            @click="${()=>this._handleButtonClick(t.gramps_id)}"
          >
          </mwc-button>`}
    `}_handleNoteRefDel(t){os(this,"edit:action",{action:"delNoteRef",handle:t})}_handleNewNoteSave(t){os(this,"edit:action",{action:"newNote",data:{handle:ls(),...t.detail.data}}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleNoteRefSave(t){os(this,"edit:action",{action:"addNoteRef",...t.detail}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleNoteCancel(){this.dialogContent=""}_handleButtonClick(t){this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:`note/${t}`}}))}});class pf extends(al(K)){static get styles(){return[nl,n`
        mwc-list,
        mwc-list > * {
          --mdc-ripple-color: transparent;
        }

        mwc-list > * {
          transition: background-color 0.1s, color 0.1s;
        }

        mwc-list[activatable] [selected] {
          background-color: rgba(2, 119, 189, 0.5);
        }

        mwc-list[activatable] [mwc-list-item]:not([selected]):hover,
        mwc-list[activatable] [mwc-list-item]:not([selected]):focus {
          background-color: rgba(2, 119, 189, 0.1);
        }

        mwc-list[activatable] [mwc-list-item]:not([selected]):active {
          background-color: rgba(2, 119, 189, 0.2);
        }

        mwc-list[activatable] [mwc-list-item][selected]:hover,
        mwc-list[activatable] [mwc-list-item][selected]:focus {
          background-color: rgba(2, 119, 189, 0.4);
          color: rgba(0, 0, 0, 0.9);
        }

        mwc-list[activatable] [mwc-list-item][selected]:active {
          background-color: rgba(2, 119, 189, 0.3);
        }

        mwc-icon-button {
          --mdc-theme-text-disabled-on-light: rgba(0, 0, 0, 0.25);
        }

        mwc-icon {
          background-color: rgba(0, 0, 0, 0.25);
          color: white;
        }

        mwc-icon.placeholder {
          width: 40px;
          height: 40px;
          line-height: 40px;
          border-radius: 50%;
        }
      `]}static get properties(){return{data:{type:Array},edit:{type:Boolean},objType:{type:String},dialogContent:{type:String},dialogTitle:{type:String},hasAdd:{type:Boolean},hasShare:{type:Boolean},hasEdit:{type:Boolean},hasReorder:{type:Boolean},_selectedIndex:{type:Number}}}constructor(){super(),this.data=[],this.edit=!1,this.objType="",this.dialogContent="",this.dialogTitle="",this.hasAdd=!0,this.hasShare=!1,this.hasEdit=!1,this.hasReorder=!1,this._selectedIndex=-1}render(){return M`
      ${0!==Object.keys(this.data).length||this.edit?M`
            ${this.edit?this._renderActionBtns():""}
            <mwc-list
              ?activatable="${this.edit}"
              @action="${this._handleSelected}"
            >
              ${this.sortData([...this.data]).map(((t,e,i)=>this.row(t,e,i)))}
            </mwc-list>
          `:""}
      ${this.dialogContent}
    `}_handleSelected(t){this._selectedIndex=t.detail.index}sortData(t){return t}row(t,e,i){return""}_renderActionBtns(){return M`
      ${this.hasShare?M`
            <mwc-icon-button
              class="edit"
              icon="add_link"
              @click="${this._handleShare}"
            ></mwc-icon-button>
          `:""}
      ${this.hasAdd?M`
            <mwc-icon-button
              class="edit"
              icon="add"
              @click="${this._handleAdd}"
            ></mwc-icon-button>
          `:""}
      ${this.hasEdit?M`
            <mwc-icon-button
              ?disabled="${-1===this._selectedIndex}"
              class="edit"
              icon="edit"
              @click="${this._handleEdit}"
            ></mwc-icon-button>
          `:""}
      ${this.hasReorder?M`
            <mwc-icon-button
              ?disabled="${-1===this._selectedIndex||0===this._selectedIndex}"
              class="edit"
              icon="arrow_upward"
              @click="${this._handleUp}"
            ></mwc-icon-button>
            <mwc-icon-button
              ?disabled="${-1===this._selectedIndex||this._selectedIndex===this.data.length-1}"
              class="edit"
              icon="arrow_downward"
              @click="${this._handleDown}"
            ></mwc-icon-button>
          `:""}
      <mwc-icon-button
        ?disabled="${-1===this._selectedIndex}"
        class="edit"
        icon="delete"
        @click="${this._handleDelete}"
      ></mwc-icon-button>
    `}updated(t){t.has("edit")&&(this._selectedIndex=-1,this.dialogContent="")}_handleActionClick(t,e,i){os(this,"edit:action",{action:e,handle:i}),t.preventDefault(),t.stopPropagation()}}window.customElements.define("grampsjs-form-citation",class extends lh{renderForm(){return M`
      <grampsjs-form-select-object-list
        notDeletable
        fixedMenuPosition
        style="min-height: 300px;"
        objectType="citation"
        .strings="${this.strings}"
        id="citation-select"
        label="${this._("Select")}"
        class="edit"
      ></grampsjs-form-select-object-list>
    `}});const uf={0:"Very Low",1:"Low",2:"Normal",3:"High",4:"Very High"};window.customElements.define("grampsjs-form-new-citation",class extends lh{constructor(){super(),this.data={_class:"Citation",confidence:2}}renderForm(){return M`
      <h4 class="label">${this._("Source")}</h4>
      <grampsjs-form-select-object-list
        fixedMenuPosition
        style="min-height: 300px;"
        id="source"
        objectType="source"
        .strings="${this.strings}"
      ></grampsjs-form-select-object-list>

      <h4 class="label">${this._("Page")}</h4>
      <p>
        <grampsjs-form-string fullwidth id="page"></grampsjs-form-string>
      </p>

      <h4 class="label">${this._("Date")}</h4>
      <p>
        <grampsjs-form-select-date id="date" .strings="${this.strings}">
        </grampsjs-form-select-date>
      </p>

      <h4 class="label">${this._("Confidence")}</h4>
      <mwc-select id="select-confidence" @change="${this.handleConfidence}">
        ${Object.keys(uf).map((t=>M`
            <mwc-list-item
              value="${t}"
              ?selected="${t==this.data.confidence}"
              >${this._(uf[t])}</mwc-list-item
            >
          `))}
      </mwc-select>

      <div class="spacer"></div>
      <grampsjs-form-private
        id="private"
        .strings="${this.strings}"
      ></grampsjs-form-private>
    `}handleConfidence(t){this.data={...this.data,confidence:parseInt(t.target.value,10)}}get isValid(){return!!this.data.source_handle&&this._areDateSelectValid()}});window.customElements.define("grampsjs-source-citations",class extends pf{constructor(){super(),this.objType="Citation"}row(t){return M`
      <mwc-list-item
        twoline
        graphic="avatar"
        ?hasMeta="${this.edit}"
        @click="${()=>this._handleClick(t.gramps_id)}"
      >
        ${t?.profile?.source?.title||this._("Source")}
        <span slot="secondary"> ${t.page||t.gramps_id} </span>
        ${fs({object:t,object_type:"citation"})}
      </mwc-list-item>
    `}_handleClick(t){this.edit||t===this.grampsId||this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:this._getItemPath(t)}}))}_getItemPath(t){return`citation/${t}`}_handleAdd(){this.dialogContent=M`
      <grampsjs-form-new-citation
        new
        @object:save="${this._handleCitSave}"
        @object:cancel="${this._handleCitCancel}"
        .strings="${this.strings}"
        dialogTitle=${this._("New Citation")}
      >
      </grampsjs-form-new-citation>
    `}_handleShare(){this.dialogContent=M`
      <grampsjs-form-citation
        new
        @object:save="${this._handleShareCitSave}"
        @object:cancel="${this._handleCitCancel}"
        .strings="${this.strings}"
        dialogTitle=${this._("Select an existing citation")}
      >
      </grampsjs-form-citation>
    `}_handleCitSave(t){os(this,"edit:action",{action:"newCitation",data:{handle:ls(),...t.detail.data}}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleShareCitSave(t){os(this,"edit:action",{action:"addCitation",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleDelete(t){os(this,"edit:action",{action:"delCitation",index:this._selectedIndex}),t.preventDefault(),t.stopPropagation()}_handleCitCancel(){this.dialogContent=""}});var mf,ff;window.customElements.define("grampsjs-view-source-citations",class extends Zm{static get styles(){return[super.styles,n`
        :host {
          margin: 0;
        }
      `]}getUrl(){const t={function:"or",rules:this.grampsIds.map((t=>({name:"HasIdOf",values:[t]})))};return`/api/citations/?locale=${this.strings?.__lang__||"en"}&profile=all&extend=all&rules=${encodeURIComponent(JSON.stringify(t))}`}renderElements(){return M`
      <grampsjs-source-citations
        hasShare
        .data="${this._data}"
        ?edit="${this.edit}"
        .strings="${this.strings}"
      >
      </grampsjs-source-citations>
    `}renderEdit(){return 0===this._data.length?this.renderElements():""}}),mf=void 0,ff=function(t){function e(t){var e,i,r,n;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])t[e]=n[e];return t}var i=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function r(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var r=i.call(arguments,2);return function(){return t.apply(e,r.length?r.concat(i.call(arguments)):arguments)}}var n=0;function a(t){return"_leaflet_id"in t||(t._leaflet_id=++n),t._leaflet_id}function s(t,e,i){var r,n,a,s;return s=function(){r=!1,n&&(a.apply(i,n),n=!1)},a=function(){r?n=arguments:(t.apply(i,arguments),setTimeout(s,e),r=!0)},a}function o(t,e,i){var r=e[1],n=e[0],a=r-n;return t===r&&i?t:((t-n)%a+a)%a+n}function l(){return!1}function c(t,e){if(!1===e)return t;var i=Math.pow(10,void 0===e?6:e);return Math.round(t*i)/i}function d(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function h(t){return d(t).split(/\s+/)}function p(t,e){for(var r in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?i(t.options):{}),e)t.options[r]=e[r];return t.options}function u(t,e,i){var r=[];for(var n in t)r.push(encodeURIComponent(i?n.toUpperCase():n)+"="+encodeURIComponent(t[n]));return(e&&-1!==e.indexOf("?")?"&":"?")+r.join("&")}var m=/\{ *([\w_ -]+) *\}/g;function f(t,e){return t.replace(m,(function(t,i){var r=e[i];if(void 0===r)throw new Error("No value provided for variable "+t);return"function"==typeof r&&(r=r(e)),r}))}var g=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function _(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}var v="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function y(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var b=0;function x(t){var e=+new Date,i=Math.max(0,16-(e-b));return b=e+i,window.setTimeout(t,i)}var w=window.requestAnimationFrame||y("RequestAnimationFrame")||x,k=window.cancelAnimationFrame||y("CancelAnimationFrame")||y("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function T(t,e,i){if(!i||w!==x)return w.call(window,r(t,e));t.call(e)}function S(t){t&&k.call(window,t)}var C={__proto__:null,extend:e,create:i,bind:r,get lastId(){return n},stamp:a,throttle:s,wrapNum:o,falseFn:l,formatNum:c,trim:d,splitWords:h,setOptions:p,getParamString:u,template:f,isArray:g,indexOf:_,emptyImageUrl:v,requestFn:w,cancelFn:k,requestAnimFrame:T,cancelAnimFrame:S};function E(){}E.extend=function(t){var r=function(){p(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},n=r.__super__=this.prototype,a=i(n);for(var s in a.constructor=r,r.prototype=a,this)Object.prototype.hasOwnProperty.call(this,s)&&"prototype"!==s&&"__super__"!==s&&(r[s]=this[s]);return t.statics&&e(r,t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=g(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),e.apply(null,[a].concat(t.includes))),e(a,t),delete a.statics,delete a.includes,a.options&&(a.options=n.options?i(n.options):{},e(a.options,t.options)),a._initHooks=[],a.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=a._initHooks.length;t<e;t++)a._initHooks[t].call(this)}},r},E.include=function(t){var i=this.prototype.options;return e(this.prototype,t),t.options&&(this.prototype.options=i,this.mergeOptions(t.options)),this},E.mergeOptions=function(t){return e(this.prototype.options,t),this},E.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};var $={on:function(t,e,i){if("object"==typeof t)for(var r in t)this._on(r,t[r],e);else for(var n=0,a=(t=h(t)).length;n<a;n++)this._on(t[n],e,i);return this},off:function(t,e,i){if(arguments.length)if("object"==typeof t)for(var r in t)this._off(r,t[r],e);else{t=h(t);for(var n=1===arguments.length,a=0,s=t.length;a<s;a++)n?this._off(t[a]):this._off(t[a],e,i)}else delete this._events;return this},_on:function(t,e,i,r){if("function"==typeof e){if(!1===this._listens(t,e,i)){i===this&&(i=void 0);var n={fn:e,ctx:i};r&&(n.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(n)}}else console.warn("wrong listener type: "+typeof e)},_off:function(t,e,i){var r,n,a;if(this._events&&(r=this._events[t]))if(1!==arguments.length)if("function"==typeof e){var s=this._listens(t,e,i);if(!1!==s){var o=r[s];this._firingCount&&(o.fn=l,this._events[t]=r=r.slice()),r.splice(s,1)}}else console.warn("wrong listener type: "+typeof e);else{if(this._firingCount)for(n=0,a=r.length;n<a;n++)r[n].fn=l;delete this._events[t]}},fire:function(t,i,r){if(!this.listens(t,r))return this;var n=e({},i,{type:t,target:this,sourceTarget:i&&i.sourceTarget||this});if(this._events){var a=this._events[t];if(a){this._firingCount=this._firingCount+1||1;for(var s=0,o=a.length;s<o;s++){var l=a[s],c=l.fn;l.once&&this.off(t,c,l.ctx),c.call(l.ctx||this,n)}this._firingCount--}}return r&&this._propagateEvent(n),this},listens:function(t,e,i,r){"string"!=typeof t&&console.warn('"string" type argument expected');var n=e;"function"!=typeof e&&(r=!!e,n=void 0,i=void 0);var a=this._events&&this._events[t];if(a&&a.length&&!1!==this._listens(t,n,i))return!0;if(r)for(var s in this._eventParents)if(this._eventParents[s].listens(t,e,i,r))return!0;return!1},_listens:function(t,e,i){if(!this._events)return!1;var r=this._events[t]||[];if(!e)return!!r.length;i===this&&(i=void 0);for(var n=0,a=r.length;n<a;n++)if(r[n].fn===e&&r[n].ctx===i)return n;return!1},once:function(t,e,i){if("object"==typeof t)for(var r in t)this._on(r,t[r],e,!0);else for(var n=0,a=(t=h(t)).length;n<a;n++)this._on(t[n],e,i,!0);return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[a(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[a(t)],this},_propagateEvent:function(t){for(var i in this._eventParents)this._eventParents[i].fire(t.type,e({layer:t.target,propagatedFrom:t.target},t),!0)}};$.addEventListener=$.on,$.removeEventListener=$.clearAllEventListeners=$.off,$.addOneTimeEventListener=$.once,$.fireEvent=$.fire,$.hasEventListeners=$.listens;var A=E.extend($);function I(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}var M=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function P(t,e,i){return t instanceof I?t:g(t)?new I(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new I(t.x,t.y):new I(t,e,i)}function R(t,e){if(t)for(var i=e?[t,e]:t,r=0,n=i.length;r<n;r++)this.extend(i[r])}function z(t,e){return!t||t instanceof R?t:new R(t,e)}function D(t,e){if(t)for(var i=e?[t,e]:t,r=0,n=i.length;r<n;r++)this.extend(i[r])}function j(t,e){return t instanceof D?t:new D(t,e)}function O(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==i&&(this.alt=+i)}function B(t,e,i){return t instanceof O?t:g(t)&&"object"!=typeof t[0]?3===t.length?new O(t[0],t[1],t[2]):2===t.length?new O(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new O(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new O(t,e,i)}I.prototype={clone:function(){return new I(this.x,this.y)},add:function(t){return this.clone()._add(P(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(P(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new I(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new I(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=M(this.x),this.y=M(this.y),this},distanceTo:function(t){var e=(t=P(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=P(t)).x===this.x&&t.y===this.y},contains:function(t){return t=P(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+c(this.x)+", "+c(this.y)+")"}},R.prototype={extend:function(t){var e,i;if(!t)return this;if(t instanceof I||"number"==typeof t[0]||"x"in t)e=i=P(t);else if(e=(t=z(t)).min,i=t.max,!e||!i)return this;return this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(i.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(i.y,this.max.y)):(this.min=e.clone(),this.max=i.clone()),this},getCenter:function(t){return P((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return P(this.min.x,this.max.y)},getTopRight:function(){return P(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof I?P(t):z(t))instanceof R?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=z(t);var e=this.min,i=this.max,r=t.min,n=t.max,a=n.x>=e.x&&r.x<=i.x,s=n.y>=e.y&&r.y<=i.y;return a&&s},overlaps:function(t){t=z(t);var e=this.min,i=this.max,r=t.min,n=t.max,a=n.x>e.x&&r.x<i.x,s=n.y>e.y&&r.y<i.y;return a&&s},isValid:function(){return!(!this.min||!this.max)},pad:function(t){var e=this.min,i=this.max,r=Math.abs(e.x-i.x)*t,n=Math.abs(e.y-i.y)*t;return z(P(e.x-r,e.y-n),P(i.x+r,i.y+n))},equals:function(t){return!!t&&(t=z(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight()))}},D.prototype={extend:function(t){var e,i,r=this._southWest,n=this._northEast;if(t instanceof O)e=t,i=t;else{if(!(t instanceof D))return t?this.extend(B(t)||j(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return r||n?(r.lat=Math.min(e.lat,r.lat),r.lng=Math.min(e.lng,r.lng),n.lat=Math.max(i.lat,n.lat),n.lng=Math.max(i.lng,n.lng)):(this._southWest=new O(e.lat,e.lng),this._northEast=new O(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,r=Math.abs(e.lat-i.lat)*t,n=Math.abs(e.lng-i.lng)*t;return new D(new O(e.lat-r,e.lng-n),new O(i.lat+r,i.lng+n))},getCenter:function(){return new O((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new O(this.getNorth(),this.getWest())},getSouthEast:function(){return new O(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof O||"lat"in t?B(t):j(t);var e,i,r=this._southWest,n=this._northEast;return t instanceof D?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=r.lat&&i.lat<=n.lat&&e.lng>=r.lng&&i.lng<=n.lng},intersects:function(t){t=j(t);var e=this._southWest,i=this._northEast,r=t.getSouthWest(),n=t.getNorthEast(),a=n.lat>=e.lat&&r.lat<=i.lat,s=n.lng>=e.lng&&r.lng<=i.lng;return a&&s},overlaps:function(t){t=j(t);var e=this._southWest,i=this._northEast,r=t.getSouthWest(),n=t.getNorthEast(),a=n.lat>e.lat&&r.lat<i.lat,s=n.lng>e.lng&&r.lng<i.lng;return a&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=j(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},O.prototype={equals:function(t,e){return!!t&&(t=B(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+c(this.lat,t)+", "+c(this.lng,t)+")"},distanceTo:function(t){return N.distance(this,B(t))},wrap:function(){return N.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return j([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new O(this.lat,this.lng,this.alt)}};var F={latLngToPoint:function(t,e){var i=this.projection.project(t),r=this.scale(e);return this.transformation._transform(i,r)},pointToLatLng:function(t,e){var i=this.scale(e),r=this.transformation.untransform(t,i);return this.projection.unproject(r)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t);return new R(this.transformation.transform(e.min,i),this.transformation.transform(e.max,i))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?o(t.lng,this.wrapLng,!0):t.lng;return new O(this.wrapLat?o(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),r=e.lat-i.lat,n=e.lng-i.lng;if(0===r&&0===n)return t;var a=t.getSouthWest(),s=t.getNorthEast();return new D(new O(a.lat-r,a.lng-n),new O(s.lat-r,s.lng-n))}},N=e({},F,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,r=t.lat*i,n=e.lat*i,a=Math.sin((e.lat-t.lat)*i/2),s=Math.sin((e.lng-t.lng)*i/2),o=a*a+Math.cos(r)*Math.cos(n)*s*s,l=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return this.R*l}}),H=6378137,V={R:H,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,r=Math.max(Math.min(i,t.lat),-i),n=Math.sin(r*e);return new I(this.R*t.lng*e,this.R*Math.log((1+n)/(1-n))/2)},unproject:function(t){var e=180/Math.PI;return new O((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=H*Math.PI;return new R([-t,-t],[t,t])}()};function U(t,e,i,r){if(g(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=i,this._d=r}function Y(t,e,i,r){return new U(t,e,i,r)}U.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new I((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var Z=e({},N,{code:"EPSG:3857",projection:V,transformation:function(){var t=.5/(Math.PI*V.R);return Y(t,.5,-t,.5)}()}),q=e({},Z,{code:"EPSG:900913"});function W(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function G(t,e){var i,r,n,a,s,o,l="";for(i=0,n=t.length;i<n;i++){for(r=0,a=(s=t[i]).length;r<a;r++)l+=(r?"L":"M")+(o=s[r]).x+" "+o.y;l+=e?Lt.svg?"z":"x":""}return l||"M0 0"}var X=document.documentElement.style,K="ActiveXObject"in window,J=K&&!document.addEventListener,Q="msLaunchUri"in navigator&&!("documentMode"in document),tt=Mt("webkit"),et=Mt("android"),it=Mt("android 2")||Mt("android 3"),rt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),nt=et&&Mt("Google")&&rt<537&&!("AudioNode"in window),at=!!window.opera,st=!Q&&Mt("chrome"),ot=Mt("gecko")&&!tt&&!at&&!K,lt=!st&&Mt("safari"),ct=Mt("phantom"),dt="OTransition"in X,ht=0===navigator.platform.indexOf("Win"),pt=K&&"transition"in X,ut="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!it,mt="MozPerspective"in X,ft=!window.L_DISABLE_3D&&(pt||ut||mt)&&!dt&&!ct,gt="undefined"!=typeof orientation||Mt("mobile"),_t=gt&&tt,vt=gt&&ut,yt=!window.PointerEvent&&window.MSPointerEvent,bt=!(!window.PointerEvent&&!yt),xt="ontouchstart"in window||!!window.TouchEvent,wt=!window.L_NO_TOUCH&&(xt||bt),kt=gt&&at,Tt=gt&&ot,St=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ct=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",l,e),window.removeEventListener("testPassiveEventSupport",l,e)}catch(t){}return t}(),Et=!!document.createElement("canvas").getContext,$t=!(!document.createElementNS||!W("svg").createSVGRect),At=!!$t&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(t.firstChild&&t.firstChild.namespaceURI)}(),It=!$t&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}();function Mt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Lt={ie:K,ielt9:J,edge:Q,webkit:tt,android:et,android23:it,androidStock:nt,opera:at,chrome:st,gecko:ot,safari:lt,phantom:ct,opera12:dt,win:ht,ie3d:pt,webkit3d:ut,gecko3d:mt,any3d:ft,mobile:gt,mobileWebkit:_t,mobileWebkit3d:vt,msPointer:yt,pointer:bt,touch:wt,touchNative:xt,mobileOpera:kt,mobileGecko:Tt,retina:St,passiveEvents:Ct,canvas:Et,svg:$t,vml:It,inlineSvg:At,mac:0===navigator.platform.indexOf("Mac"),linux:0===navigator.platform.indexOf("Linux")},Pt=Lt.msPointer?"MSPointerDown":"pointerdown",Rt=Lt.msPointer?"MSPointerMove":"pointermove",zt=Lt.msPointer?"MSPointerUp":"pointerup",Dt=Lt.msPointer?"MSPointerCancel":"pointercancel",jt={touchstart:Pt,touchmove:Rt,touchend:zt,touchcancel:Dt},Ot={touchstart:function(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&De(e),Yt(t,e)},touchmove:Yt,touchend:Yt,touchcancel:Yt},Bt={},Ft=!1;function Nt(t,e,i){return"touchstart"===e&&(Ft||(document.addEventListener(Pt,Ht,!0),document.addEventListener(Rt,Vt,!0),document.addEventListener(zt,Ut,!0),document.addEventListener(Dt,Ut,!0),Ft=!0)),Ot[e]?(i=Ot[e].bind(this,i),t.addEventListener(jt[e],i,!1),i):(console.warn("wrong event specified:",e),l)}function Ht(t){Bt[t.pointerId]=t}function Vt(t){Bt[t.pointerId]&&(Bt[t.pointerId]=t)}function Ut(t){delete Bt[t.pointerId]}function Yt(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){for(var i in e.touches=[],Bt)e.touches.push(Bt[i]);e.changedTouches=[e],t(e)}}var Zt,qt,Wt,Gt,Xt,Kt=200,Jt=me(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Qt=me(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),te="webkitTransition"===Qt||"OTransition"===Qt?Qt+"End":"transitionend";function ee(t){return"string"==typeof t?document.getElementById(t):t}function ie(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var r=document.defaultView.getComputedStyle(t,null);i=r?r[e]:null}return"auto"===i?null:i}function re(t,e,i){var r=document.createElement(t);return r.className=e||"",i&&i.appendChild(r),r}function ne(t){var e=t.parentNode;e&&e.removeChild(t)}function ae(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function se(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function oe(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function le(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=pe(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function ce(t,e){if(void 0!==t.classList)for(var i=h(e),r=0,n=i.length;r<n;r++)t.classList.add(i[r]);else if(!le(t,e)){var a=pe(t);he(t,(a?a+" ":"")+e)}}function de(t,e){void 0!==t.classList?t.classList.remove(e):he(t,d((" "+pe(t)+" ").replace(" "+e+" "," ")))}function he(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function pe(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function ue(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var i=!1,r="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(r)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+r+"(opacity="+e+")"}(t,e)}function me(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function fe(t,e,i){var r=e||new I(0,0);t.style[Jt]=(Lt.ie3d?"translate("+r.x+"px,"+r.y+"px)":"translate3d("+r.x+"px,"+r.y+"px,0)")+(i?" scale("+i+")":"")}function ge(t,e){t._leaflet_pos=e,Lt.any3d?fe(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function _e(t){return t._leaflet_pos||new I(0,0)}if("onselectstart"in document)Zt=function(){Ce(window,"selectstart",De)},qt=function(){$e(window,"selectstart",De)};else{var ve=me(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Zt=function(){if(ve){var t=document.documentElement.style;Wt=t[ve],t[ve]="none"}},qt=function(){ve&&(document.documentElement.style[ve]=Wt,Wt=void 0)}}function ye(){Ce(window,"dragstart",De)}function be(){$e(window,"dragstart",De)}function xe(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(we(),Gt=t,Xt=t.style.outlineStyle,t.style.outlineStyle="none",Ce(window,"keydown",we))}function we(){Gt&&(Gt.style.outlineStyle=Xt,Gt=void 0,Xt=void 0,$e(window,"keydown",we))}function ke(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Te(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Se={__proto__:null,TRANSFORM:Jt,TRANSITION:Qt,TRANSITION_END:te,get:ee,getStyle:ie,create:re,remove:ne,empty:ae,toFront:se,toBack:oe,hasClass:le,addClass:ce,removeClass:de,setClass:he,getClass:pe,setOpacity:ue,testProp:me,setTransform:fe,setPosition:ge,getPosition:_e,get disableTextSelection(){return Zt},get enableTextSelection(){return qt},disableImageDrag:ye,enableImageDrag:be,preventOutline:xe,restoreOutline:we,getSizedParentNode:ke,getScale:Te};function Ce(t,e,i,r){if(e&&"object"==typeof e)for(var n in e)Me(t,n,e[n],i);else for(var a=0,s=(e=h(e)).length;a<s;a++)Me(t,e[a],i,r);return this}var Ee="_leaflet_events";function $e(t,e,i,r){if(1===arguments.length)Ae(t),delete t[Ee];else if(e&&"object"==typeof e)for(var n in e)Le(t,n,e[n],i);else if(e=h(e),2===arguments.length)Ae(t,(function(t){return-1!==_(e,t)}));else for(var a=0,s=e.length;a<s;a++)Le(t,e[a],i,r);return this}function Ae(t,e){for(var i in t[Ee]){var r=i.split(/\d/)[0];e&&!e(r)||Le(t,r,null,null,i)}}var Ie={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Me(t,e,i,r){var n=e+a(i)+(r?"_"+a(r):"");if(t[Ee]&&t[Ee][n])return this;var s=function(e){return i.call(r||t,e||window.event)},o=s;!Lt.touchNative&&Lt.pointer&&0===e.indexOf("touch")?s=Nt(t,e,s):Lt.touch&&"dblclick"===e?s=function(t,e){t.addEventListener("dblclick",e);var i,r=0;function n(t){if(1===t.detail){if("mouse"!==t.pointerType&&(!t.sourceCapabilities||t.sourceCapabilities.firesTouchEvents)){var n=Oe(t);if(!n.some((function(t){return t instanceof HTMLLabelElement&&t.attributes.for}))||n.some((function(t){return t instanceof HTMLInputElement||t instanceof HTMLSelectElement}))){var a=Date.now();a-r<=Kt?2==++i&&e(function(t){var e,i,r={};for(i in t)e=t[i],r[i]=e&&e.bind?e.bind(t):e;return t=r,r.type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r}(t)):i=1,r=a}}}else i=t.detail}return t.addEventListener("click",n),{dblclick:e,simDblclick:n}}(t,s):"addEventListener"in t?"touchstart"===e||"touchmove"===e||"wheel"===e||"mousewheel"===e?t.addEventListener(Ie[e]||e,s,!!Lt.passiveEvents&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?(s=function(e){e=e||window.event,He(t,e)&&o(e)},t.addEventListener(Ie[e],s,!1)):t.addEventListener(e,o,!1):t.attachEvent("on"+e,s),t[Ee]=t[Ee]||{},t[Ee][n]=s}function Le(t,e,i,r,n){n=n||e+a(i)+(r?"_"+a(r):"");var s=t[Ee]&&t[Ee][n];if(!s)return this;!Lt.touchNative&&Lt.pointer&&0===e.indexOf("touch")?function(t,e,i){jt[e]?t.removeEventListener(jt[e],i,!1):console.warn("wrong event specified:",e)}(t,e,s):Lt.touch&&"dblclick"===e?function(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}(t,s):"removeEventListener"in t?t.removeEventListener(Ie[e]||e,s,!1):t.detachEvent("on"+e,s),t[Ee][n]=null}function Pe(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Re(t){return Me(t,"wheel",Pe),this}function ze(t){return Ce(t,"mousedown touchstart dblclick contextmenu",Pe),t._leaflet_disable_click=!0,this}function De(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function je(t){return De(t),Pe(t),this}function Oe(t){if(t.composedPath)return t.composedPath();for(var e=[],i=t.target;i;)e.push(i),i=i.parentNode;return e}function Be(t,e){if(!e)return new I(t.clientX,t.clientY);var i=Te(e),r=i.boundingClientRect;return new I((t.clientX-r.left)/i.x-e.clientLeft,(t.clientY-r.top)/i.y-e.clientTop)}var Fe=Lt.linux&&Lt.chrome?window.devicePixelRatio:Lt.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ne(t){return Lt.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Fe:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function He(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t}var Ve={__proto__:null,on:Ce,off:$e,stopPropagation:Pe,disableScrollPropagation:Re,disableClickPropagation:ze,preventDefault:De,stop:je,getPropagationPath:Oe,getMousePosition:Be,getWheelDelta:Ne,isExternalTarget:He,addListener:Ce,removeListener:$e},Ue=A.extend({run:function(t,e,i,r){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(r||.5,.2),this._startPos=_e(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=T(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),ge(this._el,i),this.fire("step")},_complete:function(){S(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),Ye=A.extend({options:{crs:Z,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=p(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=r(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(B(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Qt&&Lt.any3d&&!Lt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ce(this._proxy,te,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,i,r){return i=void 0===i?this._zoom:this._limitZoom(i),t=this._limitCenter(B(t),i,this.options.maxBounds),r=r||{},this._stop(),this._loaded&&!r.reset&&!0!==r&&(void 0!==r.animate&&(r.zoom=e({animate:r.animate},r.zoom),r.pan=e({animate:r.animate,duration:r.duration},r.pan)),this._zoom!==i?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,i,r.zoom):this._tryAnimatedPan(t,r.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,i,r.pan&&r.pan.noMoveStart),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Lt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Lt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var r=this.getZoomScale(e),n=this.getSize().divideBy(2),a=(t instanceof I?t:this.latLngToContainerPoint(t)).subtract(n).multiplyBy(1-1/r),s=this.containerPointToLatLng(n.add(a));return this.setView(s,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():j(t);var i=P(e.paddingTopLeft||e.padding||[0,0]),r=P(e.paddingBottomRight||e.padding||[0,0]),n=this.getBoundsZoom(t,!1,i.add(r));if((n="number"==typeof e.maxZoom?Math.min(e.maxZoom,n):n)===1/0)return{center:t.getCenter(),zoom:n};var a=r.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),n),o=this.project(t.getNorthEast(),n);return{center:this.unproject(s.add(o).divideBy(2).add(a),n),zoom:n}},fitBounds:function(t,e){if(!(t=j(t)).isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=P(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ue,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){ce(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){if(!1===(i=i||{}).animate||!Lt.any3d)return this.setView(t,e,i);this._stop();var r=this.project(this.getCenter()),n=this.project(t),a=this.getSize(),s=this._zoom;t=B(t),e=void 0===e?s:e;var o=Math.max(a.x,a.y),l=o*this.getZoomScale(s,e),c=n.distanceTo(r)||1,d=1.42,h=d*d;function p(t){var e=(l*l-o*o+(t?-1:1)*h*h*c*c)/(2*(t?l:o)*h*c),i=Math.sqrt(e*e+1)-e;return i<1e-9?-18:Math.log(i)}function u(t){return(Math.exp(t)-Math.exp(-t))/2}function m(t){return(Math.exp(t)+Math.exp(-t))/2}var f=p(0);function g(t){return o*(m(f)*function(t){return u(t)/m(t)}(f+d*t)-u(f))/h}var _=Date.now(),v=(p(1)-f)/d,y=i.duration?1e3*i.duration:1e3*v*.8;return this._moveStart(!0,i.noMoveStart),function i(){var a=(Date.now()-_)/y,l=function(t){return 1-Math.pow(1-t,1.5)}(a)*v;a<=1?(this._flyToFrame=T(i,this),this._move(this.unproject(r.add(n.subtract(r).multiplyBy(g(l)/c)),s),this.getScaleZoom(o/function(t){return o*(m(f)/m(f+d*t))}(l),s),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return t=j(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),r=this._limitCenter(i,this._zoom,j(t));return i.equals(r)||this.panTo(r,e),this._enforcingBounds=!1,this},panInside:function(t,e){var i=P((e=e||{}).paddingTopLeft||e.padding||[0,0]),r=P(e.paddingBottomRight||e.padding||[0,0]),n=this.project(this.getCenter()),a=this.project(t),s=this.getPixelBounds(),o=z([s.min.add(i),s.max.subtract(r)]),l=o.getSize();if(!o.contains(a)){this._enforcingBounds=!0;var c=a.subtract(o.getCenter()),d=o.extend(a).getSize().subtract(l);n.x+=c.x<0?-d.x:d.x,n.y+=c.y<0?-d.y:d.y,this.panTo(this.unproject(n),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=e({animate:!1,pan:!0},!0===t?{animate:!0}:t);var i=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var n=this.getSize(),a=i.divideBy(2).round(),s=n.divideBy(2).round(),o=a.subtract(s);return o.x||o.y?(t.animate&&t.pan?this.panBy(o):(t.pan&&this._rawPanBy(o),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:i,newSize:n})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=e({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var i=r(this._handleGeolocationResponse,this),n=r(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(i,n,t):navigator.geolocation.getCurrentPosition(i,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=new O(t.coords.latitude,t.coords.longitude),i=e.toBounds(2*t.coords.accuracy),r=this._locateOptions;if(r.setView){var n=this.getBoundsZoom(i);this.setView(e,r.maxZoom?Math.min(n,r.maxZoom):n)}var a={latlng:e,bounds:i,timestamp:t.timestamp};for(var s in t.coords)"number"==typeof t.coords[s]&&(a[s]=t.coords[s]);this.fire("locationfound",a)}},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),ne(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(S(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)ne(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var i=re("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new D(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=j(t),i=P(i||[0,0]);var r=this.getZoom()||0,n=this.getMinZoom(),a=this.getMaxZoom(),s=t.getNorthWest(),o=t.getSouthEast(),l=this.getSize().subtract(i),c=z(this.project(o,r),this.project(s,r)).getSize(),d=Lt.any3d?this.options.zoomSnap:1,h=l.x/c.x,p=l.y/c.y,u=e?Math.max(h,p):Math.min(h,p);return r=this.getScaleZoom(u,r),d&&(r=Math.round(r/(d/100))*(d/100),r=e?Math.ceil(r/d)*d:Math.floor(r/d)*d),Math.max(n,Math.min(a,r))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new I(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new R(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=void 0===e?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=void 0===e?this._zoom:e;var r=i.zoom(t*i.scale(e));return isNaN(r)?1/0:r},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(B(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(P(t),e)},layerPointToLatLng:function(t){var e=P(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(B(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(B(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(j(t))},distance:function(t,e){return this.options.crs.distance(B(t),B(e))},containerPointToLayerPoint:function(t){return P(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return P(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(P(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(B(t)))},mouseEventToContainerPoint:function(t){return Be(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=ee(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Ce(e,"scroll",this._onScroll,this),this._containerId=a(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Lt.any3d,ce(t,"leaflet-container"+(Lt.touch?" leaflet-touch":"")+(Lt.retina?" leaflet-retina":"")+(Lt.ielt9?" leaflet-oldie":"")+(Lt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=ie(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&"sticky"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ge(this._mapPane,new I(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ce(t.markerPane,"leaflet-zoom-hide"),ce(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,i){ge(this._mapPane,new I(0,0));var r=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var n=this._zoom!==e;this._moveStart(n,i)._move(t,e)._moveEnd(n),this.fire("viewreset"),r&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,i,r){void 0===e&&(e=this._zoom);var n=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),r?i&&i.pinch&&this.fire("zoom",i):((n||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return S(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){ge(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[a(this._container)]=this;var e=t?$e:Ce;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Lt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){S(this._resizeRequest),this._resizeRequest=T((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,r=[],n="mouseout"===e||"mouseover"===e,s=t.target||t.srcElement,o=!1;s;){if((i=this._targets[a(s)])&&("click"===e||"preclick"===e)&&this._draggableMoved(i)){o=!0;break}if(i&&i.listens(e,!0)){if(n&&!He(s,t))break;if(r.push(i),n)break}if(s===this._container)break;s=s.parentNode}return r.length||o||n||!this.listens(e,!0)||(r=[this]),r},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||"click"===t.type&&this._isClickDisabled(e))){var i=t.type;"mousedown"===i&&xe(e),this._fireDOMEvent(t,i)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,i,r){if("click"===t.type){var n=e({},t);n.type="preclick",this._fireDOMEvent(n,n.type,r)}var a=this._findEventTargets(t,i);if(r){for(var s=[],o=0;o<r.length;o++)r[o].listens(i,!0)&&s.push(r[o]);a=s.concat(a)}if(a.length){"contextmenu"===i&&De(t);var l=a[0],c={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var d=l.getLatLng&&(!l._radius||l._radius<=10);c.containerPoint=d?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(t),c.layerPoint=this.containerPointToLayerPoint(c.containerPoint),c.latlng=d?l.getLatLng():this.layerPointToLatLng(c.layerPoint)}for(o=0;o<a.length;o++)if(a[o].fire(i,c,!0),c.originalEvent._stopped||!1===a[o].options.bubblingMouseEvents&&-1!==_(this._mouseEvents,i))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return _e(this._mapPane)||new I(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var r=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(r)},_latLngBoundsToNewLayerBounds:function(t,e,i){var r=this._getNewPixelOrigin(i,e);return z([this.project(t.getSouthWest(),e)._subtract(r),this.project(t.getNorthWest(),e)._subtract(r),this.project(t.getSouthEast(),e)._subtract(r),this.project(t.getNorthEast(),e)._subtract(r)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var r=this.project(t,e),n=this.getSize().divideBy(2),a=new R(r.subtract(n),r.add(n)),s=this._getBoundsOffset(a,i,e);return Math.abs(s.x)<=1&&Math.abs(s.y)<=1?t:this.unproject(r.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),r=new R(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(r,e))},_getBoundsOffset:function(t,e,i){var r=z(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),n=r.min.subtract(t.min),a=r.max.subtract(t.max);return new I(this._rebound(n.x,-a.x),this._rebound(n.y,-a.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),r=Lt.any3d?this.options.zoomSnap:1;return r&&(t=Math.round(t/r)*r),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){de(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i)||(this.panBy(i,e),0))},_createAnimProxy:function(){var t=this._proxy=re("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=Jt,i=this._proxy.style[e];fe(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),i===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ne(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();fe(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var r=this.getZoomScale(e),n=this._getCenterOffset(t)._divideBy(1-1/r);return!(!0!==i.animate&&!this.getSize().contains(n)||(T((function(){this._moveStart(!0,i.noMoveStart||!1)._animateZoom(t,e,!0)}),this),0))},_animateZoom:function(t,e,i,n){this._mapPane&&(i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,ce(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:n}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(r(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&de(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}}),Ze=E.extend({options:{position:"topright"},initialize:function(t){p(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),r=t._controlCorners[i];return ce(e,"leaflet-control"),-1!==i.indexOf("bottom")?r.insertBefore(e,r.firstChild):r.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ne(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),qe=function(t){return new Ze(t)};Ye.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",i=this._controlContainer=re("div",e+"control-container",this._container);function r(r,n){var a=e+r+" "+e+n;t[r+n]=re("div",a,i)}r("top","left"),r("top","right"),r("bottom","left"),r("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ne(this._controlCorners[t]);ne(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var We=Ze.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,r){return i<r?-1:r<i?1:0}},initialize:function(t,e,i){for(var r in p(this,i),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,t)this._addLayer(t[r],r);for(r in e)this._addLayer(e[r],r,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Ze.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(a(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){ce(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(ce(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):de(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return de(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=re("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),ze(e),Re(e);var r=this._section=re("section",t+"-list");i&&(this._map.on("click",this.collapse,this),Ce(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var n=this._layersLink=re("a",t+"-toggle",e);n.href="#",n.title="Layers",n.setAttribute("role","button"),Ce(n,{keydown:function(t){13===t.keyCode&&this._expandSafely()},click:function(t){De(t),this._expandSafely()}},this),i||this.expand(),this._baseLayersList=re("div",t+"-base",r),this._separator=re("div",t+"-separator",r),this._overlaysList=re("div",t+"-overlays",r),e.appendChild(r)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&a(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(r((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ae(this._baseLayersList),ae(this._overlaysList),this._layerControlInputs=[];var t,e,i,r,n=0;for(i=0;i<this._layers.length;i++)r=this._layers[i],this._addItem(r),e=e||r.overlay,t=t||!r.overlay,n+=r.overlay?0:1;return this.options.hideSingleBase&&(t=t&&n>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(a(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",r=document.createElement("div");return r.innerHTML=i,r.firstChild},_addItem:function(t){var e,i=document.createElement("label"),r=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=r):e=this._createRadioElement("leaflet-base-layers_"+a(this),r),this._layerControlInputs.push(e),e.layerId=a(t.layer),Ce(e,"click",this._onInputClick,this);var n=document.createElement("span");n.innerHTML=" "+t.name;var s=document.createElement("span");return i.appendChild(s),s.appendChild(e),s.appendChild(n),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){if(!this._preventClick){var t,e,i=this._layerControlInputs,r=[],n=[];this._handlingClick=!0;for(var a=i.length-1;a>=0;a--)t=i[a],e=this._getLayer(t.layerId).layer,t.checked?r.push(e):t.checked||n.push(e);for(a=0;a<n.length;a++)this._map.hasLayer(n[a])&&this._map.removeLayer(n[a]);for(a=0;a<r.length;a++)this._map.hasLayer(r[a])||this._map.addLayer(r[a]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t,e,i=this._layerControlInputs,r=this._map.getZoom(),n=i.length-1;n>=0;n--)t=i[n],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&r<e.options.minZoom||void 0!==e.options.maxZoom&&r>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,Ce(t,"click",De),this.expand();var e=this;setTimeout((function(){$e(t,"click",De),e._preventClick=!1}))}}),Ge=Ze.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=re("div",e+" leaflet-bar"),r=this.options;return this._zoomInButton=this._createButton(r.zoomInText,r.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(r.zoomOutText,r.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,r,n){var a=re("a",i,r);return a.innerHTML=t,a.href="#",a.title=e,a.setAttribute("role","button"),a.setAttribute("aria-label",e),ze(a),Ce(a,"click",je),Ce(a,"click",n,this),Ce(a,"click",this._refocusOnMap,this),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";de(this._zoomInButton,e),de(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(ce(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(ce(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ye.mergeOptions({zoomControl:!0}),Ye.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new Ge,this.addControl(this.zoomControl))}));var Xe=Ze.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=re("div",e),r=this.options;return this._addScales(r,e+"-line",i),t.on(r.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=re("div",e,i)),t.imperial&&(this._iScale=re("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,r,n=3.2808399*t;n>5280?(e=n/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(r=this._getRoundNum(n),this._updateScale(this._iScale,r+" ft",r/n))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return e*(i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1)}}),Ke=Ze.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Lt.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(t){p(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=re("div","leaflet-control-attribution"),ze(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",(function(){this.removeAttribution(t.layer.getAttribution())}),this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(' <span aria-hidden="true">|</span> ')}}});Ye.mergeOptions({attributionControl:!0}),Ye.addInitHook((function(){this.options.attributionControl&&(new Ke).addTo(this)})),Ze.Layers=We,Ze.Zoom=Ge,Ze.Scale=Xe,Ze.Attribution=Ke,qe.layers=function(t,e,i){return new We(t,e,i)},qe.zoom=function(t){return new Ge(t)},qe.scale=function(t){return new Xe(t)},qe.attribution=function(t){return new Ke(t)};var Je=E.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Je.addTo=function(t,e){return t.addHandler(e,this),this};var Qe={Events:$},ti=Lt.touch?"touchstart mousedown":"mousedown",ei=A.extend({options:{clickTolerance:3},initialize:function(t,e,i,r){p(this,r),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(Ce(this._dragStartTarget,ti,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ei._dragging===this&&this.finishDrag(!0),$e(this._dragStartTarget,ti,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!le(this._element,"leaflet-zoom-anim")))if(t.touches&&1!==t.touches.length)ei._dragging===this&&this.finishDrag();else if(!(ei._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(ei._dragging=this,this._preventOutline&&xe(this._element),ye(),Zt(),this._moving))){this.fire("down");var e=t.touches?t.touches[0]:t,i=ke(this._element);this._startPoint=new I(e.clientX,e.clientY),this._startPos=_e(this._element),this._parentScale=Te(i);var r="mousedown"===t.type;Ce(document,r?"mousemove":"touchmove",this._onMove,this),Ce(document,r?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(t){if(this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new I(e.clientX,e.clientY)._subtract(this._startPoint);(i.x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,De(t),this._moved||(this.fire("dragstart"),this._moved=!0,ce(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ce(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,this._lastEvent=t,this._updatePosition()))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ge(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){de(document.body,"leaflet-dragging"),this._lastTarget&&(de(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),$e(document,"mousemove touchmove",this._onMove,this),$e(document,"mouseup touchend touchcancel",this._onUp,this),be(),qt();var e=this._moved&&this._moving;this._moving=!1,ei._dragging=!1,e&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function ii(t,e,i){var r,n,a,s,o,l,c,d,h,p=[1,4,2,8];for(n=0,c=t.length;n<c;n++)t[n]._code=pi(t[n],e);for(s=0;s<4;s++){for(d=p[s],r=[],n=0,a=(c=t.length)-1;n<c;a=n++)o=t[n],l=t[a],o._code&d?l._code&d||((h=hi(l,o,d,e,i))._code=pi(h,e),r.push(h)):(l._code&d&&((h=hi(l,o,d,e,i))._code=pi(h,e),r.push(h)),r.push(o));t=r}return t}function ri(t,e){var i,r,n,a,s,o,l,c,d;if(!t||0===t.length)throw new Error("latlngs not passed");fi(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var h=B([0,0]),p=j(t);p.getNorthWest().distanceTo(p.getSouthWest())*p.getNorthEast().distanceTo(p.getNorthWest())<1700&&(h=ni(t));var u=t.length,m=[];for(i=0;i<u;i++){var f=B(t[i]);m.push(e.project(B([f.lat-h.lat,f.lng-h.lng])))}for(o=l=c=0,i=0,r=u-1;i<u;r=i++)n=m[i],a=m[r],s=n.y*a.x-a.y*n.x,l+=(n.x+a.x)*s,c+=(n.y+a.y)*s,o+=3*s;d=0===o?m[0]:[l/o,c/o];var g=e.unproject(P(d));return B([g.lat+h.lat,g.lng+h.lng])}function ni(t){for(var e=0,i=0,r=0,n=0;n<t.length;n++){var a=B(t[n]);e+=a.lat,i+=a.lng,r++}return B([e/r,i/r])}var ai,si={__proto__:null,clipPolygon:ii,polygonCenter:ri,centroid:ni};function oi(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=function(t,e){for(var i=[t[0]],r=1,n=0,a=t.length;r<a;r++)ui(t[r],t[n])>e&&(i.push(t[r]),n=r);return n<a-1&&i.push(t[a-1]),i}(t,i),t=function(t,e){var i=t.length,r=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(i);r[0]=r[i-1]=1,ci(t,r,e,0,i-1);var n,a=[];for(n=0;n<i;n++)r[n]&&a.push(t[n]);return a}(t,i),t}function li(t,e,i){return Math.sqrt(mi(t,e,i,!0))}function ci(t,e,i,r,n){var a,s,o,l=0;for(s=r+1;s<=n-1;s++)(o=mi(t[s],t[r],t[n],!0))>l&&(a=s,l=o);l>i&&(e[a]=1,ci(t,e,i,r,a),ci(t,e,i,a,n))}function di(t,e,i,r,n){var a,s,o,l=r?ai:pi(t,i),c=pi(e,i);for(ai=c;;){if(!(l|c))return[t,e];if(l&c)return!1;o=pi(s=hi(t,e,a=l||c,i,n),i),a===l?(t=s,l=o):(e=s,c=o)}}function hi(t,e,i,r,n){var a,s,o=e.x-t.x,l=e.y-t.y,c=r.min,d=r.max;return 8&i?(a=t.x+o*(d.y-t.y)/l,s=d.y):4&i?(a=t.x+o*(c.y-t.y)/l,s=c.y):2&i?(a=d.x,s=t.y+l*(d.x-t.x)/o):1&i&&(a=c.x,s=t.y+l*(c.x-t.x)/o),new I(a,s,n)}function pi(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function ui(t,e){var i=e.x-t.x,r=e.y-t.y;return i*i+r*r}function mi(t,e,i,r){var n,a=e.x,s=e.y,o=i.x-a,l=i.y-s,c=o*o+l*l;return c>0&&((n=((t.x-a)*o+(t.y-s)*l)/c)>1?(a=i.x,s=i.y):n>0&&(a+=o*n,s+=l*n)),o=t.x-a,l=t.y-s,r?o*o+l*l:new I(a,s)}function fi(t){return!g(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function gi(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),fi(t)}function _i(t,e){var i,r,n,a,s,o,l,c;if(!t||0===t.length)throw new Error("latlngs not passed");fi(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var d=B([0,0]),h=j(t);h.getNorthWest().distanceTo(h.getSouthWest())*h.getNorthEast().distanceTo(h.getNorthWest())<1700&&(d=ni(t));var p=t.length,u=[];for(i=0;i<p;i++){var m=B(t[i]);u.push(e.project(B([m.lat-d.lat,m.lng-d.lng])))}for(i=0,r=0;i<p-1;i++)r+=u[i].distanceTo(u[i+1])/2;if(0===r)c=u[0];else for(i=0,a=0;i<p-1;i++)if(s=u[i],o=u[i+1],(a+=n=s.distanceTo(o))>r){l=(a-r)/n,c=[o.x-l*(o.x-s.x),o.y-l*(o.y-s.y)];break}var f=e.unproject(P(c));return B([f.lat+d.lat,f.lng+d.lng])}var vi={__proto__:null,simplify:oi,pointToSegmentDistance:li,closestPointOnSegment:function(t,e,i){return mi(t,e,i)},clipSegment:di,_getEdgeIntersection:hi,_getBitCode:pi,_sqClosestPointOnSegment:mi,isFlat:fi,_flat:gi,polylineCenter:_i},yi={project:function(t){return new I(t.lng,t.lat)},unproject:function(t){return new O(t.y,t.x)},bounds:new R([-180,-90],[180,90])},bi={R:6378137,R_MINOR:6356752.314245179,bounds:new R([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,r=t.lat*e,n=this.R_MINOR/i,a=Math.sqrt(1-n*n),s=a*Math.sin(r),o=Math.tan(Math.PI/4-r/2)/Math.pow((1-s)/(1+s),a/2);return r=-i*Math.log(Math.max(o,1e-10)),new I(t.lng*e*i,r)},unproject:function(t){for(var e,i=180/Math.PI,r=this.R,n=this.R_MINOR/r,a=Math.sqrt(1-n*n),s=Math.exp(-t.y/r),o=Math.PI/2-2*Math.atan(s),l=0,c=.1;l<15&&Math.abs(c)>1e-7;l++)e=a*Math.sin(o),e=Math.pow((1-e)/(1+e),a/2),o+=c=Math.PI/2-2*Math.atan(s*e)-o;return new O(o*i,t.x*i/r)}},xi={__proto__:null,LonLat:yi,Mercator:bi,SphericalMercator:V},wi=e({},N,{code:"EPSG:3395",projection:bi,transformation:function(){var t=.5/(Math.PI*bi.R);return Y(t,.5,-t,.5)}()}),ki=e({},N,{code:"EPSG:4326",projection:yi,transformation:Y(1/180,1,-1/180,.5)}),Ti=e({},F,{projection:yi,transformation:Y(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,r=e.lat-t.lat;return Math.sqrt(i*i+r*r)},infinite:!0});F.Earth=N,F.EPSG3395=wi,F.EPSG3857=Z,F.EPSG900913=q,F.EPSG4326=ki,F.Simple=Ti;var Si=A.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[a(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[a(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",(function(){e.off(i,this)}),this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});Ye.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=a(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=a(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return a(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){for(var e=0,i=(t=t?g(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[a(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=a(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var r in this._zoomBoundLayers){var n=this._zoomBoundLayers[r].options;t=void 0===n.minZoom?t:Math.min(t,n.minZoom),e=void 0===n.maxZoom?e:Math.max(e,n.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ci=Si.extend({initialize:function(t,e){var i,r;if(p(this,e),this._layers={},t)for(i=0,r=t.length;i<r;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,i,r=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,r);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return a(t)}}),Ei=Ci.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Ci.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Ci.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new D;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),$i=E.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){p(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var r=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(r,t),(this.options.crossOrigin||""===this.options.crossOrigin)&&(r.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),r},_setIconStyles:function(t,e){var i=this.options,r=i[e+"Size"];"number"==typeof r&&(r=[r,r]);var n=P(r),a=P("shadow"===e&&i.shadowAnchor||i.iconAnchor||n&&n.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),a&&(t.style.marginLeft=-a.x+"px",t.style.marginTop=-a.y+"px"),n&&(t.style.width=n.x+"px",t.style.height=n.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Lt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),Ai=$i.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return"string"!=typeof Ai.imagePath&&(Ai.imagePath=this._detectIconPath()),(this.options.imagePath||Ai.imagePath)+$i.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(t,e,i){var r=e.exec(t);return r&&r[i]};return(t=e(t,/^url\((['"])?(.+)\1\)$/,2))&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=re("div","leaflet-default-icon-path",document.body),e=ie(t,"background-image")||ie(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e))return e;var i=document.querySelector('link[href$="leaflet.css"]');return i?i.href.substring(0,i.href.length-11-1):""}}),Ii=Je.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new ei(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ce(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&de(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,r=this._marker.options.autoPanSpeed,n=this._marker.options.autoPanPadding,a=_e(e._icon),s=i.getPixelBounds(),o=i.getPixelOrigin(),l=z(s.min._subtract(o).add(n),s.max._subtract(o).subtract(n));if(!l.contains(a)){var c=P((Math.max(l.max.x,a.x)-l.max.x)/(s.max.x-l.max.x)-(Math.min(l.min.x,a.x)-l.min.x)/(s.min.x-l.min.x),(Math.max(l.max.y,a.y)-l.max.y)/(s.max.y-l.max.y)-(Math.min(l.min.y,a.y)-l.min.y)/(s.min.y-l.min.y)).multiplyBy(r);i.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),ge(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=T(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(S(this._panRequest),this._panRequest=T(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,r=_e(e._icon),n=e._map.layerPointToLatLng(r);i&&ge(i,r),e._latlng=n,t.latlng=n,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){S(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Mi=Si.extend({options:{icon:new Ai,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){p(this,e),this._latlng=B(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=B(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),r=!1;i!==this._icon&&(this._icon&&this._removeIcon(),r=!0,t.title&&(i.title=t.title),"IMG"===i.tagName&&(i.alt=t.alt||"")),ce(i,e),t.keyboard&&(i.tabIndex="0",i.setAttribute("role","button")),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ce(i,"focus",this._panOnFocus,this);var n=t.icon.createShadow(this._shadow),a=!1;n!==this._shadow&&(this._removeShadow(),a=!0),n&&(ce(n,e),n.alt=""),this._shadow=n,t.opacity<1&&this._updateOpacity(),r&&this.getPane().appendChild(this._icon),this._initInteraction(),n&&a&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&$e(this._icon,"focus",this._panOnFocus,this),ne(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ne(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&ge(this._icon,t),this._shadow&&ge(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(ce(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ii)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ii(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&ue(this._icon,t),this._shadow&&ue(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,i=e.iconSize?P(e.iconSize):P(0,0),r=e.iconAnchor?P(e.iconAnchor):P(0,0);t.panInside(this._latlng,{paddingTopLeft:r,paddingBottomRight:i.subtract(r)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),Li=Si.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return p(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Pi=Li.extend({options:{fill:!0,radius:10},initialize:function(t,e){p(this,e),this._latlng=B(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=B(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Li.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),r=[t+i,e+i];this._pxBounds=new R(this._point.subtract(r),this._point.add(r))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Ri=Pi.extend({initialize:function(t,i,r){if("number"==typeof i&&(i=e({},r,{radius:i})),p(this,i),this._latlng=B(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new D(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Li.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,r=i.options.crs;if(r.distance===N.distance){var n=Math.PI/180,a=this._mRadius/N.R/n,s=i.project([e+a,t]),o=i.project([e-a,t]),l=s.add(o).divideBy(2),c=i.unproject(l).lat,d=Math.acos((Math.cos(a*n)-Math.sin(e*n)*Math.sin(c*n))/(Math.cos(e*n)*Math.cos(c*n)))/n;(isNaN(d)||0===d)&&(d=a/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(d)?0:l.x-i.project([c,t-d]).x,this._radiusY=l.y-s.y}else{var h=r.unproject(r.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(h).x}this._updateBounds()}}),zi=Li.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){p(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,r=1/0,n=null,a=mi,s=0,o=this._parts.length;s<o;s++)for(var l=this._parts[s],c=1,d=l.length;c<d;c++){var h=a(t,e=l[c-1],i=l[c],!0);h<r&&(r=h,n=a(t,e,i))}return n&&(n.distance=Math.sqrt(r)),n},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return _i(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=B(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new D,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return fi(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=fi(t),r=0,n=t.length;r<n;r++)i?(e[r]=B(t[r]),this._bounds.extend(e[r])):e[r]=this._convertLatLngs(t[r]);return e},_project:function(){var t=new R;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new I(t,t);this._rawPxBounds&&(this._pxBounds=new R([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,i){var r,n,a=t[0]instanceof O,s=t.length;if(a){for(n=[],r=0;r<s;r++)n[r]=this._map.latLngToLayerPoint(t[r]),i.extend(n[r]);e.push(n)}else for(r=0;r<s;r++)this._projectLatlngs(t[r],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,i,r,n,a,s,o,l=this._parts;for(e=0,r=0,n=this._rings.length;e<n;e++)for(i=0,a=(o=this._rings[e]).length;i<a-1;i++)(s=di(o[i],o[i+1],t,i,!0))&&(l[r]=l[r]||[],l[r].push(s[0]),s[1]===o[i+1]&&i!==a-2||(l[r].push(s[1]),r++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,r=t.length;i<r;i++)t[i]=oi(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,r,n,a,s,o,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,a=this._parts.length;i<a;i++)for(r=0,n=(s=(o=this._parts[i]).length)-1;r<s;n=r++)if((e||0!==r)&&li(t,o[n],o[r])<=l)return!0;return!1}});zi._flat=gi;var Di=zi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ri(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=zi.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof O&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){zi.prototype._setLatLngs.call(this,t),fi(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return fi(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new I(e,e);if(t=new R(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var r,n=0,a=this._rings.length;n<a;n++)(r=ii(this._rings[n],t,!0)).length&&this._parts.push(r)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,i,r,n,a,s,o,l,c=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,o=this._parts.length;n<o;n++)for(a=0,s=(l=(e=this._parts[n]).length)-1;a<l;s=a++)i=e[a],r=e[s],i.y>t.y!=r.y>t.y&&t.x<(r.x-i.x)*(t.y-i.y)/(r.y-i.y)+i.x&&(c=!c);return c||zi.prototype._containsPoint.call(this,t,!0)}}),ji=Ei.extend({initialize:function(t,e){p(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,r,n=g(t)?t:t.features;if(n){for(e=0,i=n.length;e<i;e++)((r=n[e]).geometries||r.geometry||r.features||r.coordinates)&&this.addData(r);return this}var a=this.options;if(a.filter&&!a.filter(t))return this;var s=Oi(t,a);return s?(s.feature=Yi(t),s.defaultOptions=s.options,this.resetStyle(s),a.onEachFeature&&a.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=e({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function Oi(t,e){var i,r,n,a,s="Feature"===t.type?t.geometry:t,o=s?s.coordinates:null,l=[],c=e&&e.pointToLayer,d=e&&e.coordsToLatLng||Fi;if(!o&&!s)return null;switch(s.type){case"Point":return Bi(c,t,i=d(o),e);case"MultiPoint":for(n=0,a=o.length;n<a;n++)i=d(o[n]),l.push(Bi(c,t,i,e));return new Ei(l);case"LineString":case"MultiLineString":return r=Ni(o,"LineString"===s.type?0:1,d),new zi(r,e);case"Polygon":case"MultiPolygon":return r=Ni(o,"Polygon"===s.type?1:2,d),new Di(r,e);case"GeometryCollection":for(n=0,a=s.geometries.length;n<a;n++){var h=Oi({geometry:s.geometries[n],type:"Feature",properties:t.properties},e);h&&l.push(h)}return new Ei(l);case"FeatureCollection":for(n=0,a=s.features.length;n<a;n++){var p=Oi(s.features[n],e);p&&l.push(p)}return new Ei(l);default:throw new Error("Invalid GeoJSON object.")}}function Bi(t,e,i,r){return t?t(e,i):new Mi(i,r&&r.markersInheritOptions&&r)}function Fi(t){return new O(t[1],t[0],t[2])}function Ni(t,e,i){for(var r,n=[],a=0,s=t.length;a<s;a++)r=e?Ni(t[a],e-1,i):(i||Fi)(t[a]),n.push(r);return n}function Hi(t,e){return void 0!==(t=B(t)).alt?[c(t.lng,e),c(t.lat,e),c(t.alt,e)]:[c(t.lng,e),c(t.lat,e)]}function Vi(t,e,i,r){for(var n=[],a=0,s=t.length;a<s;a++)n.push(e?Vi(t[a],fi(t[a])?0:e-1,i,r):Hi(t[a],r));return!e&&i&&n.length>0&&n.push(n[0].slice()),n}function Ui(t,i){return t.feature?e({},t.feature,{geometry:i}):Yi(i)}function Yi(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Zi={toGeoJSON:function(t){return Ui(this,{type:"Point",coordinates:Hi(this.getLatLng(),t)})}};function qi(t,e){return new ji(t,e)}Mi.include(Zi),Ri.include(Zi),Pi.include(Zi),zi.include({toGeoJSON:function(t){var e=!fi(this._latlngs);return Ui(this,{type:(e?"Multi":"")+"LineString",coordinates:Vi(this._latlngs,e?1:0,!1,t)})}}),Di.include({toGeoJSON:function(t){var e=!fi(this._latlngs),i=e&&!fi(this._latlngs[0]),r=Vi(this._latlngs,i?2:e?1:0,!0,t);return e||(r=[r]),Ui(this,{type:(i?"Multi":"")+"Polygon",coordinates:r})}}),Ci.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(i){e.push(i.toGeoJSON(t).geometry.coordinates)})),Ui(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var i="GeometryCollection"===e,r=[];return this.eachLayer((function(e){if(e.toGeoJSON){var n=e.toGeoJSON(t);if(i)r.push(n.geometry);else{var a=Yi(n);"FeatureCollection"===a.type?r.push.apply(r,a.features):r.push(a)}}})),i?Ui(this,{geometries:r,type:"GeometryCollection"}):{type:"FeatureCollection",features:r}}});var Wi=qi,Gi=Si.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,i){this._url=t,this._bounds=j(e),p(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ce(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ne(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&se(this._image),this},bringToBack:function(){return this._map&&oe(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=j(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:re("img");ce(e,"leaflet-image-layer"),this._zoomAnimated&&ce(e,"leaflet-zoom-animated"),this.options.className&&ce(e,this.options.className),e.onselectstart=l,e.onmousemove=l,e.onload=r(this.fire,this,"load"),e.onerror=r(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;fe(this._image,i,e)},_reset:function(){var t=this._image,e=new R(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();ge(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){ue(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Xi=Gi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:re("video");if(ce(e,"leaflet-image-layer"),this._zoomAnimated&&ce(e,"leaflet-zoom-animated"),this.options.className&&ce(e,this.options.className),e.onselectstart=l,e.onmousemove=l,e.onloadeddata=r(this.fire,this,"load"),t){for(var i=e.getElementsByTagName("source"),n=[],a=0;a<i.length;a++)n.push(i[a].src);this._url=i.length>0?n:[e.src]}else{g(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var s=0;s<this._url.length;s++){var o=re("source");o.src=this._url[s],e.appendChild(o)}}}}),Ki=Gi.extend({_initImage:function(){var t=this._image=this._url;ce(t,"leaflet-image-layer"),this._zoomAnimated&&ce(t,"leaflet-zoom-animated"),this.options.className&&ce(t,this.options.className),t.onselectstart=l,t.onmousemove=l}}),Ji=Si.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof O||g(t))?(this._latlng=B(t),p(this,e)):(p(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return(t=arguments.length?t:this._source._map).hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&ue(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&ue(this._container,1),this.bringToFront(),this.options.interactive&&(ce(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(ue(this._container,0),this._removeTimeout=setTimeout(r(ne,void 0,this._container),200)):ne(this._container),this.options.interactive&&(de(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=B(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&se(this._container),this},bringToBack:function(){return this._map&&oe(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof Ei){e=null;var i=this._source._layers;for(var r in i)if(i[r]._map){e=i[r];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else{if(!e.getBounds)throw new Error("Unable to get source layer LatLng.");t=e.getBounds().getCenter()}return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=P(this.options.offset),i=this._getAnchor();this._zoomAnimated?ge(this._container,t.add(i)):e=e.add(t).add(i);var r=this._containerBottom=-e.y,n=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=r+"px",this._container.style.left=n+"px"}},_getAnchor:function(){return[0,0]}});Ye.include({_initOverlay:function(t,e,i,r){var n=e;return n instanceof t||(n=new t(r).setContent(e)),i&&n.setLatLng(i),n}}),Si.include({_initOverlay:function(t,e,i,r){var n=i;return n instanceof t?(p(n,r),n._source=this):(n=e&&!r?e:new t(r,this)).setContent(i),n}});var Qi=Ji.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return!(t=arguments.length?t:this._source._map).hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,Ji.prototype.openOn.call(this,t)},onAdd:function(t){Ji.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Li||this._source.on("preclick",Pe))},onRemove:function(t){Ji.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Li||this._source.off("preclick",Pe))},getEvents:function(){var t=Ji.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=re("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=re("div",t+"-content-wrapper",e);if(this._contentNode=re("div",t+"-content",i),ze(e),Re(this._contentNode),Ce(e,"contextmenu",Pe),this._tipContainer=re("div",t+"-tip-container",e),this._tip=re("div",t+"-tip",this._tipContainer),this.options.closeButton){var r=this._closeButton=re("a",t+"-close-button",e);r.setAttribute("role","button"),r.setAttribute("aria-label","Close popup"),r.href="#close",r.innerHTML='<span aria-hidden="true">&#215;</span>',Ce(r,"click",(function(t){De(t),this.close()}),this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var r=t.offsetHeight,n=this.options.maxHeight,a="leaflet-popup-scrolled";n&&r>n?(e.height=n+"px",ce(t,a)):de(t,a),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();ge(this._container,e.add(i))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var t=this._map,e=parseInt(ie(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,r=this._containerWidth,n=new I(this._containerLeft,-i-this._containerBottom);n._add(_e(this._container));var a=t.layerPointToContainerPoint(n),s=P(this.options.autoPanPadding),o=P(this.options.autoPanPaddingTopLeft||s),l=P(this.options.autoPanPaddingBottomRight||s),c=t.getSize(),d=0,h=0;a.x+r+l.x>c.x&&(d=a.x+r-c.x+l.x),a.x-d-o.x<0&&(d=a.x-o.x),a.y+i+l.y>c.y&&(h=a.y+i-c.y+l.y),a.y-h-o.y<0&&(h=a.y-o.y),(d||h)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([d,h]))}},_getAnchor:function(){return P(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});Ye.mergeOptions({closePopupOnClick:!0}),Ye.include({openPopup:function(t,e,i){return this._initOverlay(Qi,t,e,i).openOn(this),this},closePopup:function(t){return(t=arguments.length?t:this._popup)&&t.close(),this}}),Si.include({bindPopup:function(t,e){return this._popup=this._initOverlay(Qi,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof Ei||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(this._popup&&this._map){je(t);var e=t.layer||t.target;this._popup._source!==e||e instanceof Li?(this._popup._source=e,this.openPopup(t.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var tr=Ji.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){Ji.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){Ji.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=Ji.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=re("div",t),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+a(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,i,r=this._map,n=this._container,a=r.latLngToContainerPoint(r.getCenter()),s=r.layerPointToContainerPoint(t),o=this.options.direction,l=n.offsetWidth,c=n.offsetHeight,d=P(this.options.offset),h=this._getAnchor();"top"===o?(e=l/2,i=c):"bottom"===o?(e=l/2,i=0):"center"===o?(e=l/2,i=c/2):"right"===o?(e=0,i=c/2):"left"===o?(e=l,i=c/2):s.x<a.x?(o="right",e=0,i=c/2):(o="left",e=l+2*(d.x+h.x),i=c/2),t=t.subtract(P(e,i,!0)).add(d).add(h),de(n,"leaflet-tooltip-right"),de(n,"leaflet-tooltip-left"),de(n,"leaflet-tooltip-top"),de(n,"leaflet-tooltip-bottom"),ce(n,"leaflet-tooltip-"+o),ge(n,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&ue(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return P(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});Ye.include({openTooltip:function(t,e,i){return this._initOverlay(tr,t,e,i).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Si.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(tr,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,i.click=this._openTooltip,this._map?this._addFocusListeners():i.add=this._addFocusListeners),this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof Ei||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e="function"==typeof t.getElement&&t.getElement();e&&(Ce(e,"focus",(function(){this._tooltip._source=t,this.openTooltip()}),this),Ce(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e="function"==typeof t.getElement&&t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var e=this;this._map.once("moveend",(function(){e._openOnceFlag=!1,e._openTooltip(t)}))}else this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,i,r=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),r=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(r)}});var er=$i.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;if(i.html instanceof Element?(ae(e),e.appendChild(i.html)):e.innerHTML=!1!==i.html?i.html:"",i.bgPos){var r=P(i.bgPos);e.style.backgroundPosition=-r.x+"px "+-r.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});$i.Default=Ai;var ir=Si.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Lt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){p(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ne(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(se(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(oe(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=s(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof I?t:new I(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,r=-t(-1/0,1/0),n=0,a=i.length;n<a;n++)e=i[n].style.zIndex,i[n]!==this._container&&e&&(r=t(r,+e));isFinite(r)&&(this.options.zIndex=r+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Lt.ielt9){ue(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var r in this._tiles){var n=this._tiles[r];if(n.current&&n.loaded){var a=Math.min(1,(t-n.loaded)/200);ue(n.el,a),a<1?e=!0:(n.active?i=!0:this._onOpaqueTile(n),n.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(S(this._fadeFrame),this._fadeFrame=T(this._updateOpacity,this))}},_onOpaqueTile:l,_initContainer:function(){this._container||(this._container=re("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var i in this._levels)i=Number(i),this._levels[i].el.children.length||i===t?(this._levels[i].el.style.zIndex=e-Math.abs(t-i),this._onUpdateLevel(i)):(ne(this._levels[i].el),this._removeTilesAtZoom(i),this._onRemoveLevel(i),delete this._levels[i]);var r=this._levels[t],n=this._map;return r||((r=this._levels[t]={}).el=re("div","leaflet-tile-container leaflet-zoom-animated",this._container),r.el.style.zIndex=e,r.origin=n.project(n.unproject(n.getPixelOrigin()),t).round(),r.zoom=t,this._setZoomTransform(r,n.getCenter(),n.getZoom()),r.el.offsetWidth,this._onCreateLevel(r)),this._level=r,r}},_onUpdateLevel:l,_onRemoveLevel:l,_onCreateLevel:l,_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var r=e.coords;this._retainParent(r.x,r.y,r.z,r.z-5)||this._retainChildren(r.x,r.y,r.z,r.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ne(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,i,r){var n=Math.floor(t/2),a=Math.floor(e/2),s=i-1,o=new I(+n,+a);o.z=+s;var l=this._tileCoordsToKey(o),c=this._tiles[l];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),s>r&&this._retainParent(n,a,s,r))},_retainChildren:function(t,e,i,r){for(var n=2*t;n<2*t+2;n++)for(var a=2*e;a<2*e+2;a++){var s=new I(n,a);s.z=i+1;var o=this._tileCoordsToKey(s),l=this._tiles[o];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),i+1<r&&this._retainChildren(n,a,i+1,r))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,i,r){var n=Math.round(e);n=void 0!==this.options.maxZoom&&n>this.options.maxZoom||void 0!==this.options.minZoom&&n<this.options.minZoom?void 0:this._clampZoom(n);var a=this.options.updateWhenZooming&&n!==this._tileZoom;r&&!a||(this._tileZoom=n,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==n&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var r=this._map.getZoomScale(i,t.zoom),n=t.origin.multiplyBy(r).subtract(this._map._getNewPixelOrigin(e,i)).round();Lt.any3d?fe(t.el,n,r):ge(t.el,n)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),r=this._tileZoom,n=this._map.getPixelWorldBounds(this._tileZoom);n&&(this._globalTileRange=this._pxBoundsToTileRange(n)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],r).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],r).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],r).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],r).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),r=e.getZoomScale(i,this._tileZoom),n=e.project(t,this._tileZoom).floor(),a=e.getSize().divideBy(2*r);return new R(n.subtract(a),n.add(a))},_update:function(t){var e=this._map;if(e){var i=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var r=this._getTiledPixelBounds(t),n=this._pxBoundsToTileRange(r),a=n.getCenter(),s=[],o=this.options.keepBuffer,l=new R(n.getBottomLeft().subtract([o,-o]),n.getTopRight().add([o,-o]));if(!(isFinite(n.min.x)&&isFinite(n.min.y)&&isFinite(n.max.x)&&isFinite(n.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var d=this._tiles[c].coords;d.z===this._tileZoom&&l.contains(new I(d.x,d.y))||(this._tiles[c].current=!1)}if(Math.abs(i-this._tileZoom)>1)this._setView(t,i);else{for(var h=n.min.y;h<=n.max.y;h++)for(var p=n.min.x;p<=n.max.x;p++){var u=new I(p,h);if(u.z=this._tileZoom,this._isValidTile(u)){var m=this._tiles[this._tileCoordsToKey(u)];m?m.current=!0:s.push(u)}}if(s.sort((function(t,e){return t.distanceTo(a)-e.distanceTo(a)})),0!==s.length){this._loading||(this._loading=!0,this.fire("loading"));var f=document.createDocumentFragment();for(p=0;p<s.length;p++)this._addTile(s[p],f);this._level.el.appendChild(f)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var r=this._tileCoordsToBounds(t);return j(this.options.bounds).overlaps(r)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,i=this.getTileSize(),r=t.scaleBy(i),n=r.add(i);return[e.unproject(r,t.z),e.unproject(n,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),i=new D(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new I(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(ne(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){ce(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=l,t.onmousemove=l,Lt.ielt9&&this.options.opacity<1&&ue(t,this.options.opacity)},_addTile:function(t,e){var i=this._getTilePos(t),n=this._tileCoordsToKey(t),a=this.createTile(this._wrapCoords(t),r(this._tileReady,this,t));this._initTile(a),this.createTile.length<2&&T(r(this._tileReady,this,t,null,a)),ge(a,i),this._tiles[n]={el:a,coords:t,current:!0},e.appendChild(a),this.fire("tileloadstart",{tile:a,coords:t})},_tileReady:function(t,e,i){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var n=this._tileCoordsToKey(t);(i=this._tiles[n])&&(i.loaded=+new Date,this._map._fadeAnimated?(ue(i.el,0),S(this._fadeFrame),this._fadeFrame=T(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(ce(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Lt.ielt9||!this._map._fadeAnimated?T(this._pruneTiles,this):setTimeout(r(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new I(this._wrapX?o(t.x,this._wrapX):t.x,this._wrapY?o(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new R(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),rr=ir.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,(e=p(this,e)).detectRetina&&Lt.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return Ce(i,"load",r(this._tileOnLoad,this,e,i)),Ce(i,"error",r(this._tileOnError,this,e,i)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(i.referrerPolicy=this.options.referrerPolicy),i.alt="",i.src=this.getTileUrl(t),i},getTileUrl:function(t){var i={r:Lt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var r=this._globalTileRange.max.y-t.y;this.options.tms&&(i.y=r),i["-y"]=r}return f(this._url,e(i,this.options))},_tileOnLoad:function(t,e){Lt.ielt9?setTimeout(r(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var r=this.options.errorTileUrl;r&&e.getAttribute("src")!==r&&(e.src=r),t(i,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=l,e.onerror=l,!e.complete)){e.src=v;var i=this._tiles[t].coords;ne(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:i})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",v),ir.prototype._removeTile.call(this,t)},_tileReady:function(t,e,i){if(this._map&&(!i||i.getAttribute("src")!==v))return ir.prototype._tileReady.call(this,t,e,i)}});function nr(t,e){return new rr(t,e)}var ar=rr.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,i){this._url=t;var r=e({},this.defaultWmsParams);for(var n in i)n in this.options||(r[n]=i[n]);var a=(i=p(this,i)).detectRetina&&Lt.retina?2:1,s=this.getTileSize();r.width=s.x*a,r.height=s.y*a,this.wmsParams=r},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,rr.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),i=this._crs,r=z(i.project(e[0]),i.project(e[1])),n=r.min,a=r.max,s=(this._wmsVersion>=1.3&&this._crs===ki?[n.y,n.x,a.y,a.x]:[n.x,n.y,a.x,a.y]).join(","),o=rr.prototype.getTileUrl.call(this,t);return o+u(this.wmsParams,o,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(t,i){return e(this.wmsParams,t),i||this.redraw(),this}});rr.WMS=ar,nr.wms=function(t,e){return new ar(t,e)};var sr=Si.extend({options:{padding:.1},initialize:function(t){p(this,t),a(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ce(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),r=this._map.getSize().multiplyBy(.5+this.options.padding),n=this._map.project(this._center,e),a=r.multiplyBy(-i).add(n).subtract(this._map._getNewPixelOrigin(t,e));Lt.any3d?fe(this._container,a,i):ge(this._container,a)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new R(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),or=sr.extend({options:{tolerance:0},getEvents:function(){var t=sr.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){sr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Ce(t,"mousemove",this._onMouseMove,this),Ce(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ce(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){S(this._redrawRequest),delete this._ctx,ne(this._container),$e(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){sr.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),r=Lt.retina?2:1;ge(e,t.min),e.width=r*i.x,e.height=r*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",Lt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){sr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[a(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,r=e.prev;i?i.prev=r:this._drawLast=r,r?r.next=i:this._drawFirst=i,delete t._order,delete this._layers[a(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,i,r=t.options.dashArray.split(/[, ]+/),n=[];for(i=0;i<r.length;i++){if(e=Number(r[i]),isNaN(e))return;n.push(e)}t.options._dashArray=n}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||T(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new R,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var r=this._drawFirst;r;r=r.next)t=r.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,r,n,a,s=t._parts,o=s.length,l=this._ctx;if(o){for(l.beginPath(),i=0;i<o;i++){for(r=0,n=s[i].length;r<n;r++)a=s[i][r],l[r?"lineTo":"moveTo"](a.x,a.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,r=Math.max(Math.round(t._radius),1),n=(Math.max(Math.round(t._radiusY),1)||r)/r;1!==n&&(i.save(),i.scale(1,n)),i.beginPath(),i.arc(e.x,e.y/n,r,0,2*Math.PI,!1),1!==n&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,r=this._map.mouseEventToLayerPoint(t),n=this._drawFirst;n;n=n.next)(e=n.layer).options.interactive&&e._containsPoint(r)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(e))&&(i=e);this._fireEvent(!!i&&[i],t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(de(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var i,n,a=this._drawFirst;a;a=a.next)(i=a.layer).options.interactive&&i._containsPoint(e)&&(n=i);n!==this._hoveredLayer&&(this._handleMouseOut(t),n&&(ce(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(r((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var i=e.next,r=e.prev;i&&(i.prev=r,r?r.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var i=e.next,r=e.prev;r&&(r.next=i,i?i.prev=r:r&&(this._drawLast=r),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function lr(t){return Lt.canvas?new or(t):null}var cr=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),dr={_initContainer:function(){this._container=re("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(sr.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=cr("shape");ce(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=cr("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[a(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;ne(e),t.removeInteractiveTarget(e),delete this._layers[a(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,r=t.options,n=t._container;n.stroked=!!r.stroke,n.filled=!!r.fill,r.stroke?(e||(e=t._stroke=cr("stroke")),n.appendChild(e),e.weight=r.weight+"px",e.color=r.color,e.opacity=r.opacity,r.dashArray?e.dashStyle=g(r.dashArray)?r.dashArray.join(" "):r.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=r.lineCap.replace("butt","flat"),e.joinstyle=r.lineJoin):e&&(n.removeChild(e),t._stroke=null),r.fill?(i||(i=t._fill=cr("fill")),n.appendChild(i),i.color=r.fillColor||r.color,i.opacity=r.fillOpacity):i&&(n.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),r=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+r+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){se(t._container)},_bringToBack:function(t){oe(t._container)}},hr=Lt.vml?cr:W,pr=sr.extend({_initContainer:function(){this._container=hr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=hr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ne(this._container),$e(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){sr.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),ge(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=hr("path");t.options.className&&ce(e,t.options.className),t.options.interactive&&ce(e,"leaflet-interactive"),this._updateStyle(t),this._layers[a(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ne(t._path),t.removeInteractiveTarget(t._path),delete this._layers[a(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,G(t._parts,e))},_updateCircle:function(t){var e=t._point,i=Math.max(Math.round(t._radius),1),r="a"+i+","+(Math.max(Math.round(t._radiusY),1)||i)+" 0 1,0 ",n=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+r+2*i+",0 "+r+2*-i+",0 ";this._setPath(t,n)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){se(t._path)},_bringToBack:function(t){oe(t._path)}});function ur(t){return Lt.svg||Lt.vml?new pr(t):null}Lt.vml&&pr.include(dr),Ye.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&lr(t)||ur(t)}});var mr=Di.extend({initialize:function(t,e){Di.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=j(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});pr.create=hr,pr.pointsToPath=G,ji.geometryToLayer=Oi,ji.coordsToLatLng=Fi,ji.coordsToLatLngs=Ni,ji.latLngToCoords=Hi,ji.latLngsToCoords=Vi,ji.getFeature=Ui,ji.asFeature=Yi,Ye.mergeOptions({boxZoom:!0});var fr=Je.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Ce(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){$e(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ne(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),Zt(),ye(),this._startPoint=this._map.mouseEventToContainerPoint(t),Ce(document,{contextmenu:je,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=re("div","leaflet-zoom-box",this._container),ce(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new R(this._point,this._startPoint),i=e.getSize();ge(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(ne(this._box),de(this._container,"leaflet-crosshair")),qt(),be(),$e(document,{contextmenu:je,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(r(this._resetState,this),0);var e=new D(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ye.addInitHook("addHandler","boxZoom",fr),Ye.mergeOptions({doubleClickZoom:!0});var gr=Je.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),r=e.options.zoomDelta,n=t.originalEvent.shiftKey?i-r:i+r;"center"===e.options.doubleClickZoom?e.setZoom(n):e.setZoomAround(t.containerPoint,n)}});Ye.addInitHook("addHandler","doubleClickZoom",gr),Ye.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var _r=Je.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new ei(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}ce(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){de(this._map._container,"leaflet-grab"),de(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=j(this._map.options.maxBounds);this._offsetLimit=z(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,r=this._draggable._newPos.x,n=(r-e+i)%t+e-i,a=(r+e+i)%t-e-i,s=Math.abs(n+i)<Math.abs(a+i)?n:a;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,i=e.options,r=!i.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),r)e.fire("moveend");else{this._prunePositions(+new Date);var n=this._lastPos.subtract(this._positions[0]),a=(this._lastTime-this._times[0])/1e3,s=i.easeLinearity,o=n.multiplyBy(s/a),l=o.distanceTo([0,0]),c=Math.min(i.inertiaMaxSpeed,l),d=o.multiplyBy(c/l),h=c/(i.inertiaDeceleration*s),p=d.multiplyBy(-h/2).round();p.x||p.y?(p=e._limitOffset(p,e.options.maxBounds),T((function(){e.panBy(p,{duration:h,easeLinearity:s,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});Ye.addInitHook("addHandler","dragging",_r),Ye.mergeOptions({keyboard:!0,keyboardPanDelta:80});var vr=Je.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Ce(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),$e(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,r=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(r,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,r=this._panKeys={},n=this.keyCodes;for(e=0,i=n.left.length;e<i;e++)r[n.left[e]]=[-1*t,0];for(e=0,i=n.right.length;e<i;e++)r[n.right[e]]=[t,0];for(e=0,i=n.down.length;e<i;e++)r[n.down[e]]=[0,t];for(e=0,i=n.up.length;e<i;e++)r[n.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,r=this._zoomKeys={},n=this.keyCodes;for(e=0,i=n.zoomIn.length;e<i;e++)r[n.zoomIn[e]]=t;for(e=0,i=n.zoomOut.length;e<i;e++)r[n.zoomOut[e]]=-t},_addHooks:function(){Ce(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){$e(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,r=this._map;if(i in this._panKeys){if(!r._panAnim||!r._panAnim._inProgress)if(e=this._panKeys[i],t.shiftKey&&(e=P(e).multiplyBy(3)),r.options.maxBounds&&(e=r._limitOffset(P(e),r.options.maxBounds)),r.options.worldCopyJump){var n=r.wrapLatLng(r.unproject(r.project(r.getCenter()).add(e)));r.panTo(n)}else r.panBy(e)}else if(i in this._zoomKeys)r.setZoom(r.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i||!r._popup||!r._popup.options.closeOnEscapeKey)return;r.closePopup()}je(t)}}});Ye.addInitHook("addHandler","keyboard",vr),Ye.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var yr=Je.extend({addHooks:function(){Ce(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){$e(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=Ne(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r(this._performZoom,this),n),je(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var r=this._delta/(4*this._map.options.wheelPxPerZoomLevel),n=4*Math.log(2/(1+Math.exp(-Math.abs(r))))/Math.LN2,a=i?Math.ceil(n/i)*i:n,s=t._limitZoom(e+(this._delta>0?a:-a))-e;this._delta=0,this._startTime=null,s&&("center"===t.options.scrollWheelZoom?t.setZoom(e+s):t.setZoomAround(this._lastMousePos,e+s))}});Ye.addInitHook("addHandler","scrollWheelZoom",yr),Ye.mergeOptions({tapHold:Lt.touchNative&&Lt.safari&&Lt.mobile,tapTolerance:15});var br=Je.extend({addHooks:function(){Ce(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){$e(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),1===t.touches.length){var e=t.touches[0];this._startPos=this._newPos=new I(e.clientX,e.clientY),this._holdTimeout=setTimeout(r((function(){this._cancel(),this._isTapValid()&&(Ce(document,"touchend",De),Ce(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))}),this),600),Ce(document,"touchend touchcancel contextmenu",this._cancel,this),Ce(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){$e(document,"touchend",De),$e(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),$e(document,"touchend touchcancel contextmenu",this._cancel,this),$e(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new I(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var i=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});i._simulated=!0,e.target.dispatchEvent(i)}});Ye.addInitHook("addHandler","tapHold",br),Ye.mergeOptions({touchZoom:Lt.touch,bounceAtZoomLimits:!0});var xr=Je.extend({addHooks:function(){ce(this._map._container,"leaflet-touch-zoom"),Ce(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){de(this._map._container,"leaflet-touch-zoom"),$e(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToContainerPoint(t.touches[0]),r=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(r)._divideBy(2))),this._startDist=i.distanceTo(r),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Ce(document,"touchmove",this._onTouchMove,this),Ce(document,"touchend touchcancel",this._onTouchEnd,this),De(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]),a=i.distanceTo(n)/this._startDist;if(this._zoom=e.getScaleZoom(a,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&a<1||this._zoom>e.getMaxZoom()&&a>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===a)return}else{var s=i._add(n)._divideBy(2)._subtract(this._centerPoint);if(1===a&&0===s.x&&0===s.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(s),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),S(this._animRequest);var o=r(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=T(o,this,!0),De(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,S(this._animRequest),$e(document,"touchmove",this._onTouchMove,this),$e(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Ye.addInitHook("addHandler","touchZoom",xr),Ye.BoxZoom=fr,Ye.DoubleClickZoom=gr,Ye.Drag=_r,Ye.Keyboard=vr,Ye.ScrollWheelZoom=yr,Ye.TapHold=br,Ye.TouchZoom=xr,t.Bounds=R,t.Browser=Lt,t.CRS=F,t.Canvas=or,t.Circle=Ri,t.CircleMarker=Pi,t.Class=E,t.Control=Ze,t.DivIcon=er,t.DivOverlay=Ji,t.DomEvent=Ve,t.DomUtil=Se,t.Draggable=ei,t.Evented=A,t.FeatureGroup=Ei,t.GeoJSON=ji,t.GridLayer=ir,t.Handler=Je,t.Icon=$i,t.ImageOverlay=Gi,t.LatLng=O,t.LatLngBounds=D,t.Layer=Si,t.LayerGroup=Ci,t.LineUtil=vi,t.Map=Ye,t.Marker=Mi,t.Mixin=Qe,t.Path=Li,t.Point=I,t.PolyUtil=si,t.Polygon=Di,t.Polyline=zi,t.Popup=Qi,t.PosAnimation=Ue,t.Projection=xi,t.Rectangle=mr,t.Renderer=sr,t.SVG=pr,t.SVGOverlay=Ki,t.TileLayer=rr,t.Tooltip=tr,t.Transformation=U,t.Util=C,t.VideoOverlay=Xi,t.bind=r,t.bounds=z,t.canvas=lr,t.circle=function(t,e,i){return new Ri(t,e,i)},t.circleMarker=function(t,e){return new Pi(t,e)},t.control=qe,t.divIcon=function(t){return new er(t)},t.extend=e,t.featureGroup=function(t,e){return new Ei(t,e)},t.geoJSON=qi,t.geoJson=Wi,t.gridLayer=function(t){return new ir(t)},t.icon=function(t){return new $i(t)},t.imageOverlay=function(t,e,i){return new Gi(t,e,i)},t.latLng=B,t.latLngBounds=j,t.layerGroup=function(t,e){return new Ci(t,e)},t.map=function(t,e){return new Ye(t,e)},t.marker=function(t,e){return new Mi(t,e)},t.point=P,t.polygon=function(t,e){return new Di(t,e)},t.polyline=function(t,e){return new zi(t,e)},t.popup=function(t,e){return new Qi(t,e)},t.rectangle=function(t,e){return new mr(t,e)},t.setOptions=p,t.stamp=a,t.svg=ur,t.svgOverlay=function(t,e,i){return new Ki(t,e,i)},t.tileLayer=nr,t.tooltip=function(t,e){return new tr(t,e)},t.transformation=Y,t.version="1.9.4",t.videoOverlay=function(t,e,i){return new Xi(t,e,i)};var wr=window.L;t.noConflict=function(){return window.L=wr,this},window.L=t},"object"==typeof exports&&"undefined"!=typeof module?ff(exports):"function"==typeof define&&define.amd?define(["exports"],ff):ff((mf="undefined"!=typeof globalThis?globalThis:mf||self).leaflet={}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).maplibregl=e()}(void 0,(function(){var t={},e={};function i(i,r,n){if(e[i]=n,"index"===i){var a="var sharedModule = {}; ("+e.shared+")(sharedModule); ("+e.worker+")(sharedModule);",s={};return e.shared(s),e.index(t,s),"undefined"!=typeof window&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))),t}}return i("shared",0,(function(t){function e(t,e,i,r){return new(i||(i=Promise))((function(n,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))}function i(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}"function"==typeof SuppressedError&&SuppressedError;var r=n;function n(t,e){this.x=t,this.y=e}n.prototype={clone:function(){return new n(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),r=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=r,this},_rotateAround:function(t,e){var i=Math.cos(t),r=Math.sin(t),n=e.y+r*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-r*(this.y-e.y),this.y=n,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t};var a=i(r),s=o;function o(t,e,i,r){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=i,this.p2y=r}o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var i=t,r=0;r<8;r++){var n=this.sampleCurveX(i)-t;if(Math.abs(n)<e)return i;var a=this.sampleCurveDerivativeX(i);if(Math.abs(a)<1e-6)break;i-=n/a}var s=0,o=1;for(i=t,r=0;r<20&&(n=this.sampleCurveX(i),!(Math.abs(n-t)<e));r++)t>n?s=i:o=i,i=.5*(o-s)+s;return i},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var l=i(s);let c,d;function h(){return null==c&&(c="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),c}function p(){if(null==d&&(d=!1,h())){const t=5,e=new OffscreenCanvas(t,t).getContext("2d",{willReadFrequently:!0});if(e){for(let i=0;i<t*t;i++){const r=4*i;e.fillStyle=`rgb(${r},${r+1},${r+2})`,e.fillRect(i%t,Math.floor(i/t),1,1)}const i=e.getImageData(0,0,t,t).data;for(let e=0;e<t*t*4;e++)if(e%4!=3&&i[e]!==e){d=!0;break}}}return d||!1}function u(t,e,i,r){const n=new l(t,e,i,r);return t=>n.solve(t)}const m=u(.25,.1,.25,1);function f(t,e,i){return Math.min(i,Math.max(e,t))}function g(t,e,i){const r=i-e,n=((t-e)%r+r)%r+e;return n===e?i:n}function _(t,...e){for(const i of e)for(const e in i)t[e]=i[e];return t}let v=1;function y(t,e,i){const r={};for(const i in t)r[i]=e.call(this,t[i],i,t);return r}function b(t,e,i){const r={};for(const i in t)e.call(this,t[i],i,t)&&(r[i]=t[i]);return r}function x(t){return Array.isArray(t)?t.map(x):"object"==typeof t&&t?y(t,x):t}const w={};function k(t){w[t]||("undefined"!=typeof console&&console.warn(t),w[t]=!0)}function T(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function S(t){return"undefined"!=typeof WorkerGlobalScope&&void 0!==t&&t instanceof WorkerGlobalScope}let C=null;function E(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap}const $="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function A(t,i,r,n,a){return e(this,void 0,void 0,(function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");const e=new VideoFrame(t,{timestamp:0});try{const s=null==e?void 0:e.format;if(!s||!s.startsWith("BGR")&&!s.startsWith("RGB"))throw new Error(`Unrecognized format ${s}`);const o=s.startsWith("BGR"),l=new Uint8ClampedArray(n*a*4);if(yield e.copyTo(l,function(t,e,i,r,n){const a=4*Math.max(-e,0),s=(Math.max(0,i)-i)*r*4+a,o=4*r,l=Math.max(0,e),c=Math.max(0,i);return{rect:{x:l,y:c,width:Math.min(t.width,e+r)-l,height:Math.min(t.height,i+n)-c},layout:[{offset:s,stride:o}]}}(t,i,r,n,a)),o)for(let t=0;t<l.length;t+=4){const e=l[t];l[t]=l[t+2],l[t+2]=e}return l}finally{e.close()}}))}let I,M;const L="AbortError";function P(){return new Error(L)}const R={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function z(t){return R.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))]}const D="global-dispatcher";class j extends Error{constructor(t,e,i,r){super(`AJAXError: ${e} (${t}): ${i}`),this.status=t,this.statusText=e,this.url=i,this.body=r}}const O=()=>S(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,B=function(t,i){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){const e=z(t.url);if(e)return e(t,i);if(S(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,targetMapId:D},i)}if(!(/^file:/.test(r=t.url)||/^file:/.test(O())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(t,i){return e(this,void 0,void 0,(function*(){const e=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:O(),signal:i.signal});"json"!==t.type||e.headers.has("Accept")||e.headers.set("Accept","application/json");const r=yield fetch(e);if(!r.ok){const e=yield r.blob();throw new j(r.status,r.statusText,t.url,e)}let n;n="arrayBuffer"===t.type||"image"===t.type?r.arrayBuffer():"json"===t.type?r.json():r.text();const a=yield n;if(i.signal.aborted)throw P();return{data:a,cacheControl:r.headers.get("Cache-Control"),expires:r.headers.get("Expires")}}))}(t,i);if(S(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,mustQueue:!0,targetMapId:D},i)}var r;return function(t,e){return new Promise(((i,r)=>{var n;const a=new XMLHttpRequest;a.open(t.method||"GET",t.url,!0),"arrayBuffer"!==t.type&&"image"!==t.type||(a.responseType="arraybuffer");for(const e in t.headers)a.setRequestHeader(e,t.headers[e]);"json"===t.type&&(a.responseType="text",(null===(n=t.headers)||void 0===n?void 0:n.Accept)||a.setRequestHeader("Accept","application/json")),a.withCredentials="include"===t.credentials,a.onerror=()=>{r(new Error(a.statusText))},a.onload=()=>{if(!e.signal.aborted)if((a.status>=200&&a.status<300||0===a.status)&&null!==a.response){let e=a.response;if("json"===t.type)try{e=JSON.parse(a.response)}catch(t){return void r(t)}i({data:e,cacheControl:a.getResponseHeader("Cache-Control"),expires:a.getResponseHeader("Expires")})}else{const e=new Blob([a.response],{type:a.getResponseHeader("Content-Type")});r(new j(a.status,a.statusText,t.url,e))}},e.signal.addEventListener("abort",(()=>{a.abort(),r(P())})),a.send(t.body)}))}(t,i)};function F(t){if(!t||t.indexOf("://")<=0||0===t.indexOf("data:image/")||0===t.indexOf("blob:"))return!0;const e=new URL(t),i=window.location;return e.protocol===i.protocol&&e.host===i.host}function N(t,e,i){i[t]&&-1!==i[t].indexOf(e)||(i[t]=i[t]||[],i[t].push(e))}function H(t,e,i){if(i&&i[t]){const r=i[t].indexOf(e);-1!==r&&i[t].splice(r,1)}}class V{constructor(t,e={}){_(this,e),this.type=t}}class U extends V{constructor(t,e={}){super("error",_({error:t},e))}}class Y{on(t,e){return this._listeners=this._listeners||{},N(t,e,this._listeners),this}off(t,e){return H(t,e,this._listeners),H(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},N(t,e,this._oneTimeListeners),this):new Promise((e=>this.once(t,e)))}fire(t,e){"string"==typeof t&&(t=new V(t,e||{}));const i=t.type;if(this.listens(i)){t.target=this;const e=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(const i of e)i.call(this,t);const r=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(const e of r)H(i,e,this._oneTimeListeners),e.call(this,t);const n=this._eventedParent;n&&(_(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),n.fire(t))}else t instanceof U&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var Z={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const q=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function W(t,e){const i={};for(const e in t)"ref"!==e&&(i[e]=t[e]);return q.forEach((t=>{t in e&&(i[t]=e[t])})),i}function G(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!G(t[i],e[i]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(!G(t[i],e[i]))return!1;return!0}return t===e}function X(t,e){t.push(e)}function K(t,e,i){X(i,{command:"addSource",args:[t,e[t]]})}function J(t,e,i){X(e,{command:"removeSource",args:[t]}),i[t]=!0}function Q(t,e,i,r){J(t,i,r),K(t,e,i)}function tt(t,e,i){let r;for(r in t[i])if(Object.prototype.hasOwnProperty.call(t[i],r)&&"data"!==r&&!G(t[i][r],e[i][r]))return!1;for(r in e[i])if(Object.prototype.hasOwnProperty.call(e[i],r)&&"data"!==r&&!G(t[i][r],e[i][r]))return!1;return!0}function et(t,e,i,r,n,a){t=t||{},e=e||{};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(G(t[s],e[s])||i.push({command:a,args:[r,s,e[s],n]}));for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&!Object.prototype.hasOwnProperty.call(t,s)&&(G(t[s],e[s])||i.push({command:a,args:[r,s,e[s],n]}))}function it(t){return t.id}function rt(t,e){return t[e.id]=e,t}class nt{constructor(t,e,i,r){this.message=(t?`${t}: `:"")+i,r&&(this.identifier=r),null!=e&&e.__line__&&(this.line=e.__line__)}}function at(t,...e){for(const i of e)for(const e in i)t[e]=i[e];return t}class st extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class ot{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,i]of e)this.bindings[t]=i}concat(t){return new ot(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const lt={kind:"null"},ct={kind:"number"},dt={kind:"string"},ht={kind:"boolean"},pt={kind:"color"},ut={kind:"object"},mt={kind:"value"},ft={kind:"collator"},gt={kind:"formatted"},_t={kind:"padding"},vt={kind:"resolvedImage"},yt={kind:"variableAnchorOffsetCollection"};function bt(t,e){return{kind:"array",itemType:t,N:e}}function xt(t){if("array"===t.kind){const e=xt(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const wt=[lt,ct,dt,ht,pt,gt,ut,bt(mt),_t,vt,yt];function kt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!kt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of wt)if(!kt(t,e))return null}return`Expected ${xt(t)} but found ${xt(e)} instead.`}function Tt(t,e){return e.some((e=>e.kind===t.kind))}function St(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}function Ct(t,e){return"array"===t.kind&&"array"===e.kind?t.itemType.kind===e.itemType.kind&&"number"==typeof t.N:t.kind===e.kind}const Et=.96422,$t=.82521,At=4/29,It=6/29,Mt=3*It*It,Lt=It*It*It,Pt=Math.PI/180,Rt=180/Math.PI;function zt(t){return(t%=360)<0&&(t+=360),t}function Dt([t,e,i,r]){let n,a;const s=Ot((.2225045*(t=jt(t))+.7168786*(e=jt(e))+.0606169*(i=jt(i)))/1);t===e&&e===i?n=a=s:(n=Ot((.4360747*t+.3850649*e+.1430804*i)/Et),a=Ot((.0139322*t+.0971045*e+.7141733*i)/$t));const o=116*s-16;return[o<0?0:o,500*(n-s),200*(s-a),r]}function jt(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ot(t){return t>Lt?Math.pow(t,1/3):t/Mt+At}function Bt([t,e,i,r]){let n=(t+16)/116,a=isNaN(e)?n:n+e/500,s=isNaN(i)?n:n-i/200;return n=1*Nt(n),a=Et*Nt(a),s=$t*Nt(s),[Ft(3.1338561*a-1.6168667*n-.4906146*s),Ft(-.9787684*a+1.9161415*n+.033454*s),Ft(.0719453*a-.2289914*n+1.4052427*s),r]}function Ft(t){return(t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055)<0?0:t>1?1:t}function Nt(t){return t>It?t*t*t:Mt*(t-At)}function Ht(t){return parseInt(t.padEnd(2,t),16)/255}function Vt(t,e){return Ut(e?t/100:t,0,1)}function Ut(t,e,i){return Math.min(Math.max(e,t),i)}function Yt(t){return!t.some(Number.isNaN)}const Zt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class qt{constructor(t,e,i,r=1,n=!0){this.r=t,this.g=e,this.b=i,this.a=r,n||(this.r*=r,this.g*=r,this.b*=r,r||this.overwriteGetter("rgb",[t,e,i,r]))}static parse(t){if(t instanceof qt)return t;if("string"!=typeof t)return;const e=function(t){if("transparent"===(t=t.toLowerCase().trim()))return[0,0,0,0];const e=Zt[t];if(e){const[t,i,r]=e;return[t/255,i/255,r/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){const e=t.length<6?1:2;let i=1;return[Ht(t.slice(i,i+=e)),Ht(t.slice(i,i+=e)),Ht(t.slice(i,i+=e)),Ht(t.slice(i,i+e)||"ff")]}if(t.startsWith("rgb")){const e=t.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(e){const[t,i,r,n,a,s,o,l,c,d,h,p]=e,u=[n||" ",o||" ",d].join("");if("  "===u||"  /"===u||",,"===u||",,,"===u){const t=[r,s,c].join(""),e="%%%"===t?100:""===t?255:0;if(e){const t=[Ut(+i/e,0,1),Ut(+a/e,0,1),Ut(+l/e,0,1),h?Vt(+h,p):1];if(Yt(t))return t}}return}}const i=t.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(i){const[t,e,r,n,a,s,o,l,c]=i,d=[r||" ",a||" ",o].join("");if("  "===d||"  /"===d||",,"===d||",,,"===d){const t=[+e,Ut(+n,0,100),Ut(+s,0,100),l?Vt(+l,c):1];if(Yt(t))return function([t,e,i,r]){function n(r){const n=(r+t/30)%12,a=e*Math.min(i,1-i);return i-a*Math.max(-1,Math.min(n-3,9-n,1))}return t=zt(t),e/=100,i/=100,[n(0),n(8),n(4),r]}(t)}}}(t);return e?new qt(...e,!1):void 0}get rgb(){const{r:t,g:e,b:i,a:r}=this,n=r||1/0;return this.overwriteGetter("rgb",[t/n,e/n,i/n,r])}get hcl(){return this.overwriteGetter("hcl",function(t){const[e,i,r,n]=Dt(t),a=Math.sqrt(i*i+r*r);return[Math.round(1e4*a)?zt(Math.atan2(r,i)*Rt):NaN,a,e,n]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Dt(this.rgb))}overwriteGetter(t,e){return Object.defineProperty(this,t,{value:e}),e}toString(){const[t,e,i,r]=this.rgb;return`rgba(${[t,e,i].map((t=>Math.round(255*t))).join(",")},${r})`}}qt.black=new qt(0,0,0,1),qt.white=new qt(1,1,1,1),qt.transparent=new qt(0,0,0,0),qt.red=new qt(1,0,0,1);class Wt{constructor(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Gt{constructor(t,e,i,r,n){this.text=t,this.image=e,this.scale=i,this.fontStack=r,this.textColor=n}}class Xt{constructor(t){this.sections=t}static fromString(t){return new Xt([new Gt(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.name.length))}static factory(t){return t instanceof Xt?t:Xt.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}}class Kt{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Kt)return t;if("number"==typeof t)return new Kt([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const e of t)if("number"!=typeof e)return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Kt(t)}}toString(){return JSON.stringify(this.values)}}const Jt=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Qt{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Qt)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let e=0;e<t.length;e+=2){const i=t[e],r=t[e+1];if("string"!=typeof i||!Jt.has(i))return;if(!Array.isArray(r)||2!==r.length||"number"!=typeof r[0]||"number"!=typeof r[1])return}return new Qt(t)}}toString(){return JSON.stringify(this.values)}}class te{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new te({name:t,available:!1}):null}}function ee(t,e,i,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:`Invalid rgba value [${[t,e,i,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof r?[t,e,i,r]:[t,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ie(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof qt||t instanceof Wt||t instanceof Xt||t instanceof Kt||t instanceof Qt||t instanceof te)return!0;if(Array.isArray(t)){for(const e of t)if(!ie(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!ie(t[e]))return!1;return!0}return!1}function re(t){if(null===t)return lt;if("string"==typeof t)return dt;if("boolean"==typeof t)return ht;if("number"==typeof t)return ct;if(t instanceof qt)return pt;if(t instanceof Wt)return ft;if(t instanceof Xt)return gt;if(t instanceof Kt)return _t;if(t instanceof Qt)return yt;if(t instanceof te)return vt;if(Array.isArray(t)){const e=t.length;let i;for(const e of t){const t=re(e);if(i){if(i===t)continue;i=mt;break}i=t}return bt(i||mt,e)}return ut}function ne(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof qt||t instanceof Xt||t instanceof Kt||t instanceof Qt||t instanceof te?t.toString():JSON.stringify(t)}class ae{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ie(t[1]))return e.error("invalid value");const i=t[1];let r=re(i);const n=e.expectedType;return"array"!==r.kind||0!==r.N||!n||"array"!==n.kind||"number"==typeof n.N&&0!==n.N||(r=n),new ae(r,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class se{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const oe={string:dt,number:ct,boolean:ht,object:ut};class le{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let i,r=1;const n=t[0];if("array"===n){let n,a;if(t.length>2){const i=t[1];if("string"!=typeof i||!(i in oe)||"object"===i)return e.error('The item type argument of "array" must be one of string, number, boolean',1);n=oe[i],r++}else n=mt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],r++}i=bt(n,a)}else{if(!oe[n])throw new Error(`Types doesn't contain name = ${n}`);i=oe[n]}const a=[];for(;r<t.length;r++){const i=e.parse(t[r],r,mt);if(!i)return null;a.push(i)}return new le(i,a)}evaluate(t){for(let e=0;e<this.args.length;e++){const i=this.args[e].evaluate(t);if(!kt(this.type,re(i)))return i;if(e===this.args.length-1)throw new se(`Expected value to be of type ${xt(this.type)}, but found ${xt(re(i))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const ce={"to-boolean":ht,"to-color":pt,"to-number":ct,"to-string":dt};class de{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[0];if(!ce[i])throw new Error(`Can't parse ${i} as it is not part of the known types`);if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return e.error("Expected one argument.");const r=ce[i],n=[];for(let i=1;i<t.length;i++){const r=e.parse(t[i],i,mt);if(!r)return null;n.push(r)}return new de(r,n)}evaluate(t){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(t));case"color":{let e,i;for(const r of this.args){if(e=r.evaluate(t),i=null,e instanceof qt)return e;if("string"==typeof e){const i=t.parseColor(e);if(i)return i}else if(Array.isArray(e)&&(i=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:ee(e[0],e[1],e[2],e[3]),!i))return new qt(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new se(i||`Could not parse color from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"padding":{let e;for(const i of this.args){e=i.evaluate(t);const r=Kt.parse(e);if(r)return r}throw new se(`Could not parse padding from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"variableAnchorOffsetCollection":{let e;for(const i of this.args){e=i.evaluate(t);const r=Qt.parse(e);if(r)return r}throw new se(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"number":{let e=null;for(const i of this.args){if(e=i.evaluate(t),null===e)return 0;const r=Number(e);if(!isNaN(r))return r}throw new se(`Could not convert ${JSON.stringify(e)} to number.`)}case"formatted":return Xt.fromString(ne(this.args[0].evaluate(t)));case"resolvedImage":return te.fromString(ne(this.args[0].evaluate(t)));default:return ne(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const he=["Unknown","Point","LineString","Polygon"];class pe{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?he[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=qt.parse(t)),e}}class ue{constructor(t,e,i=[],r,n=new ot,a=[]){this.registry=t,this.path=i,this.key=i.map((t=>`[${t}]`)).join(""),this.scope=n,this.errors=a,this.expectedType=r,this._isConstant=e}parse(t,e,i,r,n={}){return e?this.concat(e,i,r)._parse(t,n):this._parse(t,n)}_parse(t,e){function i(t,e,i){return"assert"===i?new le(e,[t]):"coerce"===i?new de(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const r=t[0];if("string"!=typeof r)return this.error(`Expression name must be a string, but found ${typeof r} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const n=this.registry[r];if(n){let r=n.parse(t,this);if(!r)return null;if(this.expectedType){const t=this.expectedType,n=r.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==n.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==n.kind&&"string"!==n.kind)if("padding"!==t.kind||"value"!==n.kind&&"number"!==n.kind&&"array"!==n.kind)if("variableAnchorOffsetCollection"!==t.kind||"value"!==n.kind&&"array"!==n.kind){if(this.checkSubtype(t,n))return null}else r=i(r,t,e.typeAnnotation||"coerce");else r=i(r,t,e.typeAnnotation||"coerce");else r=i(r,t,e.typeAnnotation||"coerce");else r=i(r,t,e.typeAnnotation||"assert")}if(!(r instanceof ae)&&"resolvedImage"!==r.type.kind&&this._isConstant(r)){const e=new pe;try{r=new ae(r.type,r.evaluate(e))}catch(t){return this.error(t.message),null}}return r}return this.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,i){const r="number"==typeof t?this.path.concat(t):this.path,n=i?this.scope.concat(i):this.scope;return new ue(this.registry,this._isConstant,r,e||null,n,this.errors)}error(t,...e){const i=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new st(i,t))}checkSubtype(t,e){const i=kt(t,e);return i&&this.error(i),i}}class me{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const i=[];for(let r=1;r<t.length-1;r+=2){const n=t[r];if("string"!=typeof n)return e.error(`Expected string, but found ${typeof n} instead.`,r);if(/[^a-zA-Z0-9_]/.test(n))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);const a=e.parse(t[r+1],r+1);if(!a)return null;i.push([n,a])}const r=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return r?new me(i,r):null}outputDefined(){return this.result.outputDefined()}}class fe{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const i=t[1];return e.scope.has(i)?new fe(i,e.scope.get(i)):e.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class ge{constructor(t,e,i){this.type=t,this.index=e,this.input=i}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,ct),r=e.parse(t[2],2,bt(e.expectedType||mt));return i&&r?new ge(r.type.itemType,i,r):null}evaluate(t){const e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new se(`Array index out of bounds: ${e} < 0.`);if(e>=i.length)throw new se(`Array index out of bounds: ${e} > ${i.length-1}.`);if(e!==Math.floor(e))throw new se(`Array index must be an integer, but found ${e} instead.`);return i[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class _e{constructor(t,e){this.type=ht,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,mt),r=e.parse(t[2],2,mt);return i&&r?Tt(i.type,[ht,dt,ct,lt,mt])?new _e(i,r):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${xt(i.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!i)return!1;if(!St(e,["boolean","string","number","null"]))throw new se(`Expected first argument to be of type boolean, string, number or null, but found ${xt(re(e))} instead.`);if(!St(i,["string","array"]))throw new se(`Expected second argument to be of type array or string, but found ${xt(re(i))} instead.`);return i.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class ve{constructor(t,e,i){this.type=ct,this.needle=t,this.haystack=e,this.fromIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,mt),r=e.parse(t[2],2,mt);if(!i||!r)return null;if(!Tt(i.type,[ht,dt,ct,lt,mt]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${xt(i.type)} instead`);if(4===t.length){const n=e.parse(t[3],3,ct);return n?new ve(i,r,n):null}return new ve(i,r)}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!St(e,["boolean","string","number","null"]))throw new se(`Expected first argument to be of type boolean, string, number or null, but found ${xt(re(e))} instead.`);if(!St(i,["string","array"]))throw new se(`Expected second argument to be of type array or string, but found ${xt(re(i))} instead.`);if(this.fromIndex){const r=this.fromIndex.evaluate(t);return i.indexOf(e,r)}return i.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class ye{constructor(t,e,i,r,n,a){this.inputType=t,this.type=e,this.input=i,this.cases=r,this.outputs=n,this.otherwise=a}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let i,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);const n={},a=[];for(let s=2;s<t.length-1;s+=2){let o=t[s];const l=t[s+1];Array.isArray(o)||(o=[o]);const c=e.concat(s);if(0===o.length)return c.error("Expected at least one branch label.");for(const t of o){if("number"!=typeof t&&"string"!=typeof t)return c.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return c.error("Numeric branch labels must be integer values.");if(i){if(c.checkSubtype(i,re(t)))return null}else i=re(t);if(void 0!==n[String(t)])return c.error("Branch labels must be unique.");n[String(t)]=a.length}const d=e.parse(l,s,r);if(!d)return null;r=r||d.type,a.push(d)}const s=e.parse(t[1],1,mt);if(!s)return null;const o=e.parse(t[t.length-1],t.length-1,r);return o?"value"!==s.type.kind&&e.concat(1).checkSubtype(i,s.type)?null:new ye(i,r,s,n,a,o):null}evaluate(t){const e=this.input.evaluate(t);return(re(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class be{constructor(t,e,i){this.type=t,this.branches=e,this.otherwise=i}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const r=[];for(let n=1;n<t.length-1;n+=2){const a=e.parse(t[n],n,ht);if(!a)return null;const s=e.parse(t[n+1],n+1,i);if(!s)return null;r.push([a,s]),i=i||s.type}const n=e.parse(t[t.length-1],t.length-1,i);if(!n)return null;if(!i)throw new Error("Can't infer output type");return new be(i,r,n)}evaluate(t){for(const[e,i]of this.branches)if(e.evaluate(t))return i.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,i]of this.branches)t(e),t(i);t(this.otherwise)}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}}class xe{constructor(t,e,i,r){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=r}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,mt),r=e.parse(t[2],2,ct);if(!i||!r)return null;if(!Tt(i.type,[bt(mt),dt,mt]))return e.error(`Expected first argument to be of type array or string, but found ${xt(i.type)} instead`);if(4===t.length){const n=e.parse(t[3],3,ct);return n?new xe(i.type,i,r,n):null}return new xe(i.type,i,r)}evaluate(t){const e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!St(e,["string","array"]))throw new se(`Expected first argument to be of type array or string, but found ${xt(re(e))} instead.`);if(this.endIndex){const r=this.endIndex.evaluate(t);return e.slice(i,r)}return e.slice(i)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function we(t,e){const i=t.length-1;let r,n,a=0,s=i,o=0;for(;a<=s;)if(o=Math.floor((a+s)/2),r=t[o],n=t[o+1],r<=e){if(o===i||e<n)return o;a=o+1}else{if(!(r>e))throw new se("Input is not a number.");s=o-1}return 0}class ke{constructor(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of i)this.labels.push(t),this.outputs.push(e)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const i=e.parse(t[1],1,ct);if(!i)return null;const r=[];let n=null;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(let i=1;i<t.length;i+=2){const a=1===i?-1/0:t[i],s=t[i+1],o=i,l=i+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(r.length&&r[r.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',o);const c=e.parse(s,l,n);if(!c)return null;n=n||c.type,r.push([a,c])}return new ke(n,i,r)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return i[0].evaluate(t);const n=e.length;return r>=e[n-1]?i[n-1].evaluate(t):i[we(e,r)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}var Te=Se;function Se(t,e,i,r){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=i,this.p2y=r}Se.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var i=t,r=0;r<8;r++){var n=this.sampleCurveX(i)-t;if(Math.abs(n)<e)return i;var a=this.sampleCurveDerivativeX(i);if(Math.abs(a)<1e-6)break;i-=n/a}var s=0,o=1;for(i=t,r=0;r<20&&(n=this.sampleCurveX(i),!(Math.abs(n-t)<e));r++)t>n?s=i:o=i,i=.5*(o-s)+s;return i},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var Ce=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(Te);function Ee(t,e,i){return t+i*(e-t)}function $e(t,e,i){return t.map(((t,r)=>Ee(t,e[r],i)))}const Ae={number:Ee,color:function(t,e,i,r="rgb"){switch(r){case"rgb":{const[r,n,a,s]=$e(t.rgb,e.rgb,i);return new qt(r,n,a,s,!1)}case"hcl":{const[r,n,a,s]=t.hcl,[o,l,c,d]=e.hcl;let h,p;if(isNaN(r)||isNaN(o))isNaN(r)?isNaN(o)?h=NaN:(h=o,1!==a&&0!==a||(p=l)):(h=r,1!==c&&0!==c||(p=n));else{let t=o-r;o>r&&t>180?t-=360:o<r&&r-o>180&&(t+=360),h=r+i*t}const[u,m,f,g]=function([t,e,i,r]){return t=isNaN(t)?0:t*Pt,Bt([i,Math.cos(t)*e,Math.sin(t)*e,r])}([h,null!=p?p:Ee(n,l,i),Ee(a,c,i),Ee(s,d,i)]);return new qt(u,m,f,g,!1)}case"lab":{const[r,n,a,s]=Bt($e(t.lab,e.lab,i));return new qt(r,n,a,s,!1)}}},array:$e,padding:function(t,e,i){return new Kt($e(t.values,e.values,i))},variableAnchorOffsetCollection:function(t,e,i){const r=t.values,n=e.values;if(r.length!==n.length)throw new se(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${e.toString()}`);const a=[];for(let t=0;t<r.length;t+=2){if(r[t]!==n[t])throw new se(`Cannot interpolate values containing mismatched anchors. from[${t}]: ${r[t]}, to[${t}]: ${n[t]}`);a.push(r[t]);const[e,s]=r[t+1],[o,l]=n[t+1];a.push([Ee(e,o,i),Ee(s,l,i)])}return new Qt(a)}};class Ie{constructor(t,e,i,r,n){this.type=t,this.operator=e,this.interpolation=i,this.input=r,this.labels=[],this.outputs=[];for(const[t,e]of n)this.labels.push(t),this.outputs.push(e)}static interpolationFactor(t,e,i,r){let n=0;if("exponential"===t.name)n=Me(e,t.base,i,r);else if("linear"===t.name)n=Me(e,1,i,r);else if("cubic-bezier"===t.name){const a=t.controlPoints;n=new Ce(a[0],a[1],a[2],a[3]).solve(Me(e,1,i,r))}return n}static parse(t,e){let[i,r,n,...a]=t;if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){const t=r[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:t}}else{if("cubic-bezier"!==r[0])return e.error(`Unknown interpolation type ${String(r[0])}`,1,0);{const t=r.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(n=e.parse(n,2,ct),!n)return null;const s=[];let o=null;"interpolate-hcl"===i||"interpolate-lab"===i?o=pt:e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType);for(let t=0;t<a.length;t+=2){const i=a[t],r=a[t+1],n=t+3,l=t+4;if("number"!=typeof i)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(s.length&&s[s.length-1][0]>=i)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);const c=e.parse(r,l,o);if(!c)return null;o=o||c.type,s.push([i,c])}return Ct(o,ct)||Ct(o,pt)||Ct(o,_t)||Ct(o,yt)||Ct(o,bt(ct))?new Ie(o,i,r,n,s):e.error(`Type ${xt(o)} is not interpolatable.`)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return i[0].evaluate(t);const n=e.length;if(r>=e[n-1])return i[n-1].evaluate(t);const a=we(e,r),s=Ie.interpolationFactor(this.interpolation,r,e[a],e[a+1]),o=i[a].evaluate(t),l=i[a+1].evaluate(t);switch(this.operator){case"interpolate":return Ae[this.type.kind](o,l,s);case"interpolate-hcl":return Ae.color(o,l,s,"hcl");case"interpolate-lab":return Ae.color(o,l,s,"lab")}}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Me(t,e,i,r){const n=r-i,a=t-i;return 0===n?0:1===e?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}class Le{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let i=null;const r=e.expectedType;r&&"value"!==r.kind&&(i=r);const n=[];for(const r of t.slice(1)){const t=e.parse(r,1+n.length,i,void 0,{typeAnnotation:"omit"});if(!t)return null;i=i||t.type,n.push(t)}if(!i)throw new Error("No output type");const a=r&&n.some((t=>kt(r,t.type)));return new Le(a?mt:i,n)}evaluate(t){let e,i=null,r=0;for(const n of this.args)if(r++,i=n.evaluate(t),i&&i instanceof te&&!i.available&&(e||(e=i.name),i=null,r===this.args.length&&(i=e)),null!==i)break;return i}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}function Pe(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Re(t,e,i,r){return 0===r.compare(e,i)}function ze(t,e,i){const r="=="!==t&&"!="!==t;return class n{constructor(t,e,i){this.type=ht,this.lhs=t,this.rhs=e,this.collator=i,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const i=t[0];let a=e.parse(t[1],1,mt);if(!a)return null;if(!Pe(i,a.type))return e.concat(1).error(`"${i}" comparisons are not supported for type '${xt(a.type)}'.`);let s=e.parse(t[2],2,mt);if(!s)return null;if(!Pe(i,s.type))return e.concat(2).error(`"${i}" comparisons are not supported for type '${xt(s.type)}'.`);if(a.type.kind!==s.type.kind&&"value"!==a.type.kind&&"value"!==s.type.kind)return e.error(`Cannot compare types '${xt(a.type)}' and '${xt(s.type)}'.`);r&&("value"===a.type.kind&&"value"!==s.type.kind?a=new le(s.type,[a]):"value"!==a.type.kind&&"value"===s.type.kind&&(s=new le(a.type,[s])));let o=null;if(4===t.length){if("string"!==a.type.kind&&"string"!==s.type.kind&&"value"!==a.type.kind&&"value"!==s.type.kind)return e.error("Cannot use collator to compare non-string types.");if(o=e.parse(t[3],3,ft),!o)return null}return new n(a,s,o)}evaluate(n){const a=this.lhs.evaluate(n),s=this.rhs.evaluate(n);if(r&&this.hasUntypedArgument){const e=re(a),i=re(s);if(e.kind!==i.kind||"string"!==e.kind&&"number"!==e.kind)throw new se(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${i.kind}) instead.`)}if(this.collator&&!r&&this.hasUntypedArgument){const t=re(a),i=re(s);if("string"!==t.kind||"string"!==i.kind)return e(n,a,s)}return this.collator?i(n,a,s,this.collator.evaluate(n)):e(n,a,s)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}}}const De=ze("==",(function(t,e,i){return e===i}),Re),je=ze("!=",(function(t,e,i){return e!==i}),(function(t,e,i,r){return!Re(0,e,i,r)})),Oe=ze("<",(function(t,e,i){return e<i}),(function(t,e,i,r){return r.compare(e,i)<0})),Be=ze(">",(function(t,e,i){return e>i}),(function(t,e,i,r){return r.compare(e,i)>0})),Fe=ze("<=",(function(t,e,i){return e<=i}),(function(t,e,i,r){return r.compare(e,i)<=0})),Ne=ze(">=",(function(t,e,i){return e>=i}),(function(t,e,i,r){return r.compare(e,i)>=0}));class He{constructor(t,e,i){this.type=ft,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const i=t[1];if("object"!=typeof i||Array.isArray(i))return e.error("Collator options argument must be an object.");const r=e.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,ht);if(!r)return null;const n=e.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,ht);if(!n)return null;let a=null;return i.locale&&(a=e.parse(i.locale,1,dt),!a)?null:new He(r,n,a)}evaluate(t){return new Wt(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Ve{constructor(t,e,i,r,n){this.type=dt,this.number=t,this.locale=e,this.currency=i,this.minFractionDigits=r,this.maxFractionDigits=n}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,ct);if(!i)return null;const r=t[2];if("object"!=typeof r||Array.isArray(r))return e.error("NumberFormat options argument must be an object.");let n=null;if(r.locale&&(n=e.parse(r.locale,1,dt),!n))return null;let a=null;if(r.currency&&(a=e.parse(r.currency,1,dt),!a))return null;let s=null;if(r["min-fraction-digits"]&&(s=e.parse(r["min-fraction-digits"],1,ct),!s))return null;let o=null;return r["max-fraction-digits"]&&(o=e.parse(r["max-fraction-digits"],1,ct),!o)?null:new Ve(i,n,a,s,o)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Ue{constructor(t){this.type=gt,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[1];if(!Array.isArray(i)&&"object"==typeof i)return e.error("First argument must be an image or text section.");const r=[];let n=!1;for(let i=1;i<=t.length-1;++i){const a=t[i];if(n&&"object"==typeof a&&!Array.isArray(a)){n=!1;let t=null;if(a["font-scale"]&&(t=e.parse(a["font-scale"],1,ct),!t))return null;let i=null;if(a["text-font"]&&(i=e.parse(a["text-font"],1,bt(dt)),!i))return null;let s=null;if(a["text-color"]&&(s=e.parse(a["text-color"],1,pt),!s))return null;const o=r[r.length-1];o.scale=t,o.font=i,o.textColor=s}else{const a=e.parse(t[i],1,mt);if(!a)return null;const s=a.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");n=!0,r.push({content:a,scale:null,font:null,textColor:null})}}return new Ue(r)}evaluate(t){return new Xt(this.sections.map((e=>{const i=e.content.evaluate(t);return re(i)===vt?new Gt("",i,null,null,null):new Gt(ne(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}}class Ye{constructor(t){this.type=vt,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,dt);return i?new Ye(i):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),i=te.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i}eachChild(t){t(this.input)}outputDefined(){return!1}}class Ze{constructor(t){this.type=ct,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const i=e.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?e.error(`Expected argument of type string or array, but found ${xt(i.type)} instead.`):new Ze(i):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new se(`Expected value to be of type string or array, but found ${xt(re(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const qe=8192;function We(t,e){const i=(180+t[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,n=Math.pow(2,e.z);return[Math.round(i*n*qe),Math.round(r*n*qe)]}function Ge(t,e){const i=Math.pow(2,e.z);return[(n=(t[0]/qe+e.x)/i,360*n-180),(r=(t[1]/qe+e.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90)];var r,n}function Xe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Ke(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Je(t,e,i){const r=t[0]-e[0],n=t[1]-e[1],a=t[0]-i[0],s=t[1]-i[1];return r*s-a*n==0&&r*a<=0&&n*s<=0}function Qe(t,e,i,r){return 0!=(n=[r[0]-i[0],r[1]-i[1]])[0]*(a=[e[0]-t[0],e[1]-t[1]])[1]-n[1]*a[0]&&!(!ai(t,e,i,r)||!ai(i,r,t,e));var n,a}function ti(t,e,i){for(const r of i)for(let i=0;i<r.length-1;++i)if(Qe(t,e,r[i],r[i+1]))return!0;return!1}function ei(t,e,i=!1){let r=!1;for(const o of e)for(let e=0;e<o.length-1;e++){if(Je(t,o[e],o[e+1]))return i;(a=o[e])[1]>(n=t)[1]!=(s=o[e+1])[1]>n[1]&&n[0]<(s[0]-a[0])*(n[1]-a[1])/(s[1]-a[1])+a[0]&&(r=!r)}var n,a,s;return r}function ii(t,e){for(const i of e)if(ei(t,i))return!0;return!1}function ri(t,e){for(const i of t)if(!ei(i,e))return!1;for(let i=0;i<t.length-1;++i)if(ti(t[i],t[i+1],e))return!1;return!0}function ni(t,e){for(const i of e)if(ri(t,i))return!0;return!1}function ai(t,e,i,r){const n=r[0]-i[0],a=r[1]-i[1],s=(t[0]-i[0])*a-n*(t[1]-i[1]),o=(e[0]-i[0])*a-n*(e[1]-i[1]);return s>0&&o<0||s<0&&o>0}function si(t,e,i){const r=[];for(let n=0;n<t.length;n++){const a=[];for(let r=0;r<t[n].length;r++){const s=We(t[n][r],i);Xe(e,s),a.push(s)}r.push(a)}return r}function oi(t,e,i){const r=[];for(let n=0;n<t.length;n++){const a=si(t[n],e,i);r.push(a)}return r}function li(t,e,i,r){if(t[0]<i[0]||t[0]>i[2]){const e=.5*r;let n=t[0]-i[0]>e?-r:i[0]-t[0]>e?r:0;0===n&&(n=t[0]-i[2]>e?-r:i[2]-t[0]>e?r:0),t[0]+=n}Xe(e,t)}function ci(t,e,i,r){const n=Math.pow(2,r.z)*qe,a=[r.x*qe,r.y*qe],s=[];for(const r of t)for(const t of r){const r=[t.x+a[0],t.y+a[1]];li(r,e,i,n),s.push(r)}return s}function di(t,e,i,r){const n=Math.pow(2,r.z)*qe,a=[r.x*qe,r.y*qe],s=[];for(const i of t){const t=[];for(const r of i){const i=[r.x+a[0],r.y+a[1]];Xe(e,i),t.push(i)}s.push(t)}if(e[2]-e[0]<=n/2){(o=e)[0]=o[1]=1/0,o[2]=o[3]=-1/0;for(const t of s)for(const r of t)li(r,e,i,n)}var o;return s}class hi{constructor(t,e){this.type=ht,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ie(t[1])){const e=t[1];if("FeatureCollection"===e.type){const t=[];for(const i of e.features){const{type:e,coordinates:r}=i.geometry;"Polygon"===e&&t.push(r),"MultiPolygon"===e&&t.push(...r)}if(t.length)return new hi(e,{type:"MultiPolygon",coordinates:t})}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new hi(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new hi(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if("Polygon"===e.type){const a=si(e.coordinates,r,n),s=ci(t.geometry(),i,r,n);if(!Ke(i,r))return!1;for(const t of s)if(!ei(t,a))return!1}if("MultiPolygon"===e.type){const a=oi(e.coordinates,r,n),s=ci(t.geometry(),i,r,n);if(!Ke(i,r))return!1;for(const t of s)if(!ii(t,a))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if("Polygon"===e.type){const a=si(e.coordinates,r,n),s=di(t.geometry(),i,r,n);if(!Ke(i,r))return!1;for(const t of s)if(!ri(t,a))return!1}if("MultiPolygon"===e.type){const a=oi(e.coordinates,r,n),s=di(t.geometry(),i,r,n);if(!Ke(i,r))return!1;for(const t of s)if(!ni(t,a))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let pi=class{constructor(t=[],e=ui){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:i}=this,r=e[t];for(;t>0;){const n=t-1>>1,a=e[n];if(i(r,a)>=0)break;e[t]=a,t=n}e[t]=r}_down(t){const{data:e,compare:i}=this,r=this.length>>1,n=e[t];for(;t<r;){let r=1+(t<<1),a=e[r];const s=r+1;if(s<this.length&&i(e[s],a)<0&&(r=s,a=e[s]),i(a,n)>=0)break;e[t]=a,t=r}e[t]=n}};function ui(t,e){return t<e?-1:t>e?1:0}function mi(t,e,i,r,n){fi(t,e,i,r||t.length-1,n||_i)}function fi(t,e,i,r,n){for(;r>i;){if(r-i>600){var a=r-i+1,s=e-i+1,o=Math.log(a),l=.5*Math.exp(2*o/3),c=.5*Math.sqrt(o*l*(a-l)/a)*(s-a/2<0?-1:1);fi(t,e,Math.max(i,Math.floor(e-s*l/a+c)),Math.min(r,Math.floor(e+(a-s)*l/a+c)),n)}var d=t[e],h=i,p=r;for(gi(t,i,e),n(t[r],d)>0&&gi(t,i,r);h<p;){for(gi(t,h,p),h++,p--;n(t[h],d)<0;)h++;for(;n(t[p],d)>0;)p--}0===n(t[i],d)?gi(t,i,p):gi(t,++p,r),p<=e&&(i=p+1),e<=p&&(r=p-1)}}function gi(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function _i(t,e){return t<e?-1:t>e?1:0}function vi(t,e){if(t.length<=1)return[t];const i=[];let r,n;for(const e of t){const t=bi(e);0!==t&&(e.area=Math.abs(t),void 0===n&&(n=t<0),n===t<0?(r&&i.push(r),r=[e]):r.push(e))}if(r&&i.push(r),e>1)for(let t=0;t<i.length;t++)i[t].length<=e||(mi(i[t],e,1,i[t].length-1,yi),i[t]=i[t].slice(0,e));return i}function yi(t,e){return e.area-t.area}function bi(t){let e=0;for(let i,r,n=0,a=t.length,s=a-1;n<a;s=n++)i=t[n],r=t[s],e+=(r.x-i.x)*(i.y+r.y);return e}const xi=1/298.257223563,wi=xi*(2-xi),ki=Math.PI/180;class Ti{constructor(t){const e=6378.137*ki*1e3,i=Math.cos(t*ki),r=1/(1-wi*(1-i*i)),n=Math.sqrt(r);this.kx=e*n*i,this.ky=e*n*r*(1-wi)}distance(t,e){const i=this.wrap(t[0]-e[0])*this.kx,r=(t[1]-e[1])*this.ky;return Math.sqrt(i*i+r*r)}pointOnLine(t,e){let i,r,n,a,s=1/0;for(let o=0;o<t.length-1;o++){let l=t[o][0],c=t[o][1],d=this.wrap(t[o+1][0]-l)*this.kx,h=(t[o+1][1]-c)*this.ky,p=0;0===d&&0===h||(p=(this.wrap(e[0]-l)*this.kx*d+(e[1]-c)*this.ky*h)/(d*d+h*h),p>1?(l=t[o+1][0],c=t[o+1][1]):p>0&&(l+=d/this.kx*p,c+=h/this.ky*p)),d=this.wrap(e[0]-l)*this.kx,h=(e[1]-c)*this.ky;const u=d*d+h*h;u<s&&(s=u,i=l,r=c,n=o,a=p)}return{point:[i,r],index:n,t:Math.max(0,Math.min(1,a))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Si(t,e){return e[0]-t[0]}function Ci(t){return t[1]-t[0]+1}function Ei(t,e){return t[1]>=t[0]&&t[1]<e}function $i(t,e){if(t[0]>t[1])return[null,null];const i=Ci(t);if(e){if(2===i)return[t,null];const e=Math.floor(i/2);return[[t[0],t[0]+e],[t[0]+e,t[1]]]}if(1===i)return[t,null];const r=Math.floor(i/2)-1;return[[t[0],t[0]+r],[t[0]+r+1,t[1]]]}function Ai(t,e){if(!Ei(e,t.length))return[1/0,1/0,-1/0,-1/0];const i=[1/0,1/0,-1/0,-1/0];for(let r=e[0];r<=e[1];++r)Xe(i,t[r]);return i}function Ii(t){const e=[1/0,1/0,-1/0,-1/0];for(const i of t)for(const t of i)Xe(e,t);return e}function Mi(t){return t[0]!==-1/0&&t[1]!==-1/0&&t[2]!==1/0&&t[3]!==1/0}function Li(t,e,i){if(!Mi(t)||!Mi(e))return NaN;let r=0,n=0;return t[2]<e[0]&&(r=e[0]-t[2]),t[0]>e[2]&&(r=t[0]-e[2]),t[1]>e[3]&&(n=t[1]-e[3]),t[3]<e[1]&&(n=e[1]-t[3]),i.distance([0,0],[r,n])}function Pi(t,e,i){const r=i.pointOnLine(e,t);return i.distance(t,r.point)}function Ri(t,e,i,r,n){const a=Math.min(Pi(t,[i,r],n),Pi(e,[i,r],n)),s=Math.min(Pi(i,[t,e],n),Pi(r,[t,e],n));return Math.min(a,s)}function zi(t,e,i,r,n){if(!Ei(e,t.length)||!Ei(r,i.length))return 1/0;let a=1/0;for(let s=e[0];s<e[1];++s){const e=t[s],o=t[s+1];for(let t=r[0];t<r[1];++t){const r=i[t],s=i[t+1];if(Qe(e,o,r,s))return 0;a=Math.min(a,Ri(e,o,r,s,n))}}return a}function Di(t,e,i,r,n){if(!Ei(e,t.length)||!Ei(r,i.length))return NaN;let a=1/0;for(let s=e[0];s<=e[1];++s)for(let e=r[0];e<=r[1];++e)if(a=Math.min(a,n.distance(t[s],i[e])),0===a)return a;return a}function ji(t,e,i){if(ei(t,e,!0))return 0;let r=1/0;for(const n of e){const e=n[0],a=n[n.length-1];if(e!==a&&(r=Math.min(r,Pi(t,[a,e],i)),0===r))return r;const s=i.pointOnLine(n,t);if(r=Math.min(r,i.distance(t,s.point)),0===r)return r}return r}function Oi(t,e,i,r){if(!Ei(e,t.length))return NaN;for(let r=e[0];r<=e[1];++r)if(ei(t[r],i,!0))return 0;let n=1/0;for(let a=e[0];a<e[1];++a){const e=t[a],s=t[a+1];for(const t of i)for(let i=0,a=t.length,o=a-1;i<a;o=i++){const a=t[o],l=t[i];if(Qe(e,s,a,l))return 0;n=Math.min(n,Ri(e,s,a,l,r))}}return n}function Bi(t,e){for(const i of t)for(const t of i)if(ei(t,e,!0))return!0;return!1}function Fi(t,e,i,r=1/0){const n=Ii(t),a=Ii(e);if(r!==1/0&&Li(n,a,i)>=r)return r;if(Ke(n,a)){if(Bi(t,e))return 0}else if(Bi(e,t))return 0;let s=1/0;for(const r of t)for(let t=0,n=r.length,a=n-1;t<n;a=t++){const n=r[a],o=r[t];for(const t of e)for(let e=0,r=t.length,a=r-1;e<r;a=e++){const r=t[a],l=t[e];if(Qe(n,o,r,l))return 0;s=Math.min(s,Ri(n,o,r,l,i))}}return s}function Ni(t,e,i,r,n,a){if(!a)return;const s=Li(Ai(r,a),n,i);s<e&&t.push([s,a,[0,0]])}function Hi(t,e,i,r,n,a,s){if(!a||!s)return;const o=Li(Ai(r,a),Ai(n,s),i);o<e&&t.push([o,a,s])}function Vi(t,e,i,r,n=1/0){let a=Math.min(r.distance(t[0],i[0][0]),n);if(0===a)return a;const s=new pi([[0,[0,t.length-1],[0,0]]],Si),o=Ii(i);for(;s.length>0;){const n=s.pop();if(n[0]>=a)continue;const l=n[1],c=e?50:100;if(Ci(l)<=c){if(!Ei(l,t.length))return NaN;if(e){const e=Oi(t,l,i,r);if(isNaN(e)||0===e)return e;a=Math.min(a,e)}else for(let e=l[0];e<=l[1];++e){const n=ji(t[e],i,r);if(a=Math.min(a,n),0===a)return 0}}else{const i=$i(l,e);Ni(s,a,r,t,o,i[0]),Ni(s,a,r,t,o,i[1])}}return a}function Ui(t,e,i,r,n,a=1/0){let s=Math.min(a,n.distance(t[0],i[0]));if(0===s)return s;const o=new pi([[0,[0,t.length-1],[0,i.length-1]]],Si);for(;o.length>0;){const a=o.pop();if(a[0]>=s)continue;const l=a[1],c=a[2],d=e?50:100,h=r?50:100;if(Ci(l)<=d&&Ci(c)<=h){if(!Ei(l,t.length)&&Ei(c,i.length))return NaN;let a;if(e&&r)a=zi(t,l,i,c,n),s=Math.min(s,a);else if(e&&!r){const e=t.slice(l[0],l[1]+1);for(let t=c[0];t<=c[1];++t)if(a=Pi(i[t],e,n),s=Math.min(s,a),0===s)return s}else if(!e&&r){const e=i.slice(c[0],c[1]+1);for(let i=l[0];i<=l[1];++i)if(a=Pi(t[i],e,n),s=Math.min(s,a),0===s)return s}else a=Di(t,l,i,c,n),s=Math.min(s,a)}else{const a=$i(l,e),d=$i(c,r);Hi(o,s,n,t,i,a[0],d[0]),Hi(o,s,n,t,i,a[0],d[1]),Hi(o,s,n,t,i,a[1],d[0]),Hi(o,s,n,t,i,a[1],d[1])}}return s}function Yi(t){return"MultiPolygon"===t.type?t.coordinates.map((t=>({type:"Polygon",coordinates:t}))):"MultiLineString"===t.type?t.coordinates.map((t=>({type:"LineString",coordinates:t}))):"MultiPoint"===t.type?t.coordinates.map((t=>({type:"Point",coordinates:t}))):[t]}class Zi{constructor(t,e){this.type=ct,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ie(t[1])){const e=t[1];if("FeatureCollection"===e.type)return new Zi(e,e.features.map((t=>Yi(t.geometry))).flat());if("Feature"===e.type)return new Zi(e,Yi(e.geometry));if("type"in e&&"coordinates"in e)return new Zi(e,Yi(e))}return e.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const i=t.geometry(),r=i.flat().map((e=>Ge([e.x,e.y],t.canonical)));if(0===i.length)return NaN;const n=new Ti(r[0][1]);let a=1/0;for(const t of e){switch(t.type){case"Point":a=Math.min(a,Ui(r,!1,[t.coordinates],!1,n,a));break;case"LineString":a=Math.min(a,Ui(r,!1,t.coordinates,!0,n,a));break;case"Polygon":a=Math.min(a,Vi(r,!1,t.coordinates,n,a))}if(0===a)return a}return a}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const i=t.geometry(),r=i.flat().map((e=>Ge([e.x,e.y],t.canonical)));if(0===i.length)return NaN;const n=new Ti(r[0][1]);let a=1/0;for(const t of e){switch(t.type){case"Point":a=Math.min(a,Ui(r,!0,[t.coordinates],!1,n,a));break;case"LineString":a=Math.min(a,Ui(r,!0,t.coordinates,!0,n,a));break;case"Polygon":a=Math.min(a,Vi(r,!0,t.coordinates,n,a))}if(0===a)return a}return a}(t,this.geometries);if("Polygon"===t.geometryType())return function(t,e){const i=t.geometry();if(0===i.length||0===i[0].length)return NaN;const r=vi(i,0).map((e=>e.map((e=>e.map((e=>Ge([e.x,e.y],t.canonical))))))),n=new Ti(r[0][0][0][1]);let a=1/0;for(const t of e)for(const e of r){switch(t.type){case"Point":a=Math.min(a,Vi([t.coordinates],!1,e,n,a));break;case"LineString":a=Math.min(a,Vi(t.coordinates,!0,e,n,a));break;case"Polygon":a=Math.min(a,Fi(e,t.coordinates,n,a))}if(0===a)return a}return a}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const qi={"==":De,"!=":je,">":Be,"<":Oe,">=":Ne,"<=":Fe,array:le,at:ge,boolean:le,case:be,coalesce:Le,collator:He,format:Ue,image:Ye,in:_e,"index-of":ve,interpolate:Ie,"interpolate-hcl":Ie,"interpolate-lab":Ie,length:Ze,let:me,literal:ae,match:ye,number:le,"number-format":Ve,object:le,slice:xe,step:ke,string:le,"to-boolean":de,"to-color":de,"to-number":de,"to-string":de,var:fe,within:hi,distance:Zi};class Wi{constructor(t,e,i,r){this.name=t,this.type=e,this._evaluate=i,this.args=r}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,e){const i=t[0],r=Wi.definitions[i];if(!r)return e.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const n=Array.isArray(r)?r[0]:r.type,a=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,s=a.filter((([e])=>!Array.isArray(e)||e.length===t.length-1));let o=null;for(const[r,a]of s){o=new ue(e.registry,Qi,e.path,null,e.scope);const s=[];let l=!1;for(let e=1;e<t.length;e++){const i=t[e],n=Array.isArray(r)?r[e-1]:r.type,a=o.parse(i,1+s.length,n);if(!a){l=!0;break}s.push(a)}if(!l)if(Array.isArray(r)&&r.length!==s.length)o.error(`Expected ${r.length} arguments, but found ${s.length} instead.`);else{for(let t=0;t<s.length;t++){const e=Array.isArray(r)?r[t]:r.type,i=s[t];o.concat(t+1).checkSubtype(e,i.type)}if(0===o.errors.length)return new Wi(i,n,a,s)}}if(1===s.length)e.errors.push(...o.errors);else{const i=(s.length?s:a).map((([t])=>{return e=t,Array.isArray(e)?`(${e.map(xt).join(", ")})`:`(${xt(e.type)}...)`;var e})).join(" | "),r=[];for(let i=1;i<t.length;i++){const n=e.parse(t[i],1+r.length);if(!n)return null;r.push(xt(n.type))}e.error(`Expected arguments of type ${i}, but found (${r.join(", ")}) instead.`)}return null}static register(t,e){Wi.definitions=e;for(const i in e)t[i]=Wi}}function Gi(t,[e,i,r,n]){e=e.evaluate(t),i=i.evaluate(t),r=r.evaluate(t);const a=n?n.evaluate(t):1,s=ee(e,i,r,a);if(s)throw new se(s);return new qt(e/255,i/255,r/255,a,!1)}function Xi(t,e){return t in e}function Ki(t,e){const i=e[t];return void 0===i?null:i}function Ji(t){return{type:t}}function Qi(t){if(t instanceof fe)return Qi(t.boundExpression);if(t instanceof Wi&&"error"===t.name)return!1;if(t instanceof He)return!1;if(t instanceof hi)return!1;if(t instanceof Zi)return!1;const e=t instanceof de||t instanceof le;let i=!0;return t.eachChild((t=>{i=e?i&&Qi(t):i&&t instanceof ae})),!!i&&tr(t)&&ir(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function tr(t){if(t instanceof Wi){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof hi)return!1;if(t instanceof Zi)return!1;let e=!0;return t.eachChild((t=>{e&&!tr(t)&&(e=!1)})),e}function er(t){if(t instanceof Wi&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild((t=>{e&&!er(t)&&(e=!1)})),e}function ir(t,e){if(t instanceof Wi&&e.indexOf(t.name)>=0)return!1;let i=!0;return t.eachChild((t=>{i&&!ir(t,e)&&(i=!1)})),i}function rr(t){return{result:"success",value:t}}function nr(t){return{result:"error",value:t}}function ar(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function sr(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function or(t){return!!t.expression&&t.expression.interpolated}function lr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function cr(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function dr(t){return t}function hr(t,e){const i="color"===e.type,r=t.stops&&"object"==typeof t.stops[0][0],n=r||!(r||void 0!==t.property),a=t.type||(or(e)?"exponential":"interval");if(i||"padding"===e.type){const r=i?qt.parse:Kt.parse;(t=at({},t)).stops&&(t.stops=t.stops.map((t=>[t[0],r(t[1])]))),t.default=r(t.default?t.default:e.default)}if(t.colorSpace&&"rgb"!==(s=t.colorSpace)&&"hcl"!==s&&"lab"!==s)throw new Error(`Unknown color space: "${t.colorSpace}"`);var s;let o,l,c;if("exponential"===a)o=fr;else if("interval"===a)o=mr;else if("categorical"===a){o=ur,l=Object.create(null);for(const e of t.stops)l[e[0]]=e[1];c=typeof t.stops[0][0]}else{if("identity"!==a)throw new Error(`Unknown function type "${a}"`);o=gr}if(r){const i={},r=[];for(let e=0;e<t.stops.length;e++){const n=t.stops[e],a=n[0].zoom;void 0===i[a]&&(i[a]={zoom:a,type:t.type,property:t.property,default:t.default,stops:[]},r.push(a)),i[a].stops.push([n[0].value,n[1]])}const n=[];for(const t of r)n.push([i[t].zoom,hr(i[t],e)]);const a={name:"linear"};return{kind:"composite",interpolationType:a,interpolationFactor:Ie.interpolationFactor.bind(void 0,a),zoomStops:n.map((t=>t[0])),evaluate:({zoom:i},r)=>fr({stops:n,base:t.base},e,i).evaluate(i,r)}}if(n){const i="exponential"===a?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:i,interpolationFactor:Ie.interpolationFactor.bind(void 0,i),zoomStops:t.stops.map((t=>t[0])),evaluate:({zoom:i})=>o(t,e,i,l,c)}}return{kind:"source",evaluate(i,r){const n=r&&r.properties?r.properties[t.property]:void 0;return void 0===n?pr(t.default,e.default):o(t,e,n,l,c)}}}function pr(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function ur(t,e,i,r,n){return pr(typeof i===n?r[i]:void 0,t.default,e.default)}function mr(t,e,i){if("number"!==lr(i))return pr(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[r-1][0])return t.stops[r-1][1];const n=we(t.stops.map((t=>t[0])),i);return t.stops[n][1]}function fr(t,e,i){const r=void 0!==t.base?t.base:1;if("number"!==lr(i))return pr(t.default,e.default);const n=t.stops.length;if(1===n)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[n-1][0])return t.stops[n-1][1];const a=we(t.stops.map((t=>t[0])),i),s=function(t,e,i,r){const n=r-i,a=t-i;return 0===n?0:1===e?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}(i,r,t.stops[a][0],t.stops[a+1][0]),o=t.stops[a][1],l=t.stops[a+1][1],c=Ae[e.type]||dr;return"function"==typeof o.evaluate?{evaluate(...e){const i=o.evaluate.apply(void 0,e),r=l.evaluate.apply(void 0,e);if(void 0!==i&&void 0!==r)return c(i,r,s,t.colorSpace)}}:c(o,l,s,t.colorSpace)}function gr(t,e,i){switch(e.type){case"color":i=qt.parse(i);break;case"formatted":i=Xt.fromString(i.toString());break;case"resolvedImage":i=te.fromString(i.toString());break;case"padding":i=Kt.parse(i);break;default:lr(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0)}return pr(i,t.default,e.default)}Wi.register(qi,{error:[{kind:"error"},[dt],(t,[e])=>{throw new se(e.evaluate(t))}],typeof:[dt,[mt],(t,[e])=>xt(re(e.evaluate(t)))],"to-rgba":[bt(ct,4),[pt],(t,[e])=>{const[i,r,n,a]=e.evaluate(t).rgb;return[255*i,255*r,255*n,a]}],rgb:[pt,[ct,ct,ct],Gi],rgba:[pt,[ct,ct,ct,ct],Gi],has:{type:ht,overloads:[[[dt],(t,[e])=>Xi(e.evaluate(t),t.properties())],[[dt,ut],(t,[e,i])=>Xi(e.evaluate(t),i.evaluate(t))]]},get:{type:mt,overloads:[[[dt],(t,[e])=>Ki(e.evaluate(t),t.properties())],[[dt,ut],(t,[e,i])=>Ki(e.evaluate(t),i.evaluate(t))]]},"feature-state":[mt,[dt],(t,[e])=>Ki(e.evaluate(t),t.featureState||{})],properties:[ut,[],t=>t.properties()],"geometry-type":[dt,[],t=>t.geometryType()],id:[mt,[],t=>t.id()],zoom:[ct,[],t=>t.globals.zoom],"heatmap-density":[ct,[],t=>t.globals.heatmapDensity||0],"line-progress":[ct,[],t=>t.globals.lineProgress||0],accumulated:[mt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[ct,Ji(ct),(t,e)=>{let i=0;for(const r of e)i+=r.evaluate(t);return i}],"*":[ct,Ji(ct),(t,e)=>{let i=1;for(const r of e)i*=r.evaluate(t);return i}],"-":{type:ct,overloads:[[[ct,ct],(t,[e,i])=>e.evaluate(t)-i.evaluate(t)],[[ct],(t,[e])=>-e.evaluate(t)]]},"/":[ct,[ct,ct],(t,[e,i])=>e.evaluate(t)/i.evaluate(t)],"%":[ct,[ct,ct],(t,[e,i])=>e.evaluate(t)%i.evaluate(t)],ln2:[ct,[],()=>Math.LN2],pi:[ct,[],()=>Math.PI],e:[ct,[],()=>Math.E],"^":[ct,[ct,ct],(t,[e,i])=>Math.pow(e.evaluate(t),i.evaluate(t))],sqrt:[ct,[ct],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[ct,[ct],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[ct,[ct],(t,[e])=>Math.log(e.evaluate(t))],log2:[ct,[ct],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[ct,[ct],(t,[e])=>Math.sin(e.evaluate(t))],cos:[ct,[ct],(t,[e])=>Math.cos(e.evaluate(t))],tan:[ct,[ct],(t,[e])=>Math.tan(e.evaluate(t))],asin:[ct,[ct],(t,[e])=>Math.asin(e.evaluate(t))],acos:[ct,[ct],(t,[e])=>Math.acos(e.evaluate(t))],atan:[ct,[ct],(t,[e])=>Math.atan(e.evaluate(t))],min:[ct,Ji(ct),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[ct,Ji(ct),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[ct,[ct],(t,[e])=>Math.abs(e.evaluate(t))],round:[ct,[ct],(t,[e])=>{const i=e.evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[ct,[ct],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[ct,[ct],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[ht,[dt,mt],(t,[e,i])=>t.properties()[e.value]===i.value],"filter-id-==":[ht,[mt],(t,[e])=>t.id()===e.value],"filter-type-==":[ht,[dt],(t,[e])=>t.geometryType()===e.value],"filter-<":[ht,[dt,mt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r<n}],"filter-id-<":[ht,[mt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i<r}],"filter->":[ht,[dt,mt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r>n}],"filter-id->":[ht,[mt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i>r}],"filter-<=":[ht,[dt,mt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r<=n}],"filter-id-<=":[ht,[mt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i<=r}],"filter->=":[ht,[dt,mt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r>=n}],"filter-id->=":[ht,[mt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i>=r}],"filter-has":[ht,[mt],(t,[e])=>e.value in t.properties()],"filter-has-id":[ht,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[ht,[bt(dt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[ht,[bt(mt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[ht,[dt,bt(mt)],(t,[e,i])=>i.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[ht,[dt,bt(mt)],(t,[e,i])=>function(t,e,i,r){for(;i<=r;){const n=i+r>>1;if(e[n]===t)return!0;e[n]>t?r=n-1:i=n+1}return!1}(t.properties()[e.value],i.value,0,i.value.length-1)],all:{type:ht,overloads:[[[ht,ht],(t,[e,i])=>e.evaluate(t)&&i.evaluate(t)],[Ji(ht),(t,e)=>{for(const i of e)if(!i.evaluate(t))return!1;return!0}]]},any:{type:ht,overloads:[[[ht,ht],(t,[e,i])=>e.evaluate(t)||i.evaluate(t)],[Ji(ht),(t,e)=>{for(const i of e)if(i.evaluate(t))return!0;return!1}]]},"!":[ht,[ht],(t,[e])=>!e.evaluate(t)],"is-supported-script":[ht,[dt],(t,[e])=>{const i=t.globals&&t.globals.isSupportedScript;return!i||i(e.evaluate(t))}],upcase:[dt,[dt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[dt,[dt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[dt,Ji(mt),(t,e)=>e.map((e=>ne(e.evaluate(t)))).join("")],"resolved-locale":[dt,[ft],(t,[e])=>e.evaluate(t).resolvedLocale()]});class _r{constructor(t,e){var i;this.expression=t,this._warningHistory={},this._evaluator=new pe,this._defaultValue=e?"color"===(i=e).type&&cr(i.default)?new qt(0,0,0,0):"color"===i.type?qt.parse(i.default)||null:"padding"===i.type?Kt.parse(i.default)||null:"variableAnchorOffsetCollection"===i.type?Qt.parse(i.default)||null:void 0===i.default?null:i.default:null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,i,r,n,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(t,e,i,r,n,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=a||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new se(`Expected value to be one of ${Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function vr(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in qi}function yr(t,e){const i=new ue(qi,Qi,[],e?function(t){const e={color:pt,string:dt,number:ct,enum:dt,boolean:ht,formatted:gt,padding:_t,resolvedImage:vt,variableAnchorOffsetCollection:yt};return"array"===t.type?bt(e[t.value]||mt,t.length):e[t.type]}(e):void 0),r=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?rr(new _r(r,e)):nr(i.errors)}class br{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!er(e.expression)}evaluateWithoutErrorHandling(t,e,i,r,n,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,r,n,a)}evaluate(t,e,i,r,n,a){return this._styleExpression.evaluate(t,e,i,r,n,a)}}class xr{constructor(t,e,i,r){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent="camera"!==t&&!er(e.expression),this.interpolationType=r}evaluateWithoutErrorHandling(t,e,i,r,n,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,r,n,a)}evaluate(t,e,i,r,n,a){return this._styleExpression.evaluate(t,e,i,r,n,a)}interpolationFactor(t,e,i){return this.interpolationType?Ie.interpolationFactor(this.interpolationType,t,e,i):0}}function wr(t,e){const i=yr(t,e);if("error"===i.result)return i;const r=i.value.expression,n=tr(r);if(!n&&!ar(e))return nr([new st("","data expressions not supported")]);const a=ir(r,["zoom"]);if(!a&&!sr(e))return nr([new st("","zoom expressions not supported")]);const s=Tr(r);return s||a?s instanceof st?nr([s]):s instanceof Ie&&!or(e)?nr([new st("",'"interpolate" expressions cannot be used with this property')]):rr(s?new xr(n?"camera":"composite",i.value,s.labels,s instanceof Ie?s.interpolation:void 0):new br(n?"constant":"source",i.value)):nr([new st("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class kr{constructor(t,e){this._parameters=t,this._specification=e,at(this,hr(this._parameters,this._specification))}static deserialize(t){return new kr(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Tr(t){let e=null;if(t instanceof me)e=Tr(t.result);else if(t instanceof Le){for(const i of t.args)if(e=Tr(i),e)break}else(t instanceof ke||t instanceof Ie)&&t.input instanceof Wi&&"zoom"===t.input.name&&(e=t);return e instanceof st||t.eachChild((t=>{const i=Tr(t);i instanceof st?e=i:!e&&i?e=new st("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&i&&e!==i&&(e=new st("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function Sr(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Sr(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const Cr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Er(t){if(null==t)return{filter:()=>!0,needGeometry:!1};Sr(t)||(t=Ir(t));const e=yr(t,Cr);if("error"===e.result)throw new Error(e.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return{filter:(t,i,r)=>e.value.evaluate(t,i,{},r),needGeometry:Ar(t)}}function $r(t,e){return t<e?-1:t>e?1:0}function Ar(t){if(!Array.isArray(t))return!1;if("within"===t[0]||"distance"===t[0])return!0;for(let e=1;e<t.length;e++)if(Ar(t[e]))return!0;return!1}function Ir(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Mr(t[1],t[2],"=="):"!="===e?Rr(Mr(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Mr(t[1],t[2],e):"any"===e?(i=t.slice(1),["any"].concat(i.map(Ir))):"all"===e?["all"].concat(t.slice(1).map(Ir)):"none"===e?["all"].concat(t.slice(1).map(Ir).map(Rr)):"in"===e?Lr(t[1],t.slice(2)):"!in"===e?Rr(Lr(t[1],t.slice(2))):"has"===e?Pr(t[1]):"!has"!==e||Rr(Pr(t[1]));var i}function Mr(t,e,i){switch(t){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,t,e]}}function Lr(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort($r)]]:["filter-in-small",t,["literal",e]]}}function Pr(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Rr(t){return["!",t]}function zr(t){const e=typeof t;if("number"===e||"boolean"===e||"string"===e||null==t)return JSON.stringify(t);if(Array.isArray(t)){let e="[";for(const i of t)e+=`${zr(i)},`;return`${e}]`}const i=Object.keys(t).sort();let r="{";for(let e=0;e<i.length;e++)r+=`${JSON.stringify(i[e])}:${zr(t[i[e]])},`;return`${r}}`}function Dr(t){let e="";for(const i of q)e+=`/${zr(t[i])}`;return e}function jr(t){const e=t.value;return e?[new nt(t.key,e,"constants have been deprecated as of v8")]:[]}function Or(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Br(t){if(Array.isArray(t))return t.map(Br);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const i in t)e[i]=Br(t[i]);return e}return Or(t)}function Fr(t){const e=t.key,i=t.value,r=t.valueSpec||{},n=t.objectElementValidators||{},a=t.style,s=t.styleSpec,o=t.validateSpec;let l=[];const c=lr(i);if("object"!==c)return[new nt(e,i,`object expected, ${c} found`)];for(const t in i){const c=t.split(".")[0],d=r[c]||r["*"];let h;if(n[c])h=n[c];else if(r[c])h=o;else if(n["*"])h=n["*"];else{if(!r["*"]){l.push(new nt(e,i[t],`unknown property "${t}"`));continue}h=o}l=l.concat(h({key:(e?`${e}.`:e)+t,value:i[t],valueSpec:d,style:a,styleSpec:s,object:i,objectKey:t,validateSpec:o},i))}for(const t in r)n[t]||r[t].required&&void 0===r[t].default&&void 0===i[t]&&l.push(new nt(e,i,`missing required property "${t}"`));return l}function Nr(t){const e=t.value,i=t.valueSpec,r=t.style,n=t.styleSpec,a=t.key,s=t.arrayElementValidator||t.validateSpec;if("array"!==lr(e))return[new nt(a,e,`array expected, ${lr(e)} found`)];if(i.length&&e.length!==i.length)return[new nt(a,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new nt(a,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let o={type:i.value,values:i.values};n.$version<7&&(o.function=i.function),"object"===lr(i.value)&&(o=i.value);let l=[];for(let i=0;i<e.length;i++)l=l.concat(s({array:e,arrayIndex:i,value:e[i],valueSpec:o,validateSpec:t.validateSpec,style:r,styleSpec:n,key:`${a}[${i}]`}));return l}function Hr(t){const e=t.key,i=t.value,r=t.valueSpec;let n=lr(i);return"number"===n&&i!=i&&(n="NaN"),"number"!==n?[new nt(e,i,`number expected, ${n} found`)]:"minimum"in r&&i<r.minimum?[new nt(e,i,`${i} is less than the minimum value ${r.minimum}`)]:"maximum"in r&&i>r.maximum?[new nt(e,i,`${i} is greater than the maximum value ${r.maximum}`)]:[]}function Vr(t){const e=t.valueSpec,i=Or(t.value.type);let r,n,a,s={};const o="categorical"!==i&&void 0===t.value.property,l=!o,c="array"===lr(t.value.stops)&&"array"===lr(t.value.stops[0])&&"object"===lr(t.value.stops[0][0]),d=Fr({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===i)return[new nt(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const r=t.value;return e=e.concat(Nr({key:t.key,value:r,valueSpec:t.valueSpec,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===lr(r)&&0===r.length&&e.push(new nt(t.key,r,"array must have at least one stop")),e},default:function(t){return t.validateSpec({key:t.key,value:t.value,valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===i&&o&&d.push(new nt(t.key,t.value,'missing required property "property"')),"identity"===i||t.value.stops||d.push(new nt(t.key,t.value,'missing required property "stops"')),"exponential"===i&&t.valueSpec.expression&&!or(t.valueSpec)&&d.push(new nt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!ar(t.valueSpec)?d.push(new nt(t.key,t.value,"property functions not supported")):o&&!sr(t.valueSpec)&&d.push(new nt(t.key,t.value,"zoom functions not supported"))),"categorical"!==i&&!c||void 0!==t.value.property||d.push(new nt(t.key,t.value,'"property" property is required')),d;function h(t){let i=[];const r=t.value,o=t.key;if("array"!==lr(r))return[new nt(o,r,`array expected, ${lr(r)} found`)];if(2!==r.length)return[new nt(o,r,`array length 2 expected, length ${r.length} found`)];if(c){if("object"!==lr(r[0]))return[new nt(o,r,`object expected, ${lr(r[0])} found`)];if(void 0===r[0].zoom)return[new nt(o,r,"object stop key must have zoom")];if(void 0===r[0].value)return[new nt(o,r,"object stop key must have value")];if(a&&a>Or(r[0].zoom))return[new nt(o,r[0].zoom,"stop zoom values must appear in ascending order")];Or(r[0].zoom)!==a&&(a=Or(r[0].zoom),n=void 0,s={}),i=i.concat(Fr({key:`${o}[0]`,value:r[0],valueSpec:{zoom:{}},validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Hr,value:p}}))}else i=i.concat(p({key:`${o}[0]`,value:r[0],valueSpec:{},validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec},r));return vr(Br(r[1]))?i.concat([new nt(`${o}[1]`,r[1],"expressions are not allowed in function stops.")]):i.concat(t.validateSpec({key:`${o}[1]`,value:r[1],valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec}))}function p(t,a){const o=lr(t.value),l=Or(t.value),c=null!==t.value?t.value:a;if(r){if(o!==r)return[new nt(t.key,c,`${o} stop domain type must match previous stop domain type ${r}`)]}else r=o;if("number"!==o&&"string"!==o&&"boolean"!==o)return[new nt(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==o&&"categorical"!==i){let r=`number expected, ${o} found`;return ar(e)&&void 0===i&&(r+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new nt(t.key,c,r)]}return"categorical"!==i||"number"!==o||isFinite(l)&&Math.floor(l)===l?"categorical"!==i&&"number"===o&&void 0!==n&&l<n?[new nt(t.key,c,"stop domain values must appear in ascending order")]:(n=l,"categorical"===i&&l in s?[new nt(t.key,c,"stop domain values must be unique")]:(s[l]=!0,[])):[new nt(t.key,c,`integer expected, found ${l}`)]}}function Ur(t){const e=("property"===t.expressionContext?wr:yr)(Br(t.value),t.valueSpec);if("error"===e.result)return e.value.map((e=>new nt(`${t.key}${e.key}`,t.value,e.message)));const i=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!i.outputDefined())return[new nt(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!er(i))return[new nt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!er(i))return[new nt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!ir(i,["zoom","feature-state"]))return[new nt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!tr(i))return[new nt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Yr(t){const e=t.key,i=t.value,r=t.valueSpec,n=[];return Array.isArray(r.values)?-1===r.values.indexOf(Or(i))&&n.push(new nt(e,i,`expected one of [${r.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(r.values).indexOf(Or(i))&&n.push(new nt(e,i,`expected one of [${Object.keys(r.values).join(", ")}], ${JSON.stringify(i)} found`)),n}function Zr(t){return Sr(Br(t.value))?Ur(at({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):qr(t)}function qr(t){const e=t.value,i=t.key;if("array"!==lr(e))return[new nt(i,e,`array expected, ${lr(e)} found`)];const r=t.styleSpec;let n,a=[];if(e.length<1)return[new nt(i,e,"filter array must have at least 1 element")];switch(a=a.concat(Yr({key:`${i}[0]`,value:e[0],valueSpec:r.filter_operator,style:t.style,styleSpec:t.styleSpec})),Or(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===Or(e[1])&&a.push(new nt(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&a.push(new nt(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(n=lr(e[1]),"string"!==n&&a.push(new nt(`${i}[1]`,e[1],`string expected, ${n} found`)));for(let s=2;s<e.length;s++)n=lr(e[s]),"$type"===Or(e[1])?a=a.concat(Yr({key:`${i}[${s}]`,value:e[s],valueSpec:r.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==n&&"number"!==n&&"boolean"!==n&&a.push(new nt(`${i}[${s}]`,e[s],`string, number, or boolean expected, ${n} found`));break;case"any":case"all":case"none":for(let r=1;r<e.length;r++)a=a.concat(qr({key:`${i}[${r}]`,value:e[r],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":n=lr(e[1]),2!==e.length?a.push(new nt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==n&&a.push(new nt(`${i}[1]`,e[1],`string expected, ${n} found`))}return a}function Wr(t,e){const i=t.key,r=t.validateSpec,n=t.style,a=t.styleSpec,s=t.value,o=t.objectKey,l=a[`${e}_${t.layerType}`];if(!l)return[];const c=o.match(/^(.*)-transition$/);if("paint"===e&&c&&l[c[1]]&&l[c[1]].transition)return r({key:i,value:s,valueSpec:a.transition,style:n,styleSpec:a});const d=t.valueSpec||l[o];if(!d)return[new nt(i,s,`unknown property "${o}"`)];let h;if("string"===lr(s)&&ar(d)&&!d.tokens&&(h=/^{([^}]+)}$/.exec(s)))return[new nt(i,s,`"${o}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(h[1])} }\`.`)];const p=[];return"symbol"===t.layerType&&("text-field"===o&&n&&!n.glyphs&&p.push(new nt(i,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&cr(Br(s))&&"identity"===Or(s.type)&&p.push(new nt(i,s,'"text-font" does not support identity functions'))),p.concat(r({key:t.key,value:s,valueSpec:d,style:n,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:o}))}function Gr(t){return Wr(t,"paint")}function Xr(t){return Wr(t,"layout")}function Kr(t){let e=[];const i=t.value,r=t.key,n=t.style,a=t.styleSpec;i.type||i.ref||e.push(new nt(r,i,'either "type" or "ref" is required'));let s=Or(i.type);const o=Or(i.ref);if(i.id){const a=Or(i.id);for(let s=0;s<t.arrayIndex;s++){const t=n.layers[s];Or(t.id)===a&&e.push(new nt(r,i.id,`duplicate layer id "${i.id}", previously used at line ${t.id.__line__}`))}}if("ref"in i){let t;["type","source","source-layer","filter","layout"].forEach((t=>{t in i&&e.push(new nt(r,i[t],`"${t}" is prohibited for ref layers`))})),n.layers.forEach((e=>{Or(e.id)===o&&(t=e)})),t?t.ref?e.push(new nt(r,i.ref,"ref cannot reference another ref layer")):s=Or(t.type):e.push(new nt(r,i.ref,`ref layer "${o}" not found`))}else if("background"!==s)if(i.source){const t=n.sources&&n.sources[i.source],a=t&&Or(t.type);t?"vector"===a&&"raster"===s?e.push(new nt(r,i.source,`layer "${i.id}" requires a raster source`)):"raster-dem"!==a&&"hillshade"===s?e.push(new nt(r,i.source,`layer "${i.id}" requires a raster-dem source`)):"raster"===a&&"raster"!==s?e.push(new nt(r,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==a||i["source-layer"]?"raster-dem"===a&&"hillshade"!==s?e.push(new nt(r,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!i.paint||!i.paint["line-gradient"]||"geojson"===a&&t.lineMetrics||e.push(new nt(r,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new nt(r,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new nt(r,i.source,`source "${i.source}" not found`))}else e.push(new nt(r,i,'missing required property "source"'));return e=e.concat(Fr({key:r,value:i,valueSpec:a.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":()=>[],type:()=>t.validateSpec({key:`${r}.type`,value:i.type,valueSpec:a.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:i,objectKey:"type"}),filter:Zr,layout:t=>Fr({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>Xr(at({layerType:s},t))}}),paint:t=>Fr({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>Gr(at({layerType:s},t))}})}})),e}function Jr(t){const e=t.value,i=t.key,r=lr(e);return"string"!==r?[new nt(i,e,`string expected, ${r} found`)]:[]}const Qr={promoteId:function({key:t,value:e}){if("string"===lr(e))return Jr({key:t,value:e});{const i=[];for(const r in e)i.push(...Jr({key:`${t}.${r}`,value:e[r]}));return i}}};function tn(t){const e=t.value,i=t.key,r=t.styleSpec,n=t.style,a=t.validateSpec;if(!e.type)return[new nt(i,e,'"type" is required')];const s=Or(e.type);let o;switch(s){case"vector":case"raster":return o=Fr({key:i,value:e,valueSpec:r[`source_${s.replace("-","_")}`],style:t.style,styleSpec:r,objectElementValidators:Qr,validateSpec:a}),o;case"raster-dem":return o=function(t){var e;const i=null!==(e=t.sourceName)&&void 0!==e?e:"",r=t.value,n=t.styleSpec,a=n.source_raster_dem,s=t.style;let o=[];const l=lr(r);if(void 0===r)return o;if("object"!==l)return o.push(new nt("source_raster_dem",r,`object expected, ${l} found`)),o;const c="custom"===Or(r.encoding),d=["redFactor","greenFactor","blueFactor","baseShift"],h=t.value.encoding?`"${t.value.encoding}"`:"Default";for(const e in r)!c&&d.includes(e)?o.push(new nt(e,r[e],`In "${i}": "${e}" is only valid when "encoding" is set to "custom". ${h} encoding found`)):a[e]?o=o.concat(t.validateSpec({key:e,value:r[e],valueSpec:a[e],validateSpec:t.validateSpec,style:s,styleSpec:n})):o.push(new nt(e,r[e],`unknown property "${e}"`));return o}({sourceName:i,value:e,style:t.style,styleSpec:r,validateSpec:a}),o;case"geojson":if(o=Fr({key:i,value:e,valueSpec:r.source_geojson,style:n,styleSpec:r,validateSpec:a,objectElementValidators:Qr}),e.cluster)for(const t in e.clusterProperties){const[r,n]=e.clusterProperties[t],s="string"==typeof r?[r,["accumulated"],["get",t]]:r;o.push(...Ur({key:`${i}.${t}.map`,value:n,validateSpec:a,expressionContext:"cluster-map"})),o.push(...Ur({key:`${i}.${t}.reduce`,value:s,validateSpec:a,expressionContext:"cluster-reduce"}))}return o;case"video":return Fr({key:i,value:e,valueSpec:r.source_video,style:n,validateSpec:a,styleSpec:r});case"image":return Fr({key:i,value:e,valueSpec:r.source_image,style:n,validateSpec:a,styleSpec:r});case"canvas":return[new nt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Yr({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,validateSpec:a,styleSpec:r})}}function en(t){const e=t.value,i=t.styleSpec,r=i.light,n=t.style;let a=[];const s=lr(e);if(void 0===e)return a;if("object"!==s)return a=a.concat([new nt("light",e,`object expected, ${s} found`)]),a;for(const s in e){const o=s.match(/^(.*)-transition$/);a=a.concat(o&&r[o[1]]&&r[o[1]].transition?t.validateSpec({key:s,value:e[s],valueSpec:i.transition,validateSpec:t.validateSpec,style:n,styleSpec:i}):r[s]?t.validateSpec({key:s,value:e[s],valueSpec:r[s],validateSpec:t.validateSpec,style:n,styleSpec:i}):[new nt(s,e[s],`unknown property "${s}"`)])}return a}function rn(t){const e=t.value,i=t.styleSpec,r=i.sky,n=t.style,a=lr(e);if(void 0===e)return[];if("object"!==a)return[new nt("sky",e,`object expected, ${a} found`)];let s=[];for(const a in e)s=s.concat(r[a]?t.validateSpec({key:a,value:e[a],valueSpec:r[a],style:n,styleSpec:i}):[new nt(a,e[a],`unknown property "${a}"`)]);return s}function nn(t){const e=t.value,i=t.styleSpec,r=i.terrain,n=t.style;let a=[];const s=lr(e);if(void 0===e)return a;if("object"!==s)return a=a.concat([new nt("terrain",e,`object expected, ${s} found`)]),a;for(const s in e)a=a.concat(r[s]?t.validateSpec({key:s,value:e[s],valueSpec:r[s],validateSpec:t.validateSpec,style:n,styleSpec:i}):[new nt(s,e[s],`unknown property "${s}"`)]);return a}function an(t){let e=[];const i=t.value,r=t.key;if(Array.isArray(i)){const n=[],a=[];for(const s in i)i[s].id&&n.includes(i[s].id)&&e.push(new nt(r,i,`all the sprites' ids must be unique, but ${i[s].id} is duplicated`)),n.push(i[s].id),i[s].url&&a.includes(i[s].url)&&e.push(new nt(r,i,`all the sprites' URLs must be unique, but ${i[s].url} is duplicated`)),a.push(i[s].url),e=e.concat(Fr({key:`${r}[${s}]`,value:i[s],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:t.validateSpec}));return e}return Jr({key:r,value:i})}const sn={"*":()=>[],array:Nr,boolean:function(t){const e=t.value,i=t.key,r=lr(e);return"boolean"!==r?[new nt(i,e,`boolean expected, ${r} found`)]:[]},number:Hr,color:function(t){const e=t.key,i=t.value,r=lr(i);return"string"!==r?[new nt(e,i,`color expected, ${r} found`)]:qt.parse(String(i))?[]:[new nt(e,i,`color expected, "${i}" found`)]},constants:jr,enum:Yr,filter:Zr,function:Vr,layer:Kr,object:Fr,source:tn,light:en,sky:rn,terrain:nn,projection:function(t){const e=t.value,i=t.styleSpec,r=i.projection,n=t.style,a=lr(e);if(void 0===e)return[];if("object"!==a)return[new nt("projection",e,`object expected, ${a} found`)];let s=[];for(const a in e)s=s.concat(r[a]?t.validateSpec({key:a,value:e[a],valueSpec:r[a],style:n,styleSpec:i}):[new nt(a,e[a],`unknown property "${a}"`)]);return s},string:Jr,formatted:function(t){return 0===Jr(t).length?[]:Ur(t)},resolvedImage:function(t){return 0===Jr(t).length?[]:Ur(t)},padding:function(t){const e=t.key,i=t.value;if("array"===lr(i)){if(i.length<1||i.length>4)return[new nt(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const r={type:"number"};let n=[];for(let a=0;a<i.length;a++)n=n.concat(t.validateSpec({key:`${e}[${a}]`,value:i[a],validateSpec:t.validateSpec,valueSpec:r}));return n}return Hr({key:e,value:i,valueSpec:{}})},variableAnchorOffsetCollection:function(t){const e=t.key,i=t.value,r=lr(i),n=t.styleSpec;if("array"!==r||i.length<1||i.length%2!=0)return[new nt(e,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let r=0;r<i.length;r+=2)a=a.concat(Yr({key:`${e}[${r}]`,value:i[r],valueSpec:n.layout_symbol["text-anchor"]})),a=a.concat(Nr({key:`${e}[${r+1}]`,value:i[r+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:n}));return a},sprite:an};function on(t){const e=t.value,i=t.valueSpec,r=t.styleSpec;return t.validateSpec=on,i.expression&&cr(Or(e))?Vr(t):i.expression&&vr(Br(e))?Ur(t):i.type&&sn[i.type]?sn[i.type](t):Fr(at({},t,{valueSpec:i.type?r[i.type]:i}))}function ln(t){const e=t.value,i=t.key,r=Jr(t);return r.length||(-1===e.indexOf("{fontstack}")&&r.push(new nt(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new nt(i,e,'"glyphs" url must include a "{range}" token'))),r}function cn(t,e=Z){let i=[];return i=i.concat(on({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:on,objectElementValidators:{glyphs:ln,"*":()=>[]}})),t.constants&&(i=i.concat(jr({key:"constants",value:t.constants,style:t,styleSpec:e,validateSpec:on}))),hn(i)}function dn(t){return function(e){return t({...e,validateSpec:on})}}function hn(t){return[].concat(t).sort(((t,e)=>t.line-e.line))}function pn(t){return function(...e){return hn(t.apply(this,e))}}cn.source=pn(dn(tn)),cn.sprite=pn(dn(an)),cn.glyphs=pn(dn(ln)),cn.light=pn(dn(en)),cn.sky=pn(dn(rn)),cn.terrain=pn(dn(nn)),cn.layer=pn(dn(Kr)),cn.filter=pn(dn(Zr)),cn.paintProperty=pn(dn(Gr)),cn.layoutProperty=pn(dn(Xr));const un=cn,mn=un.light,fn=un.paintProperty,gn=un.layoutProperty;function _n(t,e){let i=!1;if(e&&e.length)for(const r of e)t.fire(new U(new Error(r.message))),i=!0;return i}class vn{constructor(t,e,i){const r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const n=new Int32Array(this.arrayBuffer);t=n[0],this.d=(e=n[1])+2*(i=n[2]);for(let t=0;t<this.d*this.d;t++){const e=n[3+t],i=n[3+t+1];r.push(e===i?null:n.subarray(e,i))}const a=n[3+r.length+1];this.keys=n.subarray(n[3+r.length],a),this.bboxes=n.subarray(a),this.insert=this._insertReadonly}else{this.d=e+2*i;for(let t=0;t<this.d*this.d;t++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;const n=i/e*t;this.min=-n,this.max=t+n}insert(t,e,i,r,n){this._forEachCell(e,i,r,n,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,e,i,r,n,a){this.cells[n].push(a)}query(t,e,i,r,n){const a=this.min,s=this.max;if(t<=a&&e<=a&&s<=i&&s<=r&&!n)return Array.prototype.slice.call(this.keys);{const a=[];return this._forEachCell(t,e,i,r,this._queryCell,a,{},n),a}}_queryCell(t,e,i,r,n,a,s,o){const l=this.cells[n];if(null!==l){const n=this.keys,c=this.bboxes;for(let d=0;d<l.length;d++){const h=l[d];if(void 0===s[h]){const l=4*h;(o?o(c[l+0],c[l+1],c[l+2],c[l+3]):t<=c[l+2]&&e<=c[l+3]&&i>=c[l+0]&&r>=c[l+1])?(s[h]=!0,a.push(n[h])):s[h]=!1}}}}_forEachCell(t,e,i,r,n,a,s,o){const l=this._convertToCellCoord(t),c=this._convertToCellCoord(e),d=this._convertToCellCoord(i),h=this._convertToCellCoord(r);for(let p=l;p<=d;p++)for(let l=c;l<=h;l++){const c=this.d*l+p;if((!o||o(this._convertFromCellCoord(p),this._convertFromCellCoord(l),this._convertFromCellCoord(p+1),this._convertFromCellCoord(l+1)))&&n.call(this,t,e,i,r,c,a,s,o))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,e=3+this.cells.length+1+1;let i=0;for(let t=0;t<this.cells.length;t++)i+=this.cells[t].length;const r=new Int32Array(e+i+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;let n=e;for(let e=0;e<t.length;e++){const i=t[e];r[3+e]=n,r.set(i,n),n+=i.length}return r[3+t.length]=n,r.set(this.keys,n),n+=this.keys.length,r[3+t.length+1]=n,r.set(this.bboxes,n),n+=this.bboxes.length,r.buffer}static serialize(t,e){const i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}}static deserialize(t){return new vn(t.buffer)}}const yn={};function bn(t,e,i={}){if(yn[t])throw new Error(`${t} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),yn[t]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}bn("Object",Object),bn("TransferableGridIndex",vn),bn("Color",qt),bn("Error",Error),bn("AJAXError",j),bn("ResolvedImage",te),bn("StylePropertyFunction",kr),bn("StyleExpression",_r,{omit:["_evaluator"]}),bn("ZoomDependentExpression",xr),bn("ZoomConstantExpression",br),bn("CompoundExpression",Wi,{omit:["_evaluate"]});for(const t in qi)qi[t]._classRegistryKey||bn(`Expression_${t}`,qi[t]);function xn(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function wn(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error)return t;if(xn(t))return e&&e.push(t),t;if(E(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const i=t;return e&&e.push(i.buffer),i}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const i=[];for(const r of t)i.push(wn(r,e));return i}if("object"==typeof t){const i=t.constructor,r=i._classRegistryKey;if(!r)throw new Error(`can't serialize object of unregistered class ${i.name}`);if(!yn[r])throw new Error(`${r} is not registered.`);const n=i.serialize?i.serialize(t,e):{};if(i.serialize){if(e&&n===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const i in t){if(!t.hasOwnProperty(i))continue;if(yn[r].omit.indexOf(i)>=0)continue;const a=t[i];n[i]=yn[r].shallow.indexOf(i)>=0?a:wn(a,e)}t instanceof Error&&(n.message=t.message)}if(n.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(n.$name=r),n}throw new Error("can't serialize object of type "+typeof t)}function kn(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error||xn(t)||E(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(kn);if("object"==typeof t){const e=t.$name||"Object";if(!yn[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=yn[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(t);const r=Object.create(i.prototype);for(const i of Object.keys(t)){if("$name"===i)continue;const n=t[i];r[i]=yn[e].shallow.indexOf(i)>=0?n:kn(n)}return r}throw new Error("can't deserialize object of type "+typeof t)}class Tn{constructor(){this.first=!0}update(t,e){const i=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=i,!0))}}const Sn={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function Cn(t){for(const e of t)if(An(e.charCodeAt(0)))return!0;return!1}function En(t){for(const e of t)if(!$n(e.charCodeAt(0)))return!1;return!0}function $n(t){return!(Sn.Arabic(t)||Sn["Arabic Supplement"](t)||Sn["Arabic Extended-A"](t)||Sn["Arabic Presentation Forms-A"](t)||Sn["Arabic Presentation Forms-B"](t))}function An(t){return!(746!==t&&747!==t&&(t<4352||!(Sn["Bopomofo Extended"](t)||Sn.Bopomofo(t)||Sn["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Sn["CJK Compatibility Ideographs"](t)||Sn["CJK Compatibility"](t)||Sn["CJK Radicals Supplement"](t)||Sn["CJK Strokes"](t)||!(!Sn["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Sn["CJK Unified Ideographs Extension A"](t)||Sn["CJK Unified Ideographs"](t)||Sn["Enclosed CJK Letters and Months"](t)||Sn["Hangul Compatibility Jamo"](t)||Sn["Hangul Jamo Extended-A"](t)||Sn["Hangul Jamo Extended-B"](t)||Sn["Hangul Jamo"](t)||Sn["Hangul Syllables"](t)||Sn.Hiragana(t)||Sn["Ideographic Description Characters"](t)||Sn.Kanbun(t)||Sn["Kangxi Radicals"](t)||Sn["Katakana Phonetic Extensions"](t)||Sn.Katakana(t)&&12540!==t||!(!Sn["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Sn["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Sn["Unified Canadian Aboriginal Syllabics"](t)||Sn["Unified Canadian Aboriginal Syllabics Extended"](t)||Sn["Vertical Forms"](t)||Sn["Yijing Hexagram Symbols"](t)||Sn["Yi Syllables"](t)||Sn["Yi Radicals"](t))))}function In(t){return!(An(t)||function(t){return!!(Sn["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Sn["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Sn["Letterlike Symbols"](t)||Sn["Number Forms"](t)||Sn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Sn["Control Pictures"](t)&&9251!==t||Sn["Optical Character Recognition"](t)||Sn["Enclosed Alphanumerics"](t)||Sn["Geometric Shapes"](t)||Sn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Sn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Sn["CJK Symbols and Punctuation"](t)||Sn.Katakana(t)||Sn["Private Use Area"](t)||Sn["CJK Compatibility Forms"](t)||Sn["Small Form Variants"](t)||Sn["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Mn(t){return t>=1424&&t<=2303||Sn["Arabic Presentation Forms-A"](t)||Sn["Arabic Presentation Forms-B"](t)}function Ln(t,e){return!(!e&&Mn(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Sn.Khmer(t))}function Pn(t){for(const e of t)if(Mn(e.charCodeAt(0)))return!0;return!1}const Rn=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(t){this.pluginStatus=t.pluginStatus,this.pluginURL=t.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(t){this.applyArabicShaping=t.applyArabicShaping,this.processBidirectionalText=t.processBidirectionalText,this.processStyledBidirectionalText=t.processStyledBidirectionalText}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class zn{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Tn,this.transition={})}isSupportedScript(t){return function(t,e){for(const i of t)if(!Ln(i.charCodeAt(0),e))return!1;return!0}(t,"loaded"===Rn.getRTLTextPluginStatus())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),i=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*e}}}class Dn{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(cr(t))return new kr(t,e);if(vr(t)){const i=wr(t,e);if("error"===i.result)throw new Error(i.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return i.value}{let i=t;return"color"===e.type&&"string"==typeof t?i=qt.parse(t):"padding"!==e.type||"number"!=typeof t&&!Array.isArray(t)?"variableAnchorOffsetCollection"===e.type&&Array.isArray(t)&&(i=Qt.parse(t)):i=Kt.parse(t),{kind:"constant",evaluate:()=>i}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,i){return this.property.possiblyEvaluate(this,t,e,i)}}class jn{constructor(t){this.property=t,this.value=new Dn(t,void 0)}transitioned(t,e){return new Bn(this.property,this.value,e,_({},t.transition,this.transition),t.now)}untransitioned(){return new Bn(this.property,this.value,null,{},0)}}class On{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return x(this._values[t].value.value)}setValue(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new jn(this._values[t].property)),this._values[t].value=new Dn(this._values[t].property,null===e?void 0:x(e))}getTransition(t){return x(this._values[t].transition)}setTransition(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new jn(this._values[t].property)),this._values[t].transition=x(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const i=this.getValue(e);void 0!==i&&(t[e]=i);const r=this.getTransition(e);void 0!==r&&(t[`${e}-transition`]=r)}return t}transitioned(t,e){const i=new Fn(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].transitioned(t,e._values[r]);return i}untransitioned(){const t=new Fn(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class Bn{constructor(t,e,i,r,n){this.property=t,this.value=e,this.begin=n+r.delay||0,this.end=this.begin+r.duration||0,t.specification.transition&&(r.delay||r.duration)&&(this.prior=i)}possiblyEvaluate(t,e,i){const r=t.now||0,n=this.value.possiblyEvaluate(t,e,i),a=this.prior;if(a){if(r>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(r<this.begin)return a.possiblyEvaluate(t,e,i);{const s=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(t,e,i),n,function(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)}(s))}}return n}}class Fn{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,i){const r=new Vn(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].possiblyEvaluate(t,e,i);return r}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Nn{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return void 0!==this._values[t].value}getValue(t){return x(this._values[t].value)}setValue(t,e){this._values[t]=new Dn(this._values[t].property,null===e?void 0:x(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const i=this.getValue(e);void 0!==i&&(t[e]=i)}return t}possiblyEvaluate(t,e,i){const r=new Vn(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].possiblyEvaluate(t,e,i);return r}}class Hn{constructor(t,e,i){this.property=t,this.value=e,this.parameters=i}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,i,r){return this.property.evaluate(this.value,this.parameters,t,e,i,r)}}class Vn{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Un{constructor(t){this.specification=t}possiblyEvaluate(t,e){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(e)}interpolate(t,e,i){const r=Ae[this.specification.type];return r?r(t,e,i):t}}class Yn{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,i,r){return new Hn(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},i,r)}:t.expression,e)}interpolate(t,e,i){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Hn(this,{kind:"constant",value:void 0},t.parameters);const r=Ae[this.specification.type];if(r){const n=r(t.value.value,e.value.value,i);return new Hn(this,{kind:"constant",value:n},t.parameters)}return t}evaluate(t,e,i,r,n,a){return"constant"===t.kind?t.value:t.evaluate(e,i,r,n,a)}}class Zn extends Yn{possiblyEvaluate(t,e,i,r){if(void 0===t.value)return new Hn(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const n=t.expression.evaluate(e,null,{},i,r),a="resolvedImage"===t.property.specification.type&&"string"!=typeof n?n.name:n,s=this._calculate(a,a,a,e);return new Hn(this,{kind:"constant",value:s},e)}if("camera"===t.expression.kind){const i=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new Hn(this,{kind:"constant",value:i},e)}return new Hn(this,t.expression,e)}evaluate(t,e,i,r,n,a){if("source"===t.kind){const s=t.evaluate(e,i,r,n,a);return this._calculate(s,s,s,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},i,r),t.evaluate({zoom:Math.floor(e.zoom)},i,r),t.evaluate({zoom:Math.floor(e.zoom)+1},i,r),e):t.value}_calculate(t,e,i,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}}interpolate(t){return t}}class qn{constructor(t){this.specification=t}possiblyEvaluate(t,e,i,r){if(void 0!==t.value){if("constant"===t.expression.kind){const n=t.expression.evaluate(e,null,{},i,r);return this._calculate(n,n,n,e)}return this._calculate(t.expression.evaluate(new zn(Math.floor(e.zoom-1),e)),t.expression.evaluate(new zn(Math.floor(e.zoom),e)),t.expression.evaluate(new zn(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,i,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}}interpolate(t){return t}}class Wn{constructor(t){this.specification=t}possiblyEvaluate(t,e,i,r){return!!t.expression.evaluate(e,null,{},i,r)}interpolate(){return!1}}class Gn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const i=t[e];i.specification.overridable&&this.overridableProperties.push(e);const r=this.defaultPropertyValues[e]=new Dn(i,void 0),n=this.defaultTransitionablePropertyValues[e]=new jn(i);this.defaultTransitioningPropertyValues[e]=n.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=r.possiblyEvaluate({})}}}bn("DataDrivenProperty",Yn),bn("DataConstantProperty",Un),bn("CrossFadedDataDrivenProperty",Zn),bn("CrossFadedProperty",qn),bn("ColorRampProperty",Wn);const Xn="-transition";class Kn extends Y{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new Nn(e.layout)),e.paint)){this._transitionablePaint=new On(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Vn(e.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e,i={}){null!=e&&this._validate(gn,`layers.${this.id}.layout.${t}`,t,e,i)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return t.endsWith(Xn)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e,i={}){if(null!=e&&this._validate(fn,`layers.${this.id}.paint.${t}`,t,e,i))return!1;if(t.endsWith(Xn))return this._transitionablePaint.setTransition(t.slice(0,-11),e||void 0),!1;{const i=this._transitionablePaint._values[t],r="cross-faded-data-driven"===i.property.specification["property-type"],n=i.value.isDataDriven(),a=i.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const s=this._transitionablePaint._values[t].value;return s.isDataDriven()||n||r||this._handleOverridablePaintPropertyUpdate(t,a,s)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,e,i){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),b(t,((t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)))}_validate(t,e,i,r,n={}){return(!n||!1!==n.validate)&&_n(this,t.call(un,{key:e,layerType:this.type,objectKey:i,value:r,styleSpec:Z,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof Hn&&ar(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const Jn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Qn{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ta{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ea(t,e=1){let i=0,r=0;return{members:t.map((t=>{const n=Jn[t.type].BYTES_PER_ELEMENT,a=i=ia(i,Math.max(e,n)),s=t.components||1;return r=Math.max(r,n),i+=n*s,{name:t.name,type:t.type,components:s,offset:a}})),size:ia(i,Math.max(r,e)),alignment:e}}function ia(t,e){return Math.ceil(t/e)*e}class ra extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const r=2*t;return this.int16[r+0]=e,this.int16[r+1]=i,t}}ra.prototype.bytesPerElement=4,bn("StructArrayLayout2i4",ra);class na extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=3*t;return this.int16[n+0]=e,this.int16[n+1]=i,this.int16[n+2]=r,t}}na.prototype.bytesPerElement=6,bn("StructArrayLayout3i6",na);class aa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i,r)}emplace(t,e,i,r,n){const a=4*t;return this.int16[a+0]=e,this.int16[a+1]=i,this.int16[a+2]=r,this.int16[a+3]=n,t}}aa.prototype.bytesPerElement=8,bn("StructArrayLayout4i8",aa);class sa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,i,r,n,a)}emplace(t,e,i,r,n,a,s){const o=6*t;return this.int16[o+0]=e,this.int16[o+1]=i,this.int16[o+2]=r,this.int16[o+3]=n,this.int16[o+4]=a,this.int16[o+5]=s,t}}sa.prototype.bytesPerElement=12,bn("StructArrayLayout2i4i12",sa);class oa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,i,r,n,a)}emplace(t,e,i,r,n,a,s){const o=4*t,l=8*t;return this.int16[o+0]=e,this.int16[o+1]=i,this.uint8[l+4]=r,this.uint8[l+5]=n,this.uint8[l+6]=a,this.uint8[l+7]=s,t}}oa.prototype.bytesPerElement=8,bn("StructArrayLayout2i4ub8",oa);class la extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const r=2*t;return this.float32[r+0]=e,this.float32[r+1]=i,t}}la.prototype.bytesPerElement=8,bn("StructArrayLayout2f8",la);class ca extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,s,o,l,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,i,r,n,a,s,o,l,c)}emplace(t,e,i,r,n,a,s,o,l,c,d){const h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=i,this.uint16[h+2]=r,this.uint16[h+3]=n,this.uint16[h+4]=a,this.uint16[h+5]=s,this.uint16[h+6]=o,this.uint16[h+7]=l,this.uint16[h+8]=c,this.uint16[h+9]=d,t}}ca.prototype.bytesPerElement=20,bn("StructArrayLayout10ui20",ca);class da extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,s,o,l,c,d,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,e,i,r,n,a,s,o,l,c,d,h)}emplace(t,e,i,r,n,a,s,o,l,c,d,h,p){const u=12*t;return this.int16[u+0]=e,this.int16[u+1]=i,this.int16[u+2]=r,this.int16[u+3]=n,this.uint16[u+4]=a,this.uint16[u+5]=s,this.uint16[u+6]=o,this.uint16[u+7]=l,this.int16[u+8]=c,this.int16[u+9]=d,this.int16[u+10]=h,this.int16[u+11]=p,t}}da.prototype.bytesPerElement=24,bn("StructArrayLayout4i4ui4i24",da);class ha extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=3*t;return this.float32[n+0]=e,this.float32[n+1]=i,this.float32[n+2]=r,t}}ha.prototype.bytesPerElement=12,bn("StructArrayLayout3f12",ha);class pa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}pa.prototype.bytesPerElement=4,bn("StructArrayLayout1ul4",pa);class ua extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,s,o,l){const c=this.length;return this.resize(c+1),this.emplace(c,t,e,i,r,n,a,s,o,l)}emplace(t,e,i,r,n,a,s,o,l,c){const d=10*t,h=5*t;return this.int16[d+0]=e,this.int16[d+1]=i,this.int16[d+2]=r,this.int16[d+3]=n,this.int16[d+4]=a,this.int16[d+5]=s,this.uint32[h+3]=o,this.uint16[d+8]=l,this.uint16[d+9]=c,t}}ua.prototype.bytesPerElement=20,bn("StructArrayLayout6i1ul2ui20",ua);class ma extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,i,r,n,a)}emplace(t,e,i,r,n,a,s){const o=6*t;return this.int16[o+0]=e,this.int16[o+1]=i,this.int16[o+2]=r,this.int16[o+3]=n,this.int16[o+4]=a,this.int16[o+5]=s,t}}ma.prototype.bytesPerElement=12,bn("StructArrayLayout2i2i2i12",ma);class fa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,i,r,n)}emplace(t,e,i,r,n,a){const s=4*t,o=8*t;return this.float32[s+0]=e,this.float32[s+1]=i,this.float32[s+2]=r,this.int16[o+6]=n,this.int16[o+7]=a,t}}fa.prototype.bytesPerElement=16,bn("StructArrayLayout2f1f2i16",fa);class ga extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,i,r,n,a)}emplace(t,e,i,r,n,a,s){const o=16*t,l=4*t,c=8*t;return this.uint8[o+0]=e,this.uint8[o+1]=i,this.float32[l+1]=r,this.float32[l+2]=n,this.int16[c+6]=a,this.int16[c+7]=s,t}}ga.prototype.bytesPerElement=16,bn("StructArrayLayout2ub2f2i16",ga);class _a extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=3*t;return this.uint16[n+0]=e,this.uint16[n+1]=i,this.uint16[n+2]=r,t}}_a.prototype.bytesPerElement=6,bn("StructArrayLayout3ui6",_a);class va extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,s,o,l,c,d,h,p,u,m,f,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,e,i,r,n,a,s,o,l,c,d,h,p,u,m,f,g)}emplace(t,e,i,r,n,a,s,o,l,c,d,h,p,u,m,f,g,_){const v=24*t,y=12*t,b=48*t;return this.int16[v+0]=e,this.int16[v+1]=i,this.uint16[v+2]=r,this.uint16[v+3]=n,this.uint32[y+2]=a,this.uint32[y+3]=s,this.uint32[y+4]=o,this.uint16[v+10]=l,this.uint16[v+11]=c,this.uint16[v+12]=d,this.float32[y+7]=h,this.float32[y+8]=p,this.uint8[b+36]=u,this.uint8[b+37]=m,this.uint8[b+38]=f,this.uint32[y+10]=g,this.int16[v+22]=_,t}}va.prototype.bytesPerElement=48,bn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",va);class ya extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,s,o,l,c,d,h,p,u,m,f,g,_,v,y,b,x,w,k,T,S,C,E){const $=this.length;return this.resize($+1),this.emplace($,t,e,i,r,n,a,s,o,l,c,d,h,p,u,m,f,g,_,v,y,b,x,w,k,T,S,C,E)}emplace(t,e,i,r,n,a,s,o,l,c,d,h,p,u,m,f,g,_,v,y,b,x,w,k,T,S,C,E,$){const A=32*t,I=16*t;return this.int16[A+0]=e,this.int16[A+1]=i,this.int16[A+2]=r,this.int16[A+3]=n,this.int16[A+4]=a,this.int16[A+5]=s,this.int16[A+6]=o,this.int16[A+7]=l,this.uint16[A+8]=c,this.uint16[A+9]=d,this.uint16[A+10]=h,this.uint16[A+11]=p,this.uint16[A+12]=u,this.uint16[A+13]=m,this.uint16[A+14]=f,this.uint16[A+15]=g,this.uint16[A+16]=_,this.uint16[A+17]=v,this.uint16[A+18]=y,this.uint16[A+19]=b,this.uint16[A+20]=x,this.uint16[A+21]=w,this.uint16[A+22]=k,this.uint32[I+12]=T,this.float32[I+13]=S,this.float32[I+14]=C,this.uint16[A+30]=E,this.uint16[A+31]=$,t}}ya.prototype.bytesPerElement=64,bn("StructArrayLayout8i15ui1ul2f2ui64",ya);class ba extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}ba.prototype.bytesPerElement=4,bn("StructArrayLayout1f4",ba);class xa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=3*t;return this.uint16[6*t+0]=e,this.float32[n+1]=i,this.float32[n+2]=r,t}}xa.prototype.bytesPerElement=12,bn("StructArrayLayout1ui2f12",xa);class wa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=4*t;return this.uint32[2*t+0]=e,this.uint16[n+2]=i,this.uint16[n+3]=r,t}}wa.prototype.bytesPerElement=8,bn("StructArrayLayout1ul2ui8",wa);class ka extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=i,t}}ka.prototype.bytesPerElement=4,bn("StructArrayLayout2ui4",ka);class Ta extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}Ta.prototype.bytesPerElement=2,bn("StructArrayLayout1ui2",Ta);class Sa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i,r)}emplace(t,e,i,r,n){const a=4*t;return this.float32[a+0]=e,this.float32[a+1]=i,this.float32[a+2]=r,this.float32[a+3]=n,t}}Sa.prototype.bytesPerElement=16,bn("StructArrayLayout4f16",Sa);class Ca extends Qn{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new a(this.anchorPointX,this.anchorPointY)}}Ca.prototype.size=20;class Ea extends ua{get(t){return new Ca(this,t)}}bn("CollisionBoxArray",Ea);class $a extends Qn{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}$a.prototype.size=48;class Aa extends va{get(t){return new $a(this,t)}}bn("PlacedSymbolArray",Aa);class Ia extends Qn{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ia.prototype.size=64;class Ma extends ya{get(t){return new Ia(this,t)}}bn("SymbolInstanceArray",Ma);class La extends ba{getoffsetX(t){return this.float32[1*t+0]}}bn("GlyphOffsetArray",La);class Pa extends na{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}bn("SymbolLineVertexArray",Pa);class Ra extends Qn{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ra.prototype.size=12;class za extends xa{get(t){return new Ra(this,t)}}bn("TextAnchorOffsetArray",za);class Da extends Qn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Da.prototype.size=8;class ja extends wa{get(t){return new Da(this,t)}}bn("FeatureIndexArray",ja);class Oa extends ra{}class Ba extends ra{}class Fa extends ra{}class Na extends sa{}class Ha extends oa{}class Va extends la{}class Ua extends ca{}class Ya extends da{}class Za extends ha{}class qa extends pa{}class Wa extends ma{}class Ga extends ga{}class Xa extends _a{}class Ka extends ka{}const Ja=ea([{name:"a_pos",components:2,type:"Int16"}],4),{members:Qa}=Ja;class ts{constructor(t=[]){this.segments=t}prepareSegment(t,e,i,r){let n=this.segments[this.segments.length-1];return t>ts.MAX_VERTEX_ARRAY_LENGTH&&k(`Max vertices per segment is ${ts.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!n||n.vertexLength+t>ts.MAX_VERTEX_ARRAY_LENGTH||n.sortKey!==r)&&(n={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==r&&(n.sortKey=r),this.segments.push(n)),n}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,i,r){return new ts([{vertexOffset:t,primitiveOffset:e,vertexLength:i,primitiveLength:r,vaos:{},sortKey:0}])}}function es(t,e){return 256*(t=f(Math.floor(t),0,255))+f(Math.floor(e),0,255)}ts.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,bn("SegmentVector",ts);const is=ea([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var rs={exports:{}},ns={exports:{}};ns.exports=function(t,e){var i,r,n,a,s,o,l,c;for(r=t.length-(i=3&t.length),n=e,s=3432918353,o=461845907,c=0;c<r;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,n=27492+(65535&(a=5*(65535&(n=(n^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<13|n>>>19))+((5*(n>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,i){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:n^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295}return n^=t.length,n=2246822507*(65535&(n^=n>>>16))+((2246822507*(n>>>16)&65535)<<16)&4294967295,n=3266489909*(65535&(n^=n>>>13))+((3266489909*(n>>>16)&65535)<<16)&4294967295,(n^=n>>>16)>>>0};var as=ns.exports,ss={exports:{}};ss.exports=function(t,e){for(var i,r=t.length,n=e^r,a=0;r>=4;)i=1540483477*(65535&(i=255&t.charCodeAt(a)|(255&t.charCodeAt(++a))<<8|(255&t.charCodeAt(++a))<<16|(255&t.charCodeAt(++a))<<24))+((1540483477*(i>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),r-=4,++a;switch(r){case 3:n^=(255&t.charCodeAt(a+2))<<16;case 2:n^=(255&t.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(a)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),(n^=n>>>15)>>>0};var os=as,ls=ss.exports;rs.exports=os,rs.exports.murmur3=os,rs.exports.murmur2=ls;var cs=i(rs.exports);class ds{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,i,r){this.ids.push(hs(t)),this.positions.push(e,i,r)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const e=hs(t);let i=0,r=this.ids.length-1;for(;i<r;){const t=i+r>>1;this.ids[t]>=e?r=t:i=t+1}const n=[];for(;this.ids[i]===e;)n.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return n}static serialize(t,e){const i=new Float64Array(t.ids),r=new Uint32Array(t.positions);return ps(i,r,0,i.length-1),e&&e.push(i.buffer,r.buffer),{ids:i,positions:r}}static deserialize(t){const e=new ds;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function hs(t){const e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:cs(String(t))}function ps(t,e,i,r){for(;i<r;){const n=t[i+r>>1];let a=i-1,s=r+1;for(;;){do{a++}while(t[a]<n);do{s--}while(t[s]>n);if(a>=s)break;us(t,a,s),us(e,3*a,3*s),us(e,3*a+1,3*s+1),us(e,3*a+2,3*s+2)}s-i<r-s?(ps(t,e,i,s),i=s+1):(ps(t,e,s+1,r),r=s)}}function us(t,e,i){const r=t[e];t[e]=t[i],t[i]=r}bn("FeaturePositionMap",ds);class ms{constructor(t,e){this.gl=t.gl,this.location=e}}class fs extends ms{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class gs extends ms{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class _s extends ms{constructor(t,e){super(t,e),this.current=qt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const vs=new Float32Array(16);function ys(t){return[es(255*t.r,255*t.g),es(255*t.b,255*t.a)]}class bs{constructor(t,e,i){this.value=t,this.uniformNames=e.map((t=>`u_${t}`)),this.type=i}setUniform(t,e,i){t.set(i.constantOr(this.value))}getBinding(t,e,i){return"color"===this.type?new _s(t,e):new fs(t,e)}}class xs{constructor(t,e){this.uniformNames=e.map((t=>`u_${t}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr}setUniform(t,e,i,r){const n="u_pattern_to"===r?this.patternTo:"u_pattern_from"===r?this.patternFrom:"u_pixel_ratio_to"===r?this.pixelRatioTo:"u_pixel_ratio_from"===r?this.pixelRatioFrom:null;n&&t.set(n)}getBinding(t,e,i){return"u_pattern"===i.substr(0,9)?new gs(t,e):new fs(t,e)}}class ws{constructor(t,e,i,r){this.expression=t,this.type=i,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===i?2:1,offset:0}))),this.paintVertexArray=new r}populatePaintArray(t,e,i,r,n){const a=this.paintVertexArray.length,s=this.expression.evaluate(new zn(0),e,{},r,[],n);this.paintVertexArray.resize(t),this._setPaintValue(a,t,s)}updatePaintArray(t,e,i,r){const n=this.expression.evaluate({zoom:0},i,r);this._setPaintValue(t,e,n)}_setPaintValue(t,e,i){if("color"===this.type){const r=ys(i);for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,r[0],r[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ks{constructor(t,e,i,r,n,a){this.expression=t,this.uniformNames=e.map((t=>`u_${t}_t`)),this.type=i,this.useIntegerZoom=r,this.zoom=n,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===i?4:2,offset:0}))),this.paintVertexArray=new a}populatePaintArray(t,e,i,r,n){const a=this.expression.evaluate(new zn(this.zoom),e,{},r,[],n),s=this.expression.evaluate(new zn(this.zoom+1),e,{},r,[],n),o=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(o,t,a,s)}updatePaintArray(t,e,i,r){const n=this.expression.evaluate({zoom:this.zoom},i,r),a=this.expression.evaluate({zoom:this.zoom+1},i,r);this._setPaintValue(t,e,n,a)}_setPaintValue(t,e,i,r){if("color"===this.type){const n=ys(i),a=ys(r);for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n[0],n[1],a[0],a[1])}else{for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i,r);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(r))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){const i=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,r=f(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);t.set(r)}getBinding(t,e,i){return new fs(t,e)}}class Ts{constructor(t,e,i,r,n,a){this.expression=t,this.type=e,this.useIntegerZoom=i,this.zoom=r,this.layerId=a,this.zoomInPaintVertexArray=new n,this.zoomOutPaintVertexArray=new n}populatePaintArray(t,e,i){const r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(r,t,e.patterns&&e.patterns[this.layerId],i)}updatePaintArray(t,e,i,r,n){this._setPaintValues(t,e,i.patterns&&i.patterns[this.layerId],n)}_setPaintValues(t,e,i,r){if(!r||!i)return;const{min:n,mid:a,max:s}=i,o=r[n],l=r[a],c=r[s];if(o&&l&&c)for(let i=t;i<e;i++)this.zoomInPaintVertexArray.emplace(i,l.tl[0],l.tl[1],l.br[0],l.br[1],o.tl[0],o.tl[1],o.br[0],o.br[1],l.pixelRatio,o.pixelRatio),this.zoomOutPaintVertexArray.emplace(i,l.tl[0],l.tl[1],l.br[0],l.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],l.pixelRatio,c.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,is.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,is.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ss{constructor(t,e,i){this.binders={},this._buffers=[];const r=[];for(const n in t.paint._values){if(!i(n))continue;const a=t.paint.get(n);if(!(a instanceof Hn&&ar(a.property.specification)))continue;const s=Es(n,t.type),o=a.value,l=a.property.specification.type,c=a.property.useIntegerZoom,d=a.property.specification["property-type"],h="cross-faded"===d||"cross-faded-data-driven"===d;if("constant"===o.kind)this.binders[n]=h?new xs(o.value,s):new bs(o.value,s,l),r.push(`/u_${n}`);else if("source"===o.kind||h){const i=$s(n,l,"source");this.binders[n]=h?new Ts(o,l,c,e,i,t.id):new ws(o,s,l,i),r.push(`/a_${n}`)}else{const t=$s(n,l,"composite");this.binders[n]=new ks(o,s,l,c,e,t),r.push(`/z_${n}`)}}this.cacheKey=r.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof ws||e instanceof ks?e.maxValue:0}populatePaintArrays(t,e,i,r,n){for(const a in this.binders){const s=this.binders[a];(s instanceof ws||s instanceof ks||s instanceof Ts)&&s.populatePaintArray(t,e,i,r,n)}}setConstantPatternPositions(t,e){for(const i in this.binders){const r=this.binders[i];r instanceof xs&&r.setConstantPatternPositions(t,e)}}updatePaintArrays(t,e,i,r,n){let a=!1;for(const s in t){const o=e.getPositions(s);for(const e of o){const o=i.feature(e.index);for(const i in this.binders){const l=this.binders[i];if((l instanceof ws||l instanceof ks||l instanceof Ts)&&!0===l.expression.isStateDependent){const c=r.paint.get(i);l.expression=c.value,l.updatePaintArray(e.start,e.end,o,t[s],n),a=!0}}}}return a}defines(){const t=[];for(const e in this.binders){const i=this.binders[e];(i instanceof bs||i instanceof xs)&&t.push(...i.uniformNames.map((t=>`#define HAS_UNIFORM_${t}`)))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const i=this.binders[e];if(i instanceof ws||i instanceof ks)for(let e=0;e<i.paintVertexAttributes.length;e++)t.push(i.paintVertexAttributes[e].name);else if(i instanceof Ts)for(let e=0;e<is.members.length;e++)t.push(is.members[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const i=this.binders[e];if(i instanceof bs||i instanceof xs||i instanceof ks)for(const e of i.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const i=[];for(const r in this.binders){const n=this.binders[r];if(n instanceof bs||n instanceof xs||n instanceof ks)for(const a of n.uniformNames)if(e[a]){const s=n.getBinding(t,e[a],a);i.push({name:a,property:r,binding:s})}}return i}setUniforms(t,e,i,r){for(const{name:t,property:n,binding:a}of e)this.binders[n].setUniform(a,r,i.get(n),t)}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const i=this.binders[e];if(t&&i instanceof Ts){const e=2===t.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;e&&this._buffers.push(e)}else(i instanceof ws||i instanceof ks)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const e in this.binders){const i=this.binders[e];(i instanceof ws||i instanceof ks||i instanceof Ts)&&i.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof ws||e instanceof ks||e instanceof Ts)&&e.destroy()}}}class Cs{constructor(t,e,i=(()=>!0)){this.programConfigurations={};for(const r of t)this.programConfigurations[r.id]=new Ss(r,e,i);this.needsUpload=!1,this._featureMap=new ds,this._bufferOffset=0}populatePaintArrays(t,e,i,r,n,a){for(const i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(t,e,r,n,a);void 0!==e.id&&this._featureMap.add(e.id,i,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,i,r){for(const n of i)this.needsUpload=this.programConfigurations[n.id].updatePaintArrays(t,this._featureMap,e,n,r)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Es(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}function $s(t,e,i){const r={color:{source:la,composite:Sa},number:{source:ba,composite:la}},n=function(t){return{"line-pattern":{source:Ua,composite:Ua},"fill-pattern":{source:Ua,composite:Ua},"fill-extrusion-pattern":{source:Ua,composite:Ua}}[t]}(t);return n&&n[i]||r[e][i]}bn("ConstantBinder",bs),bn("CrossFadedConstantBinder",xs),bn("SourceExpressionBinder",ws),bn("CrossFadedCompositeBinder",Ts),bn("CompositeExpressionBinder",ks),bn("ProgramConfiguration",Ss,{omit:["_buffers"]}),bn("ProgramConfigurationSet",Cs);const As=8192,Is=Math.pow(2,14)-1,Ms=-Is-1;function Ls(t){const e=As/t.extent,i=t.loadGeometry();for(let t=0;t<i.length;t++){const r=i[t];for(let t=0;t<r.length;t++){const i=r[t],n=Math.round(i.x*e),a=Math.round(i.y*e);i.x=f(n,Ms,Is),i.y=f(a,Ms,Is),(n<i.x||n>i.x+1||a<i.y||a>i.y+1)&&k("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function Ps(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Ls(t):[]}}function Rs(t,e,i,r,n){t.emplaceBack(2*e+(r+1)/2,2*i+(n+1)/2)}class zs{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ba,this.indexArray=new Xa,this.segments=new ts,this.programConfigurations=new Cs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){const r=this.layers[0],n=[];let a=null,s=!1;"circle"===r.type&&(a=r.layout.get("circle-sort-key"),s=!a.isConstant());for(const{feature:e,id:r,index:o,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=Ps(e,t);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),c,i))continue;const d=s?a.evaluate(c,{},i):void 0,h={id:r,properties:e.properties,type:e.type,sourceLayerIndex:l,index:o,geometry:t?c.geometry:Ls(e),patterns:{},sortKey:d};n.push(h)}s&&n.sort(((t,e)=>t.sortKey-e.sortKey));for(const r of n){const{geometry:n,index:a,sourceLayerIndex:s}=r,o=t[a].feature;this.addFeature(r,n,a,i),e.featureIndex.insert(o,n,a,s,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Qa),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,i,r){for(const i of e)for(const e of i){const i=e.x,r=e.y;if(i<0||i>=As||r<0||r>=As)continue;const n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),a=n.vertexLength;Rs(this.layoutVertexArray,i,r,-1,-1),Rs(this.layoutVertexArray,i,r,1,-1),Rs(this.layoutVertexArray,i,r,1,1),Rs(this.layoutVertexArray,i,r,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+3,a+2),n.vertexLength+=4,n.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,{},r)}}function Ds(t,e){for(let i=0;i<t.length;i++)if(Ys(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(Ys(t,e[i]))return!0;return!!Fs(t,e)}function js(t,e,i){return!!Ys(t,e)||!!Hs(e,t,i)}function Os(t,e){if(1===t.length)return Us(e,t[0]);for(let i=0;i<e.length;i++){const r=e[i];for(let e=0;e<r.length;e++)if(Ys(t,r[e]))return!0}for(let i=0;i<t.length;i++)if(Us(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(Fs(t,e[i]))return!0;return!1}function Bs(t,e,i){if(t.length>1){if(Fs(t,e))return!0;for(let r=0;r<e.length;r++)if(Hs(e[r],t,i))return!0}for(let r=0;r<t.length;r++)if(Hs(t[r],e,i))return!0;return!1}function Fs(t,e){if(0===t.length||0===e.length)return!1;for(let i=0;i<t.length-1;i++){const r=t[i],n=t[i+1];for(let t=0;t<e.length-1;t++)if(Ns(r,n,e[t],e[t+1]))return!0}return!1}function Ns(t,e,i,r){return T(t,i,r)!==T(e,i,r)&&T(t,e,i)!==T(t,e,r)}function Hs(t,e,i){const r=i*i;if(1===e.length)return t.distSqr(e[0])<r;for(let i=1;i<e.length;i++)if(Vs(t,e[i-1],e[i])<r)return!0;return!1}function Vs(t,e,i){const r=e.distSqr(i);if(0===r)return t.distSqr(e);const n=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/r;return t.distSqr(n<0?e:n>1?i:i.sub(e)._mult(n)._add(e))}function Us(t,e){let i,r,n,a=!1;for(let s=0;s<t.length;s++){i=t[s];for(let t=0,s=i.length-1;t<i.length;s=t++)r=i[t],n=i[s],r.y>e.y!=n.y>e.y&&e.x<(n.x-r.x)*(e.y-r.y)/(n.y-r.y)+r.x&&(a=!a)}return a}function Ys(t,e){let i=!1;for(let r=0,n=t.length-1;r<t.length;n=r++){const a=t[r],s=t[n];a.y>e.y!=s.y>e.y&&e.x<(s.x-a.x)*(e.y-a.y)/(s.y-a.y)+a.x&&(i=!i)}return i}function Zs(t,e,i){const r=i[0],n=i[2];if(t.x<r.x&&e.x<r.x||t.x>n.x&&e.x>n.x||t.y<r.y&&e.y<r.y||t.y>n.y&&e.y>n.y)return!1;const a=T(t,e,i[0]);return a!==T(t,e,i[1])||a!==T(t,e,i[2])||a!==T(t,e,i[3])}function qs(t,e,i){const r=e.paint.get(t).value;return"constant"===r.kind?r.value:i.programConfigurations.get(e.id).getMaxValue(t)}function Ws(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Gs(t,e,i,r,n){if(!e[0]&&!e[1])return t;const s=a.convert(e)._mult(n);"viewport"===i&&s._rotate(-r);const o=[];for(let e=0;e<t.length;e++)o.push(t[e].sub(s));return o}let Xs,Ks;bn("CircleBucket",zs,{omit:["layers"]});var Js={get paint(){return Ks=Ks||new Gn({"circle-radius":new Yn(Z.paint_circle["circle-radius"]),"circle-color":new Yn(Z.paint_circle["circle-color"]),"circle-blur":new Yn(Z.paint_circle["circle-blur"]),"circle-opacity":new Yn(Z.paint_circle["circle-opacity"]),"circle-translate":new Un(Z.paint_circle["circle-translate"]),"circle-translate-anchor":new Un(Z.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Un(Z.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Un(Z.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Yn(Z.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Yn(Z.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Yn(Z.paint_circle["circle-stroke-opacity"])})},get layout(){return Xs=Xs||new Gn({"circle-sort-key":new Yn(Z.layout_circle["circle-sort-key"])})}},Qs=1e-6,to="undefined"!=typeof Float32Array?Float32Array:Array;function eo(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function io(t,e,i){var r=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],c=e[6],d=e[7],h=e[8],p=e[9],u=e[10],m=e[11],f=e[12],g=e[13],_=e[14],v=e[15],y=i[0],b=i[1],x=i[2],w=i[3];return t[0]=y*r+b*o+x*h+w*f,t[1]=y*n+b*l+x*p+w*g,t[2]=y*a+b*c+x*u+w*_,t[3]=y*s+b*d+x*m+w*v,t[4]=(y=i[4])*r+(b=i[5])*o+(x=i[6])*h+(w=i[7])*f,t[5]=y*n+b*l+x*p+w*g,t[6]=y*a+b*c+x*u+w*_,t[7]=y*s+b*d+x*m+w*v,t[8]=(y=i[8])*r+(b=i[9])*o+(x=i[10])*h+(w=i[11])*f,t[9]=y*n+b*l+x*p+w*g,t[10]=y*a+b*c+x*u+w*_,t[11]=y*s+b*d+x*m+w*v,t[12]=(y=i[12])*r+(b=i[13])*o+(x=i[14])*h+(w=i[15])*f,t[13]=y*n+b*l+x*p+w*g,t[14]=y*a+b*c+x*u+w*_,t[15]=y*s+b*d+x*m+w*v,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ro,no=io;function ao(t,e,i){var r=e[0],n=e[1],a=e[2],s=e[3];return t[0]=i[0]*r+i[4]*n+i[8]*a+i[12]*s,t[1]=i[1]*r+i[5]*n+i[9]*a+i[13]*s,t[2]=i[2]*r+i[6]*n+i[10]*a+i[14]*s,t[3]=i[3]*r+i[7]*n+i[11]*a+i[15]*s,t}ro=new to(4),to!=Float32Array&&(ro[0]=0,ro[1]=0,ro[2]=0,ro[3]=0);class so extends Kn{constructor(t){super(t,Js)}createBucket(t){return new zs(t)}queryRadius(t){const e=t;return qs("circle-radius",this,e)+qs("circle-stroke-width",this,e)+Ws(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,i,r,n,a,s,o){const l=Gs(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,s),c=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i),d="map"===this.paint.get("circle-pitch-alignment"),h=d?l:function(t,e){return t.map((t=>oo(t,e)))}(l,o),p=d?c*s:c;for(const t of r)for(const e of t){const t=d?e:oo(e,o);let i=p;const r=ao([],[e.x,e.y,0,1],o);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?i*=r[3]/a.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(i*=a.cameraToCenterDistance/r[3]),js(h,t,i))return!0}return!1}}function oo(t,e){const i=ao([],[t.x,t.y,0,1],e);return new a(i[0]/i[3],i[1]/i[3])}class lo extends zs{}let co;bn("HeatmapBucket",lo,{omit:["layers"]});var ho={get paint(){return co=co||new Gn({"heatmap-radius":new Yn(Z.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Yn(Z.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Un(Z.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Wn(Z.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Un(Z.paint_heatmap["heatmap-opacity"])})}};function po(t,{width:e,height:i},r,n){if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==e*i*r)throw new RangeError(`mismatched image size. expected: ${n.length} but got: ${e*i*r}`)}else n=new Uint8Array(e*i*r);return t.width=e,t.height=i,t.data=n,t}function uo(t,{width:e,height:i},r){if(e===t.width&&i===t.height)return;const n=po({},{width:e,height:i},r);mo(t,n,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,i)},r),t.width=e,t.height=i,t.data=n.data}function mo(t,e,i,r,n,a){if(0===n.width||0===n.height)return e;if(n.width>t.width||n.height>t.height||i.x>t.width-n.width||i.y>t.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>e.width||n.height>e.height||r.x>e.width-n.width||r.y>e.height-n.height)throw new RangeError("out of range destination coordinates for image copy");const s=t.data,o=e.data;if(s===o)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<n.height;l++){const c=((i.y+l)*t.width+i.x)*a,d=((r.y+l)*e.width+r.x)*a;for(let t=0;t<n.width*a;t++)o[d+t]=s[c+t]}return e}class fo{constructor(t,e){po(this,t,1,e)}resize(t){uo(this,t,1)}clone(){return new fo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,i,r,n){mo(t,e,i,r,n,1)}}class go{constructor(t,e){po(this,t,4,e)}resize(t){uo(this,t,4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new go({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,i,r,n){mo(t,e,i,r,n,4)}}function _o(t){const e={},i=t.resolution||256,r=t.clips?t.clips.length:1,n=t.image||new go({width:i,height:r});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const a=(i,r,a)=>{e[t.evaluationKey]=a;const s=t.expression.evaluate(e);n.data[i+r+0]=Math.floor(255*s.r/s.a),n.data[i+r+1]=Math.floor(255*s.g/s.a),n.data[i+r+2]=Math.floor(255*s.b/s.a),n.data[i+r+3]=Math.floor(255*s.a)};if(t.clips)for(let e=0,n=0;e<r;++e,n+=4*i)for(let r=0,s=0;r<i;r++,s+=4){const o=r/(i-1),{start:l,end:c}=t.clips[e];a(n,s,l*(1-o)+c*o)}else for(let t=0,e=0;t<i;t++,e+=4)a(0,e,t/(i-1));return n}bn("AlphaImage",fo),bn("RGBAImage",go);class vo extends Kn{createBucket(t){return new lo(t)}constructor(t){super(t,ho),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_o({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let yo;var bo={get paint(){return yo=yo||new Gn({"hillshade-illumination-direction":new Un(Z.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Un(Z.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Un(Z.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Un(Z.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Un(Z.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Un(Z.paint_hillshade["hillshade-accent-color"])})}};class xo extends Kn{constructor(t){super(t,bo)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const wo=ea([{name:"a_pos",components:2,type:"Int16"}],4),{members:ko}=wo;var To={exports:{}};function So(t,e,i){i=i||2;var r,n,a,s,o,l,c,d=e&&e.length,h=d?e[0]*i:t.length,p=Co(t,0,h,i,!0),u=[];if(!p||p.next===p.prev)return u;if(d&&(p=function(t,e,i,r){var n,a,s,o=[];for(n=0,a=e.length;n<a;n++)(s=Co(t,e[n]*r,n<a-1?e[n+1]*r:t.length,r,!1))===s.next&&(s.steiner=!0),o.push(jo(s));for(o.sort(Po),n=0;n<o.length;n++)i=Ro(o[n],i);return i}(t,e,p,i)),t.length>80*i){r=a=t[0],n=s=t[1];for(var m=i;m<h;m+=i)(o=t[m])<r&&(r=o),(l=t[m+1])<n&&(n=l),o>a&&(a=o),l>s&&(s=l);c=0!==(c=Math.max(a-r,s-n))?32767/c:0}return $o(p,u,i,r,n,c,0),u}function Co(t,e,i,r,n){var a,s;if(n===Xo(t,e,i,r)>0)for(a=e;a<i;a+=r)s=qo(a,t[a],t[a+1],s);else for(a=i-r;a>=e;a-=r)s=qo(a,t[a],t[a+1],s);return s&&No(s,s.next)&&(Wo(s),s=s.next),s}function Eo(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!No(r,r.next)&&0!==Fo(r.prev,r,r.next))r=r.next;else{if(Wo(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function $o(t,e,i,r,n,a,s){if(t){!s&&a&&function(t,e,i,r){var n=t;do{0===n.z&&(n.z=Do(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,a,s,o,l,c=1;do{for(i=t,t=null,a=null,s=0;i;){for(s++,r=i,o=0,e=0;e<c&&(o++,r=r.nextZ);e++);for(l=c;o>0||l>0&&r;)0!==o&&(0===l||!r||i.z<=r.z)?(n=i,i=i.nextZ,o--):(n=r,r=r.nextZ,l--),a?a.nextZ=n:t=n,n.prevZ=a,a=n;i=r}a.nextZ=null,c*=2}while(s>1)}(n)}(t,r,n,a);for(var o,l,c=t;t.prev!==t.next;)if(o=t.prev,l=t.next,a?Io(t,r,n,a):Ao(t))e.push(o.i/i|0),e.push(t.i/i|0),e.push(l.i/i|0),Wo(t),t=l.next,c=l.next;else if((t=l)===c){s?1===s?$o(t=Mo(Eo(t),e,i),e,i,r,n,a,2):2===s&&Lo(t,e,i,r,n,a):$o(Eo(t),e,i,r,n,a,1);break}}}function Ao(t){var e=t.prev,i=t,r=t.next;if(Fo(e,i,r)>=0)return!1;for(var n=e.x,a=i.x,s=r.x,o=e.y,l=i.y,c=r.y,d=n<a?n<s?n:s:a<s?a:s,h=o<l?o<c?o:c:l<c?l:c,p=n>a?n>s?n:s:a>s?a:s,u=o>l?o>c?o:c:l>c?l:c,m=r.next;m!==e;){if(m.x>=d&&m.x<=p&&m.y>=h&&m.y<=u&&Oo(n,o,a,l,s,c,m.x,m.y)&&Fo(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Io(t,e,i,r){var n=t.prev,a=t,s=t.next;if(Fo(n,a,s)>=0)return!1;for(var o=n.x,l=a.x,c=s.x,d=n.y,h=a.y,p=s.y,u=o<l?o<c?o:c:l<c?l:c,m=d<h?d<p?d:p:h<p?h:p,f=o>l?o>c?o:c:l>c?l:c,g=d>h?d>p?d:p:h>p?h:p,_=Do(u,m,e,i,r),v=Do(f,g,e,i,r),y=t.prevZ,b=t.nextZ;y&&y.z>=_&&b&&b.z<=v;){if(y.x>=u&&y.x<=f&&y.y>=m&&y.y<=g&&y!==n&&y!==s&&Oo(o,d,l,h,c,p,y.x,y.y)&&Fo(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,b.x>=u&&b.x<=f&&b.y>=m&&b.y<=g&&b!==n&&b!==s&&Oo(o,d,l,h,c,p,b.x,b.y)&&Fo(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;y&&y.z>=_;){if(y.x>=u&&y.x<=f&&y.y>=m&&y.y<=g&&y!==n&&y!==s&&Oo(o,d,l,h,c,p,y.x,y.y)&&Fo(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;b&&b.z<=v;){if(b.x>=u&&b.x<=f&&b.y>=m&&b.y<=g&&b!==n&&b!==s&&Oo(o,d,l,h,c,p,b.x,b.y)&&Fo(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Mo(t,e,i){var r=t;do{var n=r.prev,a=r.next.next;!No(n,a)&&Ho(n,r,r.next,a)&&Yo(n,a)&&Yo(a,n)&&(e.push(n.i/i|0),e.push(r.i/i|0),e.push(a.i/i|0),Wo(r),Wo(r.next),r=t=a),r=r.next}while(r!==t);return Eo(r)}function Lo(t,e,i,r,n,a){var s=t;do{for(var o=s.next.next;o!==s.prev;){if(s.i!==o.i&&Bo(s,o)){var l=Zo(s,o);return s=Eo(s,s.next),l=Eo(l,l.next),$o(s,e,i,r,n,a,0),void $o(l,e,i,r,n,a,0)}o=o.next}s=s.next}while(s!==t)}function Po(t,e){return t.x-e.x}function Ro(t,e){var i=function(t,e){var i,r=e,n=t.x,a=t.y,s=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var o=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=n&&o>s&&(s=o,i=r.x<r.next.x?r:r.next,o===n))return i}r=r.next}while(r!==e);if(!i)return null;var l,c=i,d=i.x,h=i.y,p=1/0;r=i;do{n>=r.x&&r.x>=d&&n!==r.x&&Oo(a<h?n:s,a,d,h,a<h?s:n,a,r.x,r.y)&&(l=Math.abs(a-r.y)/(n-r.x),Yo(r,t)&&(l<p||l===p&&(r.x>i.x||r.x===i.x&&zo(i,r)))&&(i=r,p=l)),r=r.next}while(r!==c);return i}(t,e);if(!i)return e;var r=Zo(i,t);return Eo(r,r.next),Eo(i,i.next)}function zo(t,e){return Fo(t.prev,t,e.prev)<0&&Fo(e.next,t,t.next)<0}function Do(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function jo(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function Oo(t,e,i,r,n,a,s,o){return(n-s)*(e-o)>=(t-s)*(a-o)&&(t-s)*(r-o)>=(i-s)*(e-o)&&(i-s)*(a-o)>=(n-s)*(r-o)}function Bo(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&Ho(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(Yo(t,e)&&Yo(e,t)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,a=(t.y+e.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&n<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)&&(Fo(t.prev,t,e.prev)||Fo(t,e.prev,e))||No(t,e)&&Fo(t.prev,t,t.next)>0&&Fo(e.prev,e,e.next)>0)}function Fo(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function No(t,e){return t.x===e.x&&t.y===e.y}function Ho(t,e,i,r){var n=Uo(Fo(t,e,i)),a=Uo(Fo(t,e,r)),s=Uo(Fo(i,r,t)),o=Uo(Fo(i,r,e));return n!==a&&s!==o||!(0!==n||!Vo(t,i,e))||!(0!==a||!Vo(t,r,e))||!(0!==s||!Vo(i,t,r))||!(0!==o||!Vo(i,e,r))}function Vo(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function Uo(t){return t>0?1:t<0?-1:0}function Yo(t,e){return Fo(t.prev,t,t.next)<0?Fo(t,e,t.next)>=0&&Fo(t,t.prev,e)>=0:Fo(t,e,t.prev)<0||Fo(t,t.next,e)<0}function Zo(t,e){var i=new Go(t.i,t.x,t.y),r=new Go(e.i,e.x,e.y),n=t.next,a=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,a.next=r,r.prev=a,r}function qo(t,e,i,r){var n=new Go(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function Wo(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Go(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Xo(t,e,i,r){for(var n=0,a=e,s=i-r;a<i;a+=r)n+=(t[s]-t[a])*(t[a+1]+t[s+1]),s=a;return n}To.exports=So,To.exports.default=So,So.deviation=function(t,e,i,r){var n=e&&e.length,a=Math.abs(Xo(t,0,n?e[0]*i:t.length,i));if(n)for(var s=0,o=e.length;s<o;s++)a-=Math.abs(Xo(t,e[s]*i,s<o-1?e[s+1]*i:t.length,i));var l=0;for(s=0;s<r.length;s+=3){var c=r[s]*i,d=r[s+1]*i,h=r[s+2]*i;l+=Math.abs((t[c]-t[h])*(t[d+1]-t[c+1])-(t[c]-t[d])*(t[h+1]-t[c+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},So.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var a=0;a<t[n].length;a++)for(var s=0;s<e;s++)i.vertices.push(t[n][a][s]);n>0&&i.holes.push(r+=t[n-1].length)}return i};var Ko=i(To.exports);function Jo(t,e,i){const r=i.patternDependencies;let n=!1;for(const i of e){const e=i.paint.get(`${t}-pattern`);e.isConstant()||(n=!0);const a=e.constantOr(null);a&&(n=!0,r[a.to]=!0,r[a.from]=!0)}return n}function Qo(t,e,i,r,n){const a=n.patternDependencies;for(const s of e){const e=s.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:r-1},i,{},n.availableImages),o=e.evaluate({zoom:r},i,{},n.availableImages),l=e.evaluate({zoom:r+1},i,{},n.availableImages);t=t&&t.name?t.name:t,o=o&&o.name?o.name:o,l=l&&l.name?l.name:l,a[t]=!0,a[o]=!0,a[l]=!0,i.patterns[s.id]={min:t,mid:o,max:l}}}return i}class tl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Fa,this.indexArray=new Xa,this.indexArray2=new Ka,this.programConfigurations=new Cs(t.layers,t.zoom),this.segments=new ts,this.segments2=new ts,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.hasPattern=Jo("fill",this.layers,e);const r=this.layers[0].layout.get("fill-sort-key"),n=!r.isConstant(),a=[];for(const{feature:s,id:o,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,d=Ps(s,t);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),d,i))continue;const h=n?r.evaluate(d,{},i,e.availableImages):void 0,p={id:o,properties:s.properties,type:s.type,sourceLayerIndex:c,index:l,geometry:t?d.geometry:Ls(s),patterns:{},sortKey:h};a.push(p)}n&&a.sort(((t,e)=>t.sortKey-e.sortKey));for(const r of a){const{geometry:n,index:a,sourceLayerIndex:s}=r;if(this.hasPattern){const t=Qo("fill",this.layers,r,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(r,n,a,i,{});e.featureIndex.insert(t[a].feature,n,a,s,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}addFeatures(t,e,i){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ko),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,i,r,n){for(const t of vi(e,500)){let e=0;for(const i of t)e+=i.length;const i=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),r=i.vertexLength,n=[],a=[];for(const e of t){if(0===e.length)continue;e!==t[0]&&a.push(n.length/2);const i=this.segments2.prepareSegment(e.length,this.layoutVertexArray,this.indexArray2),r=i.vertexLength;this.layoutVertexArray.emplaceBack(e[0].x,e[0].y),this.indexArray2.emplaceBack(r+e.length-1,r),n.push(e[0].x),n.push(e[0].y);for(let t=1;t<e.length;t++)this.layoutVertexArray.emplaceBack(e[t].x,e[t].y),this.indexArray2.emplaceBack(r+t-1,r+t),n.push(e[t].x),n.push(e[t].y);i.vertexLength+=e.length,i.primitiveLength+=e.length}const s=Ko(n,a);for(let t=0;t<s.length;t+=3)this.indexArray.emplaceBack(r+s[t],r+s[t+1],r+s[t+2]);i.vertexLength+=e,i.primitiveLength+=s.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)}}let el,il;bn("FillBucket",tl,{omit:["layers","patternFeatures"]});var rl={get paint(){return il=il||new Gn({"fill-antialias":new Un(Z.paint_fill["fill-antialias"]),"fill-opacity":new Yn(Z.paint_fill["fill-opacity"]),"fill-color":new Yn(Z.paint_fill["fill-color"]),"fill-outline-color":new Yn(Z.paint_fill["fill-outline-color"]),"fill-translate":new Un(Z.paint_fill["fill-translate"]),"fill-translate-anchor":new Un(Z.paint_fill["fill-translate-anchor"]),"fill-pattern":new Zn(Z.paint_fill["fill-pattern"])})},get layout(){return el=el||new Gn({"fill-sort-key":new Yn(Z.layout_fill["fill-sort-key"])})}};class nl extends Kn{constructor(t){super(t,rl)}recalculate(t,e){super.recalculate(t,e);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new tl(t)}queryRadius(){return Ws(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,i,r,n,a,s){return Os(Gs(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,s),r)}isTileClipped(){return!0}}const al=ea([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),sl=ea([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ol}=al;var ll={},cl=r,dl=hl;function hl(t,e,i,r,n){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=n,t.readFields(pl,this,e)}function pl(t,e,i){1==t?e.id=i.readVarint():2==t?function(t,e){for(var i=t.readVarint()+t.pos;t.pos<i;){var r=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[r]=n}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function ul(t){for(var e,i,r=0,n=0,a=t.length,s=a-1;n<a;s=n++)r+=((i=t[s]).x-(e=t[n]).x)*(e.y+i.y);return r}hl.types=["Unknown","Point","LineString","Polygon"],hl.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,r=1,n=0,a=0,s=0,o=[];t.pos<i;){if(n<=0){var l=t.readVarint();r=7&l,n=l>>3}if(n--,1===r||2===r)a+=t.readSVarint(),s+=t.readSVarint(),1===r&&(e&&o.push(e),e=[]),e.push(new cl(a,s));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&o.push(e),o},hl.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,r=0,n=0,a=0,s=1/0,o=-1/0,l=1/0,c=-1/0;t.pos<e;){if(r<=0){var d=t.readVarint();i=7&d,r=d>>3}if(r--,1===i||2===i)(n+=t.readSVarint())<s&&(s=n),n>o&&(o=n),(a+=t.readSVarint())<l&&(l=a),a>c&&(c=a);else if(7!==i)throw new Error("unknown command "+i)}return[s,l,o,c]},hl.prototype.toGeoJSON=function(t,e,i){var r,n,a=this.extent*Math.pow(2,i),s=this.extent*t,o=this.extent*e,l=this.loadGeometry(),c=hl.types[this.type];function d(t){for(var e=0;e<t.length;e++){var i=t[e];t[e]=[360*(i.x+s)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(i.y+o)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(r=0;r<l.length;r++)h[r]=l[r][0];d(l=h);break;case 2:for(r=0;r<l.length;r++)d(l[r]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var i,r,n=[],a=0;a<e;a++){var s=ul(t[a]);0!==s&&(void 0===r&&(r=s<0),r===s<0?(i&&n.push(i),i=[t[a]]):i.push(t[a]))}return i&&n.push(i),n}(l),r=0;r<l.length;r++)for(n=0;n<l[r].length;n++)d(l[r][n])}1===l.length?l=l[0]:c="Multi"+c;var p={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(p.id=this.id),p};var ml=dl,fl=gl;function gl(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(_l,this,e),this.length=this._features.length}function _l(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(t){for(var e=null,i=t.readVarint()+t.pos;t.pos<i;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(i))}gl.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new ml(this._pbf,e,this.extent,this._keys,this._values)};var vl=fl;function yl(t,e,i){if(3===t){var r=new vl(i,i.readVarint()+i.pos);r.length&&(e[r.name]=r)}}ll.VectorTile=function(t,e){this.layers=t.readFields(yl,{},e)},ll.VectorTileFeature=dl,ll.VectorTileLayer=fl;const bl=ll.VectorTileFeature.types,xl=Math.pow(2,13);function wl(t,e,i,r,n,a,s,o){t.emplaceBack(e,i,2*Math.floor(r*xl)+s,n*xl*2,a*xl*2,Math.round(o))}class kl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Na,this.centroidVertexArray=new Oa,this.indexArray=new Xa,this.programConfigurations=new Cs(t.layers,t.zoom),this.segments=new ts,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.features=[],this.hasPattern=Jo("fill-extrusion",this.layers,e);for(const{feature:r,id:n,index:a,sourceLayerIndex:s}of t){const t=this.layers[0]._featureFilter.needGeometry,o=Ps(r,t);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),o,i))continue;const l={id:n,sourceLayerIndex:s,index:a,geometry:t?o.geometry:Ls(r),properties:r.properties,type:r.type,patterns:{}};this.hasPattern?this.features.push(Qo("fill-extrusion",this.layers,l,this.zoom,e)):this.addFeature(l,l.geometry,a,i,{}),e.featureIndex.insert(r,l.geometry,a,s,this.index,!0)}}addFeatures(t,e,i){for(const t of this.features){const{geometry:r}=t;this.addFeature(t,r,t.index,e,i)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ol),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,sl.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,e,i,r,n){for(const i of vi(e,500)){const e={x:0,y:0,vertexCount:0};let r=0;for(const t of i)r+=t.length;let n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const t of i){if(0===t.length)continue;if(Sl(t))continue;let i=0;for(let r=0;r<t.length;r++){const a=t[r];if(r>=1){const s=t[r-1];if(!Tl(a,s)){n.vertexLength+4>ts.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const t=a.sub(s)._perp()._unit(),r=s.dist(a);i+r>32768&&(i=0),wl(this.layoutVertexArray,a.x,a.y,t.x,t.y,0,0,i),wl(this.layoutVertexArray,a.x,a.y,t.x,t.y,0,1,i),e.x+=2*a.x,e.y+=2*a.y,e.vertexCount+=2,i+=r,wl(this.layoutVertexArray,s.x,s.y,t.x,t.y,0,0,i),wl(this.layoutVertexArray,s.x,s.y,t.x,t.y,0,1,i),e.x+=2*s.x,e.y+=2*s.y,e.vertexCount+=2;const o=n.vertexLength;this.indexArray.emplaceBack(o,o+2,o+1),this.indexArray.emplaceBack(o+1,o+2,o+3),n.vertexLength+=4,n.primitiveLength+=2}}}}if(n.vertexLength+r>ts.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(r,this.layoutVertexArray,this.indexArray)),"Polygon"!==bl[t.type])continue;const a=[],s=[],o=n.vertexLength;for(const t of i)if(0!==t.length){t!==i[0]&&s.push(a.length/2);for(let i=0;i<t.length;i++){const r=t[i];wl(this.layoutVertexArray,r.x,r.y,0,0,1,1,0),e.x+=r.x,e.y+=r.y,e.vertexCount+=1,a.push(r.x),a.push(r.y)}}const l=Ko(a,s);for(let t=0;t<l.length;t+=3)this.indexArray.emplaceBack(o+l[t],o+l[t+2],o+l[t+1]);n.primitiveLength+=l.length/3,n.vertexLength+=r;for(let t=0;t<e.vertexCount;t++){const t=Math.floor(e.x/e.vertexCount),i=Math.floor(e.y/e.vertexCount);this.centroidVertexArray.emplaceBack(t,i)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)}}function Tl(t,e){return t.x===e.x&&(t.x<0||t.x>As)||t.y===e.y&&(t.y<0||t.y>As)}function Sl(t){return t.every((t=>t.x<0))||t.every((t=>t.x>As))||t.every((t=>t.y<0))||t.every((t=>t.y>As))}let Cl;bn("FillExtrusionBucket",kl,{omit:["layers","features"]});var El={get paint(){return Cl=Cl||new Gn({"fill-extrusion-opacity":new Un(Z["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Yn(Z["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Un(Z["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Un(Z["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Zn(Z["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Yn(Z["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Yn(Z["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Un(Z["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class $l extends Kn{constructor(t){super(t,El)}createBucket(t){return new kl(t)}queryRadius(){return Ws(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,e,i,r,n,s,o,l){const c=Gs(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,o),d=this.paint.get("fill-extrusion-height").evaluate(e,i),h=this.paint.get("fill-extrusion-base").evaluate(e,i),p=function(t,e,i,r){const n=[];for(const i of t){const t=[i.x,i.y,0,1];ao(t,t,e),n.push(new a(t[0]/t[3],t[1]/t[3]))}return n}(c,l),u=function(t,e,i,r){const n=[],s=[],o=r[8]*e,l=r[9]*e,c=r[10]*e,d=r[11]*e,h=r[8]*i,p=r[9]*i,u=r[10]*i,m=r[11]*i;for(const e of t){const t=[],i=[];for(const n of e){const e=n.x,s=n.y,f=r[0]*e+r[4]*s+r[12],g=r[1]*e+r[5]*s+r[13],_=r[2]*e+r[6]*s+r[14],v=r[3]*e+r[7]*s+r[15],y=_+c,b=v+d,x=f+h,w=g+p,k=_+u,T=v+m,S=new a((f+o)/b,(g+l)/b);S.z=y/b,t.push(S);const C=new a(x/T,w/T);C.z=k/T,i.push(C)}n.push(t),s.push(i)}return[n,s]}(r,h,d,l);return function(t,e,i){let r=1/0;Os(i,e)&&(r=Il(i,e[0]));for(let n=0;n<e.length;n++){const a=e[n],s=t[n];for(let t=0;t<a.length-1;t++){const e=a[t],n=[e,a[t+1],s[t+1],s[t],e];Ds(i,n)&&(r=Math.min(r,Il(i,n)))}}return r!==1/0&&r}(u[0],u[1],p)}}function Al(t,e){return t.x*e.x+t.y*e.y}function Il(t,e){if(1===t.length){let i=0;const r=e[i++];let n;for(;!n||r.equals(n);)if(n=e[i++],!n)return 1/0;for(;i<e.length;i++){const a=e[i],s=t[0],o=n.sub(r),l=a.sub(r),c=s.sub(r),d=Al(o,o),h=Al(o,l),p=Al(l,l),u=Al(c,o),m=Al(c,l),f=d*p-h*h,g=(p*u-h*m)/f,_=(d*m-h*u)/f,v=r.z*(1-g-_)+n.z*g+a.z*_;if(isFinite(v))return v}return 1/0}{let t=1/0;for(const i of e)t=Math.min(t,i.z);return t}}const Ml=ea([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ll}=Ml,Pl=ea([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Rl}=Pl,zl=ll.VectorTileFeature.types,Dl=Math.cos(Math.PI/180*37.5),jl=Math.pow(2,14)/.5;class Ol{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((t=>{this.gradients[t.id]={}})),this.layoutVertexArray=new Ha,this.layoutVertexArray2=new Va,this.indexArray=new Xa,this.programConfigurations=new Cs(t.layers,t.zoom),this.segments=new ts,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.hasPattern=Jo("line",this.layers,e);const r=this.layers[0].layout.get("line-sort-key"),n=!r.isConstant(),a=[];for(const{feature:e,id:s,index:o,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=Ps(e,t);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),c,i))continue;const d=n?r.evaluate(c,{},i):void 0,h={id:s,properties:e.properties,type:e.type,sourceLayerIndex:l,index:o,geometry:t?c.geometry:Ls(e),patterns:{},sortKey:d};a.push(h)}n&&a.sort(((t,e)=>t.sortKey-e.sortKey));for(const r of a){const{geometry:n,index:a,sourceLayerIndex:s}=r;if(this.hasPattern){const t=Qo("line",this.layers,r,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(r,n,a,i,{});e.featureIndex.insert(t[a].feature,n,a,s,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}addFeatures(t,e,i){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Rl)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ll),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,i,r,n){const a=this.layers[0].layout,s=a.get("line-join").evaluate(t,{}),o=a.get("line-cap"),l=a.get("line-miter-limit"),c=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const i of e)this.addLine(i,t,s,o,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)}addLine(t,e,i,r,n,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const s="Polygon"===zl[e.type];let o=t.length;for(;o>=2&&t[o-1].equals(t[o-2]);)o--;let l=0;for(;l<o-1&&t[l].equals(t[l+1]);)l++;if(o<(s?3:2))return;"bevel"===i&&(n=1.05);const c=this.overscaling<=16?15*As/(512*this.overscaling):0,d=this.segments.prepareSegment(10*o,this.layoutVertexArray,this.indexArray);let h,p,u,m,f;this.e1=this.e2=-1,s&&(h=t[o-2],f=t[l].sub(h)._unit()._perp());for(let e=l;e<o;e++){if(u=e===o-1?s?t[l+1]:void 0:t[e+1],u&&t[e].equals(u))continue;f&&(m=f),h&&(p=h),h=t[e],f=u?u.sub(h)._unit()._perp():m,m=m||f;let g=m.add(f);0===g.x&&0===g.y||g._unit();const _=m.x*f.x+m.y*f.y,v=g.x*f.x+g.y*f.y,y=0!==v?1/v:1/0,b=2*Math.sqrt(2-2*v),x=v<Dl&&p&&u,w=m.x*f.y-m.y*f.x>0;if(x&&e>l){const t=h.dist(p);if(t>2*c){const e=h.sub(h.sub(p)._mult(c/t)._round());this.updateDistance(p,e),this.addCurrentVertex(e,m,0,0,d),p=e}}const k=p&&u;let T=k?i:s?"butt":r;if(k&&"round"===T&&(y<a?T="miter":y<=2&&(T="fakeround")),"miter"===T&&y>n&&(T="bevel"),"bevel"===T&&(y>2&&(T="flipbevel"),y<n&&(T="miter")),p&&this.updateDistance(p,h),"miter"===T)g._mult(y),this.addCurrentVertex(h,g,0,0,d);else if("flipbevel"===T){if(y>100)g=f.mult(-1);else{const t=y*m.add(f).mag()/m.sub(f).mag();g._perp()._mult(t*(w?-1:1))}this.addCurrentVertex(h,g,0,0,d),this.addCurrentVertex(h,g.mult(-1),0,0,d)}else if("bevel"===T||"fakeround"===T){const t=-Math.sqrt(y*y-1),e=w?t:0,i=w?0:t;if(p&&this.addCurrentVertex(h,m,e,i,d),"fakeround"===T){const t=Math.round(180*b/Math.PI/20);for(let e=1;e<t;e++){let i=e/t;if(.5!==i){const t=i-.5;i+=i*t*(i-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*t*t+(.848013+_*(.215638*_-1.06021)))}const r=f.sub(m)._mult(i)._add(m)._unit()._mult(w?-1:1);this.addHalfVertex(h,r.x,r.y,!1,w,0,d)}}u&&this.addCurrentVertex(h,f,-e,-i,d)}else if("butt"===T)this.addCurrentVertex(h,g,0,0,d);else if("square"===T){const t=p?1:-1;this.addCurrentVertex(h,g,t,t,d)}else"round"===T&&(p&&(this.addCurrentVertex(h,m,0,0,d),this.addCurrentVertex(h,m,1,1,d,!0)),u&&(this.addCurrentVertex(h,f,-1,-1,d,!0),this.addCurrentVertex(h,f,0,0,d)));if(x&&e<o-1){const t=h.dist(u);if(t>2*c){const e=h.add(u.sub(h)._mult(c/t)._round());this.updateDistance(h,e),this.addCurrentVertex(e,f,0,0,d),h=e}}}}addCurrentVertex(t,e,i,r,n,a=!1){const s=e.y*r-e.x,o=-e.y-e.x*r;this.addHalfVertex(t,e.x+e.y*i,e.y-e.x*i,a,!1,i,n),this.addHalfVertex(t,s,o,a,!0,-r,n),this.distance>jl/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,e,i,r,n,a))}addHalfVertex({x:t,y:e},i,r,n,a,s,o){const l=.5*(this.lineClips?this.scaledDistance*(jl-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(n?1:0),(e<<1)+(a?1:0),Math.round(63*i)+128,Math.round(63*r)+128,1+(0===s?0:s<0?-1:1)|(63&l)<<2,l>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const c=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),o.primitiveLength++),a?this.e2=c:this.e1=c}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}let Bl,Fl;bn("LineBucket",Ol,{omit:["layers","patternFeatures"]});var Nl={get paint(){return Fl=Fl||new Gn({"line-opacity":new Yn(Z.paint_line["line-opacity"]),"line-color":new Yn(Z.paint_line["line-color"]),"line-translate":new Un(Z.paint_line["line-translate"]),"line-translate-anchor":new Un(Z.paint_line["line-translate-anchor"]),"line-width":new Yn(Z.paint_line["line-width"]),"line-gap-width":new Yn(Z.paint_line["line-gap-width"]),"line-offset":new Yn(Z.paint_line["line-offset"]),"line-blur":new Yn(Z.paint_line["line-blur"]),"line-dasharray":new qn(Z.paint_line["line-dasharray"]),"line-pattern":new Zn(Z.paint_line["line-pattern"]),"line-gradient":new Wn(Z.paint_line["line-gradient"])})},get layout(){return Bl=Bl||new Gn({"line-cap":new Un(Z.layout_line["line-cap"]),"line-join":new Yn(Z.layout_line["line-join"]),"line-miter-limit":new Un(Z.layout_line["line-miter-limit"]),"line-round-limit":new Un(Z.layout_line["line-round-limit"]),"line-sort-key":new Yn(Z.layout_line["line-sort-key"])})}};class Hl extends Yn{possiblyEvaluate(t,e){return e=new zn(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,i,r){return e=_({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,i,r)}}let Vl;class Ul extends Kn{constructor(t){super(t,Nl),this.gradientVersion=0,Vl||(Vl=new Hl(Nl.paint.properties["line-width"].specification),Vl.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this.gradientExpression();this.stepInterpolant=!!function(t){return void 0!==t._styleExpression}(t)&&t._styleExpression.expression instanceof ke,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Vl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Ol(t)}queryRadius(t){const e=t,i=Yl(qs("line-width",this,e),qs("line-gap-width",this,e)),r=qs("line-offset",this,e);return i/2+Math.abs(r)+Ws(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,i,r,n,s,o){const l=Gs(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),s.angle,o),c=o/2*Yl(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),d=this.paint.get("line-offset").evaluate(e,i);return d&&(r=function(t,e){const i=[];for(let r=0;r<t.length;r++){const n=t[r],s=[];for(let t=0;t<n.length;t++){const i=n[t-1],r=n[t],o=n[t+1],l=0===t?new a(0,0):r.sub(i)._unit()._perp(),c=t===n.length-1?new a(0,0):o.sub(r)._unit()._perp(),d=l._add(c)._unit(),h=d.x*c.x+d.y*c.y;0!==h&&d._mult(1/h),s.push(d._mult(e)._add(r))}i.push(s)}return i}(r,d*o)),function(t,e,i){for(let r=0;r<e.length;r++){const n=e[r];if(t.length>=3)for(let e=0;e<n.length;e++)if(Ys(t,n[e]))return!0;if(Bs(t,n,i))return!0}return!1}(l,r,c)}isTileClipped(){return!0}}function Yl(t,e){return e>0?e+2*t:t}const Zl=ea([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ql=ea([{name:"a_projected_pos",components:3,type:"Float32"}],4);ea([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Wl=ea([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ea([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Gl=ea([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Xl=ea([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Kl(t,e,i){return t.sections.forEach((t=>{t.text=function(t,e,i){const r=e.layout.get("text-transform").evaluate(i,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),Rn.applyArabicShaping&&(t=Rn.applyArabicShaping(t)),t}(t.text,e,i)})),t}ea([{name:"triangle",components:3,type:"Uint16"}]),ea([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ea([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ea([{type:"Float32",name:"offsetX"}]),ea([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ea([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Jl={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Ql=24,tc=rc,ec=function(t,e,i,r,n){var a,s,o=8*n-r-1,l=(1<<o)-1,c=l>>1,d=-7,h=i?n-1:0,p=i?-1:1,u=t[e+h];for(h+=p,a=u&(1<<-d)-1,u>>=-d,d+=o;d>0;a=256*a+t[e+h],h+=p,d-=8);for(s=a&(1<<-d)-1,a>>=-d,d+=r;d>0;s=256*s+t[e+h],h+=p,d-=8);if(0===a)a=1-c;else{if(a===l)return s?NaN:1/0*(u?-1:1);s+=Math.pow(2,r),a-=c}return(u?-1:1)*s*Math.pow(2,a-r)},ic=function(t,e,i,r,n,a){var s,o,l,c=8*a-n-1,d=(1<<c)-1,h=d>>1,p=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,u=r?0:a-1,m=r?1:-1,f=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,s=d):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=d?(o=0,s=d):s+h>=1?(o=(e*l-1)*Math.pow(2,n),s+=h):(o=e*Math.pow(2,h-1)*Math.pow(2,n),s=0));n>=8;t[i+u]=255&o,u+=m,o/=256,n-=8);for(s=s<<n|o,c+=n;c>0;t[i+u]=255&s,u+=m,s/=256,c-=8);t[i+u-m]|=128*f};function rc(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}rc.Varint=0,rc.Fixed64=1,rc.Bytes=2,rc.Fixed32=5;var nc=4294967296,ac=1/nc,sc="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function oc(t){return t.type===rc.Bytes?t.readVarint()+t.pos:t.pos+1}function lc(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function cc(t,e,i){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(r);for(var n=i.pos-1;n>=t;n--)i.buf[n+r]=i.buf[n]}function dc(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function hc(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function pc(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function uc(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function mc(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function fc(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function gc(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function _c(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function vc(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function yc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function bc(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function xc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}rc.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,a=this.pos;this.type=7&r,t(n,e,this),this.pos===a&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=yc(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=xc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=yc(this.buf,this.pos)+yc(this.buf,this.pos+4)*nc;return this.pos+=8,t},readSFixed64:function(){var t=yc(this.buf,this.pos)+xc(this.buf,this.pos+4)*nc;return this.pos+=8,t},readFloat:function(){var t=ec(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ec(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,r=this.buf;return e=127&(i=r[this.pos++]),i<128?e:(e|=(127&(i=r[this.pos++]))<<7,i<128?e:(e|=(127&(i=r[this.pos++]))<<14,i<128?e:(e|=(127&(i=r[this.pos++]))<<21,i<128?e:function(t,e,i){var r,n,a=i.buf;if(r=(112&(n=a[i.pos++]))>>4,n<128)return lc(t,r,e);if(r|=(127&(n=a[i.pos++]))<<3,n<128)return lc(t,r,e);if(r|=(127&(n=a[i.pos++]))<<10,n<128)return lc(t,r,e);if(r|=(127&(n=a[i.pos++]))<<17,n<128)return lc(t,r,e);if(r|=(127&(n=a[i.pos++]))<<24,n<128)return lc(t,r,e);if(r|=(1&(n=a[i.pos++]))<<31,n<128)return lc(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&sc?function(t,e,i){return sc.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){for(var r="",n=e;n<i;){var a,s,o,l=t[n],c=null,d=l>239?4:l>223?3:l>191?2:1;if(n+d>i)break;1===d?l<128&&(c=l):2===d?128==(192&(a=t[n+1]))&&(c=(31&l)<<6|63&a)<=127&&(c=null):3===d?(s=t[n+2],128==(192&(a=t[n+1]))&&128==(192&s)&&((c=(15&l)<<12|(63&a)<<6|63&s)<=2047||c>=55296&&c<=57343)&&(c=null)):4===d&&(s=t[n+2],o=t[n+3],128==(192&(a=t[n+1]))&&128==(192&s)&&128==(192&o)&&((c=(15&l)<<18|(63&a)<<12|(63&s)<<6|63&o)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,d=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),n+=d}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==rc.Bytes)return t.push(this.readVarint(e));var i=oc(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==rc.Bytes)return t.push(this.readSVarint());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==rc.Bytes)return t.push(this.readBoolean());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==rc.Bytes)return t.push(this.readFloat());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==rc.Bytes)return t.push(this.readDouble());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==rc.Bytes)return t.push(this.readFixed32());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==rc.Bytes)return t.push(this.readSFixed32());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==rc.Bytes)return t.push(this.readFixed64());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==rc.Bytes)return t.push(this.readSFixed64());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===rc.Varint)for(;this.buf[this.pos++]>127;);else if(e===rc.Bytes)this.pos=this.readVarint()+this.pos;else if(e===rc.Fixed32)this.pos+=4;else{if(e!==rc.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),bc(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),bc(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),bc(this.buf,-1&t,this.pos),bc(this.buf,Math.floor(t*ac),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),bc(this.buf,-1&t,this.pos),bc(this.buf,Math.floor(t*ac),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,r;if(t>=0?(i=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,i.buf[i.pos]=127&(t>>>=7)}(i,0,e),function(t,e){var i=(7&t)<<4;e.buf[e.pos++]|=i|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var r,n,a=0;a<e.length;a++){if((r=e.charCodeAt(a))>55295&&r<57344){if(!n){r>56319||a+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):n=r;continue}if(r<56320){t[i++]=239,t[i++]=191,t[i++]=189,n=r;continue}r=n-55296<<10|r-56320|65536,n=null}else n&&(t[i++]=239,t[i++]=191,t[i++]=189,n=null);r<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:(r<65536?t[i++]=r>>12|224:(t[i++]=r>>18|240,t[i++]=r>>12&63|128),t[i++]=r>>6&63|128),t[i++]=63&r|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&cc(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),ic(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ic(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var r=this.pos-i;r>=128&&cc(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,i){this.writeTag(t,rc.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,dc,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,hc,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,mc,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,pc,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,uc,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,fc,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,gc,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,_c,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,vc,e)},writeBytesField:function(t,e){this.writeTag(t,rc.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,rc.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,rc.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,rc.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,rc.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,rc.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,rc.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,rc.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,rc.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,rc.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var wc=i(tc);const kc=3;function Tc(t,e,i){1===t&&i.readMessage(Sc,e)}function Sc(t,e,i){if(3===t){const{id:t,bitmap:r,width:n,height:a,left:s,top:o,advance:l}=i.readMessage(Cc,{});e.push({id:t,bitmap:new fo({width:n+2*kc,height:a+2*kc},r),metrics:{width:n,height:a,left:s,top:o,advance:l}})}}function Cc(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}const Ec=kc;function $c(t){let e=0,i=0;for(const r of t)e+=r.w*r.h,i=Math.max(i,r.w);t.sort(((t,e)=>e.h-t.h));const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let n=0,a=0;for(const e of t)for(let t=r.length-1;t>=0;t--){const i=r[t];if(!(e.w>i.w||e.h>i.h)){if(e.x=i.x,e.y=i.y,a=Math.max(a,e.y+e.h),n=Math.max(n,e.x+e.w),e.w===i.w&&e.h===i.h){const e=r.pop();t<r.length&&(r[t]=e)}else e.h===i.h?(i.x+=e.w,i.w-=e.w):e.w===i.w?(i.y+=e.h,i.h-=e.h):(r.push({x:i.x+e.w,y:i.y,w:i.w-e.w,h:e.h}),i.y+=e.h,i.h-=e.h);break}}return{w:n,h:a,fill:e/(n*a)||0}}const Ac=1;class Ic{constructor(t,{pixelRatio:e,version:i,stretchX:r,stretchY:n,content:a,textFitWidth:s,textFitHeight:o}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=r,this.stretchY=n,this.content=a,this.version=i,this.textFitWidth=s,this.textFitHeight=o}get tl(){return[this.paddedRect.x+Ac,this.paddedRect.y+Ac]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ac,this.paddedRect.y+this.paddedRect.h-Ac]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Ac)/this.pixelRatio,(this.paddedRect.h-2*Ac)/this.pixelRatio]}}class Mc{constructor(t,e){const i={},r={};this.haveRenderCallbacks=[];const n=[];this.addImages(t,i,n),this.addImages(e,r,n);const{w:a,h:s}=$c(n),o=new go({width:a||1,height:s||1});for(const e in t){const r=t[e],n=i[e].paddedRect;go.copy(r.data,o,{x:0,y:0},{x:n.x+Ac,y:n.y+Ac},r.data)}for(const t in e){const i=e[t],n=r[t].paddedRect,a=n.x+Ac,s=n.y+Ac,l=i.data.width,c=i.data.height;go.copy(i.data,o,{x:0,y:0},{x:a,y:s},i.data),go.copy(i.data,o,{x:0,y:c-1},{x:a,y:s-1},{width:l,height:1}),go.copy(i.data,o,{x:0,y:0},{x:a,y:s+c},{width:l,height:1}),go.copy(i.data,o,{x:l-1,y:0},{x:a-1,y:s},{width:1,height:c}),go.copy(i.data,o,{x:0,y:0},{x:a+l,y:s},{width:1,height:c})}this.image=o,this.iconPositions=i,this.patternPositions=r}addImages(t,e,i){for(const r in t){const n=t[r],a={x:0,y:0,w:n.data.width+2*Ac,h:n.data.height+2*Ac};i.push(a),e[r]=new Ic(a,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(r)}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const i in t.updatedImages)this.patchUpdatedImage(this.iconPositions[i],t.getImage(i),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i),e)}patchUpdatedImage(t,e,i){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[r,n]=t.tl;i.update(e.data,void 0,{x:r,y:n})}}var Lc;bn("ImagePosition",Ic),bn("ImageAtlas",Mc),t.ah=void 0,(Lc=t.ah||(t.ah={}))[Lc.none=0]="none",Lc[Lc.horizontal=1]="horizontal",Lc[Lc.vertical=2]="vertical",Lc[Lc.horizontalOnly=3]="horizontalOnly";const Pc=-17;class Rc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const i=new Rc;return i.scale=t||1,i.fontStack=e,i}static forImage(t){const e=new Rc;return e.imageName=t,e}}class zc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const i=new zc;for(let r=0;r<t.sections.length;r++){const n=t.sections[r];n.image?i.addImageSection(n):i.addTextSection(n,e)}return i}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let e="";for(let i=0;i<t.length;i++){const r=t.charCodeAt(i+1)||null,n=t.charCodeAt(i-1)||null;e+=r&&In(r)&&!Jl[t[i+1]]||n&&In(n)&&!Jl[t[i-1]]||!Jl[t[i]]?t[i]:Jl[t[i]]}return e}(this.text)}trim(){let t=0;for(let e=0;e<this.text.length&&jc[this.text.charCodeAt(e)];e++)t++;let e=this.text.length;for(let i=this.text.length-1;i>=0&&i>=t&&jc[this.text.charCodeAt(i)];i--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const i=new zc;return i.text=this.text.substring(t,e),i.sectionIndex=this.sectionIndex.slice(t,e),i.sections=this.sections,i}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,e)=>Math.max(t,this.sections[e].scale)),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(Rc.forText(t.scale,t.fontStack||e));const i=this.sections.length-1;for(let e=0;e<t.text.length;++e)this.sectionIndex.push(i)}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void k("Can't add FormattedSection with an empty image.");const i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(Rc.forImage(e)),this.sectionIndex.push(this.sections.length-1)):k("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Dc(e,i,r,n,a,s,o,l,c,d,h,p,u,m,f){const g=zc.fromFeature(e,a);let _;p===t.ah.vertical&&g.verticalizePunctuation();const{processBidirectionalText:v,processStyledBidirectionalText:y}=Rn;if(v&&1===g.sections.length){_=[];const t=v(g.toString(),Yc(g,d,s,i,n,m));for(const e of t){const t=new zc;t.text=e,t.sections=g.sections;for(let i=0;i<e.length;i++)t.sectionIndex.push(0);_.push(t)}}else if(y){_=[];const t=y(g.text,g.sectionIndex,Yc(g,d,s,i,n,m));for(const e of t){const t=new zc;t.text=e[0],t.sectionIndex=e[1],t.sections=g.sections,_.push(t)}}else _=function(t,e){const i=[],r=t.text;let n=0;for(const r of e)i.push(t.substring(n,r)),n=r;return n<r.length&&i.push(t.substring(n,r.length)),i}(g,Yc(g,d,s,i,n,m));const b=[],x={positionedLines:b,text:g.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:p,iconsInText:!1,verticalizable:!1};return function(e,i,r,n,a,s,o,l,c,d,h,p){let u=0,m=Pc,f=0,g=0;const _="right"===l?1:"left"===l?0:.5;let v=0;for(const o of a){o.trim();const a=o.getMaxScale(),l=(a-1)*Ql,b={positionedGlyphs:[],lineOffset:0};e.positionedLines[v]=b;const x=b.positionedGlyphs;let w=0;if(!o.length()){m+=s,++v;continue}for(let s=0;s<o.length();s++){const f=o.getSection(s),g=o.getSectionIndex(s),_=o.getCharCode(s);let v=0,b=null,k=null,T=null,S=Ql;const C=!(c===t.ah.horizontal||!h&&!An(_)||h&&(jc[_]||(y=_,Sn.Arabic(y)||Sn["Arabic Supplement"](y)||Sn["Arabic Extended-A"](y)||Sn["Arabic Presentation Forms-A"](y)||Sn["Arabic Presentation Forms-B"](y))));if(f.imageName){const t=n[f.imageName];if(!t)continue;T=f.imageName,e.iconsInText=e.iconsInText||!0,k=t.paddedRect;const i=t.displaySize;f.scale=f.scale*Ql/p,b={width:i[0],height:i[1],left:Ac,top:-Ec,advance:C?i[1]:i[0]},v=l+(Ql-i[1]*f.scale),S=b.advance;const r=C?i[0]*f.scale-Ql*a:i[1]*f.scale-Ql*a;r>0&&r>w&&(w=r)}else{const t=r[f.fontStack],e=t&&t[_];if(e&&e.rect)k=e.rect,b=e.metrics;else{const t=i[f.fontStack],e=t&&t[_];if(!e)continue;b=e.metrics}v=(a-f.scale)*Ql}C?(e.verticalizable=!0,x.push({glyph:_,imageName:T,x:u,y:m+v,vertical:C,scale:f.scale,fontStack:f.fontStack,sectionIndex:g,metrics:b,rect:k}),u+=S*f.scale+d):(x.push({glyph:_,imageName:T,x:u,y:m+v,vertical:C,scale:f.scale,fontStack:f.fontStack,sectionIndex:g,metrics:b,rect:k}),u+=b.advance*f.scale+d)}0!==x.length&&(f=Math.max(u-d,f),qc(x,0,x.length-1,_,w)),u=0;const k=s*a+w;b.lineOffset=Math.max(w,l),m+=k,g=Math.max(k,g),++v}var y;const b=m-Pc,{horizontalAlign:x,verticalAlign:w}=Zc(o);(function(t,e,i,r,n,a,s,o,l){const c=(e-i)*n;let d=0;d=a!==s?-o*r-Pc:(-r*l+.5)*s;for(const e of t)for(const t of e.positionedGlyphs)t.x+=c,t.y+=d})(e.positionedLines,_,x,w,f,g,s,b,a.length),e.top+=-w*b,e.bottom=e.top+b,e.left+=-x*f,e.right=e.left+f}(x,i,r,n,_,o,l,c,p,d,u,f),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(b)&&x}const jc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Oc={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Bc={40:!0};function Fc(t,e,i,r,n,a){if(e.imageName){const t=r[e.imageName];return t?t.displaySize[0]*e.scale*Ql/a+n:0}{const r=i[e.fontStack],a=r&&r[t];return a?a.metrics.advance*e.scale+n:0}}function Nc(t,e,i,r){const n=Math.pow(t-e,2);return r?t<e?n/2:2*n:n+Math.abs(i)*i}function Hc(t,e,i){let r=0;return 10===t&&(r-=1e4),i&&(r+=150),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function Vc(t,e,i,r,n,a){let s=null,o=Nc(e,i,n,a);for(const t of r){const r=Nc(e-t.x,i,n,a)+t.badness;r<=o&&(s=t,o=r)}return{index:t,x:e,priorBreak:s,badness:o}}function Uc(t){return t?Uc(t.priorBreak).concat(t.index):[]}function Yc(t,e,i,r,n,a){if(!t)return[];const s=[],o=function(t,e,i,r,n,a){let s=0;for(let i=0;i<t.length();i++){const o=t.getSection(i);s+=Fc(t.getCharCode(i),o,r,n,e,a)}return s/Math.max(1,Math.ceil(s/i))}(t,e,i,r,n,a),l=t.text.indexOf("")>=0;let c=0;for(let i=0;i<t.length();i++){const h=t.getSection(i),p=t.getCharCode(i);if(jc[p]||(c+=Fc(p,h,r,n,e,a)),i<t.length()-1){const e=!((d=p)<11904||!(Sn["Bopomofo Extended"](d)||Sn.Bopomofo(d)||Sn["CJK Compatibility Forms"](d)||Sn["CJK Compatibility Ideographs"](d)||Sn["CJK Compatibility"](d)||Sn["CJK Radicals Supplement"](d)||Sn["CJK Strokes"](d)||Sn["CJK Symbols and Punctuation"](d)||Sn["CJK Unified Ideographs Extension A"](d)||Sn["CJK Unified Ideographs"](d)||Sn["Enclosed CJK Letters and Months"](d)||Sn["Halfwidth and Fullwidth Forms"](d)||Sn.Hiragana(d)||Sn["Ideographic Description Characters"](d)||Sn["Kangxi Radicals"](d)||Sn["Katakana Phonetic Extensions"](d)||Sn.Katakana(d)||Sn["Vertical Forms"](d)||Sn["Yi Radicals"](d)||Sn["Yi Syllables"](d)));(Oc[p]||e||h.imageName||i!==t.length()-2&&Bc[t.getCharCode(i+1)])&&s.push(Vc(i+1,c,o,s,Hc(p,t.getCharCode(i+1),e&&l),!1))}}var d;return Uc(Vc(t.length(),c,o,s,0,!0))}function Zc(t){let e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function qc(t,e,i,r,n){if(!r&&!n)return;const a=t[i],s=(t[i].x+a.metrics.advance*a.scale)*r;for(let r=e;r<=i;r++)t[r].x-=s,t[r].y+=n}function Wc(t,e,i){const{horizontalAlign:r,verticalAlign:n}=Zc(i),a=e[0]-t.displaySize[0]*r,s=e[1]-t.displaySize[1]*n;return{image:t,top:s,bottom:s+t.displaySize[1],left:a,right:a+t.displaySize[0]}}function Gc(t){var e,i;let r=t.left,n=t.top,a=t.right-r,s=t.bottom-n;const o=null!==(e=t.image.textFitWidth)&&void 0!==e?e:"stretchOrShrink",l=null!==(i=t.image.textFitHeight)&&void 0!==i?i:"stretchOrShrink",c=(t.image.content[2]-t.image.content[0])/(t.image.content[3]-t.image.content[1]);if("proportional"===l){if("stretchOnly"===o&&a/s<c||"proportional"===o){const t=Math.ceil(s*c);r*=t/a,a=t}}else if("proportional"===o&&"stretchOnly"===l&&0!==c&&a/s>c){const t=Math.ceil(a/c);n*=t/s,s=t}return{x1:r,y1:n,x2:r+a,y2:n+s}}function Xc(t,e,i,r,n,a){const s=t.image;let o;if(s.content){const t=s.content,e=s.pixelRatio||1;o=[t[0]/e,t[1]/e,s.displaySize[0]-t[2]/e,s.displaySize[1]-t[3]/e]}const l=e.left*a,c=e.right*a;let d,h,p,u;"width"===i||"both"===i?(u=n[0]+l-r[3],h=n[0]+c+r[1]):(u=n[0]+(l+c-s.displaySize[0])/2,h=u+s.displaySize[0]);const m=e.top*a,f=e.bottom*a;return"height"===i||"both"===i?(d=n[1]+m-r[0],p=n[1]+f+r[2]):(d=n[1]+(m+f-s.displaySize[1])/2,p=d+s.displaySize[1]),{image:s,top:d,right:h,bottom:p,left:u,collisionPadding:o}}const Kc=255,Jc=128,Qc=Kc*Jc;function td(t,e){const{expression:i}=e;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new zn(t+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:r}=i;let n=0;for(;n<e.length&&e[n]<=t;)n++;n=Math.max(0,n-1);let a=n;for(;a<e.length&&e[a]<t+1;)a++;a=Math.min(e.length-1,a);const s=e[n],o=e[a];return"composite"===i.kind?{kind:"composite",minZoom:s,maxZoom:o,interpolationType:r}:{kind:"camera",minZoom:s,maxZoom:o,minSize:i.evaluate(new zn(s)),maxSize:i.evaluate(new zn(o)),interpolationType:r}}}function ed(t,e,i){let r="never";const n=t.get(e);return n?r=n:t.get(i)&&(r="always"),r}const id=ll.VectorTileFeature.types,rd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nd(t,e,i,r,n,a,s,o,l,c,d,h,p){const u=o?Math.min(Qc,Math.round(o[0])):0,m=o?Math.min(Qc,Math.round(o[1])):0;t.emplaceBack(e,i,Math.round(32*r),Math.round(32*n),a,s,(u<<1)+(l?1:0),m,16*c,16*d,256*h,256*p)}function ad(t,e,i){t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i)}function sd(t){for(const e of t.sections)if(Pn(e.text))return!0;return!1}class od{constructor(t){this.layoutVertexArray=new Ya,this.indexArray=new Xa,this.programConfigurations=t,this.segments=new ts,this.dynamicLayoutVertexArray=new Za,this.opacityVertexArray=new qa,this.hasVisibleVertices=!1,this.placedSymbolArray=new Aa}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,i,r){this.isEmpty()||(i&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Zl.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,ql.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,rd,!0),this.opacityVertexBuffer.itemSize=1),(i||r)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}bn("SymbolBuffers",od);class ld{constructor(t,e,i){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new i,this.segments=new ts,this.collisionVertexArray=new Ga}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Wl.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}bn("CollisionBuffers",ld);class cd{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=eo([]),this.placementViewportMatrix=eo([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=td(this.zoom,i["text-size"]),this.iconSizeData=td(this.zoom,i["icon-size"]);const r=this.layers[0].layout,n=r.get("symbol-sort-key"),a=r.get("symbol-z-order");this.canOverlap="never"!==ed(r,"text-overlap","text-allow-overlap")||"never"!==ed(r,"icon-overlap","icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&!n.isConstant(),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map((e=>t.ah[e]))),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.sourceID=e.sourceID}createArrays(){this.text=new od(new Cs(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new od(new Cs(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new La,this.lineVertexArray=new Pa,this.symbolInstances=new Ma,this.textAnchorOffsets=new za}calculateGlyphDependencies(t,e,i,r,n){for(let a=0;a<t.length;a++)if(e[t.charCodeAt(a)]=!0,(i||r)&&n){const i=Jl[t.charAt(a)];i&&(e[i.charCodeAt(0)]=!0)}}populate(e,i,r){const n=this.layers[0],a=n.layout,s=a.get("text-font"),o=a.get("text-field"),l=a.get("icon-image"),c=("constant"!==o.value.kind||o.value.value instanceof Xt&&!o.value.value.isEmpty()||o.value.value.toString().length>0)&&("constant"!==s.value.kind||s.value.value.length>0),d="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=a.get("symbol-sort-key");if(this.features=[],!c&&!d)return;const p=i.iconDependencies,u=i.glyphDependencies,m=i.availableImages,f=new zn(this.zoom);for(const{feature:i,id:o,index:l,sourceLayerIndex:g}of e){const e=n._featureFilter.needGeometry,_=Ps(i,e);if(!n._featureFilter.filter(f,_,r))continue;let v,y;if(e||(_.geometry=Ls(i)),c){const t=n.getValueAndResolveTokens("text-field",_,r,m),e=Xt.factory(t),i=this.hasRTLText=this.hasRTLText||sd(e);(!i||"unavailable"===Rn.getRTLTextPluginStatus()||i&&Rn.isParsed())&&(v=Kl(e,n,_))}if(d){const t=n.getValueAndResolveTokens("icon-image",_,r,m);y=t instanceof te?t:te.fromString(t)}if(!v&&!y)continue;const b=this.sortFeaturesByKey?h.evaluate(_,{},r):void 0;if(this.features.push({id:o,text:v,icon:y,index:l,sourceLayerIndex:g,geometry:_.geometry,properties:i.properties,type:id[i.type],sortKey:b}),y&&(p[y.name]=!0),v){const e=s.evaluate(_,{},r).join(","),i="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(t.ah.vertical)>=0;for(const t of v.sections)if(t.image)p[t.image.name]=!0;else{const r=Cn(v.toString()),n=t.fontStack||e,a=u[n]=u[n]||{};this.calculateGlyphDependencies(t.text,a,i,this.allowVerticalPlacement,r)}}}"line"===a.get("symbol-placement")&&(this.features=function(t){const e={},i={},r=[];let n=0;function a(e){r.push(t[e]),n++}function s(t,e,n){const a=i[t];return delete i[t],i[e]=a,r[a].geometry[0].pop(),r[a].geometry[0]=r[a].geometry[0].concat(n[0]),a}function o(t,i,n){const a=e[i];return delete e[i],e[t]=a,r[a].geometry[0].shift(),r[a].geometry[0]=n[0].concat(r[a].geometry[0]),a}function l(t,e,i){const r=i?e[0][e[0].length-1]:e[0][0];return`${t}:${r.x}:${r.y}`}for(let c=0;c<t.length;c++){const d=t[c],h=d.geometry,p=d.text?d.text.toString():null;if(!p){a(c);continue}const u=l(p,h),m=l(p,h,!0);if(u in i&&m in e&&i[u]!==e[m]){const t=o(u,m,h),n=s(u,m,r[t].geometry);delete e[u],delete i[m],i[l(p,r[n].geometry,!0)]=n,r[t].geometry=null}else u in i?s(u,m,h):m in e?o(u,m,h):(a(c),e[u]=n-1,i[m]=n-1)}return r.filter((t=>t.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((t,e)=>t.sortKey-e.sortKey))}update(t,e,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,i),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,i))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const i=this.lineVertexArray.length;if(void 0!==t.segment){let i=t.dist(e[t.segment+1]),r=t.dist(e[t.segment]);const n={};for(let r=t.segment+1;r<e.length;r++)n[r]={x:e[r].x,y:e[r].y,tileUnitDistanceFromAnchor:i},r<e.length-1&&(i+=e[r+1].dist(e[r]));for(let i=t.segment||0;i>=0;i--)n[i]={x:e[i].x,y:e[i].y,tileUnitDistanceFromAnchor:r},i>0&&(r+=e[i-1].dist(e[i]));for(let t=0;t<e.length;t++){const e=n[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(e,i,r,n,a,s,o,l,c,d,h,p){const u=e.indexArray,m=e.layoutVertexArray,f=e.segments.prepareSegment(4*i.length,m,u,this.canOverlap?s.sortKey:void 0),g=this.glyphOffsetArray.length,_=f.vertexLength,v=this.allowVerticalPlacement&&o===t.ah.vertical?Math.PI/2:0,y=s.text&&s.text.sections;for(let t=0;t<i.length;t++){const{tl:n,tr:a,bl:o,br:c,tex:d,pixelOffsetTL:h,pixelOffsetBR:g,minFontScaleX:_,minFontScaleY:b,glyphOffset:x,isSDF:w,sectionIndex:k}=i[t],T=f.vertexLength,S=x[1];nd(m,l.x,l.y,n.x,S+n.y,d.x,d.y,r,w,h.x,h.y,_,b),nd(m,l.x,l.y,a.x,S+a.y,d.x+d.w,d.y,r,w,g.x,h.y,_,b),nd(m,l.x,l.y,o.x,S+o.y,d.x,d.y+d.h,r,w,h.x,g.y,_,b),nd(m,l.x,l.y,c.x,S+c.y,d.x+d.w,d.y+d.h,r,w,g.x,g.y,_,b),ad(e.dynamicLayoutVertexArray,l,v),u.emplaceBack(T,T+1,T+2),u.emplaceBack(T+1,T+2,T+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(x[0]),t!==i.length-1&&k===i[t+1].sectionIndex||e.programConfigurations.populatePaintArrays(m.length,s,s.index,{},p,y&&y[k])}e.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,_,c,d,l.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],o,0,!1,0,h)}_addCollisionDebugVertex(t,e,i,r,n,a){return e.emplaceBack(0,0),t.emplaceBack(i.x,i.y,r,n,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(t,e,i,r,n,s,o){const l=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),c=l.vertexLength,d=n.layoutVertexArray,h=n.collisionVertexArray,p=o.anchorX,u=o.anchorY;this._addCollisionDebugVertex(d,h,s,p,u,new a(t,e)),this._addCollisionDebugVertex(d,h,s,p,u,new a(i,e)),this._addCollisionDebugVertex(d,h,s,p,u,new a(i,r)),this._addCollisionDebugVertex(d,h,s,p,u,new a(t,r)),l.vertexLength+=4;const m=n.indexArray;m.emplaceBack(c,c+1),m.emplaceBack(c+1,c+2),m.emplaceBack(c+2,c+3),m.emplaceBack(c+3,c),l.primitiveLength+=4}addDebugCollisionBoxes(t,e,i,r){for(let n=t;n<e;n++){const t=this.collisionBoxArray.get(n);this.addCollisionDebugVertices(t.x1,t.y1,t.x2,t.y2,r?this.textCollisionBox:this.iconCollisionBox,t.anchorPoint,i)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ld(Wa,Gl.members,Ka),this.iconCollisionBox=new ld(Wa,Gl.members,Ka);for(let t=0;t<this.symbolInstances.length;t++){const e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}}_deserializeCollisionBoxesForSymbol(t,e,i,r,n,a,s,o,l){const c={};for(let r=e;r<i;r++){const e=t.get(r);c.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.textFeatureIndex=e.featureIndex;break}for(let e=r;e<n;e++){const i=t.get(e);c.verticalTextBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},c.verticalTextFeatureIndex=i.featureIndex;break}for(let e=a;e<s;e++){const i=t.get(e);c.iconBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},c.iconFeatureIndex=i.featureIndex;break}for(let e=o;e<l;e++){const i=t.get(e);c.verticalIconBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},c.verticalIconFeatureIndex=i.featureIndex;break}return c}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const i=t.placedSymbolArray.get(e),r=i.vertexStartIndex+4*i.numGlyphs;for(let e=i.vertexStartIndex;e<r;e+=4)t.indexArray.emplaceBack(e,e+1,e+2),t.indexArray.emplaceBack(e+1,e+2,e+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),i=Math.cos(t),r=[],n=[],a=[];for(let t=0;t<this.symbolInstances.length;++t){a.push(t);const s=this.symbolInstances.get(t);r.push(0|Math.round(e*s.anchorX+i*s.anchorY)),n.push(s.featureIndex)}return a.sort(((t,e)=>r[t]-r[e]||n[e]-n[t])),a}addToSortKeyRanges(t,e){const i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===e?i.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach(((t,e,i)=>{t>=0&&i.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t)})),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let dd,hd;bn("SymbolBucket",cd,{omit:["layers","collisionBoxArray","features","compareText"]}),cd.MAX_GLYPHS=65535,cd.addDynamicAttributes=ad;var pd={get paint(){return hd=hd||new Gn({"icon-opacity":new Yn(Z.paint_symbol["icon-opacity"]),"icon-color":new Yn(Z.paint_symbol["icon-color"]),"icon-halo-color":new Yn(Z.paint_symbol["icon-halo-color"]),"icon-halo-width":new Yn(Z.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Yn(Z.paint_symbol["icon-halo-blur"]),"icon-translate":new Un(Z.paint_symbol["icon-translate"]),"icon-translate-anchor":new Un(Z.paint_symbol["icon-translate-anchor"]),"text-opacity":new Yn(Z.paint_symbol["text-opacity"]),"text-color":new Yn(Z.paint_symbol["text-color"],{runtimeType:pt,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new Yn(Z.paint_symbol["text-halo-color"]),"text-halo-width":new Yn(Z.paint_symbol["text-halo-width"]),"text-halo-blur":new Yn(Z.paint_symbol["text-halo-blur"]),"text-translate":new Un(Z.paint_symbol["text-translate"]),"text-translate-anchor":new Un(Z.paint_symbol["text-translate-anchor"])})},get layout(){return dd=dd||new Gn({"symbol-placement":new Un(Z.layout_symbol["symbol-placement"]),"symbol-spacing":new Un(Z.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Un(Z.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Yn(Z.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Un(Z.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Un(Z.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Un(Z.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Un(Z.layout_symbol["icon-ignore-placement"]),"icon-optional":new Un(Z.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Un(Z.layout_symbol["icon-rotation-alignment"]),"icon-size":new Yn(Z.layout_symbol["icon-size"]),"icon-text-fit":new Un(Z.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Un(Z.layout_symbol["icon-text-fit-padding"]),"icon-image":new Yn(Z.layout_symbol["icon-image"]),"icon-rotate":new Yn(Z.layout_symbol["icon-rotate"]),"icon-padding":new Yn(Z.layout_symbol["icon-padding"]),"icon-keep-upright":new Un(Z.layout_symbol["icon-keep-upright"]),"icon-offset":new Yn(Z.layout_symbol["icon-offset"]),"icon-anchor":new Yn(Z.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Un(Z.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Un(Z.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Un(Z.layout_symbol["text-rotation-alignment"]),"text-field":new Yn(Z.layout_symbol["text-field"]),"text-font":new Yn(Z.layout_symbol["text-font"]),"text-size":new Yn(Z.layout_symbol["text-size"]),"text-max-width":new Yn(Z.layout_symbol["text-max-width"]),"text-line-height":new Un(Z.layout_symbol["text-line-height"]),"text-letter-spacing":new Yn(Z.layout_symbol["text-letter-spacing"]),"text-justify":new Yn(Z.layout_symbol["text-justify"]),"text-radial-offset":new Yn(Z.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Un(Z.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Yn(Z.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Yn(Z.layout_symbol["text-anchor"]),"text-max-angle":new Un(Z.layout_symbol["text-max-angle"]),"text-writing-mode":new Un(Z.layout_symbol["text-writing-mode"]),"text-rotate":new Yn(Z.layout_symbol["text-rotate"]),"text-padding":new Un(Z.layout_symbol["text-padding"]),"text-keep-upright":new Un(Z.layout_symbol["text-keep-upright"]),"text-transform":new Yn(Z.layout_symbol["text-transform"]),"text-offset":new Yn(Z.layout_symbol["text-offset"]),"text-allow-overlap":new Un(Z.layout_symbol["text-allow-overlap"]),"text-overlap":new Un(Z.layout_symbol["text-overlap"]),"text-ignore-placement":new Un(Z.layout_symbol["text-ignore-placement"]),"text-optional":new Un(Z.layout_symbol["text-optional"])})}};class ud{constructor(t){if(void 0===t.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:lt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}bn("FormatSectionOverride",ud,{omit:["defaultValue"]});class md extends Kn{constructor(t){super(t,pd)}recalculate(t,e){if(super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const t=this.layout.get("text-writing-mode");if(t){const e=[];for(const i of t)e.indexOf(i)<0&&e.push(i);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,e,i,r){const n=this.layout.get(t).evaluate(e,{},i,r),a=this._unevaluatedLayout._values[t];return a.isDataDriven()||vr(a.value)||!n?n:function(t,e){return e.replace(/{([^{}]+)}/g,((e,i)=>t&&i in t?String(t[i]):""))}(e.properties,n)}createBucket(t){return new cd(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of pd.paint.overridableProperties){if(!md.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),i=new ud(e),r=new _r(i,e.property.specification);let n=null;n="constant"===e.value.kind||"source"===e.value.kind?new br("source",r):new xr("composite",r,e.value.zoomStops),this.paint._values[t]=new Hn(e.property,n,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,i){return!(!this.layout||e.isDataDriven()||i.isDataDriven())&&md.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const i=t.get("text-field"),r=pd.paint.properties[e];let n=!1;const a=t=>{for(const e of t)if(r.overrides&&r.overrides.hasOverride(e))return void(n=!0)};if("constant"===i.value.kind&&i.value.value instanceof Xt)a(i.value.value.sections);else if("source"===i.value.kind){const t=e=>{n||(e instanceof ae&&re(e.value)===gt?a(e.value.sections):e instanceof Ue?a(e.sections):e.eachChild(t))},e=i.value;e._styleExpression&&t(e._styleExpression.expression)}return n}}let fd;var gd={get paint(){return fd=fd||new Gn({"background-color":new Un(Z.paint_background["background-color"]),"background-pattern":new qn(Z.paint_background["background-pattern"]),"background-opacity":new Un(Z.paint_background["background-opacity"])})}};class _d extends Kn{constructor(t){super(t,gd)}}let vd;var yd={get paint(){return vd=vd||new Gn({"raster-opacity":new Un(Z.paint_raster["raster-opacity"]),"raster-hue-rotate":new Un(Z.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Un(Z.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Un(Z.paint_raster["raster-brightness-max"]),"raster-saturation":new Un(Z.paint_raster["raster-saturation"]),"raster-contrast":new Un(Z.paint_raster["raster-contrast"]),"raster-resampling":new Un(Z.paint_raster["raster-resampling"]),"raster-fade-duration":new Un(Z.paint_raster["raster-fade-duration"])})}};class bd extends Kn{constructor(t){super(t,yd)}}class xd extends Kn{constructor(t){super(t,{}),this.onAdd=t=>{this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},this.onRemove=t=>{this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class wd{constructor(t){this._methodToThrottle=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const kd=6371008.8;class Td{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Td(g(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,i=this.lat*e,r=t.lat*e,n=Math.sin(i)*Math.sin(r)+Math.cos(i)*Math.cos(r)*Math.cos((t.lng-this.lng)*e);return kd*Math.acos(Math.min(n,1))}static convert(t){if(t instanceof Td)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Td(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Td(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Sd=2*Math.PI*kd;function Cd(t){return Sd*Math.cos(t*Math.PI/180)}function Ed(t){return(180+t)/360}function $d(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Ad(t,e){return t/Cd(e)}function Id(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}class Md{constructor(t,e,i=0){this.x=+t,this.y=+e,this.z=+i}static fromLngLat(t,e=0){const i=Td.convert(t);return new Md(Ed(i.lng),$d(i.lat),Ad(e,i.lat))}toLngLat(){return new Td(360*this.x-180,Id(this.y))}toAltitude(){return this.z*Cd(Id(this.y))}meterInMercatorCoordinateUnits(){return 1/Sd*(t=Id(this.y),1/Math.cos(t*Math.PI/180));var t}}function Ld(t,e,i){var r=2*Math.PI*6378137/256/Math.pow(2,i);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}class Pd{constructor(t,e,i){if(t<0||t>25||i<0||i>=Math.pow(2,t)||e<0||e>=Math.pow(2,t))throw new Error(`x=${e}, y=${i}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=e,this.y=i,this.key=Dd(0,t,t,e,i)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e,i){const r=(a=this.y,s=this.z,o=Ld(256*(n=this.x),256*(a=Math.pow(2,s)-a-1),s),l=Ld(256*(n+1),256*(a+1),s),o[0]+","+o[1]+","+l[0]+","+l[1]);var n,a,s,o,l;const c=function(t,e,i){let r,n="";for(let a=t;a>0;a--)r=1<<a-1,n+=(e&r?1:0)+(i&r?2:0);return n}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,e>1?"@2x":"").replace(/{quadkey}/g,c).replace(/{bbox-epsg-3857}/g,r)}isChildOf(t){const e=this.z-t.z;return e>0&&t.x===this.x>>e&&t.y===this.y>>e}getTilePoint(t){const e=Math.pow(2,this.z);return new a((t.x*e-this.x)*As,(t.y*e-this.y)*As)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Rd{constructor(t,e){this.wrap=t,this.canonical=e,this.key=Dd(t,e.z,e.z,e.x,e.y)}}class zd{constructor(t,e,i,r,n){if(t<i)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${i}`);this.overscaledZ=t,this.wrap=e,this.canonical=new Pd(i,+r,+n),this.key=Dd(e,t,i,r,n)}clone(){return new zd(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const e=this.canonical.z-t;return t>this.canonical.z?new zd(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new zd(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-t;return t>this.canonical.z?Dd(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):Dd(this.wrap*+e,t,t,this.canonical.x>>i,this.canonical.y>>i)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new zd(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,i=2*this.canonical.x,r=2*this.canonical.y;return[new zd(e,this.wrap,e,i,r),new zd(e,this.wrap,e,i+1,r),new zd(e,this.wrap,e,i,r+1),new zd(e,this.wrap,e,i+1,r+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new zd(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new zd(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Rd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Md(t.x-this.wrap,t.y))}}function Dd(t,e,i,r,n){(t*=2)<0&&(t=-1*t-1);const a=1<<i;return(a*a*t+a*n+r).toString(36)+i.toString(36)+e.toString(36)}bn("CanonicalTileID",Pd),bn("OverscaledTileID",zd,{omit:["posMatrix"]});class jd{constructor(t,e,i,r=1,n=1,a=1,s=0){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(i&&!["mapbox","terrarium","custom"].includes(i))return void k(`"${i}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=e.height;const o=this.dim=e.height-2;switch(this.data=new Uint32Array(e.data.buffer),i){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=r,this.greenFactor=n,this.blueFactor=a,this.baseShift=s;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let t=0;t<o;t++)this.data[this._idx(-1,t)]=this.data[this._idx(0,t)],this.data[this._idx(o,t)]=this.data[this._idx(o-1,t)],this.data[this._idx(t,-1)]=this.data[this._idx(t,0)],this.data[this._idx(t,o)]=this.data[this._idx(t,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let t=0;t<o;t++)for(let e=0;e<o;e++){const i=this.get(t,e);i>this.max&&(this.max=i),i<this.min&&(this.min=i)}}get(t,e){const i=new Uint8Array(this.data.buffer),r=4*this._idx(t,e);return this.unpack(i[r],i[r+1],i[r+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}unpack(t,e,i){return t*this.redFactor+e*this.greenFactor+i*this.blueFactor-this.baseShift}getPixels(){return new go({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,i){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let r=e*this.dim,n=e*this.dim+this.dim,a=i*this.dim,s=i*this.dim+this.dim;switch(e){case-1:r=n-1;break;case 1:n=r+1}switch(i){case-1:a=s-1;break;case 1:s=a+1}const o=-e*this.dim,l=-i*this.dim;for(let e=a;e<s;e++)for(let i=r;i<n;i++)this.data[this._idx(i,e)]=t.data[this._idx(i+o,e+l)]}}bn("DEMData",jd);class Od{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const i=t[e];this._stringToNumber[i]=e,this._numberToString[e]=i}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Bd{constructor(t,e,i,r,n){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=i,t._y=r,this.properties=t.properties,this.id=n}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}class Fd{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new vn(As,16,0),this.grid3D=new vn(As,16,0),this.featureIndexArray=new ja,this.promoteId=e}insert(t,e,i,r,n,a){const s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,r,n);const o=a?this.grid3D:this.grid;for(let t=0;t<e.length;t++){const i=e[t],r=[1/0,1/0,-1/0,-1/0];for(let t=0;t<i.length;t++){const e=i[t];r[0]=Math.min(r[0],e.x),r[1]=Math.min(r[1],e.y),r[2]=Math.max(r[2],e.x),r[3]=Math.max(r[3],e.y)}r[0]<As&&r[1]<As&&r[2]>=0&&r[3]>=0&&o.insert(s,r[0],r[1],r[2],r[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ll.VectorTile(new wc(this.rawTileData)).layers,this.sourceLayerCoder=new Od(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,e,i,r){this.loadVTLayers();const n=t.params||{},s=As/t.tileSize/t.scale,o=Er(n.filter),l=t.queryGeometry,c=t.queryPadding*s,d=Hd(l),h=this.grid.query(d.minX-c,d.minY-c,d.maxX+c,d.maxY+c),p=Hd(t.cameraQueryGeometry),u=this.grid3D.query(p.minX-c,p.minY-c,p.maxX+c,p.maxY+c,((e,i,r,n)=>function(t,e,i,r,n){for(const a of t)if(e<=a.x&&i<=a.y&&r>=a.x&&n>=a.y)return!0;const s=[new a(e,i),new a(e,n),new a(r,n),new a(r,i)];if(t.length>2)for(const e of s)if(Ys(t,e))return!0;for(let e=0;e<t.length-1;e++)if(Zs(t[e],t[e+1],s))return!0;return!1}(t.cameraQueryGeometry,e-c,i-c,r+c,n+c)));for(const t of u)h.push(t);h.sort(Vd);const m={};let f;for(let a=0;a<h.length;a++){const c=h[a];if(c===f)continue;f=c;const d=this.featureIndexArray.get(c);let p=null;this.loadMatchingFeature(m,d.bucketIndex,d.sourceLayerIndex,d.featureIndex,o,n.layers,n.availableImages,e,i,r,((e,i,r)=>(p||(p=Ls(e)),i.queryIntersectsFeature(l,e,r,p,this.z,t.transform,s,t.pixelPosMatrix))))}return m}loadMatchingFeature(t,e,i,r,n,a,s,o,l,c,d){const h=this.bucketLayerIDs[e];if(a&&!function(t,e){for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>=0)return!0;return!1}(a,h))return;const p=this.sourceLayerCoder.decode(i),u=this.vtLayers[p].feature(r);if(n.needGeometry){const t=Ps(u,!0);if(!n.filter(new zn(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!n.filter(new zn(this.tileID.overscaledZ),u))return;const m=this.getId(u,p);for(let e=0;e<h.length;e++){const i=h[e];if(a&&a.indexOf(i)<0)continue;const n=o[i];if(!n)continue;let p={};m&&c&&(p=c.getState(n.sourceLayer||"_geojsonTileLayer",m));const f=_({},l[i]);f.paint=Nd(f.paint,n.paint,u,p,s),f.layout=Nd(f.layout,n.layout,u,p,s);const g=!d||d(u,n,p);if(!g)continue;const v=new Bd(u,this.z,this.x,this.y,m);v.layer=f;let y=t[i];void 0===y&&(y=t[i]=[]),y.push({featureIndex:r,feature:v,intersectionZ:g})}}lookupSymbolFeatures(t,e,i,r,n,a,s,o){const l={};this.loadVTLayers();const c=Er(n);for(const n of t)this.loadMatchingFeature(l,i,r,n,c,a,s,o,e);return l}hasLayer(t){for(const e of this.bucketLayerIDs)for(const i of e)if(t===i)return!0;return!1}getId(t,e){let i=t.id;return this.promoteId&&(i=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]],"boolean"==typeof i&&(i=Number(i))),i}}function Nd(t,e,i,r,n){return y(t,((t,a)=>{const s=e instanceof Vn?e.get(a):null;return s&&s.evaluate?s.evaluate(i,r,n):s}))}function Hd(t){let e=1/0,i=1/0,r=-1/0,n=-1/0;for(const a of t)e=Math.min(e,a.x),i=Math.min(i,a.y),r=Math.max(r,a.x),n=Math.max(n,a.y);return{minX:e,minY:i,maxX:r,maxY:n}}function Vd(t,e){return e-t}function Ud(t,e,i,r,n){const s=[];for(let o=0;o<t.length;o++){const l=t[o];let c;for(let t=0;t<l.length-1;t++){let o=l[t],d=l[t+1];o.x<e&&d.x<e||(o.x<e?o=new a(e,o.y+(e-o.x)/(d.x-o.x)*(d.y-o.y))._round():d.x<e&&(d=new a(e,o.y+(e-o.x)/(d.x-o.x)*(d.y-o.y))._round()),o.y<i&&d.y<i||(o.y<i?o=new a(o.x+(i-o.y)/(d.y-o.y)*(d.x-o.x),i)._round():d.y<i&&(d=new a(o.x+(i-o.y)/(d.y-o.y)*(d.x-o.x),i)._round()),o.x>=r&&d.x>=r||(o.x>=r?o=new a(r,o.y+(r-o.x)/(d.x-o.x)*(d.y-o.y))._round():d.x>=r&&(d=new a(r,o.y+(r-o.x)/(d.x-o.x)*(d.y-o.y))._round()),o.y>=n&&d.y>=n||(o.y>=n?o=new a(o.x+(n-o.y)/(d.y-o.y)*(d.x-o.x),n)._round():d.y>=n&&(d=new a(o.x+(n-o.y)/(d.y-o.y)*(d.x-o.x),n)._round()),c&&o.equals(c[c.length-1])||(c=[o],s.push(c)),c.push(d)))))}}return s}bn("FeatureIndex",Fd,{omit:["rawTileData","sourceLayerCoder"]});class Yd extends a{constructor(t,e,i,r){super(t,e),this.angle=i,void 0!==r&&(this.segment=r)}clone(){return new Yd(this.x,this.y,this.angle,this.segment)}}function Zd(t,e,i,r,n){if(void 0===e.segment||0===i)return!0;let a=e,s=e.segment+1,o=0;for(;o>-i/2;){if(s--,s<0)return!1;o-=t[s].dist(a),a=t[s]}o+=t[s].dist(t[s+1]),s++;const l=[];let c=0;for(;o<i/2;){const e=t[s],i=t[s+1];if(!i)return!1;let a=t[s-1].angleTo(e)-e.angleTo(i);for(a=Math.abs((a+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:o,angleDelta:a}),c+=a;o-l[0].distance>r;)c-=l.shift().angleDelta;if(c>n)return!1;s++,o+=e.dist(i)}return!0}function qd(t){let e=0;for(let i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function Wd(t,e,i){return t?.6*e*i:0}function Gd(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Xd(t,e,i,r,n,a){const s=Wd(i,n,a),o=Gd(i,r)*a;let l=0;const c=qd(t)/2;for(let i=0;i<t.length-1;i++){const r=t[i],n=t[i+1],a=r.dist(n);if(l+a>c){const d=(c-l)/a,h=Ae.number(r.x,n.x,d),p=Ae.number(r.y,n.y,d),u=new Yd(h,p,n.angleTo(r),i);return u._round(),!s||Zd(t,u,o,s,e)?u:void 0}l+=a}}function Kd(t,e,i,r,n,a,s,o,l){const c=Wd(r,a,s),d=Gd(r,n),h=d*s,p=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),Jd(t,p?e/2*o%e:(d/2+2*a)*s*o%e,e,c,i,h,p,!1,l)}function Jd(t,e,i,r,n,a,s,o,l){const c=a/2,d=qd(t);let h=0,p=e-i,u=[];for(let e=0;e<t.length-1;e++){const s=t[e],o=t[e+1],m=s.dist(o),f=o.angleTo(s);for(;p+i<h+m;){p+=i;const g=(p-h)/m,_=Ae.number(s.x,o.x,g),v=Ae.number(s.y,o.y,g);if(_>=0&&_<l&&v>=0&&v<l&&p-c>=0&&p+c<=d){const i=new Yd(_,v,f,e);i._round(),r&&!Zd(t,i,a,r,n)||u.push(i)}}h+=m}return o||u.length||s||(u=Jd(t,h/2,i,r,n,a,s,!0,l)),u}bn("Anchor",Yd);const Qd=Ac;function th(t,e,i,r){const n=[],s=t.image,o=s.pixelRatio,l=s.paddedRect.w-2*Qd,c=s.paddedRect.h-2*Qd;let d={x1:t.left,y1:t.top,x2:t.right,y2:t.bottom};const h=s.stretchX||[[0,l]],p=s.stretchY||[[0,c]],u=(t,e)=>t+e[1]-e[0],m=h.reduce(u,0),f=p.reduce(u,0),g=l-m,_=c-f;let v=0,y=m,b=0,x=f,w=0,k=g,T=0,S=_;if(s.content&&r){const e=s.content,i=e[2]-e[0],r=e[3]-e[1];(s.textFitWidth||s.textFitHeight)&&(d=Gc(t)),v=eh(h,0,e[0]),b=eh(p,0,e[1]),y=eh(h,e[0],e[2]),x=eh(p,e[1],e[3]),w=e[0]-v,T=e[1]-b,k=i-y,S=r-x}const C=d.x1,E=d.y1,$=d.x2-C,A=d.y2-E,I=(t,r,n,l)=>{const c=rh(t.stretch-v,y,$,C),d=nh(t.fixed-w,k,t.stretch,m),h=rh(r.stretch-b,x,A,E),p=nh(r.fixed-T,S,r.stretch,f),u=rh(n.stretch-v,y,$,C),g=nh(n.fixed-w,k,n.stretch,m),_=rh(l.stretch-b,x,A,E),I=nh(l.fixed-T,S,l.stretch,f),M=new a(c,h),L=new a(u,h),P=new a(u,_),R=new a(c,_),z=new a(d/o,p/o),D=new a(g/o,I/o),j=e*Math.PI/180;if(j){const t=Math.sin(j),e=Math.cos(j),i=[e,-t,t,e];M._matMult(i),L._matMult(i),R._matMult(i),P._matMult(i)}const O=t.stretch+t.fixed,B=r.stretch+r.fixed;return{tl:M,tr:L,bl:R,br:P,tex:{x:s.paddedRect.x+Qd+O,y:s.paddedRect.y+Qd+B,w:n.stretch+n.fixed-O,h:l.stretch+l.fixed-B},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:z,pixelOffsetBR:D,minFontScaleX:k/o/$,minFontScaleY:S/o/A,isSDF:i}};if(r&&(s.stretchX||s.stretchY)){const t=ih(h,g,m),e=ih(p,_,f);for(let i=0;i<t.length-1;i++){const r=t[i],a=t[i+1];for(let t=0;t<e.length-1;t++)n.push(I(r,e[t],a,e[t+1]))}}else n.push(I({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return n}function eh(t,e,i){let r=0;for(const n of t)r+=Math.max(e,Math.min(i,n[1]))-Math.max(e,Math.min(i,n[0]));return r}function ih(t,e,i){const r=[{fixed:-Qd,stretch:0}];for(const[e,i]of t){const t=r[r.length-1];r.push({fixed:e-t.stretch,stretch:t.stretch}),r.push({fixed:e-t.stretch,stretch:t.stretch+(i-e)})}return r.push({fixed:e+Qd,stretch:i}),r}function rh(t,e,i,r){return t/e*i+r}function nh(t,e,i,r){return t-e*i/r}class ah{constructor(t,e,i,r,n,s,o,l,c,d){var h;if(this.boxStartIndex=t.length,c){let t=s.top,e=s.bottom;const i=s.collisionPadding;i&&(t-=i[1],e+=i[3]);let r=e-t;r>0&&(r=Math.max(10,r),this.circleDiameter=r)}else{const c=(null===(h=s.image)||void 0===h?void 0:h.content)&&(s.image.textFitWidth||s.image.textFitHeight)?Gc(s):{x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};c.y1=c.y1*o-l[0],c.y2=c.y2*o+l[2],c.x1=c.x1*o-l[3],c.x2=c.x2*o+l[1];const p=s.collisionPadding;if(p&&(c.x1-=p[0]*o,c.y1-=p[1]*o,c.x2+=p[2]*o,c.y2+=p[3]*o),d){const t=new a(c.x1,c.y1),e=new a(c.x2,c.y1),i=new a(c.x1,c.y2),r=new a(c.x2,c.y2),n=d*Math.PI/180;t._rotate(n),e._rotate(n),i._rotate(n),r._rotate(n),c.x1=Math.min(t.x,e.x,i.x,r.x),c.x2=Math.max(t.x,e.x,i.x,r.x),c.y1=Math.min(t.y,e.y,i.y,r.y),c.y2=Math.max(t.y,e.y,i.y,r.y)}t.emplaceBack(e.x,e.y,c.x1,c.y1,c.x2,c.y2,i,r,n)}this.boxEndIndex=t.length}}class sh{constructor(t=[],e=oh){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:i}=this,r=e[t];for(;t>0;){const n=t-1>>1,a=e[n];if(i(r,a)>=0)break;e[t]=a,t=n}e[t]=r}_down(t){const{data:e,compare:i}=this,r=this.length>>1,n=e[t];for(;t<r;){let r=1+(t<<1),a=e[r];const s=r+1;if(s<this.length&&i(e[s],a)<0&&(r=s,a=e[s]),i(a,n)>=0)break;e[t]=a,t=r}e[t]=n}}function oh(t,e){return t<e?-1:t>e?1:0}function lh(t,e=1,i=!1){let r=1/0,n=1/0,s=-1/0,o=-1/0;const l=t[0];for(let t=0;t<l.length;t++){const e=l[t];(!t||e.x<r)&&(r=e.x),(!t||e.y<n)&&(n=e.y),(!t||e.x>s)&&(s=e.x),(!t||e.y>o)&&(o=e.y)}const c=Math.min(s-r,o-n);let d=c/2;const h=new sh([],ch);if(0===c)return new a(r,n);for(let e=r;e<s;e+=c)for(let i=n;i<o;i+=c)h.push(new dh(e+d,i+d,d,t));let p=function(t){let e=0,i=0,r=0;const n=t[0];for(let t=0,a=n.length,s=a-1;t<a;s=t++){const a=n[t],o=n[s],l=a.x*o.y-o.x*a.y;i+=(a.x+o.x)*l,r+=(a.y+o.y)*l,e+=3*l}return new dh(i/e,r/e,0,t)}(t),u=h.length;for(;h.length;){const r=h.pop();(r.d>p.d||!p.d)&&(p=r,i&&console.log("found best %d after %d probes",Math.round(1e4*r.d)/1e4,u)),r.max-p.d<=e||(d=r.h/2,h.push(new dh(r.p.x-d,r.p.y-d,d,t)),h.push(new dh(r.p.x+d,r.p.y-d,d,t)),h.push(new dh(r.p.x-d,r.p.y+d,d,t)),h.push(new dh(r.p.x+d,r.p.y+d,d,t)),u+=4)}return i&&(console.log(`num probes: ${u}`),console.log(`best distance: ${p.d}`)),p.p}function ch(t,e){return e.max-t.max}function dh(t,e,i,r){this.p=new a(t,e),this.h=i,this.d=function(t,e){let i=!1,r=1/0;for(let n=0;n<e.length;n++){const a=e[n];for(let e=0,n=a.length,s=n-1;e<n;s=e++){const n=a[e],o=a[s];n.y>t.y!=o.y>t.y&&t.x<(o.x-n.x)*(t.y-n.y)/(o.y-n.y)+n.x&&(i=!i),r=Math.min(r,Vs(t,n,o))}}return(i?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}var hh;t.aq=void 0,(hh=t.aq||(t.aq={}))[hh.center=1]="center",hh[hh.left=2]="left",hh[hh.right=3]="right",hh[hh.top=4]="top",hh[hh.bottom=5]="bottom",hh[hh["top-left"]=6]="top-left",hh[hh["top-right"]=7]="top-right",hh[hh["bottom-left"]=8]="bottom-left",hh[hh["bottom-right"]=9]="bottom-right";const ph=7,uh=Number.POSITIVE_INFINITY;function mh(t,e){return e[1]!==uh?function(t,e,i){let r=0,n=0;switch(e=Math.abs(e),i=Math.abs(i),t){case"top-right":case"top-left":case"top":n=i-ph;break;case"bottom-right":case"bottom-left":case"bottom":n=-i+ph}switch(t){case"top-right":case"bottom-right":case"right":r=-e;break;case"top-left":case"bottom-left":case"left":r=e}return[r,n]}(t,e[0],e[1]):function(t,e){let i=0,r=0;e<0&&(e=0);const n=e/Math.SQRT2;switch(t){case"top-right":case"top-left":r=n-ph;break;case"bottom-right":case"bottom-left":r=-n+ph;break;case"bottom":r=-e+ph;break;case"top":r=e-ph}switch(t){case"top-right":case"bottom-right":i=-n;break;case"top-left":case"bottom-left":i=n;break;case"left":i=e;break;case"right":i=-e}return[i,r]}(t,e[0])}function fh(t,e,i){var r;const n=t.layout,a=null===(r=n.get("text-variable-anchor-offset"))||void 0===r?void 0:r.evaluate(e,{},i);if(a){const t=a.values,e=[];for(let i=0;i<t.length;i+=2){const r=e[i]=t[i],n=t[i+1].map((t=>t*Ql));r.startsWith("top")?n[1]-=ph:r.startsWith("bottom")&&(n[1]+=ph),e[i+1]=n}return new Qt(e)}const s=n.get("text-variable-anchor");if(s){let r;r=void 0!==t._unevaluatedLayout.getValue("text-radial-offset")?[n.get("text-radial-offset").evaluate(e,{},i)*Ql,uh]:n.get("text-offset").evaluate(e,{},i).map((t=>t*Ql));const a=[];for(const t of s)a.push(t,mh(t,r));return new Qt(a)}return null}function gh(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function _h(e,i,r,n,a,s,o,l,c,d,h){let p=s.textMaxSize.evaluate(i,{});void 0===p&&(p=o);const u=e.layers[0].layout,m=u.get("icon-offset").evaluate(i,{},h),f=yh(r.horizontal),g=o/24,_=e.tilePixelRatio*g,v=e.tilePixelRatio*p/24,y=e.tilePixelRatio*l,b=e.tilePixelRatio*u.get("symbol-spacing"),x=u.get("text-padding")*e.tilePixelRatio,w=function(t,e,i,r=1){const n=t.get("icon-padding").evaluate(e,{},i),a=n&&n.values;return[a[0]*r,a[1]*r,a[2]*r,a[3]*r]}(u,i,h,e.tilePixelRatio),T=u.get("text-max-angle")/180*Math.PI,S="viewport"!==u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement"),C="map"===u.get("icon-rotation-alignment")&&"point"!==u.get("symbol-placement"),E=u.get("symbol-placement"),$=b/2,A=u.get("icon-text-fit");let I;n&&"none"!==A&&(e.allowVerticalPlacement&&r.vertical&&(I=Xc(n,r.vertical,A,u.get("icon-text-fit-padding"),m,g)),f&&(n=Xc(n,f,A,u.get("icon-text-fit-padding"),m,g)));const M=(l,p)=>{p.x<0||p.x>=As||p.y<0||p.y>=As||function(e,i,r,n,a,s,o,l,c,d,h,p,u,m,f,g,_,v,y,b,x,w,T,S,C){const E=e.addToLineVertexArray(i,r);let $,A,I,M,L=0,P=0,R=0,z=0,D=-1,j=-1;const O={};let B=cs("");if(e.allowVerticalPlacement&&n.vertical){const t=l.layout.get("text-rotate").evaluate(x,{},S)+90;I=new ah(c,i,d,h,p,n.vertical,u,m,f,t),o&&(M=new ah(c,i,d,h,p,o,_,v,f,t))}if(a){const r=l.layout.get("icon-rotate").evaluate(x,{}),n="none"!==l.layout.get("icon-text-fit"),s=th(a,r,T,n),u=o?th(o,r,T,n):void 0;A=new ah(c,i,d,h,p,a,_,v,!1,r),L=4*s.length;const m=e.iconSizeData;let f=null;"source"===m.kind?(f=[Jc*l.layout.get("icon-size").evaluate(x,{})],f[0]>Qc&&k(`${e.layerIds[0]}: Value for "icon-size" is >= ${Kc}. Reduce your "icon-size".`)):"composite"===m.kind&&(f=[Jc*w.compositeIconSizes[0].evaluate(x,{},S),Jc*w.compositeIconSizes[1].evaluate(x,{},S)],(f[0]>Qc||f[1]>Qc)&&k(`${e.layerIds[0]}: Value for "icon-size" is >= ${Kc}. Reduce your "icon-size".`)),e.addSymbols(e.icon,s,f,b,y,x,t.ah.none,i,E.lineStartIndex,E.lineLength,-1,S),D=e.icon.placedSymbolArray.length-1,u&&(P=4*u.length,e.addSymbols(e.icon,u,f,b,y,x,t.ah.vertical,i,E.lineStartIndex,E.lineLength,-1,S),j=e.icon.placedSymbolArray.length-1)}const F=Object.keys(n.horizontal);for(const r of F){const a=n.horizontal[r];if(!$){B=cs(a.text);const t=l.layout.get("text-rotate").evaluate(x,{},S);$=new ah(c,i,d,h,p,a,u,m,f,t)}const o=1===a.positionedLines.length;if(R+=vh(e,i,a,s,l,f,x,g,E,n.vertical?t.ah.horizontal:t.ah.horizontalOnly,o?F:[r],O,D,w,S),o)break}n.vertical&&(z+=vh(e,i,n.vertical,s,l,f,x,g,E,t.ah.vertical,["vertical"],O,j,w,S));const N=$?$.boxStartIndex:e.collisionBoxArray.length,H=$?$.boxEndIndex:e.collisionBoxArray.length,V=I?I.boxStartIndex:e.collisionBoxArray.length,U=I?I.boxEndIndex:e.collisionBoxArray.length,Y=A?A.boxStartIndex:e.collisionBoxArray.length,Z=A?A.boxEndIndex:e.collisionBoxArray.length,q=M?M.boxStartIndex:e.collisionBoxArray.length,W=M?M.boxEndIndex:e.collisionBoxArray.length;let G=-1;const X=(t,e)=>t&&t.circleDiameter?Math.max(t.circleDiameter,e):e;G=X($,G),G=X(I,G),G=X(A,G),G=X(M,G);const K=G>-1?1:0;K&&(G*=C/Ql),e.glyphOffsetArray.length>=cd.MAX_GLYPHS&&k("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,x.sortKey);const J=fh(l,x,S),[Q,tt]=function(e,i){const r=e.length,n=null==i?void 0:i.values;if((null==n?void 0:n.length)>0)for(let i=0;i<n.length;i+=2){const r=n[i+1];e.emplaceBack(t.aq[n[i]],r[0],r[1])}return[r,e.length]}(e.textAnchorOffsets,J);e.symbolInstances.emplaceBack(i.x,i.y,O.right>=0?O.right:-1,O.center>=0?O.center:-1,O.left>=0?O.left:-1,O.vertical||-1,D,j,B,N,H,V,U,Y,Z,q,W,d,R,z,L,P,K,0,u,G,Q,tt)}(e,p,l,r,n,a,I,e.layers[0],e.collisionBoxArray,i.index,i.sourceLayerIndex,e.index,_,[x,x,x,x],S,c,y,w,C,m,i,s,d,h,o)};if("line"===E)for(const t of Ud(i.geometry,0,0,As,As)){const i=Kd(t,b,T,r.vertical||f,n,24,v,e.overscaling,As);for(const r of i)f&&bh(e,f.text,$,r)||M(t,r)}else if("line-center"===E){for(const t of i.geometry)if(t.length>1){const e=Xd(t,T,r.vertical||f,n,24,v);e&&M(t,e)}}else if("Polygon"===i.type)for(const t of vi(i.geometry,0)){const e=lh(t,16);M(t[0],new Yd(e.x,e.y,0))}else if("LineString"===i.type)for(const t of i.geometry)M(t,new Yd(t[0].x,t[0].y,0));else if("Point"===i.type)for(const t of i.geometry)for(const e of t)M([e],new Yd(e.x,e.y,0))}function vh(t,e,i,r,n,s,o,l,c,d,h,p,u,m,f){const g=function(t,e,i,r,n,s,o,l){const c=r.layout.get("text-rotate").evaluate(s,{})*Math.PI/180,d=[];for(const t of e.positionedLines)for(const r of t.positionedGlyphs){if(!r.rect)continue;const s=r.rect||{};let h=Ec+1,p=!0,u=1,m=0;const f=(n||l)&&r.vertical,g=r.metrics.advance*r.scale/2;if(l&&e.verticalizable&&(m=t.lineOffset/2-(r.imageName?-(Ql-r.metrics.width*r.scale)/2:(r.scale-1)*Ql)),r.imageName){const t=o[r.imageName];p=t.sdf,u=t.pixelRatio,h=Ac/u}const _=n?[r.x+g,r.y]:[0,0];let v=n?[0,0]:[r.x+g+i[0],r.y+i[1]-m],y=[0,0];f&&(y=v,v=[0,0]);const b=r.metrics.isDoubleResolution?2:1,x=(r.metrics.left-h)*r.scale-g+v[0],w=(-r.metrics.top-h)*r.scale+v[1],k=x+s.w/b*r.scale/u,T=w+s.h/b*r.scale/u,S=new a(x,w),C=new a(k,w),E=new a(x,T),$=new a(k,T);if(f){const t=new a(-g,g-Pc),e=-Math.PI/2,i=Ql/2-g,n=new a(5-Pc-i,-(r.imageName?i:0)),s=new a(...y);S._rotateAround(e,t)._add(n)._add(s),C._rotateAround(e,t)._add(n)._add(s),E._rotateAround(e,t)._add(n)._add(s),$._rotateAround(e,t)._add(n)._add(s)}if(c){const t=Math.sin(c),e=Math.cos(c),i=[e,-t,t,e];S._matMult(i),C._matMult(i),E._matMult(i),$._matMult(i)}const A=new a(0,0),I=new a(0,0);d.push({tl:S,tr:C,bl:E,br:$,tex:s,writingMode:e.writingMode,glyphOffset:_,sectionIndex:r.sectionIndex,isSDF:p,pixelOffsetTL:A,pixelOffsetBR:I,minFontScaleX:0,minFontScaleY:0})}return d}(0,i,l,n,s,o,r,t.allowVerticalPlacement),_=t.textSizeData;let v=null;"source"===_.kind?(v=[Jc*n.layout.get("text-size").evaluate(o,{})],v[0]>Qc&&k(`${t.layerIds[0]}: Value for "text-size" is >= ${Kc}. Reduce your "text-size".`)):"composite"===_.kind&&(v=[Jc*m.compositeTextSizes[0].evaluate(o,{},f),Jc*m.compositeTextSizes[1].evaluate(o,{},f)],(v[0]>Qc||v[1]>Qc)&&k(`${t.layerIds[0]}: Value for "text-size" is >= ${Kc}. Reduce your "text-size".`)),t.addSymbols(t.text,g,v,l,s,o,d,e,c.lineStartIndex,c.lineLength,u,f);for(const e of h)p[e]=t.text.placedSymbolArray.length-1;return 4*g.length}function yh(t){for(const e in t)return t[e];return null}function bh(t,e,i,r){const n=t.compareText;if(e in n){const t=n[e];for(let e=t.length-1;e>=0;e--)if(r.dist(t[e])<i)return!0}else n[e]=[];return n[e].push(r),!1}const xh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class wh{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,i]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const r=i>>4;if(1!==r)throw new Error(`Got v${r} data when expected v1.`);const n=xh[15&i];if(!n)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(t,2,1),[s]=new Uint32Array(t,4,1);return new wh(s,a,n,t)}constructor(t,e=64,i=Float64Array,r){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=i,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const n=xh.indexOf(this.ArrayType),a=2*t*this.ArrayType.BYTES_PER_ELEMENT,s=t*this.IndexArrayType.BYTES_PER_ELEMENT,o=(8-s%8)%8;if(n<0)throw new Error(`Unexpected typed array class: ${i}.`);r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+o,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+a+s+o),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+o,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+n]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=t,this.coords[this._pos++]=e,i}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return kh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,i,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:a,nodeSize:s}=this,o=[0,n.length-1,0],l=[];for(;o.length;){const c=o.pop()||0,d=o.pop()||0,h=o.pop()||0;if(d-h<=s){for(let s=h;s<=d;s++){const o=a[2*s],c=a[2*s+1];o>=t&&o<=i&&c>=e&&c<=r&&l.push(n[s])}continue}const p=h+d>>1,u=a[2*p],m=a[2*p+1];u>=t&&u<=i&&m>=e&&m<=r&&l.push(n[p]),(0===c?t<=u:e<=m)&&(o.push(h),o.push(p-1),o.push(1-c)),(0===c?i>=u:r>=m)&&(o.push(p+1),o.push(d),o.push(1-c))}return l}within(t,e,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:n,nodeSize:a}=this,s=[0,r.length-1,0],o=[],l=i*i;for(;s.length;){const c=s.pop()||0,d=s.pop()||0,h=s.pop()||0;if(d-h<=a){for(let i=h;i<=d;i++)Eh(n[2*i],n[2*i+1],t,e)<=l&&o.push(r[i]);continue}const p=h+d>>1,u=n[2*p],m=n[2*p+1];Eh(u,m,t,e)<=l&&o.push(r[p]),(0===c?t-i<=u:e-i<=m)&&(s.push(h),s.push(p-1),s.push(1-c)),(0===c?t+i>=u:e+i>=m)&&(s.push(p+1),s.push(d),s.push(1-c))}return o}}function kh(t,e,i,r,n,a){if(n-r<=i)return;const s=r+n>>1;Th(t,e,s,r,n,a),kh(t,e,i,r,s-1,1-a),kh(t,e,i,s+1,n,1-a)}function Th(t,e,i,r,n,a){for(;n>r;){if(n-r>600){const s=n-r+1,o=i-r+1,l=Math.log(s),c=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*c*(s-c)/s)*(o-s/2<0?-1:1);Th(t,e,i,Math.max(r,Math.floor(i-o*c/s+d)),Math.min(n,Math.floor(i+(s-o)*c/s+d)),a)}const s=e[2*i+a];let o=r,l=n;for(Sh(t,e,r,i),e[2*n+a]>s&&Sh(t,e,r,n);o<l;){for(Sh(t,e,o,l),o++,l--;e[2*o+a]<s;)o++;for(;e[2*l+a]>s;)l--}e[2*r+a]===s?Sh(t,e,r,l):(l++,Sh(t,e,l,n)),l<=i&&(r=l+1),i<=l&&(n=l-1)}}function Sh(t,e,i,r){Ch(t,i,r),Ch(e,2*i,2*r),Ch(e,2*i+1,2*r+1)}function Ch(t,e,i){const r=t[e];t[e]=t[i],t[i]=r}function Eh(t,e,i,r){const n=t-i,a=e-r;return n*n+a*a}var $h;t.be=void 0,($h=t.be||(t.be={})).create="create",$h.load="load",$h.fullLoad="fullLoad";let Ah=null,Ih=[];const Mh=1e3/60,Lh="loadTime",Ph="fullLoadTime",Rh={mark(t){performance.mark(t)},frame(t){const e=t;null!=Ah&&Ih.push(e-Ah),Ah=e},clearMetrics(){Ah=null,Ih=[],performance.clearMeasures(Lh),performance.clearMeasures(Ph);for(const e in t.be)performance.clearMarks(t.be[e])},getPerformanceMetrics(){performance.measure(Lh,t.be.create,t.be.load),performance.measure(Ph,t.be.create,t.be.fullLoad);const e=performance.getEntriesByName(Lh)[0].duration,i=performance.getEntriesByName(Ph)[0].duration,r=Ih.length,n=1/(Ih.reduce(((t,e)=>t+e),0)/r/1e3),a=Ih.filter((t=>t>Mh)).reduce(((t,e)=>t+(e-Mh)/Mh),0);return{loadTime:e,fullLoadTime:i,fps:n,percentDroppedFrames:a/(r+a)*100,totalFrames:r}}};t.$=ts,t.A=to,t.B=function(t){if(null==C){const e=t.navigator?t.navigator.userAgent:null;C=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return C},t.C=class{constructor(t,e){this.target=t,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new wd((()=>this.process())),this.subscription=function(t,e,i,r){return t.addEventListener(e,i,!1),{unsubscribe:()=>{t.removeEventListener(e,i,!1)}}}(this.target,"message",(t=>this.receive(t))),this.globalScope=S(self)?t:window}registerMessageHandler(t,e){this.messageHandlers[t]=e}sendAsync(t,e){return new Promise(((i,r)=>{const n=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[n]={resolve:i,reject:r},e&&e.signal.addEventListener("abort",(()=>{delete this.resolveRejects[n];const e={id:n,type:"<cancel>",origin:location.origin,targetMapId:t.targetMapId,sourceMapId:this.mapId};this.target.postMessage(e)}),{once:!0});const a=[],s=Object.assign(Object.assign({},t),{id:n,sourceMapId:this.mapId,origin:location.origin,data:wn(t.data,a)});this.target.postMessage(s,{transfer:a})}))}receive(t){const e=t.data,i=e.id;if(!("file://"!==e.origin&&"file://"!==location.origin&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if("<cancel>"===e.type){delete this.tasks[i];const t=this.abortControllers[i];return delete this.abortControllers[i],void(t&&t.abort())}if(S(self)||e.mustQueue)return this.tasks[i]=e,this.taskQueue.push(i),void this.invoker.trigger();this.processTask(i,e)}}process(){if(0===this.taskQueue.length)return;const t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(t,e)}processTask(t,i){return e(this,void 0,void 0,(function*(){if("<response>"===i.type){const e=this.resolveRejects[t];if(delete this.resolveRejects[t],!e)return;return void(i.error?e.reject(kn(i.error)):e.resolve(kn(i.data)))}if(!this.messageHandlers[i.type])return void this.completeTask(t,new Error(`Could not find a registered handler for ${i.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const e=kn(i.data),r=new AbortController;this.abortControllers[t]=r;try{const n=yield this.messageHandlers[i.type](i.sourceMapId,e,r);this.completeTask(t,null,n)}catch(e){this.completeTask(t,e)}}))}completeTask(t,e,i){const r=[];delete this.abortControllers[t];const n={id:t,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?wn(e):null,data:wn(i,r)};this.target.postMessage(n,{transfer:r})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},t.D=Un,t.E=Y,t.F=function(){var t=new to(16);return to!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.G=D,t.H=function(t,e,i){var r,n,a,s,o,l,c,d,h,p,u,m,f=i[0],g=i[1],_=i[2];return e===t?(t[12]=e[0]*f+e[4]*g+e[8]*_+e[12],t[13]=e[1]*f+e[5]*g+e[9]*_+e[13],t[14]=e[2]*f+e[6]*g+e[10]*_+e[14],t[15]=e[3]*f+e[7]*g+e[11]*_+e[15]):(n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],c=e[6],d=e[7],h=e[8],p=e[9],u=e[10],m=e[11],t[0]=r=e[0],t[1]=n,t[2]=a,t[3]=s,t[4]=o,t[5]=l,t[6]=c,t[7]=d,t[8]=h,t[9]=p,t[10]=u,t[11]=m,t[12]=r*f+o*g+h*_+e[12],t[13]=n*f+l*g+p*_+e[13],t[14]=a*f+c*g+u*_+e[14],t[15]=s*f+d*g+m*_+e[15]),t},t.I=Ic,t.J=function(t,e,i){var r=i[0],n=i[1],a=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.K=io,t.L=function(t,e){const i={};for(let r=0;r<e.length;r++){const n=e[r];n in t&&(i[n]=t[n])}return i},t.M=Td,t.N=Ed,t.O=$d,t.P=a,t.Q=zd,t.R=go,t.S=h,t.T=On,t.U=p,t.V=A,t.W=As,t.X=ea,t.Y=Md,t.Z=class extends aa{},t._=e,t.a=R,t.a$=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.a0=Pd,t.a1=nt,t.a2=t=>{const e=window.document.createElement("video");return e.muted=!0,new Promise((i=>{e.onloadstart=()=>{i(e)};for(const i of t){const t=window.document.createElement("source");F(i)||(e.crossOrigin="Anonymous"),t.src=i,e.appendChild(t)}}))},t.a3=function(){return v++},t.a4=Ea,t.a5=cd,t.a6=Er,t.a7=Ps,t.a8=zn,t.a9=Bd,t.aA=function(t){if("custom"===t.type)return new xd(t);switch(t.type){case"background":return new _d(t);case"circle":return new so(t);case"fill":return new nl(t);case"fill-extrusion":return new $l(t);case"heatmap":return new vo(t);case"hillshade":return new xo(t);case"line":return new Ul(t);case"raster":return new bd(t);case"symbol":return new md(t)}},t.aB=x,t.aC=function(t,e){if(!t)return[{command:"setStyle",args:[e]}];let i=[];try{if(!G(t.version,e.version))return[{command:"setStyle",args:[e]}];G(t.center,e.center)||i.push({command:"setCenter",args:[e.center]}),G(t.zoom,e.zoom)||i.push({command:"setZoom",args:[e.zoom]}),G(t.bearing,e.bearing)||i.push({command:"setBearing",args:[e.bearing]}),G(t.pitch,e.pitch)||i.push({command:"setPitch",args:[e.pitch]}),G(t.sprite,e.sprite)||i.push({command:"setSprite",args:[e.sprite]}),G(t.glyphs,e.glyphs)||i.push({command:"setGlyphs",args:[e.glyphs]}),G(t.transition,e.transition)||i.push({command:"setTransition",args:[e.transition]}),G(t.light,e.light)||i.push({command:"setLight",args:[e.light]}),G(t.terrain,e.terrain)||i.push({command:"setTerrain",args:[e.terrain]}),G(t.sky,e.sky)||i.push({command:"setSky",args:[e.sky]}),G(t.projection,e.projection)||i.push({command:"setProjection",args:[e.projection]});const r={},n=[];!function(t,e,i,r){let n;for(n in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,n)&&(Object.prototype.hasOwnProperty.call(e,n)||J(n,i,r));for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(Object.prototype.hasOwnProperty.call(t,n)?G(t[n],e[n])||("geojson"===t[n].type&&"geojson"===e[n].type&&tt(t,e,n)?X(i,{command:"setGeoJSONSourceData",args:[n,e[n].data]}):Q(n,e,i,r)):K(n,e,i))}(t.sources,e.sources,n,r);const a=[];t.layers&&t.layers.forEach((t=>{"source"in t&&r[t.source]?i.push({command:"removeLayer",args:[t.id]}):a.push(t)})),i=i.concat(n),function(t,e,i){e=e||[];const r=(t=t||[]).map(it),n=e.map(it),a=t.reduce(rt,{}),s=e.reduce(rt,{}),o=r.slice(),l=Object.create(null);let c,d,h,p,u;for(let t=0,e=0;t<r.length;t++)c=r[t],Object.prototype.hasOwnProperty.call(s,c)?e++:(X(i,{command:"removeLayer",args:[c]}),o.splice(o.indexOf(c,e),1));for(let t=0,e=0;t<n.length;t++)c=n[n.length-1-t],o[o.length-1-t]!==c&&(Object.prototype.hasOwnProperty.call(a,c)?(X(i,{command:"removeLayer",args:[c]}),o.splice(o.lastIndexOf(c,o.length-e),1)):e++,p=o[o.length-t],X(i,{command:"addLayer",args:[s[c],p]}),o.splice(o.length-t,0,c),l[c]=!0);for(let t=0;t<n.length;t++)if(c=n[t],d=a[c],h=s[c],!l[c]&&!G(d,h))if(G(d.source,h.source)&&G(d["source-layer"],h["source-layer"])&&G(d.type,h.type)){for(u in et(d.layout,h.layout,i,c,null,"setLayoutProperty"),et(d.paint,h.paint,i,c,null,"setPaintProperty"),G(d.filter,h.filter)||X(i,{command:"setFilter",args:[c,h.filter]}),G(d.minzoom,h.minzoom)&&G(d.maxzoom,h.maxzoom)||X(i,{command:"setLayerZoomRange",args:[c,h.minzoom,h.maxzoom]}),d)Object.prototype.hasOwnProperty.call(d,u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?et(d[u],h[u],i,c,u.slice(6),"setPaintProperty"):G(d[u],h[u])||X(i,{command:"setLayerProperty",args:[c,u,h[u]]}));for(u in h)Object.prototype.hasOwnProperty.call(h,u)&&!Object.prototype.hasOwnProperty.call(d,u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?et(d[u],h[u],i,c,u.slice(6),"setPaintProperty"):G(d[u],h[u])||X(i,{command:"setLayerProperty",args:[c,u,h[u]]}))}else X(i,{command:"removeLayer",args:[c]}),p=o[o.lastIndexOf(c)+1],X(i,{command:"addLayer",args:[h,p]})}(a,e.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:"setStyle",args:[e]}]}return i},t.aD=function(t){const e=[],i=t.id;return void 0===i&&e.push({message:`layers.${i}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${i}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},t.aE=function t(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(let r=0;r<e.length;r++)if(!t(e[r],i[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==i){if("object"!=typeof i)return!1;if(Object.keys(e).length!==Object.keys(i).length)return!1;for(const r in e)if(!t(e[r],i[r]))return!1;return!0}return e===i},t.aF=y,t.aG=b,t.aH=class extends ms{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},t.aI=fs,t.aJ=class extends ms{constructor(t,e){super(t,e),this.current=vs}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},t.aK=gs,t.aL=class extends ms{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},t.aM=class extends ms{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},t.aN=_s,t.aO=function(t,e,i,r,n,a,s){var o=1/(e-i),l=1/(r-n),c=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*o,t[13]=(n+r)*l,t[14]=(s+a)*c,t[15]=1,t},t.aP=qt,t.aQ=no,t.aR=class extends fa{},t.aS=Xl,t.aT=class extends _a{},t.aU=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},t.aV=_o,t.aW=Oa,t.aX=class extends Ta{},t.aY=Xa,t.aZ=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},t.a_=function(t,e){var i=t[0],r=t[1],n=t[2],a=t[3],s=t[4],o=t[5],l=t[6],c=t[7],d=t[8],h=t[9],p=t[10],u=t[11],m=t[12],f=t[13],g=t[14],_=t[15],v=e[0],y=e[1],b=e[2],x=e[3],w=e[4],k=e[5],T=e[6],S=e[7],C=e[8],E=e[9],$=e[10],A=e[11],I=e[12],M=e[13],L=e[14],P=e[15];return Math.abs(i-v)<=Qs*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(r-y)<=Qs*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(n-b)<=Qs*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(a-x)<=Qs*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(s-w)<=Qs*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(o-k)<=Qs*Math.max(1,Math.abs(o),Math.abs(k))&&Math.abs(l-T)<=Qs*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-S)<=Qs*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(d-C)<=Qs*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(h-E)<=Qs*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(p-$)<=Qs*Math.max(1,Math.abs(p),Math.abs($))&&Math.abs(u-A)<=Qs*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(m-I)<=Qs*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(f-M)<=Qs*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(g-L)<=Qs*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(_-P)<=Qs*Math.max(1,Math.abs(_),Math.abs(P))},t.aa=function(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((t,i,r,n)=>{const a=r||n;return e[i]=!a||a.toLowerCase(),""})),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e},t.ab=function(t,e){const i=[];for(const r in t)r in e||i.push(r);return i},t.ac=f,t.ad=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),a=e[0],s=e[1],o=e[2],l=e[3],c=e[4],d=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n+c*r,t[1]=s*n+d*r,t[2]=o*n+h*r,t[3]=l*n+p*r,t[4]=c*n-a*r,t[5]=d*n-s*r,t[6]=h*n-o*r,t[7]=p*n-l*r,t},t.ae=function(t){var e=new to(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.af=ao,t.ag=function(t,e){let i=0,r=0;if("constant"===t.kind)r=t.layoutSize;else if("source"!==t.kind){const{interpolationType:n,minZoom:a,maxZoom:s}=t,o=n?f(Ie.interpolationFactor(n,e,a,s),0,1):0;"camera"===t.kind?r=Ae.number(t.minSize,t.maxSize,o):i=o}return{uSizeT:i,uSize:r}},t.ai=function(t,{uSize:e,uSizeT:i},{lowerSize:r,upperSize:n}){return"source"===t.kind?r/Jc:"composite"===t.kind?Ae.number(r/Jc,n/Jc,i):e},t.aj=ad,t.ak=function(t,e,i,r){const n=e.y-t.y,s=e.x-t.x,o=r.y-i.y,l=r.x-i.x,c=o*s-l*n;if(0===c)return null;const d=(l*(t.y-i.y)-o*(t.x-i.x))/c;return new a(t.x+d*s,t.y+d*n)},t.al=Ud,t.am=Ds,t.an=eo,t.ao=function(t){let e=1/0,i=1/0,r=-1/0,n=-1/0;for(const a of t)e=Math.min(e,a.x),i=Math.min(i,a.y),r=Math.max(r,a.x),n=Math.max(n,a.y);return[e,i,r,n]},t.ap=Ql,t.ar=ed,t.as=function(t,e){var i=e[0],r=e[1],n=e[2],a=e[3],s=e[4],o=e[5],l=e[6],c=e[7],d=e[8],h=e[9],p=e[10],u=e[11],m=e[12],f=e[13],g=e[14],_=e[15],v=i*o-r*s,y=i*l-n*s,b=i*c-a*s,x=r*l-n*o,w=r*c-a*o,k=n*c-a*l,T=d*f-h*m,S=d*g-p*m,C=d*_-u*m,E=h*g-p*f,$=h*_-u*f,A=p*_-u*g,I=v*A-y*$+b*E+x*C-w*S+k*T;return I?(t[0]=(o*A-l*$+c*E)*(I=1/I),t[1]=(n*$-r*A-a*E)*I,t[2]=(f*k-g*w+_*x)*I,t[3]=(p*w-h*k-u*x)*I,t[4]=(l*C-s*A-c*S)*I,t[5]=(i*A-n*C+a*S)*I,t[6]=(g*b-m*k-_*y)*I,t[7]=(d*k-p*b+u*y)*I,t[8]=(s*$-o*C+c*T)*I,t[9]=(r*C-i*$-a*T)*I,t[10]=(m*w-f*b+_*v)*I,t[11]=(h*b-d*w-u*v)*I,t[12]=(o*S-s*E-l*T)*I,t[13]=(i*E-r*S+n*T)*I,t[14]=(f*y-m*x-g*v)*I,t[15]=(d*x-h*y+p*v)*I,t):null},t.at=gh,t.au=Zc,t.av=wh,t.aw=function(){const t={},e=Z.$version;for(const i in Z.$root){const r=Z.$root[i];if(r.required){let n=null;n="version"===i?e:"array"===r.type?[]:{},null!=n&&(t[i]=n)}}return t},t.ax=Tn,t.ay=O,t.az=function(t){t=t.slice();const e=Object.create(null);for(let i=0;i<t.length;i++)e[t[i].id]=t[i];for(let i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=W(t[i],e[t[i].ref]));return t},t.b=E,t.b0=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t},t.b1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.b2=g,t.b3=Rd,t.b4=Ad,t.b5=function(t,e,i,r,n){var a,s=1/Math.tan(e/2);return t[0]=s/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(t[10]=(n+r)*(a=1/(r-n)),t[14]=2*n*r*a):(t[10]=-1,t[14]=-2*r),t},t.b6=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),a=e[4],s=e[5],o=e[6],l=e[7],c=e[8],d=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*n+c*r,t[5]=s*n+d*r,t[6]=o*n+h*r,t[7]=l*n+p*r,t[8]=c*n-a*r,t[9]=d*n-s*r,t[10]=h*n-o*r,t[11]=p*n-l*r,t},t.b7=u,t.b8=m,t.b9=function(t){return t*Math.PI/180},t.bA=yr,t.bB=Rn,t.ba=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.bb=class extends na{},t.bc=kd,t.bd=Rh,t.bf=j,t.bg=function(t,e){R.REGISTERED_PROTOCOLS[t]=e},t.bh=function(t){delete R.REGISTERED_PROTOCOLS[t]},t.bi=function(t,e){const i={};for(let r=0;r<t.length;r++){const n=e&&e[t[r].id]||Dr(t[r]);e&&(e[t[r].id]=n);let a=i[n];a||(a=i[n]=[]),a.push(t[r])}const r=[];for(const t in i)r.push(i[t]);return r},t.bj=bn,t.bk=Od,t.bl=Fd,t.bm=Mc,t.bn=function(e){e.bucket.createArrays(),e.bucket.tilePixelRatio=As/(512*e.bucket.overscaling),e.bucket.compareText={},e.bucket.iconsNeedLinear=!1;const i=e.bucket.layers[0],r=i.layout,n=i._unevaluatedLayout._values,a={layoutIconSize:n["icon-size"].possiblyEvaluate(new zn(e.bucket.zoom+1),e.canonical),layoutTextSize:n["text-size"].possiblyEvaluate(new zn(e.bucket.zoom+1),e.canonical),textMaxSize:n["text-size"].possiblyEvaluate(new zn(18))};if("composite"===e.bucket.textSizeData.kind){const{minZoom:t,maxZoom:i}=e.bucket.textSizeData;a.compositeTextSizes=[n["text-size"].possiblyEvaluate(new zn(t),e.canonical),n["text-size"].possiblyEvaluate(new zn(i),e.canonical)]}if("composite"===e.bucket.iconSizeData.kind){const{minZoom:t,maxZoom:i}=e.bucket.iconSizeData;a.compositeIconSizes=[n["icon-size"].possiblyEvaluate(new zn(t),e.canonical),n["icon-size"].possiblyEvaluate(new zn(i),e.canonical)]}const s=r.get("text-line-height")*Ql,o="viewport"!==r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement"),l=r.get("text-keep-upright"),c=r.get("text-size");for(const n of e.bucket.features){const d=r.get("text-font").evaluate(n,{},e.canonical).join(","),h=c.evaluate(n,{},e.canonical),p=a.layoutTextSize.evaluate(n,{},e.canonical),u=a.layoutIconSize.evaluate(n,{},e.canonical),m={horizontal:{},vertical:void 0},f=n.text;let g,_=[0,0];if(f){const a=f.toString(),c=r.get("text-letter-spacing").evaluate(n,{},e.canonical)*Ql,u=En(a)?c:0,g=r.get("text-anchor").evaluate(n,{},e.canonical),v=fh(i,n,e.canonical);if(!v){const t=r.get("text-radial-offset").evaluate(n,{},e.canonical);_=t?mh(g,[t*Ql,uh]):r.get("text-offset").evaluate(n,{},e.canonical).map((t=>t*Ql))}let y=o?"center":r.get("text-justify").evaluate(n,{},e.canonical);const b="point"===r.get("symbol-placement")?r.get("text-max-width").evaluate(n,{},e.canonical)*Ql:1/0,x=()=>{e.bucket.allowVerticalPlacement&&Cn(a)&&(m.vertical=Dc(f,e.glyphMap,e.glyphPositions,e.imagePositions,d,b,s,g,"left",u,_,t.ah.vertical,!0,p,h))};if(!o&&v){const i=new Set;if("auto"===y)for(let t=0;t<v.values.length;t+=2)i.add(gh(v.values[t]));else i.add(y);let r=!1;for(const n of i)if(!m.horizontal[n])if(r)m.horizontal[n]=m.horizontal[0];else{const i=Dc(f,e.glyphMap,e.glyphPositions,e.imagePositions,d,b,s,"center",n,u,_,t.ah.horizontal,!1,p,h);i&&(m.horizontal[n]=i,r=1===i.positionedLines.length)}x()}else{"auto"===y&&(y=gh(g));const i=Dc(f,e.glyphMap,e.glyphPositions,e.imagePositions,d,b,s,g,y,u,_,t.ah.horizontal,!1,p,h);i&&(m.horizontal[y]=i),x(),Cn(a)&&o&&l&&(m.vertical=Dc(f,e.glyphMap,e.glyphPositions,e.imagePositions,d,b,s,g,y,u,_,t.ah.vertical,!1,p,h))}}let v=!1;if(n.icon&&n.icon.name){const t=e.imageMap[n.icon.name];t&&(g=Wc(e.imagePositions[n.icon.name],r.get("icon-offset").evaluate(n,{},e.canonical),r.get("icon-anchor").evaluate(n,{},e.canonical)),v=!!t.sdf,void 0===e.bucket.sdfIcons?e.bucket.sdfIcons=v:e.bucket.sdfIcons!==v&&k("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(t.pixelRatio!==e.bucket.pixelRatio||0!==r.get("icon-rotate").constantOr(1))&&(e.bucket.iconsNeedLinear=!0))}const y=yh(m.horizontal)||m.vertical;e.bucket.iconsInText=!!y&&y.iconsInText,(y||g)&&_h(e.bucket,n,m,g,e.imageMap,a,p,u,_,v,e.canonical)}e.showCollisionBoxes&&e.bucket.generateCollisionDebugBuffers()},t.bo=Ol,t.bp=tl,t.bq=kl,t.br=ll,t.bs=wc,t.bt=class{constructor(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let t=performance.getEntriesByName(this._marks.measure);return 0===t.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),t=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),t}},t.bu=function(t,i,r,n,a){return e(this,void 0,void 0,(function*(){if(p())try{return yield A(t,i,r,n,a)}catch(t){}return function(t,e,i,r,n){const a=t.width,s=t.height;I&&M||(I=new OffscreenCanvas(a,s),M=I.getContext("2d",{willReadFrequently:!0})),I.width=a,I.height=s,M.drawImage(t,0,0,a,s);const o=M.getImageData(e,i,r,n);return M.clearRect(0,0,a,s),o.data}(t,i,r,n,a)}))},t.bv=jd,t.bw=i,t.bx=r,t.by=tc,t.bz=function(t){return t.message===L},t.c=P,t.d=t=>e(void 0,void 0,void 0,(function*(){if(0===t.byteLength)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(t)],{type:"image/png"});try{return createImageBitmap(e)}catch(t){throw new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),t.e=_,t.f=t=>new Promise(((e,i)=>{const r=new Image;r.onload=()=>{e(r),URL.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame((()=>{r.src=$}))},r.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const n=new Blob([new Uint8Array(t)],{type:"image/png"});r.src=t.byteLength?URL.createObjectURL(n):$})),t.g=z,t.h=(t,e)=>B(_(t,{type:"json"}),e),t.i=S,t.j=U,t.k=V,t.l=(t,e)=>B(_(t,{type:"arrayBuffer"}),e),t.m=B,t.n=function(t){return new wc(t).readFields(Tc,[])},t.o=fo,t.p=$c,t.q=Gn,t.r=mn,t.s=F,t.t=_n,t.u=Sn,t.v=Z,t.w=k,t.x=un,t.y=function([t,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:t*Math.cos(e)*Math.sin(i),y:t*Math.sin(e)*Math.sin(i),z:t*Math.cos(i)}},t.z=Ae})),i("worker",0,(function(t){class e{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(e,i){for(const i of e){this._layerConfigs[i.id]=i;const e=this._layers[i.id]=t.aA(i);e._featureFilter=t.a6(e.filter),this.keyCache[i.id]&&delete this.keyCache[i.id]}for(const t of i)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const r=t.bi(Object.values(this._layerConfigs),this.keyCache);for(const t of r){const e=t.map((t=>this._layers[t.id])),i=e[0];if("none"===i.visibility)continue;const r=i.source||"";let n=this.familiesBySource[r];n||(n=this.familiesBySource[r]={});const a=i.sourceLayer||"_geojsonTileLayer";let s=n[a];s||(s=n[a]=[]),s.push(e)}}}class i{constructor(e){const i={},r=[];for(const t in e){const n=e[t],a=i[t]={};for(const t in n){const e=n[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const i={x:0,y:0,w:e.bitmap.width+2,h:e.bitmap.height+2};r.push(i),a[t]={rect:i,metrics:e.metrics}}}const{w:n,h:a}=t.p(r),s=new t.o({width:n||1,height:a||1});for(const r in e){const n=e[r];for(const e in n){const a=n[+e];if(!a||0===a.bitmap.width||0===a.bitmap.height)continue;const o=i[r][e].rect;t.o.copy(a.bitmap,s,{x:0,y:0},{x:o.x+1,y:o.y+1},a.bitmap)}}this.image=s,this.positions=i}}t.bj("GlyphAtlas",i);class r{constructor(e){this.tileID=new t.Q(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.inFlightDependencies=[]}parse(e,r,a,s){return t._(this,void 0,void 0,(function*(){this.status="parsing",this.data=e,this.collisionBoxArray=new t.a4;const o=new t.bk(Object.keys(e.layers).sort()),l=new t.bl(this.tileID,this.promoteId);l.bucketLayerIDs=[];const c={},d={featureIndex:l,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:a},h=r.familiesBySource[this.source];for(const i in h){const r=e.layers[i];if(!r)continue;1===r.version&&t.w(`Vector tile source "${this.source}" layer "${i}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const s=o.encode(i),p=[];for(let t=0;t<r.length;t++){const e=r.feature(t),n=l.getId(e,i);p.push({feature:e,id:n,index:t,sourceLayerIndex:s})}for(const e of h[i]){const i=e[0];i.source!==this.source&&t.w(`layer.source = ${i.source} does not equal this.source = ${this.source}`),i.minzoom&&this.zoom<Math.floor(i.minzoom)||i.maxzoom&&this.zoom>=i.maxzoom||"none"!==i.visibility&&(n(e,this.zoom,a),(c[i.id]=i.createBucket({index:l.bucketLayerIDs.length,layers:e,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:s,sourceID:this.source})).populate(p,d,this.tileID.canonical),l.bucketLayerIDs.push(e.map((t=>t.id))))}}const p=t.aF(d.glyphDependencies,(t=>Object.keys(t).map(Number)));this.inFlightDependencies.forEach((t=>null==t?void 0:t.abort())),this.inFlightDependencies=[];let u=Promise.resolve({});if(Object.keys(p).length){const t=new AbortController;this.inFlightDependencies.push(t),u=s.sendAsync({type:"GG",data:{stacks:p,source:this.source,tileID:this.tileID,type:"glyphs"}},t)}const m=Object.keys(d.iconDependencies);let f=Promise.resolve({});if(m.length){const t=new AbortController;this.inFlightDependencies.push(t),f=s.sendAsync({type:"GI",data:{icons:m,source:this.source,tileID:this.tileID,type:"icons"}},t)}const g=Object.keys(d.patternDependencies);let _=Promise.resolve({});if(g.length){const t=new AbortController;this.inFlightDependencies.push(t),_=s.sendAsync({type:"GI",data:{icons:g,source:this.source,tileID:this.tileID,type:"patterns"}},t)}const[v,y,b]=yield Promise.all([u,f,_]),x=new i(v),w=new t.bm(y,b);for(const e in c){const i=c[e];i instanceof t.a5?(n(i.layers,this.zoom,a),t.bn({bucket:i,glyphMap:v,glyphPositions:x.positions,imageMap:y,imagePositions:w.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):i.hasPattern&&(i instanceof t.bo||i instanceof t.bp||i instanceof t.bq)&&(n(i.layers,this.zoom,a),i.addFeatures(d,this.tileID.canonical,w.patternPositions))}return this.status="done",{buckets:Object.values(c).filter((t=>!t.isEmpty())),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:x.image,imageAtlas:w,glyphMap:this.returnDependencies?v:null,iconMap:this.returnDependencies?y:null,glyphPositions:this.returnDependencies?x.positions:null}}))}}function n(e,i,r){const n=new t.a8(i);for(const t of e)t.recalculate(n,r)}class a{constructor(t,e,i){this.actor=t,this.layerIndex=e,this.availableImages=i,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(e,i){return t._(this,void 0,void 0,(function*(){const r=yield t.l(e.request,i);try{return{vectorTile:new t.br.VectorTile(new t.bs(r.data)),rawData:r.data,cacheControl:r.cacheControl,expires:r.expires}}catch(t){const i=new Uint8Array(r.data);let n=`Unable to parse the tile at ${e.request.url}, `;throw n+=31===i[0]&&139===i[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${t.message}`,new Error(n)}}))}loadTile(e){return t._(this,void 0,void 0,(function*(){const i=e.uid,n=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.bt(e.request),a=new r(e);this.loading[i]=a;const s=new AbortController;a.abort=s;try{const r=yield this.loadVectorTile(e,s);if(delete this.loading[i],!r)return null;const o=r.rawData,l={};r.expires&&(l.expires=r.expires),r.cacheControl&&(l.cacheControl=r.cacheControl);const c={};if(n){const t=n.finish();t&&(c.resourceTiming=JSON.parse(JSON.stringify(t)))}a.vectorTile=r.vectorTile;const d=a.parse(r.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[i]=a,this.fetching[i]={rawTileData:o,cacheControl:l,resourceTiming:c};try{const e=yield d;return t.e({rawTileData:o.slice(0)},e,l,c)}finally{delete this.fetching[i]}}catch(t){throw delete this.loading[i],a.status="done",this.loaded[i]=a,t}}))}reloadTile(e){return t._(this,void 0,void 0,(function*(){const i=e.uid;if(!this.loaded||!this.loaded[i])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const r=this.loaded[i];if(r.showCollisionBoxes=e.showCollisionBoxes,"parsing"===r.status){const e=yield r.parse(r.vectorTile,this.layerIndex,this.availableImages,this.actor);let n;if(this.fetching[i]){const{rawTileData:r,cacheControl:a,resourceTiming:s}=this.fetching[i];delete this.fetching[i],n=t.e({rawTileData:r.slice(0)},e,a,s)}else n=e;return n}if("done"===r.status&&r.vectorTile)return r.parse(r.vectorTile,this.layerIndex,this.availableImages,this.actor)}))}abortTile(e){return t._(this,void 0,void 0,(function*(){const t=this.loading,i=e.uid;t&&t[i]&&t[i].abort&&(t[i].abort.abort(),delete t[i])}))}removeTile(e){return t._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[e.uid]&&delete this.loaded[e.uid]}))}}class s{constructor(){this.loaded={}}loadTile(e){return t._(this,void 0,void 0,(function*(){const{uid:i,encoding:r,rawImageData:n,redFactor:a,greenFactor:s,blueFactor:o,baseShift:l}=e,c=n.width+2,d=n.height+2,h=t.b(n)?new t.R({width:c,height:d},yield t.bu(n,-1,-1,c,d)):n,p=new t.bv(i,h,r,a,s,o,l);return this.loaded=this.loaded||{},this.loaded[i]=p,p}))}removeTile(t){const e=this.loaded,i=t.uid;e&&e[i]&&delete e[i]}}function o(t,e){if(0!==t.length){l(t[0],e);for(var i=1;i<t.length;i++)l(t[i],!e)}}function l(t,e){for(var i=0,r=0,n=0,a=t.length,s=a-1;n<a;s=n++){var o=(t[n][0]-t[s][0])*(t[s][1]+t[n][1]),l=i+o;r+=Math.abs(i)>=Math.abs(o)?i-l+o:o-l+i,i=l}i+r>=0!=!!e&&t.reverse()}var c=t.bw((function t(e,i){var r,n=e&&e.type;if("FeatureCollection"===n)for(r=0;r<e.features.length;r++)t(e.features[r],i);else if("GeometryCollection"===n)for(r=0;r<e.geometries.length;r++)t(e.geometries[r],i);else if("Feature"===n)t(e.geometry,i);else if("Polygon"===n)o(e.coordinates,i);else if("MultiPolygon"===n)for(r=0;r<e.coordinates.length;r++)o(e.coordinates[r],i);return e}));const d=t.br.VectorTileFeature.prototype.toGeoJSON;var h={exports:{}},p=t.bx,u=t.br.VectorTileFeature,m=f;function f(t,e){this.options=e||{},this.features=t,this.length=t.length}function g(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}f.prototype.feature=function(t){return new g(this.features[t],this.options.extent)},g.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var i=t[e],r=[],n=0;n<i.length;n++)r.push(new p(i[n][0],i[n][1]));this.geometry.push(r)}return this.geometry},g.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,i=-1/0,r=1/0,n=-1/0,a=0;a<t.length;a++)for(var s=t[a],o=0;o<s.length;o++){var l=s[o];e=Math.min(e,l.x),i=Math.max(i,l.x),r=Math.min(r,l.y),n=Math.max(n,l.y)}return[e,r,i,n]},g.prototype.toGeoJSON=u.prototype.toGeoJSON;var _=t.by,v=m;function y(t){var e=new _;return function(t,e){for(var i in t.layers)e.writeMessage(3,b,t.layers[i])}(t,e),e.finish()}function b(t,e){var i;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(i=0;i<t.length;i++)r.feature=t.feature(i),e.writeMessage(2,x,r);var n=r.keys;for(i=0;i<n.length;i++)e.writeStringField(3,n[i]);var a=r.values;for(i=0;i<a.length;i++)e.writeMessage(4,C,a[i])}function x(t,e){var i=t.feature;void 0!==i.id&&e.writeVarintField(1,i.id),e.writeMessage(2,w,t),e.writeVarintField(3,i.type),e.writeMessage(4,S,i)}function w(t,e){var i=t.feature,r=t.keys,n=t.values,a=t.keycache,s=t.valuecache;for(var o in i.properties){var l=i.properties[o],c=a[o];if(null!==l){void 0===c&&(r.push(o),a[o]=c=r.length-1),e.writeVarint(c);var d=typeof l;"string"!==d&&"boolean"!==d&&"number"!==d&&(l=JSON.stringify(l));var h=d+":"+l,p=s[h];void 0===p&&(n.push(l),s[h]=p=n.length-1),e.writeVarint(p)}}}function k(t,e){return(e<<3)+(7&t)}function T(t){return t<<1^t>>31}function S(t,e){for(var i=t.loadGeometry(),r=t.type,n=0,a=0,s=i.length,o=0;o<s;o++){var l=i[o],c=1;1===r&&(c=l.length),e.writeVarint(k(1,c));for(var d=3===r?l.length-1:l.length,h=0;h<d;h++){1===h&&1!==r&&e.writeVarint(k(2,d-1));var p=l[h].x-n,u=l[h].y-a;e.writeVarint(T(p)),e.writeVarint(T(u)),n+=p,a+=u}3===r&&e.writeVarint(k(7,1))}}function C(t,e){var i=typeof t;"string"===i?e.writeStringField(1,t):"boolean"===i?e.writeBooleanField(7,t):"number"===i&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}h.exports=y,h.exports.fromVectorTileJs=y,h.exports.fromGeojsonVt=function(t,e){e=e||{};var i={};for(var r in t)i[r]=new v(t[r].features,e),i[r].name=r,i[r].version=e.version,i[r].extent=e.extent;return y({layers:i})},h.exports.GeoJSONWrapper=v;var E=t.bw(h.exports);const $={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},A=Math.fround||(I=new Float32Array(1),t=>(I[0]=+t,I[0]));var I;const M=3,L=5,P=6;class R{constructor(t){this.options=Object.assign(Object.create($),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:i,maxZoom:r}=this.options;e&&console.time("total time");const n=`prepare ${t.length} points`;e&&console.time(n),this.points=t;const a=[];for(let e=0;e<t.length;e++){const i=t[e];if(!i.geometry)continue;const[r,n]=i.geometry.coordinates,s=A(j(r)),o=A(O(n));a.push(s,o,1/0,e,-1,1),this.options.reduce&&a.push(0)}let s=this.trees[r+1]=this._createTree(a);e&&console.timeEnd(n);for(let t=r;t>=i;t--){const i=+Date.now();s=this.trees[t]=this._createTree(this._cluster(s,t)),e&&console.log("z%d: %d clusters in %dms",t,s.numItems,+Date.now()-i)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let i=((t[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,t[1]));let n=180===t[2]?180:((t[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)i=-180,n=180;else if(i>n){const t=this.getClusters([i,r,180,a],e),s=this.getClusters([-180,r,n,a],e);return t.concat(s)}const s=this.trees[this._limitZoom(e)],o=s.range(j(i),O(a),j(n),O(r)),l=s.data,c=[];for(const t of o){const e=this.stride*t;c.push(l[e+L]>1?z(l,e,this.clusterProps):this.points[l[e+M]])}return c}getChildren(t){const e=this._getOriginId(t),i=this._getOriginZoom(t),r="No cluster with the specified id.",n=this.trees[i];if(!n)throw new Error(r);const a=n.data;if(e*this.stride>=a.length)throw new Error(r);const s=this.options.radius/(this.options.extent*Math.pow(2,i-1)),o=n.within(a[e*this.stride],a[e*this.stride+1],s),l=[];for(const e of o){const i=e*this.stride;a[i+4]===t&&l.push(a[i+L]>1?z(a,i,this.clusterProps):this.points[a[i+M]])}if(0===l.length)throw new Error(r);return l}getLeaves(t,e,i){const r=[];return this._appendLeaves(r,t,e=e||10,i=i||0,0),r}getTile(t,e,i){const r=this.trees[this._limitZoom(t)],n=Math.pow(2,t),{extent:a,radius:s}=this.options,o=s/a,l=(i-o)/n,c=(i+1+o)/n,d={features:[]};return this._addTileFeatures(r.range((e-o)/n,l,(e+1+o)/n,c),r.data,e,i,n,d),0===e&&this._addTileFeatures(r.range(1-o/n,l,1,c),r.data,n,i,n,d),e===n-1&&this._addTileFeatures(r.range(0,l,o/n,c),r.data,-1,i,n,d),d.features.length?d:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const i=this.getChildren(t);if(e++,1!==i.length)break;t=i[0].properties.cluster_id}return e}_appendLeaves(t,e,i,r,n){const a=this.getChildren(e);for(const e of a){const a=e.properties;if(a&&a.cluster?n+a.point_count<=r?n+=a.point_count:n=this._appendLeaves(t,a.cluster_id,i,r,n):n<r?n++:t.push(e),t.length===i)break}return n}_createTree(e){const i=new t.av(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let t=0;t<e.length;t+=this.stride)i.add(e[t],e[t+1]);return i.finish(),i.data=e,i}_addTileFeatures(t,e,i,r,n,a){for(const s of t){const t=s*this.stride,o=e[t+L]>1;let l,c,d;if(o)l=D(e,t,this.clusterProps),c=e[t],d=e[t+1];else{const i=this.points[e[t+M]];l=i.properties;const[r,n]=i.geometry.coordinates;c=j(r),d=O(n)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*n-i)),Math.round(this.options.extent*(d*n-r))]],tags:l};let p;p=o||this.options.generateId?e[t+M]:this.points[e[t+M]].id,void 0!==p&&(h.id=p),a.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:i,extent:r,reduce:n,minPoints:a}=this.options,s=i/(r*Math.pow(2,e)),o=t.data,l=[],c=this.stride;for(let i=0;i<o.length;i+=c){if(o[i+2]<=e)continue;o[i+2]=e;const r=o[i],d=o[i+1],h=t.within(o[i],o[i+1],s),p=o[i+L];let u=p;for(const t of h){const i=t*c;o[i+2]>e&&(u+=o[i+L])}if(u>p&&u>=a){let t,a=r*p,s=d*p,m=-1;const f=((i/c|0)<<5)+(e+1)+this.points.length;for(const r of h){const l=r*c;if(o[l+2]<=e)continue;o[l+2]=e;const d=o[l+L];a+=o[l]*d,s+=o[l+1]*d,o[l+4]=f,n&&(t||(t=this._map(o,i,!0),m=this.clusterProps.length,this.clusterProps.push(t)),n(t,this._map(o,l)))}o[i+4]=f,l.push(a/u,s/u,1/0,f,-1,u),n&&l.push(m)}else{for(let t=0;t<c;t++)l.push(o[i+t]);if(u>1)for(const t of h){const i=t*c;if(!(o[i+2]<=e)){o[i+2]=e;for(let t=0;t<c;t++)l.push(o[i+t])}}}}return l}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,i){if(t[e+L]>1){const r=this.clusterProps[t[e+P]];return i?Object.assign({},r):r}const r=this.points[t[e+M]].properties,n=this.options.map(r);return i&&n===r?Object.assign({},n):n}}function z(t,e,i){return{type:"Feature",id:t[e+M],properties:D(t,e,i),geometry:{type:"Point",coordinates:[(r=t[e],360*(r-.5)),B(t[e+1])]}};var r}function D(t,e,i){const r=t[e+L],n=r>=1e4?`${Math.round(r/1e3)}k`:r>=1e3?Math.round(r/100)/10+"k":r,a=t[e+P],s=-1===a?{}:Object.assign({},i[a]);return Object.assign(s,{cluster:!0,cluster_id:t[e+M],point_count:r,point_count_abbreviated:n})}function j(t){return t/360+.5}function O(t){const e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:i>1?1:i}function B(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function F(t,e,i,r){for(var n,a=r,s=i-e>>1,o=i-e,l=t[e],c=t[e+1],d=t[i],h=t[i+1],p=e+3;p<i;p+=3){var u=N(t[p],t[p+1],l,c,d,h);if(u>a)n=p,a=u;else if(u===a){var m=Math.abs(p-s);m<o&&(n=p,o=m)}}a>r&&(n-e>3&&F(t,e,n,r),t[n+2]=a,i-n>3&&F(t,n,i,r))}function N(t,e,i,r,n,a){var s=n-i,o=a-r;if(0!==s||0!==o){var l=((t-i)*s+(e-r)*o)/(s*s+o*o);l>1?(i=n,r=a):l>0&&(i+=s*l,r+=o*l)}return(s=t-i)*s+(o=e-r)*o}function H(t,e,i,r){var n={id:void 0===t?null:t,type:e,geometry:i,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,i=t.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)V(t,e);else if("Polygon"===i||"MultiLineString"===i)for(var r=0;r<e.length;r++)V(t,e[r]);else if("MultiPolygon"===i)for(r=0;r<e.length;r++)for(var n=0;n<e[r].length;n++)V(t,e[r][n])}(n),n}function V(t,e){for(var i=0;i<e.length;i+=3)t.minX=Math.min(t.minX,e[i]),t.minY=Math.min(t.minY,e[i+1]),t.maxX=Math.max(t.maxX,e[i]),t.maxY=Math.max(t.maxY,e[i+1])}function U(t,e,i,r){if(e.geometry){var n=e.geometry.coordinates,a=e.geometry.type,s=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),o=[],l=e.id;if(i.promoteId?l=e.properties[i.promoteId]:i.generateId&&(l=r||0),"Point"===a)Y(n,o);else if("MultiPoint"===a)for(var c=0;c<n.length;c++)Y(n[c],o);else if("LineString"===a)Z(n,o,s,!1);else if("MultiLineString"===a){if(i.lineMetrics){for(c=0;c<n.length;c++)Z(n[c],o=[],s,!1),t.push(H(l,"LineString",o,e.properties));return}q(n,o,s,!1)}else if("Polygon"===a)q(n,o,s,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(c=0;c<e.geometry.geometries.length;c++)U(t,{id:l,geometry:e.geometry.geometries[c],properties:e.properties},i,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<n.length;c++){var d=[];q(n[c],d,s,!0),o.push(d)}}t.push(H(l,a,o,e.properties))}}function Y(t,e){e.push(W(t[0])),e.push(G(t[1])),e.push(0)}function Z(t,e,i,r){for(var n,a,s=0,o=0;o<t.length;o++){var l=W(t[o][0]),c=G(t[o][1]);e.push(l),e.push(c),e.push(0),o>0&&(s+=r?(n*c-l*a)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(c-a,2))),n=l,a=c}var d=e.length-3;e[2]=1,F(e,0,d,i),e[d+2]=1,e.size=Math.abs(s),e.start=0,e.end=e.size}function q(t,e,i,r){for(var n=0;n<t.length;n++){var a=[];Z(t[n],a,i,r),e.push(a)}}function W(t){return t/360+.5}function G(t){var e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:i>1?1:i}function X(t,e,i,r,n,a,s,o){if(r/=e,a>=(i/=e)&&s<r)return t;if(s<i||a>=r)return null;for(var l=[],c=0;c<t.length;c++){var d=t[c],h=d.geometry,p=d.type,u=0===n?d.minX:d.minY,m=0===n?d.maxX:d.maxY;if(u>=i&&m<r)l.push(d);else if(!(m<i||u>=r)){var f=[];if("Point"===p||"MultiPoint"===p)K(h,f,i,r,n);else if("LineString"===p)J(h,f,i,r,n,!1,o.lineMetrics);else if("MultiLineString"===p)tt(h,f,i,r,n,!1);else if("Polygon"===p)tt(h,f,i,r,n,!0);else if("MultiPolygon"===p)for(var g=0;g<h.length;g++){var _=[];tt(h[g],_,i,r,n,!0),_.length&&f.push(_)}if(f.length){if(o.lineMetrics&&"LineString"===p){for(g=0;g<f.length;g++)l.push(H(d.id,p,f[g],d.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===f.length?(p="LineString",f=f[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===f.length?"Point":"MultiPoint"),l.push(H(d.id,p,f,d.tags))}}}return l.length?l:null}function K(t,e,i,r,n){for(var a=0;a<t.length;a+=3){var s=t[a+n];s>=i&&s<=r&&(e.push(t[a]),e.push(t[a+1]),e.push(t[a+2]))}}function J(t,e,i,r,n,a,s){for(var o,l,c=Q(t),d=0===n?it:rt,h=t.start,p=0;p<t.length-3;p+=3){var u=t[p],m=t[p+1],f=t[p+2],g=t[p+3],_=t[p+4],v=0===n?u:m,y=0===n?g:_,b=!1;s&&(o=Math.sqrt(Math.pow(u-g,2)+Math.pow(m-_,2))),v<i?y>i&&(l=d(c,u,m,g,_,i),s&&(c.start=h+o*l)):v>r?y<r&&(l=d(c,u,m,g,_,r),s&&(c.start=h+o*l)):et(c,u,m,f),y<i&&v>=i&&(l=d(c,u,m,g,_,i),b=!0),y>r&&v<=r&&(l=d(c,u,m,g,_,r),b=!0),!a&&b&&(s&&(c.end=h+o*l),e.push(c),c=Q(t)),s&&(h+=o)}var x=t.length-3;u=t[x],m=t[x+1],f=t[x+2],(v=0===n?u:m)>=i&&v<=r&&et(c,u,m,f),x=c.length-3,a&&x>=3&&(c[x]!==c[0]||c[x+1]!==c[1])&&et(c,c[0],c[1],c[2]),c.length&&e.push(c)}function Q(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function tt(t,e,i,r,n,a){for(var s=0;s<t.length;s++)J(t[s],e,i,r,n,a,!1)}function et(t,e,i,r){t.push(e),t.push(i),t.push(r)}function it(t,e,i,r,n,a){var s=(a-e)/(r-e);return t.push(a),t.push(i+(n-i)*s),t.push(1),s}function rt(t,e,i,r,n,a){var s=(a-i)/(n-i);return t.push(e+(r-e)*s),t.push(a),t.push(1),s}function nt(t,e){for(var i=[],r=0;r<t.length;r++){var n,a=t[r],s=a.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)n=at(a.geometry,e);else if("MultiLineString"===s||"Polygon"===s){n=[];for(var o=0;o<a.geometry.length;o++)n.push(at(a.geometry[o],e))}else if("MultiPolygon"===s)for(n=[],o=0;o<a.geometry.length;o++){for(var l=[],c=0;c<a.geometry[o].length;c++)l.push(at(a.geometry[o][c],e));n.push(l)}i.push(H(a.id,s,n,a.tags))}return i}function at(t,e){var i=[];i.size=t.size,void 0!==t.start&&(i.start=t.start,i.end=t.end);for(var r=0;r<t.length;r+=3)i.push(t[r]+e,t[r+1],t[r+2]);return i}function st(t,e){if(t.transformed)return t;var i,r,n,a=1<<t.z,s=t.x,o=t.y;for(i=0;i<t.features.length;i++){var l=t.features[i],c=l.geometry,d=l.type;if(l.geometry=[],1===d)for(r=0;r<c.length;r+=2)l.geometry.push(ot(c[r],c[r+1],e,a,s,o));else for(r=0;r<c.length;r++){var h=[];for(n=0;n<c[r].length;n+=2)h.push(ot(c[r][n],c[r][n+1],e,a,s,o));l.geometry.push(h)}}return t.transformed=!0,t}function ot(t,e,i,r,n,a){return[Math.round(i*(t*r-n)),Math.round(i*(e*r-a))]}function lt(t,e,i,r,n){for(var a=e===n.maxZoom?0:n.tolerance/((1<<e)*n.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},o=0;o<t.length;o++){s.numFeatures++,ct(s,t[o],a,n);var l=t[o].minX,c=t[o].minY,d=t[o].maxX,h=t[o].maxY;l<s.minX&&(s.minX=l),c<s.minY&&(s.minY=c),d>s.maxX&&(s.maxX=d),h>s.maxY&&(s.maxY=h)}return s}function ct(t,e,i,r){var n=e.geometry,a=e.type,s=[];if("Point"===a||"MultiPoint"===a)for(var o=0;o<n.length;o+=3)s.push(n[o]),s.push(n[o+1]),t.numPoints++,t.numSimplified++;else if("LineString"===a)dt(s,n,t,i,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(o=0;o<n.length;o++)dt(s,n[o],t,i,"Polygon"===a,0===o);else if("MultiPolygon"===a)for(var l=0;l<n.length;l++){var c=n[l];for(o=0;o<c.length;o++)dt(s,c[o],t,i,!0,0===o)}if(s.length){var d=e.tags||null;if("LineString"===a&&r.lineMetrics){for(var h in d={},e.tags)d[h]=e.tags[h];d.mapbox_clip_start=n.start/n.size,d.mapbox_clip_end=n.end/n.size}var p={geometry:s,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:d};null!==e.id&&(p.id=e.id),t.features.push(p)}}function dt(t,e,i,r,n,a){var s=r*r;if(r>0&&e.size<(n?s:r))i.numPoints+=e.length/3;else{for(var o=[],l=0;l<e.length;l+=3)(0===r||e[l+2]>s)&&(i.numSimplified++,o.push(e[l]),o.push(e[l+1])),i.numPoints++;n&&function(t,e){for(var i=0,r=0,n=t.length,a=n-2;r<n;a=r,r+=2)i+=(t[r]-t[a])*(t[r+1]+t[a+1]);if(i>0===e)for(r=0,n=t.length;r<n/2;r+=2){var s=t[r],o=t[r+1];t[r]=t[n-2-r],t[r+1]=t[n-1-r],t[n-2-r]=s,t[n-1-r]=o}}(o,a),t.push(o)}}function ht(t,e){var i=(e=this.options=function(t,e){for(var i in e)t[i]=e[i];return t}(Object.create(this.options),e)).debug;if(i&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var i=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)U(i,t.features[r],e,r);else U(i,"Feature"===t.type?t:{geometry:t},e);return i}(t,e);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=function(t,e){var i=e.buffer/e.extent,r=t,n=X(t,1,-1-i,i,0,-1,2,e),a=X(t,1,1-i,2+i,0,-1,2,e);return(n||a)&&(r=X(t,1,-i,1+i,0,-1,2,e)||[],n&&(r=nt(n,1).concat(r)),a&&(r=r.concat(nt(a,-1)))),r}(r,e),r.length&&this.splitTile(r,0,0,0),i&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function pt(t,e,i){return 32*((1<<t)*i+e)+t}function ut(t,e){return e?t.properties[e]:t.id}function mt(t,e){if(null==t)return!0;if("Feature"===t.type)return null!=ut(t,e);if("FeatureCollection"===t.type){const i=new Set;for(const r of t.features){const t=ut(r,e);if(null==t)return!1;if(i.has(t))return!1;i.add(t)}return!0}return!1}function ft(t,e){const i=new Map;if(null==t);else if("Feature"===t.type)i.set(ut(t,e),t);else for(const r of t.features)i.set(ut(r,e),r);return i}ht.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ht.prototype.splitTile=function(t,e,i,r,n,a,s){for(var o=[t,e,i,r],l=this.options,c=l.debug;o.length;){r=o.pop(),i=o.pop(),e=o.pop(),t=o.pop();var d=1<<e,h=pt(e,i,r),p=this.tiles[h];if(!p&&(c>1&&console.time("creation"),p=this.tiles[h]=lt(t,e,i,r,l),this.tileCoords.push({z:e,x:i,y:r}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,i,r,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var u="z"+e;this.stats[u]=(this.stats[u]||0)+1,this.total++}if(p.source=t,n){if(e===l.maxZoom||e===n)continue;var m=1<<n-e;if(i!==Math.floor(a/m)||r!==Math.floor(s/m))continue}else if(e===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==t.length){c>1&&console.time("clipping");var f,g,_,v,y,b,x=.5*l.buffer/l.extent,w=.5-x,k=.5+x,T=1+x;f=g=_=v=null,y=X(t,d,i-x,i+k,0,p.minX,p.maxX,l),b=X(t,d,i+w,i+T,0,p.minX,p.maxX,l),t=null,y&&(f=X(y,d,r-x,r+k,1,p.minY,p.maxY,l),g=X(y,d,r+w,r+T,1,p.minY,p.maxY,l),y=null),b&&(_=X(b,d,r-x,r+k,1,p.minY,p.maxY,l),v=X(b,d,r+w,r+T,1,p.minY,p.maxY,l),b=null),c>1&&console.timeEnd("clipping"),o.push(f||[],e+1,2*i,2*r),o.push(g||[],e+1,2*i,2*r+1),o.push(_||[],e+1,2*i+1,2*r),o.push(v||[],e+1,2*i+1,2*r+1)}}},ht.prototype.getTile=function(t,e,i){var r=this.options,n=r.extent,a=r.debug;if(t<0||t>24)return null;var s=1<<t,o=pt(t,e=(e%s+s)%s,i);if(this.tiles[o])return st(this.tiles[o],n);a>1&&console.log("drilling down to z%d-%d-%d",t,e,i);for(var l,c=t,d=e,h=i;!l&&c>0;)c--,d=Math.floor(d/2),h=Math.floor(h/2),l=this.tiles[pt(c,d,h)];return l&&l.source?(a>1&&console.log("found parent tile z%d-%d-%d",c,d,h),a>1&&console.time("drilling down"),this.splitTile(l.source,c,d,h,t,e,i),a>1&&console.timeEnd("drilling down"),this.tiles[o]?st(this.tiles[o],n):null):null};class gt extends a{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(e,i){return t._(this,void 0,void 0,(function*(){const i=e.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const r=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!r)return null;const n=new class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.W,this.length=e.length,this._features=e}feature(e){return new class{constructor(e){this._feature=e,this.extent=t.W,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const i of this._feature.geometry)e.push([new t.P(i[0],i[1])]);return e}{const e=[];for(const i of this._feature.geometry){const r=[];for(const e of i)r.push(new t.P(e[0],e[1]));e.push(r)}return e}}toGeoJSON(t,e,i){return d.call(this,t,e,i)}}(this._features[e])}}(r.features);let a=E(n);return 0===a.byteOffset&&a.byteLength===a.buffer.byteLength||(a=new Uint8Array(a)),{vectorTile:n,rawData:a.buffer}}))}loadData(e){return t._(this,void 0,void 0,(function*(){var i;null===(i=this._pendingRequest)||void 0===i||i.abort();const r=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.bt(e.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(e,this._pendingRequest),this._geoJSONIndex=e.cluster?new R(function({superclusterOptions:e,clusterProperties:i}){if(!i||!e)return e;const r={},n={},a={accumulated:null,zoom:0},s={properties:null},o=Object.keys(i);for(const e of o){const[a,s]=i[e],o=t.bA(s),l=t.bA("string"==typeof a?[a,["accumulated"],["get",e]]:a);r[e]=o.value,n[e]=l.value}return e.map=t=>{s.properties=t;const e={};for(const t of o)e[t]=r[t].evaluate(a,s);return e},e.reduce=(t,e)=>{s.properties=e;for(const e of o)a.accumulated=t[e],t[e]=n[e].evaluate(a,s)},e}(e)).load((yield this._pendingData).features):new ht(yield this._pendingData,e.geojsonVtOptions),this.loaded={};const i={};if(r){const t=r.finish();t&&(i.resourceTiming={},i.resourceTiming[e.source]=JSON.parse(JSON.stringify(t)))}return i}catch(e){if(delete this._pendingRequest,t.bz(e))return{abandoned:!0};throw e}}))}getData(){return t._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(t){const e=this.loaded;return e&&e[t.uid]?super.reloadTile(t):this.loadTile(t)}loadAndProcessGeoJSON(e,i){return t._(this,void 0,void 0,(function*(){let r=yield this.loadGeoJSON(e,i);if(delete this._pendingRequest,"object"!=typeof r)throw new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`);if(c(r,!0),e.filter){const i=t.bA(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===i.result)throw new Error(i.value.map((t=>`${t.key}: ${t.message}`)).join(", "));const n=r.features.filter((t=>i.value.evaluate({zoom:0},t)));r={type:"FeatureCollection",features:n}}return r}))}loadGeoJSON(e,i){return t._(this,void 0,void 0,(function*(){const{promoteId:r}=e;if(e.request){const n=yield t.h(e.request,i);return this._dataUpdateable=mt(n.data,r)?ft(n.data,r):void 0,n.data}if("string"==typeof e.data)try{const t=JSON.parse(e.data);return this._dataUpdateable=mt(t,r)?ft(t,r):void 0,t}catch(t){throw new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`)}if(!e.dataDiff)throw new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${e.source}`);return function(t,e,i){var r,n,a,s;if(e.removeAll&&t.clear(),e.remove)for(const i of e.remove)t.delete(i);if(e.add)for(const r of e.add){const e=ut(r,i);null!=e&&t.set(e,r)}if(e.update)for(const i of e.update){let e=t.get(i.id);if(null==e)continue;const o=!i.removeAllProperties&&((null===(r=i.removeProperties)||void 0===r?void 0:r.length)>0||(null===(n=i.addOrUpdateProperties)||void 0===n?void 0:n.length)>0);if((i.newGeometry||i.removeAllProperties||o)&&(e=Object.assign({},e),t.set(i.id,e),o&&(e.properties=Object.assign({},e.properties))),i.newGeometry&&(e.geometry=i.newGeometry),i.removeAllProperties)e.properties={};else if((null===(a=i.removeProperties)||void 0===a?void 0:a.length)>0)for(const t of i.removeProperties)Object.prototype.hasOwnProperty.call(e.properties,t)&&delete e.properties[t];if((null===(s=i.addOrUpdateProperties)||void 0===s?void 0:s.length)>0)for(const{key:t,value:r}of i.addOrUpdateProperties)e.properties[t]=r}}(this._dataUpdateable,e.dataDiff,r),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(e){return t._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(t){return this._geoJSONIndex.getClusterExpansionZoom(t.clusterId)}getClusterChildren(t){return this._geoJSONIndex.getChildren(t.clusterId)}getClusterLeaves(t){return this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset)}}class _t{constructor(e){this.self=e,this.actor=new t.C(e),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(t,e)=>{if(this.externalWorkerSourceTypes[t])throw new Error(`Worker source with name "${t}" already registered.`);this.externalWorkerSourceTypes[t]=e},this.self.addProtocol=t.bg,this.self.removeProtocol=t.bh,this.self.registerRTLTextPlugin=e=>{if(t.bB.isParsed())throw new Error("RTL text plugin already registered.");t.bB.setMethods(e)},this.actor.registerMessageHandler("LDT",((t,e)=>this._getDEMWorkerSource(t,e.source).loadTile(e))),this.actor.registerMessageHandler("RDT",((e,i)=>t._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(e,i.source).removeTile(i)})))),this.actor.registerMessageHandler("GCEZ",((e,i)=>t._(this,void 0,void 0,(function*(){return this._getWorkerSource(e,i.type,i.source).getClusterExpansionZoom(i)})))),this.actor.registerMessageHandler("GCC",((e,i)=>t._(this,void 0,void 0,(function*(){return this._getWorkerSource(e,i.type,i.source).getClusterChildren(i)})))),this.actor.registerMessageHandler("GCL",((e,i)=>t._(this,void 0,void 0,(function*(){return this._getWorkerSource(e,i.type,i.source).getClusterLeaves(i)})))),this.actor.registerMessageHandler("LD",((t,e)=>this._getWorkerSource(t,e.type,e.source).loadData(e))),this.actor.registerMessageHandler("GD",((t,e)=>this._getWorkerSource(t,e.type,e.source).getData())),this.actor.registerMessageHandler("LT",((t,e)=>this._getWorkerSource(t,e.type,e.source).loadTile(e))),this.actor.registerMessageHandler("RT",((t,e)=>this._getWorkerSource(t,e.type,e.source).reloadTile(e))),this.actor.registerMessageHandler("AT",((t,e)=>this._getWorkerSource(t,e.type,e.source).abortTile(e))),this.actor.registerMessageHandler("RMT",((t,e)=>this._getWorkerSource(t,e.type,e.source).removeTile(e))),this.actor.registerMessageHandler("RS",((e,i)=>t._(this,void 0,void 0,(function*(){if(!this.workerSources[e]||!this.workerSources[e][i.type]||!this.workerSources[e][i.type][i.source])return;const t=this.workerSources[e][i.type][i.source];delete this.workerSources[e][i.type][i.source],void 0!==t.removeSource&&t.removeSource(i)})))),this.actor.registerMessageHandler("RM",(e=>t._(this,void 0,void 0,(function*(){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e]})))),this.actor.registerMessageHandler("SR",((e,i)=>t._(this,void 0,void 0,(function*(){this.referrer=i})))),this.actor.registerMessageHandler("SRPS",((t,e)=>this._syncRTLPluginState(t,e))),this.actor.registerMessageHandler("IS",((e,i)=>t._(this,void 0,void 0,(function*(){this.self.importScripts(i)})))),this.actor.registerMessageHandler("SI",((t,e)=>this._setImages(t,e))),this.actor.registerMessageHandler("UL",((e,i)=>t._(this,void 0,void 0,(function*(){this._getLayerIndex(e).update(i.layers,i.removedIds)})))),this.actor.registerMessageHandler("SL",((e,i)=>t._(this,void 0,void 0,(function*(){this._getLayerIndex(e).replace(i)}))))}_setImages(e,i){return t._(this,void 0,void 0,(function*(){this.availableImages[e]=i;for(const t in this.workerSources[e]){const r=this.workerSources[e][t];for(const t in r)r[t].availableImages=i}}))}_syncRTLPluginState(e,i){return t._(this,void 0,void 0,(function*(){if(t.bB.isParsed())return t.bB.getState();if("loading"!==i.pluginStatus)return t.bB.setState(i),i;const e=i.pluginURL;if(this.self.importScripts(e),t.bB.isParsed()){const i={pluginStatus:"loaded",pluginURL:e};return t.bB.setState(i),i}throw t.bB.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${e}`)}))}_getAvailableImages(t){let e=this.availableImages[t];return e||(e=[]),e}_getLayerIndex(t){let i=this.layerIndexes[t];return i||(i=this.layerIndexes[t]=new e),i}_getWorkerSource(t,e,i){if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][i]){const r={sendAsync:(e,i)=>(e.targetMapId=t,this.actor.sendAsync(e,i))};switch(e){case"vector":this.workerSources[t][e][i]=new a(r,this._getLayerIndex(t),this._getAvailableImages(t));break;case"geojson":this.workerSources[t][e][i]=new gt(r,this._getLayerIndex(t),this._getAvailableImages(t));break;default:this.workerSources[t][e][i]=new this.externalWorkerSourceTypes[e](r,this._getLayerIndex(t),this._getAvailableImages(t))}}return this.workerSources[t][e][i]}_getDEMWorkerSource(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new s),this.demWorkerSources[t][e]}}return t.i(self)&&(self.worker=new _t(self)),_t})),i("index",0,(function(t,e){var i="4.4.1";let r,n;const a={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:t=>new Promise(((i,r)=>{const n=requestAnimationFrame(i);t.signal.addEventListener("abort",(()=>{cancelAnimationFrame(n),r(e.c())}))})),getImageData(t,e=0){return this.getImageCanvasContext(t).getImageData(-e,-e,t.width+2*e,t.height+2*e)},getImageCanvasContext(t){const e=window.document.createElement("canvas"),i=e.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,i.drawImage(t,0,0,t.width,t.height),i},resolveURL:t=>(r||(r=document.createElement("a")),r.href=t,r.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==n&&(n=matchMedia("(prefers-reduced-motion: reduce)")),n.matches)}};class s{static testProp(t){if(!s.docStyle)return t[0];for(let e=0;e<t.length;e++)if(t[e]in s.docStyle)return t[e];return t[0]}static create(t,e,i){const r=window.document.createElement(t);return void 0!==e&&(r.className=e),i&&i.appendChild(r),r}static createNS(t,e){return window.document.createElementNS(t,e)}static disableDrag(){s.docStyle&&s.selectProp&&(s.userSelect=s.docStyle[s.selectProp],s.docStyle[s.selectProp]="none")}static enableDrag(){s.docStyle&&s.selectProp&&(s.docStyle[s.selectProp]=s.userSelect)}static setTransform(t,e){t.style[s.transformProp]=e}static addEventListener(t,e,i,r={}){t.addEventListener(e,i,"passive"in r?r:r.capture)}static removeEventListener(t,e,i,r={}){t.removeEventListener(e,i,"passive"in r?r:r.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",s.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",s.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",s.suppressClickInternal,!0)}),0)}static getScale(t){const e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}static getPoint(t,i,r){const n=i.boundingClientRect;return new e.P((r.clientX-n.left)/i.x-t.clientLeft,(r.clientY-n.top)/i.y-t.clientTop)}static mousePos(t,e){const i=s.getScale(t);return s.getPoint(t,i,e)}static touchPos(t,e){const i=[],r=s.getScale(t);for(let n=0;n<e.length;n++)i.push(s.getPoint(t,r,e[n]));return i}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}s.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,s.selectProp=s.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),s.transformProp=s.testProp(["transform","WebkitTransform"]);const o={supported:!1,testSupport:function(t){!d&&c&&(h?p(t):l=t)}};let l,c,d=!1,h=!1;function p(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,c),t.isContextLost())return;o.supported=!0}catch(t){}t.deleteTexture(e),d=!0}var u;"undefined"!=typeof document&&(c=document.createElement("img"),c.onload=()=>{l&&p(l),l=null,h=!0},c.onerror=()=>{d=!0,l=null},c.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(t){let i,r,n,a;t.resetRequestQueue=()=>{i=[],r=0,n=0,a={}},t.addThrottleControl=t=>{const e=n++;return a[e]=t,e},t.removeThrottleControl=t=>{delete a[t],l()},t.getImage=(t,r,n=!0)=>new Promise(((a,s)=>{o.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),e.e(t,{type:"image"}),i.push({abortController:r,requestParameters:t,supportImageRefresh:n,state:"queued",onError:t=>{s(t)},onSuccess:t=>{a(t)}}),l()}));const s=t=>e._(this,void 0,void 0,(function*(){t.state="running";const{requestParameters:i,supportImageRefresh:n,onError:a,onSuccess:s,abortController:o}=t,d=!1===n&&!e.i(self)&&!e.g(i.url)&&(!i.headers||Object.keys(i.headers).reduce(((t,e)=>t&&"accept"===e),!0));r++;const h=d?c(i,o):e.m(i,o);try{const i=yield h;delete t.abortController,t.state="completed",i.data instanceof HTMLImageElement||e.b(i.data)?s(i):i.data&&s({data:yield(p=i.data,"function"==typeof createImageBitmap?e.d(p):e.f(p)),cacheControl:i.cacheControl,expires:i.expires})}catch(e){delete t.abortController,a(e)}finally{r--,l()}var p})),l=()=>{const t=(()=>{for(const t of Object.keys(a))if(a[t]())return!0;return!1})()?e.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:e.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let e=r;e<t&&i.length>0;e++){const t=i.shift();t.abortController.signal.aborted?e--:s(t)}},c=(t,i)=>new Promise(((r,n)=>{const a=new Image,s=t.url,o=t.credentials;o&&"include"===o?a.crossOrigin="use-credentials":(o&&"same-origin"===o||!e.s(s))&&(a.crossOrigin="anonymous"),i.signal.addEventListener("abort",(()=>{a.src="",n(e.c())})),a.fetchPriority="high",a.onload=()=>{a.onerror=a.onload=null,r({data:a})},a.onerror=()=>{a.onerror=a.onload=null,i.signal.aborted||n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},a.src=s}))}(u||(u={})),u.resetRequestQueue();class m{constructor(t){this._transformRequestFn=t}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function f(t){var i=new e.A(3);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i}var g,_=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t};g=new e.A(3),e.A!=Float32Array&&(g[0]=0,g[1]=0,g[2]=0);var v=function(t){var e=t[0],i=t[1];return e*e+i*i};function y(t){const e=[];if("string"==typeof t)e.push({id:"default",url:t});else if(t&&t.length>0){const i=[];for(const{id:r,url:n}of t){const t=`${r}${n}`;-1===i.indexOf(t)&&(i.push(t),e.push({id:r,url:n}))}}return e}function b(t,e,i){const r=t.split("?");return r[0]+=`${e}${i}`,r.join("?")}!function(){var t=new e.A(2);e.A!=Float32Array&&(t[0]=0,t[1]=0)}();class x{constructor(t,e,i,r){this.context=t,this.format=i,this.texture=t.gl.createTexture(),this.update(e,r)}update(t,i,r){const{width:n,height:a}=t,s=!(this.size&&this.size[0]===n&&this.size[1]===a||r),{context:o}=this,{gl:l}=o;if(this.useMipmap=Boolean(i&&i.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!i||!1!==i.premultiply)),s)this.size=[n,a],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||e.b(t)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,t):l.texImage2D(l.TEXTURE_2D,0,this.format,n,a,0,this.format,l.UNSIGNED_BYTE,t.data);else{const{x:i,y:s}=r||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||e.b(t)?l.texSubImage2D(l.TEXTURE_2D,0,i,s,l.RGBA,l.UNSIGNED_BYTE,t):l.texSubImage2D(l.TEXTURE_2D,0,i,s,n,a,l.RGBA,l.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(t,e,i){const{context:r}=this,{gl:n}=r;n.bindTexture(n.TEXTURE_2D,this.texture),i!==n.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=n.LINEAR),t!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,i||t),this.filter=t),e!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function w(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class k extends e.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,promiseResolve:e}of this.requestors)e(this._getImagesForIds(t));this.requestors=[]}}getImage(t){const i=this.images[t];if(i&&!i.data&&i.spriteData){const t=i.spriteData;i.data=new e.R({width:t.width,height:t.height},t.context.getImageData(t.x,t.y,t.width,t.height).data),i.spriteData=null}return i}addImage(t,e){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,e)&&(this.images[t]=e)}_validate(t,i){let r=!0;const n=i.data||i.spriteData;return this._validateStretch(i.stretchX,n&&n.width)||(this.fire(new e.j(new Error(`Image "${t}" has invalid "stretchX" value`))),r=!1),this._validateStretch(i.stretchY,n&&n.height)||(this.fire(new e.j(new Error(`Image "${t}" has invalid "stretchY" value`))),r=!1),this._validateContent(i.content,i)||(this.fire(new e.j(new Error(`Image "${t}" has invalid "content" value`))),r=!1),r}_validateStretch(t,e){if(!t)return!0;let i=0;for(const r of t){if(r[0]<i||r[1]<r[0]||e<r[1])return!1;i=r[1]}return!0}_validateContent(t,e){if(!t)return!0;if(4!==t.length)return!1;const i=e.spriteData,r=i&&i.width||e.data.width,n=i&&i.height||e.data.height;return!(t[0]<0||r<t[0]||t[1]<0||n<t[1]||t[2]<0||r<t[2]||t[3]<0||n<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,e,i=!0){const r=this.getImage(t);if(i&&(r.data.width!==e.data.width||r.data.height!==e.data.height))throw new Error(`size mismatch between old image (${r.data.width}x${r.data.height}) and new image (${e.data.width}x${e.data.height}).`);e.version=r.version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((e,i)=>{let r=!0;if(!this.isLoaded())for(const e of t)this.images[e]||(r=!1);this.isLoaded()||r?e(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:e})}))}_getImagesForIds(t){const i={};for(const r of t){let t=this.getImage(r);t||(this.fire(new e.k("styleimagemissing",{id:r})),t=this.getImage(r)),t?i[r]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,textFitWidth:t.textFitWidth,textFitHeight:t.textFitHeight,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:e.w(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return i}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(t){const i=this.patterns[t],r=this.getImage(t);if(!r)return null;if(i&&i.position.version===r.version)return i.position;if(i)i.position.version=r.version;else{const i={w:r.data.width+2,h:r.data.height+2,x:0,y:0},n=new e.I(i,r);this.patterns[t]={bin:i,position:n}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new x(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const e in this.patterns)t.push(this.patterns[e].bin);const{w:i,h:r}=e.p(t),n=this.atlasImage;n.resize({width:i||1,height:r||1});for(const t in this.patterns){const{bin:i}=this.patterns[t],r=i.x+1,a=i.y+1,s=this.getImage(t).data,o=s.width,l=s.height;e.R.copy(s,n,{x:0,y:0},{x:r,y:a},{width:o,height:l}),e.R.copy(s,n,{x:0,y:l-1},{x:r,y:a-1},{width:o,height:1}),e.R.copy(s,n,{x:0,y:0},{x:r,y:a+l},{width:o,height:1}),e.R.copy(s,n,{x:o-1,y:0},{x:r-1,y:a},{width:1,height:l}),e.R.copy(s,n,{x:0,y:0},{x:r+o,y:a},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const i of t){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const t=this.getImage(i);t||e.w(`Image with ID: "${i}" was not found`),w(t)&&this.updateImage(i,t)}}}const T=1e20;function S(t,e,i,r,n,a,s,o,l){for(let c=e;c<e+r;c++)C(t,i*a+c,a,n,s,o,l);for(let c=i;c<i+n;c++)C(t,c*a+e,1,r,s,o,l)}function C(t,e,i,r,n,a,s){a[0]=0,s[0]=-T,s[1]=T,n[0]=t[e];for(let o=1,l=0,c=0;o<r;o++){n[o]=t[e+o*i];const r=o*o;do{const t=a[l];c=(n[o]-n[t]+r-t*t)/(o-t)/2}while(c<=s[l]&&--l>-1);l++,a[l]=o,s[l]=c,s[l+1]=T}for(let o=0,l=0;o<r;o++){for(;s[l+1]<o;)l++;const r=a[l],c=o-r;t[e+o*i]=n[r]+c*c}}class E{constructor(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return e._(this,void 0,void 0,(function*(){const e=[];for(const i in t)for(const r of t[i])e.push(this._getAndCacheGlyphsPromise(i,r));const i=yield Promise.all(e),r={};for(const{stack:t,id:e,glyph:n}of i)r[t]||(r[t]={}),r[t][e]=n&&{id:n.id,bitmap:n.bitmap.clone(),metrics:n.metrics};return r}))}_getAndCacheGlyphsPromise(t,i){return e._(this,void 0,void 0,(function*(){let e=this.entries[t];e||(e=this.entries[t]={glyphs:{},requests:{},ranges:{}});let r=e.glyphs[i];if(void 0!==r)return{stack:t,id:i,glyph:r};if(r=this._tinySDF(e,t,i),r)return e.glyphs[i]=r,{stack:t,id:i,glyph:r};const n=Math.floor(i/256);if(256*n>65535)throw new Error("glyphs > 65535 not supported");if(e.ranges[n])return{stack:t,id:i,glyph:r};if(!this.url)throw new Error("glyphsUrl is not set");if(!e.requests[n]){const i=E.loadGlyphRange(t,n,this.url,this.requestManager);e.requests[n]=i}const a=yield e.requests[n];for(const t in a)this._doesCharSupportLocalGlyph(+t)||(e.glyphs[+t]=a[+t]);return e.ranges[n]=!0,{stack:t,id:i,glyph:a[i]||null}}))}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(e.u["CJK Unified Ideographs"](t)||e.u["Hangul Syllables"](t)||e.u.Hiragana(t)||e.u.Katakana(t))}_tinySDF(t,i,r){const n=this.localIdeographFontFamily;if(!n)return;if(!this._doesCharSupportLocalGlyph(r))return;let a=t.tinySDF;if(!a){let e="400";/bold/i.test(i)?e="900":/medium/i.test(i)?e="500":/light/i.test(i)&&(e="200"),a=t.tinySDF=new E.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:n,fontWeight:e})}const s=a.draw(String.fromCharCode(r));return{id:r,bitmap:new e.o({width:s.width||60,height:s.height||60},s.data),metrics:{width:s.glyphWidth/2||24,height:s.glyphHeight/2||24,left:s.glyphLeft/2+.5||0,top:s.glyphTop/2-27.5||-8,advance:s.glyphAdvance/2||24,isDoubleResolution:!0}}}}E.loadGlyphRange=function(t,i,r,n){return e._(this,void 0,void 0,(function*(){const a=256*i,s=a+255,o=n.transformRequest(r.replace("{fontstack}",t).replace("{range}",`${a}-${s}`),"Glyphs"),l=yield e.l(o,new AbortController);if(!l||!l.data)throw new Error(`Could not load glyph range. range: ${i}, ${a}-${s}`);const c={};for(const t of e.n(l.data))c[t.id]=t;return c}))},E.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:i=8,cutoff:r=.25,fontFamily:n="sans-serif",fontWeight:a="normal",fontStyle:s="normal"}={}){this.buffer=e,this.cutoff=r,this.radius=i;const o=this.size=t+4*e,l=this._createCanvas(o),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${s} ${a} ${t}px ${n}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(o*o),this.gridInner=new Float64Array(o*o),this.f=new Float64Array(o),this.z=new Float64Array(o+1),this.v=new Uint16Array(o)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:n,actualBoundingBoxRight:a}=this.ctx.measureText(t),s=Math.ceil(i),o=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-n))),l=Math.min(this.size-this.buffer,s+Math.ceil(r)),c=o+2*this.buffer,d=l+2*this.buffer,h=Math.max(c*d,0),p=new Uint8ClampedArray(h),u={data:p,width:c,height:d,glyphWidth:o,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:e};if(0===o||0===l)return u;const{ctx:m,buffer:f,gridInner:g,gridOuter:_}=this;m.clearRect(f,f,o,l),m.fillText(t,f,f+s);const v=m.getImageData(f,f,o,l);_.fill(T,0,h),g.fill(0,0,h);for(let t=0;t<l;t++)for(let e=0;e<o;e++){const i=v.data[4*(t*o+e)+3]/255;if(0===i)continue;const r=(t+f)*c+e+f;if(1===i)_[r]=0,g[r]=T;else{const t=.5-i;_[r]=t>0?t*t:0,g[r]=t<0?t*t:0}}S(_,0,0,c,d,c,this.f,this.v,this.z),S(g,f,f,o,l,c,this.f,this.v,this.z);for(let t=0;t<h;t++){const e=Math.sqrt(_[t])-Math.sqrt(g[t]);p[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return u}};class ${constructor(){this.specification=e.v.light.position}possiblyEvaluate(t,i){return e.y(t.expression.evaluate(i))}interpolate(t,i,r){return{x:e.z.number(t.x,i.x,r),y:e.z.number(t.y,i.y,r),z:e.z.number(t.z,i.z,r)}}}let A;class I extends e.E{constructor(t){super(),A=A||new e.q({anchor:new e.D(e.v.light.anchor),position:new $,color:new e.D(e.v.light.color),intensity:new e.D(e.v.light.intensity)}),this._transitionable=new e.T(A),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,i={}){if(!this._validate(e.r,t,i))for(const e in t){const i=t[e];e.endsWith("-transition")?this._transitionable.setTransition(e.slice(0,-11),i):this._transitionable.setValue(e,i)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,i,r){return(!r||!1!==r.validate)&&e.t(this,t.call(e.x,{value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.v}))}}class M{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,e){const i=t.join(",")+String(e);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(t,e)),this.dashEntry[i]}getDashRanges(t,e,i){const r=[];let n=t.length%2==1?-t[t.length-1]*i:0,a=t[0]*i,s=!0;r.push({left:n,right:a,isDash:s,zeroLength:0===t[0]});let o=t[0];for(let e=1;e<t.length;e++){s=!s;const l=t[e];n=o*i,o+=l,a=o*i,r.push({left:n,right:a,isDash:s,zeroLength:0===l})}return r}addRoundDash(t,e,i){const r=e/2;for(let e=-i;e<=i;e++){const n=this.width*(this.nextRow+i+e);let a=0,s=t[a];for(let o=0;o<this.width;o++){o/s.right>1&&(s=t[++a]);const l=Math.abs(o-s.left),c=Math.abs(o-s.right),d=Math.min(l,c);let h;const p=e/i*(r+1);if(s.isDash){const t=r-Math.abs(p);h=Math.sqrt(d*d+t*t)}else h=r-Math.sqrt(d*d+p*p);this.data[n+o]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(t){for(let e=t.length-1;e>=0;--e){const i=t[e],r=t[e+1];i.zeroLength?t.splice(e,1):r&&r.isDash===i.isDash&&(r.left=i.left,t.splice(e,1))}const e=t[0],i=t[t.length-1];e.isDash===i.isDash&&(e.left=i.left-this.width,i.right=e.right+this.width);const r=this.width*this.nextRow;let n=0,a=t[n];for(let e=0;e<this.width;e++){e/a.right>1&&(a=t[++n]);const i=Math.abs(e-a.left),s=Math.abs(e-a.right),o=Math.min(i,s);this.data[r+e]=Math.max(0,Math.min(255,(a.isDash?o:-o)+128))}}addDash(t,i){const r=i?7:0,n=2*r+1;if(this.nextRow+n>this.height)return e.w("LineAtlas out of space"),null;let a=0;for(let e=0;e<t.length;e++)a+=t[e];if(0!==a){const e=this.width/a,n=this.getDashRanges(t,this.width,e);i?this.addRoundDash(n,e,r):this.addRegularDash(n)}const s={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:a};return this.nextRow+=n,this.dirty=!0,s}bind(t){const e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))}}const L="maplibre_preloaded_worker_pool";class P{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<P.workerCount;)this.workers.push(new Worker(e.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((t=>{t.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[L]}numActive(){return Object.keys(this.active).length}}const R=Math.floor(a.hardwareConcurrency/2);let z,D;function j(){return z||(z=new P),z}P.workerCount=e.B(globalThis)?Math.max(Math.min(R,3),1):1;class O{constructor(t,i){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=i;const r=this.workerPool.acquire(i);for(let t=0;t<r.length;t++){const n=new e.C(r[t],i);n.name=`Worker ${t}`,this.actors.push(n)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,e){const i=[];for(const r of this.actors)i.push(r.sendAsync({type:t,data:e}));return Promise.all(i)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((t=>{t.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,e){for(const i of this.actors)i.registerMessageHandler(t,e)}}function B(){return D||(D=new O(j(),e.G),D.registerMessageHandler("GR",((t,i,r)=>e.m(i,r)))),D}function F(t,i){const r=e.F();return e.H(r,r,[1,1,0]),e.J(r,r,[.5*t.width,.5*t.height,1]),e.K(r,r,t.calculatePosMatrix(i.toUnwrapped()))}function N(t,e,i,r,n,a){const s=function(t,e,i){if(t)for(const r of t){const t=e[r];if(t&&t.source===i&&"fill-extrusion"===t.type)return!0}else for(const t in e){const r=e[t];if(r.source===i&&"fill-extrusion"===r.type)return!0}return!1}(n&&n.layers,e,t.id),o=a.maxPitchScaleFactor(),l=t.tilesIn(r,o,s);l.sort(H);const c=[];for(const r of l)c.push({wrappedTileID:r.tileID.wrapped().key,queryResults:r.tile.queryRenderedFeatures(e,i,t._state,r.queryGeometry,r.cameraQueryGeometry,r.scale,n,a,o,F(t.transform,r.tileID))});const d=function(t){const e={},i={};for(const r of t){const t=r.queryResults,n=r.wrappedTileID,a=i[n]=i[n]||{};for(const i in t){const r=t[i],n=a[i]=a[i]||{},s=e[i]=e[i]||[];for(const t of r)n[t.featureIndex]||(n[t.featureIndex]=!0,s.push(t))}}return e}(c);for(const e in d)d[e].forEach((e=>{const i=e.feature,r=t.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=r}));return d}function H(t,e){const i=t.tileID,r=e.tileID;return i.overscaledZ-r.overscaledZ||i.canonical.y-r.canonical.y||i.wrap-r.wrap||i.canonical.x-r.canonical.x}function V(t,i,r){return e._(this,void 0,void 0,(function*(){let n=t;if(t.url?n=(yield e.h(i.transformRequest(t.url,"Source"),r)).data:yield a.frameAsync(r),!n)return null;const s=e.L(e.e(n,t),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in n&&n.vector_layers&&(s.vectorLayerIds=n.vector_layers.map((t=>t.id))),s}))}class U{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):Array.isArray(t)&&(4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof e.M?new e.M(t.lng,t.lat):e.M.convert(t),this}setSouthWest(t){return this._sw=t instanceof e.M?new e.M(t.lng,t.lat):e.M.convert(t),this}extend(t){const i=this._sw,r=this._ne;let n,a;if(t instanceof e.M)n=t,a=t;else{if(!(t instanceof U))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(U.convert(t)):this.extend(e.M.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(e.M.convert(t)):this;if(n=t._sw,a=t._ne,!n||!a)return this}return i||r?(i.lng=Math.min(n.lng,i.lng),i.lat=Math.min(n.lat,i.lat),r.lng=Math.max(a.lng,r.lng),r.lat=Math.max(a.lat,r.lat)):(this._sw=new e.M(n.lng,n.lat),this._ne=new e.M(a.lng,a.lat)),this}getCenter(){return new e.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new e.M(this.getWest(),this.getNorth())}getSouthEast(){return new e.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:i,lat:r}=e.M.convert(t);let n=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&n}static convert(t){return t instanceof U?t:t?new U(t):t}static fromLngLat(t,i=0){const r=360*i/40075017,n=r/Math.cos(Math.PI/180*t.lat);return new U(new e.M(t.lng-n,t.lat-r),new e.M(t.lng+n,t.lat+r))}}class Y{constructor(t,e,i){this.bounds=U.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=i||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const i=Math.pow(2,t.z),r=Math.floor(e.N(this.bounds.getWest())*i),n=Math.floor(e.O(this.bounds.getNorth())*i),a=Math.ceil(e.N(this.bounds.getEast())*i),s=Math.ceil(e.O(this.bounds.getSouth())*i);return t.x>=r&&t.x<a&&t.y>=n&&t.y<s}}class Z extends e.E{constructor(t,i,r,n){if(super(),this.id=t,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.e(this,e.L(i,["url","scheme","tileSize","promoteId"])),this._options=e.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(n)}load(){return e._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new e.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield V(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(e.e(this,t),t.bounds&&(this.tileBounds=new Y(t.bounds,this.minzoom,this.maxzoom)),this.fire(new e.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new e.j(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return e.e({},this._options)}loadTile(t){return e._(this,void 0,void 0,(function*(){const e=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i={request:this.map._requestManager.transformRequest(e,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.request.collectResourceTiming=this._collectResourceTiming;let r="RT";if(t.actor&&"expired"!==t.state){if("loading"===t.state)return new Promise(((e,i)=>{t.reloadPromise={resolve:e,reject:i}}))}else t.actor=this.dispatcher.getActor(),r="LT";t.abortController=new AbortController;try{const e=yield t.actor.sendAsync({type:r,data:i},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,e)}catch(e){if(delete t.abortController,t.aborted)return;if(e&&404!==e.status)throw e;this._afterTileLoadWorkerResponse(t,null)}}))}_afterTileLoadWorkerResponse(t,e){if(e&&e.resourceTiming&&(t.resourceTiming=e.resourceTiming),e&&this.map._refreshExpiredTiles&&t.setExpiryData(e),t.loadVectorData(e,this.map.painter),t.reloadPromise){const e=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(e.resolve).catch(e.reject)}}abortTile(t){return e._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return e._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class q extends e.E{constructor(t,i,r,n){super(),this.id=t,this.dispatcher=r,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.e({type:"raster"},i),e.e(this,e.L(i,["url","scheme","tileSize"]))}load(){return e._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new e.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield V(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,t&&(e.e(this,t),t.bounds&&(this.tileBounds=new Y(t.bounds,this.minzoom,this.maxzoom)),this.fire(new e.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new e.j(t))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return e.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return e._(this,void 0,void 0,(function*(){const e=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const i=yield u.getImage(this.map._requestManager.transformRequest(e,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(i&&i.data){this.map._refreshExpiredTiles&&i.cacheControl&&i.expires&&t.setExpiryData({cacheControl:i.cacheControl,expires:i.expires});const e=this.map.painter.context,r=e.gl,n=i.data;t.texture=this.map.painter.getTileTexture(n.width),t.texture?t.texture.update(n,{useMipmap:!0}):(t.texture=new x(e,n,r.RGBA,{useMipmap:!0}),t.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),e.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax)),t.state="loaded"}}catch(e){if(delete t.abortController,t.aborted)t.state="unloaded";else if(e)throw t.state="errored",e}}))}abortTile(t){return e._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return e._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class W extends q{constructor(t,i,r,n){super(t,i,r,n),this.type="raster-dem",this.maxzoom=22,this._options=e.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(t){return e._(this,void 0,void 0,(function*(){const i=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r=this.map._requestManager.transformRequest(i,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const i=yield u.getImage(r,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(i&&i.data){const r=i.data;this.map._refreshExpiredTiles&&i.cacheControl&&i.expires&&t.setExpiryData({cacheControl:i.cacheControl,expires:i.expires});const n=e.b(r)&&e.S()?r:yield this.readImageNow(r),a={type:this.type,uid:t.uid,source:this.id,rawImageData:n,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||"expired"===t.state){t.actor=this.dispatcher.getActor();const e=yield t.actor.sendAsync({type:"LDT",data:a});t.dem=e,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(e){if(delete t.abortController,t.aborted)t.state="unloaded";else if(e)throw t.state="errored",e}}))}readImageNow(t){return e._(this,void 0,void 0,(function*(){if("undefined"!=typeof VideoFrame&&e.U()){const i=t.width+2,r=t.height+2;try{return new e.R({width:i,height:r},yield e.V(t,-1,-1,i,r))}catch(t){}}return a.getImageData(t,1)}))}_getNeighboringTiles(t){const i=t.canonical,r=Math.pow(2,i.z),n=(i.x-1+r)%r,a=0===i.x?t.wrap-1:t.wrap,s=(i.x+1+r)%r,o=i.x+1===r?t.wrap+1:t.wrap,l={};return l[new e.Q(t.overscaledZ,a,i.z,n,i.y).key]={backfilled:!1},l[new e.Q(t.overscaledZ,o,i.z,s,i.y).key]={backfilled:!1},i.y>0&&(l[new e.Q(t.overscaledZ,a,i.z,n,i.y-1).key]={backfilled:!1},l[new e.Q(t.overscaledZ,t.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},l[new e.Q(t.overscaledZ,o,i.z,s,i.y-1).key]={backfilled:!1}),i.y+1<r&&(l[new e.Q(t.overscaledZ,a,i.z,n,i.y+1).key]={backfilled:!1},l[new e.Q(t.overscaledZ,t.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},l[new e.Q(t.overscaledZ,o,i.z,s,i.y+1).key]={backfilled:!1}),l}unloadTile(t){return e._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}class G extends e.E{constructor(t,i,r,n){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=r.getActor(),this.setEventedParent(n),this._data=i.data,this._options=e.e({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const a=e.W/this.tileSize;this.workerOptions=e.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*a,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*a,extent:e.W,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:e.W,radius:(i.clusterRadius||50)*a,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){return e._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return e._(this,void 0,void 0,(function*(){const t=e.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(void 0!==t.clusterRadius&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),void 0!==t.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,e,i){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:e,offset:i}})}_updateWorkerData(t){return e._(this,void 0,void 0,(function*(){const i=e.e({type:this.type},this.workerOptions);t?i.dataDiff=t:"string"==typeof this._data?(i.request=this.map._requestManager.transformRequest(a.resolveURL(this._data),"Source"),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new e.k("dataloading",{dataType:"source"}));try{const t=yield this.actor.sendAsync({type:"LD",data:i});if(this._pendingLoads--,this._removed||t.abandoned)return void this.fire(new e.k("dataabort",{dataType:"source"}));let r=null;t.resourceTiming&&t.resourceTiming[this.id]&&(r=t.resourceTiming[this.id].slice(0));const n={dataType:"source"};this._collectResourceTiming&&r&&r.length>0&&e.e(n,{resourceTiming:r}),this.fire(new e.k("data",Object.assign(Object.assign({},n),{sourceDataType:"metadata"}))),this.fire(new e.k("data",Object.assign(Object.assign({},n),{sourceDataType:"content"})))}catch(t){if(this._pendingLoads--,this._removed)return void this.fire(new e.k("dataabort",{dataType:"source"}));this.fire(new e.j(t))}}))}loaded(){return 0===this._pendingLoads}loadTile(t){return e._(this,void 0,void 0,(function*(){const e=t.actor?"RT":"LT";t.actor=this.actor;const i={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.abortController=new AbortController;const r=yield this.actor.sendAsync({type:e,data:i},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(r,this.map.painter,"RT"===e)}))}abortTile(t){return e._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return e._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return e.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var X=e.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class K extends e.E{constructor(t,e,i,r){super(),this.id=t,this.dispatcher=i,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(r),this.options=e}load(t){return e._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new e.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const e=yield u.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,e&&e.data&&(this.image=e.data,t&&(this.coordinates=t),this._finishLoading())}catch(t){this._request=null,this._loaded=!0,this.fire(new e.j(t))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const i=t.map(e.Y.fromLngLat);this.tileID=function(t){let i=1/0,r=1/0,n=-1/0,a=-1/0;for(const e of t)i=Math.min(i,e.x),r=Math.min(r,e.y),n=Math.max(n,e.x),a=Math.max(a,e.y);const s=Math.max(n-i,a-r),o=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),l=Math.pow(2,o);return new e.a0(o,Math.floor((i+n)/2*l),Math.floor((r+a)/2*l))}(i),this.minzoom=this.maxzoom=this.tileID.z;const r=i.map((t=>this.tileID.getTilePoint(t)._round()));return this._boundsArray=new e.Z,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,e.W,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,e.W),this._boundsArray.emplaceBack(r[2].x,r[2].y,e.W,e.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,i=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new x(t,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,r=!0)}r&&this.fire(new e.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return e._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class J extends K{constructor(t,e,i,r){super(t,e,i,r),this.roundZoom=!0,this.type="video",this.options=e}load(){return e._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const e of t.urls)this.urls.push(this.map._requestManager.transformRequest(e,"Source").url);try{const t=yield e.a2(this.urls);if(this._loaded=!0,!t)return;this.video=t,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(t){this.fire(new e.j(t))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const i=this.video.seekable;t<i.start(0)||t>i.end(0)?this.fire(new e.j(new e.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,i=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new x(t,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,r=!0)}r&&this.fire(new e.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Q extends K{constructor(t,i,r,n){super(t,i,r,n),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some((t=>!Array.isArray(t)||2!==t.length||t.some((t=>"number"!=typeof t))))||this.fire(new e.j(new e.a1(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.j(new e.a1(`sources.${t}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new e.j(new e.a1(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof HTMLCanvasElement||this.fire(new e.j(new e.a1(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.j(new e.a1(`sources.${t}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){return e._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const i=this.map.painter.context,r=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.$.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new x(i,this.canvas,r.RGBA,{premultiply:!0});let n=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,n=!0)}n&&this.fire(new e.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const tt={},et=t=>{switch(t){case"geojson":return G;case"image":return K;case"raster":return q;case"raster-dem":return W;case"vector":return Z;case"video":return J;case"canvas":return Q}return tt[t]},it="RTLPluginLoaded";class rt extends e.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=B()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((t=>{throw this.status="error",t}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return e._(this,arguments,void 0,(function*(t,e=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=a.resolveURL(t),!this.url)throw new Error(`requested url ${t} is invalid`);if("unavailable"===this.status){if(!e)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if("requested"===this.status)return this._requestImport()}))}_requestImport(){return e._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new e.k(it))}))}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let nt=null;function at(){return nt||(nt=new rt),nt}class st{constructor(t,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=e.a3(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const e=t+this.timeAdded;e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,i,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const i={};if(!e)return i;for(const r of t){const t=r.layerIds.map((t=>e.getLayer(t))).filter(Boolean);if(0!==t.length){r.layers=t,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map((e=>t.filter((t=>t.id===e))[0])));for(const e of t)i[e.id]=r}}return i}(t.buckets,i.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const i=this.buckets[t];if(i instanceof e.a5){if(this.hasSymbolBuckets=!0,!r)break;i.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const i=this.buckets[t];if(i instanceof e.a5&&i.hasRTLText){this.hasRTLText=!0,at().lazyLoad();break}}this.queryPadding=0;for(const t in this.buckets){const e=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(t).queryRadius(e))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new e.a4}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const e in this.buckets){const i=this.buckets[e];i.uploadPending()&&i.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new x(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new x(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,i,r,n,a,s,o,l,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:n,scale:a,tileSize:this.tileSize,pixelPosMatrix:c,transform:o,params:s,queryPadding:this.queryPadding*l},t,e,i):{}}querySourceFeatures(t,i){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const n=r.loadVTLayers(),a=i&&i.sourceLayer?i.sourceLayer:"",s=n._geojsonTileLayer||n[a];if(!s)return;const o=e.a6(i&&i.filter),{z:l,x:c,y:d}=this.tileID.canonical,h={z:l,x:c,y:d};for(let i=0;i<s.length;i++){const n=s.feature(i);if(o.needGeometry){const t=e.a7(n,!0);if(!o.filter(new e.a8(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!o.filter(new e.a8(this.tileID.overscaledZ),n))continue;const p=r.getId(n,a),u=new e.a9(n,l,c,d,p);u.tile=h,t.push(u)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const i=this.expirationTime;if(t.cacheControl){const i=e.aa(t.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let e=!1;if(this.expirationTime>t)e=!1;else if(i)if(this.expirationTime<i)e=!0;else{const r=this.expirationTime-i;r?this.expirationTime=t+Math.max(r,3e4):e=!0}else e=!0;e?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length)return;const i=this.latestFeatureIndex.loadVTLayers();for(const r in this.buckets){if(!e.style.hasLayer(r))continue;const n=this.buckets[r],a=n.layers[0].sourceLayer||"_geojsonTileLayer",s=i[a],o=t[a];if(!s||!o||0===Object.keys(o).length)continue;n.update(o,s,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=e&&e.style&&e.style.getLayer(r);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(n)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=a.now()+t}setDependencies(t,e){const i={};for(const t of e)i[t]=!0;this.dependencies[t]=i}hasDependency(t,e){for(const i of t){const t=this.dependencies[i];if(t)for(const i of e)if(t[i])return!0}return!1}}class ot{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,i){const r=t.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);const n={value:e,timeout:void 0};if(void 0!==i&&(n.timeout=setTimeout((()=>{this.remove(t,n)}),i)),this.data[r].push(n),this.order.push(r),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const i=t.wrapped().key,r=void 0===e?0:this.data[i].indexOf(e),n=this.data[i][r];return this.data[i].splice(r,1),n.timeout&&clearTimeout(n.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(n.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const i in this.data)for(const r of this.data[i])t(r.value)||e.push(r);for(const t of e)this.remove(t.value.tileID,t)}}class lt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,i,r){const n=String(i);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][n]=this.stateChanges[t][n]||{},e.e(this.stateChanges[t][n],r),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==n&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][n]){this.deletedStates[t][n]={};for(const e in this.state[t][n])r[e]||(this.deletedStates[t][n][e]=null)}else for(const e in r)this.deletedStates[t]&&this.deletedStates[t][n]&&null===this.deletedStates[t][n][e]&&delete this.deletedStates[t][n][e]}removeFeatureState(t,e,i){if(null===this.deletedStates[t])return;const r=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},i&&void 0!==e)null!==this.deletedStates[t][r]&&(this.deletedStates[t][r]=this.deletedStates[t][r]||{},this.deletedStates[t][r][i]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][r])for(i in this.deletedStates[t][r]={},this.stateChanges[t][r])this.deletedStates[t][r][i]=null;else this.deletedStates[t][r]=null;else this.deletedStates[t]=null}getState(t,i){const r=String(i),n=e.e({},(this.state[t]||{})[r],(this.stateChanges[t]||{})[r]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const e=this.deletedStates[t][i];if(null===e)return{};for(const t in e)delete n[t]}return n}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,i){const r={};for(const t in this.stateChanges){this.state[t]=this.state[t]||{};const i={};for(const r in this.stateChanges[t])this.state[t][r]||(this.state[t][r]={}),e.e(this.state[t][r],this.stateChanges[t][r]),i[r]=this.state[t][r];r[t]=i}for(const t in this.deletedStates){this.state[t]=this.state[t]||{};const i={};if(null===this.deletedStates[t])for(const e in this.state[t])i[e]={},this.state[t][e]={};else for(const e in this.deletedStates[t]){if(null===this.deletedStates[t][e])this.state[t][e]={};else for(const i of Object.keys(this.deletedStates[t][e]))delete this.state[t][e][i];i[e]=this.state[t][e]}r[t]=r[t]||{},e.e(r[t],i)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(const e in t)t[e].setFeatureState(r,i)}}class ct extends e.E{constructor(t,e,i){super(),this.id=t,this.dispatcher=i,this.on("data",(t=>this._dataHandler(t))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((t,e,i,r)=>{const n=new(et(e.type))(t,e,i,r);if(n.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${n.id}`);return n})(t,e,i,this),this._tiles={},this._cache=new ot(0,(t=>this._unloadTile(t))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new lt,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,i,r){return e._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,i,r)}catch(i){t.state="errored",404!==i.status?this._source.fire(new e.j(i,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new e.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const i=this._tiles[e];i.upload(t),i.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((t=>t.tileID)).sort(dt).map((t=>t.key))}getRenderableIds(t){const i=[];for(const e in this._tiles)this._isIdRenderable(e,t)&&i.push(this._tiles[e]);return t?i.sort(((t,i)=>{const r=t.tileID,n=i.tileID,a=new e.P(r.canonical.x,r.canonical.y)._rotate(this.transform.angle),s=new e.P(n.canonical.x,n.canonical.y)._rotate(this.transform.angle);return r.overscaledZ-n.overscaledZ||s.y-a.y||s.x-a.x})).map((t=>t.tileID.key)):i.map((t=>t.tileID)).sort(dt).map((t=>t.key))}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")}}_reloadTile(t,i){return e._(this,void 0,void 0,(function*(){const e=this._tiles[t];e&&("loading"!==e.state&&(e.state=i),yield this._loadTile(e,t,i))}))}_tileLoaded(t,i,r){t.timeAdded=a.now(),"expired"===r&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(i,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new e.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const e=this.getRenderableIds();for(let r=0;r<e.length;r++){const n=e[r];if(t.neighboringTiles&&t.neighboringTiles[n]){const e=this.getTileByID(n);i(t,e),i(e,t)}}function i(t,e){t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0;let i=e.tileID.canonical.x-t.tileID.canonical.x;const r=e.tileID.canonical.y-t.tileID.canonical.y,n=Math.pow(2,t.tileID.canonical.z),a=e.tileID.key;0===i&&0===r||Math.abs(r)>1||(Math.abs(i)>1&&(1===Math.abs(i+n)?i+=n:1===Math.abs(i-n)&&(i-=n)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,i,r),t.neighboringTiles&&t.neighboringTiles[a]&&(t.neighboringTiles[a].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,i,r){for(const n in this._tiles){let a=this._tiles[n];if(r[n]||!a.hasData()||a.tileID.overscaledZ<=e||a.tileID.overscaledZ>i)continue;let s=a.tileID;for(;a&&a.tileID.overscaledZ>e+1;){const t=a.tileID.scaledTo(a.tileID.overscaledZ-1);a=this._tiles[t.key],a&&a.hasData()&&(s=t)}let o=s;for(;o.overscaledZ>e;)if(o=o.scaledTo(o.overscaledZ-1),t[o.key]){r[s.key]=s;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const i=this._loadedParentTiles[t.key];return i&&i.tileID.overscaledZ>=e?i:null}for(let i=t.overscaledZ-1;i>=e;i--){const e=t.scaledTo(i),r=this._getLoadedTile(e);if(r)return r}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const i=Math.ceil(t.width/this._source.tileSize)+1,r=Math.ceil(t.height/this._source.tileSize)+1,n=Math.floor(i*r*(null===this._maxTileCacheZoomLevels?e.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(a)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const i in this._tiles){const r=this._tiles[i];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),t[r.tileID.key]=r}this._tiles=t;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(t,this._tiles[t])}}_updateCoveredAndRetainedTiles(t,e,i,r,n,s){const o={},l={},c=Object.keys(t),d=a.now();for(const i of c){const r=t[i],n=this._tiles[i];if(!n||0!==n.fadeEndTime&&n.fadeEndTime<=d)continue;const a=this.findLoadedParent(r,e),s=this.findLoadedSibling(r),c=a||s||null;c&&(this._addTile(c.tileID),o[c.tileID.key]=c.tileID),l[i]=r}this._retainLoadedChildren(l,r,i,t);for(const e in o)t[e]||(this._coveredTiles[e]=!0,t[e]=o[e]);if(s){const e={},i={};for(const t of n)this._tiles[t.key].hasData()?e[t.key]=t:i[t.key]=t;for(const r in i){const n=i[r].children(this._source.maxzoom);this._tiles[n[0].key]&&this._tiles[n[1].key]&&this._tiles[n[2].key]&&this._tiles[n[3].key]&&(e[n[0].key]=t[n[0].key]=n[0],e[n[1].key]=t[n[1].key]=n[1],e[n[2].key]=t[n[2].key]=n[2],e[n[3].key]=t[n[3].key]=n[3],delete i[r])}for(const r in i){const n=i[r],a=this.findLoadedParent(n,this._source.minzoom),s=this.findLoadedSibling(n),o=a||s||null;if(o){e[o.tileID.key]=t[o.tileID.key]=o.tileID;for(const t in e)e[t].isChildOf(o.tileID)&&delete e[t]}}for(const t in this._tiles)e[t]||(this._coveredTiles[t]=!0)}}update(t,i){if(!this._sourceLoaded||this._paused)return;let r;this.transform=t,this.terrain=i,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?r=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new e.Q(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y))):(r=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i}),this._source.hasTile&&(r=r.filter((t=>this._source.hasTile(t))))):r=[];const n=t.coveringZoomLevel(this._source),a=Math.max(n-ct.maxOverzooming,this._source.minzoom),s=Math.max(n+ct.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const t={};for(const e of r)if(e.canonical.z>this._source.minzoom){const i=e.scaledTo(e.canonical.z-1);t[i.key]=i;const r=e.scaledTo(Math.max(this._source.minzoom,Math.min(e.canonical.z,5)));t[r.key]=r}r=r.concat(Object.values(t))}const o=0===r.length&&!this._updated&&this._didEmitContent;this._updated=!0,o&&this.fire(new e.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const l=this._updateRetainedTiles(r,n);ht(this._source.type)&&this._updateCoveredAndRetainedTiles(l,a,s,n,r,i);for(const t in l)this._tiles[t].clearFadeHold();const c=e.ab(this._tiles,l);for(const t of c){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(t)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,e){var i;const r={},n={},a=Math.max(e-ct.maxOverzooming,this._source.minzoom),s=Math.max(e+ct.maxUnderzooming,this._source.minzoom),o={};for(const i of t){const t=this._addTile(i);r[i.key]=i,t.hasData()||e<this._source.maxzoom&&(o[i.key]=i)}this._retainLoadedChildren(o,e,s,r);for(const s of t){let t=this._tiles[s.key];if(t.hasData())continue;if(e+1>this._source.maxzoom){const t=s.children(this._source.maxzoom)[0],e=this.getTile(t);if(e&&e.hasData()){r[t.key]=t;continue}}else{const t=s.children(this._source.maxzoom);if(r[t[0].key]&&r[t[1].key]&&r[t[2].key]&&r[t[3].key])continue}let o=t.wasRequested();for(let e=s.overscaledZ-1;e>=a;--e){const a=s.scaledTo(e);if(n[a.key])break;if(n[a.key]=!0,t=this.getTile(a),!t&&o&&(t=this._addTile(a)),t){const e=t.hasData();if((e||!(null===(i=this.map)||void 0===i?void 0:i.cancelPendingTileRequestsWhileZooming)||o)&&(r[a.key]=a),o=t.wasRequested(),e)break}}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let i,r=this._tiles[t].tileID;for(;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){i=this._loadedParentTiles[r.key];break}e.push(r.key);const t=r.scaledTo(r.overscaledZ-1);if(i=this._getLoadedTile(t),i)break;r=t}for(const t of e)this._loadedParentTiles[t]=i}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const e=this._tiles[t].tileID,i=this._getLoadedTile(e);this._loadedSiblingTiles[e.key]=i}}_addTile(t){let i=this._tiles[t.key];if(i)return i;i=this._cache.getAndRemove(t),i&&(this._setTileReloadTimer(t.key,i),i.tileID=t,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,i)));const r=i;return i||(i=new st(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(i,t.key,i.state)),i.uses++,this._tiles[t.key]=i,r||this._source.fire(new e.k("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),i))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}_dataHandler(t){const e=t.sourceDataType;"source"===t.dataType&&"metadata"===e&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===e&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,i,r){const n=[],a=this.transform;if(!a)return n;const s=r?a.getCameraQueryGeometry(t):t,o=t.map((t=>a.pointCoordinate(t,this.terrain))),l=s.map((t=>a.pointCoordinate(t,this.terrain))),c=this.getIds();let d=1/0,h=1/0,p=-1/0,u=-1/0;for(const t of l)d=Math.min(d,t.x),h=Math.min(h,t.y),p=Math.max(p,t.x),u=Math.max(u,t.y);for(let t=0;t<c.length;t++){const r=this._tiles[c[t]];if(r.holdingForFade())continue;const s=r.tileID,m=Math.pow(2,a.zoom-r.tileID.overscaledZ),f=i*r.queryPadding*e.W/r.tileSize/m,g=[s.getTilePoint(new e.Y(d,h)),s.getTilePoint(new e.Y(p,u))];if(g[0].x-f<e.W&&g[0].y-f<e.W&&g[1].x+f>=0&&g[1].y+f>=0){const t=o.map((t=>s.getTilePoint(t))),e=l.map((t=>s.getTilePoint(t)));n.push({tile:r,tileID:s,queryGeometry:t,cameraQueryGeometry:e,scale:m})}}return n}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map((t=>this._tiles[t].tileID));for(const t of e)t.posMatrix=this.transform.calculatePosMatrix(t.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(ht(this._source.type)){const t=a.now();for(const e in this._tiles)if(this._tiles[e].fadeEndTime>=t)return!0}return!1}setFeatureState(t,e,i){this._state.updateState(t=t||"_geojsonTileLayer",e,i)}removeFeatureState(t,e,i){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,i)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,i){const r=this._tiles[t];r&&r.setDependencies(e,i)}reloadTilesForDependencies(t,e){for(const i in this._tiles)this._tiles[i].hasDependency(t,e)&&this._reloadTile(i,"reloading");this._cache.filter((i=>!i.hasDependency(t,e)))}}function dt(t,e){const i=Math.abs(2*t.wrap)-+(t.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||r-i||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function ht(t){return"raster"===t||"image"===t||"video"===t}ct.maxOverzooming=10,ct.maxUnderzooming=3;class pt{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let t=1;t<this.points.length;t++)this._distances[t]=this._distances[t-1]+this.points[t].dist(this.points[t-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=e.ac(t,0,1);let i=1,r=this._distances[i];const n=t*this.paddedLength+this.padding;for(;r<n&&i<this._distances.length;)r=this._distances[++i];const a=i-1,s=this._distances[a],o=r-s,l=o>0?(n-s)/o:0;return this.points[a].mult(1-l).add(this.points[i].mult(l))}}function ut(t,e){let i=!0;return"always"===t||"never"!==t&&"never"!==e||(i=!1),i}class mt{constructor(t,e,i){const r=this.boxCells=[],n=this.circleCells=[];this.xCellCount=Math.ceil(t/i),this.yCellCount=Math.ceil(e/i);for(let t=0;t<this.xCellCount*this.yCellCount;t++)r.push([]),n.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,i,r,n){this._forEachCell(e,i,r,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)}insertCircle(t,e,i,r){this._forEachCell(e-r,i-r,e+r,i+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(i),this.circles.push(r)}_insertBoxCell(t,e,i,r,n,a){this.boxCells[n].push(a)}_insertCircleCell(t,e,i,r,n,a){this.circleCells[n].push(a)}_query(t,e,i,r,n,a,s){if(i<0||t>this.width||r<0||e>this.height)return[];const o=[];if(t<=0&&e<=0&&this.width<=i&&this.height<=r){if(n)return[{key:null,x1:t,y1:e,x2:i,y2:r}];for(let t=0;t<this.boxKeys.length;t++)o.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],i=this.circles[3*t+1],r=this.circles[3*t+2];o.push({key:this.circleKeys[t],x1:e-r,y1:i-r,x2:e+r,y2:i+r})}}else this._forEachCell(t,e,i,r,this._queryCell,o,{hitTest:n,overlapMode:a,seenUids:{box:{},circle:{}}},s);return o}query(t,e,i,r){return this._query(t,e,i,r,!1,null)}hitTest(t,e,i,r,n,a){return this._query(t,e,i,r,!0,n,a).length>0}hitTestCircle(t,e,i,r,n){const a=t-i,s=t+i,o=e-i,l=e+i;if(s<0||a>this.width||l<0||o>this.height)return!1;const c=[];return this._forEachCell(a,o,s,l,this._queryCellCircle,c,{hitTest:!0,overlapMode:r,circle:{x:t,y:e,radius:i},seenUids:{box:{},circle:{}}},n),c.length>0}_queryCell(t,e,i,r,n,a,s,o){const{seenUids:l,hitTest:c,overlapMode:d}=s,h=this.boxCells[n];if(null!==h){const n=this.bboxes;for(const s of h)if(!l.box[s]){l.box[s]=!0;const h=4*s,p=this.boxKeys[s];if(t<=n[h+2]&&e<=n[h+3]&&i>=n[h+0]&&r>=n[h+1]&&(!o||o(p))&&(!c||!ut(d,p.overlapMode))&&(a.push({key:p,x1:n[h],y1:n[h+1],x2:n[h+2],y2:n[h+3]}),c))return!0}}const p=this.circleCells[n];if(null!==p){const n=this.circles;for(const s of p)if(!l.circle[s]){l.circle[s]=!0;const h=3*s,p=this.circleKeys[s];if(this._circleAndRectCollide(n[h],n[h+1],n[h+2],t,e,i,r)&&(!o||o(p))&&(!c||!ut(d,p.overlapMode))){const t=n[h],e=n[h+1],i=n[h+2];if(a.push({key:p,x1:t-i,y1:e-i,x2:t+i,y2:e+i}),c)return!0}}}return!1}_queryCellCircle(t,e,i,r,n,a,s,o){const{circle:l,seenUids:c,overlapMode:d}=s,h=this.boxCells[n];if(null!==h){const t=this.bboxes;for(const e of h)if(!c.box[e]){c.box[e]=!0;const i=4*e,r=this.boxKeys[e];if(this._circleAndRectCollide(l.x,l.y,l.radius,t[i+0],t[i+1],t[i+2],t[i+3])&&(!o||o(r))&&!ut(d,r.overlapMode))return a.push(!0),!0}}const p=this.circleCells[n];if(null!==p){const t=this.circles;for(const e of p)if(!c.circle[e]){c.circle[e]=!0;const i=3*e,r=this.circleKeys[e];if(this._circlesCollide(t[i],t[i+1],t[i+2],l.x,l.y,l.radius)&&(!o||o(r))&&!ut(d,r.overlapMode))return a.push(!0),!0}}}_forEachCell(t,e,i,r,n,a,s,o){const l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),d=this._convertToXCellCoord(i),h=this._convertToYCellCoord(r);for(let p=l;p<=d;p++)for(let l=c;l<=h;l++)if(n.call(this,t,e,i,r,this.xCellCount*l+p,a,s,o))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,i,r,n,a){const s=r-t,o=n-e,l=i+a;return l*l>s*s+o*o}_circleAndRectCollide(t,e,i,r,n,a,s){const o=(a-r)/2,l=Math.abs(t-(r+o));if(l>o+i)return!1;const c=(s-n)/2,d=Math.abs(e-(n+c));if(d>c+i)return!1;if(l<=o||d<=c)return!0;const h=l-o,p=d-c;return h*h+p*p<=i*i}}function ft(t,i,r,n,a){const s=e.F();return i?(e.J(s,s,[1/a,1/a,1]),r||e.ad(s,s,n.angle)):e.K(s,n.labelPlaneMatrix,t),s}function gt(t,i,r,n,a){if(i){const i=e.ae(t);return e.J(i,i,[a,a,1]),r||e.ad(i,i,-n.angle),i}return n.glCoordMatrix}function _t(t,i,r){let n;r?(n=[t.x,t.y,r(t.x,t.y),1],e.af(n,n,i)):(n=[t.x,t.y,0,1],function(t,e,i){const r=e[0],n=e[1];t[0]=i[0]*r+i[4]*n+i[12],t[1]=i[1]*r+i[5]*n+i[13],t[3]=i[3]*r+i[7]*n+i[15]}(n,n,i));const a=n[3];return{point:new e.P(n[0]/a,n[1]/a),signedDistanceFromCamera:a,isOccluded:!1}}function vt(t,e){return.5+t/e*.5}function yt(t,e){return t.x>=-e[0]&&t.x<=e[0]&&t.y>=-e[1]&&t.y<=e[1]}function bt(t,i,r,n,a,s,o,l,c,d,h,p,u,m,f){const g=n?t.textSizeData:t.iconSizeData,_=e.ag(g,r.transform.zoom),v=[256/r.width*2+1,256/r.height*2+1],y=n?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;y.clear();const b=t.lineVertexArray,x=n?t.text.placedSymbolArray:t.icon.placedSymbolArray,w=r.transform.width/r.transform.height;let k=!1;for(let n=0;n<x.length;n++){const T=x.get(n);if(T.hidden||T.writingMode===e.ah.vertical&&!k){Mt(T.numGlyphs,y);continue}k=!1;const S=_t(new e.P(T.anchorX,T.anchorY),i,f);if(!yt(S.point,v)){Mt(T.numGlyphs,y);continue}const C=vt(r.transform.cameraToCenterDistance,S.signedDistanceFromCamera),E=e.ai(g,_,T),$=o?E/C:E*C,A={getElevation:f,labelPlaneMatrix:a,lineVertexArray:b,pitchWithMap:o,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:d,tileAnchorPoint:new e.P(T.anchorX,T.anchorY),unwrappedTileID:h,width:p,height:u,translation:m},I=kt(A,T,$,!1,l,i,s,t.glyphOffsetArray,y,w,c);k=I.useVertical,(I.notEnoughRoom||k||I.needsFlipping&&kt(A,T,$,!0,l,i,s,t.glyphOffsetArray,y,w,c).notEnoughRoom)&&Mt(T.numGlyphs,y)}n?t.text.dynamicLayoutVertexBuffer.updateData(y):t.icon.dynamicLayoutVertexBuffer.updateData(y)}function xt(t,e,i,r,n,a,s,o){const l=a.glyphStartIndex+a.numGlyphs,c=a.lineStartIndex,d=a.lineStartIndex+a.lineLength,h=e.getoffsetX(a.glyphStartIndex),p=e.getoffsetX(l-1),u=At(t*h,i,r,n,a.segment,c,d,o,s);if(!u)return null;const m=At(t*p,i,r,n,a.segment,c,d,o,s);return m?o.projectionCache.anyProjectionOccluded?null:{first:u,last:m}:null}function wt(t,i,r,n){return t===e.ah.horizontal&&Math.abs(r.y-i.y)>Math.abs(r.x-i.x)*n?{useVertical:!0}:(t===e.ah.vertical?i.y<r.y:i.x>r.x)?{needsFlipping:!0}:null}function kt(t,i,r,n,a,s,o,l,c,d,h){const p=r/24,u=i.lineOffsetX*p,m=i.lineOffsetY*p;let f;if(i.numGlyphs>1){const e=i.glyphStartIndex+i.numGlyphs,r=i.lineStartIndex,s=i.lineStartIndex+i.lineLength,c=xt(p,l,u,m,n,i,h,t);if(!c)return{notEnoughRoom:!0};const g=_t(c.first.point,o,t.getElevation).point,_=_t(c.last.point,o,t.getElevation).point;if(a&&!n){const t=wt(i.writingMode,g,_,d);if(t)return t}f=[c.first];for(let a=i.glyphStartIndex+1;a<e-1;a++)f.push(At(p*l.getoffsetX(a),u,m,n,i.segment,r,s,t,h));f.push(c.last)}else{if(a&&!n){const r=_t(t.tileAnchorPoint,s,t.getElevation).point,n=i.lineStartIndex+i.segment+1,a=new e.P(t.lineVertexArray.getx(n),t.lineVertexArray.gety(n)),o=_t(a,s,t.getElevation),l=o.signedDistanceFromCamera>0?o.point:function(t,e,i,r,n,a){return Tt(t,e,i,1,n,a)}(t.tileAnchorPoint,a,r,0,s,t),c=wt(i.writingMode,r,l,d);if(c)return c}const r=At(p*l.getoffsetX(i.glyphStartIndex),u,m,n,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,t,h);if(!r||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};f=[r]}for(const t of f)e.aj(c,t.point,t.angle);return{}}function Tt(t,e,i,r,n,a){const s=t.add(t.sub(e)._unit()),o=void 0!==n?_t(s,n,a.getElevation).point:Ct(s.x,s.y,a).point,l=i.sub(o);return i.add(l._mult(r/l.mag()))}function St(t,i,r){const n=i.projectionCache;if(n.projections[t])return n.projections[t];const a=new e.P(i.lineVertexArray.getx(t),i.lineVertexArray.gety(t)),s=Ct(a.x,a.y,i);if(s.signedDistanceFromCamera>0)return n.projections[t]=s.point,n.anyProjectionOccluded=n.anyProjectionOccluded||s.isOccluded,s.point;const o=t-r.direction;return function(t,e,i,r,n){return Tt(t,e,i,r,void 0,n)}(0===r.distanceFromAnchor?i.tileAnchorPoint:new e.P(i.lineVertexArray.getx(o),i.lineVertexArray.gety(o)),a,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,i)}function Ct(t,i,r){const n=t+r.translation[0],a=i+r.translation[1];let s;return!r.pitchWithMap&&r.projection.useSpecialProjectionForSymbols?(s=r.projection.projectTileCoordinates(n,a,r.unwrappedTileID,r.getElevation),s.point.x=(.5*s.point.x+.5)*r.width,s.point.y=(.5*-s.point.y+.5)*r.height):(s=_t(new e.P(n,a),r.labelPlaneMatrix,r.getElevation),s.isOccluded=!1),s}function Et(t,e,i){return t._unit()._perp()._mult(e*i)}function $t(t,i,r,n,a,s,o,l,c){if(l.projectionCache.offsets[t])return l.projectionCache.offsets[t];const d=r.add(i);if(t+c.direction<n||t+c.direction>=a)return l.projectionCache.offsets[t]=d,d;const h=St(t+c.direction,l,c),p=Et(h.sub(r),o,c.direction),u=r.add(p),m=h.add(p);return l.projectionCache.offsets[t]=e.ak(s,d,u,m)||d,l.projectionCache.offsets[t]}function At(t,e,i,r,n,a,s,o,l){const c=r?t-e:t+e;let d=c>0?1:-1,h=0;r&&(d*=-1,h=Math.PI),d<0&&(h+=Math.PI);let p,u=d>0?a+n:a+n+1;o.projectionCache.cachedAnchorPoint?p=o.projectionCache.cachedAnchorPoint:(p=Ct(o.tileAnchorPoint.x,o.tileAnchorPoint.y,o).point,o.projectionCache.cachedAnchorPoint=p);let m,f,g=p,_=p,v=0,y=0;const b=Math.abs(c),x=[];let w;for(;v+y<=b;){if(u+=d,u<a||u>=s)return null;v+=y,_=g,f=m;const t={absOffsetX:b,direction:d,distanceFromAnchor:v,previousVertex:_};if(g=St(u,o,t),0===i)x.push(_),w=g.sub(_);else{let e;const r=g.sub(_);e=0===r.mag()?Et(St(u+d,o,t).sub(g),i,d):Et(r,i,d),f||(f=_.add(e)),m=$t(u,e,g,a,s,f,i,o,t),x.push(f),w=m.sub(f)}y=w.mag()}const k=w._mult((b-v)/y)._add(f||_),T=h+Math.atan2(g.y-_.y,g.x-_.x);return x.push(k),{point:k,angle:l?T:0,path:x}}const It=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Mt(t,e){for(let i=0;i<t;i++){const t=e.length;e.resize(t+4),e.float32.set(It,3*t)}}const Lt=100;class Pt{constructor(t,e,i=new mt(t.width+200,t.height+200,25),r=new mt(t.width+200,t.height+200,25)){this.transform=t,this.mapProjection=e,this.grid=i,this.ignoredGrid=r,this.pitchFactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Lt,this.screenBottomBoundary=t.height+Lt,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,e,i,r,n,a,s,o,l,c,d){const h=t.anchorPointX+o[0],p=t.anchorPointY+o[1],u=this.projectAndGetPerspectiveRatio(r,h,p,n,c),m=this._projectCollisionBox(t,i,r,n,a,s,o,u,c,d),[f,g,_,v]=m.box;return this.mapProjection.useSpecialProjectionForSymbols&&(a?m.allPointsOccluded:this.mapProjection.isOccluded(h,p,n))||u.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(f,g,_,v)||"always"!==e&&this.grid.hitTest(f,g,_,v,e,l)?{box:[f,g,_,v],placeable:!1,offscreen:!1}:{box:[f,g,_,v],placeable:!0,offscreen:this.isOffscreen(f,g,_,v)}}placeCollisionCircles(t,i,r,n,a,s,o,l,c,d,h,p,u,m,f,g){const _=[],v=new e.P(i.anchorX,i.anchorY),y=this.getPerspectiveRatio(s,v.x,v.y,o,g),b=(h?a/y:a*y)/e.ap,x={getElevation:g,labelPlaneMatrix:l,lineVertexArray:r,pitchWithMap:h,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:v,unwrappedTileID:o,width:this.transform.width,height:this.transform.height,translation:f},w=xt(b,n,i.lineOffsetX*b,i.lineOffsetY*b,!1,i,!1,x);let k=!1,T=!1,S=!0;if(w){const i=.5*u*y+m,r=new e.P(-100,-100),n=new e.P(this.screenRightBoundary,this.screenBottomBoundary),a=new pt,s=w.first,o=w.last;let l=[];for(let t=s.path.length-1;t>=1;t--)l.push(s.path[t]);for(let t=1;t<o.path.length;t++)l.push(o.path[t]);const h=2.5*i;if(c){const t=this.projectPathToScreenSpace(l,x,c);l=t.some((t=>t.signedDistanceFromCamera<=0))?[]:t.map((t=>t.point))}let f=[];if(l.length>0){const t=l[0].clone(),i=l[0].clone();for(let e=1;e<l.length;e++)t.x=Math.min(t.x,l[e].x),t.y=Math.min(t.y,l[e].y),i.x=Math.max(i.x,l[e].x),i.y=Math.max(i.y,l[e].y);f=t.x>=r.x&&i.x<=n.x&&t.y>=r.y&&i.y<=n.y?[l]:i.x<r.x||t.x>n.x||i.y<r.y||t.y>n.y?[]:e.al([l],r.x,r.y,n.x,n.y)}for(const e of f){a.reset(e,.25*i);let r=0;r=a.length<=.5*i?1:Math.ceil(a.paddedLength/h)+1;for(let e=0;e<r;e++){const n=e/Math.max(r-1,1),s=a.lerp(n),o=s.x+Lt,l=s.y+Lt;_.push(o,l,i,0);const c=o-i,h=l-i,u=o+i,m=l+i;if(S=S&&this.isOffscreen(c,h,u,m),T=T||this.isInsideGrid(c,h,u,m),"always"!==t&&this.grid.hitTestCircle(o,l,i,t,p)&&(k=!0,!d))return{circles:[],offscreen:!1,collisionDetected:k}}}}return{circles:!d&&k||!T||y<this.perspectiveRatioCutoff?[]:_,offscreen:S,collisionDetected:k}}projectPathToScreenSpace(t,e,i){return t.map((t=>_t(t,i,e.getElevation)))}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const i=[];let r=1/0,n=1/0,a=-1/0,s=-1/0;for(const o of t){const t=new e.P(o.x+Lt,o.y+Lt);r=Math.min(r,t.x),n=Math.min(n,t.y),a=Math.max(a,t.x),s=Math.max(s,t.y),i.push(t)}const o=this.grid.query(r,n,a,s).concat(this.ignoredGrid.query(r,n,a,s)),l={},c={};for(const t of o){const r=t.key;if(void 0===l[r.bucketInstanceId]&&(l[r.bucketInstanceId]={}),l[r.bucketInstanceId][r.featureIndex])continue;const n=[new e.P(t.x1,t.y1),new e.P(t.x2,t.y1),new e.P(t.x2,t.y2),new e.P(t.x1,t.y2)];e.am(i,n)&&(l[r.bucketInstanceId][r.featureIndex]=!0,void 0===c[r.bucketInstanceId]&&(c[r.bucketInstanceId]=[]),c[r.bucketInstanceId].push(r.featureIndex))}return c}insertCollisionBox(t,e,i,r,n,a){(i?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:n,collisionGroupID:a,overlapMode:e},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,i,r,n,a){const s=i?this.ignoredGrid:this.grid,o={bucketInstanceId:r,featureIndex:n,collisionGroupID:a,overlapMode:e};for(let e=0;e<t.length;e+=4)s.insertCircle(o,t[e],t[e+1],t[e+2])}projectAndGetPerspectiveRatio(t,i,r,n,a){const s=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(i,r,n,a):_t(new e.P(i,r),t,a);return{point:new e.P((s.point.x+1)/2*this.transform.width+Lt,(1-s.point.y)/2*this.transform.height+Lt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/s.signedDistanceFromCamera*.5,isOccluded:s.isOccluded,signedDistanceFromCamera:s.signedDistanceFromCamera}}getPerspectiveRatio(t,i,r,n,a){const s=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(i,r,n,a):_t(new e.P(i,r),t,a);return.5+this.transform.cameraToCenterDistance/s.signedDistanceFromCamera*.5}isOffscreen(t,e,i,r){return i<Lt||t>=this.screenRightBoundary||r<Lt||e>this.screenBottomBoundary}isInsideGrid(t,e,i,r){return i>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const t=e.an([]);return e.H(t,t,[-100,-100,0]),t}_projectCollisionBox(t,i,r,n,a,s,o,l,c,d){const h=i*l.perspectiveRatio;let p=new e.P(1,0),u=new e.P(0,1);const m=new e.P(t.anchorPointX+o[0],t.anchorPointY+o[1]);if(s&&!a){const t=this.projectAndGetPerspectiveRatio(r,m.x+1,m.y,n,c).point.sub(l.point).unit(),i=Math.atan(t.y/t.x)+(t.x<0?Math.PI:0),a=Math.sin(i),s=Math.cos(i);p=new e.P(s,a),u=new e.P(-a,s)}else if(!s&&a){const t=-this.transform.angle,i=Math.sin(t),r=Math.cos(t);p=new e.P(r,i),u=new e.P(-i,r)}let f=l.point,g=h;if(a){f=m;const t=this.transform.zoom-Math.floor(this.transform.zoom);g=Math.pow(2,-t),g*=this.mapProjection.getPitchedTextCorrection(this.transform,m,n),d||(g*=e.ac(.5+l.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}d&&(f=f.add(p.mult(d.x*g)).add(u.mult(d.y*g)));const _=t.x1*g,v=t.x2*g,y=(_+v)/2,b=t.y1*g,x=t.y2*g,w=(b+x)/2,k=[{offsetX:_,offsetY:b},{offsetX:y,offsetY:b},{offsetX:v,offsetY:b},{offsetX:v,offsetY:w},{offsetX:v,offsetY:x},{offsetX:y,offsetY:x},{offsetX:_,offsetY:x},{offsetX:_,offsetY:w}];let T=[];for(const{offsetX:t,offsetY:i}of k)T.push(new e.P(f.x+p.x*t+u.x*i,f.y+p.y*t+u.y*i));let S=!1;if(a){const t=T.map((t=>this.projectAndGetPerspectiveRatio(r,t.x,t.y,n,c)));S=t.some((t=>!t.isOccluded)),T=t.map((t=>t.point))}else S=!0;return{box:e.ao(T),allPointsOccluded:!S}}}function Rt(t,i,r){return i*(e.W/(t.tileSize*Math.pow(2,r-t.tileID.overscaledZ)))}class zt{constructor(t,e,i,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&i?1:0,this.placed=i}isHidden(){return 0===this.opacity&&!this.placed}}class Dt{constructor(t,e,i,r,n){this.text=new zt(t?t.text:null,e,i,n),this.icon=new zt(t?t.icon:null,e,r,n)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class jt{constructor(t,e,i){this.text=t,this.icon=e,this.skipFade=i}}class Ot{constructor(){this.invProjMatrix=e.F(),this.viewportMatrix=e.F(),this.circles=[]}}class Bt{constructor(t,e,i,r,n){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=i,this.bucketIndex=r,this.tileID=n}}class Ft{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function Nt(t,i,r,n,a){const{horizontalAlign:s,verticalAlign:o}=e.au(t);return new e.P(-(s-.5)*i+n[0]*a,-(o-.5)*r+n[1]*a)}class Ht{constructor(t,e,i,r,n,a){this.transform=t.clone(),this.terrain=i,this.collisionIndex=new Pt(this.transform,e),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new Ft(n),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const e=this.terrain;return e?(i,r)=>e.getElevation(t,i,r):null}getBucketParts(t,i,r,n){const a=r.getBucket(i),s=r.latestFeatureIndex;if(!a||!s||i.id!==a.layerIds[0])return;const o=r.collisionBoxArray,l=a.layers[0].layout,c=a.layers[0].paint,d=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),h=r.tileSize/e.W,p=r.tileID.toUnwrapped(),u=this.transform.calculatePosMatrix(p),m="map"===l.get("text-pitch-alignment"),f="map"===l.get("text-rotation-alignment"),g=Rt(r,1,this.transform.zoom),_=this.collisionIndex.mapProjection.translatePosition(this.transform,r,c.get("text-translate"),c.get("text-translate-anchor")),v=this.collisionIndex.mapProjection.translatePosition(this.transform,r,c.get("icon-translate"),c.get("icon-translate-anchor")),y=ft(u,m,f,this.transform,g);let b=null;if(m){const t=gt(u,m,f,this.transform,g);b=e.K([],this.transform.labelPlaneMatrix,t)}this.retainedQueryData[a.bucketInstanceId]=new Bt(a.bucketInstanceId,s,a.sourceLayerIndex,a.index,r.tileID);const x={bucket:a,layout:l,translationText:_,translationIcon:v,posMatrix:u,unwrappedTileID:p,textLabelPlaneMatrix:y,labelToScreenMatrix:b,scale:d,textPixelRatio:h,holdingForFade:r.holdingForFade(),collisionBoxArray:o,partiallyEvaluatedTextSize:e.ag(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(n)for(const e of a.sortKeyRanges){const{sortKey:i,symbolInstanceStart:r,symbolInstanceEnd:n}=e;t.push({sortKey:i,symbolInstanceStart:r,symbolInstanceEnd:n,parameters:x})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:x})}attemptAnchorPlacement(t,i,r,n,a,s,o,l,c,d,h,p,u,m,f,g,_,v,y){const b=e.aq[t.textAnchor],x=[t.textOffset0,t.textOffset1],w=Nt(b,r,n,x,a),k=this.collisionIndex.placeCollisionBox(i,p,l,c,d,o,s,g,h.predicate,y,w);if((!v||this.collisionIndex.placeCollisionBox(v,p,l,c,d,o,s,_,h.predicate,y,w).placeable)&&k.placeable){let t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[u.crossTileID]&&this.prevPlacement.placements[u.crossTileID]&&this.prevPlacement.placements[u.crossTileID].text&&(t=this.prevPlacement.variableOffsets[u.crossTileID].anchor),0===u.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[u.crossTileID]={textOffset:x,width:r,height:n,anchor:b,textBoxScale:a,prevAnchor:t},this.markUsedJustification(m,b,u,f),m.allowVerticalPlacement&&(this.markUsedOrientation(m,f,u),this.placedOrientations[u.crossTileID]=f),{shift:w,placedGlyphBoxes:k}}}placeLayerBucketPart(t,i,r){const{bucket:n,layout:a,translationText:s,translationIcon:o,posMatrix:l,unwrappedTileID:c,textLabelPlaneMatrix:d,labelToScreenMatrix:h,textPixelRatio:p,holdingForFade:u,collisionBoxArray:m,partiallyEvaluatedTextSize:f,collisionGroup:g}=t.parameters,_=a.get("text-optional"),v=a.get("icon-optional"),y=e.ar(a,"text-overlap","text-allow-overlap"),b="always"===y,x=e.ar(a,"icon-overlap","icon-allow-overlap"),w="always"===x,k="map"===a.get("text-rotation-alignment"),T="map"===a.get("text-pitch-alignment"),S="none"!==a.get("icon-text-fit"),C="viewport-y"===a.get("symbol-z-order"),E=b&&(w||!n.hasIconData()||v),$=w&&(b||!n.hasTextData()||_);!n.collisionArrays&&m&&n.deserializeCollisionBoxes(m);const A=this._getTerrainElevationFunc(this.retainedQueryData[n.bucketInstanceId].tileID),I=(t,m,w)=>{var C,I;if(i[t.crossTileID])return;if(u)return void(this.placements[t.crossTileID]=new jt(!1,!1,!1));let M=!1,L=!1,P=!0,R=null,z={box:null,placeable:!1,offscreen:null},D={box:null,placeable:!1,offscreen:null},j=null,O=null,B=null,F=0,N=0,H=0;m.textFeatureIndex?F=m.textFeatureIndex:t.useRuntimeCollisionCircles&&(F=t.featureIndex),m.verticalTextFeatureIndex&&(N=m.verticalTextFeatureIndex);const V=m.textBox;if(V){const i=i=>{let r=e.ah.horizontal;if(n.allowVerticalPlacement&&!i&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[t.crossTileID];e&&(this.placedOrientations[t.crossTileID]=e,r=e,this.markUsedOrientation(n,r,t))}return r},a=(i,r)=>{if(n.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&m.verticalTextBox){for(const t of n.writingModes)if(t===e.ah.vertical?(z=r(),D=z):z=i(),z&&z.placeable)break}else z=i()},d=t.textAnchorOffsetStartIndex,h=t.textAnchorOffsetEndIndex;if(h===d){const r=(e,i)=>{const r=this.collisionIndex.placeCollisionBox(e,y,p,l,c,T,k,s,g.predicate,A);return r&&r.placeable&&(this.markUsedOrientation(n,i,t),this.placedOrientations[t.crossTileID]=i),r};a((()=>r(V,e.ah.horizontal)),(()=>{const i=m.verticalTextBox;return n.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&i?r(i,e.ah.vertical):{box:null,offscreen:null}})),i(z&&z.placeable)}else{let u=e.aq[null===(I=null===(C=this.prevPlacement)||void 0===C?void 0:C.variableOffsets[t.crossTileID])||void 0===I?void 0:I.anchor];const f=(i,a,m)=>{const f=i.x2-i.x1,_=i.y2-i.y1,v=t.textBoxScale,b=S&&"never"===x?a:null;let w=null,C="never"===y?1:2,E="never";u&&C++;for(let e=0;e<C;e++){for(let e=d;e<h;e++){const r=n.textAnchorOffsets.get(e);if(u&&r.textAnchor!==u)continue;const a=this.attemptAnchorPlacement(r,i,f,_,v,k,T,p,l,c,g,E,t,n,m,s,o,b,A);if(a&&(w=a.placedGlyphBoxes,w&&w.placeable))return M=!0,R=a.shift,w}u?u=null:E=y}return r&&!w&&(w={box:this.collisionIndex.placeCollisionBox(V,"always",p,l,c,T,k,s,g.predicate,A,new e.P(0,0)).box,offscreen:!1,placeable:!1}),w};a((()=>f(V,m.iconBox,e.ah.horizontal)),(()=>{const i=m.verticalTextBox;return n.allowVerticalPlacement&&(!z||!z.placeable)&&t.numVerticalGlyphVertices>0&&i?f(i,m.verticalIconBox,e.ah.vertical):{box:null,occluded:!0,offscreen:null}})),z&&(M=z.placeable,P=z.offscreen);const _=i(z&&z.placeable);if(!M&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[t.crossTileID];e&&(this.variableOffsets[t.crossTileID]=e,this.markUsedJustification(n,e.anchor,t,_))}}}if(j=z,M=j&&j.placeable,P=j&&j.offscreen,t.useRuntimeCollisionCircles){const i=n.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),o=e.ai(n.textSizeData,f,i),p=a.get("text-padding");O=this.collisionIndex.placeCollisionCircles(y,i,n.lineVertexArray,n.glyphOffsetArray,o,l,c,d,h,r,T,g.predicate,t.collisionCircleDiameter,p,s,A),O.circles.length&&O.collisionDetected&&!r&&e.w("Collisions detected, but collision boxes are not shown"),M=b||O.circles.length>0&&!O.collisionDetected,P=P&&O.offscreen}if(m.iconFeatureIndex&&(H=m.iconFeatureIndex),m.iconBox){const t=t=>this.collisionIndex.placeCollisionBox(t,x,p,l,c,T,k,o,g.predicate,A,S&&R?R:void 0);D&&D.placeable&&m.verticalIconBox?(B=t(m.verticalIconBox),L=B.placeable):(B=t(m.iconBox),L=B.placeable),P=P&&B.offscreen}const U=_||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,Y=v||0===t.numIconVertices;U||Y?Y?U||(L=L&&M):M=L&&M:L=M=L&&M;const Z=L&&B.placeable;if(M&&j.placeable&&this.collisionIndex.insertCollisionBox(j.box,y,a.get("text-ignore-placement"),n.bucketInstanceId,D&&D.placeable&&N?N:F,g.ID),Z&&this.collisionIndex.insertCollisionBox(B.box,x,a.get("icon-ignore-placement"),n.bucketInstanceId,H,g.ID),O&&M&&this.collisionIndex.insertCollisionCircles(O.circles,y,a.get("text-ignore-placement"),n.bucketInstanceId,F,g.ID),r&&this.storeCollisionData(n.bucketInstanceId,w,m,j,B,O),0===t.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===n.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[t.crossTileID]=new jt(M||E,L||$,P||n.justReloaded),i[t.crossTileID]=!0};if(C){if(0!==t.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const e=n.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const i=e[t];I(n.symbolInstances.get(i),n.collisionArrays[i],i)}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)I(n.symbolInstances.get(e),n.collisionArrays[e],e);if(r&&n.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[n.bucketInstanceId];e.as(t.invProjMatrix,l),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}n.justReloaded=!1}storeCollisionData(t,e,i,r,n,a){if(i.textBox||i.iconBox){let a,s;this.collisionBoxArrays.has(t)?a=this.collisionBoxArrays.get(t):(a=new Map,this.collisionBoxArrays.set(t,a)),a.has(e)?s=a.get(e):(s={text:null,icon:null},a.set(e,s)),i.textBox&&(s.text=r.box),i.iconBox&&(s.icon=n.box)}if(a){let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new Ot);for(let t=0;t<a.circles.length;t+=4)e.circles.push(a.circles[t+0]),e.circles.push(a.circles[t+1]),e.circles.push(a.circles[t+2]),e.circles.push(a.collisionDetected?1:0)}}markUsedJustification(t,i,r,n){let a;a=n===e.ah.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[e.at(i)];const s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(const e of s)e>=0&&(t.text.placedSymbolArray.get(e).crossTileID=a>=0&&e!==a?0:r.crossTileID)}markUsedOrientation(t,i,r){const n=i===e.ah.horizontal||i===e.ah.horizontalOnly?i:0,a=i===e.ah.vertical?i:0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(const e of s)t.text.placedSymbolArray.get(e).placedOrientation=n;r.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let i=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const r=e?e.symbolFadeChange(t):1,n=e?e.opacities:{},a=e?e.variableOffsets:{},s=e?e.placedOrientations:{};for(const t in this.placements){const e=this.placements[t],a=n[t];a?(this.opacities[t]=new Dt(a,r,e.text,e.icon),i=i||e.text!==a.text.placed||e.icon!==a.icon.placed):(this.opacities[t]=new Dt(null,r,e.text,e.icon,e.skipFade),i=i||e.text||e.icon)}for(const t in n){const e=n[t];if(!this.opacities[t]){const n=new Dt(e,r,!1,!1);n.isHidden()||(this.opacities[t]=n,i=i||e.text.placed||e.icon.placed)}}for(const t in a)this.variableOffsets[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.variableOffsets[t]=a[t]);for(const t in s)this.placedOrientations[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.placedOrientations[t]=s[t]);if(e&&void 0===e.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");i?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const i={};for(const r of e){const e=r.getBucket(t);e&&r.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,r.tileID,i,r.collisionBoxArray)}}updateBucketOpacities(t,i,r,n){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const a=t.layers[0],s=a.layout,o=new Dt(null,0,!1,!1,!0),l=s.get("text-allow-overlap"),c=s.get("icon-allow-overlap"),d=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),h="map"===s.get("text-rotation-alignment"),p="map"===s.get("text-pitch-alignment"),u="none"!==s.get("icon-text-fit"),m=new Dt(null,0,l&&(c||!t.hasIconData()||s.get("icon-optional")),c&&(l||!t.hasTextData()||s.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(n);const f=(t,e,i)=>{for(let r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(i);t.hasVisibleVertices=t.hasVisibleVertices||i!==Jt},g=this.collisionBoxArrays.get(t.bucketInstanceId);for(let i=0;i<t.symbolInstances.length;i++){const n=t.symbolInstances.get(i),{numHorizontalGlyphVertices:a,numVerticalGlyphVertices:s,crossTileID:l}=n;let c=this.opacities[l];r[l]?c=o:c||(c=m,this.opacities[l]=c),r[l]=!0;const _=n.numIconVertices>0,v=this.placedOrientations[n.crossTileID],y=v===e.ah.vertical,b=v===e.ah.horizontal||v===e.ah.horizontalOnly;if(a>0||s>0){const e=Kt(c.text);f(t.text,a,y?Jt:e),f(t.text,s,b?Jt:e);const i=c.text.isHidden();[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((e=>{e>=0&&(t.text.placedSymbolArray.get(e).hidden=i||y?1:0)})),n.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).hidden=i||b?1:0);const r=this.variableOffsets[n.crossTileID];r&&this.markUsedJustification(t,r.anchor,n,v);const o=this.placedOrientations[n.crossTileID];o&&(this.markUsedJustification(t,"left",n,o),this.markUsedOrientation(t,o,n))}if(_){const e=Kt(c.icon),i=!(u&&n.verticalPlacedIconSymbolIndex&&y);n.placedIconSymbolIndex>=0&&(f(t.icon,n.numIconVertices,i?e:Jt),t.icon.placedSymbolArray.get(n.placedIconSymbolIndex).hidden=c.icon.isHidden()),n.verticalPlacedIconSymbolIndex>=0&&(f(t.icon,n.numVerticalIconVertices,i?Jt:e),t.icon.placedSymbolArray.get(n.verticalPlacedIconSymbolIndex).hidden=c.icon.isHidden())}const x=g&&g.has(i)?g.get(i):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const r=t.collisionArrays[i];if(r){let i=new e.P(0,0);if(r.textBox||r.verticalTextBox){let e=!0;if(d){const t=this.variableOffsets[l];t?(i=Nt(t.anchor,t.width,t.height,t.textOffset,t.textBoxScale),h&&i._rotate(p?this.transform.angle:-this.transform.angle)):e=!1}if(r.textBox||r.verticalTextBox){let n;r.textBox&&(n=y),r.verticalTextBox&&(n=b),Vt(t.textCollisionBox.collisionVertexArray,c.text.placed,!e||n,x.text,i.x,i.y)}}if(r.iconBox||r.verticalIconBox){const e=Boolean(!b&&r.verticalIconBox);let n;r.iconBox&&(n=e),r.verticalIconBox&&(n=!e),Vt(t.iconCollisionBox.collisionVertexArray,c.icon.placed,n,x.icon,u?i.x:0,u?i.y:0)}}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const i=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*i>t}setStale(){this.stale=!0}}function Vt(t,e,i,r,n,a){r&&0!==r.length||(r=[0,0,0,0]);const s=r[0]-Lt,o=r[1]-Lt,l=r[2]-Lt,c=r[3]-Lt;t.emplaceBack(e?1:0,i?1:0,n||0,a||0,s,o),t.emplaceBack(e?1:0,i?1:0,n||0,a||0,l,o),t.emplaceBack(e?1:0,i?1:0,n||0,a||0,l,c),t.emplaceBack(e?1:0,i?1:0,n||0,a||0,s,c)}const Ut=Math.pow(2,25),Yt=Math.pow(2,24),Zt=Math.pow(2,17),qt=Math.pow(2,16),Wt=Math.pow(2,9),Gt=Math.pow(2,8),Xt=Math.pow(2,1);function Kt(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,i=Math.floor(127*t.opacity);return i*Ut+e*Yt+i*Zt+e*qt+i*Wt+e*Gt+i*Xt+e}const Jt=0;function Qt(){return{isOccluded:(t,e,i)=>!1,getPitchedTextCorrection:(t,e,i)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(t,e,i,r){throw new Error("Not implemented.")},translatePosition:(t,e,i,r)=>function(t,e,i,r,n=!1){if(!i[0]&&!i[1])return[0,0];const a=n?"map"===r?t.angle:0:"viewport"===r?-t.angle:0;if(a){const t=Math.sin(a),e=Math.cos(a);i=[i[0]*e-i[1]*t,i[0]*t+i[1]*e]}return[n?i[0]:Rt(e,i[0],t.zoom),n?i[1]:Rt(e,i[1],t.zoom)]}(t,e,i,r),getCircleRadiusCorrection:t=>1}}class te{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,e,i,r,n){const a=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(a,r,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,n())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort(((t,e)=>t.sortKey-e.sortKey)));this._currentPartIndex<a.length;)if(e.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,n())return!0;return!1}}class ee{constructor(t,e,i,r,n,a,s,o){this.placement=new Ht(t,Qt(),e,a,s,o),this._currentPlacementIndex=i.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=n,this._done=!1}isDone(){return this._done}continuePlacement(t,e,i){const r=a.now(),n=()=>!this._forceFullPlacement&&a.now()-r>2;for(;this._currentPlacementIndex>=0;){const r=e[t[this._currentPlacementIndex]],a=this.placement.collisionIndex.transform.zoom;if("symbol"===r.type&&(!r.minzoom||r.minzoom<=a)&&(!r.maxzoom||r.maxzoom>a)){if(this._inProgressLayer||(this._inProgressLayer=new te(r)),this._inProgressLayer.continuePlacement(i[r.source],this.placement,this._showCollisionBoxes,r,n))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const ie=512/e.W/2;class re{constructor(t,i,r){this.tileID=t,this.bucketInstanceId=r,this._symbolsByKey={};const n=new Map;for(let t=0;t<i.length;t++){const e=i.get(t),r=e.key,a=n.get(r);a?a.push(e):n.set(r,[e])}for(const[t,i]of n){const r={positions:i.map((t=>({x:Math.floor(t.anchorX*ie),y:Math.floor(t.anchorY*ie)}))),crossTileIDs:i.map((t=>t.crossTileID))};if(r.positions.length>128){const t=new e.av(r.positions.length,16,Uint16Array);for(const{x:e,y:i}of r.positions)t.add(e,i);t.finish(),delete r.positions,r.index=t}this._symbolsByKey[t]=r}}getScaledCoordinates(t,i){const{x:r,y:n,z:a}=this.tileID.canonical,{x:s,y:o,z:l}=i.canonical,c=ie/Math.pow(2,l-a),d=(o*e.W+t.anchorY)*c,h=n*e.W*ie;return{x:Math.floor((s*e.W+t.anchorX)*c-r*e.W*ie),y:Math.floor(d-h)}}findMatches(t,e,i){const r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let n=0;n<t.length;n++){const a=t.get(n);if(a.crossTileID)continue;const s=this._symbolsByKey[a.key];if(!s)continue;const o=this.getScaledCoordinates(a,e);if(s.index){const t=s.index.range(o.x-r,o.y-r,o.x+r,o.y+r).sort();for(const e of t){const t=s.crossTileIDs[e];if(!i[t]){i[t]=!0,a.crossTileID=t;break}}}else if(s.positions)for(let t=0;t<s.positions.length;t++){const e=s.positions[t],n=s.crossTileIDs[t];if(Math.abs(e.x-o.x)<=r&&Math.abs(e.y-o.y)<=r&&!i[n]){i[n]=!0,a.crossTileID=n;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class ne{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ae{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const t in this.indexes){const i=this.indexes[t],r={};for(const t in i){const n=i[t];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+e),r[n.tileID.key]=n}this.indexes[t]=r}this.lng=t}addBucket(t,e,i){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let t=0;t<e.symbolInstances.length;t++)e.symbolInstances.get(t).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const r=this.usedCrossTileIDs[t.overscaledZ];for(const i in this.indexes){const n=this.indexes[i];if(Number(i)>t.overscaledZ)for(const i in n){const a=n[i];a.tileID.isChildOf(t)&&a.findMatches(e.symbolInstances,t,r)}else{const a=n[t.scaledTo(Number(i)).key];a&&a.findMatches(e.symbolInstances,t,r)}}for(let t=0;t<e.symbolInstances.length;t++){const n=e.symbolInstances.get(t);n.crossTileID||(n.crossTileID=i.generate(),r[n.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new re(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const i of e.getCrossTileIDsLists())for(const e of i)delete this.usedCrossTileIDs[t][e]}removeStaleBuckets(t){let e=!1;for(const i in this.indexes){const r=this.indexes[i];for(const n in r)t[r[n].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,r[n]),delete r[n],e=!0)}return e}}class se{constructor(){this.layerIndexes={},this.crossTileIDs=new ne,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,i){let r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new ae);let n=!1;const a={};r.handleWrapJump(i);for(const i of e){const e=i.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(i.tileID,e,this.crossTileIDs)&&(n=!0),a[e.bucketInstanceId]=!0)}return r.removeStaleBuckets(a)&&(n=!0),n}pruneUnusedLayers(t){const e={};t.forEach((t=>{e[t]=!0}));for(const t in this.layerIndexes)e[t]||delete this.layerIndexes[t]}}const oe=(t,i)=>e.t(t,i&&i.filter((t=>"source.canvas"!==t.identifier))),le=e.aw();class ce extends e.E{constructor(t,i={}){super(),this._rtlPluginLoaded=()=>{for(const t in this.sourceCaches){const e=this.sourceCaches[t].getSource().type;"vector"!==e&&"geojson"!==e||this.sourceCaches[t].reload()}},this.map=t,this.dispatcher=new O(j(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((t,e)=>this.getGlyphs(t,e))),this.dispatcher.registerMessageHandler("GI",((t,e)=>this.getImages(t,e))),this.imageManager=new k,this.imageManager.setEventedParent(this),this.glyphManager=new E(t._requestManager,i.localIdeographFontFamily),this.lineAtlas=new M(256,512),this.crossTileSymbolIndex=new se,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",e.ay()),at().on(it,this._rtlPluginLoaded),this.on("data",(t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.sourceCaches[t.sourceId];if(!e)return;const i=e.getSource();if(i&&i.vectorLayerIds)for(const t in this._layers){const e=this._layers[t];e.source===i.id&&this._validateLayer(e)}}))}loadURL(t,i={},r){this.fire(new e.k("dataloading",{dataType:"style"})),i.validate="boolean"!=typeof i.validate||i.validate;const n=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController,e.h(n,this._loadStyleRequest).then((t=>{this._loadStyleRequest=null,this._load(t.data,i,r)})).catch((t=>{this._loadStyleRequest=null,t&&this.fire(new e.j(t))}))}loadJSON(t,i={},r){this.fire(new e.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,a.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,i.validate=!1!==i.validate,this._load(t,i,r)})).catch((()=>{}))}loadEmpty(){this.fire(new e.k("dataloading",{dataType:"style"})),this._load(le,{validate:!1})}_load(t,i,r){var n;const a=i.transformStyle?i.transformStyle(r,t):t;if(!i.validate||!oe(this,e.x(a))){this._loaded=!0,this.stylesheet=a;for(const t in a.sources)this.addSource(t,a.sources[t],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new I(this.stylesheet.light),this.map.setTerrain(null!==(n=this.stylesheet.terrain)&&void 0!==n?n:null),this.fire(new e.k("data",{dataType:"style"})),this.fire(new e.k("style.load"))}}_createLayers(){const t=e.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map((t=>t.id)),this._layers={},this._serializedLayers=null;for(const i of t){const t=e.aA(i);t.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=t}}_loadSprite(t,i=!1,r=void 0){let n;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(t,i,r,n){return e._(this,void 0,void 0,(function*(){const s=y(t),o=r>1?"@2x":"",l={},c={};for(const{id:t,url:r}of s){const a=i.transformRequest(b(r,o,".json"),"SpriteJSON");l[t]=e.h(a,n);const s=i.transformRequest(b(r,o,".png"),"SpriteImage");c[t]=u.getImage(s,n)}return yield Promise.all([...Object.values(l),...Object.values(c)]),function(t,i){return e._(this,void 0,void 0,(function*(){const e={};for(const r in t){e[r]={};const n=a.getImageCanvasContext((yield i[r]).data),s=(yield t[r]).data;for(const t in s){const{width:i,height:a,x:o,y:l,sdf:c,pixelRatio:d,stretchX:h,stretchY:p,content:u,textFitWidth:m,textFitHeight:f}=s[t];e[r][t]={data:null,pixelRatio:d,sdf:c,stretchX:h,stretchY:p,content:u,textFitWidth:m,textFitHeight:f,spriteData:{width:i,height:a,x:o,y:l,context:n}}}}return e}))}(l,c)}))}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((t=>{if(this._spriteRequest=null,t)for(const e in t){this._spritesImagesIds[e]=[];const r=this._spritesImagesIds[e]?this._spritesImagesIds[e].filter((e=>!(e in t))):[];for(const t of r)this.imageManager.removeImage(t),this._changedImages[t]=!0;for(const r in t[e]){const n="default"===e?r:`${e}:${r}`;this._spritesImagesIds[e].push(n),n in this.imageManager.images?this.imageManager.updateImage(n,t[e][r],!1):this.imageManager.addImage(n,t[e][r]),i&&(this._changedImages[n]=!0)}}})).catch((t=>{this._spriteRequest=null,n=t,this.fire(new e.j(n))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.k("data",{dataType:"style"})),r&&r(n)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.k("data",{dataType:"style"}))}_validateLayer(t){const i=this.sourceCaches[t.source];if(!i)return;const r=t.sourceLayer;if(!r)return;const n=i.getSource();("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(r))&&this.fire(new e.j(new Error(`Source layer "${r}" does not exist on source "${n.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){const e=this._serializedAllLayers();if(!t||0===t.length)return Object.values(e);const i=[];for(const r of t)e[r]&&i.push(e[r]);return i}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const e=Object.keys(this._layers);for(const i of e){const e=this._layers[i];"custom"!==e.type&&(t[i]=e.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const i=this._changed;if(i){const e=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);(e.length||i.length)&&this._updateWorkerLayers(e,i);for(const t in this._updatedSources){const e=this._updatedSources[t];if("reload"===e)this._reloadSource(t);else{if("clear"!==e)throw new Error(`Invalid action ${e}`);this._clearSource(t)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const e in this._updatedPaintProps)this._layers[e].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const r={};for(const t in this.sourceCaches){const e=this.sourceCaches[t];r[t]=e.used,e.used=!1}for(const e of this._order){const i=this._layers[e];i.recalculate(t,this._availableImages),!i.isHidden(t.zoom)&&i.source&&(this.sourceCaches[i.source].used=!0)}for(const t in r){const i=this.sourceCaches[t];!!r[t]!=!!i.used&&i.fire(new e.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:t}))}this.light.recalculate(t),this.z=t.zoom,i&&this.fire(new e.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,i={}){var r;this._checkLoaded();const n=this.serialize();if(t=i.transformStyle?i.transformStyle(n,t):t,(null===(r=i.validate)||void 0===r||r)&&oe(this,e.x(t)))return!1;(t=e.aB(t)).layers=e.az(t.layers);const a=e.aC(n,t),s=this._getOperationsToPerform(a);if(s.unimplemented.length>0)throw new Error(`Unimplemented: ${s.unimplemented.join(", ")}.`);if(0===s.operations.length)return!1;for(const t of s.operations)t();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const e=[],i=[];for(const r of t)switch(r.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":e.push((()=>this.addLayer.apply(this,r.args)));break;case"removeLayer":e.push((()=>this.removeLayer.apply(this,r.args)));break;case"setPaintProperty":e.push((()=>this.setPaintProperty.apply(this,r.args)));break;case"setLayoutProperty":e.push((()=>this.setLayoutProperty.apply(this,r.args)));break;case"setFilter":e.push((()=>this.setFilter.apply(this,r.args)));break;case"addSource":e.push((()=>this.addSource.apply(this,r.args)));break;case"removeSource":e.push((()=>this.removeSource.apply(this,r.args)));break;case"setLayerZoomRange":e.push((()=>this.setLayerZoomRange.apply(this,r.args)));break;case"setLight":e.push((()=>this.setLight.apply(this,r.args)));break;case"setGeoJSONSourceData":e.push((()=>this.setGeoJSONSourceData.apply(this,r.args)));break;case"setGlyphs":e.push((()=>this.setGlyphs.apply(this,r.args)));break;case"setSprite":e.push((()=>this.setSprite.apply(this,r.args)));break;case"setTerrain":e.push((()=>this.map.setTerrain.apply(this,r.args)));break;case"setTransition":e.push((()=>{}));break;default:i.push(r.command)}return{operations:e,unimplemented:i}}addImage(t,i){if(this.getImage(t))return this.fire(new e.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,i),this._afterImageUpdated(t)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new e.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,i,r={}){if(this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error(`Source "${t}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(e.x.source,`sources.${t}`,i,null,r))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const n=this.sourceCaches[t]=new ct(t,i,this.dispatcher);n.style=this,n.setEventedParent(this,(()=>({isSourceLoaded:n.loaded(),source:n.serialize(),sourceId:t}))),n.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(const i in this._layers)if(this._layers[i].source===t)return this.fire(new e.j(new Error(`Source "${t}" cannot be removed while layer "${i}" is using it.`)));const i=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],i.fire(new e.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,e){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error(`There is no source with this ID=${t}`);const i=this.sourceCaches[t].getSource();if("geojson"!==i.type)throw new Error(`geojsonSource.type is ${i.type}, which is !== 'geojson`);i.setData(e),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,i,r={}){this._checkLoaded();const n=t.id;if(this.getLayer(n))return void this.fire(new e.j(new Error(`Layer "${n}" already exists on this map.`)));let a;if("custom"===t.type){if(oe(this,e.aD(t)))return;a=e.aA(t)}else{if("source"in t&&"object"==typeof t.source&&(this.addSource(n,t.source),t=e.aB(t),t=e.e(t,{source:n})),this._validate(e.x.layer,`layers.${n}`,t,{arrayIndex:-1},r))return;a=e.aA(t),this._validateLayer(a),a.setEventedParent(this,{layer:{id:n}})}const s=i?this._order.indexOf(i):this._order.length;if(i&&-1===s)this.fire(new e.j(new Error(`Cannot add layer "${n}" before non-existing layer "${i}".`)));else{if(this._order.splice(s,0,n),this._layerOrderChanged=!0,this._layers[n]=a,this._removedLayers[n]&&a.source&&"custom"!==a.type){const t=this._removedLayers[n];delete this._removedLayers[n],t.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}moveLayer(t,i){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new e.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===i)return;const r=this._order.indexOf(t);this._order.splice(r,1);const n=i?this._order.indexOf(i):this._order.length;i&&-1===n?this.fire(new e.j(new Error(`Cannot move layer "${t}" before non-existing layer "${i}".`))):(this._order.splice(n,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const i=this._layers[t];if(!i)return void this.fire(new e.j(new Error(`Cannot remove non-existing layer "${t}".`)));i.setEventedParent(null);const r=this._order.indexOf(t);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=i,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],i.onRemove&&i.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,i,r){this._checkLoaded();const n=this.getLayer(t);n?n.minzoom===i&&n.maxzoom===r||(null!=i&&(n.minzoom=i),null!=r&&(n.maxzoom=r),this._updateLayer(n)):this.fire(new e.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,i,r={}){this._checkLoaded();const n=this.getLayer(t);if(n){if(!e.aE(n.filter,i))return null==i?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(e.x.filter,`layers.${n.id}.filter`,i,null,r)||(n.filter=e.aB(i),this._updateLayer(n)))}else this.fire(new e.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return e.aB(this.getLayer(t).filter)}setLayoutProperty(t,i,r,n={}){this._checkLoaded();const a=this.getLayer(t);a?e.aE(a.getLayoutProperty(i),r)||(a.setLayoutProperty(i,r,n),this._updateLayer(a)):this.fire(new e.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,i){const r=this.getLayer(t);if(r)return r.getLayoutProperty(i);this.fire(new e.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,i,r,n={}){this._checkLoaded();const a=this.getLayer(t);a?e.aE(a.getPaintProperty(i),r)||(a.setPaintProperty(i,r,n)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new e.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(t,i){this._checkLoaded();const r=t.source,n=t.sourceLayer,a=this.sourceCaches[r];if(void 0===a)return void this.fire(new e.j(new Error(`The source '${r}' does not exist in the map's style.`)));const s=a.getSource().type;"geojson"===s&&n?this.fire(new e.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==s||n?(void 0===t.id&&this.fire(new e.j(new Error("The feature id parameter must be provided."))),a.setFeatureState(n,t.id,i)):this.fire(new e.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,i){this._checkLoaded();const r=t.source,n=this.sourceCaches[r];if(void 0===n)return void this.fire(new e.j(new Error(`The source '${r}' does not exist in the map's style.`)));const a=n.getSource().type,s="vector"===a?t.sourceLayer:void 0;"vector"!==a||s?i&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new e.j(new Error("A feature id is required to remove its specific state property."))):n.removeFeatureState(s,t.id,i):this.fire(new e.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const i=t.source,r=t.sourceLayer,n=this.sourceCaches[i];if(void 0!==n)return"vector"!==n.getSource().type||r?(void 0===t.id&&this.fire(new e.j(new Error("The feature id parameter must be provided."))),n.getFeatureState(r,t.id)):void this.fire(new e.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new e.j(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return e.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=e.aF(this.sourceCaches,(t=>t.serialize())),i=this._serializeByIds(this._order),r=this.map.getTerrain()||void 0,n=this.stylesheet;return e.aG({version:n.version,name:n.name,metadata:n.metadata,light:n.light,center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch,sprite:n.sprite,glyphs:n.glyphs,transition:n.transition,sources:t,layers:i,terrain:r},(t=>void 0!==t))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,i={},r=[];for(let n=this._order.length-1;n>=0;n--){const a=this._order[n];if(e(a)){i[a]=n;for(const e of t){const t=e[a];if(t)for(const e of t)r.push(e)}}}r.sort(((t,e)=>e.intersectionZ-t.intersectionZ));const n=[];for(let a=this._order.length-1;a>=0;a--){const s=this._order[a];if(e(s))for(let t=r.length-1;t>=0;t--){const e=r[t].feature;if(i[e.layer.id]<a)break;n.push(e),r.pop()}else for(const e of t){const t=e[s];if(t)for(const e of t)n.push(e.feature)}}return n}queryRenderedFeatures(t,i,r){i&&i.filter&&this._validate(e.x.filter,"queryRenderedFeatures.filter",i.filter,null,i);const n={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new e.j(new Error("parameters.layers must be an Array."))),[];for(const t of i.layers){const i=this._layers[t];if(!i)return this.fire(new e.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be queried for features.`))),[];n[i.source]=!0}}const a=[];i.availableImages=this._availableImages;const s=this._serializedAllLayers();for(const e in this.sourceCaches)i.layers&&!n[e]||a.push(N(this.sourceCaches[e],this._layers,s,t,i,r));return this.placement&&a.push(function(t,e,i,r,n,a,s){const o={},l=a.queryRenderedSymbols(r),c=[];for(const t of Object.keys(l).map(Number))c.push(s[t]);c.sort(H);for(const i of c){const r=i.featureIndex.lookupSymbolFeatures(l[i.bucketInstanceId],e,i.bucketIndex,i.sourceLayerIndex,n.filter,n.layers,n.availableImages,t);for(const t in r){const e=o[t]=o[t]||[],n=r[t];n.sort(((t,e)=>{const r=i.featureSortOrder;if(r){const i=r.indexOf(t.featureIndex);return r.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex}));for(const t of n)e.push(t)}}for(const e in o)o[e].forEach((r=>{const n=r.feature,a=i[t[e].source].getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=a}));return o}(this._layers,s,this.sourceCaches,t,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(t,i){i&&i.filter&&this._validate(e.x.filter,"querySourceFeatures.filter",i.filter,null,i);const r=this.sourceCaches[t];return r?function(t,e){const i=t.getRenderableIds().map((e=>t.getTileByID(e))),r=[],n={};for(let t=0;t<i.length;t++){const a=i[t],s=a.tileID.canonical.key;n[s]||(n[s]=!0,a.querySourceFeatures(r,e))}return r}(r,i):[]}getLight(){return this.light.getLight()}setLight(t,i={}){this._checkLoaded();const r=this.light.getLight();let n=!1;for(const i in t)if(!e.aE(t[i],r[i])){n=!0;break}if(!n)return;const s={now:a.now(),transition:e.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,i),this.light.updateTransitions(s)}_validate(t,i,r,n,a={}){return(!a||!1!==a.validate)&&oe(this,t.call(e.x,e.e({key:i,style:this.serialize(),value:r,styleSpec:e.v},n)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),at().off(it,this._rtlPluginLoaded);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.sourceCaches){const e=this.sourceCaches[t];e.setEventedParent(null),e.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const e in this.sourceCaches)this.sourceCaches[e].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,e,i,r,n=!1){let s=!1,o=!1;const l={};for(const e of this._order){const i=this._layers[e];if("symbol"!==i.type)continue;if(!l[i.source]){const t=this.sourceCaches[i.source];l[i.source]=t.getRenderableIds(!0).map((e=>t.getTileByID(e))).sort(((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)))}const r=this.crossTileSymbolIndex.addLayer(i,l[i.source],t.center.lng);s=s||r}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((n=n||this._layerOrderChanged||0===i)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.now(),t.zoom))&&(this.pauseablePlacement=new ee(t,this.map.terrain,this._order,n,e,i,r,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.now()),o=!0),s&&this.pauseablePlacement.placement.setStale()),o||s)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,i){return e._(this,void 0,void 0,(function*(){const t=yield this.imageManager.getImages(i.icons);this._updateTilesForChangedImages();const e=this.sourceCaches[i.source];return e&&e.setDependencies(i.tileID.key,i.type,i.icons),t}))}getGlyphs(t,i){return e._(this,void 0,void 0,(function*(){const t=yield this.glyphManager.getGlyphs(i.stacks),e=this.sourceCaches[i.source];return e&&e.setDependencies(i.tileID.key,i.type,[""]),t}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,i={}){this._checkLoaded(),t&&this._validate(e.x.glyphs,"glyphs",t,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,i,r={},n){this._checkLoaded();const a=[{id:t,url:i}],s=[...y(this.stylesheet.sprite),...a];this._validate(e.x.sprite,"sprite",s,null,r)||(this.stylesheet.sprite=s,this._loadSprite(a,!0,n))}removeSprite(t){this._checkLoaded();const i=y(this.stylesheet.sprite);if(i.find((e=>e.id===t))){if(this._spritesImagesIds[t])for(const e of this._spritesImagesIds[t])this.imageManager.removeImage(e),this._changedImages[e]=!0;i.splice(i.findIndex((e=>e.id===t)),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.k("data",{dataType:"style"}))}else this.fire(new e.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return y(this.stylesheet.sprite)}setSprite(t,i={},r){this._checkLoaded(),t&&this._validate(e.x.sprite,"sprite",t,null,i)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,r):(this._unloadSprite(),r&&r(null)))}}var de=e.X([{name:"a_pos",type:"Int16",components:2}]),he="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const pe={prelude:ue("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:ue("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:ue("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ue("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:ue("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ue("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:ue("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ue("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ue("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ue("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:ue("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:ue("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:ue("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:ue("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:ue("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:ue("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:ue("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ue("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:ue("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:ue("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:ue("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:ue("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:ue("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:ue("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:ue("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:ue("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:ue("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",he),terrainDepth:ue("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",he),terrainCoords:ue("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",he)};function ue(t,e){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute ([\w]+) ([\w]+)/g),n=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),s=a?a.concat(n):n,o={};return{fragmentSource:t=t.replace(i,((t,e,i,r,n)=>(o[n]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nvarying ${i} ${r} ${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = u_${n};\n#endif\n`))),vertexSource:e=e.replace(i,((t,e,i,r,n)=>{const a="float"===r?"vec2":"vec4",s=n.match(/color/)?"color":a;return o[n]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nuniform lowp float u_${n}_t;\nattribute ${i} ${a} a_${n};\nvarying ${i} ${r} ${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${n}\n    ${n} = a_${n};\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${n}\n    ${n} = unpack_mix_${s}(a_${n}, u_${n}_t);\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nuniform lowp float u_${n}_t;\nattribute ${i} ${a} a_${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = a_${n};\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = unpack_mix_${s}(a_${n}, u_${n}_t);\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`})),staticAttributes:r,staticUniforms:s}}class me{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,e,i,r,n,a,s,o,l){this.context=t;let c=this.boundPaintVertexBuffers.length!==r.length;for(let t=0;!c&&t<r.length;t++)this.boundPaintVertexBuffers[t]!==r[t]&&(c=!0);!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==i||c||this.boundIndexBuffer!==n||this.boundVertexOffset!==a||this.boundDynamicVertexBuffer!==s||this.boundDynamicVertexBuffer2!==o||this.boundDynamicVertexBuffer3!==l?this.freshBind(e,i,r,n,a,s,o,l):(t.bindVertexArray.set(this.vao),s&&s.bind(),n&&n.dynamicDraw&&n.bind(),o&&o.bind(),l&&l.bind())}freshBind(t,e,i,r,n,a,s,o){const l=t.numAttributes,c=this.context,d=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=r,this.boundVertexOffset=n,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=s,this.boundDynamicVertexBuffer3=o,e.enableAttributes(d,t);for(const e of i)e.enableAttributes(d,t);a&&a.enableAttributes(d,t),s&&s.enableAttributes(d,t),o&&o.enableAttributes(d,t),e.bind(),e.setVertexAttribPointers(d,t,n);for(const e of i)e.bind(),e.setVertexAttribPointers(d,t,n);a&&(a.bind(),a.setVertexAttribPointers(d,t,n)),r&&r.bind(),s&&(s.bind(),s.setVertexAttribPointers(d,t,n)),o&&(o.bind(),o.setVertexAttribPointers(d,t,n)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function fe(t){const e=[];for(let i=0;i<t.length;i++){if(null===t[i])continue;const r=t[i].split(" ");e.push(r.pop())}return e}class ge{constructor(t,i,r,n,a,s){const o=t.gl;this.program=o.createProgram();const l=fe(i.staticAttributes),c=r?r.getBinderAttributes():[],d=l.concat(c),h=pe.prelude.staticUniforms?fe(pe.prelude.staticUniforms):[],p=i.staticUniforms?fe(i.staticUniforms):[],u=r?r.getBinderUniforms():[],m=h.concat(p).concat(u),f=[];for(const t of m)f.indexOf(t)<0&&f.push(t);const g=r?r.defines():[];a&&g.push("#define OVERDRAW_INSPECTOR;"),s&&g.push("#define TERRAIN3D;");const _=g.concat(pe.prelude.fragmentSource,i.fragmentSource).join("\n"),v=g.concat(pe.prelude.vertexSource,i.vertexSource).join("\n"),y=o.createShader(o.FRAGMENT_SHADER);if(o.isContextLost())return void(this.failedToCreate=!0);if(o.shaderSource(y,_),o.compileShader(y),!o.getShaderParameter(y,o.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${o.getShaderInfoLog(y)}`);o.attachShader(this.program,y);const b=o.createShader(o.VERTEX_SHADER);if(o.isContextLost())return void(this.failedToCreate=!0);if(o.shaderSource(b,v),o.compileShader(b),!o.getShaderParameter(b,o.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${o.getShaderInfoLog(b)}`);o.attachShader(this.program,b),this.attributes={};const x={};this.numAttributes=d.length;for(let t=0;t<this.numAttributes;t++)d[t]&&(o.bindAttribLocation(this.program,t,d[t]),this.attributes[d[t]]=t);if(o.linkProgram(this.program),!o.getProgramParameter(this.program,o.LINK_STATUS))throw new Error(`Program failed to link: ${o.getProgramInfoLog(this.program)}`);o.deleteShader(b),o.deleteShader(y);for(let t=0;t<f.length;t++){const e=f[t];if(e&&!x[e]){const t=o.getUniformLocation(this.program,e);t&&(x[e]=t)}}this.fixedUniforms=n(t,x),this.terrainUniforms=((t,i)=>({u_depth:new e.aH(t,i.u_depth),u_terrain:new e.aH(t,i.u_terrain),u_terrain_dim:new e.aI(t,i.u_terrain_dim),u_terrain_matrix:new e.aJ(t,i.u_terrain_matrix),u_terrain_unpack:new e.aK(t,i.u_terrain_unpack),u_terrain_exaggeration:new e.aI(t,i.u_terrain_exaggeration)}))(t,x),this.binderUniforms=r?r.getUniforms(t,x):[]}draw(t,e,i,r,n,a,s,o,l,c,d,h,p,u,m,f,g,_){const v=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(i),t.setStencilMode(r),t.setColorMode(n),t.setCullFace(a),o){t.activeTexture.set(v.TEXTURE2),v.bindTexture(v.TEXTURE_2D,o.depthTexture),t.activeTexture.set(v.TEXTURE3),v.bindTexture(v.TEXTURE_2D,o.texture);for(const t in this.terrainUniforms)this.terrainUniforms[t].set(o[t])}for(const t in this.fixedUniforms)this.fixedUniforms[t].set(s[t]);m&&m.setUniforms(t,this.binderUniforms,p,{zoom:u});let y=0;switch(e){case v.LINES:y=2;break;case v.TRIANGLES:y=3;break;case v.LINE_STRIP:y=1}for(const i of h.get()){const r=i.vaos||(i.vaos={});(r[l]||(r[l]=new me)).bind(t,this,c,m?m.getPaintVertexBuffers():[],d,i.vertexOffset,f,g,_),v.drawElements(e,i.primitiveLength*y,v.UNSIGNED_SHORT,i.primitiveOffset*y*2)}}}function _e(t,e,i){const r=1/Rt(i,1,e.transform.tileZoom),n=Math.pow(2,i.tileID.overscaledZ),a=i.tileSize*Math.pow(2,e.transform.tileZoom)/n,s=a*(i.tileID.canonical.x+i.tileID.wrap*n),o=a*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[r,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[s>>16,o>>16],u_pixel_coord_lower:[65535&s,65535&o]}}const ve=(t,i,r,n)=>{const a=i.style.light,s=a.properties.get("position"),o=[s.x,s.y,s.z],l=function(){var t=new e.A(9);return e.A!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}();"viewport"===a.properties.get("anchor")&&function(t,e){var i=Math.sin(e),r=Math.cos(e);t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1}(l,-i.transform.angle),function(t,e,i){var r=e[0],n=e[1],a=e[2];t[0]=r*i[0]+n*i[3]+a*i[6],t[1]=r*i[1]+n*i[4]+a*i[7],t[2]=r*i[2]+n*i[5]+a*i[8]}(o,o,l);const c=a.properties.get("color");return{u_matrix:t,u_lightpos:o,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+r,u_opacity:n}},ye=(t,i,r,n,a,s,o)=>e.e(ve(t,i,r,n),_e(s,i,o),{u_height_factor:-Math.pow(2,a.overscaledZ)/o.tileSize/8}),be=t=>({u_matrix:t}),xe=(t,i,r,n)=>e.e(be(t),_e(r,i,n)),we=(t,e)=>({u_matrix:t,u_world:e}),ke=(t,i,r,n,a)=>e.e(xe(t,i,r,n),{u_world:a}),Te=(t,e,i,r)=>{const n=t.transform;let a,s;if("map"===r.paint.get("circle-pitch-alignment")){const t=Rt(i,1,n.zoom);a=!0,s=[t,t]}else a=!1,s=n.pixelsToGLUnits;return{u_camera_to_center_distance:n.cameraToCenterDistance,u_scale_with_map:+("map"===r.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:t.pixelRatio,u_extrude_scale:s}},Se=(t,e,i)=>({u_matrix:t,u_inv_matrix:e,u_camera_to_center_distance:i.cameraToCenterDistance,u_viewport_size:[i.width,i.height]}),Ce=(t,e,i=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:i}),Ee=t=>({u_matrix:t}),$e=(t,e,i,r)=>({u_matrix:t,u_extrude_scale:Rt(e,1,i),u_intensity:r});function Ae(t,i){const r=Math.pow(2,i.canonical.z),n=i.canonical.y;return[new e.Y(0,n/r).toLngLat().lat,new e.Y(0,(n+1)/r).toLngLat().lat]}const Ie=(t,e,i,r)=>{const n=t.transform;return{u_matrix:ze(t,e,i,r),u_ratio:1/Rt(e,1,n.zoom),u_device_pixel_ratio:t.pixelRatio,u_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}},Me=(t,i,r,n,a)=>e.e(Ie(t,i,r,a),{u_image:0,u_image_height:n}),Le=(t,e,i,r,n)=>{const a=t.transform,s=Re(e,a);return{u_matrix:ze(t,e,i,n),u_texsize:e.imageAtlasTexture.size,u_ratio:1/Rt(e,1,a.zoom),u_device_pixel_ratio:t.pixelRatio,u_image:0,u_scale:[s,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},Pe=(t,i,r,n,a,s)=>{const o=t.lineAtlas,l=Re(i,t.transform),c="round"===r.layout.get("line-cap"),d=o.getDash(n.from,c),h=o.getDash(n.to,c),p=d.width*a.fromScale,u=h.width*a.toScale;return e.e(Ie(t,i,r,s),{u_patternscale_a:[l/p,-d.height/2],u_patternscale_b:[l/u,-h.height/2],u_sdfgamma:o.width/(256*Math.min(p,u)*t.pixelRatio)/2,u_image:0,u_tex_y_a:d.y,u_tex_y_b:h.y,u_mix:a.t})};function Re(t,e){return 1/Rt(t,1,e.tileZoom)}function ze(t,e,i,r){return t.translatePosMatrix(r?r.posMatrix:e.tileID.posMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const De=(t,e,i,r,n)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:i,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:(s=n.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(a=n.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:je(n.paint.get("raster-hue-rotate"))};var a,s};function je(t){t*=Math.PI/180;const e=Math.sin(t),i=Math.cos(t);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}const Oe=(t,e,i,r,n,a,s,o,l,c,d,h,p,u)=>{const m=s.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:m.cameraToCenterDistance,u_pitch:m.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:m.width/m.height,u_fade_change:s.options.fadeDuration?s.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:l,u_coord_matrix:c,u_is_text:+h,u_pitch_with_map:+r,u_is_along_line:n,u_is_variable_anchor:a,u_texsize:p,u_texture:0,u_translation:d,u_pitched_scale:u}},Be=(t,i,r,n,a,s,o,l,c,d,h,p,u,m,f)=>{const g=o.transform;return e.e(Oe(t,i,r,n,a,s,o,l,c,d,h,p,u,f),{u_gamma_scale:n?Math.cos(g._pitch)*g.cameraToCenterDistance:1,u_device_pixel_ratio:o.pixelRatio,u_is_halo:+m})},Fe=(t,i,r,n,a,s,o,l,c,d,h,p,u,m)=>e.e(Be(t,i,r,n,a,s,o,l,c,d,h,!0,p,!0,m),{u_texsize_icon:u,u_texture_icon:1}),Ne=(t,e,i)=>({u_matrix:t,u_opacity:e,u_color:i}),He=(t,i,r,n,a,s)=>e.e(function(t,e,i,r){const n=i.imageManager.getPattern(t.from.toString()),a=i.imageManager.getPattern(t.to.toString()),{width:s,height:o}=i.imageManager.getPixelSize(),l=Math.pow(2,r.tileID.overscaledZ),c=r.tileSize*Math.pow(2,i.transform.tileZoom)/l,d=c*(r.tileID.canonical.x+r.tileID.wrap*l),h=c*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:n.tl,u_pattern_br_a:n.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[s,o],u_mix:e.t,u_pattern_size_a:n.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/Rt(r,1,i.transform.tileZoom),u_pixel_coord_upper:[d>>16,h>>16],u_pixel_coord_lower:[65535&d,65535&h]}}(n,s,r,a),{u_matrix:t,u_opacity:i}),Ve={fillExtrusion:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_lightpos:new e.aL(t,i.u_lightpos),u_lightintensity:new e.aI(t,i.u_lightintensity),u_lightcolor:new e.aL(t,i.u_lightcolor),u_vertical_gradient:new e.aI(t,i.u_vertical_gradient),u_opacity:new e.aI(t,i.u_opacity)}),fillExtrusionPattern:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_lightpos:new e.aL(t,i.u_lightpos),u_lightintensity:new e.aI(t,i.u_lightintensity),u_lightcolor:new e.aL(t,i.u_lightcolor),u_vertical_gradient:new e.aI(t,i.u_vertical_gradient),u_height_factor:new e.aI(t,i.u_height_factor),u_image:new e.aH(t,i.u_image),u_texsize:new e.aM(t,i.u_texsize),u_pixel_coord_upper:new e.aM(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.aM(t,i.u_pixel_coord_lower),u_scale:new e.aL(t,i.u_scale),u_fade:new e.aI(t,i.u_fade),u_opacity:new e.aI(t,i.u_opacity)}),fill:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix)}),fillPattern:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_image:new e.aH(t,i.u_image),u_texsize:new e.aM(t,i.u_texsize),u_pixel_coord_upper:new e.aM(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.aM(t,i.u_pixel_coord_lower),u_scale:new e.aL(t,i.u_scale),u_fade:new e.aI(t,i.u_fade)}),fillOutline:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_world:new e.aM(t,i.u_world)}),fillOutlinePattern:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_world:new e.aM(t,i.u_world),u_image:new e.aH(t,i.u_image),u_texsize:new e.aM(t,i.u_texsize),u_pixel_coord_upper:new e.aM(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.aM(t,i.u_pixel_coord_lower),u_scale:new e.aL(t,i.u_scale),u_fade:new e.aI(t,i.u_fade)}),circle:(t,i)=>({u_camera_to_center_distance:new e.aI(t,i.u_camera_to_center_distance),u_scale_with_map:new e.aH(t,i.u_scale_with_map),u_pitch_with_map:new e.aH(t,i.u_pitch_with_map),u_extrude_scale:new e.aM(t,i.u_extrude_scale),u_device_pixel_ratio:new e.aI(t,i.u_device_pixel_ratio),u_matrix:new e.aJ(t,i.u_matrix)}),collisionBox:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_pixel_extrude_scale:new e.aM(t,i.u_pixel_extrude_scale)}),collisionCircle:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_inv_matrix:new e.aJ(t,i.u_inv_matrix),u_camera_to_center_distance:new e.aI(t,i.u_camera_to_center_distance),u_viewport_size:new e.aM(t,i.u_viewport_size)}),debug:(t,i)=>({u_color:new e.aN(t,i.u_color),u_matrix:new e.aJ(t,i.u_matrix),u_overlay:new e.aH(t,i.u_overlay),u_overlay_scale:new e.aI(t,i.u_overlay_scale)}),clippingMask:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix)}),heatmap:(t,i)=>({u_extrude_scale:new e.aI(t,i.u_extrude_scale),u_intensity:new e.aI(t,i.u_intensity),u_matrix:new e.aJ(t,i.u_matrix)}),heatmapTexture:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_world:new e.aM(t,i.u_world),u_image:new e.aH(t,i.u_image),u_color_ramp:new e.aH(t,i.u_color_ramp),u_opacity:new e.aI(t,i.u_opacity)}),hillshade:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_image:new e.aH(t,i.u_image),u_latrange:new e.aM(t,i.u_latrange),u_light:new e.aM(t,i.u_light),u_shadow:new e.aN(t,i.u_shadow),u_highlight:new e.aN(t,i.u_highlight),u_accent:new e.aN(t,i.u_accent)}),hillshadePrepare:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_image:new e.aH(t,i.u_image),u_dimension:new e.aM(t,i.u_dimension),u_zoom:new e.aI(t,i.u_zoom),u_unpack:new e.aK(t,i.u_unpack)}),line:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_ratio:new e.aI(t,i.u_ratio),u_device_pixel_ratio:new e.aI(t,i.u_device_pixel_ratio),u_units_to_pixels:new e.aM(t,i.u_units_to_pixels)}),lineGradient:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_ratio:new e.aI(t,i.u_ratio),u_device_pixel_ratio:new e.aI(t,i.u_device_pixel_ratio),u_units_to_pixels:new e.aM(t,i.u_units_to_pixels),u_image:new e.aH(t,i.u_image),u_image_height:new e.aI(t,i.u_image_height)}),linePattern:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_texsize:new e.aM(t,i.u_texsize),u_ratio:new e.aI(t,i.u_ratio),u_device_pixel_ratio:new e.aI(t,i.u_device_pixel_ratio),u_image:new e.aH(t,i.u_image),u_units_to_pixels:new e.aM(t,i.u_units_to_pixels),u_scale:new e.aL(t,i.u_scale),u_fade:new e.aI(t,i.u_fade)}),lineSDF:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_ratio:new e.aI(t,i.u_ratio),u_device_pixel_ratio:new e.aI(t,i.u_device_pixel_ratio),u_units_to_pixels:new e.aM(t,i.u_units_to_pixels),u_patternscale_a:new e.aM(t,i.u_patternscale_a),u_patternscale_b:new e.aM(t,i.u_patternscale_b),u_sdfgamma:new e.aI(t,i.u_sdfgamma),u_image:new e.aH(t,i.u_image),u_tex_y_a:new e.aI(t,i.u_tex_y_a),u_tex_y_b:new e.aI(t,i.u_tex_y_b),u_mix:new e.aI(t,i.u_mix)}),raster:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_tl_parent:new e.aM(t,i.u_tl_parent),u_scale_parent:new e.aI(t,i.u_scale_parent),u_buffer_scale:new e.aI(t,i.u_buffer_scale),u_fade_t:new e.aI(t,i.u_fade_t),u_opacity:new e.aI(t,i.u_opacity),u_image0:new e.aH(t,i.u_image0),u_image1:new e.aH(t,i.u_image1),u_brightness_low:new e.aI(t,i.u_brightness_low),u_brightness_high:new e.aI(t,i.u_brightness_high),u_saturation_factor:new e.aI(t,i.u_saturation_factor),u_contrast_factor:new e.aI(t,i.u_contrast_factor),u_spin_weights:new e.aL(t,i.u_spin_weights)}),symbolIcon:(t,i)=>({u_is_size_zoom_constant:new e.aH(t,i.u_is_size_zoom_constant),u_is_size_feature_constant:new e.aH(t,i.u_is_size_feature_constant),u_size_t:new e.aI(t,i.u_size_t),u_size:new e.aI(t,i.u_size),u_camera_to_center_distance:new e.aI(t,i.u_camera_to_center_distance),u_pitch:new e.aI(t,i.u_pitch),u_rotate_symbol:new e.aH(t,i.u_rotate_symbol),u_aspect_ratio:new e.aI(t,i.u_aspect_ratio),u_fade_change:new e.aI(t,i.u_fade_change),u_matrix:new e.aJ(t,i.u_matrix),u_label_plane_matrix:new e.aJ(t,i.u_label_plane_matrix),u_coord_matrix:new e.aJ(t,i.u_coord_matrix),u_is_text:new e.aH(t,i.u_is_text),u_pitch_with_map:new e.aH(t,i.u_pitch_with_map),u_is_along_line:new e.aH(t,i.u_is_along_line),u_is_variable_anchor:new e.aH(t,i.u_is_variable_anchor),u_texsize:new e.aM(t,i.u_texsize),u_texture:new e.aH(t,i.u_texture),u_translation:new e.aM(t,i.u_translation),u_pitched_scale:new e.aI(t,i.u_pitched_scale)}),symbolSDF:(t,i)=>({u_is_size_zoom_constant:new e.aH(t,i.u_is_size_zoom_constant),u_is_size_feature_constant:new e.aH(t,i.u_is_size_feature_constant),u_size_t:new e.aI(t,i.u_size_t),u_size:new e.aI(t,i.u_size),u_camera_to_center_distance:new e.aI(t,i.u_camera_to_center_distance),u_pitch:new e.aI(t,i.u_pitch),u_rotate_symbol:new e.aH(t,i.u_rotate_symbol),u_aspect_ratio:new e.aI(t,i.u_aspect_ratio),u_fade_change:new e.aI(t,i.u_fade_change),u_matrix:new e.aJ(t,i.u_matrix),u_label_plane_matrix:new e.aJ(t,i.u_label_plane_matrix),u_coord_matrix:new e.aJ(t,i.u_coord_matrix),u_is_text:new e.aH(t,i.u_is_text),u_pitch_with_map:new e.aH(t,i.u_pitch_with_map),u_is_along_line:new e.aH(t,i.u_is_along_line),u_is_variable_anchor:new e.aH(t,i.u_is_variable_anchor),u_texsize:new e.aM(t,i.u_texsize),u_texture:new e.aH(t,i.u_texture),u_gamma_scale:new e.aI(t,i.u_gamma_scale),u_device_pixel_ratio:new e.aI(t,i.u_device_pixel_ratio),u_is_halo:new e.aH(t,i.u_is_halo),u_translation:new e.aM(t,i.u_translation),u_pitched_scale:new e.aI(t,i.u_pitched_scale)}),symbolTextAndIcon:(t,i)=>({u_is_size_zoom_constant:new e.aH(t,i.u_is_size_zoom_constant),u_is_size_feature_constant:new e.aH(t,i.u_is_size_feature_constant),u_size_t:new e.aI(t,i.u_size_t),u_size:new e.aI(t,i.u_size),u_camera_to_center_distance:new e.aI(t,i.u_camera_to_center_distance),u_pitch:new e.aI(t,i.u_pitch),u_rotate_symbol:new e.aH(t,i.u_rotate_symbol),u_aspect_ratio:new e.aI(t,i.u_aspect_ratio),u_fade_change:new e.aI(t,i.u_fade_change),u_matrix:new e.aJ(t,i.u_matrix),u_label_plane_matrix:new e.aJ(t,i.u_label_plane_matrix),u_coord_matrix:new e.aJ(t,i.u_coord_matrix),u_is_text:new e.aH(t,i.u_is_text),u_pitch_with_map:new e.aH(t,i.u_pitch_with_map),u_is_along_line:new e.aH(t,i.u_is_along_line),u_is_variable_anchor:new e.aH(t,i.u_is_variable_anchor),u_texsize:new e.aM(t,i.u_texsize),u_texsize_icon:new e.aM(t,i.u_texsize_icon),u_texture:new e.aH(t,i.u_texture),u_texture_icon:new e.aH(t,i.u_texture_icon),u_gamma_scale:new e.aI(t,i.u_gamma_scale),u_device_pixel_ratio:new e.aI(t,i.u_device_pixel_ratio),u_is_halo:new e.aH(t,i.u_is_halo),u_translation:new e.aM(t,i.u_translation),u_pitched_scale:new e.aI(t,i.u_pitched_scale)}),background:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_opacity:new e.aI(t,i.u_opacity),u_color:new e.aN(t,i.u_color)}),backgroundPattern:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_opacity:new e.aI(t,i.u_opacity),u_image:new e.aH(t,i.u_image),u_pattern_tl_a:new e.aM(t,i.u_pattern_tl_a),u_pattern_br_a:new e.aM(t,i.u_pattern_br_a),u_pattern_tl_b:new e.aM(t,i.u_pattern_tl_b),u_pattern_br_b:new e.aM(t,i.u_pattern_br_b),u_texsize:new e.aM(t,i.u_texsize),u_mix:new e.aI(t,i.u_mix),u_pattern_size_a:new e.aM(t,i.u_pattern_size_a),u_pattern_size_b:new e.aM(t,i.u_pattern_size_b),u_scale_a:new e.aI(t,i.u_scale_a),u_scale_b:new e.aI(t,i.u_scale_b),u_pixel_coord_upper:new e.aM(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.aM(t,i.u_pixel_coord_lower),u_tile_units_to_pixels:new e.aI(t,i.u_tile_units_to_pixels)}),terrain:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_texture:new e.aH(t,i.u_texture),u_ele_delta:new e.aI(t,i.u_ele_delta)}),terrainDepth:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_ele_delta:new e.aI(t,i.u_ele_delta)}),terrainCoords:(t,i)=>({u_matrix:new e.aJ(t,i.u_matrix),u_texture:new e.aH(t,i.u_texture),u_terrain_coords_id:new e.aI(t,i.u_terrain_coords_id),u_ele_delta:new e.aI(t,i.u_ele_delta)})};class Ue{constructor(t,e,i){this.context=t;const r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ye={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ze{constructor(t,e,i,r){this.length=e.length,this.attributes=i,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;const n=t.gl;this.buffer=n.createBuffer(),t.bindVertexBuffer.set(this.buffer),n.bufferData(n.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let i=0;i<this.attributes.length;i++){const r=e.attributes[this.attributes[i].name];void 0!==r&&t.enableVertexAttribArray(r)}}setVertexAttribPointers(t,e,i){for(let r=0;r<this.attributes.length;r++){const n=this.attributes[r],a=e.attributes[n.name];void 0!==a&&t.vertexAttribPointer(a,n.components,t[Ye[n.type]],!1,this.itemSize,n.offset+this.itemSize*(i||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const qe=new WeakMap;function We(t){var e;if(qe.has(t))return qe.get(t);{const i=null===(e=t.getParameter(t.VERSION))||void 0===e?void 0:e.startsWith("WebGL 2.0");return qe.set(t,i),i}}class Ge{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Xe extends Ge{getDefault(){return e.aP.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ke extends Ge{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Je extends Ge{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Qe extends Ge{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ti extends Ge{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class ei extends Ge{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class ii extends Ge{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class ri extends Ge{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class ni extends Ge{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class ai extends Ge{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class si extends Ge{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class oi extends Ge{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class li extends Ge{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class ci extends Ge{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class di extends Ge{getDefault(){return e.aP.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class hi extends Ge{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class pi extends Ge{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class ui extends Ge{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class mi extends Ge{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class fi extends Ge{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class gi extends Ge{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class _i extends Ge{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class vi extends Ge{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class yi extends Ge{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class bi extends Ge{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class xi extends Ge{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class wi extends Ge{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ki extends Ge{getDefault(){return null}set(t){var e;if(t===this.current&&!this.dirty)return;const i=this.gl;We(i)?i.bindVertexArray(t):null===(e=i.getExtension("OES_vertex_array_object"))||void 0===e||e.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Ti extends Ge{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Si extends Ge{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Ci extends Ge{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Ei extends Ge{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class $i extends Ei{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Ai extends Ei{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ii extends Ei{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Mi{constructor(t,e,i,r,n){this.context=t,this.width=e,this.height=i;const a=t.gl,s=this.framebuffer=a.createFramebuffer();if(this.colorAttachment=new $i(t,s),r)this.depthAttachment=n?new Ii(t,s):new Ai(t,s);else if(n)throw new Error("Stencil cannot be set without depth");if(a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class Li{constructor(t,e,i){this.blendFunction=t,this.blendColor=e,this.mask=i}}Li.Replace=[1,0],Li.disabled=new Li(Li.Replace,e.aP.transparent,[!1,!1,!1,!1]),Li.unblended=new Li(Li.Replace,e.aP.transparent,[!0,!0,!0,!0]),Li.alphaBlended=new Li([1,771],e.aP.transparent,[!0,!0,!0,!0]);class Pi{constructor(t){var e,i;if(this.gl=t,this.clearColor=new Xe(this),this.clearDepth=new Ke(this),this.clearStencil=new Je(this),this.colorMask=new Qe(this),this.depthMask=new ti(this),this.stencilMask=new ei(this),this.stencilFunc=new ii(this),this.stencilOp=new ri(this),this.stencilTest=new ni(this),this.depthRange=new ai(this),this.depthTest=new si(this),this.depthFunc=new oi(this),this.blend=new li(this),this.blendFunc=new ci(this),this.blendColor=new di(this),this.blendEquation=new hi(this),this.cullFace=new pi(this),this.cullFaceSide=new ui(this),this.frontFace=new mi(this),this.program=new fi(this),this.activeTexture=new gi(this),this.viewport=new _i(this),this.bindFramebuffer=new vi(this),this.bindRenderbuffer=new yi(this),this.bindTexture=new bi(this),this.bindVertexBuffer=new xi(this),this.bindElementBuffer=new wi(this),this.bindVertexArray=new ki(this),this.pixelStoreUnpack=new Ti(this),this.pixelStoreUnpackPremultiplyAlpha=new Si(this),this.pixelStoreUnpackFlipY=new Ci(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),We(t)){this.HALF_FLOAT=t.HALF_FLOAT;const r=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(e=t.RGBA16F)&&void 0!==e?e:null==r?void 0:r.RGBA16F_EXT,this.RGB16F=null!==(i=t.RGB16F)&&void 0!==i?i:null==r?void 0:r.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const e=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==e?void 0:e.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new Ue(this,t,e)}createVertexBuffer(t,e,i){return new Ze(this,t,e,i)}createRenderbuffer(t,e,i){const r=this.gl,n=r.createRenderbuffer();return this.bindRenderbuffer.set(n),r.renderbufferStorage(r.RENDERBUFFER,t,e,i),this.bindRenderbuffer.set(null),n}createFramebuffer(t,e,i,r){return new Mi(this,t,e,i,r)}clear({color:t,depth:e,stencil:i}){const r=this.gl;let n=0;t&&(n|=r.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(n|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==i&&(n|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),r.clear(n)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){e.aE(t.blendFunction,Li.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return We(this.gl)?this.gl.createVertexArray():null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var e;return We(this.gl)?this.gl.deleteVertexArray(t):null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class Ri{constructor(t,e,i){this.func=t,this.mask=e,this.range=i}}Ri.ReadOnly=!1,Ri.ReadWrite=!0,Ri.disabled=new Ri(519,Ri.ReadOnly,[0,1]);const zi=7680;class Di{constructor(t,e,i,r,n,a){this.test=t,this.ref=e,this.mask=i,this.fail=r,this.depthFail=n,this.pass=a}}Di.disabled=new Di({func:519,mask:0},0,0,zi,zi,zi);class ji{constructor(t,e,i){this.enable=t,this.mode=e,this.frontFace=i}}let Oi;function Bi(t,i,r,n,a){const s=t.context,o=s.gl,l=t.useProgram("collisionBox"),c=[];let d=0,h=0;for(let u=0;u<n.length;u++){const m=n[u],f=i.getTile(m).getBucket(r);if(!f)continue;const g=a?f.textCollisionBox:f.iconCollisionBox,_=f.collisionCircleArray;if(_.length>0){const i=e.F();e.aQ(i,f.placementInvProjMatrix,t.transform.glCoordMatrix),e.aQ(i,i,f.placementViewportMatrix),c.push({circleArray:_,circleOffset:h,transform:m.posMatrix,invTransform:i,coord:m}),d+=_.length/4,h=d}g&&l.draw(s,o.LINES,Ri.disabled,Di.disabled,t.colorModeForRenderPass(),ji.disabled,{u_matrix:m.posMatrix,u_pixel_extrude_scale:[1/(p=t.transform).width,1/p.height]},t.style.map.terrain&&t.style.map.terrain.getTerrainData(m),r.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,null,t.transform.zoom,null,null,g.collisionVertexBuffer)}var p;if(!a||!c.length)return;const u=t.useProgram("collisionCircle"),m=new e.aR;m.resize(4*d),m._trim();let f=0;for(const t of c)for(let e=0;e<t.circleArray.length/4;e++){const i=4*e,r=t.circleArray[i+0],n=t.circleArray[i+1],a=t.circleArray[i+2],s=t.circleArray[i+3];m.emplace(f++,r,n,a,s,0),m.emplace(f++,r,n,a,s,1),m.emplace(f++,r,n,a,s,2),m.emplace(f++,r,n,a,s,3)}(!Oi||Oi.length<2*d)&&(Oi=function(t){const i=2*t,r=new e.aT;r.resize(i),r._trim();for(let t=0;t<i;t++){const e=6*t;r.uint16[e+0]=4*t+0,r.uint16[e+1]=4*t+1,r.uint16[e+2]=4*t+2,r.uint16[e+3]=4*t+2,r.uint16[e+4]=4*t+3,r.uint16[e+5]=4*t+0}return r}(d));const g=s.createIndexBuffer(Oi,!0),_=s.createVertexBuffer(m,e.aS.members,!0);for(const i of c){const n=Se(i.transform,i.invTransform,t.transform);u.draw(s,o.TRIANGLES,Ri.disabled,Di.disabled,t.colorModeForRenderPass(),ji.disabled,n,t.style.map.terrain&&t.style.map.terrain.getTerrainData(i.coord),r.id,_,g,e.$.simpleSegment(0,2*i.circleOffset,i.circleArray.length,i.circleArray.length/2),null,t.transform.zoom,null,null,null)}_.destroy(),g.destroy()}ji.disabled=new ji(!1,1029,2305),ji.backCCW=new ji(!0,1029,2305);const Fi=e.an(new Float32Array(16));function Ni(t,i,r,n,a,s){const{horizontalAlign:o,verticalAlign:l}=e.au(t);return new e.P((-(o-.5)*i/a+n[0])*s,(-(l-.5)*r/a+n[1])*s)}function Hi(t,i,r,n,a,s){const o=i.tileAnchorPoint.add(new e.P(i.translation[0],i.translation[1]));if(i.pitchWithMap){let t=n.mult(s);return r||(t=t.rotate(-a)),_t(o.add(t),i.labelPlaneMatrix,i.getElevation).point}if(r){const e=Ct(i.tileAnchorPoint.x+1,i.tileAnchorPoint.y,i).point.sub(t),r=Math.atan(e.y/e.x)+(e.x<0?Math.PI:0);return t.add(n.rotate(r))}return t.add(n)}function Vi(t,i,r,n,a,s,o,l,c,d,h,p,u,m){const f=t.text.placedSymbolArray,g=t.text.dynamicLayoutVertexArray,_=t.icon.dynamicLayoutVertexArray,v={};g.clear();for(let _=0;_<f.length;_++){const y=f.get(_),b=y.hidden||!y.crossTileID||t.allowVerticalPlacement&&!y.placedOrientation?null:n[y.crossTileID];if(b){const n=new e.P(y.anchorX,y.anchorY),f={getElevation:m,width:a.width,height:a.height,labelPlaneMatrix:s,lineVertexArray:null,pitchWithMap:r,projection:h,projectionCache:null,tileAnchorPoint:n,translation:p,unwrappedTileID:u},_=r?_t(n,o,m):Ct(n.x,n.y,f),x=vt(a.cameraToCenterDistance,_.signedDistanceFromCamera);let w=e.ai(t.textSizeData,c,y)*x/e.ap;r&&(w*=t.tilePixelRatio/l);const{width:k,height:T,anchor:S,textOffset:C,textBoxScale:E}=b,$=Ni(S,k,T,C,E,w),A=h.getPitchedTextCorrection(a,n.add(new e.P(p[0],p[1])),u),I=Hi(_.point,f,i,$,a.angle,A),M=t.allowVerticalPlacement&&y.placedOrientation===e.ah.vertical?Math.PI/2:0;for(let t=0;t<y.numGlyphs;t++)e.aj(g,I,M);d&&y.associatedIconIndex>=0&&(v[y.associatedIconIndex]={shiftedAnchor:I,angle:M})}else Mt(y.numGlyphs,g)}if(d){_.clear();const i=t.icon.placedSymbolArray;for(let t=0;t<i.length;t++){const r=i.get(t);if(r.hidden)Mt(r.numGlyphs,_);else{const i=v[t];if(i)for(let t=0;t<r.numGlyphs;t++)e.aj(_,i.shiftedAnchor,i.angle);else Mt(r.numGlyphs,_)}}t.icon.dynamicLayoutVertexBuffer.updateData(_)}t.text.dynamicLayoutVertexBuffer.updateData(g)}function Ui(t,e,i){return i.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function Yi(t,i,r,n,a,s,o,l,c,d,h,p){const u=t.context,m=u.gl,f=t.transform,g=Qt(),_="map"===l,v="map"===c,y="viewport"!==l&&"point"!==r.layout.get("symbol-placement"),b=_&&!v&&!y,x=!v&&y,w=!r.layout.get("symbol-sort-key").isConstant();let k=!1;const T=t.depthModeForSublayer(0,Ri.ReadOnly),S=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),C=[],E=g.getCircleRadiusCorrection(f);for(const l of n){const n=i.getTile(l),c=n.getBucket(r);if(!c)continue;const h=a?c.text:c.icon;if(!h||!h.segments.get().length||!h.hasVisibleVertices)continue;const p=h.programConfigurations.get(r.id),u=a||c.sdfIcons,T=a?c.textSizeData:c.iconSizeData,$=v||0!==f.pitch,A=t.useProgram(Ui(u,a,c),p),I=e.ag(T,f.zoom),M=t.style.map.terrain&&t.style.map.terrain.getTerrainData(l);let L,P,R,z,D=[0,0],j=null;if(a)P=n.glyphAtlasTexture,R=m.LINEAR,L=n.glyphAtlasTexture.size,c.iconsInText&&(D=n.imageAtlasTexture.size,j=n.imageAtlasTexture,z=$||t.options.rotating||t.options.zooming||"composite"===T.kind||"camera"===T.kind?m.LINEAR:m.NEAREST);else{const e=1!==r.layout.get("icon-size").constantOr(0)||c.iconsNeedLinear;P=n.imageAtlasTexture,R=u||t.options.rotating||t.options.zooming||e||$?m.LINEAR:m.NEAREST,L=n.imageAtlasTexture.size}const O=Rt(n,1,t.transform.zoom),B=x?l.posMatrix:Fi,F=ft(B,v,_,t.transform,O),N=gt(B,v,_,t.transform,O),H=gt(l.posMatrix,v,_,t.transform,O),V=g.translatePosition(t.transform,n,s,o),U=S&&c.hasTextData(),Y="none"!==r.layout.get("icon-text-fit")&&U&&c.hasIconData();if(y){const e=t.style.map.terrain?(e,i)=>t.style.map.terrain.getElevation(l,e,i):null,i="map"===r.layout.get("text-rotation-alignment");bt(c,l.posMatrix,t,a,F,H,v,d,i,g,l.toUnwrapped(),f.width,f.height,V,e)}const Z=l.posMatrix,q=a&&S||Y,W=y||q?Fi:F,G=N,X=u&&0!==r.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1);let K;K=u?c.iconsInText?Fe(T.kind,I,b,v,y,q,t,Z,W,G,V,L,D,E):Be(T.kind,I,b,v,y,q,t,Z,W,G,V,a,L,!0,E):Oe(T.kind,I,b,v,y,q,t,Z,W,G,V,a,L,E);const J={program:A,buffers:h,uniformValues:K,atlasTexture:P,atlasTextureIcon:j,atlasInterpolation:R,atlasInterpolationIcon:z,isSDF:u,hasHalo:X};if(w&&c.canOverlap){k=!0;const t=h.segments.get();for(const i of t)C.push({segments:new e.$([i]),sortKey:i.sortKey,state:J,terrainData:M})}else C.push({segments:h.segments,sortKey:0,state:J,terrainData:M})}k&&C.sort(((t,e)=>t.sortKey-e.sortKey));for(const e of C){const i=e.state;if(u.activeTexture.set(m.TEXTURE0),i.atlasTexture.bind(i.atlasInterpolation,m.CLAMP_TO_EDGE),i.atlasTextureIcon&&(u.activeTexture.set(m.TEXTURE1),i.atlasTextureIcon&&i.atlasTextureIcon.bind(i.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),i.isSDF){const n=i.uniformValues;i.hasHalo&&(n.u_is_halo=1,Zi(i.buffers,e.segments,r,t,i.program,T,h,p,n,e.terrainData)),n.u_is_halo=0}Zi(i.buffers,e.segments,r,t,i.program,T,h,p,i.uniformValues,e.terrainData)}}function Zi(t,e,i,r,n,a,s,o,l,c){const d=r.context;n.draw(d,d.gl.TRIANGLES,a,s,o,ji.disabled,l,c,i.id,t.layoutVertexBuffer,t.indexBuffer,e,i.paint,r.transform.zoom,t.programConfigurations.get(i.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function qi(t,e,i,r,n){if(!i||!r||!r.imageAtlas)return;const a=r.imageAtlas.patternPositions;let s=a[i.to.toString()],o=a[i.from.toString()];if(!s&&o&&(s=o),!o&&s&&(o=s),!s||!o){const t=n.getPaintProperty(e);s=a[t],o=a[t]}s&&o&&t.setConstantPatternPositions(s,o)}function Wi(t,e,i,r,n,a,s){const o=t.context.gl,l="fill-pattern",c=i.paint.get(l),d=c&&c.constantOr(1),h=i.getCrossfadeParameters();let p,u,m,f,g;s?(u=d&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",p=o.LINES):(u=d?"fillPattern":"fill",p=o.TRIANGLES);const _=c.constantOr(null);for(const c of r){const r=e.getTile(c);if(d&&!r.patternsLoaded())continue;const v=r.getBucket(i);if(!v)continue;const y=v.programConfigurations.get(i.id),b=t.useProgram(u,y),x=t.style.map.terrain&&t.style.map.terrain.getTerrainData(c);d&&(t.context.activeTexture.set(o.TEXTURE0),r.imageAtlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),y.updatePaintBuffers(h)),qi(y,l,_,r,i);const w=x?c:null,k=t.translatePosMatrix(w?w.posMatrix:c.posMatrix,r,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(s){f=v.indexBuffer2,g=v.segments2;const e=[o.drawingBufferWidth,o.drawingBufferHeight];m="fillOutlinePattern"===u&&d?ke(k,t,h,r,e):we(k,e)}else f=v.indexBuffer,g=v.segments,m=d?xe(k,t,h,r):be(k);b.draw(t.context,p,n,t.stencilModeForClipping(c),a,ji.disabled,m,x,i.id,v.layoutVertexBuffer,f,g,i.paint,t.transform.zoom,y)}}function Gi(t,e,i,r,n,a,s){const o=t.context,l=o.gl,c="fill-extrusion-pattern",d=i.paint.get(c),h=d.constantOr(1),p=i.getCrossfadeParameters(),u=i.paint.get("fill-extrusion-opacity"),m=d.constantOr(null);for(const d of r){const r=e.getTile(d),f=r.getBucket(i);if(!f)continue;const g=t.style.map.terrain&&t.style.map.terrain.getTerrainData(d),_=f.programConfigurations.get(i.id),v=t.useProgram(h?"fillExtrusionPattern":"fillExtrusion",_);h&&(t.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),_.updatePaintBuffers(p)),qi(_,c,m,r,i);const y=t.translatePosMatrix(d.posMatrix,r,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),b=i.paint.get("fill-extrusion-vertical-gradient"),x=h?ye(y,t,b,u,d,p,r):ve(y,t,b,u);v.draw(o,o.gl.TRIANGLES,n,a,s,ji.backCCW,x,g,i.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,i.paint,t.transform.zoom,_,t.style.map.terrain&&f.centroidVertexBuffer)}}function Xi(t,e,i,r,n,a,s){const o=t.context,l=o.gl,c=i.fbo;if(!c)return;const d=t.useProgram("hillshade"),h=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);o.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.colorAttachment.get()),d.draw(o,l.TRIANGLES,n,a,s,ji.disabled,((t,e,i,r)=>{const n=i.paint.get("hillshade-shadow-color"),a=i.paint.get("hillshade-highlight-color"),s=i.paint.get("hillshade-accent-color");let o=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(o-=t.transform.angle);const l=!t.options.moving;return{u_matrix:r?r.posMatrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:Ae(0,e.tileID),u_light:[i.paint.get("hillshade-exaggeration"),o],u_shadow:n,u_highlight:a,u_accent:s}})(t,i,r,h?e:null),h,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}function Ki(t,i,r,n,a,s){const o=t.context,l=o.gl,c=i.dem;if(c&&c.data){const d=c.dim,h=c.stride,p=c.getPixels();if(o.activeTexture.set(l.TEXTURE1),o.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||t.getTileTexture(h),i.demTexture){const t=i.demTexture;t.update(p,{premultiply:!1}),t.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else i.demTexture=new x(o,p,l.RGBA,{premultiply:!1}),i.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);o.activeTexture.set(l.TEXTURE0);let u=i.fbo;if(!u){const t=new x(o,{width:d,height:d,data:null},l.RGBA);t.bind(l.LINEAR,l.CLAMP_TO_EDGE),u=i.fbo=o.createFramebuffer(d,d,!0,!1),u.colorAttachment.set(t.texture)}o.bindFramebuffer.set(u.framebuffer),o.viewport.set([0,0,d,d]),t.useProgram("hillshadePrepare").draw(o,l.TRIANGLES,n,a,s,ji.disabled,((t,i)=>{const r=i.stride,n=e.F();return e.aO(n,0,e.W,-e.W,0,0,1),e.H(n,n,[0,-e.W,0]),{u_matrix:n,u_image:1,u_dimension:[r,r],u_zoom:t.overscaledZ,u_unpack:i.getUnpackVector()}})(i.tileID,c),null,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function Ji(t,i,r,n,s,o){const l=n.paint.get("raster-fade-duration");if(!o&&l>0){const n=a.now(),o=(n-t.timeAdded)/l,c=i?(n-i.timeAdded)/l:-1,d=r.getSource(),h=s.coveringZoomLevel({tileSize:d.tileSize,roundZoom:d.roundZoom}),p=!i||Math.abs(i.tileID.overscaledZ-h)>Math.abs(t.tileID.overscaledZ-h),u=p&&t.refreshedUponExpiration?1:e.ac(p?o:1-c,0,1);return t.refreshedUponExpiration&&o>=1&&(t.refreshedUponExpiration=!1),i?{opacity:1,mix:1-u}:{opacity:u,mix:0}}return{opacity:1,mix:0}}const Qi=new e.aP(1,0,0,1),tr=new e.aP(0,1,0,1),er=new e.aP(0,0,1,1),ir=new e.aP(1,0,1,1),rr=new e.aP(0,1,1,1);function nr(t,e,i,r){sr(t,0,e+i/2,t.transform.width,i,r)}function ar(t,e,i,r){sr(t,e-i/2,0,i,t.transform.height,r)}function sr(t,e,i,r,n,a){const s=t.context,o=s.gl;o.enable(o.SCISSOR_TEST),o.scissor(e*t.pixelRatio,i*t.pixelRatio,r*t.pixelRatio,n*t.pixelRatio),s.clear({color:a}),o.disable(o.SCISSOR_TEST)}function or(t,i,r){const n=t.context,a=n.gl,s=r.posMatrix,o=t.useProgram("debug"),l=Ri.disabled,c=Di.disabled,d=t.colorModeForRenderPass(),h="$debug",p=t.style.map.terrain&&t.style.map.terrain.getTerrainData(r);n.activeTexture.set(a.TEXTURE0);const u=i.getTileByID(r.key).latestRawTileData,m=Math.floor((u&&u.byteLength||0)/1024),f=i.getTile(r).tileSize,g=512/Math.min(f,512)*(r.overscaledZ/t.transform.zoom)*.5;let _=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(_+=` => ${r.overscaledZ}`),function(t,e){t.initDebugOverlayCanvas();const i=t.debugOverlayCanvas,r=t.context.gl,n=t.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,i.width,i.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(e,5,5),n.strokeText(e,5,5),t.debugOverlayTexture.update(i),t.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(t,`${_} ${m}kB`),o.draw(n,a.TRIANGLES,l,c,Li.alphaBlended,ji.disabled,Ce(s,e.aP.transparent,g),null,h,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments),o.draw(n,a.LINE_STRIP,l,c,d,ji.disabled,Ce(s,e.aP.red),p,h,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments)}function lr(t,e,i){const r=t.context,n=r.gl,a=t.colorModeForRenderPass(),s=new Ri(n.LEQUAL,Ri.ReadWrite,t.depthRangeFor3D),o=t.useProgram("terrain"),l=e.getTerrainMesh();r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height]);for(const c of i){const i=t.renderToTexture.getTexture(c),d=e.getTerrainData(c.tileID);r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,i.texture);const h={u_matrix:t.transform.calculatePosMatrix(c.tileID.toUnwrapped()),u_texture:0,u_ele_delta:e.getMeshFrameDelta(t.transform.zoom)};o.draw(r,n.TRIANGLES,s,Di.disabled,a,ji.backCCW,h,d,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}}class cr{constructor(t,i){this.context=new Pi(t),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:e.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ct.maxUnderzooming+ct.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new se}resize(t,e,i){if(this.width=Math.floor(t*i),this.height=Math.floor(e*i),this.pixelRatio=i,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style._order)this.style._layers[t].resize()}setup(){const t=this.context,i=new e.aW;i.emplaceBack(0,0),i.emplaceBack(e.W,0),i.emplaceBack(0,e.W),i.emplaceBack(e.W,e.W),this.tileExtentBuffer=t.createVertexBuffer(i,de.members),this.tileExtentSegments=e.$.simpleSegment(0,0,4,2);const r=new e.aW;r.emplaceBack(0,0),r.emplaceBack(e.W,0),r.emplaceBack(0,e.W),r.emplaceBack(e.W,e.W),this.debugBuffer=t.createVertexBuffer(r,de.members),this.debugSegments=e.$.simpleSegment(0,0,4,5);const n=new e.Z;n.emplaceBack(0,0,0,0),n.emplaceBack(e.W,0,e.W,0),n.emplaceBack(0,e.W,0,e.W),n.emplaceBack(e.W,e.W,e.W,e.W),this.rasterBoundsBuffer=t.createVertexBuffer(n,X.members),this.rasterBoundsSegments=e.$.simpleSegment(0,0,4,2);const a=new e.aW;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(a,de.members),this.viewportSegments=e.$.simpleSegment(0,0,4,2);const s=new e.aX;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(s);const o=new e.aY;o.emplaceBack(0,1,2),o.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(o);const l=this.context.gl;this.stencilClearMode=new Di({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}clearStencil(){const t=this.context,i=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const r=e.F();e.aO(r,0,this.width,this.height,0,0,1),e.J(r,r,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,i.TRIANGLES,Ri.disabled,this.stencilClearMode,Li.disabled,ji.disabled,Ee(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,e){if(this.currentStencilSource===t.source||!t.isTileClipped()||!e||!e.length)return;this.currentStencilSource=t.source;const i=this.context,r=i.gl;this.nextStencilID+e.length>256&&this.clearStencil(),i.setColorMode(Li.disabled),i.setDepthMode(Ri.disabled);const n=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const t of e){const e=this._tileClippingMaskIDs[t.key]=this.nextStencilID++,a=this.style.map.terrain&&this.style.map.terrain.getTerrainData(t);n.draw(i,r.TRIANGLES,Ri.disabled,new Di({func:r.ALWAYS,mask:0},e,255,r.KEEP,r.KEEP,r.REPLACE),Li.disabled,ji.disabled,Ee(t.posMatrix),a,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,e=this.context.gl;return new Di({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)}stencilModeForClipping(t){const e=this.context.gl;return new Di({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)}stencilConfigForOverlap(t){const e=this.context.gl,i=t.sort(((t,e)=>e.overscaledZ-t.overscaledZ)),r=i[i.length-1].overscaledZ,n=i[0].overscaledZ-r+1;if(n>1){this.currentStencilSource=void 0,this.nextStencilID+n>256&&this.clearStencil();const t={};for(let i=0;i<n;i++)t[i+r]=new Di({func:e.GEQUAL,mask:255},i+this.nextStencilID,255,e.KEEP,e.KEEP,e.REPLACE);return this.nextStencilID+=n,[t,i]}return[{[r]:Di.disabled},i]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const i=1/8;return new Li([t.CONSTANT_COLOR,t.ONE],new e.aP(i,i,i,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Li.unblended:Li.alphaBlended}depthModeForSublayer(t,e,i){if(!this.opaquePassEnabledForLayer())return Ri.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Ri(i||this.context.gl.LEQUAL,e,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,i){this.style=t,this.options=i,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(a.now()),this.imageManager.beginFrame();const r=this.style._order,n=this.style.sourceCaches,s={},o={},l={};for(const t in n){const e=n[t];e.used&&e.prepare(this.context),s[t]=e.getVisibleCoordinates(),o[t]=s[t].slice().reverse(),l[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<r.length;t++)if(this.style._layers[r[t]].is3D()){this.opaquePassCutoff=t;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const t of r){const e=this.style._layers[t];if(!e.hasOffscreenPass()||e.isHidden(this.transform.zoom))continue;const i=o[e.source];("custom"===e.type||i.length)&&this.renderLayer(this,n[e.source],e,i)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?e.aP.black:e.aP.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[r[this.currentLayer]],e=n[t.source],i=s[t.source];this._renderTileClippingMasks(t,i),this.renderLayer(this,e,t,i)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const t=this.style._layers[r[this.currentLayer]],e=n[t.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(t))continue;const i=("symbol"===t.type?l:o)[t.source];this._renderTileClippingMasks(t,s[t.source]),this.renderLayer(this,e,t,i)}if(this.options.showTileBoundaries){const t=function(t,e){let i=null;const r=Object.values(t._layers).flatMap((i=>i.source&&!i.isHidden(e)?[t.sourceCaches[i.source]]:[])),n=r.filter((t=>"vector"===t.getSource().type)),a=r.filter((t=>"vector"!==t.getSource().type)),s=t=>{(!i||i.getSource().maxzoom<t.getSource().maxzoom)&&(i=t)};return n.forEach((t=>s(t))),i||a.forEach((t=>s(t))),i}(this.style,this.transform.zoom);t&&function(t,e,i){for(let r=0;r<i.length;r++)or(t,e,i[r])}(this,t,t.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;nr(t,t.transform.height-(e.top||0),3,Qi),nr(t,e.bottom||0,3,tr),ar(t,e.left||0,3,er),ar(t,t.transform.width-(e.right||0),3,ir);const i=t.transform.centerPoint;!function(t,e,i,r){sr(t,e-1,i-10,2,20,r),sr(t,e-10,i-1,20,2,r)}(t,i.x,t.transform.height-i.y,rr)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const i=this.terrainFacilitator.matrix,r=this.transform.modelViewProjectionMatrix;let n=this.terrainFacilitator.dirty;n||(n=t?!e.aZ(i,r):!e.a_(i,r)),n||(n=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),n&&(e.a$(i,r),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(t,i){const r=t.context,n=r.gl,a=Li.unblended,s=new Ri(n.LEQUAL,Ri.ReadWrite,[0,1]),o=i.getTerrainMesh(),l=i.sourceCache.getRenderableTiles(),c=t.useProgram("terrainDepth");r.bindFramebuffer.set(i.getFramebuffer("depth").framebuffer),r.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),r.clear({color:e.aP.transparent,depth:1});for(const e of l){const l=i.getTerrainData(e.tileID),d={u_matrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped()),u_ele_delta:i.getMeshFrameDelta(t.transform.zoom)};c.draw(r,n.TRIANGLES,s,Di.disabled,a,ji.backCCW,d,l,"terrain",o.vertexBuffer,o.indexBuffer,o.segments)}r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain),function(t,i){const r=t.context,n=r.gl,a=Li.unblended,s=new Ri(n.LEQUAL,Ri.ReadWrite,[0,1]),o=i.getTerrainMesh(),l=i.getCoordsTexture(),c=i.sourceCache.getRenderableTiles(),d=t.useProgram("terrainCoords");r.bindFramebuffer.set(i.getFramebuffer("coords").framebuffer),r.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),r.clear({color:e.aP.transparent,depth:1}),i.coordsIndex=[];for(const e of c){const c=i.getTerrainData(e.tileID);r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,l.texture);const h={u_matrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped()),u_terrain_coords_id:(255-i.coordsIndex.length)/255,u_texture:0,u_ele_delta:i.getMeshFrameDelta(t.transform.zoom)};d.draw(r,n.TRIANGLES,s,Di.disabled,a,ji.backCCW,h,c,"terrain",o.vertexBuffer,o.indexBuffer,o.segments),i.coordsIndex.push(e.tileID.key)}r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain))}renderLayer(t,i,r,n){if(!r.isHidden(this.transform.zoom)&&("background"===r.type||"custom"===r.type||(n||[]).length))switch(this.id=r.id,r.type){case"symbol":!function(t,i,r,n,a){if("translucent"!==t.renderPass)return;const s=Di.disabled,o=t.colorModeForRenderPass();(r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(t,i,r,n,a,s,o,l,c){const d=i.transform,h=Qt(),p="map"===a,u="map"===s;for(const a of t){const t=n.getTile(a),s=t.getBucket(r);if(!s||!s.text||!s.text.segments.get().length)continue;const m=e.ag(s.textSizeData,d.zoom),f=Rt(t,1,i.transform.zoom),g=ft(a.posMatrix,u,p,i.transform,f),_="none"!==r.layout.get("icon-text-fit")&&s.hasIconData();if(m){const e=Math.pow(2,d.zoom-t.tileID.overscaledZ),r=i.style.map.terrain?(t,e)=>i.style.map.terrain.getElevation(a,t,e):null,n=h.translatePosition(d,t,o,l);Vi(s,p,u,c,d,g,a.posMatrix,e,m,_,h,n,a.toUnwrapped(),r)}}}(n,t,r,i,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),a),0!==r.paint.get("icon-opacity").constantOr(1)&&Yi(t,i,r,n,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),s,o),0!==r.paint.get("text-opacity").constantOr(1)&&Yi(t,i,r,n,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),s,o),i.map.showCollisionBoxes&&(Bi(t,i,r,n,!0),Bi(t,i,r,n,!1))}(t,i,r,n,this.style.placement.variableOffsets);break;case"circle":!function(t,i,r,n){if("translucent"!==t.renderPass)return;const a=r.paint.get("circle-opacity"),s=r.paint.get("circle-stroke-width"),o=r.paint.get("circle-stroke-opacity"),l=!r.layout.get("circle-sort-key").isConstant();if(0===a.constantOr(1)&&(0===s.constantOr(1)||0===o.constantOr(1)))return;const c=t.context,d=c.gl,h=t.depthModeForSublayer(0,Ri.ReadOnly),p=Di.disabled,u=t.colorModeForRenderPass(),m=[];for(let a=0;a<n.length;a++){const s=n[a],o=i.getTile(s),c=o.getBucket(r);if(!c)continue;const d=c.programConfigurations.get(r.id),h=t.useProgram("circle",d),p=c.layoutVertexBuffer,u=c.indexBuffer,f=t.style.map.terrain&&t.style.map.terrain.getTerrainData(s),g={programConfiguration:d,program:h,layoutVertexBuffer:p,indexBuffer:u,uniformValues:Te(t,s,o,r),terrainData:f};if(l){const t=c.segments.get();for(const i of t)m.push({segments:new e.$([i]),sortKey:i.sortKey,state:g})}else m.push({segments:c.segments,sortKey:0,state:g})}l&&m.sort(((t,e)=>t.sortKey-e.sortKey));for(const e of m){const{programConfiguration:i,program:n,layoutVertexBuffer:a,indexBuffer:s,uniformValues:o,terrainData:l}=e.state;n.draw(c,d.TRIANGLES,h,p,u,ji.disabled,o,l,r.id,a,s,e.segments,r.paint,t.transform.zoom,i)}}(t,i,r,n);break;case"heatmap":!function(t,i,r,n){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const a=t.context,s=a.gl,o=Di.disabled,l=new Li([s.ONE,s.ONE],e.aP.transparent,[!0,!0,!0,!0]);!function(t,e,i){const r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let n=i.heatmapFbo;if(n)r.bindTexture(r.TEXTURE_2D,n.colorAttachment.get()),t.bindFramebuffer.set(n.framebuffer);else{const a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),n=i.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1,!1),function(t,e,i,r){var n,a;const s=t.gl,o=null!==(n=t.HALF_FLOAT)&&void 0!==n?n:s.UNSIGNED_BYTE,l=null!==(a=t.RGBA16F)&&void 0!==a?a:s.RGBA;s.texImage2D(s.TEXTURE_2D,0,l,e.width/4,e.height/4,0,s.RGBA,o,null),r.colorAttachment.set(i)}(t,e,a,n)}}(a,t,r),a.clear({color:e.aP.transparent});for(let e=0;e<n.length;e++){const c=n[e];if(i.hasRenderableParent(c))continue;const d=i.getTile(c),h=d.getBucket(r);if(!h)continue;const p=h.programConfigurations.get(r.id),u=t.useProgram("heatmap",p),{zoom:m}=t.transform;u.draw(a,s.TRIANGLES,Ri.disabled,o,l,ji.disabled,$e(c.posMatrix,d,m,r.paint.get("heatmap-intensity")),null,r.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,r.paint,t.transform.zoom,p)}a.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,i){const r=t.context,n=r.gl,a=i.heatmapFbo;if(!a)return;r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,a.colorAttachment.get()),r.activeTexture.set(n.TEXTURE1);let s=i.colorRampTexture;s||(s=i.colorRampTexture=new x(r,i.colorRamp,n.RGBA)),s.bind(n.LINEAR,n.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(r,n.TRIANGLES,Ri.disabled,Di.disabled,t.colorModeForRenderPass(),ji.disabled,((t,i,r,n)=>{const a=e.F();e.aO(a,0,t.width,t.height,0,0,1);const s=t.context.gl;return{u_matrix:a,u_world:[s.drawingBufferWidth,s.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:i.paint.get("heatmap-opacity")}})(t,i),null,i.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,i.paint,t.transform.zoom)}(t,r))}(t,i,r,n);break;case"line":!function(t,i,r,n){if("translucent"!==t.renderPass)return;const a=r.paint.get("line-opacity"),s=r.paint.get("line-width");if(0===a.constantOr(1)||0===s.constantOr(1))return;const o=t.depthModeForSublayer(0,Ri.ReadOnly),l=t.colorModeForRenderPass(),c=r.paint.get("line-dasharray"),d=r.paint.get("line-pattern"),h=d.constantOr(1),p=r.paint.get("line-gradient"),u=r.getCrossfadeParameters(),m=h?"linePattern":c?"lineSDF":p?"lineGradient":"line",f=t.context,g=f.gl;let _=!0;for(const a of n){const n=i.getTile(a);if(h&&!n.patternsLoaded())continue;const s=n.getBucket(r);if(!s)continue;const v=s.programConfigurations.get(r.id),y=t.context.program.get(),b=t.useProgram(m,v),w=_||b.program!==y,k=t.style.map.terrain&&t.style.map.terrain.getTerrainData(a),T=d.constantOr(null);if(T&&n.imageAtlas){const t=n.imageAtlas,e=t.patternPositions[T.to.toString()],i=t.patternPositions[T.from.toString()];e&&i&&v.setConstantPatternPositions(e,i)}const S=k?a:null,C=h?Le(t,n,r,u,S):c?Pe(t,n,r,c,u,S):p?Me(t,n,r,s.lineClipsArray.length,S):Ie(t,n,r,S);if(h)f.activeTexture.set(g.TEXTURE0),n.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),v.updatePaintBuffers(u);else if(c&&(w||t.lineAtlas.dirty))f.activeTexture.set(g.TEXTURE0),t.lineAtlas.bind(f);else if(p){const n=s.gradients[r.id];let o=n.texture;if(r.gradientVersion!==n.version){let l=256;if(r.stepInterpolant){const r=i.getSource().maxzoom,n=a.canonical.z===r?Math.ceil(1<<t.transform.maxZoom-a.canonical.z):1;l=e.ac(e.aU(s.maxLineLength/e.W*1024*n),256,f.maxTextureSize)}n.gradient=e.aV({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:n.gradient||void 0,clips:s.lineClipsArray}),n.texture?n.texture.update(n.gradient):n.texture=new x(f,n.gradient,g.RGBA),n.version=r.gradientVersion,o=n.texture}f.activeTexture.set(g.TEXTURE0),o.bind(r.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}b.draw(f,g.TRIANGLES,o,t.stencilModeForClipping(a),l,ji.disabled,C,k,r.id,s.layoutVertexBuffer,s.indexBuffer,s.segments,r.paint,t.transform.zoom,v,s.layoutVertexBuffer2),_=!1}}(t,i,r,n);break;case"fill":!function(t,i,r,n){const a=r.paint.get("fill-color"),s=r.paint.get("fill-opacity");if(0===s.constantOr(1))return;const o=t.colorModeForRenderPass(),l=r.paint.get("fill-pattern"),c=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===a.constantOr(e.aP.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(t.renderPass===c){const e=t.depthModeForSublayer(1,"opaque"===t.renderPass?Ri.ReadWrite:Ri.ReadOnly);Wi(t,i,r,n,e,o,!1)}if("translucent"===t.renderPass&&r.paint.get("fill-antialias")){const e=t.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Ri.ReadOnly);Wi(t,i,r,n,e,o,!0)}}(t,i,r,n);break;case"fill-extrusion":!function(t,e,i,r){const n=i.paint.get("fill-extrusion-opacity");if(0!==n&&"translucent"===t.renderPass){const a=new Ri(t.context.gl.LEQUAL,Ri.ReadWrite,t.depthRangeFor3D);if(1!==n||i.paint.get("fill-extrusion-pattern").constantOr(1))Gi(t,e,i,r,a,Di.disabled,Li.disabled),Gi(t,e,i,r,a,t.stencilModeFor3D(),t.colorModeForRenderPass());else{const n=t.colorModeForRenderPass();Gi(t,e,i,r,a,Di.disabled,n)}}}(t,i,r,n);break;case"hillshade":!function(t,e,i,r){if("offscreen"!==t.renderPass&&"translucent"!==t.renderPass)return;const n=t.context,a=t.depthModeForSublayer(0,Ri.ReadOnly),s=t.colorModeForRenderPass(),[o,l]="translucent"===t.renderPass?t.stencilConfigForOverlap(r):[{},r];for(const r of l){const n=e.getTile(r);void 0!==n.needsHillshadePrepare&&n.needsHillshadePrepare&&"offscreen"===t.renderPass?Ki(t,n,i,a,Di.disabled,s):"translucent"===t.renderPass&&Xi(t,r,n,i,a,o[r.overscaledZ],s)}n.viewport.set([0,0,t.width,t.height])}(t,i,r,n);break;case"raster":!function(t,e,i,r){if("translucent"!==t.renderPass)return;if(0===i.paint.get("raster-opacity"))return;if(!r.length)return;const n=t.context,a=n.gl,s=e.getSource(),o=t.useProgram("raster"),l=t.colorModeForRenderPass(),[c,d]=s instanceof K?[{},r]:t.stencilConfigForOverlap(r),h=d[d.length-1].overscaledZ,p=!t.options.moving;for(const r of d){const d=t.depthModeForSublayer(r.overscaledZ-h,1===i.paint.get("raster-opacity")?Ri.ReadWrite:Ri.ReadOnly,a.LESS),u=e.getTile(r);u.registerFadeDuration(i.paint.get("raster-fade-duration"));const m=e.findLoadedParent(r,0),f=e.findLoadedSibling(r),g=Ji(u,m||f||null,e,i,t.transform,t.style.map.terrain);let _,v;const y="nearest"===i.paint.get("raster-resampling")?a.NEAREST:a.LINEAR;n.activeTexture.set(a.TEXTURE0),u.texture.bind(y,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(a.TEXTURE1),m?(m.texture.bind(y,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),_=Math.pow(2,m.tileID.overscaledZ-u.tileID.overscaledZ),v=[u.tileID.canonical.x*_%1,u.tileID.canonical.y*_%1]):u.texture.bind(y,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const b=t.style.map.terrain&&t.style.map.terrain.getTerrainData(r),x=b?r:null,w=x?x.posMatrix:t.transform.calculatePosMatrix(r.toUnwrapped(),p),k=De(w,v||[0,0],_||1,g,i);s instanceof K?o.draw(n,a.TRIANGLES,d,Di.disabled,l,ji.disabled,k,b,i.id,s.boundsBuffer,t.quadTriangleIndexBuffer,s.boundsSegments):o.draw(n,a.TRIANGLES,d,c[r.overscaledZ],l,ji.disabled,k,b,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}(t,i,r,n);break;case"background":!function(t,e,i,r){const n=i.paint.get("background-color"),a=i.paint.get("background-opacity");if(0===a)return;const s=t.context,o=s.gl,l=t.transform,c=l.tileSize,d=i.paint.get("background-pattern");if(t.isPatternMissing(d))return;const h=!d&&1===n.a&&1===a&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==h)return;const p=Di.disabled,u=t.depthModeForSublayer(0,"opaque"===h?Ri.ReadWrite:Ri.ReadOnly),m=t.colorModeForRenderPass(),f=t.useProgram(d?"backgroundPattern":"background"),g=r||l.coveringTiles({tileSize:c,terrain:t.style.map.terrain});d&&(s.activeTexture.set(o.TEXTURE0),t.imageManager.bind(t.context));const _=i.getCrossfadeParameters();for(const e of g){const l=r?e.posMatrix:t.transform.calculatePosMatrix(e.toUnwrapped()),h=d?He(l,a,t,d,{tileID:e,tileSize:c},_):Ne(l,a,n),g=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);f.draw(s,o.TRIANGLES,u,p,m,ji.disabled,h,g,i.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}(t,0,r,n);break;case"custom":!function(t,e,i){const r=t.context,n=i.implementation;if("offscreen"===t.renderPass){const e=n.prerender;e&&(t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),e.call(n,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),r.setStencilMode(Di.disabled);const e="3d"===n.renderingMode?new Ri(t.context.gl.LEQUAL,Ri.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Ri.ReadOnly);r.setDepthMode(e),n.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}(t,0,r)}}translatePosMatrix(t,i,r,n,a){if(!r[0]&&!r[1])return t;const s=a?"map"===n?this.transform.angle:0:"viewport"===n?-this.transform.angle:0;if(s){const t=Math.sin(s),e=Math.cos(s);r=[r[0]*e-r[1]*t,r[0]*t+r[1]*e]}const o=[a?r[0]:Rt(i,r[0],this.transform.zoom),a?r[1]:Rt(i,r[1],this.transform.zoom),0],l=new Float32Array(16);return e.H(l,t,o),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const e=this.imageManager.getPattern(t.from.toString()),i=this.imageManager.getPattern(t.to.toString());return!e||!i}useProgram(t,e){this.cache=this.cache||{};const i=t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[i]||(this.cache[i]=new ge(this.context,pe[t],e,Ve[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[i]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new x(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:e}=this.context.gl;return this.width!==t||this.height!==e}}class dr{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(t,i,r){const n=Math.pow(2,r),a=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((r=>{const a=1/(r=e.af([],r,t))[3]/i*n;return e.b0(r,r,[a,a,1/r[3],a])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((t=>{const e=function(t,e){var i=e[0],r=e[1],n=e[2],a=i*i+r*r+n*n;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}([],function(t,e,i){var r=e[0],n=e[1],a=e[2],s=i[0],o=i[1],l=i[2];return t[0]=n*l-a*o,t[1]=a*s-r*l,t[2]=r*o-n*s,t}([],_([],a[t[0]],a[t[1]]),_([],a[t[2]],a[t[1]]))),i=-((r=e)[0]*(n=a[t[1]])[0]+r[1]*n[1]+r[2]*n[2]);var r,n;return e.concat(i)}));return new dr(a,s)}}class hr{constructor(t,e){this.min=t,this.max=e,this.center=function(t,e,i){return t[0]=.5*e[0],t[1]=.5*e[1],t[2]=.5*e[2],t}([],function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}([],this.min,this.max))}quadrant(t){const e=[t%2==0,t<2],i=f(this.min),r=f(this.max);for(let t=0;t<e.length;t++)i[t]=e[t]?this.min[t]:this.center[t],r[t]=e[t]?this.center[t]:this.max[t];return r[2]=this.max[2],new hr(i,r)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const i=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let r=!0;for(let n=0;n<t.planes.length;n++){const a=t.planes[n];let s=0;for(let t=0;t<i.length;t++)e.b1(a,i[t])>=0&&s++;if(0===s)return 0;s!==i.length&&(r=!1)}if(r)return 2;for(let e=0;e<3;e++){let i=Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let n=0;n<t.points.length;n++){const a=t.points[n][e]-this.min[e];i=Math.min(i,a),r=Math.max(r,a)}if(r<0||i>this.max[e]-this.min[e])return 0}return 1}}class pr{constructor(t=0,e=0,i=0,r=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(i)||i<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=i,this.right=r}interpolate(t,i,r){return null!=i.top&&null!=t.top&&(this.top=e.z.number(t.top,i.top,r)),null!=i.bottom&&null!=t.bottom&&(this.bottom=e.z.number(t.bottom,i.bottom,r)),null!=i.left&&null!=t.left&&(this.left=e.z.number(t.left,i.left,r)),null!=i.right&&null!=t.right&&(this.right=e.z.number(t.right,i.right,r)),this}getCenter(t,i){const r=e.ac((this.left+t-this.right)/2,0,t),n=e.ac((this.top+i-this.bottom)/2,0,i);return new e.P(r,n)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new pr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const ur=85.051129;class mr{constructor(t,i,r,n,a){this.tileSize=512,this._renderWorldCopies=void 0===a||!!a,this._minZoom=t||0,this._maxZoom=i||22,this._minPitch=null==r?0:r,this._maxPitch=null==n?60:n,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new pr,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const t=new mr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.minElevationForCurrentTile=t.minElevationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new e.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const i=-e.b2(t,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=function(){var t=new e.A(4);return e.A!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}(),function(t,e,i){var r=e[0],n=e[1],a=e[2],s=e[3],o=Math.sin(i),l=Math.cos(i);t[0]=r*l+a*o,t[1]=n*l+s*o,t[2]=r*-o+a*l,t[3]=n*-o+s*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const i=e.ac(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.tileZoom=Math.max(0,Math.floor(e)),this.scale=this.zoomScale(e),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,i){this._unmodified=!1,this._edgeInsets.interpolate(t,e,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(t){const i=[new e.b3(0,t)];if(this._renderWorldCopies){const r=this.pointCoordinate(new e.P(0,0)),n=this.pointCoordinate(new e.P(this.width,0)),a=this.pointCoordinate(new e.P(this.width,this.height)),s=this.pointCoordinate(new e.P(0,this.height)),o=Math.floor(Math.min(r.x,n.x,a.x,s.x)),l=Math.floor(Math.max(r.x,n.x,a.x,s.x)),c=1;for(let r=o-c;r<=l+c;r++)0!==r&&i.push(new e.b3(r,t))}return i}coveringTiles(t){var i,r;let n=this.coveringZoomLevel(t);const a=n;if(void 0!==t.minzoom&&n<t.minzoom)return[];void 0!==t.maxzoom&&n>t.maxzoom&&(n=t.maxzoom);const s=this.pointCoordinate(this.getCameraPoint()),o=e.Y.fromLngLat(this.center),l=Math.pow(2,n),c=[l*s.x,l*s.y,0],d=[l*o.x,l*o.y,0],h=dr.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,n);let p=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(p=n);const u=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,m=t=>({aabb:new hr([t*l,0,0],[(t+1)*l,l,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),f=[],g=[],_=n,y=t.reparseOverscaled?a:n;if(this._renderWorldCopies)for(let t=1;t<=3;t++)f.push(m(-t)),f.push(m(t));for(f.push(m(0));f.length>0;){const n=f.pop(),a=n.x,s=n.y;let o=n.fullyVisible;if(!o){const t=n.aabb.intersects(h);if(0===t)continue;o=2===t}const l=t.terrain?c:d,m=n.aabb.distanceX(l),b=n.aabb.distanceY(l),x=Math.max(Math.abs(m),Math.abs(b));if(n.zoom===_||x>u+(1<<_-n.zoom)-2&&n.zoom>=p){const t=_-n.zoom,i=c[0]-.5-(a<<t),r=c[1]-.5-(s<<t);g.push({tileID:new e.Q(n.zoom===_?y:n.zoom,n.wrap,n.zoom,a,s),distanceSq:v([d[0]-.5-a,d[1]-.5-s]),tileDistanceToCamera:Math.sqrt(i*i+r*r)})}else for(let l=0;l<4;l++){const c=(a<<1)+l%2,d=(s<<1)+(l>>1),h=n.zoom+1;let p=n.aabb.quadrant(l);if(t.terrain){const a=new e.Q(h,n.wrap,h,c,d),s=t.terrain.getMinMaxElevation(a),o=null!==(i=s.minElevation)&&void 0!==i?i:this.elevation,l=null!==(r=s.maxElevation)&&void 0!==r?r:this.elevation;p=new hr([p.min[0],p.min[1],o],[p.max[0],p.max[1],l])}f.push({aabb:p,zoom:h,x:c,y:d,wrap:n.wrap,fullyVisible:o})}}return g.sort(((t,e)=>t.distanceSq-e.distanceSq)).map((t=>t.tileID))}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const i=e.ac(t.lat,-85.051129,ur);return new e.P(e.N(t.lng)*this.worldSize,e.O(i)*this.worldSize)}unproject(t){return new e.Y(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const i=this.elevation,r=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,n=this.pointLocation(this.centerPoint,t),a=t.getElevationForLngLatZoom(n,this.tileZoom);if(!(this.elevation-a))return;const s=r+i-a,o=Math.cos(this._pitch)*this.cameraToCenterDistance/s/e.b4(1,n.lat),l=this.scaleZoom(o/this.tileSize);this._elevation=a,this._center=n,this.zoom=l}setLocationAtPoint(t,i){const r=this.pointCoordinate(i),n=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(t),s=new e.Y(a.x-(r.x-n.x),a.y-(r.y-n.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,e){return e?this.coordinatePoint(this.locationCoordinate(t),e.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,e){return this.coordinateLocation(this.pointCoordinate(t,e))}locationCoordinate(t){return e.Y.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,i){if(i){const e=i.pointCoordinate(t);if(null!=e)return e}const r=[t.x,t.y,0,1],n=[t.x,t.y,1,1];e.af(r,r,this.pixelMatrixInverse),e.af(n,n,this.pixelMatrixInverse);const a=r[3],s=n[3],o=r[1]/a,l=n[1]/s,c=r[2]/a,d=n[2]/s,h=c===d?0:(0-c)/(d-c);return new e.Y(e.z.number(r[0]/a,n[0]/s,h)/this.worldSize,e.z.number(o,l,h)/this.worldSize)}coordinatePoint(t,i=0,r=this.pixelMatrix){const n=[t.x*this.worldSize,t.y*this.worldSize,i,1];return e.af(n,n,r),new e.P(n[0]/n[3],n[1]/n[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return(new U).extend(this.pointLocation(new e.P(0,t))).extend(this.pointLocation(new e.P(this.width,t))).extend(this.pointLocation(new e.P(this.width,this.height))).extend(this.pointLocation(new e.P(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new U([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,ur])}calculatePosMatrix(t,i=!1){const r=t.key,n=i?this._alignedPosMatrixCache:this._posMatrixCache;if(n[r])return n[r];const a=t.canonical,s=this.worldSize/this.zoomScale(a.z),o=a.x+Math.pow(2,a.z)*t.wrap,l=e.an(new Float64Array(16));return e.H(l,l,[o*s,a.y*s,0]),e.J(l,l,[s/e.W,s/e.W,1]),e.K(l,i?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,l),n[r]=new Float32Array(l),n[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(t,i){i=e.ac(+i,this.minZoom,this.maxZoom);const r={center:new e.M(t.lng,t.lat),zoom:i};let n=this.lngRange;if(!this._renderWorldCopies&&null===n){const t=180-1e-10;n=[-t,t]}const a=this.tileSize*this.zoomScale(r.zoom);let s=0,o=a,l=0,c=a,d=0,h=0;const{x:p,y:u}=this.size;if(this.latRange){const t=this.latRange;s=e.O(t[1])*a,o=e.O(t[0])*a,o-s<u&&(d=u/(o-s))}n&&(l=e.b2(e.N(n[0])*a,0,a),c=e.b2(e.N(n[1])*a,0,a),c<l&&(c+=a),c-l<p&&(h=p/(c-l)));const{x:m,y:f}=this.project.call({worldSize:a},t);let g,_;const v=Math.max(h||0,d||0);if(v){const t=new e.P(h?(c+l)/2:m,d?(o+s)/2:f);return r.center=this.unproject.call({worldSize:a},t).wrap(),r.zoom+=this.scaleZoom(v),r}if(this.latRange){const t=u/2;f-t<s&&(_=s+t),f+t>o&&(_=o-t)}if(n){const t=(l+c)/2;let i=m;this._renderWorldCopies&&(i=e.b2(m,t-a/2,t+a/2));const r=p/2;i-r<l&&(g=l+r),i+r>c&&(g=c-r)}if(void 0!==g||void 0!==_){const t=new e.P(null!=g?g:m,null!=_?_:f);r.center=this.unproject.call({worldSize:a},t).wrap()}return r}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:e,zoom:i}=this.getConstrained(this.center,this.zoom);this.center=e,this.zoom=i,this._unmodified=t,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,i=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=e.b4(1,this.center.lat)*this.worldSize;let n=e.an(new Float64Array(16));e.J(n,n,[this.width/2,-this.height/2,1]),e.H(n,n,[1,-1,0]),this.labelPlaneMatrix=n,n=e.an(new Float64Array(16)),e.J(n,n,[1,-1,1]),e.H(n,n,[-1,-1,0]),e.J(n,n,[2/this.width,2/this.height,1]),this.glCoordMatrix=n;const a=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this.minElevationForCurrentTile),o=a-s*this._pixelPerMeter/Math.cos(this._pitch),l=s<0?o:a,c=Math.PI/2+this._pitch,d=this._fov*(.5+t.y/this.height),h=Math.sin(d)*l/Math.sin(e.ac(Math.PI-c-d,.01,Math.PI-.01)),p=this.getHorizon(),u=2*Math.atan(p/this.cameraToCenterDistance)*(.5+t.y/(2*p)),m=Math.sin(u)*l/Math.sin(e.ac(Math.PI-c-u,.01,Math.PI-.01)),f=Math.min(h,m),g=1.01*(Math.cos(Math.PI/2-this._pitch)*f+l),_=this.height/50;n=new Float64Array(16),e.b5(n,this._fov,this.width/this.height,_,g),n[8]=2*-t.x/this.width,n[9]=2*t.y/this.height,e.J(n,n,[1,-1,1]),e.H(n,n,[0,0,-this.cameraToCenterDistance]),e.b6(n,n,this._pitch),e.ad(n,n,this.angle),e.H(n,n,[-i,-r,0]),this.mercatorMatrix=e.J([],n,[this.worldSize,this.worldSize,this.worldSize]),e.J(n,n,[1,1,this._pixelPerMeter]),this.pixelMatrix=e.K(new Float64Array(16),this.labelPlaneMatrix,n),e.H(n,n,[0,0,-this.elevation]),this.modelViewProjectionMatrix=n,this.invModelViewProjectionMatrix=e.as([],n),this.pixelMatrix3D=e.K(new Float64Array(16),this.labelPlaneMatrix,n);const v=this.width%2/2,y=this.height%2/2,b=Math.cos(this.angle),x=Math.sin(this.angle),w=i-Math.round(i)+b*v+x*y,k=r-Math.round(r)+b*y+x*v,T=new Float64Array(n);if(e.H(T,T,[w>.5?w-1:w,k>.5?k-1:k,0]),this.alignedModelViewProjectionMatrix=T,n=e.as(new Float64Array(16),this.pixelMatrix),!n)throw new Error("failed to invert matrix");this.pixelMatrixInverse=n,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new e.P(0,0)),i=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.af(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.P(0,t))}getCameraQueryGeometry(t){const i=this.getCameraPoint();if(1===t.length)return[t[0],i];{let r=i.x,n=i.y,a=i.x,s=i.y;for(const e of t)r=Math.min(r,e.x),n=Math.min(n,e.y),a=Math.max(a,e.x),s=Math.max(s,e.y);return[new e.P(r,n),new e.P(a,n),new e.P(a,s),new e.P(r,s),new e.P(r,n)]}}lngLatToCameraDepth(t,i){const r=this.locationCoordinate(t),n=[r.x*this.worldSize,r.y*this.worldSize,i,1];return e.af(n,n,this.modelViewProjectionMatrix),n[2]/n[3]}}function fr(t,e){let i,r=!1,n=null,a=null;const s=()=>{n=null,r&&(t.apply(a,i),n=setTimeout(s,e),r=!1)};return(...t)=>(r=!0,a=this,i=t,n||s(),n)}class gr{constructor(t){this._getCurrentHash=()=>{const t=window.location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map((t=>t.split("="))).forEach((t=>{t[0]===this._hashName&&(e=t)})),(e&&e[1]||"").split("/")}return t.split("/")},this._onHashChange=()=>{const t=this._getCurrentHash();if(t.length>=3&&!t.some((t=>isNaN(t)))){const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch(t){}},this._updateHash=fr(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const e=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,r=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),n=Math.pow(10,r),a=Math.round(e.lng*n)/n,s=Math.round(e.lat*n)/n,o=this._map.getBearing(),l=this._map.getPitch();let c="";if(c+=t?`/${a}/${s}/${i}`:`${i}/${s}/${a}`,(o||l)&&(c+="/"+Math.round(10*o)/10),l&&(c+=`/${Math.round(l)}`),this._hashName){const t=this._hashName;let e=!1;const i=window.location.hash.slice(1).split("&").map((i=>{const r=i.split("=")[0];return r===t?(e=!0,`${r}=${c}`):i})).filter((t=>t));return e||i.push(`${t}=${c}`),`#${i.join("&")}`}return`#${c}`}}const _r={linearity:.3,easing:e.b7(0,0,.3,1)},vr=e.e({deceleration:2500,maxSpeed:1400},_r),yr=e.e({deceleration:20,maxSpeed:1400},_r),br=e.e({deceleration:1e3,maxSpeed:360},_r),xr=e.e({deceleration:1e3,maxSpeed:90},_r);class wr{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,e=a.now();for(;t.length>0&&e-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new e.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)i.zoom+=t.zoomDelta||0,i.bearing+=t.bearingDelta||0,i.pitch+=t.pitchDelta||0,t.panDelta&&i.pan._add(t.panDelta),t.around&&(i.around=t.around),t.pinchAround&&(i.pinchAround=t.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,n={};if(i.pan.mag()){const a=Tr(i.pan.mag(),r,e.e({},vr,t||{}));n.offset=i.pan.mult(a.amount/i.pan.mag()),n.center=this._map.transform.center,kr(n,a)}if(i.zoom){const t=Tr(i.zoom,r,yr);n.zoom=this._map.transform.zoom+t.amount,kr(n,t)}if(i.bearing){const t=Tr(i.bearing,r,br);n.bearing=this._map.transform.bearing+e.ac(t.amount,-179,179),kr(n,t)}if(i.pitch){const t=Tr(i.pitch,r,xr);n.pitch=this._map.transform.pitch+t.amount,kr(n,t)}if(n.zoom||n.bearing){const t=void 0===i.pinchAround?i.around:i.pinchAround;n.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),e.e(n,{noMoveStart:!0})}}function kr(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Tr(t,i,r){const{maxSpeed:n,linearity:a,deceleration:s}=r,o=e.ac(t*a/(i/1e3),-n,n),l=Math.abs(o)/(s*a);return{easing:r.easing,duration:1e3*l,amount:o*(l/2)}}class Sr extends e.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,i,r,n={}){const a=s.mousePos(i.getCanvas(),r),o=i.unproject(a);super(t,e.e({point:a,lngLat:o,originalEvent:r},n)),this._defaultPrevented=!1,this.target=i}}class Cr extends e.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,i,r){const n="touchend"===t?r.changedTouches:r.touches,a=s.touchPos(i.getCanvasContainer(),n),o=a.map((t=>i.unproject(t))),l=a.reduce(((t,e,i,r)=>t.add(e.div(r.length))),new e.P(0,0));super(t,{points:a,point:l,lngLats:o,lngLat:i.unproject(l),originalEvent:r}),this._defaultPrevented=!1}}class Er extends e.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,i){super(t,{originalEvent:i}),this._defaultPrevented=!1}}class $r{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Er(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new Sr(t.type,this._map,t))}mouseup(t){this._map.fire(new Sr(t.type,this._map,t))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Sr(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Sr(t.type,this._map,t))}mouseover(t){this._map.fire(new Sr(t.type,this._map,t))}mouseout(t){this._map.fire(new Sr(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Cr(t.type,this._map,t))}touchmove(t){this._map.fire(new Cr(t.type,this._map,t))}touchend(t){this._map.fire(new Cr(t.type,this._map,t))}touchcancel(t){this._map.fire(new Cr(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ar{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Sr(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Sr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Sr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ir{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(e.P.convert(t),this._map.terrain)}}class Mr{constructor(t,e){this._map=t,this._tr=new Ir(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(s.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const i=e;if(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)return;const r=this._startPos;this._lastPos=i,this._box||(this._box=s.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const n=Math.min(r.x,i.x),a=Math.max(r.x,i.x),o=Math.min(r.y,i.y),l=Math.max(r.y,i.y);s.setTransform(this._box,`translate(${n}px,${o}px)`),this._box.style.width=a-n+"px",this._box.style.height=l-o+"px"}mouseupWindow(t,i){if(!this._active)return;if(0!==t.button)return;const r=this._startPos,n=i;if(this.reset(),s.suppressClick(),r.x!==n.x||r.y!==n.y)return this._map.fire(new e.k("boxzoomend",{originalEvent:t})),{cameraAnimation:t=>t.fitScreenCoordinates(r,n,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(s.remove(this._box),this._box=null),s.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,i){return this._map.fire(new e.k(t,{originalEvent:i}))}}function Lr(t,e){if(t.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${t.length}, points ${e.length}`);const i={};for(let r=0;r<t.length;r++)i[t[r].identifier]=e[r];return i}class Pr{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,i,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),r.length===this.numTouches&&(this.centroid=function(t){const i=new e.P(0,0);for(const e of t)i._add(e);return i.div(t.length)}(i),this.touches=Lr(r,i)))}touchmove(t,e,i){if(this.aborted||!this.centroid)return;const r=Lr(i,e);for(const t in this.touches){const e=r[t];(!e||e.dist(this.touches[t])>30)&&(this.aborted=!0)}}touchend(t,e,i){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class Rr{constructor(t){this.singleTap=new Pr(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,e,i){this.singleTap.touchstart(t,e,i)}touchmove(t,e,i){this.singleTap.touchmove(t,e,i)}touchend(t,e,i){const r=this.singleTap.touchend(t,e,i);if(r){const e=t.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(r)<30;if(e&&i||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}}}class zr{constructor(t){this._tr=new Ir(t),this._zoomIn=new Rr({numTouches:1,numTaps:2}),this._zoomOut=new Rr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,i){this._zoomIn.touchstart(t,e,i),this._zoomOut.touchstart(t,e,i)}touchmove(t,e,i){this._zoomIn.touchmove(t,e,i),this._zoomOut.touchmove(t,e,i)}touchend(t,e,i){const r=this._zoomIn.touchend(t,e,i),n=this._zoomOut.touchend(t,e,i),a=this._tr;return r?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:a.zoom+1,around:a.unproject(r)},{originalEvent:t})}):n?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:a.zoom-1,around:a.unproject(n)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dr{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const e=this._moveFunction(...t);if(e.bearingDelta||e.pitchDelta||e.around||e.panDelta)return this._active=!0,e}dragStart(t,e){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=e.length?e[0]:e,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,e){if(!this.isEnabled())return;const i=this._lastPoint;if(!i)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const r=e.length?e[0]:e;return!this._moved&&r.dist(i)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=r,this._move(i,r))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&s.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const jr={0:1,2:2};class Or{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const e=s.mouseButton(t);this._eventButton=e}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(t,e){const i=jr[e];return void 0===t.buttons||(t.buttons&i)!==i}(t,this._eventButton)}isValidEndEvent(t){return s.mouseButton(t)===this._eventButton}}class Br{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return 1===t.targetTouches.length}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const Fr=t=>{t.mousedown=t.dragStart,t.mousemoveWindow=t.dragMove,t.mouseup=t.dragEnd,t.contextmenu=t=>{t.preventDefault()}},Nr=({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:i=.8})=>{const r=new Or({checkCorrectEvent:t=>0===s.mouseButton(t)&&t.ctrlKey||2===s.mouseButton(t)});return new Dr({clickTolerance:e,move:(t,e)=>({bearingDelta:(e.x-t.x)*i}),moveStateManager:r,enable:t,assignEvents:Fr})},Hr=({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:i=-.5})=>{const r=new Or({checkCorrectEvent:t=>0===s.mouseButton(t)&&t.ctrlKey||2===s.mouseButton(t)});return new Dr({clickTolerance:e,move:(t,e)=>({pitchDelta:(e.y-t.y)*i}),moveStateManager:r,enable:t,assignEvents:Fr})};class Vr{constructor(t,e){this._clickTolerance=t.clickTolerance||1,this._map=e,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new e.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(t,e,i){return this._calculateTransform(t,e,i)}touchmove(t,e,i){if(this._active&&!(i.length<this.minTouchs()))return t.preventDefault(),this._calculateTransform(t,e,i)}touchend(t,e,i){this._calculateTransform(t,e,i),this._active&&i.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,i,r){r.length>0&&(this._active=!0);const n=Lr(r,i),a=new e.P(0,0),s=new e.P(0,0);let o=0;for(const t in n){const e=n[t],i=this._touches[t];i&&(a._add(e),s._add(e.sub(i)),o++,n[t]=e)}if(this._touches=n,o<this.minTouchs()||!s.mag())return;const l=s.div(o);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(o),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ur{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,e,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,i){if(!this._firstTwoTouches)return;t.preventDefault();const[r,n]=this._firstTwoTouches,a=Yr(i,e,r),s=Yr(i,e,n);if(!a||!s)return;const o=this._aroundCenter?null:a.add(s).div(2);return this._move([a,s],o,t)}touchend(t,e,i){if(!this._firstTwoTouches)return;const[r,n]=this._firstTwoTouches,a=Yr(i,e,r),o=Yr(i,e,n);a&&o||(this._active&&s.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Yr(t,e,i){for(let r=0;r<t.length;r++)if(t[r].identifier===i)return e[r]}function Zr(t,e){return Math.log(t/e)/Math.LN2}class qr extends Ur{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const i=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Zr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Zr(this._distance,i),pinchAround:e}}}function Wr(t,e){return 180*t.angleWith(e)/Math.PI}class Gr extends Ur{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e,i){const r=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Wr(this._vector,r),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,i=Wr(t,this._startVector);return Math.abs(i)<e}}function Xr(t){return Math.abs(t.y)>Math.abs(t.x)}class Kr extends Ur{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,e,i){super.touchstart(t,e,i),this._currentTouchCount=i.length}_start(t){this._lastPoints=t,Xr(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,i){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const r=t[0].sub(this._lastPoints[0]),n=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(r,n,i.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(r.y+n.y)/2*-.5}):void 0}gestureBeginsVertically(t,e,i){if(void 0!==this._valid)return this._valid;const r=t.mag()>=2,n=e.mag()>=2;if(!r&&!n)return;if(!r||!n)return void 0===this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;const a=t.y>0==e.y>0;return Xr(t)&&Xr(e)&&a}}const Jr={panStep:100,bearingStep:15,pitchStep:10};class Qr{constructor(t){this._tr=new Ir(t);const e=Jr;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,i=0,r=0,n=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?i=-1:(t.preventDefault(),n=-1);break;case 39:t.shiftKey?i=1:(t.preventDefault(),n=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?r=-1:(t.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(i=0,r=0),{cameraAnimation:s=>{const o=this._tr;s.easeTo({duration:300,easeId:"keyboardHandler",easing:tn,zoom:e?Math.round(o.zoom)+e*(t.shiftKey?2:1):o.zoom,bearing:o.bearing+i*this._bearingStep,pitch:o.pitch+r*this._pitchStep,offset:[-n*this._panStep,-a*this._panStep],center:o.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function tn(t){return t*(2-t)}const en=4.000244140625;class rn{constructor(t,e){this._onTimeout=t=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},this._map=t,this._tr=new Ir(t),this._triggerRenderFrame=e,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map.cooperativeGestures.isEnabled()&&!t[this._map.cooperativeGestures._bypassKey])return;let e=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const i=a.now(),r=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==e&&e%en==0?this._type="wheel":0!==e&&Math.abs(e)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(r*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=s.mousePos(this._map.getCanvas(),t),r=this._tr;this._around=i.y>r.transform.height/2-r.transform.getHorizon()?e.M.convert(this._aroundCenter?r.center:r.unproject(i)):e.M.convert(r.center),this._aroundPoint=r.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._tr.transform;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>en?this._wheelZoomRate:this._defaultZoomRate;let i=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==i&&(i=1/i);const r="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(r*i))),"wheel"===this._type&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i="number"==typeof this._targetZoom?this._targetZoom:t.zoom,r=this._startZoom,n=this._easing;let s,o=!1;if("wheel"===this._type&&r&&n){const t=Math.min((a.now()-this._lastWheelEventTime)/200,1),l=n(t);s=e.z.number(r,i,l),t<1?this._frameId||(this._frameId=!0):o=!0}else s=i,o=!0;return this._active=!0,o&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!o,zoomDelta:s-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let i=e.b8;if(this._prevEase){const t=this._prevEase,r=(a.now()-t.start)/t.duration,n=t.easing(r+.01)-t.easing(r),s=.27/Math.sqrt(n*n+1e-4)*.01,o=Math.sqrt(.0729-s*s);i=e.b7(s,o,.25,1)}return this._prevEase={start:a.now(),duration:t,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class nn{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class an{constructor(t){this._tr=new Ir(t),this.reset()}reset(){this._active=!1}dblclick(t,e){return t.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sn{constructor(){this._tap=new Rr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,e,i){if(!this._swipePoint)if(this._tapTime){const r=e[0],n=t.timeStamp-this._tapTime<500,a=this._tapPoint.dist(r)<30;n&&a?i.length>0&&(this._swipePoint=r,this._swipeTouch=i[0].identifier):this.reset()}else this._tap.touchstart(t,e,i)}touchmove(t,e,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const r=e[0],n=r.y-this._swipePoint.y;return this._swipePoint=r,t.preventDefault(),this._active=!0,{zoomDelta:n/128}}}else this._tap.touchmove(t,e,i)}touchend(t,e,i){if(this._tapTime)this._swipePoint&&0===i.length&&this.reset();else{const r=this._tap.touchend(t,e,i);r&&(this._tapTime=t.timeStamp,this._tapPoint=r)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class on{constructor(t,e,i){this._el=t,this._mousePan=e,this._touchPan=i}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ln{constructor(t,e,i){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class cn{constructor(t,e,i,r){this._el=t,this._touchZoom=e,this._touchRotate=i,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class dn{constructor(t,e){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=t,this._options=e,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=s.create("div","maplibregl-cooperative-gesture-screen",t);let e=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(e=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const i=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),r=document.createElement("div");r.className="maplibregl-desktop-message",r.textContent=e,this._container.appendChild(r);const n=document.createElement("div");n.className="maplibregl-mobile-message",n.textContent=i,this._container.appendChild(n),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(s.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(t){this._onCooperativeGesture(1===t.touches.length)}wheel(t){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!t[this._bypassKey])}_onCooperativeGesture(t){this._enabled&&t&&(this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const hn=t=>t.zoom||t.drag||t.pitch||t.rotate;class pn extends e.k{}function un(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class mn{constructor(t,e){this.handleWindowEvent=t=>{this.handleEvent(t,`${t.type}Window`)},this.handleEvent=(t,e)=>{if("blur"===t.type)return void this.stop(!0);this._updatingCamera=!0;const i="renderFrame"===t.type?void 0:t,r={needsRenderFrame:!1},n={},a={},o=t.touches,l=o?this._getMapTouches(o):void 0,c=l?s.touchPos(this._map.getCanvas(),l):s.mousePos(this._map.getCanvas(),t);for(const{handlerName:s,handler:o,allowed:d}of this._handlers){if(!o.isEnabled())continue;let h;this._blockedByActive(a,d,s)?o.reset():o[e||t.type]&&(h=o[e||t.type](t,c,l),this.mergeHandlerResult(r,n,h,s,i),h&&h.needsRenderFrame&&this._triggerRenderFrame()),(h||o.isActive())&&(a[s]=o)}const d={};for(const t in this._previousActiveHandlers)a[t]||(d[t]=i);this._previousActiveHandlers=a,(Object.keys(d).length||un(r))&&(this._changes.push([r,n,d]),this._triggerRenderFrame()),(Object.keys(a).length||un(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:h}=r;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new wr(t),this._bearingSnap=e.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(e);const i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];for(const[t,e,i]of this._listeners)s.addEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,i)}destroy(){for(const[t,e,i]of this._listeners)s.removeEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,i)}_addDefaultHandlers(t){const e=this._map,i=e.getCanvasContainer();this._add("mapEvent",new $r(e,t));const r=e.boxZoom=new Mr(e,t);this._add("boxZoom",r),t.interactive&&t.boxZoom&&r.enable();const n=e.cooperativeGestures=new dn(e,t.cooperativeGestures);this._add("cooperativeGestures",n),t.cooperativeGestures&&n.enable();const a=new zr(e),o=new an(e);e.doubleClickZoom=new nn(o,a),this._add("tapZoom",a),this._add("clickZoom",o),t.interactive&&t.doubleClickZoom&&e.doubleClickZoom.enable();const l=new sn;this._add("tapDragZoom",l);const c=e.touchPitch=new Kr(e);this._add("touchPitch",c),t.interactive&&t.touchPitch&&e.touchPitch.enable(t.touchPitch);const d=Nr(t),h=Hr(t);e.dragRotate=new ln(t,d,h),this._add("mouseRotate",d,["mousePitch"]),this._add("mousePitch",h,["mouseRotate"]),t.interactive&&t.dragRotate&&e.dragRotate.enable();const p=(({enable:t,clickTolerance:e})=>{const i=new Or({checkCorrectEvent:t=>0===s.mouseButton(t)&&!t.ctrlKey});return new Dr({clickTolerance:e,move:(t,e)=>({around:e,panDelta:e.sub(t)}),activateOnStart:!0,moveStateManager:i,enable:t,assignEvents:Fr})})(t),u=new Vr(t,e);e.dragPan=new on(i,p,u),this._add("mousePan",p),this._add("touchPan",u,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&e.dragPan.enable(t.dragPan);const m=new Gr,f=new qr;e.touchZoomRotate=new cn(i,f,m,l),this._add("touchRotate",m,["touchPan","touchZoom"]),this._add("touchZoom",f,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&e.touchZoomRotate.enable(t.touchZoomRotate);const g=e.scrollZoom=new rn(e,(()=>this._triggerRenderFrame()));this._add("scrollZoom",g,["mousePan"]),t.interactive&&t.scrollZoom&&e.scrollZoom.enable(t.scrollZoom);const _=e.keyboard=new Qr(e);this._add("keyboard",_),t.interactive&&t.keyboard&&e.keyboard.enable(),this._add("blockableMapEvent",new Ar(e))}_add(t,e,i){this._handlers.push({handlerName:t,handler:e,allowed:i}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(hn(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,e,i){for(const r in t)if(r!==i&&(!e||e.indexOf(r)<0))return!0;return!1}_getMapTouches(t){const e=[];for(const i of t)this._el.contains(i.target)&&e.push(i);return e}mergeHandlerResult(t,i,r,n,a){if(!r)return;e.e(t,r);const s={handlerName:n,originalEvent:r.originalEvent||a};void 0!==r.zoomDelta&&(i.zoom=s),void 0!==r.panDelta&&(i.drag=s),void 0!==r.pitchDelta&&(i.pitch=s),void 0!==r.bearingDelta&&(i.rotate=s)}_applyChanges(){const t={},i={},r={};for(const[n,a,s]of this._changes)n.panDelta&&(t.panDelta=(t.panDelta||new e.P(0,0))._add(n.panDelta)),n.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+n.zoomDelta),n.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+n.bearingDelta),n.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+n.pitchDelta),void 0!==n.around&&(t.around=n.around),void 0!==n.pinchAround&&(t.pinchAround=n.pinchAround),n.noInertia&&(t.noInertia=n.noInertia),e.e(i,a),e.e(r,s);this._updateMapTransform(t,i,r),this._changes=[]}_updateMapTransform(t,e,i){const r=this._map,n=r._getTransformForUpdate(),a=r.terrain;if(!(un(t)||a&&this._terrainMovement))return this._fireEvents(e,i,!0);let{panDelta:s,zoomDelta:o,bearingDelta:l,pitchDelta:c,around:d,pinchAround:h}=t;void 0!==h&&(d=h),r._stop(!0),d=d||r.transform.centerPoint;const p=n.pointLocation(s?d.sub(s):d);l&&(n.bearing+=l),c&&(n.pitch+=c),o&&(n.zoom+=o),a?this._terrainMovement||!e.drag&&!e.zoom?e.drag&&this._terrainMovement?n.center=n.pointLocation(n.centerPoint.sub(s)):n.setLocationAtPoint(p,d):(this._terrainMovement=!0,this._map._elevationFreeze=!0,n.setLocationAtPoint(p,d)):n.setLocationAtPoint(p,d),r._applyUpdatedTransform(n),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,i,!0)}_fireEvents(t,i,r){const n=hn(this._eventsInProgress),s=hn(t),o={};for(const e in t){const{originalEvent:i}=t[e];this._eventsInProgress[e]||(o[`${e}start`]=i),this._eventsInProgress[e]=t[e]}!n&&s&&this._fireEvent("movestart",s.originalEvent);for(const t in o)this._fireEvent(t,o[t]);s&&this._fireEvent("move",s.originalEvent);for(const e in t){const{originalEvent:i}=t[e];this._fireEvent(e,i)}const l={};let c;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:r}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],c=i[e]||r,l[`${t}end`]=c)}for(const t in l)this._fireEvent(t,l[t]);const d=hn(this._eventsInProgress),h=(n||s)&&!d;if(h&&this._terrainMovement&&(this._map._elevationFreeze=!1,this._terrainMovement=!1,this._map.transform.recalculateZoom(this._map.terrain)),r&&h){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),i=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;!t||!t.essential&&a.prefersReducedMotion?(this._map.fire(new e.k("moveend",{originalEvent:c})),i(this._map.getBearing())&&this._map.resetNorth()):(i(t.bearing||this._map.getBearing())&&(t.bearing=0),t.freezeElevation=!0,this._map.easeTo(t,{originalEvent:c})),this._updatingCamera=!1}}_fireEvent(t,i){this._map.fire(new e.k(t,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new pn("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class fn extends e.E{constructor(t,e){super(),this._renderFrameCallback=()=>{const t=Math.min((a.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=e.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new e.M(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(t,i,r){return t=e.P.convert(t).mult(-1),this.panTo(this.transform.center,e.e({offset:t},i),r)}panTo(t,i,r){return this.easeTo(e.e({center:t},i),r)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(t,i,r){return this.easeTo(e.e({zoom:t},i),r)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(t,i,r){return this.easeTo(e.e({bearing:t},i),r)}resetNorth(t,i){return this.rotateTo(0,e.e({duration:1e3},t),i),this}resetNorthPitch(t,i){return this.easeTo(e.e({bearing:0,pitch:0,duration:1e3},t),i),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(t,e){t=U.convert(t);const i=e&&e.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),i,e)}_cameraForBoxAndBearing(t,i,r,n){const a={top:0,bottom:0,right:0,left:0};if("number"==typeof(n=e.e({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding){const t=n.padding;n.padding={top:t,bottom:t,right:t,left:t}}n.padding=e.e(a,n.padding);const s=this.transform,o=s.padding,l=new U(t,i),c=s.project(l.getNorthWest()),d=s.project(l.getNorthEast()),h=s.project(l.getSouthEast()),p=s.project(l.getSouthWest()),u=e.b9(-r),m=c.rotate(u),f=d.rotate(u),g=h.rotate(u),_=p.rotate(u),v=new e.P(Math.max(m.x,f.x,_.x,g.x),Math.max(m.y,f.y,_.y,g.y)),y=new e.P(Math.min(m.x,f.x,_.x,g.x),Math.min(m.y,f.y,_.y,g.y)),b=v.sub(y),x=(s.width-(o.left+o.right+n.padding.left+n.padding.right))/b.x,w=(s.height-(o.top+o.bottom+n.padding.top+n.padding.bottom))/b.y;if(w<0||x<0)return void e.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const k=Math.min(s.scaleZoom(s.scale*Math.min(x,w)),n.maxZoom),T=e.P.convert(n.offset),S=new e.P((n.padding.left-n.padding.right)/2,(n.padding.top-n.padding.bottom)/2).rotate(e.b9(r)),C=T.add(S).mult(s.scale/s.zoomScale(k));return{center:s.unproject(c.add(h).div(2).sub(C)),zoom:k,bearing:r}}fitBounds(t,e,i){return this._fitInternal(this.cameraForBounds(t,e),e,i)}fitScreenCoordinates(t,i,r,n,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.P.convert(t)),this.transform.pointLocation(e.P.convert(i)),r,n),n,a)}_fitInternal(t,i,r){return t?(delete(i=e.e(t,i)).padding,i.linear?this.easeTo(i,r):this.flyTo(i,r)):this}jumpTo(t,i){this.stop();const r=this._getTransformForUpdate();let n=!1,a=!1,s=!1;return"zoom"in t&&r.zoom!==+t.zoom&&(n=!0,r.zoom=+t.zoom),void 0!==t.center&&(r.center=e.M.convert(t.center)),"bearing"in t&&r.bearing!==+t.bearing&&(a=!0,r.bearing=+t.bearing),"pitch"in t&&r.pitch!==+t.pitch&&(s=!0,r.pitch=+t.pitch),null==t.padding||r.isPaddingEqual(t.padding)||(r.padding=t.padding),this._applyUpdatedTransform(r),this.fire(new e.k("movestart",i)).fire(new e.k("move",i)),n&&this.fire(new e.k("zoomstart",i)).fire(new e.k("zoom",i)).fire(new e.k("zoomend",i)),a&&this.fire(new e.k("rotatestart",i)).fire(new e.k("rotate",i)).fire(new e.k("rotateend",i)),s&&this.fire(new e.k("pitchstart",i)).fire(new e.k("pitch",i)).fire(new e.k("pitchend",i)),this.fire(new e.k("moveend",i))}calculateCameraOptionsFromTo(t,i,r,n=0){const a=e.Y.fromLngLat(t,i),s=e.Y.fromLngLat(r,n),o=s.x-a.x,l=s.y-a.y,c=s.z-a.z,d=Math.hypot(o,l,c);if(0===d)throw new Error("Can't calculate camera options with same From and To");const h=Math.hypot(o,l),p=this.transform.scaleZoom(this.transform.cameraToCenterDistance/d/this.transform.tileSize),u=180*Math.atan2(o,-l)/Math.PI;let m=180*Math.acos(h/d)/Math.PI;return m=c<0?90-m:90+m,{center:s.toLngLat(),zoom:p,pitch:m,bearing:u}}easeTo(t,i){var r;this._stop(!1,t.easeId),(!1===(t=e.e({offset:[0,0],duration:500,easing:e.b8},t)).animate||!t.essential&&a.prefersReducedMotion)&&(t.duration=0);const n=this._getTransformForUpdate(),s=this.getZoom(),o=this.getBearing(),l=this.getPitch(),c=this.getPadding(),d="bearing"in t?this._normalizeBearing(t.bearing,o):o,h="pitch"in t?+t.pitch:l,p="padding"in t?t.padding:n.padding,u=e.P.convert(t.offset);let m=n.centerPoint.add(u);const f=n.pointLocation(m),{center:g,zoom:_}=n.getConstrained(e.M.convert(t.center||f),null!==(r=t.zoom)&&void 0!==r?r:s);this._normalizeCenter(g);const v=n.project(f),y=n.project(g).sub(v),b=n.zoomScale(_-s);let x,w;t.around&&(x=e.M.convert(t.around),w=n.locationPoint(x));const k={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||_!==s,this._rotating=this._rotating||o!==d,this._pitching=this._pitching||h!==l,this._padding=!n.isPaddingEqual(p),this._easeId=t.easeId,this._prepareEase(i,t.noMoveStart,k),this.terrain&&this._prepareElevation(g),this._ease((r=>{if(this._zooming&&(n.zoom=e.z.number(s,_,r)),this._rotating&&(n.bearing=e.z.number(o,d,r)),this._pitching&&(n.pitch=e.z.number(l,h,r)),this._padding&&(n.interpolatePadding(c,p,r),m=n.centerPoint.add(u)),this.terrain&&!t.freezeElevation&&this._updateElevation(r),x)n.setLocationAtPoint(x,w);else{const t=n.zoomScale(n.zoom-s),e=_>s?Math.min(2,b):Math.max(.5,b),i=Math.pow(e,1-r),a=n.unproject(v.add(y.mult(r*i)).mult(t));n.setLocationAtPoint(n.renderWorldCopies?a.wrap():a,m)}this._applyUpdatedTransform(n),this._fireMoveEvents(i)}),(e=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(i,e)}),t),this}_prepareEase(t,i,r={}){this._moving=!0,i||r.moving||this.fire(new e.k("movestart",t)),this._zooming&&!r.zooming&&this.fire(new e.k("zoomstart",t)),this._rotating&&!r.rotating&&this.fire(new e.k("rotatestart",t)),this._pitching&&!r.pitching&&this.fire(new e.k("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&i!==this._elevationTarget){const e=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(e-(i-(e*t+this._elevationStart))/(1-t)),this._elevationTarget=i}this.transform.elevation=e.z.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const e=t.clone(),{center:i,zoom:r,pitch:n,bearing:a,elevation:s}=this.transformCameraUpdate(e);i&&(e.center=i),void 0!==r&&(e.zoom=r),void 0!==n&&(e.pitch=n),void 0!==a&&(e.bearing=a),void 0!==s&&(e.elevation=s),this.transform.apply(e)}_fireMoveEvents(t){this.fire(new e.k("move",t)),this._zooming&&this.fire(new e.k("zoom",t)),this._rotating&&this.fire(new e.k("rotate",t)),this._pitching&&this.fire(new e.k("pitch",t))}_afterEase(t,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const r=this._zooming,n=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new e.k("zoomend",t)),n&&this.fire(new e.k("rotateend",t)),a&&this.fire(new e.k("pitchend",t)),this.fire(new e.k("moveend",t))}flyTo(t,i){var r;if(!t.essential&&a.prefersReducedMotion){const r=e.L(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(r,i)}this.stop(),t=e.e({offset:[0,0],speed:1.2,curve:1.42,easing:e.b8},t);const n=this._getTransformForUpdate(),s=this.getZoom(),o=this.getBearing(),l=this.getPitch(),c=this.getPadding(),d="bearing"in t?this._normalizeBearing(t.bearing,o):o,h="pitch"in t?+t.pitch:l,p="padding"in t?t.padding:n.padding,u=e.P.convert(t.offset);let m=n.centerPoint.add(u);const f=n.pointLocation(m),{center:g,zoom:_}=n.getConstrained(e.M.convert(t.center||f),null!==(r=t.zoom)&&void 0!==r?r:s);this._normalizeCenter(g);const v=n.zoomScale(_-s),y=n.project(f),b=n.project(g).sub(y);let x=t.curve;const w=Math.max(n.width,n.height),k=w/v,T=b.mag();if("minZoom"in t){const i=e.ac(Math.min(t.minZoom,s,_),n.minZoom,n.maxZoom),r=w/n.zoomScale(i-s);x=Math.sqrt(r/T*2)}const S=x*x;function C(t){const e=(k*k-w*w+(t?-1:1)*S*S*T*T)/(2*(t?k:w)*S*T);return Math.log(Math.sqrt(e*e+1)-e)}function E(t){return(Math.exp(t)-Math.exp(-t))/2}function $(t){return(Math.exp(t)+Math.exp(-t))/2}const A=C(!1);let I=function(t){return $(A)/$(A+x*t)},M=function(t){return w*(($(A)*(E(e=A+x*t)/$(e))-E(A))/S)/T;var e},L=(C(!0)-A)/x;if(Math.abs(T)<1e-6||!isFinite(L)){if(Math.abs(w-k)<1e-6)return this.easeTo(t,i);const e=k<w?-1:1;L=Math.abs(Math.log(k/w))/x,M=()=>0,I=t=>Math.exp(e*x*t)}return t.duration="duration"in t?+t.duration:1e3*L/("screenSpeed"in t?+t.screenSpeed/x:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=o!==d,this._pitching=h!==l,this._padding=!n.isPaddingEqual(p),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(g),this._ease((r=>{const a=r*L,f=1/I(a);n.zoom=1===r?_:s+n.scaleZoom(f),this._rotating&&(n.bearing=e.z.number(o,d,r)),this._pitching&&(n.pitch=e.z.number(l,h,r)),this._padding&&(n.interpolatePadding(c,p,r),m=n.centerPoint.add(u)),this.terrain&&!t.freezeElevation&&this._updateElevation(r);const v=1===r?g:n.unproject(y.add(b.mult(M(a))).mult(f));n.setLocationAtPoint(n.renderWorldCopies?v.wrap():v,m),this._applyUpdatedTransform(n),this._fireMoveEvents(i)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(i)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){var i;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e)}return t||null===(i=this.handlers)||void 0===i||i.stop(!1),this}_ease(t,e,i){!1===i.animate||0===i.duration?(t(1),e()):(this._easeStart=a.now(),this._easeOptions=i,this._onEaseFrame=t,this._onEaseEnd=e,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,i){t=e.b2(t,-180,180);const r=Math.abs(t-i);return Math.abs(t-360-i)<r&&(t-=360),Math.abs(t+360-i)<r&&(t+=360),t}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.lngRange)return;const i=t.lng-e.center.lng;t.lng+=i>180?-360:i<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(e.M.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}const gn={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class _n{constructor(t=gn){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=t=>{!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType&&"terrain"!==t.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=s.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=s.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=s.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){s.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const i=this._map._getUIString(`AttributionControl.${e}`);t.title=i,t.setAttribute("aria-label",i)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((t=>"string"!=typeof t?"":t))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style.sourceCaches;for(const i in e){const r=e[i];if(r.used||r.usedForTerrain){const e=r.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t=t.filter((t=>String(t).trim())),t.sort(((t,e)=>t.length-e.length)),t=t.filter(((e,i)=>{for(let r=i+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0}));const i=t.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,t.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class vn{constructor(t={}){this._updateCompact=()=>{const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&e.classList.add("maplibregl-compact"):e.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=s.create("div","maplibregl-ctrl");const e=s.create("a","maplibregl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://maplibre.org/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){s.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class yn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,i=e?this._queue.concat(e):this._queue;for(const e of i)if(e.id===t)return void(e.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const e=this._currentlyRunning=this._queue;this._queue=[];for(const i of e)if(!i.cancelled&&(i.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var bn=e.X([{name:"a_pos3d",type:"Int16",components:3}]);class xn extends e.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,i){this.sourceCache.update(t,i),this._renderableTilesKeys=[];const r={};for(const n of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i}))r[n.key]=!0,this._renderableTilesKeys.push(n.key),this._tiles[n.key]||(n.posMatrix=new Float64Array(16),e.aO(n.posMatrix,0,e.W,0,e.W,0,1),this._tiles[n.key]=new st(n,this.tileSize));for(const t in this._tiles)r[t]||delete this._tiles[t]}freeRtt(t){for(const e in this._tiles){const i=this._tiles[e];(!t||i.tileID.equals(t)||i.tileID.isChildOf(t)||t.isChildOf(i.tileID))&&(i.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const i={};for(const r of this._renderableTilesKeys){const n=this._tiles[r].tileID;if(n.canonical.equals(t.canonical)){const n=t.clone();n.posMatrix=new Float64Array(16),e.aO(n.posMatrix,0,e.W,0,e.W,0,1),i[r]=n}else if(n.canonical.isChildOf(t.canonical)){const a=t.clone();a.posMatrix=new Float64Array(16);const s=n.canonical.z-t.canonical.z,o=n.canonical.x-(n.canonical.x>>s<<s),l=n.canonical.y-(n.canonical.y>>s<<s),c=e.W>>s;e.aO(a.posMatrix,0,c,0,c,0,1),e.H(a.posMatrix,a.posMatrix,[-o*c,-l*c,0]),i[r]=a}else if(t.canonical.isChildOf(n.canonical)){const a=t.clone();a.posMatrix=new Float64Array(16);const s=t.canonical.z-n.canonical.z,o=t.canonical.x-(t.canonical.x>>s<<s),l=t.canonical.y-(t.canonical.y>>s<<s),c=e.W>>s;e.aO(a.posMatrix,0,e.W,0,e.W,0,1),e.H(a.posMatrix,a.posMatrix,[o*c,l*c,0]),e.J(a.posMatrix,a.posMatrix,[1/2**s,1/2**s,0]),i[r]=a}}return i}getSourceTile(t,e){const i=this.sourceCache._source;let r=t.overscaledZ-this.deltaZoom;if(r>i.maxzoom&&(r=i.maxzoom),r<i.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(r).key);let n=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!n||!n.dem)&&e)for(;r>=i.minzoom&&(!n||!n.dem);)n=this.sourceCache.getTileByID(t.scaledTo(r--).key);return n}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter((e=>e.timeAdded>=t))}}class wn{constructor(t,e,i){this.painter=t,this.sourceCache=new xn(e),this.options=i,this.exaggeration="number"==typeof i.exaggeration?i.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,i,r,n=e.W){var a;if(!(i>=0&&i<n&&r>=0&&r<n))return 0;const s=this.getTerrainData(t),o=null===(a=s.tile)||void 0===a?void 0:a.dem;if(!o)return 0;const l=function(t,e,i){var r=e[0],n=e[1];return t[0]=i[0]*r+i[4]*n+i[12],t[1]=i[1]*r+i[5]*n+i[13],t}([],[i/n*e.W,r/n*e.W],s.u_terrain_matrix),c=[l[0]*o.dim,l[1]*o.dim],d=Math.floor(c[0]),h=Math.floor(c[1]),p=c[0]-d,u=c[1]-h;return o.get(d,h)*(1-p)*(1-u)+o.get(d+1,h)*p*(1-u)+o.get(d,h+1)*(1-p)*u+o.get(d+1,h+1)*p*u}getElevationForLngLatZoom(t,i){const{tileID:r,mercatorX:n,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(t,i);return this.getElevation(r,n%e.W,a%e.W,e.W)}getElevation(t,i,r,n=e.W){return this.getDEMElevation(t,i,r,n)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const t=this.painter.context,i=new e.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new x(t,i,t.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new x(t,new e.R({width:1,height:1}),t.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=e.an([])}const i=this.sourceCache.getSourceTile(t,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const t=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new x(t,i.dem.getPixels(),t.gl.RGBA,{premultiply:!1}),i.demTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const r=i&&i+i.tileID.key+t.key;if(r&&!this._demMatrixCache[r]){const r=this.sourceCache.sourceCache._source.maxzoom;let n=t.canonical.z-i.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=r?n=t.canonical.z-r:e.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const a=t.canonical.x-(t.canonical.x>>n<<n),s=t.canonical.y-(t.canonical.y>>n<<n),o=e.ba(new Float64Array(16),[1/(e.W<<n),1/(e.W<<n),0]);e.H(o,o,[a*e.W,s*e.W,0]),this._demMatrixCache[t.key]={matrix:o,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:r?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(t){const e=this.painter,i=e.width/devicePixelRatio,r=e.height/devicePixelRatio;return!this._fbo||this._fbo.width===i&&this._fbo.height===r||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new x(e.context,{width:i,height:r,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new x(e.context,{width:i,height:r,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=e.context.createFramebuffer(i,r,!0,!1),this._fbo.depthAttachment.set(e.context.createRenderbuffer(e.context.gl.DEPTH_COMPONENT16,i,r))),this._fbo.colorAttachment.set("coords"===t?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let t=0,e=0;t<this._coordsTextureSize;t++)for(let r=0;r<this._coordsTextureSize;r++,e+=4)i[e+0]=255&r,i[e+1]=255&t,i[e+2]=r>>8<<4|t>>8,i[e+3]=0;const r=new e.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),n=new x(t,r,t.gl.RGBA,{premultiply:!1});return n.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=n,n}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const i=new Uint8Array(4),r=this.painter.context,n=r.gl,a=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),s=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),o=Math.round(this.painter.height/devicePixelRatio);r.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),n.readPixels(a,o-s-1,1,1,n.RGBA,n.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null);const l=i[0]+(i[2]>>4<<8),c=i[1]+((15&i[2])<<8),d=this.coordsIndex[255-i[3]],h=d&&this.sourceCache.getTileByID(d);if(!h)return null;const p=this._coordsTextureSize,u=(1<<h.tileID.canonical.z)*p;return new e.Y((h.tileID.canonical.x*p+l)/u+h.tileID.wrap,(h.tileID.canonical.y*p+c)/u,this.getElevation(h.tileID,l,c,p))}depthAtPoint(t){const e=new Uint8Array(4),i=this.painter.context,r=i.gl;return i.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),r.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,r.RGBA,r.UNSIGNED_BYTE,e),i.bindFramebuffer.set(null),(e[0]/16777216+e[1]/65536+e[2]/256+e[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,i=new e.bb,r=new e.aY,n=this.meshSize,a=e.W/n,s=n*n;for(let t=0;t<=n;t++)for(let e=0;e<=n;e++)i.emplaceBack(e*a,t*a,0);for(let t=0;t<s;t+=n+1)for(let e=0;e<n;e++)r.emplaceBack(e+t,n+e+t+1,n+e+t+2),r.emplaceBack(e+t,n+e+t+2,e+t+1);const o=i.length,l=o+2*(n+1);for(const t of[0,1])for(let r=0;r<=n;r++)for(const n of[0,1])i.emplaceBack(r*a,t*e.W,n);for(let t=0;t<2*n;t+=2)r.emplaceBack(l+t,l+t+1,l+t+3),r.emplaceBack(l+t,l+t+3,l+t+2),r.emplaceBack(o+t,o+t+3,o+t+1),r.emplaceBack(o+t,o+t+2,o+t+3);const c=i.length,d=c+2*(n+1);for(const t of[0,1])for(let r=0;r<=n;r++)for(const n of[0,1])i.emplaceBack(t*e.W,r*a,n);for(let t=0;t<2*n;t+=2)r.emplaceBack(c+t,c+t+1,c+t+3),r.emplaceBack(c+t,c+t+3,c+t+2),r.emplaceBack(d+t,d+t+3,d+t+1),r.emplaceBack(d+t,d+t+2,d+t+3);return this._mesh={indexBuffer:t.createIndexBuffer(r),vertexBuffer:t.createVertexBuffer(i,bn.members),segments:e.$.simpleSegment(0,0,i.length,r.length)},this._mesh}getMeshFrameDelta(t){return 2*Math.PI*e.bc/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,e){var i;const{tileID:r}=this._getOverscaledTileIDFromLngLatZoom(t,e);return null!==(i=this.getMinMaxElevation(r).minElevation)&&void 0!==i?i:0}getMinMaxElevation(t){const e=this.getTerrainData(t).tile,i={minElevation:null,maxElevation:null};return e&&e.dem&&(i.minElevation=e.dem.min*this.exaggeration,i.maxElevation=e.dem.max*this.exaggeration),i}_getOverscaledTileIDFromLngLatZoom(t,i){const r=e.Y.fromLngLat(t.wrap()),n=(1<<i)*e.W,a=r.x*n,s=r.y*n,o=Math.floor(a/e.W),l=Math.floor(s/e.W);return{tileID:new e.Q(i,0,i,o,l),mercatorX:a,mercatorY:s}}}class kn{constructor(t,e,i){this._context=t,this._size=e,this._tileSize=i,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const e=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),i=new x(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return i.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),e.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),e.colorAttachment.set(i.texture),{id:t,fbo:e,texture:i,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((e=>t.id!==e)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some((t=>!t.inUse))}}const Tn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Sn{constructor(t,e){this.painter=t,this.terrain=e,this.pool=new kn(t.context,30,e.sourceCache.tileSize*e.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,e){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter((i=>!t._layers[i].isHidden(e))),this._coordsDescendingInv={};for(const e in t.sourceCaches){this._coordsDescendingInv[e]={};const i=t.sourceCaches[e].getVisibleCoordinates();for(const t of i){const i=this.terrain.sourceCache.getTerrainCoords(t);for(const t in i)this._coordsDescendingInv[e][t]||(this._coordsDescendingInv[e][t]=[]),this._coordsDescendingInv[e][t].push(i[t])}}this._coordsDescendingInvStr={};for(const e of t._order){const i=t._layers[e],r=i.source;if(Tn[i.type]&&!this._coordsDescendingInvStr[r]){this._coordsDescendingInvStr[r]={};for(const t in this._coordsDescendingInv[r])this._coordsDescendingInvStr[r][t]=this._coordsDescendingInv[r][t].map((t=>t.key)).sort().join()}}for(const t of this._renderableTiles)for(const e in this._coordsDescendingInvStr){const i=this._coordsDescendingInvStr[e][t.tileID.key];i&&i!==t.rttCoords[e]&&(t.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const i=t.type,r=this.painter,n=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Tn[i]&&(this._prevType&&Tn[this._prevType]||this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(t.id),!n))return!0;if(Tn[this._prevType]||Tn[i]&&n){this._prevType=i;const t=this._stacks.length-1,n=this._stacks[t]||[];for(const i of this._renderableTiles){if(this.pool.isFull()&&(lr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(i),i.rtt[t]){const e=this.pool.getObjectForId(i.rtt[t].id);if(e.stamp===i.rtt[t].stamp){this.pool.useObject(e);continue}}const a=this.pool.getOrCreateFreeObject();this.pool.useObject(a),this.pool.stampObject(a),i.rtt[t]={id:a.id,stamp:a.stamp},r.context.bindFramebuffer.set(a.fbo.framebuffer),r.context.clear({color:e.aP.transparent,stencil:0}),r.currentStencilSource=void 0;for(let t=0;t<n.length;t++){const e=r.style._layers[n[t]],s=e.source?this._coordsDescendingInv[e.source][i.tileID.key]:[i.tileID];r.context.viewport.set([0,0,a.fbo.width,a.fbo.height]),r._renderTileClippingMasks(e,s),r.renderLayer(r,r.style.sourceCaches[e.source],e,s),e.source&&(i.rttCoords[e.source]=this._coordsDescendingInvStr[e.source][i.tileID.key])}}return lr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Tn[i]}return!1}}const Cn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},En=i,$n={hash:!1,interactive:!0,bearingSnap:7,attributionControl:gn,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:e.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},An=t=>{t.touchstart=t.dragStart,t.touchmoveWindow=t.dragMove,t.touchend=t.dragEnd},In={showCompass:!0,showZoom:!0,visualizePitch:!1};class Mn{constructor(t,i,r=!1){this.mousedown=t=>{this.startMouse(e.e({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),s.mousePos(this.element,t)),s.addEventListener(window,"mousemove",this.mousemove),s.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=t=>{this.moveMouse(t,s.mousePos(this.element,t))},this.mouseup=t=>{this.mouseRotate.dragEnd(t),this.mousePitch&&this.mousePitch.dragEnd(t),this.offTemp()},this.touchstart=t=>{1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=s.touchPos(this.element,t.targetTouches)[0],this.startTouch(t,this._startPos),s.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),s.addEventListener(window,"touchend",this.touchend))},this.touchmove=t=>{1!==t.targetTouches.length?this.reset():(this._lastPos=s.touchPos(this.element,t.targetTouches)[0],this.moveTouch(t,this._lastPos))},this.touchend=t=>{0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const n=t.dragRotate._mouseRotate.getClickTolerance(),a=t.dragRotate._mousePitch.getClickTolerance();this.element=i,this.mouseRotate=Nr({clickTolerance:n,enable:!0}),this.touchRotate=(({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:i=.8})=>{const r=new Br;return new Dr({clickTolerance:e,move:(t,e)=>({bearingDelta:(e.x-t.x)*i}),moveStateManager:r,enable:t,assignEvents:An})})({clickTolerance:n,enable:!0}),this.map=t,r&&(this.mousePitch=Hr({clickTolerance:a,enable:!0}),this.touchPitch=(({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:i=-.5})=>{const r=new Br;return new Dr({clickTolerance:e,move:(t,e)=>({pitchDelta:(e.y-t.y)*i}),moveStateManager:r,enable:t,assignEvents:An})})({clickTolerance:a,enable:!0})),s.addEventListener(i,"mousedown",this.mousedown),s.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),s.addEventListener(i,"touchcancel",this.reset)}startMouse(t,e){this.mouseRotate.dragStart(t,e),this.mousePitch&&this.mousePitch.dragStart(t,e),s.disableDrag()}startTouch(t,e){this.touchRotate.dragStart(t,e),this.touchPitch&&this.touchPitch.dragStart(t,e),s.disableDrag()}moveMouse(t,e){const i=this.map,{bearingDelta:r}=this.mouseRotate.dragMove(t,e)||{};if(r&&i.setBearing(i.getBearing()+r),this.mousePitch){const{pitchDelta:r}=this.mousePitch.dragMove(t,e)||{};r&&i.setPitch(i.getPitch()+r)}}moveTouch(t,e){const i=this.map,{bearingDelta:r}=this.touchRotate.dragMove(t,e)||{};if(r&&i.setBearing(i.getBearing()+r),this.touchPitch){const{pitchDelta:r}=this.touchPitch.dragMove(t,e)||{};r&&i.setPitch(i.getPitch()+r)}}off(){const t=this.element;s.removeEventListener(t,"mousedown",this.mousedown),s.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),s.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),s.removeEventListener(window,"touchend",this.touchend),s.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){s.enableDrag(),s.removeEventListener(window,"mousemove",this.mousemove),s.removeEventListener(window,"mouseup",this.mouseup),s.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),s.removeEventListener(window,"touchend",this.touchend)}}let Ln;function Pn(t,i,r){const n=new e.M(t.lng,t.lat);if(t=new e.M(t.lng,t.lat),i){const n=new e.M(t.lng-360,t.lat),a=new e.M(t.lng+360,t.lat),s=r.locationPoint(t).distSqr(i);r.locationPoint(n).distSqr(i)<s?t=n:r.locationPoint(a).distSqr(i)<s&&(t=a)}for(;Math.abs(t.lng-r.center.lng)>180;){const e=r.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=r.width&&e.y<=r.height)break;t.lng>r.center.lng?t.lng-=360:t.lng+=360}return t.lng!==n.lng&&r.locationPoint(t).y>r.height/2-r.getHorizon()?t:n}const Rn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function zn(t,e,i){const r=t.classList;for(const t in Rn)r.remove(`maplibregl-${i}-anchor-${t}`);r.add(`maplibregl-${i}-anchor-${e}`)}class Dn extends e.E{constructor(t){if(super(),this._onKeyPress=t=>{const e=t.code,i=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==i&&13!==i||this.togglePopup()},this._onMapClick=t=>{const e=t.originalEvent.target,i=this._element;this._popup&&(e===i||i.contains(e))&&this.togglePopup()},this._update=t=>{var e;if(!this._map)return;const i=this._map.loaded()&&!this._map.isMoving();("terrain"===(null==t?void 0:t.type)||"render"===(null==t?void 0:t.type)&&!i)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Pn(this._lngLat,this._flatPos,this._map.transform):null===(e=this._lngLat)||void 0===e?void 0:e.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let r="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?r=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(r=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),t&&"moveend"!==t.type||(this._pos=this._pos.round()),s.setTransform(this._element,`${Rn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} ${r}`),a.frameAsync(new AbortController).then((()=>{this._updateOpacity(t&&"moveend"===t.type)})).catch((()=>{}))},this._onMove=t=>{if(!this._isDragging){const e=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=e}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.k("dragstart"))),this.fire(new e.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.k("dragend")),this._state="inactive"},this._addDragHandler=t=>{this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&"auto"!==t.pitchAlignment?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(null==t?void 0:t.opacity,null==t?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=e.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=s.create("div");const i=s.createNS("http://www.w3.org/2000/svg","svg"),r=41,n=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${r}px`),i.setAttributeNS(null,"width",`${n}px`),i.setAttributeNS(null,"viewBox",`0 0 ${n} ${r}`);const a=s.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");const o=s.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");const l=s.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of c){const e=s.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),l.appendChild(e)}const d=s.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill",this._color);const h=s.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),d.appendChild(h);const p=s.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"opacity","0.25"),p.setAttributeNS(null,"fill","#000000");const u=s.createNS("http://www.w3.org/2000/svg","path");u.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),p.appendChild(u);const m=s.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(6.0, 7.0)"),m.setAttributeNS(null,"fill","#FFFFFF");const f=s.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=s.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const _=s.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#FFFFFF"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962"),f.appendChild(g),f.appendChild(_),o.appendChild(l),o.appendChild(d),o.appendChild(p),o.appendChild(m),o.appendChild(f),i.appendChild(o),i.setAttributeNS(null,"height",r*this._scale+"px"),i.setAttributeNS(null,"width",n*this._scale+"px"),this._element.appendChild(i),this._offset=e.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(t=>{t.preventDefault()})),this._element.addEventListener("mousedown",(t=>{t.preventDefault()})),zn(this._element,this._anchor,"marker"),t&&t.className)for(const e of t.className.split(" "))this._element.classList.add(e);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),s.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.M.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,i=13.5,r=Math.abs(i)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[r,-1*(e-i+r)],"bottom-right":[-r,-1*(e-i+r)],left:[i,-1*(e-i)],right:[-i,-1*(e-i)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var i,r;if(!(null===(i=this._map)||void 0===i?void 0:i.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const n=this._map,a=n.terrain.depthAtPoint(this._pos),s=n.terrain.getElevationForLngLatZoom(this._lngLat,n.transform.tileZoom);if(n.transform.lngLatToCameraDepth(this._lngLat,s)-a<.006)return void(this._element.style.opacity=this._opacity);const o=-this._offset.y/n.transform._pixelPerMeter,l=Math.sin(n.getPitch()*Math.PI/180)*o,c=n.terrain.depthAtPoint(new e.P(this._pos.x,this._pos.y-this._offset.y)),d=n.transform.lngLatToCameraDepth(this._lngLat,s+l)-c>.006;(null===(r=this._popup)||void 0===r?void 0:r.isOpen())&&d&&this._popup.remove(),this._element.style.opacity=d?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=e.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,e){return void 0===t&&void 0===e&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==t&&(this._opacity=t),void 0!==e&&(this._opacityWhenCovered=e),this._map&&this._updateOpacity(!0),this}}const jn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let On=0,Bn=!1;const Fn={maxWidth:100,unit:"metric"};function Nn(t,e,i){const r=i&&i.maxWidth||100,n=t._container.clientHeight/2,a=t.unproject([0,n]),s=t.unproject([r,n]),o=a.distanceTo(s);if(i&&"imperial"===i.unit){const i=3.2808*o;i>5280?Hn(e,r,i/5280,t._getUIString("ScaleControl.Miles")):Hn(e,r,i,t._getUIString("ScaleControl.Feet"))}else i&&"nautical"===i.unit?Hn(e,r,o/1852,t._getUIString("ScaleControl.NauticalMiles")):o>=1e3?Hn(e,r,o/1e3,t._getUIString("ScaleControl.Kilometers")):Hn(e,r,o,t._getUIString("ScaleControl.Meters"))}function Hn(t,e,i,r){const n=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(i),e*i}(i);t.style.width=e*(n/i)+"px",t.innerHTML=`${n}&nbsp;${r}`}const Vn={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Un=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Yn(t){if(t){if("number"==typeof t){const i=Math.round(Math.abs(t)/Math.SQRT2);return{center:new e.P(0,0),top:new e.P(0,t),"top-left":new e.P(i,i),"top-right":new e.P(-i,i),bottom:new e.P(0,-t),"bottom-left":new e.P(i,-i),"bottom-right":new e.P(-i,-i),left:new e.P(t,0),right:new e.P(-t,0)}}if(t instanceof e.P||Array.isArray(t)){const i=e.P.convert(t);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:e.P.convert(t.center||[0,0]),top:e.P.convert(t.top||[0,0]),"top-left":e.P.convert(t["top-left"]||[0,0]),"top-right":e.P.convert(t["top-right"]||[0,0]),bottom:e.P.convert(t.bottom||[0,0]),"bottom-left":e.P.convert(t["bottom-left"]||[0,0]),"bottom-right":e.P.convert(t["bottom-right"]||[0,0]),left:e.P.convert(t.left||[0,0]),right:e.P.convert(t.right||[0,0])}}return Yn(new e.P(0,0))}const Zn=i;t.AJAXError=e.bf,t.Evented=e.E,t.LngLat=e.M,t.MercatorCoordinate=e.Y,t.Point=e.P,t.addProtocol=e.bg,t.config=e.a,t.removeProtocol=e.bh,t.AttributionControl=_n,t.BoxZoomHandler=Mr,t.CanvasSource=Q,t.CooperativeGesturesHandler=dn,t.DoubleClickZoomHandler=nn,t.DragPanHandler=on,t.DragRotateHandler=ln,t.EdgeInsets=pr,t.FullscreenControl=class extends e.E{constructor(t={}){super(),this._onFullscreenChange=()=>{var t;let e=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null===(t=null==e?void 0:e.shadowRoot)||void 0===t?void 0:t.fullscreenElement;)e=e.shadowRoot.fullscreenElement;e===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,t&&t.container&&(t.container instanceof HTMLElement?this._container=t.container:e.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){s.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const t=this._fullscreenButton=s.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);s.create("span","maplibregl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new e.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new e.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},t.GeoJSONSource=G,t.GeolocateControl=class extends e.E{constructor(t){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new e.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const i=new e.M(t.coords.longitude,t.coords.latitude),r=t.coords.accuracy,n=this._map.getBearing(),a=e.e({bearing:n},this.options.fitBoundsOptions),s=U.fromLngLat(i,r);this._map.fitBounds(s,a,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const i=new e.M(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&Bn)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new e.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=t=>{if(this._map){if(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=s.create("button","maplibregl-ctrl-geolocate",this._container),s.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.w("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=s.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Dn({element:this._dotElement}),this._circleElement=s.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Dn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new e.k("trackuserlocationend")),this.fire(new e.k("userlocationlostfocus")))}))}},this.options=e.e({},jn,t)}onAdd(t){return this._map=t,this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return e._(this,arguments,void 0,(function*(t=!1){if(void 0!==Ln&&!t)return Ln;if(void 0===window.navigator.permissions)return Ln=!!window.navigator.geolocation,Ln;try{const t=yield window.navigator.permissions.query({name:"geolocation"});Ln="denied"!==t.state}catch(t){Ln=!!window.navigator.geolocation}return Ln}))}().then((t=>this._setupUI(t))),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),s.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,On=0,Bn=!1}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),i=t.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const t=this._map.getBounds(),e=t.getSouthEast(),i=t.getNorthEast(),r=e.distanceTo(i),n=Math.ceil(this._accuracy/(r/this._map._container.clientHeight)*2);this._circleElement.style.width=`${n}px`,this._circleElement.style.height=`${n}px`}trigger(){if(!this._setup)return e.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":On--,Bn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new e.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.k("trackuserlocationstart")),this.fire(new e.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let t;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),On++,On>1?(t={maximumAge:6e5,timeout:0},Bn=!0):(t=this.options.positionOptions,Bn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},t.Hash=gr,t.ImageSource=K,t.KeyboardHandler=Qr,t.LngLatBounds=U,t.LogoControl=vn,t.Map=class extends fn{constructor(t){e.bd.mark(e.be.create);const i=Object.assign(Object.assign({},$n),t);if(null!=i.minZoom&&null!=i.maxZoom&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=i.minPitch&&null!=i.maxPitch&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=i.minPitch&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=i.maxPitch&&i.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new mr(i.minZoom,i.maxZoom,i.minPitch,i.maxPitch,i.renderWorldCopies),{bearingSnap:i.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new yn,this._controls=[],this._mapId=e.a3(),this._contextLost=t=>{t.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new e.k("webglcontextlost",{originalEvent:t}))},this._contextRestored=t=>{this._setupPainter(),this.resize(),this._update(),this.fire(new e.k("webglcontextrestored",{originalEvent:t}))},this._onMapScroll=t=>{if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=i.interactive,this._maxTileCacheSize=i.maxTileCacheSize,this._maxTileCacheZoomLevels=i.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=!0===i.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=!0===i.preserveDrawingBuffer,this._antialias=!0===i.antialias,this._trackResize=!0===i.trackResize,this._bearingSnap=i.bearingSnap,this._refreshExpiredTiles=!0===i.refreshExpiredTiles,this._fadeDuration=i.fadeDuration,this._crossSourceCollisions=!0===i.crossSourceCollisions,this._collectResourceTiming=!0===i.collectResourceTiming,this._locale=Object.assign(Object.assign({},Cn),i.locale),this._clickTolerance=i.clickTolerance,this._overridePixelRatio=i.pixelRatio,this._maxCanvasSize=i.maxCanvasSize,this.transformCameraUpdate=i.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=!0===i.cancelPendingTileRequestsWhileZooming,this._imageQueueHandle=u.addThrottleControl((()=>this.isMoving())),this._requestManager=new m(i.transformRequest),"string"==typeof i.container){if(this._container=document.getElementById(i.container),!this._container)throw new Error(`Container '${i.container}' not found.`)}else{if(!(i.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=i.container}if(i.maxBounds&&this.setMaxBounds(i.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))).on("moveend",(()=>this._update(!1))).on("zoom",(()=>this._update(!0))).on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})).once("idle",(()=>{this._idleTriggered=!0})),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let t=!1;const e=fr((t=>{this._trackResize&&!this._removed&&this.resize(t)._update()}),50);this._resizeObserver=new ResizeObserver((i=>{t?e(i):t=!0})),this._resizeObserver.observe(this._container)}this.handlers=new mn(this,i),this._hash=i.hash&&new gr("string"==typeof i.hash&&i.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch}),i.bounds&&(this.resize(),this.fitBounds(i.bounds,e.e({},i.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=i.localIdeographFontFamily,this._validateStyle=i.validateStyle,i.style&&this.setStyle(i.style,{localIdeographFontFamily:i.localIdeographFontFamily}),i.attributionControl&&this.addControl(new _n("boolean"==typeof i.attributionControl?void 0:i.attributionControl)),i.maplibreLogo&&this.addControl(new vn,i.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(t=>{this._update("style"===t.dataType),this.fire(new e.k(`${t.dataType}data`,t))})),this.on("dataloading",(t=>{this.fire(new e.k(`${t.dataType}dataloading`,t))})),this.on("dataabort",(t=>{this.fire(new e.k("sourcedataabort",t))}))}_getMapId(){return this._mapId}addControl(t,i){if(void 0===i&&(i=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=t.onAdd(this);this._controls.push(t);const n=this._controlPositions[i];return-1!==i.indexOf("bottom")?n.insertBefore(r,n.firstChild):n.appendChild(r),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new e.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(t);return i>-1&&this._controls.splice(i,1),t.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}calculateCameraOptionsFromTo(t,e,i,r){return null==r&&this.terrain&&(r=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(t,e,i,r)}resize(t){var i;const r=this._containerDimensions(),n=r[0],a=r[1],s=this._getClampedPixelRatio(n,a);if(this._resizeCanvas(n,a,s),this.painter.resize(n,a,s),this.painter.overLimit()){const t=this.painter.context.gl;this._maxCanvasSize=[t.drawingBufferWidth,t.drawingBufferHeight];const e=this._getClampedPixelRatio(n,a);this._resizeCanvas(n,a,e),this.painter.resize(n,a,e)}this.transform.resize(n,a),null===(i=this._requestedCameraState)||void 0===i||i.resize(n,a);const o=!this._moving;return o&&(this.stop(),this.fire(new e.k("movestart",t)).fire(new e.k("move",t))),this.fire(new e.k("resize",t)),o&&this.fire(new e.k("moveend",t)),this}_getClampedPixelRatio(t,e){const{0:i,1:r}=this._maxCanvasSize,n=this.getPixelRatio(),a=t*n,s=e*n;return Math.min(a>i?i/a:1,s>r?r/s:1)*n}getPixelRatio(){var t;return null!==(t=this._overridePixelRatio)&&void 0!==t?t:devicePixelRatio}setPixelRatio(t){this._overridePixelRatio=t,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(t){return this.transform.setMaxBounds(U.convert(t)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?60:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this._update()}project(t){return this.transform.locationPoint(e.M.convert(t),this.style&&this.terrain)}unproject(t){return this.transform.pointLocation(e.P.convert(t),this.terrain)}isMoving(){var t;return this._moving||(null===(t=this.handlers)||void 0===t?void 0:t.isMoving())}isZooming(){var t;return this._zooming||(null===(t=this.handlers)||void 0===t?void 0:t.isZooming())}isRotating(){var t;return this._rotating||(null===(t=this.handlers)||void 0===t?void 0:t.isRotating())}_createDelegatedListener(t,e,i){if("mouseenter"===t||"mouseover"===t){let r=!1;const n=n=>{const a=this.getLayer(e)?this.queryRenderedFeatures(n.point,{layers:[e]}):[];a.length?r||(r=!0,i.call(this,new Sr(t,this,n.originalEvent,{features:a}))):r=!1};return{layer:e,listener:i,delegates:{mousemove:n,mouseout:()=>{r=!1}}}}if("mouseleave"===t||"mouseout"===t){let r=!1;const n=n=>{(this.getLayer(e)?this.queryRenderedFeatures(n.point,{layers:[e]}):[]).length?r=!0:r&&(r=!1,i.call(this,new Sr(t,this,n.originalEvent)))},a=e=>{r&&(r=!1,i.call(this,new Sr(t,this,e.originalEvent)))};return{layer:e,listener:i,delegates:{mousemove:n,mouseout:a}}}{const r=t=>{const r=this.getLayer(e)?this.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,i.call(this,t),delete t.features)};return{layer:e,listener:i,delegates:{[t]:r}}}}on(t,e,i){if(void 0===i)return super.on(t,e);const r=this._createDelegatedListener(t,e,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(r);for(const t in r.delegates)this.on(t,r.delegates[t]);return this}once(t,e,i){if(void 0===i)return super.once(t,e);const r=this._createDelegatedListener(t,e,i);for(const t in r.delegates)this.once(t,r.delegates[t]);return this}off(t,e,i){return void 0===i?super.off(t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&(r=>{const n=this._delegatedListeners[t];for(let t=0;t<n.length;t++){const r=n[t];if(r.layer===e&&r.listener===i){for(const t in r.delegates)this.off(t,r.delegates[t]);return n.splice(t,1),this}}})(),this)}queryRenderedFeatures(t,i){if(!this.style)return[];let r;const n=t instanceof e.P||Array.isArray(t),a=n?t:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(n?{}:t)||{},a instanceof e.P||"number"==typeof a[0])r=[e.P.convert(a)];else{const t=e.P.convert(a[0]),i=e.P.convert(a[1]);r=[t,new e.P(i.x,t.y),i,new e.P(t.x,i.y),t]}return this.style.queryRenderedFeatures(r,i,this.transform)}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}setStyle(t,i){return!1!==(i=e.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(t,i))}setTransformRequest(t){return this._requestManager.setTransformRequest(t),this}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(t,e)));const i=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!t)),t?(this.style=new ce(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t,e,i):this.style.loadJSON(t,e,i),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ce(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,i){if("string"==typeof t){const r=this._requestManager.transformRequest(t,"Style");e.h(r,new AbortController).then((t=>{this._updateDiff(t.data,i)})).catch((t=>{t&&this.fire(new e.j(t))}))}else"object"==typeof t&&this._updateDiff(t,i)}_updateDiff(t,i){try{this.style.setState(t,i)&&this._update(!0)}catch(r){e.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(t,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():e.w("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(t){const i=this.style&&this.style.sourceCaches[t];if(void 0!==i)return i.loaded();this.fire(new e.j(new Error(`There is no source with ID '${t}'`)))}setTerrain(t){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),t){const i=this.style.sourceCaches[t.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${t.source}`);null===this.terrain&&i.reload();for(const i in this.style._layers){const r=this.style._layers[i];"hillshade"===r.type&&r.source===t.source&&e.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new wn(this.painter,i,t),this.painter.renderToTexture=new Sn(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=e=>{"style"===e.dataType?this.terrain.sourceCache.freeRtt():"source"===e.dataType&&e.tile&&(e.sourceId!==t.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(e.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new e.k("terrain",{terrain:t})),this}getTerrain(){var t,e;return null!==(e=null===(t=this.terrain)||void 0===t?void 0:t.options)&&void 0!==e?e:null}areTilesLoaded(){const t=this.style&&this.style.sourceCaches;for(const e in t){const i=t[e]._tiles;for(const t in i){const e=i[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}removeSource(t){return this.style.removeSource(t),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(t,i,r={}){const{pixelRatio:n=1,sdf:s=!1,stretchX:o,stretchY:l,content:c,textFitWidth:d,textFitHeight:h}=r;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||e.b(i))){if(void 0===i.width||void 0===i.height)return this.fire(new e.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:r,height:a,data:p}=i,u=i;return this.style.addImage(t,{data:new e.R({width:r,height:a},new Uint8Array(p)),pixelRatio:n,stretchX:o,stretchY:l,content:c,textFitWidth:d,textFitHeight:h,sdf:s,version:0,userImage:u}),u.onAdd&&u.onAdd(this,t),this}}{const{width:r,height:p,data:u}=a.getImageData(i);this.style.addImage(t,{data:new e.R({width:r,height:p},u),pixelRatio:n,stretchX:o,stretchY:l,content:c,textFitWidth:d,textFitHeight:h,sdf:s,version:0})}}updateImage(t,i){const r=this.style.getImage(t);if(!r)return this.fire(new e.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const n=i instanceof HTMLImageElement||e.b(i)?a.getImageData(i):i,{width:s,height:o,data:l}=n;if(void 0===s||void 0===o)return this.fire(new e.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(s!==r.data.width||o!==r.data.height)return this.fire(new e.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const c=!(i instanceof HTMLImageElement||e.b(i));return r.data.replace(l,c),this.style.updateImage(t,r),this}getImage(t){return this.style.getImage(t)}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new e.j(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(t){return u.getImage(this._requestManager.transformRequest(t,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(t,e,i){return this.style.setLayerZoomRange(t,e,i),this._update(!0)}setFilter(t,e,i={}){return this.style.setFilter(t,e,i),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,i,r={}){return this.style.setPaintProperty(t,e,i,r),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,i,r={}){return this.style.setLayoutProperty(t,e,i,r),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setGlyphs(t,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(t,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(t,e,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(t,e,i,(t=>{t||this._update(!0)})),this}removeSprite(t){return this._lazyInitEmptyStyle(),this.style.removeSprite(t),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(t,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(t,e,(t=>{t||this._update(!0)})),this}setLight(t,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]}_setupContainer(){const t=this._container;t.classList.add("maplibregl-map");const e=this._canvasContainer=s.create("div","maplibregl-canvas-container",t);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=s.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const i=this._containerDimensions(),r=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],r);const n=this._controlContainer=s.create("div","maplibregl-control-container",t),a=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((t=>{a[t]=s.create("div",`maplibregl-ctrl-${t} `,n)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(t,e,i){this._canvas.width=Math.floor(i*t),this._canvas.height=Math.floor(i*e),this._canvas.style.width=`${t}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const t={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",(i=>{e={requestedAttributes:t},i&&(e.statusMessage=i.statusMessage,e.type=i.type)}),{once:!0});const i=this._canvas.getContext("webgl2",t)||this._canvas.getContext("webgl",t);if(!i){const t="Failed to initialize WebGL";throw e?(e.message=t,new Error(JSON.stringify(e))):new Error(t)}this.painter=new cr(i,this.transform),o.testSupport(i)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_render(t){const i=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),this._removed)return;let r=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,n=a.now();this.style.zoomHistory.update(t,n);const s=new e.a8(t,{now:n,fadeDuration:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),o=s.crossFadingFactor();1===o&&o===this._crossFadingFactor||(r=!0,this._crossFadingFactor=o),this.style.update(s)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,showPadding:this.showPadding}),this.fire(new e.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,e.bd.mark(e.be.load),this.fire(new e.k("load"))),this.style&&(this.style.hasTransitions()||r)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const n=this._sourcesDirty||this._styleDirty||this._placementDirty;return n||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new e.k("idle")),!this._loaded||this._fullyLoaded||n||(this._fullyLoaded=!0,e.bd.mark(e.be.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var t;this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),u.removeThrottleControl(this._imageQueueHandle),null===(t=this._resizeObserver)||void 0===t||t.disconnect();const i=this.painter.context.gl.getExtension("WEBGL_lose_context");(null==i?void 0:i.loseContext)&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),s.remove(this._canvasContainer),s.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),e.bd.clearMetrics(),this._removed=!0,this.fire(new e.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,a.frameAsync(this._frameRequest).then((t=>{e.bd.frame(t),this._frameRequest=null,this._render(t)})).catch((()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get version(){return En}getCameraTargetElevation(){return this.transform.elevation}},t.MapMouseEvent=Sr,t.MapTouchEvent=Cr,t.MapWheelEvent=Er,t.Marker=Dn,t.NavigationControl=class{constructor(t){this._updateZoomButtons=()=>{const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),i=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,e)=>{const i=this._map._getUIString(`NavigationControl.${e}`);t.title=i,t.setAttribute("aria-label",i)},this.options=e.e({},In,t),this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),s.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),s.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=s.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Mn(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){s.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(t,e){const i=s.create("button",t,this._container);return i.type="button",i.addEventListener("click",e),i}},t.Popup=class extends e.E{constructor(t){super(),this.remove=()=>(this._content&&s.remove(this._content),this._container&&(s.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new e.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var e;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=s.create("div","maplibregl-popup",this._map.getContainer()),this._tip=s.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const t of this.options.className.split(" "))this._container.classList.add(t);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Pn(this._lngLat,this._flatPos,this._map.transform):null===(e=this._lngLat)||void 0===e?void 0:e.wrap(),this._trackPointer&&!t)return;const i=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let r=this.options.anchor;const n=Yn(this.options.offset);if(!r){const t=this._container.offsetWidth,e=this._container.offsetHeight;let a;a=i.y+n.bottom.y<e?["top"]:i.y>this._map.transform.height-e?["bottom"]:[],i.x<t/2?a.push("left"):i.x>this._map.transform.width-t/2&&a.push("right"),r=0===a.length?"bottom":a.join("-")}let a=i.add(n[r]);this.options.subpixelPositioning||(a=a.round()),s.setTransform(this._container,`${Rn[r]} translate(${a.x}px,${a.y}px)`),zn(this._container,r,"popup")},this._onClose=()=>{this.remove()},this.options=e.e(Object.create(Vn),t)}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new e.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.M.convert(t),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(document.createTextNode(t))}setHTML(t){const e=document.createDocumentFragment(),i=document.createElement("body");let r;for(i.innerHTML=t;r=i.firstChild,r;)e.appendChild(r);return this.setDOMContent(e)}getMaxWidth(){var t;return null===(t=this._container)||void 0===t?void 0:t.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=s.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){return this._container&&this._container.classList.add(t),this}removeClassName(t){return this._container&&this._container.classList.remove(t),this}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){if(this._container)return this._container.classList.toggle(t)}setSubpixelPositioning(t){this.options.subpixelPositioning=t}_createCloseButton(){this.options.closeButton&&(this._closeButton=s.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(Un);t&&t.focus()}},t.RasterDEMTileSource=W,t.RasterTileSource=q,t.ScaleControl=class{constructor(t){this._onMove=()=>{Nn(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Nn(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Fn),t)}getDefaultPosition(){return"bottom-left"}onAdd(t){return this._map=t,this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){s.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},t.ScrollZoomHandler=rn,t.Style=ce,t.TerrainControl=class{constructor(t){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=t}onAdd(t){return this._map=t,this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=s.create("button","maplibregl-ctrl-terrain",this._container),s.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){s.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},t.TwoFingersTouchPitchHandler=Kr,t.TwoFingersTouchRotateHandler=Gr,t.TwoFingersTouchZoomHandler=qr,t.TwoFingersTouchZoomRotateHandler=cn,t.VectorTileSource=Z,t.VideoSource=J,t.addSourceType=(t,i)=>e._(void 0,void 0,void 0,(function*(){if(et(t))throw new Error(`A source type called "${t}" already exists.`);((t,e)=>{tt[t]=e})(t,i)})),t.clearPrewarmedResources=function(){const t=z;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(L),z=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},t.getMaxParallelImageRequests=function(){return e.a.MAX_PARALLEL_IMAGE_REQUESTS},t.getRTLTextPluginStatus=function(){return at().getRTLTextPluginStatus()},t.getVersion=function(){return Zn},t.getWorkerCount=function(){return P.workerCount},t.getWorkerUrl=function(){return e.a.WORKER_URL},t.importScriptInWorkers=function(t){return B().broadcast("IS",t)},t.prewarm=function(){j().acquire(L)},t.setMaxParallelImageRequests=function(t){e.a.MAX_PARALLEL_IMAGE_REQUESTS=t},t.setRTLTextPlugin=function(t,e){return at().setRTLTextPlugin(t,e)},t.setWorkerCount=function(t){P.workerCount=t},t.setWorkerUrl=function(t){e.a.WORKER_URL=t}})),t})),function(t,e){"function"==typeof define&&define.amd?define(["leaflet","maplibre-gl"],e):"object"==typeof exports?module.exports=e(require("leaflet"),require("maplibre-gl")):t.returnExports=e(t.L,t.maplibregl)}("undefined"!=typeof globalThis?globalThis:self,(function(t,e){t.MaplibreGL=t.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},initialize:function(e){t.setOptions(this,e),this._throttledUpdate=t.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(e){this._container||this._initContainer();var i=this.getPaneName();e.getPane(i).appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),e.options.zoomAnimation&&t.DomEvent.on(e._proxy,t.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(e){this._map._proxy&&this._map.options.zoomAnimation&&t.DomEvent.off(this._map._proxy,t.DomUtil.TRANSITION_END,this._transitionEnd,this);var i=this.getPaneName();e.getPane(i).removeChild(this._container),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaplibreMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+2*this.options.padding)},getBounds:function(){var e=this.getSize().multiplyBy(.5),i=this._map.latLngToContainerPoint(this._map.getCenter());return t.latLngBounds(this._map.containerPointToLatLng(i.subtract(e)),this._map.containerPointToLatLng(i.add(e)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},_roundPoint:function(t){return{x:Math.round(t.x),y:Math.round(t.y)}},_initContainer:function(){var e=this._container=t.DomUtil.create("div","leaflet-gl-layer"),i=this.getSize(),r=this._map.getSize().multiplyBy(this.options.padding);e.style.width=i.x+"px",e.style.height=i.y+"px";var n=this._map.containerPointToLayerPoint([0,0]).subtract(r);t.DomUtil.setPosition(e,this._roundPoint(n))},_initGL:function(){var i=this._map.getCenter(),r=t.extend({},this.options,{container:this._container,center:[i.lng,i.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new e.Map(r),this._glMap.transform.latRange=null,this._glMap.transform.maxValidLatitude=1/0,this._transformGL(this._glMap),this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas;var n=this._glMap._actualCanvas;t.DomUtil.addClass(n,"leaflet-image-layer"),t.DomUtil.addClass(n,"leaflet-zoom-animated"),this.options.interactive&&t.DomUtil.addClass(n,"leaflet-interactive"),this.options.className&&t.DomUtil.addClass(n,this.options.className)},_update:function(e){if(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming){var i=this.getSize(),r=this._container,n=this._glMap,a=this._map.getSize().multiplyBy(this.options.padding),s=this._map.containerPointToLayerPoint([0,0]).subtract(a);t.DomUtil.setPosition(r,this._roundPoint(s)),this._transformGL(n),n.transform.width!==i.x||n.transform.height!==i.y?(r.style.width=i.x+"px",r.style.height=i.y+"px",null!==n._resize&&void 0!==n._resize?n._resize():n.resize()):null!==n._update&&void 0!==n._update?n._update():n.update()}},_transformGL:function(t){var i=this._map.getCenter(),r=t.transform;r.center=e.LngLat.convert([i.lng,i.lat]),r.zoom=this._map.getZoom()-1},_pinchZoom:function(t){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(e){var i=this._map.getZoomScale(e.zoom),r=this._map.getSize().multiplyBy(this.options.padding*i),n=this.getSize()._divideBy(2),a=this._map.project(e.center,e.zoom)._subtract(n)._add(this._map._getMapPanePos().add(r))._round(),s=this._map.project(this._map.getBounds().getNorthWest(),e.zoom)._subtract(a);t.DomUtil.setTransform(this._glMap._actualCanvas,s.subtract(this._offset),i)},_zoomStart:function(t){this._zooming=!0},_zoomEnd:function(){var e=this._map.getZoomScale(this._map.getZoom());t.DomUtil.setTransform(this._glMap._actualCanvas,null,e),this._zooming=!1,this._update()},_transitionEnd:function(e){t.Util.requestAnimFrame((function(){var e=this._map.getZoom(),i=this._map.getCenter(),r=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());t.DomUtil.setTransform(this._glMap._actualCanvas,r,1),this._glMap.once("moveend",t.Util.bind((function(){this._zoomEnd()}),this)),this._glMap.jumpTo({center:i,zoom:e-1})}),this)},_resize:function(t){this._transitionEnd(t)}}),t.maplibreGL=function(e){return new t.MaplibreGL(e)}}));const gf="maplibre_gl_dates";function _f(t,e){let i=vf(e);t.getStyle().layers.map((function(e){if(!("source-layer"in e))return;let r=wf(t.getFilter(e.id),i);t.setFilter(e.id,r)}))}function vf(t){let e;if("string"==typeof t)e=yf(t);else if(t instanceof Date&&!isNaN(t)){let i=xf(t),r=t.toISOString().split("T")[0];e={startDate:t,startDecimalYear:i,startISODate:r,endDate:t,endDecimalYear:i,endISODate:r}}return e}function yf(t){if(!t||!/^-?\d{1,4}(?:-\d\d){0,2}$/.test(t))return;let e=t.split("-");""===e[0]&&(e.shift(),e[0]*=-1);let i,r,n,a,s=+e[0],o=+e[0];e[1]?i=r=+e[1]-1:(o++,i=r=0),e[2]?n=a=+e[2]:e[1]&&(r++,n=a=1);let l=bf(s,i,n),c=bf(o,r,a);return{startDate:!isNaN(l)&&l,startDecimalYear:!isNaN(l)&&xf(l),startISODate:!isNaN(l)&&l.toISOString().split("T")[0],endDate:!isNaN(c)&&c,endDecimalYear:!isNaN(c)&&xf(c),endISODate:!isNaN(c)&&c.toISOString().split("T")[0]}}function bf(t,e,i){let r=new Date(Date.UTC(t,e,i));return r.setUTCFullYear(t),r}function xf(t){let e=t.getUTCFullYear(),i=bf(e+1,0,1).getTime(),r=bf(e,0,1).getTime();return e<0&&e--,e+(t.getTime()-r)/(i-r)}function wf(t,e){return void 0!==t&&Sf(t)?kf(t,e):Tf(t,e)}function kf(t,e){return"all"===t[0]&&t[2]&&"any"===t[1][0]&&"any"===t[2][0]?(t[1][1]&&"all"===t[1][1][0]&&t[1][1][2]&&"<"===t[1][1][2][0]&&"start_decdate"===t[1][1][2][1]&&(t[1][1][2][2]=e.endDecimalYear),t[1][2]&&"all"===t[1][2][0]&&t[1][2][2]&&"<"===t[1][2][2][0]&&"start_date"===t[1][2][2][2]&&(t[1][2][2][3]=e.endISODate),t[2][1]&&"all"===t[2][1][0]&&t[2][1][2]&&">="===t[2][1][2][0]&&"end_decdate"===t[2][1][2][1]&&(t[2][1][2][2]=e.startDecimalYear),t[2][2]&&"all"===t[2][2][0]&&t[2][2][2]&&">="===t[2][2][2][0]&&"end_date"===t[2][2][2][2]&&(t[2][2][2][3]=e.startISODate),t):["all",["any",["all",["has","start_decdate"],["<","start_decdate",e.endDecimalYear]],["all",["!has","start_decdate"],["has","start_date"],["<","start_date",e.endISODate]],["all",["!has","start_decdate"],["!has","start_date"]]],["any",["all",["has","end_decdate"],[">=","end_decdate",e.startDecimalYear]],["all",["!has","end_decdate"],["has","end_date"],[">=","end_date",e.startISODate]],["all",["!has","end_decdate"],["!has","end_date"]]],t]}function Tf(t,e){const i=`${gf}__startDecimalYear`,r=`${gf}__startISODate`,n=`${gf}__endDecimalYear`,a=`${gf}__endISODate`;if(Array.isArray(t)&&"let"===t[0])return Cf(t,i,e.startDecimalYear),Cf(t,r,e.startISODate),Cf(t,n,e.endDecimalYear),Cf(t,a,e.endISODate),t;let s=["all",["any",["all",["has","start_decdate"],["<",["get","start_decdate"],["var",n]]],["all",["!",["has","start_decdate"]],["has","start_date"],["<",["get","start_date"],["var",a]]],["all",["!",["has","start_decdate"]],["!",["has","start_date"]]]],["any",["all",["has","end_decdate"],[">=",["get","end_decdate"],["var",i]]],["all",["!",["has","end_decdate"]],["has","end_date"],[">=",["get","end_date"],["var",r]]],["all",["!",["has","end_decdate"]],["!",["has","end_date"]]]]];return t&&s.push(t),["let",i,e.startDecimalYear,r,e.startISODate,n,e.endDecimalYear,a,e.endISODate,s]}function Sf(t){if(!Array.isArray(t)||t.length<2)return!1;let e=t.slice(1);switch(t[0]){case"!has":case"!in":case"none":return!0;case"has":return"$id"===e[0]||"$type"===e[0];case"in":return e.length>2||"$id"===e[0]||"$type"===e[0]||"number"==typeof e[1]||"boolean"==typeof e[1]||"string"==typeof e[0]&&"string"==typeof e[1];case"==":case"!=":case">":case">=":case"<":case"<=":return"string"==typeof e[0]&&!Array.isArray(e[1]);case"all":case"any":return e.some(Sf);default:return!1}}function Cf(t,e,i){if("let"!==t[0])return;let r=t.indexOf(e);-1!==r&&r%2==1?t[r+1]=i:t.splice(-1,0,e,i)}function Ef(t){var e,i,r,n;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])t[e]=n[e];return t}"undefined"!=typeof window&&"maplibregl"in window?maplibregl.Map.prototype.filterByDate=function(t){_f(this,t)}:"undefined"!=typeof module&&(module.exports={filterByDate:_f,dateRangeFromDate:vf,decimalYearFromDate:xf,dateRangeFromISODate:yf,constrainFilterByDateRange:wf,constrainLegacyFilterByDateRange:kf,constrainExpressionFilterByDateRange:Tf,isLegacyFilter:Sf,updateVariable:Cf});var $f=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function Af(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var r=i.call(arguments,2);return function(){return t.apply(e,r.length?r.concat(i.call(arguments)):arguments)}}var If=0;function Mf(t){return"_leaflet_id"in t||(t._leaflet_id=++If),t._leaflet_id}function Lf(t,e,i){var r=e[1],n=e[0],a=r-n;return t===r&&i?t:((t-n)%a+a)%a+n}function Pf(){return!1}function Rf(t,e){if(!1===e)return t;var i=Math.pow(10,void 0===e?6:e);return Math.round(t*i)/i}function zf(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Df(t){return zf(t).split(/\s+/)}function jf(t,e){for(var i in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?$f(t.options):{}),e)t.options[i]=e[i];return t.options}var Of=/\{ *([\w_ -]+) *\}/g;var Bf=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function Ff(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}var Nf="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Hf(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var Vf=0;function Uf(t){var e=+new Date,i=Math.max(0,16-(e-Vf));return Vf=e+i,window.setTimeout(t,i)}var Yf=window.requestAnimationFrame||Hf("RequestAnimationFrame")||Uf,Zf=window.cancelAnimationFrame||Hf("CancelAnimationFrame")||Hf("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function qf(t,e,i){if(!i||Yf!==Uf)return Yf.call(window,Af(t,e));t.call(e)}function Wf(t){t&&Zf.call(window,t)}function Gf(){}Gf.extend=function(t){var e=function(){jf(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=e.__super__=this.prototype,r=$f(i);for(var n in r.constructor=e,e.prototype=r,this)Object.prototype.hasOwnProperty.call(this,n)&&"prototype"!==n&&"__super__"!==n&&(e[n]=this[n]);return t.statics&&Ef(e,t.statics),t.includes&&(!function(t){if("undefined"==typeof L||!L||!L.Mixin)return;t=Bf(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}(t.includes),Ef.apply(null,[r].concat(t.includes))),Ef(r,t),delete r.statics,delete r.includes,r.options&&(r.options=i.options?$f(i.options):{},Ef(r.options,t.options)),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=r._initHooks.length;t<e;t++)r._initHooks[t].call(this)}},e},Gf.include=function(t){var e=this.prototype.options;return Ef(this.prototype,t),t.options&&(this.prototype.options=e,this.mergeOptions(t.options)),this},Gf.mergeOptions=function(t){return Ef(this.prototype.options,t),this},Gf.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};var Xf={on:function(t,e,i){if("object"==typeof t)for(var r in t)this._on(r,t[r],e);else for(var n=0,a=(t=Df(t)).length;n<a;n++)this._on(t[n],e,i);return this},off:function(t,e,i){if(arguments.length)if("object"==typeof t)for(var r in t)this._off(r,t[r],e);else{t=Df(t);for(var n=1===arguments.length,a=0,s=t.length;a<s;a++)n?this._off(t[a]):this._off(t[a],e,i)}else delete this._events;return this},_on:function(t,e,i,r){if("function"==typeof e){if(!1===this._listens(t,e,i)){i===this&&(i=void 0);var n={fn:e,ctx:i};r&&(n.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(n)}}else console.warn("wrong listener type: "+typeof e)},_off:function(t,e,i){var r,n,a;if(this._events&&(r=this._events[t]))if(1!==arguments.length)if("function"==typeof e){var s=this._listens(t,e,i);if(!1!==s){var o=r[s];this._firingCount&&(o.fn=Pf,this._events[t]=r=r.slice()),r.splice(s,1)}}else console.warn("wrong listener type: "+typeof e);else{if(this._firingCount)for(n=0,a=r.length;n<a;n++)r[n].fn=Pf;delete this._events[t]}},fire:function(t,e,i){if(!this.listens(t,i))return this;var r=Ef({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var n=this._events[t];if(n){this._firingCount=this._firingCount+1||1;for(var a=0,s=n.length;a<s;a++){var o=n[a],l=o.fn;o.once&&this.off(t,l,o.ctx),l.call(o.ctx||this,r)}this._firingCount--}}return i&&this._propagateEvent(r),this},listens:function(t,e,i,r){"string"!=typeof t&&console.warn('"string" type argument expected');var n=e;"function"!=typeof e&&(r=!!e,n=void 0,i=void 0);var a=this._events&&this._events[t];if(a&&a.length&&!1!==this._listens(t,n,i))return!0;if(r)for(var s in this._eventParents)if(this._eventParents[s].listens(t,e,i,r))return!0;return!1},_listens:function(t,e,i){if(!this._events)return!1;var r=this._events[t]||[];if(!e)return!!r.length;i===this&&(i=void 0);for(var n=0,a=r.length;n<a;n++)if(r[n].fn===e&&r[n].ctx===i)return n;return!1},once:function(t,e,i){if("object"==typeof t)for(var r in t)this._on(r,t[r],e,!0);else for(var n=0,a=(t=Df(t)).length;n<a;n++)this._on(t[n],e,i,!0);return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[Mf(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[Mf(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,Ef({layer:t.target,propagatedFrom:t.target},t),!0)}};Xf.addEventListener=Xf.on,Xf.removeEventListener=Xf.clearAllEventListeners=Xf.off,Xf.addOneTimeEventListener=Xf.once,Xf.fireEvent=Xf.fire,Xf.hasEventListeners=Xf.listens;var Kf=Gf.extend(Xf);function Jf(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}var Qf=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function tg(t,e,i){return t instanceof Jf?t:Bf(t)?new Jf(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new Jf(t.x,t.y):new Jf(t,e,i)}function eg(t,e){if(t)for(var i=e?[t,e]:t,r=0,n=i.length;r<n;r++)this.extend(i[r])}function ig(t,e){return!t||t instanceof eg?t:new eg(t,e)}function rg(t,e){if(t)for(var i=e?[t,e]:t,r=0,n=i.length;r<n;r++)this.extend(i[r])}function ng(t,e){return t instanceof rg?t:new rg(t,e)}function ag(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==i&&(this.alt=+i)}function sg(t,e,i){return t instanceof ag?t:Bf(t)&&"object"!=typeof t[0]?3===t.length?new ag(t[0],t[1],t[2]):2===t.length?new ag(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new ag(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new ag(t,e,i)}Jf.prototype={clone:function(){return new Jf(this.x,this.y)},add:function(t){return this.clone()._add(tg(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(tg(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new Jf(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new Jf(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Qf(this.x),this.y=Qf(this.y),this},distanceTo:function(t){var e=(t=tg(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=tg(t)).x===this.x&&t.y===this.y},contains:function(t){return t=tg(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+Rf(this.x)+", "+Rf(this.y)+")"}},eg.prototype={extend:function(t){var e,i;if(!t)return this;if(t instanceof Jf||"number"==typeof t[0]||"x"in t)e=i=tg(t);else if(e=(t=ig(t)).min,i=t.max,!e||!i)return this;return this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(i.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(i.y,this.max.y)):(this.min=e.clone(),this.max=i.clone()),this},getCenter:function(t){return tg((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return tg(this.min.x,this.max.y)},getTopRight:function(){return tg(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof Jf?tg(t):ig(t))instanceof eg?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=ig(t);var e=this.min,i=this.max,r=t.min,n=t.max,a=n.x>=e.x&&r.x<=i.x,s=n.y>=e.y&&r.y<=i.y;return a&&s},overlaps:function(t){t=ig(t);var e=this.min,i=this.max,r=t.min,n=t.max,a=n.x>e.x&&r.x<i.x,s=n.y>e.y&&r.y<i.y;return a&&s},isValid:function(){return!(!this.min||!this.max)},pad:function(t){var e=this.min,i=this.max,r=Math.abs(e.x-i.x)*t,n=Math.abs(e.y-i.y)*t;return ig(tg(e.x-r,e.y-n),tg(i.x+r,i.y+n))},equals:function(t){return!!t&&(t=ig(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight()))}},rg.prototype={extend:function(t){var e,i,r=this._southWest,n=this._northEast;if(t instanceof ag)e=t,i=t;else{if(!(t instanceof rg))return t?this.extend(sg(t)||ng(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return r||n?(r.lat=Math.min(e.lat,r.lat),r.lng=Math.min(e.lng,r.lng),n.lat=Math.max(i.lat,n.lat),n.lng=Math.max(i.lng,n.lng)):(this._southWest=new ag(e.lat,e.lng),this._northEast=new ag(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,r=Math.abs(e.lat-i.lat)*t,n=Math.abs(e.lng-i.lng)*t;return new rg(new ag(e.lat-r,e.lng-n),new ag(i.lat+r,i.lng+n))},getCenter:function(){return new ag((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ag(this.getNorth(),this.getWest())},getSouthEast:function(){return new ag(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof ag||"lat"in t?sg(t):ng(t);var e,i,r=this._southWest,n=this._northEast;return t instanceof rg?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=r.lat&&i.lat<=n.lat&&e.lng>=r.lng&&i.lng<=n.lng},intersects:function(t){t=ng(t);var e=this._southWest,i=this._northEast,r=t.getSouthWest(),n=t.getNorthEast(),a=n.lat>=e.lat&&r.lat<=i.lat,s=n.lng>=e.lng&&r.lng<=i.lng;return a&&s},overlaps:function(t){t=ng(t);var e=this._southWest,i=this._northEast,r=t.getSouthWest(),n=t.getNorthEast(),a=n.lat>e.lat&&r.lat<i.lat,s=n.lng>e.lng&&r.lng<i.lng;return a&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=ng(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},ag.prototype={equals:function(t,e){return!!t&&(t=sg(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+Rf(this.lat,t)+", "+Rf(this.lng,t)+")"},distanceTo:function(t){return lg.distance(this,sg(t))},wrap:function(){return lg.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return ng([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new ag(this.lat,this.lng,this.alt)}};var og={latLngToPoint:function(t,e){var i=this.projection.project(t),r=this.scale(e);return this.transformation._transform(i,r)},pointToLatLng:function(t,e){var i=this.scale(e),r=this.transformation.untransform(t,i);return this.projection.unproject(r)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t);return new eg(this.transformation.transform(e.min,i),this.transformation.transform(e.max,i))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?Lf(t.lng,this.wrapLng,!0):t.lng;return new ag(this.wrapLat?Lf(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),r=e.lat-i.lat,n=e.lng-i.lng;if(0===r&&0===n)return t;var a=t.getSouthWest(),s=t.getNorthEast();return new rg(new ag(a.lat-r,a.lng-n),new ag(s.lat-r,s.lng-n))}},lg=Ef({},og,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,r=t.lat*i,n=e.lat*i,a=Math.sin((e.lat-t.lat)*i/2),s=Math.sin((e.lng-t.lng)*i/2),o=a*a+Math.cos(r)*Math.cos(n)*s*s,l=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return this.R*l}}),cg=6378137,dg={R:cg,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,r=Math.max(Math.min(i,t.lat),-i),n=Math.sin(r*e);return new Jf(this.R*t.lng*e,this.R*Math.log((1+n)/(1-n))/2)},unproject:function(t){var e=180/Math.PI;return new ag((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=cg*Math.PI;return new eg([-t,-t],[t,t])}()};function hg(t,e,i,r){if(Bf(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=i,this._d=r}function pg(t,e,i,r){return new hg(t,e,i,r)}hg.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new Jf((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var ug,mg=Ef({},lg,{code:"EPSG:3857",projection:dg,transformation:(ug=.5/(Math.PI*dg.R),pg(ug,.5,-ug,.5))}),fg=Ef({},mg,{code:"EPSG:900913"});function gg(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function _g(t,e){var i,r,n,a,s,o,l="";for(i=0,n=t.length;i<n;i++){for(r=0,a=(s=t[i]).length;r<a;r++)l+=(r?"L":"M")+(o=s[r]).x+" "+o.y;l+=e?t_.svg?"z":"x":""}return l||"M0 0"}var vg=document.documentElement.style,yg="ActiveXObject"in window,bg=yg&&!document.addEventListener,xg="msLaunchUri"in navigator&&!("documentMode"in document),wg=Qg("webkit"),kg=Qg("android"),Tg=Qg("android 2")||Qg("android 3"),Sg=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Cg=kg&&Qg("Google")&&Sg<537&&!("AudioNode"in window),Eg=!!window.opera,$g=!xg&&Qg("chrome"),Ag=Qg("gecko")&&!wg&&!Eg&&!yg,Ig=!$g&&Qg("safari"),Mg=Qg("phantom"),Lg="OTransition"in vg,Pg=0===navigator.platform.indexOf("Win"),Rg=yg&&"transition"in vg,zg="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Tg,Dg="MozPerspective"in vg,jg=!window.L_DISABLE_3D&&(Rg||zg||Dg)&&!Lg&&!Mg,Og="undefined"!=typeof orientation||Qg("mobile"),Bg=Og&&wg,Fg=Og&&zg,Ng=!window.PointerEvent&&window.MSPointerEvent,Hg=!(!window.PointerEvent&&!Ng),Vg="ontouchstart"in window||!!window.TouchEvent,Ug=!window.L_NO_TOUCH&&(Vg||Hg),Yg=Og&&Eg,Zg=Og&&Ag,qg=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Wg=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",Pf,e),window.removeEventListener("testPassiveEventSupport",Pf,e)}catch(t){}return t}(),Gg=!!document.createElement("canvas").getContext,Xg=!(!document.createElementNS||!gg("svg").createSVGRect),Kg=!!Xg&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(t.firstChild&&t.firstChild.namespaceURI)}(),Jg=!Xg&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}();function Qg(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var t_={ie:yg,ielt9:bg,edge:xg,webkit:wg,android:kg,android23:Tg,androidStock:Cg,opera:Eg,chrome:$g,gecko:Ag,safari:Ig,phantom:Mg,opera12:Lg,win:Pg,ie3d:Rg,webkit3d:zg,gecko3d:Dg,any3d:jg,mobile:Og,mobileWebkit:Bg,mobileWebkit3d:Fg,msPointer:Ng,pointer:Hg,touch:Ug,touchNative:Vg,mobileOpera:Yg,mobileGecko:Zg,retina:qg,passiveEvents:Wg,canvas:Gg,svg:Xg,vml:Jg,inlineSvg:Kg,mac:0===navigator.platform.indexOf("Mac"),linux:0===navigator.platform.indexOf("Linux")},e_=t_.msPointer?"MSPointerDown":"pointerdown",i_=t_.msPointer?"MSPointerMove":"pointermove",r_=t_.msPointer?"MSPointerUp":"pointerup",n_=t_.msPointer?"MSPointerCancel":"pointercancel",a_={touchstart:e_,touchmove:i_,touchend:r_,touchcancel:n_},s_={touchstart:function(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&ev(e);u_(t,e)},touchmove:u_,touchend:u_,touchcancel:u_},o_={},l_=!1;function c_(t,e,i){return"touchstart"===e&&(l_||(document.addEventListener(e_,d_,!0),document.addEventListener(i_,h_,!0),document.addEventListener(r_,p_,!0),document.addEventListener(n_,p_,!0),l_=!0)),s_[e]?(i=s_[e].bind(this,i),t.addEventListener(a_[e],i,!1),i):(console.warn("wrong event specified:",e),Pf)}function d_(t){o_[t.pointerId]=t}function h_(t){o_[t.pointerId]&&(o_[t.pointerId]=t)}function p_(t){delete o_[t.pointerId]}function u_(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){for(var i in e.touches=[],o_)e.touches.push(o_[i]);e.changedTouches=[e],t(e)}}var m_=200;var f_,g_,__,v_,y_,b_=z_(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),x_=z_(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),w_="webkitTransition"===x_||"OTransition"===x_?x_+"End":"transitionend";function k_(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var r=document.defaultView.getComputedStyle(t,null);i=r?r[e]:null}return"auto"===i?null:i}function T_(t,e,i){var r=document.createElement(t);return r.className=e||"",i&&i.appendChild(r),r}function S_(t){var e=t.parentNode;e&&e.removeChild(t)}function C_(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function E_(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function $_(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function A_(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=P_(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function I_(t,e){if(void 0!==t.classList)for(var i=Df(e),r=0,n=i.length;r<n;r++)t.classList.add(i[r]);else if(!A_(t,e)){var a=P_(t);L_(t,(a?a+" ":"")+e)}}function M_(t,e){void 0!==t.classList?t.classList.remove(e):L_(t,zf((" "+P_(t)+" ").replace(" "+e+" "," ")))}function L_(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function P_(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function R_(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var i=!1,r="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(r)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+r+"(opacity="+e+")"}(t,e)}function z_(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function D_(t,e,i){var r=e||new Jf(0,0);t.style[b_]=(t_.ie3d?"translate("+r.x+"px,"+r.y+"px)":"translate3d("+r.x+"px,"+r.y+"px,0)")+(i?" scale("+i+")":"")}function j_(t,e){t._leaflet_pos=e,t_.any3d?D_(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function O_(t){return t._leaflet_pos||new Jf(0,0)}if("onselectstart"in document)f_=function(){Y_(window,"selectstart",ev)},g_=function(){q_(window,"selectstart",ev)};else{var B_=z_(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);f_=function(){if(B_){var t=document.documentElement.style;__=t[B_],t[B_]="none"}},g_=function(){B_&&(document.documentElement.style[B_]=__,__=void 0)}}function F_(){Y_(window,"dragstart",ev)}function N_(){q_(window,"dragstart",ev)}function H_(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(V_(),v_=t,y_=t.style.outlineStyle,t.style.outlineStyle="none",Y_(window,"keydown",V_))}function V_(){v_&&(v_.style.outlineStyle=y_,v_=void 0,y_=void 0,q_(window,"keydown",V_))}function U_(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}function Y_(t,e,i,r){if(e&&"object"==typeof e)for(var n in e)X_(t,n,e[n],i);else for(var a=0,s=(e=Df(e)).length;a<s;a++)X_(t,e[a],i,r);return this}var Z_="_leaflet_events";function q_(t,e,i,r){if(1===arguments.length)W_(t),delete t[Z_];else if(e&&"object"==typeof e)for(var n in e)K_(t,n,e[n],i);else if(e=Df(e),2===arguments.length)W_(t,(function(t){return-1!==Ff(e,t)}));else for(var a=0,s=e.length;a<s;a++)K_(t,e[a],i,r);return this}function W_(t,e){for(var i in t[Z_]){var r=i.split(/\d/)[0];e&&!e(r)||K_(t,r,null,null,i)}}var G_={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function X_(t,e,i,r){var n=e+Mf(i)+(r?"_"+Mf(r):"");if(t[Z_]&&t[Z_][n])return this;var a=function(e){return i.call(r||t,e||window.event)},s=a;!t_.touchNative&&t_.pointer&&0===e.indexOf("touch")?a=c_(t,e,a):t_.touch&&"dblclick"===e?a=function(t,e){t.addEventListener("dblclick",e);var i,r=0;function n(t){if(1===t.detail){if("mouse"!==t.pointerType&&(!t.sourceCapabilities||t.sourceCapabilities.firesTouchEvents)){var n=function(t){if(t.composedPath)return t.composedPath();for(var e=[],i=t.target;i;)e.push(i),i=i.parentNode;return e}(t);if(!n.some((function(t){return t instanceof HTMLLabelElement&&t.attributes.for}))||n.some((function(t){return t instanceof HTMLInputElement||t instanceof HTMLSelectElement}))){var a=Date.now();a-r<=m_?2==++i&&e(function(t){var e,i,r={};for(i in t)e=t[i],r[i]=e&&e.bind?e.bind(t):e;return t=r,r.type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r}(t)):i=1,r=a}}}else i=t.detail}return t.addEventListener("click",n),{dblclick:e,simDblclick:n}}(t,a):"addEventListener"in t?"touchstart"===e||"touchmove"===e||"wheel"===e||"mousewheel"===e?t.addEventListener(G_[e]||e,a,!!t_.passiveEvents&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?(a=function(e){e=e||window.event,nv(t,e)&&s(e)},t.addEventListener(G_[e],a,!1)):t.addEventListener(e,s,!1):t.attachEvent("on"+e,a),t[Z_]=t[Z_]||{},t[Z_][n]=a}function K_(t,e,i,r,n){n=n||e+Mf(i)+(r?"_"+Mf(r):"");var a=t[Z_]&&t[Z_][n];if(!a)return this;!t_.touchNative&&t_.pointer&&0===e.indexOf("touch")?function(t,e,i){a_[e]?t.removeEventListener(a_[e],i,!1):console.warn("wrong event specified:",e)}(t,e,a):t_.touch&&"dblclick"===e?function(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}(t,a):"removeEventListener"in t?t.removeEventListener(G_[e]||e,a,!1):t.detachEvent("on"+e,a),t[Z_][n]=null}function J_(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Q_(t){return X_(t,"wheel",J_),this}function tv(t){return Y_(t,"mousedown touchstart dblclick contextmenu",J_),t._leaflet_disable_click=!0,this}function ev(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function iv(t){return ev(t),J_(t),this}var rv=t_.linux&&t_.chrome?window.devicePixelRatio:t_.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function nv(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t}var av=Kf.extend({run:function(t,e,i,r){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(r||.5,.2),this._startPos=O_(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=qf(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),j_(this._el,i),this.fire("step")},_complete:function(){Wf(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),sv=Kf.extend({options:{crs:mg,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=jf(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=Af(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(sg(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=x_&&t_.any3d&&!t_.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Y_(this._proxy,w_,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,i){if((e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(sg(t),e,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i)&&(void 0!==i.animate&&(i.zoom=Ef({animate:i.animate},i.zoom),i.pan=Ef({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(t,e,i.pan&&i.pan.noMoveStart),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(t_.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(t_.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var r=this.getZoomScale(e),n=this.getSize().divideBy(2),a=(t instanceof Jf?t:this.latLngToContainerPoint(t)).subtract(n).multiplyBy(1-1/r),s=this.containerPointToLatLng(n.add(a));return this.setView(s,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():ng(t);var i=tg(e.paddingTopLeft||e.padding||[0,0]),r=tg(e.paddingBottomRight||e.padding||[0,0]),n=this.getBoundsZoom(t,!1,i.add(r));if((n="number"==typeof e.maxZoom?Math.min(e.maxZoom,n):n)===1/0)return{center:t.getCenter(),zoom:n};var a=r.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),n),o=this.project(t.getNorthEast(),n);return{center:this.unproject(s.add(o).divideBy(2).add(a),n),zoom:n}},fitBounds:function(t,e){if(!(t=ng(t)).isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=tg(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new av,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){I_(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){if(!1===(i=i||{}).animate||!t_.any3d)return this.setView(t,e,i);this._stop();var r=this.project(this.getCenter()),n=this.project(t),a=this.getSize(),s=this._zoom;t=sg(t),e=void 0===e?s:e;var o=Math.max(a.x,a.y),l=o*this.getZoomScale(s,e),c=n.distanceTo(r)||1,d=1.42,h=d*d;function p(t){var e=(l*l-o*o+(t?-1:1)*h*h*c*c)/(2*(t?l:o)*h*c),i=Math.sqrt(e*e+1)-e;return i<1e-9?-18:Math.log(i)}function u(t){return(Math.exp(t)-Math.exp(-t))/2}function m(t){return(Math.exp(t)+Math.exp(-t))/2}var f=p(0);function g(t){return o*(m(f)*function(t){return u(t)/m(t)}(f+d*t)-u(f))/h}var _=Date.now(),v=(p(1)-f)/d,y=i.duration?1e3*i.duration:1e3*v*.8;return this._moveStart(!0,i.noMoveStart),function i(){var a=(Date.now()-_)/y,l=function(t){return 1-Math.pow(1-t,1.5)}(a)*v;a<=1?(this._flyToFrame=qf(i,this),this._move(this.unproject(r.add(n.subtract(r).multiplyBy(g(l)/c)),s),this.getScaleZoom(o/function(t){return o*(m(f)/m(f+d*t))}(l),s),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return t=ng(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),r=this._limitCenter(i,this._zoom,ng(t));return i.equals(r)||this.panTo(r,e),this._enforcingBounds=!1,this},panInside:function(t,e){var i=tg((e=e||{}).paddingTopLeft||e.padding||[0,0]),r=tg(e.paddingBottomRight||e.padding||[0,0]),n=this.project(this.getCenter()),a=this.project(t),s=this.getPixelBounds(),o=ig([s.min.add(i),s.max.subtract(r)]),l=o.getSize();if(!o.contains(a)){this._enforcingBounds=!0;var c=a.subtract(o.getCenter()),d=o.extend(a).getSize().subtract(l);n.x+=c.x<0?-d.x:d.x,n.y+=c.y<0?-d.y:d.y,this.panTo(this.unproject(n),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=Ef({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),r=e.divideBy(2).round(),n=i.divideBy(2).round(),a=r.subtract(n);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(Af(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=Ef({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=Af(this._handleGeolocationResponse,this),i=Af(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=new ag(t.coords.latitude,t.coords.longitude),i=e.toBounds(2*t.coords.accuracy),r=this._locateOptions;if(r.setView){var n=this.getBoundsZoom(i);this.setView(e,r.maxZoom?Math.min(n,r.maxZoom):n)}var a={latlng:e,bounds:i,timestamp:t.timestamp};for(var s in t.coords)"number"==typeof t.coords[s]&&(a[s]=t.coords[s]);this.fire("locationfound",a)}},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),S_(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Wf(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)S_(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var i=T_("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new rg(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=ng(t),i=tg(i||[0,0]);var r=this.getZoom()||0,n=this.getMinZoom(),a=this.getMaxZoom(),s=t.getNorthWest(),o=t.getSouthEast(),l=this.getSize().subtract(i),c=ig(this.project(o,r),this.project(s,r)).getSize(),d=t_.any3d?this.options.zoomSnap:1,h=l.x/c.x,p=l.y/c.y,u=e?Math.max(h,p):Math.min(h,p);return r=this.getScaleZoom(u,r),d&&(r=Math.round(r/(d/100))*(d/100),r=e?Math.ceil(r/d)*d:Math.floor(r/d)*d),Math.max(n,Math.min(a,r))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new Jf(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new eg(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=void 0===e?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=void 0===e?this._zoom:e;var r=i.zoom(t*i.scale(e));return isNaN(r)?1/0:r},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(sg(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(tg(t),e)},layerPointToLatLng:function(t){var e=tg(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(sg(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(sg(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(ng(t))},distance:function(t,e){return this.options.crs.distance(sg(t),sg(e))},containerPointToLayerPoint:function(t){return tg(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return tg(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(tg(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(sg(t)))},mouseEventToContainerPoint:function(t){return function(t,e){if(!e)return new Jf(t.clientX,t.clientY);var i=U_(e),r=i.boundingClientRect;return new Jf((t.clientX-r.left)/i.x-e.clientLeft,(t.clientY-r.top)/i.y-e.clientTop)}(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=function(t){return"string"==typeof t?document.getElementById(t):t}(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Y_(e,"scroll",this._onScroll,this),this._containerId=Mf(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&t_.any3d,I_(t,"leaflet-container"+(t_.touch?" leaflet-touch":"")+(t_.retina?" leaflet-retina":"")+(t_.ielt9?" leaflet-oldie":"")+(t_.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=k_(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&"sticky"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),j_(this._mapPane,new Jf(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(I_(t.markerPane,"leaflet-zoom-hide"),I_(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,i){j_(this._mapPane,new Jf(0,0));var r=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var n=this._zoom!==e;this._moveStart(n,i)._move(t,e)._moveEnd(n),this.fire("viewreset"),r&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,i,r){void 0===e&&(e=this._zoom);var n=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),r?i&&i.pinch&&this.fire("zoom",i):((n||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Wf(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){j_(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[Mf(this._container)]=this;var e=t?q_:Y_;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),t_.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Wf(this._resizeRequest),this._resizeRequest=qf((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,r=[],n="mouseout"===e||"mouseover"===e,a=t.target||t.srcElement,s=!1;a;){if((i=this._targets[Mf(a)])&&("click"===e||"preclick"===e)&&this._draggableMoved(i)){s=!0;break}if(i&&i.listens(e,!0)){if(n&&!nv(a,t))break;if(r.push(i),n)break}if(a===this._container)break;a=a.parentNode}return r.length||s||n||!this.listens(e,!0)||(r=[this]),r},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||"click"===t.type&&this._isClickDisabled(e))){var i=t.type;"mousedown"===i&&H_(e),this._fireDOMEvent(t,i)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,i){if("click"===t.type){var r=Ef({},t);r.type="preclick",this._fireDOMEvent(r,r.type,i)}var n=this._findEventTargets(t,e);if(i){for(var a=[],s=0;s<i.length;s++)i[s].listens(e,!0)&&a.push(i[s]);n=a.concat(n)}if(n.length){"contextmenu"===e&&ev(t);var o=n[0],l={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var c=o.getLatLng&&(!o._radius||o._radius<=10);l.containerPoint=c?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),l.layerPoint=this.containerPointToLayerPoint(l.containerPoint),l.latlng=c?o.getLatLng():this.layerPointToLatLng(l.layerPoint)}for(s=0;s<n.length;s++)if(n[s].fire(e,l,!0),l.originalEvent._stopped||!1===n[s].options.bubblingMouseEvents&&-1!==Ff(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return O_(this._mapPane)||new Jf(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var r=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(r)},_latLngBoundsToNewLayerBounds:function(t,e,i){var r=this._getNewPixelOrigin(i,e);return ig([this.project(t.getSouthWest(),e)._subtract(r),this.project(t.getNorthWest(),e)._subtract(r),this.project(t.getSouthEast(),e)._subtract(r),this.project(t.getNorthEast(),e)._subtract(r)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var r=this.project(t,e),n=this.getSize().divideBy(2),a=new eg(r.subtract(n),r.add(n)),s=this._getBoundsOffset(a,i,e);return Math.abs(s.x)<=1&&Math.abs(s.y)<=1?t:this.unproject(r.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),r=new eg(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(r,e))},_getBoundsOffset:function(t,e,i){var r=ig(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),n=r.min.subtract(t.min),a=r.max.subtract(t.max);return new Jf(this._rebound(n.x,-a.x),this._rebound(n.y,-a.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),r=t_.any3d?this.options.zoomSnap:1;return r&&(t=Math.round(t/r)*r),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){M_(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i))&&(this.panBy(i,e),!0)},_createAnimProxy:function(){var t=this._proxy=T_("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=b_,i=this._proxy.style[e];D_(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),i===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){S_(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();D_(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var r=this.getZoomScale(e),n=this._getCenterOffset(t)._divideBy(1-1/r);return!(!0!==i.animate&&!this.getSize().contains(n))&&(qf((function(){this._moveStart(!0,i.noMoveStart||!1)._animateZoom(t,e,!0)}),this),!0)},_animateZoom:function(t,e,i,r){this._mapPane&&(i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,I_(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:r}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(Af(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&M_(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}}),ov=Gf.extend({options:{position:"topright"},initialize:function(t){jf(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),r=t._controlCorners[i];return I_(e,"leaflet-control"),-1!==i.indexOf("bottom")?r.insertBefore(e,r.firstChild):r.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(S_(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}});sv.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",i=this._controlContainer=T_("div",e+"control-container",this._container);function r(r,n){var a=e+r+" "+e+n;t[r+n]=T_("div",a,i)}r("top","left"),r("top","right"),r("bottom","left"),r("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)S_(this._controlCorners[t]);S_(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var lv=ov.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,r){return i<r?-1:r<i?1:0}},initialize:function(t,e,i){for(var r in jf(this,i),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,t)this._addLayer(t[r],r);for(r in e)this._addLayer(e[r],r,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return ov.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(Mf(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){I_(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(I_(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):M_(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return M_(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=T_("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),tv(e),Q_(e);var r=this._section=T_("section",t+"-list");i&&(this._map.on("click",this.collapse,this),Y_(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var n=this._layersLink=T_("a",t+"-toggle",e);n.href="#",n.title="Layers",n.setAttribute("role","button"),Y_(n,{keydown:function(t){13===t.keyCode&&this._expandSafely()},click:function(t){ev(t),this._expandSafely()}},this),i||this.expand(),this._baseLayersList=T_("div",t+"-base",r),this._separator=T_("div",t+"-separator",r),this._overlaysList=T_("div",t+"-overlays",r),e.appendChild(r)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&Mf(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(Af((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;C_(this._baseLayersList),C_(this._overlaysList),this._layerControlInputs=[];var t,e,i,r,n=0;for(i=0;i<this._layers.length;i++)r=this._layers[i],this._addItem(r),e=e||r.overlay,t=t||!r.overlay,n+=r.overlay?0:1;return this.options.hideSingleBase&&(t=t&&n>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(Mf(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",r=document.createElement("div");return r.innerHTML=i,r.firstChild},_addItem:function(t){var e,i=document.createElement("label"),r=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=r):e=this._createRadioElement("leaflet-base-layers_"+Mf(this),r),this._layerControlInputs.push(e),e.layerId=Mf(t.layer),Y_(e,"click",this._onInputClick,this);var n=document.createElement("span");n.innerHTML=" "+t.name;var a=document.createElement("span");return i.appendChild(a),a.appendChild(e),a.appendChild(n),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){if(!this._preventClick){var t,e,i=this._layerControlInputs,r=[],n=[];this._handlingClick=!0;for(var a=i.length-1;a>=0;a--)t=i[a],e=this._getLayer(t.layerId).layer,t.checked?r.push(e):t.checked||n.push(e);for(a=0;a<n.length;a++)this._map.hasLayer(n[a])&&this._map.removeLayer(n[a]);for(a=0;a<r.length;a++)this._map.hasLayer(r[a])||this._map.addLayer(r[a]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t,e,i=this._layerControlInputs,r=this._map.getZoom(),n=i.length-1;n>=0;n--)t=i[n],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&r<e.options.minZoom||void 0!==e.options.maxZoom&&r>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,Y_(t,"click",ev),this.expand();var e=this;setTimeout((function(){q_(t,"click",ev),e._preventClick=!1}))}}),cv=ov.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=T_("div",e+" leaflet-bar"),r=this.options;return this._zoomInButton=this._createButton(r.zoomInText,r.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(r.zoomOutText,r.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,r,n){var a=T_("a",i,r);return a.innerHTML=t,a.href="#",a.title=e,a.setAttribute("role","button"),a.setAttribute("aria-label",e),tv(a),Y_(a,"click",iv),Y_(a,"click",n,this),Y_(a,"click",this._refocusOnMap,this),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";M_(this._zoomInButton,e),M_(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(I_(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(I_(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});sv.mergeOptions({zoomControl:!0}),sv.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new cv,this.addControl(this.zoomControl))}));var dv=ov.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=T_("div",e),r=this.options;return this._addScales(r,e+"-line",i),t.on(r.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=T_("div",e,i)),t.imperial&&(this._iScale=T_("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,r,n=3.2808399*t;n>5280?(e=n/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(r=this._getRoundNum(n),this._updateScale(this._iScale,r+" ft",r/n))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return e*(i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1)}}),hv=ov.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(t_.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(t){jf(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=T_("div","leaflet-control-attribution"),tv(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",(function(){this.removeAttribution(t.layer.getAttribution())}),this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(' <span aria-hidden="true">|</span> ')}}});sv.mergeOptions({attributionControl:!0}),sv.addInitHook((function(){this.options.attributionControl&&(new hv).addTo(this)})),ov.Layers=lv,ov.Zoom=cv,ov.Scale=dv,ov.Attribution=hv;var pv=Gf.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});pv.addTo=function(t,e){return t.addHandler(e,this),this};var uv,mv=t_.touch?"touchstart mousedown":"mousedown",fv=Kf.extend({options:{clickTolerance:3},initialize:function(t,e,i,r){jf(this,r),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(Y_(this._dragStartTarget,mv,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(fv._dragging===this&&this.finishDrag(!0),q_(this._dragStartTarget,mv,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!A_(this._element,"leaflet-zoom-anim")))if(t.touches&&1!==t.touches.length)fv._dragging===this&&this.finishDrag();else if(!(fv._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(fv._dragging=this,this._preventOutline&&H_(this._element),F_(),f_(),this._moving))){this.fire("down");var e=t.touches?t.touches[0]:t,i=function(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}(this._element);this._startPoint=new Jf(e.clientX,e.clientY),this._startPos=O_(this._element),this._parentScale=U_(i);var r="mousedown"===t.type;Y_(document,r?"mousemove":"touchmove",this._onMove,this),Y_(document,r?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(t){if(this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new Jf(e.clientX,e.clientY)._subtract(this._startPoint);(i.x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,ev(t),this._moved||(this.fire("dragstart"),this._moved=!0,I_(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),I_(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,this._lastEvent=t,this._updatePosition()))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),j_(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){M_(document.body,"leaflet-dragging"),this._lastTarget&&(M_(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),q_(document,"mousemove touchmove",this._onMove,this),q_(document,"mouseup touchend touchcancel",this._onUp,this),N_(),g_();var e=this._moved&&this._moving;this._moving=!1,fv._dragging=!1,e&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function gv(t,e,i){var r,n,a,s,o,l,c,d,h,p=[1,4,2,8];for(n=0,c=t.length;n<c;n++)t[n]._code=kv(t[n],e);for(s=0;s<4;s++){for(d=p[s],r=[],n=0,a=(c=t.length)-1;n<c;a=n++)o=t[n],l=t[a],o._code&d?l._code&d||((h=wv(l,o,d,e,i))._code=kv(h,e),r.push(h)):(l._code&d&&((h=wv(l,o,d,e,i))._code=kv(h,e),r.push(h)),r.push(o));t=r}return t}function _v(t){for(var e=0,i=0,r=0,n=0;n<t.length;n++){var a=sg(t[n]);e+=a.lat,i+=a.lng,r++}return sg([e/r,i/r])}function vv(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=function(t,e){for(var i=[t[0]],r=1,n=0,a=t.length;r<a;r++)Tv(t[r],t[n])>e&&(i.push(t[r]),n=r);n<a-1&&i.push(t[a-1]);return i}(t,i),t=function(t,e){var i=t.length,r=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(i);r[0]=r[i-1]=1,bv(t,r,e,0,i-1);var n,a=[];for(n=0;n<i;n++)r[n]&&a.push(t[n]);return a}(t,i),t}function yv(t,e,i){return Math.sqrt(Sv(t,e,i,!0))}function bv(t,e,i,r,n){var a,s,o,l=0;for(s=r+1;s<=n-1;s++)(o=Sv(t[s],t[r],t[n],!0))>l&&(a=s,l=o);l>i&&(e[a]=1,bv(t,e,i,r,a),bv(t,e,i,a,n))}function xv(t,e,i,r,n){var a,s,o,l=r?uv:kv(t,i),c=kv(e,i);for(uv=c;;){if(!(l|c))return[t,e];if(l&c)return!1;o=kv(s=wv(t,e,a=l||c,i,n),i),a===l?(t=s,l=o):(e=s,c=o)}}function wv(t,e,i,r,n){var a,s,o=e.x-t.x,l=e.y-t.y,c=r.min,d=r.max;return 8&i?(a=t.x+o*(d.y-t.y)/l,s=d.y):4&i?(a=t.x+o*(c.y-t.y)/l,s=c.y):2&i?(a=d.x,s=t.y+l*(d.x-t.x)/o):1&i&&(a=c.x,s=t.y+l*(c.x-t.x)/o),new Jf(a,s,n)}function kv(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function Tv(t,e){var i=e.x-t.x,r=e.y-t.y;return i*i+r*r}function Sv(t,e,i,r){var n,a=e.x,s=e.y,o=i.x-a,l=i.y-s,c=o*o+l*l;return c>0&&((n=((t.x-a)*o+(t.y-s)*l)/c)>1?(a=i.x,s=i.y):n>0&&(a+=o*n,s+=l*n)),o=t.x-a,l=t.y-s,r?o*o+l*l:new Jf(a,s)}function Cv(t){return!Bf(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}var Ev={project:function(t){return new Jf(t.lng,t.lat)},unproject:function(t){return new ag(t.y,t.x)},bounds:new eg([-180,-90],[180,90])},$v={R:6378137,R_MINOR:6356752.314245179,bounds:new eg([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,r=t.lat*e,n=this.R_MINOR/i,a=Math.sqrt(1-n*n),s=a*Math.sin(r),o=Math.tan(Math.PI/4-r/2)/Math.pow((1-s)/(1+s),a/2);return r=-i*Math.log(Math.max(o,1e-10)),new Jf(t.lng*e*i,r)},unproject:function(t){for(var e,i=180/Math.PI,r=this.R,n=this.R_MINOR/r,a=Math.sqrt(1-n*n),s=Math.exp(-t.y/r),o=Math.PI/2-2*Math.atan(s),l=0,c=.1;l<15&&Math.abs(c)>1e-7;l++)e=a*Math.sin(o),e=Math.pow((1-e)/(1+e),a/2),o+=c=Math.PI/2-2*Math.atan(s*e)-o;return new ag(o*i,t.x*i/r)}},Av=Ef({},lg,{code:"EPSG:3395",projection:$v,transformation:function(){var t=.5/(Math.PI*$v.R);return pg(t,.5,-t,.5)}()}),Iv=Ef({},lg,{code:"EPSG:4326",projection:Ev,transformation:pg(1/180,1,-1/180,.5)}),Mv=Ef({},og,{projection:Ev,transformation:pg(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,r=e.lat-t.lat;return Math.sqrt(i*i+r*r)},infinite:!0});og.Earth=lg,og.EPSG3395=Av,og.EPSG3857=mg,og.EPSG900913=fg,og.EPSG4326=Iv,og.Simple=Mv;var Lv=Kf.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[Mf(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[Mf(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",(function(){e.off(i,this)}),this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});sv.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=Mf(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=Mf(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return Mf(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){for(var e=0,i=(t=t?Bf(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[Mf(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=Mf(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var r in this._zoomBoundLayers){var n=this._zoomBoundLayers[r].options;t=void 0===n.minZoom?t:Math.min(t,n.minZoom),e=void 0===n.maxZoom?e:Math.max(e,n.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Pv=Lv.extend({initialize:function(t,e){var i,r;if(jf(this,e),this._layers={},t)for(i=0,r=t.length;i<r;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,i,r=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,r);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return Mf(t)}}),Rv=Pv.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Pv.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Pv.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new rg;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),zv=Gf.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){jf(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var r=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(r,t),(this.options.crossOrigin||""===this.options.crossOrigin)&&(r.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),r},_setIconStyles:function(t,e){var i=this.options,r=i[e+"Size"];"number"==typeof r&&(r=[r,r]);var n=tg(r),a=tg("shadow"===e&&i.shadowAnchor||i.iconAnchor||n&&n.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),a&&(t.style.marginLeft=-a.x+"px",t.style.marginTop=-a.y+"px"),n&&(t.style.width=n.x+"px",t.style.height=n.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return t_.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),Dv=zv.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return"string"!=typeof Dv.imagePath&&(Dv.imagePath=this._detectIconPath()),(this.options.imagePath||Dv.imagePath)+zv.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(t,e,i){var r=e.exec(t);return r&&r[i]};return(t=e(t,/^url\((['"])?(.+)\1\)$/,2))&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=T_("div","leaflet-default-icon-path",document.body),e=k_(t,"background-image")||k_(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e))return e;var i=document.querySelector('link[href$="leaflet.css"]');return i?i.href.substring(0,i.href.length-11-1):""}}),jv=pv.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new fv(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),I_(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&M_(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,r=this._marker.options.autoPanSpeed,n=this._marker.options.autoPanPadding,a=O_(e._icon),s=i.getPixelBounds(),o=i.getPixelOrigin(),l=ig(s.min._subtract(o).add(n),s.max._subtract(o).subtract(n));if(!l.contains(a)){var c=tg((Math.max(l.max.x,a.x)-l.max.x)/(s.max.x-l.max.x)-(Math.min(l.min.x,a.x)-l.min.x)/(s.min.x-l.min.x),(Math.max(l.max.y,a.y)-l.max.y)/(s.max.y-l.max.y)-(Math.min(l.min.y,a.y)-l.min.y)/(s.min.y-l.min.y)).multiplyBy(r);i.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),j_(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=qf(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(Wf(this._panRequest),this._panRequest=qf(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,r=O_(e._icon),n=e._map.layerPointToLatLng(r);i&&j_(i,r),e._latlng=n,t.latlng=n,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){Wf(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Ov=Lv.extend({options:{icon:new Dv,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){jf(this,e),this._latlng=sg(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=sg(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),r=!1;i!==this._icon&&(this._icon&&this._removeIcon(),r=!0,t.title&&(i.title=t.title),"IMG"===i.tagName&&(i.alt=t.alt||"")),I_(i,e),t.keyboard&&(i.tabIndex="0",i.setAttribute("role","button")),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Y_(i,"focus",this._panOnFocus,this);var n=t.icon.createShadow(this._shadow),a=!1;n!==this._shadow&&(this._removeShadow(),a=!0),n&&(I_(n,e),n.alt=""),this._shadow=n,t.opacity<1&&this._updateOpacity(),r&&this.getPane().appendChild(this._icon),this._initInteraction(),n&&a&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&q_(this._icon,"focus",this._panOnFocus,this),S_(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&S_(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&j_(this._icon,t),this._shadow&&j_(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(I_(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),jv)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new jv(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&R_(this._icon,t),this._shadow&&R_(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,i=e.iconSize?tg(e.iconSize):tg(0,0),r=e.iconAnchor?tg(e.iconAnchor):tg(0,0);t.panInside(this._latlng,{paddingTopLeft:r,paddingBottomRight:i.subtract(r)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),Bv=Lv.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return jf(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Fv=Bv.extend({options:{fill:!0,radius:10},initialize:function(t,e){jf(this,e),this._latlng=sg(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=sg(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Bv.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),r=[t+i,e+i];this._pxBounds=new eg(this._point.subtract(r),this._point.add(r))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Nv=Fv.extend({initialize:function(t,e,i){if("number"==typeof e&&(e=Ef({},i,{radius:e})),jf(this,e),this._latlng=sg(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new rg(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Bv.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,r=i.options.crs;if(r.distance===lg.distance){var n=Math.PI/180,a=this._mRadius/lg.R/n,s=i.project([e+a,t]),o=i.project([e-a,t]),l=s.add(o).divideBy(2),c=i.unproject(l).lat,d=Math.acos((Math.cos(a*n)-Math.sin(e*n)*Math.sin(c*n))/(Math.cos(e*n)*Math.cos(c*n)))/n;(isNaN(d)||0===d)&&(d=a/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(d)?0:l.x-i.project([c,t-d]).x,this._radiusY=l.y-s.y}else{var h=r.unproject(r.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(h).x}this._updateBounds()}}),Hv=Bv.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){jf(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,r=1/0,n=null,a=Sv,s=0,o=this._parts.length;s<o;s++)for(var l=this._parts[s],c=1,d=l.length;c<d;c++){var h=a(t,e=l[c-1],i=l[c],!0);h<r&&(r=h,n=a(t,e,i))}return n&&(n.distance=Math.sqrt(r)),n},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return function(t,e){var i,r,n,a,s,o,l,c;if(!t||0===t.length)throw new Error("latlngs not passed");Cv(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var d=sg([0,0]),h=ng(t);h.getNorthWest().distanceTo(h.getSouthWest())*h.getNorthEast().distanceTo(h.getNorthWest())<1700&&(d=_v(t));var p=t.length,u=[];for(i=0;i<p;i++){var m=sg(t[i]);u.push(e.project(sg([m.lat-d.lat,m.lng-d.lng])))}for(i=0,r=0;i<p-1;i++)r+=u[i].distanceTo(u[i+1])/2;if(0===r)c=u[0];else for(i=0,a=0;i<p-1;i++)if(s=u[i],o=u[i+1],(a+=n=s.distanceTo(o))>r){l=(a-r)/n,c=[o.x-l*(o.x-s.x),o.y-l*(o.y-s.y)];break}var f=e.unproject(tg(c));return sg([f.lat+d.lat,f.lng+d.lng])}(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=sg(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new rg,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Cv(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=Cv(t),r=0,n=t.length;r<n;r++)i?(e[r]=sg(t[r]),this._bounds.extend(e[r])):e[r]=this._convertLatLngs(t[r]);return e},_project:function(){var t=new eg;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new Jf(t,t);this._rawPxBounds&&(this._pxBounds=new eg([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,i){var r,n,a=t[0]instanceof ag,s=t.length;if(a){for(n=[],r=0;r<s;r++)n[r]=this._map.latLngToLayerPoint(t[r]),i.extend(n[r]);e.push(n)}else for(r=0;r<s;r++)this._projectLatlngs(t[r],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,i,r,n,a,s,o,l=this._parts;for(e=0,r=0,n=this._rings.length;e<n;e++)for(i=0,a=(o=this._rings[e]).length;i<a-1;i++)(s=xv(o[i],o[i+1],t,i,!0))&&(l[r]=l[r]||[],l[r].push(s[0]),s[1]===o[i+1]&&i!==a-2||(l[r].push(s[1]),r++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,r=t.length;i<r;i++)t[i]=vv(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,r,n,a,s,o,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,a=this._parts.length;i<a;i++)for(r=0,n=(s=(o=this._parts[i]).length)-1;r<s;n=r++)if((e||0!==r)&&yv(t,o[n],o[r])<=l)return!0;return!1}});Hv._flat=function(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Cv(t)};var Vv=Hv.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return function(t,e){var i,r,n,a,s,o,l,c,d;if(!t||0===t.length)throw new Error("latlngs not passed");Cv(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var h=sg([0,0]),p=ng(t);p.getNorthWest().distanceTo(p.getSouthWest())*p.getNorthEast().distanceTo(p.getNorthWest())<1700&&(h=_v(t));var u=t.length,m=[];for(i=0;i<u;i++){var f=sg(t[i]);m.push(e.project(sg([f.lat-h.lat,f.lng-h.lng])))}for(o=l=c=0,i=0,r=u-1;i<u;r=i++)n=m[i],a=m[r],s=n.y*a.x-a.y*n.x,l+=(n.x+a.x)*s,c+=(n.y+a.y)*s,o+=3*s;d=0===o?m[0]:[l/o,c/o];var g=e.unproject(tg(d));return sg([g.lat+h.lat,g.lng+h.lng])}(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=Hv.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof ag&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){Hv.prototype._setLatLngs.call(this,t),Cv(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Cv(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new Jf(e,e);if(t=new eg(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var r,n=0,a=this._rings.length;n<a;n++)(r=gv(this._rings[n],t,!0)).length&&this._parts.push(r)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,i,r,n,a,s,o,l,c=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,o=this._parts.length;n<o;n++)for(a=0,s=(l=(e=this._parts[n]).length)-1;a<l;s=a++)i=e[a],r=e[s],i.y>t.y!=r.y>t.y&&t.x<(r.x-i.x)*(t.y-i.y)/(r.y-i.y)+i.x&&(c=!c);return c||Hv.prototype._containsPoint.call(this,t,!0)}}),Uv=Rv.extend({initialize:function(t,e){jf(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,r,n=Bf(t)?t:t.features;if(n){for(e=0,i=n.length;e<i;e++)((r=n[e]).geometries||r.geometry||r.features||r.coordinates)&&this.addData(r);return this}var a=this.options;if(a.filter&&!a.filter(t))return this;var s=Yv(t,a);return s?(s.feature=Jv(t),s.defaultOptions=s.options,this.resetStyle(s),a.onEachFeature&&a.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=Ef({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function Yv(t,e){var i,r,n,a,s="Feature"===t.type?t.geometry:t,o=s?s.coordinates:null,l=[],c=e&&e.pointToLayer,d=e&&e.coordsToLatLng||qv;if(!o&&!s)return null;switch(s.type){case"Point":return Zv(c,t,i=d(o),e);case"MultiPoint":for(n=0,a=o.length;n<a;n++)i=d(o[n]),l.push(Zv(c,t,i,e));return new Rv(l);case"LineString":case"MultiLineString":return r=Wv(o,"LineString"===s.type?0:1,d),new Hv(r,e);case"Polygon":case"MultiPolygon":return r=Wv(o,"Polygon"===s.type?1:2,d),new Vv(r,e);case"GeometryCollection":for(n=0,a=s.geometries.length;n<a;n++){var h=Yv({geometry:s.geometries[n],type:"Feature",properties:t.properties},e);h&&l.push(h)}return new Rv(l);case"FeatureCollection":for(n=0,a=s.features.length;n<a;n++){var p=Yv(s.features[n],e);p&&l.push(p)}return new Rv(l);default:throw new Error("Invalid GeoJSON object.")}}function Zv(t,e,i,r){return t?t(e,i):new Ov(i,r&&r.markersInheritOptions&&r)}function qv(t){return new ag(t[1],t[0],t[2])}function Wv(t,e,i){for(var r,n=[],a=0,s=t.length;a<s;a++)r=e?Wv(t[a],e-1,i):(i||qv)(t[a]),n.push(r);return n}function Gv(t,e){return void 0!==(t=sg(t)).alt?[Rf(t.lng,e),Rf(t.lat,e),Rf(t.alt,e)]:[Rf(t.lng,e),Rf(t.lat,e)]}function Xv(t,e,i,r){for(var n=[],a=0,s=t.length;a<s;a++)n.push(e?Xv(t[a],Cv(t[a])?0:e-1,i,r):Gv(t[a],r));return!e&&i&&n.length>0&&n.push(n[0].slice()),n}function Kv(t,e){return t.feature?Ef({},t.feature,{geometry:e}):Jv(e)}function Jv(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Qv={toGeoJSON:function(t){return Kv(this,{type:"Point",coordinates:Gv(this.getLatLng(),t)})}};Ov.include(Qv),Nv.include(Qv),Fv.include(Qv),Hv.include({toGeoJSON:function(t){var e=!Cv(this._latlngs);return Kv(this,{type:(e?"Multi":"")+"LineString",coordinates:Xv(this._latlngs,e?1:0,!1,t)})}}),Vv.include({toGeoJSON:function(t){var e=!Cv(this._latlngs),i=e&&!Cv(this._latlngs[0]),r=Xv(this._latlngs,i?2:e?1:0,!0,t);return e||(r=[r]),Kv(this,{type:(i?"Multi":"")+"Polygon",coordinates:r})}}),Pv.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(i){e.push(i.toGeoJSON(t).geometry.coordinates)})),Kv(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var i="GeometryCollection"===e,r=[];return this.eachLayer((function(e){if(e.toGeoJSON){var n=e.toGeoJSON(t);if(i)r.push(n.geometry);else{var a=Jv(n);"FeatureCollection"===a.type?r.push.apply(r,a.features):r.push(a)}}})),i?Kv(this,{geometries:r,type:"GeometryCollection"}):{type:"FeatureCollection",features:r}}});var ty=Lv.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,i){this._url=t,this._bounds=ng(e),jf(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(I_(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){S_(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&E_(this._image),this},bringToBack:function(){return this._map&&$_(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=ng(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:T_("img");I_(e,"leaflet-image-layer"),this._zoomAnimated&&I_(e,"leaflet-zoom-animated"),this.options.className&&I_(e,this.options.className),e.onselectstart=Pf,e.onmousemove=Pf,e.onload=Af(this.fire,this,"load"),e.onerror=Af(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;D_(this._image,i,e)},_reset:function(){var t=this._image,e=new eg(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();j_(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){R_(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),ey=function(t,e,i){return new ty(t,e,i)};ty.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:T_("video");if(I_(e,"leaflet-image-layer"),this._zoomAnimated&&I_(e,"leaflet-zoom-animated"),this.options.className&&I_(e,this.options.className),e.onselectstart=Pf,e.onmousemove=Pf,e.onloadeddata=Af(this.fire,this,"load"),t){for(var i=e.getElementsByTagName("source"),r=[],n=0;n<i.length;n++)r.push(i[n].src);this._url=i.length>0?r:[e.src]}else{Bf(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var a=0;a<this._url.length;a++){var s=T_("source");s.src=this._url[a],e.appendChild(s)}}}}),ty.extend({_initImage:function(){var t=this._image=this._url;I_(t,"leaflet-image-layer"),this._zoomAnimated&&I_(t,"leaflet-zoom-animated"),this.options.className&&I_(t,this.options.className),t.onselectstart=Pf,t.onmousemove=Pf}});var iy=Lv.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof ag||Bf(t))?(this._latlng=sg(t),jf(this,e)):(jf(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return(t=arguments.length?t:this._source._map).hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&R_(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&R_(this._container,1),this.bringToFront(),this.options.interactive&&(I_(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(R_(this._container,0),this._removeTimeout=setTimeout(Af(S_,void 0,this._container),200)):S_(this._container),this.options.interactive&&(M_(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=sg(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&E_(this._container),this},bringToBack:function(){return this._map&&$_(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof Rv){e=null;var i=this._source._layers;for(var r in i)if(i[r]._map){e=i[r];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else{if(!e.getBounds)throw new Error("Unable to get source layer LatLng.");t=e.getBounds().getCenter()}return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=tg(this.options.offset),i=this._getAnchor();this._zoomAnimated?j_(this._container,t.add(i)):e=e.add(t).add(i);var r=this._containerBottom=-e.y,n=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=r+"px",this._container.style.left=n+"px"}},_getAnchor:function(){return[0,0]}});sv.include({_initOverlay:function(t,e,i,r){var n=e;return n instanceof t||(n=new t(r).setContent(e)),i&&n.setLatLng(i),n}}),Lv.include({_initOverlay:function(t,e,i,r){var n=i;return n instanceof t?(jf(n,r),n._source=this):(n=e&&!r?e:new t(r,this)).setContent(i),n}});var ry=iy.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return!(t=arguments.length?t:this._source._map).hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,iy.prototype.openOn.call(this,t)},onAdd:function(t){iy.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Bv||this._source.on("preclick",J_))},onRemove:function(t){iy.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Bv||this._source.off("preclick",J_))},getEvents:function(){var t=iy.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=T_("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=T_("div",t+"-content-wrapper",e);if(this._contentNode=T_("div",t+"-content",i),tv(e),Q_(this._contentNode),Y_(e,"contextmenu",J_),this._tipContainer=T_("div",t+"-tip-container",e),this._tip=T_("div",t+"-tip",this._tipContainer),this.options.closeButton){var r=this._closeButton=T_("a",t+"-close-button",e);r.setAttribute("role","button"),r.setAttribute("aria-label","Close popup"),r.href="#close",r.innerHTML='<span aria-hidden="true">&#215;</span>',Y_(r,"click",(function(t){ev(t),this.close()}),this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var r=t.offsetHeight,n=this.options.maxHeight,a="leaflet-popup-scrolled";n&&r>n?(e.height=n+"px",I_(t,a)):M_(t,a),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();j_(this._container,e.add(i))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var t=this._map,e=parseInt(k_(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,r=this._containerWidth,n=new Jf(this._containerLeft,-i-this._containerBottom);n._add(O_(this._container));var a=t.layerPointToContainerPoint(n),s=tg(this.options.autoPanPadding),o=tg(this.options.autoPanPaddingTopLeft||s),l=tg(this.options.autoPanPaddingBottomRight||s),c=t.getSize(),d=0,h=0;a.x+r+l.x>c.x&&(d=a.x+r-c.x+l.x),a.x-d-o.x<0&&(d=a.x-o.x),a.y+i+l.y>c.y&&(h=a.y+i-c.y+l.y),a.y-h-o.y<0&&(h=a.y-o.y),(d||h)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([d,h]))}},_getAnchor:function(){return tg(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});sv.mergeOptions({closePopupOnClick:!0}),sv.include({openPopup:function(t,e,i){return this._initOverlay(ry,t,e,i).openOn(this),this},closePopup:function(t){return(t=arguments.length?t:this._popup)&&t.close(),this}}),Lv.include({bindPopup:function(t,e){return this._popup=this._initOverlay(ry,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof Rv||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(this._popup&&this._map){iv(t);var e=t.layer||t.target;this._popup._source!==e||e instanceof Bv?(this._popup._source=e,this.openPopup(t.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var ny=iy.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){iy.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){iy.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=iy.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=T_("div",t),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+Mf(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,i,r=this._map,n=this._container,a=r.latLngToContainerPoint(r.getCenter()),s=r.layerPointToContainerPoint(t),o=this.options.direction,l=n.offsetWidth,c=n.offsetHeight,d=tg(this.options.offset),h=this._getAnchor();"top"===o?(e=l/2,i=c):"bottom"===o?(e=l/2,i=0):"center"===o?(e=l/2,i=c/2):"right"===o?(e=0,i=c/2):"left"===o?(e=l,i=c/2):s.x<a.x?(o="right",e=0,i=c/2):(o="left",e=l+2*(d.x+h.x),i=c/2),t=t.subtract(tg(e,i,!0)).add(d).add(h),M_(n,"leaflet-tooltip-right"),M_(n,"leaflet-tooltip-left"),M_(n,"leaflet-tooltip-top"),M_(n,"leaflet-tooltip-bottom"),I_(n,"leaflet-tooltip-"+o),j_(n,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&R_(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return tg(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});sv.include({openTooltip:function(t,e,i){return this._initOverlay(ny,t,e,i).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Lv.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ny,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,i.click=this._openTooltip,this._map?this._addFocusListeners():i.add=this._addFocusListeners),this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof Rv||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e="function"==typeof t.getElement&&t.getElement();e&&(Y_(e,"focus",(function(){this._tooltip._source=t,this.openTooltip()}),this),Y_(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e="function"==typeof t.getElement&&t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var e=this;this._map.once("moveend",(function(){e._openOnceFlag=!1,e._openTooltip(t)}))}else this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,i,r=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),r=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(r)}}),zv.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;if(i.html instanceof Element?(C_(e),e.appendChild(i.html)):e.innerHTML=!1!==i.html?i.html:"",i.bgPos){var r=tg(i.bgPos);e.style.backgroundPosition=-r.x+"px "+-r.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),zv.Default=Dv;var ay=Lv.extend({options:{tileSize:256,opacity:1,updateWhenIdle:t_.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){jf(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),S_(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(E_(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&($_(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=function(t,e,i){var r,n,a,s;return s=function(){r=!1,n&&(a.apply(i,n),n=!1)},a=function(){r?n=arguments:(t.apply(i,arguments),setTimeout(s,e),r=!0)},a}(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof Jf?t:new Jf(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,r=-t(-1/0,1/0),n=0,a=i.length;n<a;n++)e=i[n].style.zIndex,i[n]!==this._container&&e&&(r=t(r,+e));isFinite(r)&&(this.options.zIndex=r+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!t_.ielt9){R_(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var r in this._tiles){var n=this._tiles[r];if(n.current&&n.loaded){var a=Math.min(1,(t-n.loaded)/200);R_(n.el,a),a<1?e=!0:(n.active?i=!0:this._onOpaqueTile(n),n.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(Wf(this._fadeFrame),this._fadeFrame=qf(this._updateOpacity,this))}},_onOpaqueTile:Pf,_initContainer:function(){this._container||(this._container=T_("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var i in this._levels)i=Number(i),this._levels[i].el.children.length||i===t?(this._levels[i].el.style.zIndex=e-Math.abs(t-i),this._onUpdateLevel(i)):(S_(this._levels[i].el),this._removeTilesAtZoom(i),this._onRemoveLevel(i),delete this._levels[i]);var r=this._levels[t],n=this._map;return r||((r=this._levels[t]={}).el=T_("div","leaflet-tile-container leaflet-zoom-animated",this._container),r.el.style.zIndex=e,r.origin=n.project(n.unproject(n.getPixelOrigin()),t).round(),r.zoom=t,this._setZoomTransform(r,n.getCenter(),n.getZoom()),r.el.offsetWidth,this._onCreateLevel(r)),this._level=r,r}},_onUpdateLevel:Pf,_onRemoveLevel:Pf,_onCreateLevel:Pf,_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var r=e.coords;this._retainParent(r.x,r.y,r.z,r.z-5)||this._retainChildren(r.x,r.y,r.z,r.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)S_(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,i,r){var n=Math.floor(t/2),a=Math.floor(e/2),s=i-1,o=new Jf(+n,+a);o.z=+s;var l=this._tileCoordsToKey(o),c=this._tiles[l];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),s>r&&this._retainParent(n,a,s,r))},_retainChildren:function(t,e,i,r){for(var n=2*t;n<2*t+2;n++)for(var a=2*e;a<2*e+2;a++){var s=new Jf(n,a);s.z=i+1;var o=this._tileCoordsToKey(s),l=this._tiles[o];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),i+1<r&&this._retainChildren(n,a,i+1,r))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,i,r){var n=Math.round(e);n=void 0!==this.options.maxZoom&&n>this.options.maxZoom||void 0!==this.options.minZoom&&n<this.options.minZoom?void 0:this._clampZoom(n);var a=this.options.updateWhenZooming&&n!==this._tileZoom;r&&!a||(this._tileZoom=n,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==n&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var r=this._map.getZoomScale(i,t.zoom),n=t.origin.multiplyBy(r).subtract(this._map._getNewPixelOrigin(e,i)).round();t_.any3d?D_(t.el,n,r):j_(t.el,n)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),r=this._tileZoom,n=this._map.getPixelWorldBounds(this._tileZoom);n&&(this._globalTileRange=this._pxBoundsToTileRange(n)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],r).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],r).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],r).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],r).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),r=e.getZoomScale(i,this._tileZoom),n=e.project(t,this._tileZoom).floor(),a=e.getSize().divideBy(2*r);return new eg(n.subtract(a),n.add(a))},_update:function(t){var e=this._map;if(e){var i=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var r=this._getTiledPixelBounds(t),n=this._pxBoundsToTileRange(r),a=n.getCenter(),s=[],o=this.options.keepBuffer,l=new eg(n.getBottomLeft().subtract([o,-o]),n.getTopRight().add([o,-o]));if(!(isFinite(n.min.x)&&isFinite(n.min.y)&&isFinite(n.max.x)&&isFinite(n.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var d=this._tiles[c].coords;d.z===this._tileZoom&&l.contains(new Jf(d.x,d.y))||(this._tiles[c].current=!1)}if(Math.abs(i-this._tileZoom)>1)this._setView(t,i);else{for(var h=n.min.y;h<=n.max.y;h++)for(var p=n.min.x;p<=n.max.x;p++){var u=new Jf(p,h);if(u.z=this._tileZoom,this._isValidTile(u)){var m=this._tiles[this._tileCoordsToKey(u)];m?m.current=!0:s.push(u)}}if(s.sort((function(t,e){return t.distanceTo(a)-e.distanceTo(a)})),0!==s.length){this._loading||(this._loading=!0,this.fire("loading"));var f=document.createDocumentFragment();for(p=0;p<s.length;p++)this._addTile(s[p],f);this._level.el.appendChild(f)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var r=this._tileCoordsToBounds(t);return ng(this.options.bounds).overlaps(r)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,i=this.getTileSize(),r=t.scaleBy(i),n=r.add(i);return[e.unproject(r,t.z),e.unproject(n,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),i=new rg(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new Jf(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(S_(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){I_(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=Pf,t.onmousemove=Pf,t_.ielt9&&this.options.opacity<1&&R_(t,this.options.opacity)},_addTile:function(t,e){var i=this._getTilePos(t),r=this._tileCoordsToKey(t),n=this.createTile(this._wrapCoords(t),Af(this._tileReady,this,t));this._initTile(n),this.createTile.length<2&&qf(Af(this._tileReady,this,t,null,n)),j_(n,i),this._tiles[r]={el:n,coords:t,current:!0},e.appendChild(n),this.fire("tileloadstart",{tile:n,coords:t})},_tileReady:function(t,e,i){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var r=this._tileCoordsToKey(t);(i=this._tiles[r])&&(i.loaded=+new Date,this._map._fadeAnimated?(R_(i.el,0),Wf(this._fadeFrame),this._fadeFrame=qf(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(I_(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),t_.ielt9||!this._map._fadeAnimated?qf(this._pruneTiles,this):setTimeout(Af(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new Jf(this._wrapX?Lf(t.x,this._wrapX):t.x,this._wrapY?Lf(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new eg(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),sy=ay.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,(e=jf(this,e)).detectRetina&&t_.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return Y_(i,"load",Af(this._tileOnLoad,this,e,i)),Y_(i,"error",Af(this._tileOnError,this,e,i)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(i.referrerPolicy=this.options.referrerPolicy),i.alt="",i.src=this.getTileUrl(t),i},getTileUrl:function(t){var e={r:t_.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return function(t,e){return t.replace(Of,(function(t,i){var r=e[i];if(void 0===r)throw new Error("No value provided for variable "+t);return"function"==typeof r&&(r=r(e)),r}))}(this._url,Ef(e,this.options))},_tileOnLoad:function(t,e){t_.ielt9?setTimeout(Af(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var r=this.options.errorTileUrl;r&&e.getAttribute("src")!==r&&(e.src=r),t(i,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=Pf,e.onerror=Pf,!e.complete)){e.src=Nf;var i=this._tiles[t].coords;S_(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:i})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",Nf),ay.prototype._removeTile.call(this,t)},_tileReady:function(t,e,i){if(this._map&&(!i||i.getAttribute("src")!==Nf))return ay.prototype._tileReady.call(this,t,e,i)}}),oy=sy.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=Ef({},this.defaultWmsParams);for(var r in e)r in this.options||(i[r]=e[r]);var n=(e=jf(this,e)).detectRetina&&t_.retina?2:1,a=this.getTileSize();i.width=a.x*n,i.height=a.y*n,this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,sy.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),i=this._crs,r=ig(i.project(e[0]),i.project(e[1])),n=r.min,a=r.max,s=(this._wmsVersion>=1.3&&this._crs===Iv?[n.y,n.x,a.y,a.x]:[n.x,n.y,a.x,a.y]).join(","),o=sy.prototype.getTileUrl.call(this,t);return o+function(t,e,i){var r=[];for(var n in t)r.push(encodeURIComponent(i?n.toUpperCase():n)+"="+encodeURIComponent(t[n]));return(e&&-1!==e.indexOf("?")?"&":"?")+r.join("&")}(this.wmsParams,o,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(t,e){return Ef(this.wmsParams,t),e||this.redraw(),this}});sy.WMS=oy;var ly=Lv.extend({options:{padding:.1},initialize:function(t){jf(this,t),Mf(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),I_(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),r=this._map.getSize().multiplyBy(.5+this.options.padding),n=this._map.project(this._center,e),a=r.multiplyBy(-i).add(n).subtract(this._map._getNewPixelOrigin(t,e));t_.any3d?D_(this._container,a,i):j_(this._container,a)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new eg(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),cy=ly.extend({options:{tolerance:0},getEvents:function(){var t=ly.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ly.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Y_(t,"mousemove",this._onMouseMove,this),Y_(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Y_(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){Wf(this._redrawRequest),delete this._ctx,S_(this._container),q_(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){ly.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),r=t_.retina?2:1;j_(e,t.min),e.width=r*i.x,e.height=r*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",t_.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){ly.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[Mf(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,r=e.prev;i?i.prev=r:this._drawLast=r,r?r.next=i:this._drawFirst=i,delete t._order,delete this._layers[Mf(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,i,r=t.options.dashArray.split(/[, ]+/),n=[];for(i=0;i<r.length;i++){if(e=Number(r[i]),isNaN(e))return;n.push(e)}t.options._dashArray=n}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||qf(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new eg,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var r=this._drawFirst;r;r=r.next)t=r.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,r,n,a,s=t._parts,o=s.length,l=this._ctx;if(o){for(l.beginPath(),i=0;i<o;i++){for(r=0,n=s[i].length;r<n;r++)a=s[i][r],l[r?"lineTo":"moveTo"](a.x,a.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,r=Math.max(Math.round(t._radius),1),n=(Math.max(Math.round(t._radiusY),1)||r)/r;1!==n&&(i.save(),i.scale(1,n)),i.beginPath(),i.arc(e.x,e.y/n,r,0,2*Math.PI,!1),1!==n&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,r=this._map.mouseEventToLayerPoint(t),n=this._drawFirst;n;n=n.next)(e=n.layer).options.interactive&&e._containsPoint(r)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(e))&&(i=e);this._fireEvent(!!i&&[i],t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(M_(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var i,r,n=this._drawFirst;n;n=n.next)(i=n.layer).options.interactive&&i._containsPoint(e)&&(r=i);r!==this._hoveredLayer&&(this._handleMouseOut(t),r&&(I_(this._container,"leaflet-interactive"),this._fireEvent([r],t,"mouseover"),this._hoveredLayer=r)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(Af((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var i=e.next,r=e.prev;i&&(i.prev=r,r?r.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var i=e.next,r=e.prev;r&&(r.next=i,i?i.prev=r:r&&(this._drawLast=r),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});var dy=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),hy={_initContainer:function(){this._container=T_("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ly.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=dy("shape");I_(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=dy("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[Mf(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;S_(e),t.removeInteractiveTarget(e),delete this._layers[Mf(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,r=t.options,n=t._container;n.stroked=!!r.stroke,n.filled=!!r.fill,r.stroke?(e||(e=t._stroke=dy("stroke")),n.appendChild(e),e.weight=r.weight+"px",e.color=r.color,e.opacity=r.opacity,r.dashArray?e.dashStyle=Bf(r.dashArray)?r.dashArray.join(" "):r.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=r.lineCap.replace("butt","flat"),e.joinstyle=r.lineJoin):e&&(n.removeChild(e),t._stroke=null),r.fill?(i||(i=t._fill=dy("fill")),n.appendChild(i),i.color=r.fillColor||r.color,i.opacity=r.fillOpacity):i&&(n.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),r=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+r+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){E_(t._container)},_bringToBack:function(t){$_(t._container)}},py=t_.vml?dy:gg,uy=ly.extend({_initContainer:function(){this._container=py("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=py("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){S_(this._container),q_(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){ly.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),j_(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=py("path");t.options.className&&I_(e,t.options.className),t.options.interactive&&I_(e,"leaflet-interactive"),this._updateStyle(t),this._layers[Mf(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){S_(t._path),t.removeInteractiveTarget(t._path),delete this._layers[Mf(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,_g(t._parts,e))},_updateCircle:function(t){var e=t._point,i=Math.max(Math.round(t._radius),1),r="a"+i+","+(Math.max(Math.round(t._radiusY),1)||i)+" 0 1,0 ",n=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+r+2*i+",0 "+r+2*-i+",0 ";this._setPath(t,n)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){E_(t._path)},_bringToBack:function(t){$_(t._path)}});t_.vml&&uy.include(hy),sv.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&function(t){return t_.canvas?new cy(t):null}(t)||function(t){return t_.svg||t_.vml?new uy(t):null}(t)}}),Vv.extend({initialize:function(t,e){Vv.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=ng(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),uy.create=py,uy.pointsToPath=_g,Uv.geometryToLayer=Yv,Uv.coordsToLatLng=qv,Uv.coordsToLatLngs=Wv,Uv.latLngToCoords=Gv,Uv.latLngsToCoords=Xv,Uv.getFeature=Kv,Uv.asFeature=Jv,sv.mergeOptions({boxZoom:!0});var my=pv.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Y_(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){q_(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){S_(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),f_(),F_(),this._startPoint=this._map.mouseEventToContainerPoint(t),Y_(document,{contextmenu:iv,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=T_("div","leaflet-zoom-box",this._container),I_(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new eg(this._point,this._startPoint),i=e.getSize();j_(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(S_(this._box),M_(this._container,"leaflet-crosshair")),g_(),N_(),q_(document,{contextmenu:iv,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(Af(this._resetState,this),0);var e=new rg(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});sv.addInitHook("addHandler","boxZoom",my),sv.mergeOptions({doubleClickZoom:!0});var fy=pv.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),r=e.options.zoomDelta,n=t.originalEvent.shiftKey?i-r:i+r;"center"===e.options.doubleClickZoom?e.setZoom(n):e.setZoomAround(t.containerPoint,n)}});sv.addInitHook("addHandler","doubleClickZoom",fy),sv.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var gy=pv.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new fv(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}I_(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){M_(this._map._container,"leaflet-grab"),M_(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=ng(this._map.options.maxBounds);this._offsetLimit=ig(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,r=this._draggable._newPos.x,n=(r-e+i)%t+e-i,a=(r+e+i)%t-e-i,s=Math.abs(n+i)<Math.abs(a+i)?n:a;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,i=e.options,r=!i.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),r)e.fire("moveend");else{this._prunePositions(+new Date);var n=this._lastPos.subtract(this._positions[0]),a=(this._lastTime-this._times[0])/1e3,s=i.easeLinearity,o=n.multiplyBy(s/a),l=o.distanceTo([0,0]),c=Math.min(i.inertiaMaxSpeed,l),d=o.multiplyBy(c/l),h=c/(i.inertiaDeceleration*s),p=d.multiplyBy(-h/2).round();p.x||p.y?(p=e._limitOffset(p,e.options.maxBounds),qf((function(){e.panBy(p,{duration:h,easeLinearity:s,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});sv.addInitHook("addHandler","dragging",gy),sv.mergeOptions({keyboard:!0,keyboardPanDelta:80});var _y=pv.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Y_(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),q_(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,r=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(r,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,r=this._panKeys={},n=this.keyCodes;for(e=0,i=n.left.length;e<i;e++)r[n.left[e]]=[-1*t,0];for(e=0,i=n.right.length;e<i;e++)r[n.right[e]]=[t,0];for(e=0,i=n.down.length;e<i;e++)r[n.down[e]]=[0,t];for(e=0,i=n.up.length;e<i;e++)r[n.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,r=this._zoomKeys={},n=this.keyCodes;for(e=0,i=n.zoomIn.length;e<i;e++)r[n.zoomIn[e]]=t;for(e=0,i=n.zoomOut.length;e<i;e++)r[n.zoomOut[e]]=-t},_addHooks:function(){Y_(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){q_(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,r=this._map;if(i in this._panKeys){if(!r._panAnim||!r._panAnim._inProgress)if(e=this._panKeys[i],t.shiftKey&&(e=tg(e).multiplyBy(3)),r.options.maxBounds&&(e=r._limitOffset(tg(e),r.options.maxBounds)),r.options.worldCopyJump){var n=r.wrapLatLng(r.unproject(r.project(r.getCenter()).add(e)));r.panTo(n)}else r.panBy(e)}else if(i in this._zoomKeys)r.setZoom(r.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i||!r._popup||!r._popup.options.closeOnEscapeKey)return;r.closePopup()}iv(t)}}});sv.addInitHook("addHandler","keyboard",_y),sv.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var vy=pv.extend({addHooks:function(){Y_(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){q_(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=function(t){return t_.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/rv:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var r=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(Af(this._performZoom,this),r),iv(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var r=this._delta/(4*this._map.options.wheelPxPerZoomLevel),n=4*Math.log(2/(1+Math.exp(-Math.abs(r))))/Math.LN2,a=i?Math.ceil(n/i)*i:n,s=t._limitZoom(e+(this._delta>0?a:-a))-e;this._delta=0,this._startTime=null,s&&("center"===t.options.scrollWheelZoom?t.setZoom(e+s):t.setZoomAround(this._lastMousePos,e+s))}});sv.addInitHook("addHandler","scrollWheelZoom",vy);sv.mergeOptions({tapHold:t_.touchNative&&t_.safari&&t_.mobile,tapTolerance:15});var yy=pv.extend({addHooks:function(){Y_(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){q_(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),1===t.touches.length){var e=t.touches[0];this._startPos=this._newPos=new Jf(e.clientX,e.clientY),this._holdTimeout=setTimeout(Af((function(){this._cancel(),this._isTapValid()&&(Y_(document,"touchend",ev),Y_(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))}),this),600),Y_(document,"touchend touchcancel contextmenu",this._cancel,this),Y_(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){q_(document,"touchend",ev),q_(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),q_(document,"touchend touchcancel contextmenu",this._cancel,this),q_(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new Jf(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var i=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});i._simulated=!0,e.target.dispatchEvent(i)}});sv.addInitHook("addHandler","tapHold",yy),sv.mergeOptions({touchZoom:t_.touch,bounceAtZoomLimits:!0});var by=pv.extend({addHooks:function(){I_(this._map._container,"leaflet-touch-zoom"),Y_(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){M_(this._map._container,"leaflet-touch-zoom"),q_(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToContainerPoint(t.touches[0]),r=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(r)._divideBy(2))),this._startDist=i.distanceTo(r),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Y_(document,"touchmove",this._onTouchMove,this),Y_(document,"touchend touchcancel",this._onTouchEnd,this),ev(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),r=e.mouseEventToContainerPoint(t.touches[1]),n=i.distanceTo(r)/this._startDist;if(this._zoom=e.getScaleZoom(n,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&n<1||this._zoom>e.getMaxZoom()&&n>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===n)return}else{var a=i._add(r)._divideBy(2)._subtract(this._centerPoint);if(1===n&&0===a.x&&0===a.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(a),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),Wf(this._animRequest);var s=Af(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=qf(s,this,!0),ev(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,Wf(this._animRequest),q_(document,"touchmove",this._onTouchMove,this),q_(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});sv.addInitHook("addHandler","touchZoom",by),sv.BoxZoom=my,sv.DoubleClickZoom=fy,sv.Drag=gy,sv.Keyboard=_y,sv.ScrollWheelZoom=vy,sv.TapHold=yy,sv.TouchZoom=by;window.customElements.define("grampsjs-map-overlay",class extends K{render(){return M` <link rel="stylesheet" href="leaflet.css" /> `}static get properties(){return{url:{type:String},bounds:{type:Array},opacity:{type:Number},title:{type:String},hidden:{type:Boolean},_overlay:{type:Object,attribute:!1}}}constructor(){super(),this.url="",this.opacity=1,this.title="",this.hidden=!1,this.bounds=[]}firstUpdated(){this._map=this.parentElement._map,this.hidden||this.addOverlay()}addOverlay(){this._overlay=new ey(this.url,this.bounds),this.parentElement._layercontrol.addOverlay(this._overlay,this.title||"image"),this._overlay.addTo(this._map),this._overlay.bringToFront(),this._overlay.setOpacity(this.opacity)}removeOverlay(){this._map.removeLayer(this._overlay),this.parentElement._layercontrol.removeLayer(this._overlay)}disconnectedCallback(){this._map.removeLayer(this._overlay),super.disconnectedCallback()}updated(t){t.has("bounds")||t.has("opacity")||t.has("url")?this.updateOverlay():t.has("hidden")&&(this.hidden?this.removeOverlay():this.addOverlay())}updateOverlay(){this._overlay&&(this.removeOverlay(),this.addOverlay())}});window.customElements.define("grampsjs-map-marker",class extends K{render(){return M` <link rel="stylesheet" href="leaflet.css" /> `}static get properties(){return{latitude:{type:Number},longitude:{type:Number},popupLabel:{type:String},markerId:{type:String},opacity:{type:Number},size:{type:Number},_marker:{type:Object,attribute:!1},_map:{type:Object,attribute:!1}}}constructor(){super(),this.popupLabel="",this.markerId="",this.opacity=1,this.size=32}attributeChangedCallback(t,e,i){super.attributeChangedCallback(t,e,i),this.updateMarker()}firstUpdated(){this._map=this.parentElement._map,this.addMarker()}addMarker(){const t=new zv({iconUrl:Va(Pa,"#EA4335"),iconSize:[this.size,this.size],iconAnchor:[this.size/2,this.size],popupAnchor:[0,-this.size]});this._marker=new Ov([this.latitude,this.longitude],{opacity:this.opacity,icon:t}),this._marker.addTo(this._map),this._marker.on("click",this.clickHandler.bind(this)),""!==this.popupLabel&&this._marker.bindPopup(this.popupLabel)}clickHandler(){this.dispatchEvent(new CustomEvent("marker:clicked",{bubbles:!0,composed:!0,detail:{latitude:this.latitude,longitude:this.longitude,markerId:this.markerId}}))}disconnectedCallback(){this._map.removeLayer(this._marker),super.disconnectedCallback()}updateMarker(){this._marker&&(this._map.removeLayer(this._marker),this.addMarker())}});const xy=(t,e,i)=>{(i=i.split(" ")).forEach((function(i){L.DomUtil[t].call(this,e,i)}))},wy=(t,e)=>xy("addClass",t,e),ky=(t,e)=>xy("removeClass",t,e),Ty=L.Marker.extend({initialize(t,e){Util.setOptions(this,e),this._latlng=t,this.createIcon()},createIcon(){const t=this.options;let e="";void 0!==t.color&&(e+=`stroke:${t.color};`),void 0!==t.weight&&(e+=`stroke-width:${t.weight};`),void 0!==t.fillColor&&(e+=`fill:${t.fillColor};`),void 0!==t.fillOpacity&&(e+=`fill-opacity:${t.fillOpacity};`),void 0!==t.opacity&&(e+=`opacity:${t.opacity};`);const i=this._getIconSVG(t,e);this._locationIcon=L.divIcon({className:i.className,html:i.svg,iconSize:[i.w,i.h]}),this.setIcon(this._locationIcon)},_getIconSVG(t,e){const i=t.radius,r=i+t.weight,n=2*r;return{className:"leaflet-control-locate-location",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="${n}" height="${n}" version="1.1" viewBox="-${r} -${r} ${n} ${n}"><circle r="`+i+'" style="'+e+'" /></svg>',w:n,h:n}},setStyle(t){L.Util.setOptions(this,t),this.createIcon()}}),Sy=Ty.extend({initialize(t,e,i){L.Util.setOptions(this,i),this._latlng=t,this._heading=e,this.createIcon()},setHeading(t){this._heading=t},_getIconSVG(t,e){const i=t.radius,r=t.width+t.weight,n=2*(i+t.depth+t.weight),a=`M0,0 l${t.width/2},${t.depth} l-${r},0 z`;return{className:"leaflet-control-locate-heading",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="${r}" height="${n}" version="1.1" viewBox="-${r/2} 0 ${r} ${n}" style="${`transform: rotate(${this._heading}deg)`}"><path d="`+a+'" style="'+e+'" /></svg>',w:r,h:n}}}),Cy=L.Control.extend({options:{position:"topleft",layer:void 0,setView:"untilPanOrZoom",keepCurrentZoomLevel:!1,initialZoomLevel:!1,getLocationBounds:t=>t.bounds,flyTo:!1,clickBehavior:{inView:"stop",outOfView:"setView",inViewNotFollowing:"inView"},returnToPrevBounds:!1,cacheLocation:!0,drawCircle:!0,drawMarker:!0,showCompass:!0,markerClass:Ty,compassClass:Sy,circleStyle:{className:"leaflet-control-locate-circle",color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:0},markerStyle:{className:"leaflet-control-locate-marker",color:"#fff",fillColor:"#2A93EE",fillOpacity:1,weight:3,opacity:1,radius:9},compassStyle:{fillColor:"#2A93EE",fillOpacity:1,weight:0,color:"#fff",opacity:1,radius:9,width:9,depth:6},followCircleStyle:{},followMarkerStyle:{},followCompassStyle:{},icon:"leaflet-control-locate-location-arrow",iconLoading:"leaflet-control-locate-spinner",iconElementTag:"span",textElementTag:"small",circlePadding:[0,0],metric:!0,createButtonCallback(t,e){const i=L.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",t);i.title=e.strings.title,i.href="#",i.setAttribute("role","button");const r=L.DomUtil.create(e.iconElementTag,e.icon,i);if(void 0!==e.strings.text){L.DomUtil.create(e.textElementTag,"leaflet-locate-text",i).textContent=e.strings.text,i.classList.add("leaflet-locate-text-active"),i.parentNode.style.display="flex",e.icon.length>0&&r.classList.add("leaflet-locate-icon")}return{link:i,icon:r}},onLocationError(t,e){alert(t.message)},onLocationOutsideMapBounds(t){t.stop(),alert(t.options.strings.outsideMapBoundsMsg)},showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0,setView:!1}},initialize(t){for(const e in t)"object"==typeof this.options[e]?L.extend(this.options[e],t[e]):this.options[e]=t[e];this.options.followMarkerStyle=L.extend({},this.options.markerStyle,this.options.followMarkerStyle),this.options.followCircleStyle=L.extend({},this.options.circleStyle,this.options.followCircleStyle),this.options.followCompassStyle=L.extend({},this.options.compassStyle,this.options.followCompassStyle)},onAdd(t){const e=L.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");this._container=e,this._map=t,this._layer=this.options.layer||new L.LayerGroup,this._layer.addTo(t),this._event=void 0,this._compassHeading=null,this._prevBounds=null;const i=this.options.createButtonCallback(e,this.options);return this._link=i.link,this._icon=i.icon,L.DomEvent.on(this._link,"click",(function(t){L.DomEvent.stopPropagation(t),L.DomEvent.preventDefault(t),this._onClick()}),this).on(this._link,"dblclick",L.DomEvent.stopPropagation),this._resetVariables(),this._map.on("unload",this._unload,this),e},_onClick(){this._justClicked=!0;const t=this._isFollowing();if(this._userPanned=!1,this._userZoomed=!1,this._active&&!this._event)this.stop();else if(this._active){const e=this.options.clickBehavior;let i=e.outOfView;switch(this._map.getBounds().contains(this._event.latlng)&&(i=t?e.inView:e.inViewNotFollowing),e[i]&&(i=e[i]),i){case"setView":this.setView();break;case"stop":if(this.stop(),this.options.returnToPrevBounds){(this.options.flyTo?this._map.flyToBounds:this._map.fitBounds).bind(this._map)(this._prevBounds)}}}else this.options.returnToPrevBounds&&(this._prevBounds=this._map.getBounds()),this.start();this._updateContainerStyle()},start(){this._activate(),this._event&&(this._drawMarker(this._map),this.options.setView&&this.setView()),this._updateContainerStyle()},stop(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this._removeMarker()},stopFollowing(){this._userPanned=!0,this._updateContainerStyle(),this._drawMarker()},_activate(){if(!this._active&&(this._map.locate(this.options.locateOptions),this._map.fire("locateactivate",this),this._active=!0,this._map.on("locationfound",this._onLocationFound,this),this._map.on("locationerror",this._onLocationError,this),this._map.on("dragstart",this._onDrag,this),this._map.on("zoomstart",this._onZoom,this),this._map.on("zoomend",this._onZoomEnd,this),this.options.showCompass)){const t="ondeviceorientationabsolute"in window;if(t||"ondeviceorientation"in window){const e=this,i=function(){L.DomEvent.on(window,t?"deviceorientationabsolute":"deviceorientation",e._onDeviceOrientation,e)};DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((function(t){"granted"===t&&i()})):i()}}},_deactivate(){this._map.stopLocate(),this._map.fire("locatedeactivate",this),this._active=!1,this.options.cacheLocation||(this._event=void 0),this._map.off("locationfound",this._onLocationFound,this),this._map.off("locationerror",this._onLocationError,this),this._map.off("dragstart",this._onDrag,this),this._map.off("zoomstart",this._onZoom,this),this._map.off("zoomend",this._onZoomEnd,this),this.options.showCompass&&(this._compassHeading=null,"ondeviceorientationabsolute"in window?L.DomEvent.off(window,"deviceorientationabsolute",this._onDeviceOrientation,this):"ondeviceorientation"in window&&L.DomEvent.off(window,"deviceorientation",this._onDeviceOrientation,this))},setView(){if(this._drawMarker(),this._isOutsideMapBounds())this._event=void 0,this.options.onLocationOutsideMapBounds(this);else if(this._justClicked&&!1!==this.options.initialZoomLevel)(t=this.options.flyTo?this._map.flyTo:this._map.setView).bind(this._map)([this._event.latitude,this._event.longitude],this.options.initialZoomLevel);else if(this.options.keepCurrentZoomLevel){(t=this.options.flyTo?this._map.flyTo:this._map.panTo).bind(this._map)([this._event.latitude,this._event.longitude])}else{var t=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;this._ignoreEvent=!0,t.bind(this._map)(this.options.getLocationBounds(this._event),{padding:this.options.circlePadding,maxZoom:this.options.initialZoomLevel||this.options.locateOptions.maxZoom}),L.Util.requestAnimFrame((function(){this._ignoreEvent=!1}),this)}},_drawCompass(){if(!this._event)return;const t=this._event.latlng;if(this.options.showCompass&&t&&null!==this._compassHeading){const e=this._isFollowing()?this.options.followCompassStyle:this.options.compassStyle;this._compass?(this._compass.setLatLng(t),this._compass.setHeading(this._compassHeading),this._compass.setStyle&&this._compass.setStyle(e)):this._compass=new this.options.compassClass(t,this._compassHeading,e).addTo(this._layer)}!this._compass||this.options.showCompass&&null!==this._compassHeading||(this._compass.removeFrom(this._layer),this._compass=null)},_drawMarker(){void 0===this._event.accuracy&&(this._event.accuracy=0);const t=this._event.accuracy,e=this._event.latlng;if(this.options.drawCircle){const i=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle;this._circle?this._circle.setLatLng(e).setRadius(t).setStyle(i):this._circle=L.circle(e,t,i).addTo(this._layer)}let i,r;if(this.options.metric?(i=t.toFixed(0),r=this.options.strings.metersUnit):(i=(3.2808399*t).toFixed(0),r=this.options.strings.feetUnit),this.options.drawMarker){const t=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle;this._marker?(this._marker.setLatLng(e),this._marker.setStyle&&this._marker.setStyle(t)):this._marker=new this.options.markerClass(e,t).addTo(this._layer)}this._drawCompass();const n=this.options.strings.popup;function a(){return"string"==typeof n?L.Util.template(n,{distance:i,unit:r}):"function"==typeof n?n({distance:i,unit:r}):n}this.options.showPopup&&n&&this._marker&&this._marker.bindPopup(a())._popup.setLatLng(e),this.options.showPopup&&n&&this._compass&&this._compass.bindPopup(a())._popup.setLatLng(e)},_removeMarker(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},_unload(){this.stop(),this._map.off("unload",this._unload,this)},_setCompassHeading(t){!isNaN(parseFloat(t))&&isFinite(t)?(t=Math.round(t),this._compassHeading=t,L.Util.requestAnimFrame(this._drawCompass,this)):this._compassHeading=null},_onCompassNeedsCalibration(){this._setCompassHeading()},_onDeviceOrientation(t){this._active&&(t.webkitCompassHeading?this._setCompassHeading(t.webkitCompassHeading):t.absolute&&t.alpha&&this._setCompassHeading(360-t.alpha))},_onLocationError(t){3==t.code&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(t,this))},_onLocationFound(t){if((!this._event||this._event.latlng.lat!==t.latlng.lat||this._event.latlng.lng!==t.latlng.lng||this._event.accuracy!==t.accuracy)&&this._active){switch(this._event=t,this._drawMarker(),this._updateContainerStyle(),this.options.setView){case"once":this._justClicked&&this.setView();break;case"untilPan":this._userPanned||this.setView();break;case"untilPanOrZoom":this._userPanned||this._userZoomed||this.setView();break;case"always":this.setView()}this._justClicked=!1}},_onDrag(){this._event&&!this._ignoreEvent&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_onZoom(){this._event&&!this._ignoreEvent&&(this._userZoomed=!0,this._updateContainerStyle(),this._drawMarker())},_onZoomEnd(){this._event&&this._drawCompass(),this._event&&!this._ignoreEvent&&this._marker&&!this._map.getBounds().pad(-.3).contains(this._marker.getLatLng())&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_isFollowing(){return!!this._active&&("always"===this.options.setView||("untilPan"===this.options.setView?!this._userPanned:"untilPanOrZoom"===this.options.setView?!this._userPanned&&!this._userZoomed:void 0))},_isOutsideMapBounds(){return void 0!==this._event&&(this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng))},_updateContainerStyle(){this._container&&(this._active&&!this._event?this._setClasses("requesting"):this._isFollowing()?this._setClasses("following"):this._active?this._setClasses("active"):this._cleanClasses())},_setClasses(t){"requesting"==t?(ky(this._container,"active following"),wy(this._container,"requesting"),ky(this._icon,this.options.icon),wy(this._icon,this.options.iconLoading)):"active"==t?(ky(this._container,"requesting following"),wy(this._container,"active"),ky(this._icon,this.options.iconLoading),wy(this._icon,this.options.icon)):"following"==t&&(ky(this._container,"requesting"),wy(this._container,"active following"),ky(this._icon,this.options.iconLoading),wy(this._icon,this.options.icon))},_cleanClasses(){L.DomUtil.removeClass(this._container,"requesting"),L.DomUtil.removeClass(this._container,"active"),L.DomUtil.removeClass(this._container,"following"),ky(this._icon,this.options.iconLoading),wy(this._icon,this.options.icon)},_resetVariables(){this._active=!1,this._justClicked=!1,this._userPanned=!1,this._userZoomed=!1}});L.control.locate=t=>new Cy(t);const{L:Ey}=window,$y={leafletTileUrl:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",leafletTileAttribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a> contributors; <a href="https://carto.com/attributions">CARTO</a>',leafletTileSize:256,leafletZoomOffset:0,glStyle:"https://www.openhistoricalmap.org/map-styles/main/main.json",glAttribution:'<a href="https://www.openhistoricalmap.org/">OpenHistoricalMap</a>'};window.customElements.define("grampsjs-map",class extends K{render(){return M`
      <link rel="stylesheet" href="leaflet.css" />
      <link rel="stylesheet" href="L.Control.Locate.min.css" />

      <div
        class="mapcontainer"
        style="width:${this.width}; height:${this.height};"
      >
        <div id="${this.mapid}" style="z-index: 0; width: 100%; height: 100%;">
          <slot> </slot>
        </div>
      </div>
    `}static get styles(){return[]}static get properties(){return{height:{type:String},width:{type:String},latitude:{type:Number},longitude:{type:Number},year:{type:Number},mapid:{type:String},zoom:{type:Number},latMin:{type:Number},latMax:{type:Number},longMin:{type:Number},longMax:{type:Number},layerSwitcher:{type:Boolean},locateControl:{type:Boolean},_map:{type:Object},_glMap:{type:Object},_layercontrol:{type:Object},_currentLayer:{type:String}}}constructor(){super(),this.height="500px",this.width="100%",this.zoom=13,this.mapid="mapid",this.latitude=0,this.longitude=0,this.year=-1,this.latMin=0,this.latMax=0,this.longMin=0,this.longMax=0,this.layerSwitcher=!1,this._currentLayer="OpenStreetMap"}firstUpdated(){const t=this.shadowRoot.getElementById(this.mapid);0===this.latMin&&0===this.latMax?this._map=new Ey.Map(t,{zoomControl:!1}).setView([this.latitude,this.longitude],this.zoom):this._map=new Ey.Map(t,{zoomControl:!1}).fitBounds([[this.latMin,this.longMin],[this.latMax,this.longMax]]);const e={...$y,...window.grampsjsConfig},i=new Ey.TileLayer(e.leafletTileUrl,{attribution:e.leafletTileAttribution,tileSize:e.leafletTileSize,zoomOffset:e.leafletZoomOffset,maxZoom:19,zoomControl:!1});i.addTo(this._map),this._gl=Ey.maplibreGL({style:e.glStyle,attribution:e.glAttribution}),this._map.addControl(Ey.control.zoom({position:"bottomright"})),this.locateControl&&this._map.addControl(Ey.control.locate({position:"bottomright",drawCircle:!1})),this._layercontrol=Ey.control.layers({OpenHistoricalMap:this._gl,OpenStreetMap:i},null,{position:"bottomleft"}),this.layerSwitcher&&this._map.addControl(this._layercontrol),this._map.on("baselayerchange",(t=>this._handleBaseLayerChange(t))),this._map.invalidateSize(!1),this._map.on("moveend",(t=>this._handleMoveEnd(t)))}_handleBaseLayerChange(t){if(this._currentLayer=t.name,"OpenHistoricalMap"===this._currentLayer){const t=this._gl.getMaplibreMap();t.on("styledata",(()=>t.filterByDate(`${this.year}`)))}os(this,"map:layerchange",{layer:this._currentLayer})}_handleMoveEnd(t){os(this,"map:moveend",{bounds:t.target.getBounds()})}panTo(t,e){void 0!==this._map&&this._map.panTo(new Ey.latLng(t,e))}updated(t){t.has("year")&&this.year>0&&"OpenHistoricalMap"===this._currentLayer?this._gl.getMaplibreMap().filterByDate(`${this.year}`):void 0!==this._map&&(t.has("latitude")||t.has("longitude")||t.has("mapid")||t.has("zoom"))&&(0===this.latMin&&0===this.latMax?(this._map.setZoom(this.zoom),this._map.panTo(new Ey.latLng(this.latitude,this.longitude))):this._map.fitBounds([[this.latMin,this.longMin],[this.latMax,this.longMax]]),this._map.invalidateSize(!1))}});class Ay extends(al(K)){static get styles(){return[nl,n`
        .timeline-event {
          padding: 0.8em;
          display: grid;
          grid-gap: 15px;
          grid-template-columns: 150px minmax(150px, 1fr);
          background-color: #fff;
          color: #444;
        }

        .timeline-event.highlighted {
          background-color: #efebe9;
          border-radius: 6px;
        }

        .timeline-date-age {
          text-align: right;
          opacity: 0.75;
        }

        .timeline-age {
          font-weight: 400;
        }

        .timeline-detail {
        }

        span {
          display: block;
          margin-bottom: 0.2em;
          vertical-align: middle;
        }

        .timeline-label,
        .timeline-date {
          font-family: var(--grampsjs-heading-font-family);
          font-weight: 400;
          font-size: 18px;
          color: rgba(0, 0, 0, 0.8);
          margin-bottom: 0.4em;
        }

        .timeline-place,
        .timeline-description,
        .timeline-person,
        .timeline-age {
          display: block;
          font-family: var(--grampsjs-body-font-family);
          font-size: 17px;
        }

        .timeline-place,
        .timeline-description,
        .timeline-person {
          font-weight: 300;
        }

        .timeline-detail mwc-icon {
          --mdc-icon-size: 1em;
          color: rgba(0, 0, 0, 0.25);
          margin-right: 0.2em;
          position: relative;
          top: 0.13em;
        }

        .timeline-button {
          margin-top: 0.5em;
          visibility: hidden;
        }

        .timeline-event.highlighted .timeline-button {
          visibility: visible;
        }

        #timeline {
        }

        #map {
          display: none;
        }

        @media (min-width: 768px) {
          #map {
            height: calc(100vh - 64px);
            position: sticky;
            top: 64px;
            display: block;
          }

          #container {
            display: grid;
            grid-gap: 8px;
            grid-template-columns: 420px 1fr;
          }
        }
      `]}static get properties(){return{data:{type:Array},highlightedId:{type:String}}}constructor(){super(),this.data=[],this.highlightedId=""}render(){return 0===this.data.length?M``:M`
      <div id="container">
        <div id="timeline">${this.data.map(this.renderEvent,this)}</div>
        <div id="map">
          ${this.data.map((t=>t.place?.lat||t.place?.long)).filter(Boolean).length>0?M` ${this.renderMap()} `:""}
        </div>
      </div>
    `}renderMap(){const t=this._getMapCorners();return M`
      <grampsjs-map
        latMin="${t[0][0]}"
        longMin="${t[0][1]}"
        latMax="${t[1][0]}"
        longMax="${t[1][1]}"
        layerSwitcher
        mapid="timeline-map"
        id="timeline-map"
        @marker:clicked="${this._handleMapClick}"
      >
        ${this.data.map((t=>t.place?.lat&&t.place?.long?M`
            <grampsjs-map-marker
              latitude="${t.place.lat}"
              longitude="${t.place.long}"
              markerId="${t.gramps_id}"
              opacity="${t.gramps_id===this.highlightedId?1:.5}"
            >
            </grampsjs-map-marker>
          `:""),this)}
      </grampsjs-map>
    `}_getMapCorners(){if(0===this.data.length)return[0,0];const t=this.data.filter((t=>t?.place?.lat||t?.place?.lat));if(0===t.length)return[[0,0],[0,0]];const e=t.map((t=>t.place.lat||0)),i=t.map((t=>t.place.long||0));return[[Math.min(...e),Math.min(...i)],[Math.max(...e),Math.max(...i)]]}renderEvent(t){return M`
      <div
        id="event-${t.gramps_id}"
        class=${Ot({"timeline-event":!0,highlighted:t.gramps_id===this.highlightedId})}
        @mouseover="${()=>this._handleMouseOver(t)}"
        @focus="${()=>this._handleMouseOver(t)}"
        @touchstart="${()=>this._handleMouseOver(t)}"
      >
        <div class="timeline-date-age">
          <span class="timeline-date">${t.date}</span>
          <span class="timeline-age">${t.age}</span>
        </div>
        <div class="timeline-detail">
          <span class="timeline-label"
            >${t.label}
            ${t.role&&![this._("Family"),this._("Primary")].includes(t.role)?M`(${t.role})`:""}
          </span>
          ${t.description?M`
                <span class="timeline-description">${t.description}</span>
              `:""}
          ${t.place?.name?M`
                <span class="timeline-place"
                  ><mwc-icon class="person">place</mwc-icon> ${t.place.name}</span
                >
              `:""}
          ${t.person?.name_given||t.person?.name_surname?M`
                <span class="timeline-person"
                  ><mwc-icon class="person">person</mwc-icon> ${t.person?.name_given||M`&hellip;`}
                  ${t.person?.name_surname||M`&hellip;`}</span
                >
              `:""}

          <span class="timeline-button">
            <mwc-button
              dense
              outlined
              label="${this._("Details")}"
              @click="${()=>this._handleButtonClick(t.gramps_id)}"
            >
            </mwc-button>
          </span>
        </div>
      </div>
    `}_handleMouseOver(t){const e=t.gramps_id,i=t?.place?.lat,r=t?.place?.long;if(this.highlightedId=e,i||r){this.shadowRoot.getElementById("timeline-map").panTo(i,r)}}_handleMapClick(t){if(t.detail?.markerId){this.highlightedId=t.detail.markerId,this._scrollToId(`event-${t.detail.markerId}`);const e=t.detail?.latitude,i=t.detail?.longitude;if(e||i){this.shadowRoot.getElementById("timeline-map").panTo(e,i)}}}_handleButtonClick(t){this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:`event/${t}`}}))}_scrollToId(t){const e=this.shadowRoot.getElementById(t);e&&e.scrollIntoView({behavior:"smooth",block:"center"})}}window.customElements.define("grampsjs-person-timeline",Ay);function Iy(t){for(var e=t.length/6|0,i=new Array(e),r=0;r<e;)i[r]="#"+t.slice(6*r,6*++r);return i}window.customElements.define("grampsjs-view-person-timeline",class extends $d{static get styles(){return[super.styles,n`
        :host {
          margin: 0;
        }
      `]}static get properties(){return{handle:{type:String},_data:{type:Array}}}constructor(){super(),this.handle="",this._data=[]}renderContent(){return 0===this._data.length?(this.loading,M``):this.renderElements()}renderElements(){return M`
      <grampsjs-person-timeline
        .data="${this._data}"
        .strings="${this.strings}"
      >
      </grampsjs-person-timeline>
    `}update(t){super.update(t),this.active&&t.has("handle")&&this._updateData()}_updateData(){if(this.handle){const t=`/api/people/${this.handle}/timeline?locale=${this.strings.__lang__||"en"}`;this._data=[],this.loading=!0,On(t).then((t=>{this.loading=!1,"data"in t?(this.error=!1,this._data=t.data):"error"in t&&(this.error=!0,this._errorMessage=t.error)}))}}});var My=Iy("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Ly=Iy("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Py=Iy("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999");function Ry(t,e,i){t.prototype=e.prototype=i,i.constructor=t}function zy(t,e){var i=Object.create(t.prototype);for(var r in e)i[r]=e[r];return i}function Dy(){}var jy=.7,Oy=1/jy,By="\\s*([+-]?\\d+)\\s*",Fy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ny="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Hy=/^#([0-9a-f]{3,8})$/,Vy=new RegExp(`^rgb\\(${By},${By},${By}\\)$`),Uy=new RegExp(`^rgb\\(${Ny},${Ny},${Ny}\\)$`),Yy=new RegExp(`^rgba\\(${By},${By},${By},${Fy}\\)$`),Zy=new RegExp(`^rgba\\(${Ny},${Ny},${Ny},${Fy}\\)$`),qy=new RegExp(`^hsl\\(${Fy},${Ny},${Ny}\\)$`),Wy=new RegExp(`^hsla\\(${Fy},${Ny},${Ny},${Fy}\\)$`),Gy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Xy(){return this.rgb().formatHex()}function Ky(){return this.rgb().formatRgb()}function Jy(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=Hy.exec(t))?(i=e[1].length,e=parseInt(e[1],16),6===i?Qy(e):3===i?new rb(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===i?tb(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===i?tb(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Vy.exec(t))?new rb(e[1],e[2],e[3],1):(e=Uy.exec(t))?new rb(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Yy.exec(t))?tb(e[1],e[2],e[3],e[4]):(e=Zy.exec(t))?tb(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=qy.exec(t))?cb(e[1],e[2]/100,e[3]/100,1):(e=Wy.exec(t))?cb(e[1],e[2]/100,e[3]/100,e[4]):Gy.hasOwnProperty(t)?Qy(Gy[t]):"transparent"===t?new rb(NaN,NaN,NaN,0):null}function Qy(t){return new rb(t>>16&255,t>>8&255,255&t,1)}function tb(t,e,i,r){return r<=0&&(t=e=i=NaN),new rb(t,e,i,r)}function eb(t){return t instanceof Dy||(t=Jy(t)),t?new rb((t=t.rgb()).r,t.g,t.b,t.opacity):new rb}function ib(t,e,i,r){return 1===arguments.length?eb(t):new rb(t,e,i,null==r?1:r)}function rb(t,e,i,r){this.r=+t,this.g=+e,this.b=+i,this.opacity=+r}function nb(){return`#${lb(this.r)}${lb(this.g)}${lb(this.b)}`}function ab(){const t=sb(this.opacity);return`${1===t?"rgb(":"rgba("}${ob(this.r)}, ${ob(this.g)}, ${ob(this.b)}${1===t?")":`, ${t})`}`}function sb(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ob(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function lb(t){return((t=ob(t))<16?"0":"")+t.toString(16)}function cb(t,e,i,r){return r<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new hb(t,e,i,r)}function db(t){if(t instanceof hb)return new hb(t.h,t.s,t.l,t.opacity);if(t instanceof Dy||(t=Jy(t)),!t)return new hb;if(t instanceof hb)return t;var e=(t=t.rgb()).r/255,i=t.g/255,r=t.b/255,n=Math.min(e,i,r),a=Math.max(e,i,r),s=NaN,o=a-n,l=(a+n)/2;return o?(s=e===a?(i-r)/o+6*(i<r):i===a?(r-e)/o+2:(e-i)/o+4,o/=l<.5?a+n:2-a-n,s*=60):o=l>0&&l<1?0:s,new hb(s,o,l,t.opacity)}function hb(t,e,i,r){this.h=+t,this.s=+e,this.l=+i,this.opacity=+r}function pb(t){return(t=(t||0)%360)<0?t+360:t}function ub(t){return Math.max(0,Math.min(1,t||0))}function mb(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)}Ry(Dy,Jy,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Xy,formatHex:Xy,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return db(this).formatHsl()},formatRgb:Ky,toString:Ky}),Ry(rb,ib,zy(Dy,{brighter(t){return t=null==t?Oy:Math.pow(Oy,t),new rb(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?jy:Math.pow(jy,t),new rb(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new rb(ob(this.r),ob(this.g),ob(this.b),sb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nb,formatHex:nb,formatHex8:function(){return`#${lb(this.r)}${lb(this.g)}${lb(this.b)}${lb(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:ab,toString:ab})),Ry(hb,(function(t,e,i,r){return 1===arguments.length?db(t):new hb(t,e,i,null==r?1:r)}),zy(Dy,{brighter(t){return t=null==t?Oy:Math.pow(Oy,t),new hb(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?jy:Math.pow(jy,t),new hb(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,r=i+(i<.5?i:1-i)*e,n=2*i-r;return new rb(mb(t>=240?t-240:t+120,n,r),mb(t,n,r),mb(t<120?t+240:t-120,n,r),this.opacity)},clamp(){return new hb(pb(this.h),ub(this.s),ub(this.l),sb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=sb(this.opacity);return`${1===t?"hsl(":"hsla("}${pb(this.h)}, ${100*ub(this.s)}%, ${100*ub(this.l)}%${1===t?")":`, ${t})`}`}}));const fb=Math.PI/180,gb=180/Math.PI;var _b=-.14861,vb=1.78277,yb=-.29227,bb=-.90649,xb=1.97294,wb=xb*bb,kb=xb*vb,Tb=vb*yb-bb*_b;function Sb(t,e,i,r){return 1===arguments.length?function(t){if(t instanceof Cb)return new Cb(t.h,t.s,t.l,t.opacity);t instanceof rb||(t=eb(t));var e=t.r/255,i=t.g/255,r=t.b/255,n=(Tb*r+wb*e-kb*i)/(Tb+wb-kb),a=r-n,s=(xb*(i-n)-yb*a)/bb,o=Math.sqrt(s*s+a*a)/(xb*n*(1-n)),l=o?Math.atan2(s,a)*gb-120:NaN;return new Cb(l<0?l+360:l,o,n,t.opacity)}(t):new Cb(t,e,i,null==r?1:r)}function Cb(t,e,i,r){this.h=+t,this.s=+e,this.l=+i,this.opacity=+r}Ry(Cb,Sb,zy(Dy,{brighter(t){return t=null==t?Oy:Math.pow(Oy,t),new Cb(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?jy:Math.pow(jy,t),new Cb(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*fb,e=+this.l,i=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),n=Math.sin(t);return new rb(255*(e+i*(_b*r+vb*n)),255*(e+i*(yb*r+bb*n)),255*(e+i*(xb*r)),this.opacity)}}));var Eb=t=>()=>t;function $b(t,e){return function(i){return t+i*e}}function Ab(t){return 1==(t=+t)?Ib:function(e,i){return i-e?function(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(r){return Math.pow(t+r*e,i)}}(e,i,t):Eb(isNaN(e)?i:e)}}function Ib(t,e){var i=e-t;return i?$b(t,i):Eb(isNaN(t)?e:t)}var Mb=function t(e){var i=Ab(e);function r(t,e){var r=i((t=ib(t)).r,(e=ib(e)).r),n=i(t.g,e.g),a=i(t.b,e.b),s=Ib(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=n(e),t.b=a(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);var Lb,Pb=(Lb=function(t){var e=t.length-1;return function(i){var r=i<=0?i=0:i>=1?(i=1,e-1):Math.floor(i*e),n=t[r],a=t[r+1],s=r>0?t[r-1]:2*n-a,o=r<e-1?t[r+2]:2*a-n;return function(t,e,i,r,n){var a=t*t,s=a*t;return((1-3*t+3*a-s)*e+(4-6*a+3*s)*i+(1+3*t+3*a-3*s)*r+s*n)/6}((i-r/e)*e,s,n,a,o)}},function(t){var e,i,r=t.length,n=new Array(r),a=new Array(r),s=new Array(r);for(e=0;e<r;++e)i=ib(t[e]),n[e]=i.r||0,a[e]=i.g||0,s[e]=i.b||0;return n=Lb(n),a=Lb(a),s=Lb(s),i.opacity=1,function(t){return i.r=n(t),i.g=a(t),i.b=s(t),i+""}});function Rb(t,e){e||(e=[]);var i,r=t?Math.min(e.length,t.length):0,n=e.slice();return function(a){for(i=0;i<r;++i)n[i]=t[i]*(1-a)+e[i]*a;return n}}function zb(t,e){var i,r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),s=new Array(r);for(i=0;i<n;++i)a[i]=Hb(t[i],e[i]);for(;i<r;++i)s[i]=e[i];return function(t){for(i=0;i<n;++i)s[i]=a[i](t);return s}}function Db(t,e){var i=new Date;return t=+t,e=+e,function(r){return i.setTime(t*(1-r)+e*r),i}}function jb(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}function Ob(t,e){var i,r={},n={};for(i in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)i in t?r[i]=Hb(t[i],e[i]):n[i]=e[i];return function(t){for(i in r)n[i]=r[i](t);return n}}var Bb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fb=new RegExp(Bb.source,"g");function Nb(t,e){var i,r,n,a=Bb.lastIndex=Fb.lastIndex=0,s=-1,o=[],l=[];for(t+="",e+="";(i=Bb.exec(t))&&(r=Fb.exec(e));)(n=r.index)>a&&(n=e.slice(a,n),o[s]?o[s]+=n:o[++s]=n),(i=i[0])===(r=r[0])?o[s]?o[s]+=r:o[++s]=r:(o[++s]=null,l.push({i:s,x:jb(i,r)})),a=Fb.lastIndex;return a<e.length&&(n=e.slice(a),o[s]?o[s]+=n:o[++s]=n),o.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var i,r=0;r<e;++r)o[(i=l[r]).i]=i.x(t);return o.join("")})}function Hb(t,e){var i,r=typeof e;return null==e||"boolean"===r?Eb(e):("number"===r?jb:"string"===r?(i=Jy(e))?(e=i,Mb):Nb:e instanceof Jy?Mb:e instanceof Date?Db:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?Rb:Array.isArray(e)?zb:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Ob:jb)(t,e)}function Vb(t,e){return t=+t,e=+e,function(i){return Math.round(t*(1-i)+e*i)}}var Ub,Yb=180/Math.PI,Zb={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function qb(t,e,i,r,n,a){var s,o,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*i+e*r)&&(i-=t*l,r-=e*l),(o=Math.sqrt(i*i+r*r))&&(i/=o,r/=o,l/=o),t*r<e*i&&(t=-t,e=-e,l=-l,s=-s),{translateX:n,translateY:a,rotate:Math.atan2(e,t)*Yb,skewX:Math.atan(l)*Yb,scaleX:s,scaleY:o}}function Wb(t,e,i,r){function n(t){return t.length?t.pop()+" ":""}return function(a,s){var o=[],l=[];return a=t(a),s=t(s),function(t,r,n,a,s,o){if(t!==n||r!==a){var l=s.push("translate(",null,e,null,i);o.push({i:l-4,x:jb(t,n)},{i:l-2,x:jb(r,a)})}else(n||a)&&s.push("translate("+n+e+a+i)}(a.translateX,a.translateY,s.translateX,s.translateY,o,l),function(t,e,i,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:i.push(n(i)+"rotate(",null,r)-2,x:jb(t,e)})):e&&i.push(n(i)+"rotate("+e+r)}(a.rotate,s.rotate,o,l),function(t,e,i,a){t!==e?a.push({i:i.push(n(i)+"skewX(",null,r)-2,x:jb(t,e)}):e&&i.push(n(i)+"skewX("+e+r)}(a.skewX,s.skewX,o,l),function(t,e,i,r,a,s){if(t!==i||e!==r){var o=a.push(n(a)+"scale(",null,",",null,")");s.push({i:o-4,x:jb(t,i)},{i:o-2,x:jb(e,r)})}else 1===i&&1===r||a.push(n(a)+"scale("+i+","+r+")")}(a.scaleX,a.scaleY,s.scaleX,s.scaleY,o,l),a=s=null,function(t){for(var e,i=-1,r=l.length;++i<r;)o[(e=l[i]).i]=e.x(t);return o.join("")}}}var Gb=Wb((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Zb:qb(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Xb=Wb((function(t){return null==t?Zb:(Ub||(Ub=document.createElementNS("http://www.w3.org/2000/svg","g")),Ub.setAttribute("transform",t),(t=Ub.transform.baseVal.consolidate())?qb((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Zb)}),", ",")",")");function Kb(t){return((t=Math.exp(t))+1/t)/2}var Jb=function t(e,i,r){function n(t,n){var a,s,o=t[0],l=t[1],c=t[2],d=n[0],h=n[1],p=n[2],u=d-o,m=h-l,f=u*u+m*m;if(f<1e-12)s=Math.log(p/c)/e,a=function(t){return[o+t*u,l+t*m,c*Math.exp(e*t*s)]};else{var g=Math.sqrt(f),_=(p*p-c*c+r*f)/(2*c*i*g),v=(p*p-c*c-r*f)/(2*p*i*g),y=Math.log(Math.sqrt(_*_+1)-_),b=Math.log(Math.sqrt(v*v+1)-v);s=(b-y)/e,a=function(t){var r=t*s,n=Kb(y),a=c/(i*g)*(n*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+y)-function(t){return((t=Math.exp(t))-1/t)/2}(y));return[o+a*u,l+a*m,c*n/Kb(e*r+y)]}}return a.duration=1e3*s*e/Math.SQRT2,a}return n.rho=function(e){var i=Math.max(.001,+e),r=i*i;return t(i,r,r*r)},n}(Math.SQRT2,2,4);function Qb(t){return function e(i){function r(e,r){var n=t((e=Sb(e)).h,(r=Sb(r)).h),a=Ib(e.s,r.s),s=Ib(e.l,r.l),o=Ib(e.opacity,r.opacity);return function(t){return e.h=n(t),e.s=a(t),e.l=s(Math.pow(t,i)),e.opacity=o(t),e+""}}return i=+i,r.gamma=e,r}(1)}Qb((function(t,e){var i=e-t;return i?$b(t,i>180||i<-180?i-360*Math.round(i/360):i):Eb(isNaN(t)?e:t)}));var tx=Qb(Ib),ex=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Iy);(t=>{Pb(t[t.length-1])})(ex);var ix=tx(Sb(-100,.75,.35),Sb(80,1.5,.8));tx(Sb(260,.75,.35),Sb(80,1.5,.8)),Sb();var rx="http://www.w3.org/1999/xhtml",nx={svg:"http://www.w3.org/2000/svg",xhtml:rx,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ax(t){var e=t+="",i=e.indexOf(":");return i>=0&&"xmlns"!==(e=t.slice(0,i))&&(t=t.slice(i+1)),nx.hasOwnProperty(e)?{space:nx[e],local:t}:t}function sx(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===rx&&e.documentElement.namespaceURI===rx?e.createElement(t):e.createElementNS(i,t)}}function ox(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function lx(t){var e=ax(t);return(e.local?ox:sx)(e)}function cx(){}function dx(t){return null==t?cx:function(){return this.querySelector(t)}}function hx(){return[]}function px(t){return null==t?hx:function(){return this.querySelectorAll(t)}}function ux(t){return function(){return function(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}function mx(t){return function(){return this.matches(t)}}function fx(t){return function(e){return e.matches(t)}}var gx=Array.prototype.find;function _x(){return this.firstElementChild}var vx=Array.prototype.filter;function yx(){return Array.from(this.children)}function bx(t){return new Array(t.length)}function xx(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function wx(t,e,i,r,n,a){for(var s,o=0,l=e.length,c=a.length;o<c;++o)(s=e[o])?(s.__data__=a[o],r[o]=s):i[o]=new xx(t,a[o]);for(;o<l;++o)(s=e[o])&&(n[o]=s)}function kx(t,e,i,r,n,a,s){var o,l,c,d=new Map,h=e.length,p=a.length,u=new Array(h);for(o=0;o<h;++o)(l=e[o])&&(u[o]=c=s.call(l,l.__data__,o,e)+"",d.has(c)?n[o]=l:d.set(c,l));for(o=0;o<p;++o)c=s.call(t,a[o],o,a)+"",(l=d.get(c))?(r[o]=l,l.__data__=a[o],d.delete(c)):i[o]=new xx(t,a[o]);for(o=0;o<h;++o)(l=e[o])&&d.get(u[o])===l&&(n[o]=l)}function Tx(t){return t.__data__}function Sx(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Cx(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ex(t){return function(){this.removeAttribute(t)}}function $x(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ax(t,e){return function(){this.setAttribute(t,e)}}function Ix(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Mx(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}}function Lx(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function Px(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Rx(t){return function(){this.style.removeProperty(t)}}function zx(t,e,i){return function(){this.style.setProperty(t,e,i)}}function Dx(t,e,i){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,i)}}function jx(t,e){return t.style.getPropertyValue(e)||Px(t).getComputedStyle(t,null).getPropertyValue(e)}function Ox(t){return function(){delete this[t]}}function Bx(t,e){return function(){this[t]=e}}function Fx(t,e){return function(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}}function Nx(t){return t.trim().split(/^|\s+/)}function Hx(t){return t.classList||new Vx(t)}function Vx(t){this._node=t,this._names=Nx(t.getAttribute("class")||"")}function Ux(t,e){for(var i=Hx(t),r=-1,n=e.length;++r<n;)i.add(e[r])}function Yx(t,e){for(var i=Hx(t),r=-1,n=e.length;++r<n;)i.remove(e[r])}function Zx(t){return function(){Ux(this,t)}}function qx(t){return function(){Yx(this,t)}}function Wx(t,e){return function(){(e.apply(this,arguments)?Ux:Yx)(this,t)}}function Gx(){this.textContent=""}function Xx(t){return function(){this.textContent=t}}function Kx(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Jx(){this.innerHTML=""}function Qx(t){return function(){this.innerHTML=t}}function tw(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ew(){this.nextSibling&&this.parentNode.appendChild(this)}function iw(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function rw(){return null}function nw(){var t=this.parentNode;t&&t.removeChild(this)}function aw(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function sw(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ow(t){return function(){var e=this.__on;if(e){for(var i,r=0,n=-1,a=e.length;r<a;++r)i=e[r],t.type&&i.type!==t.type||i.name!==t.name?e[++n]=i:this.removeEventListener(i.type,i.listener,i.options);++n?e.length=n:delete this.__on}}}function lw(t,e,i){return function(){var r,n=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(n)for(var s=0,o=n.length;s<o;++s)if((r=n[s]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=i),void(r.value=e);this.addEventListener(t.type,a,i),r={type:t.type,name:t.name,value:e,listener:a,options:i},n?n.push(r):this.__on=[r]}}function cw(t,e,i){var r=Px(t),n=r.CustomEvent;"function"==typeof n?n=new n(e,i):(n=r.document.createEvent("Event"),i?(n.initEvent(e,i.bubbles,i.cancelable),n.detail=i.detail):n.initEvent(e,!1,!1)),t.dispatchEvent(n)}function dw(t,e){return function(){return cw(this,t,e)}}function hw(t,e){return function(){return cw(this,t,e.apply(this,arguments))}}xx.prototype={constructor:xx,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},Vx.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var pw=[null];function uw(t,e){this._groups=t,this._parents=e}function mw(){return new uw([[document.documentElement]],pw)}function fw(t){return"string"==typeof t?new uw([[document.querySelector(t)]],[document.documentElement]):new uw([[t]],pw)}function gw(t){return fw(lx(t).call(document.documentElement))}function _w(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var i=e.ownerSVGElement||e;if(i.createSVGPoint){var r=i.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var n=e.getBoundingClientRect();return[t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop]}}return[t.pageX,t.pageY]}function vw(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function yw(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function bw(t){let e,i,r;function n(t,r,n=0,a=t.length){if(n<a){if(0!==e(r,r))return a;do{const e=n+a>>>1;i(t[e],r)<0?n=e+1:a=e}while(n<a)}return n}return 2!==t.length?(e=vw,i=(e,i)=>vw(t(e),i),r=(e,i)=>t(e)-i):(e=t===vw||t===yw?t:xw,i=t,r=t),{left:n,center:function(t,e,i=0,a=t.length){const s=n(t,e,i,a-1);return s>i&&r(t[s-1],e)>-r(t[s],e)?s-1:s},right:function(t,r,n=0,a=t.length){if(n<a){if(0!==e(r,r))return a;do{const e=n+a>>>1;i(t[e],r)<=0?n=e+1:a=e}while(n<a)}return n}}}function xw(){return 0}uw.prototype=mw.prototype={constructor:uw,select:function(t){"function"!=typeof t&&(t=dx(t));for(var e=this._groups,i=e.length,r=new Array(i),n=0;n<i;++n)for(var a,s,o=e[n],l=o.length,c=r[n]=new Array(l),d=0;d<l;++d)(a=o[d])&&(s=t.call(a,a.__data__,d,o))&&("__data__"in a&&(s.__data__=a.__data__),c[d]=s);return new uw(r,this._parents)},selectAll:function(t){t="function"==typeof t?ux(t):px(t);for(var e=this._groups,i=e.length,r=[],n=[],a=0;a<i;++a)for(var s,o=e[a],l=o.length,c=0;c<l;++c)(s=o[c])&&(r.push(t.call(s,s.__data__,c,o)),n.push(s));return new uw(r,n)},selectChild:function(t){return this.select(null==t?_x:function(t){return function(){return gx.call(this.children,t)}}("function"==typeof t?t:fx(t)))},selectChildren:function(t){return this.selectAll(null==t?yx:function(t){return function(){return vx.call(this.children,t)}}("function"==typeof t?t:fx(t)))},filter:function(t){"function"!=typeof t&&(t=mx(t));for(var e=this._groups,i=e.length,r=new Array(i),n=0;n<i;++n)for(var a,s=e[n],o=s.length,l=r[n]=[],c=0;c<o;++c)(a=s[c])&&t.call(a,a.__data__,c,s)&&l.push(a);return new uw(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Tx);var i=e?kx:wx,r=this._parents,n=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var a=n.length,s=new Array(a),o=new Array(a),l=new Array(a),c=0;c<a;++c){var d=r[c],h=n[c],p=h.length,u=Sx(t.call(d,d&&d.__data__,c,r)),m=u.length,f=o[c]=new Array(m),g=s[c]=new Array(m);i(d,h,f,g,l[c]=new Array(p),u,e);for(var _,v,y=0,b=0;y<m;++y)if(_=f[y]){for(y>=b&&(b=y+1);!(v=g[b])&&++b<m;);_._next=v||null}}return(s=new uw(s,r))._enter=o,s._exit=l,s},enter:function(){return new uw(this._enter||this._groups.map(bx),this._parents)},exit:function(){return new uw(this._exit||this._groups.map(bx),this._parents)},join:function(t,e,i){var r=this.enter(),n=this,a=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(n=e(n))&&(n=n.selection()),null==i?a.remove():i(a),r&&n?r.merge(n).order():n},merge:function(t){for(var e=t.selection?t.selection():t,i=this._groups,r=e._groups,n=i.length,a=r.length,s=Math.min(n,a),o=new Array(n),l=0;l<s;++l)for(var c,d=i[l],h=r[l],p=d.length,u=o[l]=new Array(p),m=0;m<p;++m)(c=d[m]||h[m])&&(u[m]=c);for(;l<n;++l)o[l]=i[l];return new uw(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var r,n=t[e],a=n.length-1,s=n[a];--a>=0;)(r=n[a])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,i){return e&&i?t(e.__data__,i.__data__):!e-!i}t||(t=Cx);for(var i=this._groups,r=i.length,n=new Array(r),a=0;a<r;++a){for(var s,o=i[a],l=o.length,c=n[a]=new Array(l),d=0;d<l;++d)(s=o[d])&&(c[d]=s);c.sort(e)}return new uw(n,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var r=t[e],n=0,a=r.length;n<a;++n){var s=r[n];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,i=0,r=e.length;i<r;++i)for(var n,a=e[i],s=0,o=a.length;s<o;++s)(n=a[s])&&t.call(n,n.__data__,s,a);return this},attr:function(t,e){var i=ax(t);if(arguments.length<2){var r=this.node();return i.local?r.getAttributeNS(i.space,i.local):r.getAttribute(i)}return this.each((null==e?i.local?$x:Ex:"function"==typeof e?i.local?Lx:Mx:i.local?Ix:Ax)(i,e))},style:function(t,e,i){return arguments.length>1?this.each((null==e?Rx:"function"==typeof e?Dx:zx)(t,e,null==i?"":i)):jx(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Ox:"function"==typeof e?Fx:Bx)(t,e)):this.node()[t]},classed:function(t,e){var i=Nx(t+"");if(arguments.length<2){for(var r=Hx(this.node()),n=-1,a=i.length;++n<a;)if(!r.contains(i[n]))return!1;return!0}return this.each(("function"==typeof e?Wx:e?Zx:qx)(i,e))},text:function(t){return arguments.length?this.each(null==t?Gx:("function"==typeof t?Kx:Xx)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Jx:("function"==typeof t?tw:Qx)(t)):this.node().innerHTML},raise:function(){return this.each(ew)},lower:function(){return this.each(iw)},append:function(t){var e="function"==typeof t?t:lx(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var i="function"==typeof t?t:lx(t),r=null==e?rw:"function"==typeof e?e:dx(e);return this.select((function(){return this.insertBefore(i.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(nw)},clone:function(t){return this.select(t?sw:aw)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,i){var r,n,a=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}}))}(t+""),s=a.length;if(!(arguments.length<2)){for(o=e?lw:ow,r=0;r<s;++r)this.each(o(a[r],e,i));return this}var o=this.node().__on;if(o)for(var l,c=0,d=o.length;c<d;++c)for(r=0,l=o[c];r<s;++r)if((n=a[r]).type===l.type&&n.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?hw:dw)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var r,n=t[e],a=0,s=n.length;a<s;++a)(r=n[a])&&(yield r)}};const ww=bw(vw).right;bw((function(t){return null===t?NaN:+t})).center;var kw=ww;class Tw extends Map{constructor(t,e=Cw){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,i]of t)this.set(e,i)}get(t){return super.get(Sw(this,t))}has(t){return super.has(Sw(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},i){const r=e(i);return t.has(r)?t.get(r):(t.set(r,i),i)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},i){const r=e(i);t.has(r)&&(i=t.get(r),t.delete(r));return i}(this,t))}}function Sw({_intern:t,_key:e},i){const r=e(i);return t.has(r)?t.get(r):i}function Cw(t){return null!==t&&"object"==typeof t?t.valueOf():t}const Ew=Math.sqrt(50),$w=Math.sqrt(10),Aw=Math.sqrt(2);function Iw(t,e,i){const r=(e-t)/Math.max(0,i),n=Math.floor(Math.log10(r)),a=r/Math.pow(10,n),s=a>=Ew?10:a>=$w?5:a>=Aw?2:1;let o,l,c;return n<0?(c=Math.pow(10,-n)/s,o=Math.round(t*c),l=Math.round(e*c),o/c<t&&++o,l/c>e&&--l,c=-c):(c=Math.pow(10,n)*s,o=Math.round(t/c),l=Math.round(e/c),o*c<t&&++o,l*c>e&&--l),l<o&&.5<=i&&i<2?Iw(t,e,2*i):[o,l,c]}function Mw(t,e,i){return Iw(t=+t,e=+e,i=+i)[2]}function Lw(t,e,i){t=+t,e=+e,i=(n=arguments.length)<2?(e=t,t=0,1):n<3?1:+i;for(var r=-1,n=0|Math.max(0,Math.ceil((e-t)/i)),a=new Array(n);++r<n;)a[r]=t+r*i;return a}function Pw(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Rw(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}const zw=Symbol("implicit");function Dw(){var t=new Tw,e=[],i=[],r=zw;function n(n){let a=t.get(n);if(void 0===a){if(r!==zw)return r;t.set(n,a=e.push(n)-1)}return i[a%i.length]}return n.domain=function(i){if(!arguments.length)return e.slice();e=[],t=new Tw;for(const r of i)t.has(r)||t.set(r,e.push(r)-1);return n},n.range=function(t){return arguments.length?(i=Array.from(t),n):i.slice()},n.unknown=function(t){return arguments.length?(r=t,n):r},n.copy=function(){return Dw(e,i).unknown(r)},Pw.apply(n,arguments),n}function jw(){var t,e,i=Dw().unknown(void 0),r=i.domain,n=i.range,a=0,s=1,o=!1,l=0,c=0,d=.5;function h(){var i=r().length,h=s<a,p=h?s:a,u=h?a:s;t=(u-p)/Math.max(1,i-l+2*c),o&&(t=Math.floor(t)),p+=(u-p-t*(i-l))*d,e=t*(1-l),o&&(p=Math.round(p),e=Math.round(e));var m=Lw(i).map((function(e){return p+t*e}));return n(h?m.reverse():m)}return delete i.unknown,i.domain=function(t){return arguments.length?(r(t),h()):r()},i.range=function(t){return arguments.length?([a,s]=t,a=+a,s=+s,h()):[a,s]},i.rangeRound=function(t){return[a,s]=t,a=+a,s=+s,o=!0,h()},i.bandwidth=function(){return e},i.step=function(){return t},i.round=function(t){return arguments.length?(o=!!t,h()):o},i.padding=function(t){return arguments.length?(l=Math.min(1,c=+t),h()):l},i.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),h()):l},i.paddingOuter=function(t){return arguments.length?(c=+t,h()):c},i.align=function(t){return arguments.length?(d=Math.max(0,Math.min(1,t)),h()):d},i.copy=function(){return jw(r(),[a,s]).round(o).paddingInner(l).paddingOuter(c).align(d)},Pw.apply(h(),arguments)}function Ow(t){return+t}var Bw=[0,1];function Fw(t){return t}function Nw(t,e){return(e-=t=+t)?function(i){return(i-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function Hw(t,e,i){var r=t[0],n=t[1],a=e[0],s=e[1];return n<r?(r=Nw(n,r),a=i(s,a)):(r=Nw(r,n),a=i(a,s)),function(t){return a(r(t))}}function Vw(t,e,i){var r=Math.min(t.length,e.length)-1,n=new Array(r),a=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)n[s]=Nw(t[s],t[s+1]),a[s]=i(e[s],e[s+1]);return function(e){var i=kw(t,e,1,r)-1;return a[i](n[i](e))}}function Uw(){var t,e,i,r,n,a,s=Bw,o=Bw,l=Hb,c=Fw;function d(){var t=Math.min(s.length,o.length);return c!==Fw&&(c=function(t,e){var i;return t>e&&(i=t,t=e,e=i),function(i){return Math.max(t,Math.min(e,i))}}(s[0],s[t-1])),r=t>2?Vw:Hw,n=a=null,h}function h(e){return null==e||isNaN(e=+e)?i:(n||(n=r(s.map(t),o,l)))(t(c(e)))}return h.invert=function(i){return c(e((a||(a=r(o,s.map(t),jb)))(i)))},h.domain=function(t){return arguments.length?(s=Array.from(t,Ow),d()):s.slice()},h.range=function(t){return arguments.length?(o=Array.from(t),d()):o.slice()},h.rangeRound=function(t){return o=Array.from(t),l=Vb,d()},h.clamp=function(t){return arguments.length?(c=!!t||Fw,d()):c!==Fw},h.interpolate=function(t){return arguments.length?(l=t,d()):l},h.unknown=function(t){return arguments.length?(i=t,h):i},function(i,r){return t=i,e=r,d()}}function Yw(t,e){if((i=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var i,r=t.slice(0,i);return[r.length>1?r[0]+r.slice(2):r,+t.slice(i+1)]}function Zw(t){return(t=Yw(Math.abs(t)))?t[1]:NaN}var qw,Ww=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gw(t){if(!(e=Ww.exec(t)))throw new Error("invalid format: "+t);var e;return new Xw({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Xw(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Kw(t,e){var i=Yw(t,e);if(!i)return t+"";var r=i[0],n=i[1];return n<0?"0."+new Array(-n).join("0")+r:r.length>n+1?r.slice(0,n+1)+"."+r.slice(n+1):r+new Array(n-r.length+2).join("0")}Gw.prototype=Xw.prototype,Xw.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Jw={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Kw(100*t,e),r:Kw,s:function(t,e){var i=Yw(t,e);if(!i)return t+"";var r=i[0],n=i[1],a=n-(qw=3*Math.max(-8,Math.min(8,Math.floor(n/3))))+1,s=r.length;return a===s?r:a>s?r+new Array(a-s+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Yw(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Qw(t){return t}var tk,ek,ik,rk=Array.prototype.map,nk=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function ak(t){var e,i,r=void 0===t.grouping||void 0===t.thousands?Qw:(e=rk.call(t.grouping,Number),i=t.thousands+"",function(t,r){for(var n=t.length,a=[],s=0,o=e[0],l=0;n>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),a.push(t.substring(n-=o,n+o)),!((l+=o+1)>r));)o=e[s=(s+1)%e.length];return a.reverse().join(i)}),n=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",o=void 0===t.numerals?Qw:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(rk.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"":t.minus+"",d=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Gw(t)).fill,i=t.align,h=t.sign,p=t.symbol,u=t.zero,m=t.width,f=t.comma,g=t.precision,_=t.trim,v=t.type;"n"===v?(f=!0,v="g"):Jw[v]||(void 0===g&&(g=12),_=!0,v="g"),(u||"0"===e&&"="===i)&&(u=!0,e="0",i="=");var y="$"===p?n:"#"===p&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",b="$"===p?a:/[%p]/.test(v)?l:"",x=Jw[v],w=/[defgprs%]/.test(v);function k(t){var n,a,l,p=y,k=b;if("c"===v)k=x(t)+k,t="";else{var T=(t=+t)<0||1/t<0;if(t=isNaN(t)?d:x(Math.abs(t),g),_&&(t=function(t){t:for(var e,i=t.length,r=1,n=-1;r<i;++r)switch(t[r]){case".":n=e=r;break;case"0":0===n&&(n=r),e=r;break;default:if(!+t[r])break t;n>0&&(n=0)}return n>0?t.slice(0,n)+t.slice(e+1):t}(t)),T&&0==+t&&"+"!==h&&(T=!1),p=(T?"("===h?h:c:"-"===h||"("===h?"":h)+p,k=("s"===v?nk[8+qw/3]:"")+k+(T&&"("===h?")":""),w)for(n=-1,a=t.length;++n<a;)if(48>(l=t.charCodeAt(n))||l>57){k=(46===l?s+t.slice(n+1):t.slice(n))+k,t=t.slice(0,n);break}}f&&!u&&(t=r(t,1/0));var S=p.length+t.length+k.length,C=S<m?new Array(m-S+1).join(e):"";switch(f&&u&&(t=r(C+t,C.length?m-k.length:1/0),C=""),i){case"<":t=p+t+k+C;break;case"=":t=p+C+t+k;break;case"^":t=C.slice(0,S=C.length>>1)+p+t+k+C.slice(S);break;default:t=C+p+t+k}return o(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),k.toString=function(){return t+""},k}return{format:h,formatPrefix:function(t,e){var i=h(((t=Gw(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Zw(e)/3))),n=Math.pow(10,-r),a=nk[8+r/3];return function(t){return i(n*t)+a}}}}function sk(t,e,i,r){var n,a=function(t,e,i){i=+i;const r=(e=+e)<(t=+t),n=r?Mw(e,t,i):Mw(t,e,i);return(r?-1:1)*(n<0?1/-n:n)}(t,e,i);switch((r=Gw(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(n=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Zw(e)/3)))-Zw(Math.abs(t)))}(a,s))||(r.precision=n),ik(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(n=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Zw(e)-Zw(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=n-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(n=function(t){return Math.max(0,-Zw(Math.abs(t)))}(a))||(r.precision=n-2*("%"===r.type))}return ek(r)}function ok(t){var e=t.domain;return t.ticks=function(t){var i=e();return function(t,e,i){if(!((i=+i)>0))return[];if((t=+t)==(e=+e))return[t];const r=e<t,[n,a,s]=r?Iw(e,t,i):Iw(t,e,i);if(!(a>=n))return[];const o=a-n+1,l=new Array(o);if(r)if(s<0)for(let t=0;t<o;++t)l[t]=(a-t)/-s;else for(let t=0;t<o;++t)l[t]=(a-t)*s;else if(s<0)for(let t=0;t<o;++t)l[t]=(n+t)/-s;else for(let t=0;t<o;++t)l[t]=(n+t)*s;return l}(i[0],i[i.length-1],null==t?10:t)},t.tickFormat=function(t,i){var r=e();return sk(r[0],r[r.length-1],null==t?10:t,i)},t.nice=function(i){null==i&&(i=10);var r,n,a=e(),s=0,o=a.length-1,l=a[s],c=a[o],d=10;for(c<l&&(n=l,l=c,c=n,n=s,s=o,o=n);d-- >0;){if((n=Mw(l,c,i))===r)return a[s]=l,a[o]=c,e(a);if(n>0)l=Math.floor(l/n)*n,c=Math.ceil(c/n)*n;else{if(!(n<0))break;l=Math.ceil(l*n)/n,c=Math.floor(c*n)/n}r=n}return t},t}function lk(){var t=Uw()(Fw,Fw);return t.copy=function(){return e=t,lk().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},Pw.apply(t,arguments),ok(t)}function ck(){var t=ok(function(){var t,e,i,r,n,a=0,s=1,o=Fw,l=!1;function c(e){return null==e||isNaN(e=+e)?n:o(0===i?.5:(e=(r(e)-t)*i,l?Math.max(0,Math.min(1,e)):e))}function d(t){return function(e){var i,r;return arguments.length?([i,r]=e,o=t(i,r),c):[o(0),o(1)]}}return c.domain=function(n){return arguments.length?([a,s]=n,t=r(a=+a),e=r(s=+s),i=t===e?0:1/(e-t),c):[a,s]},c.clamp=function(t){return arguments.length?(l=!!t,c):l},c.interpolator=function(t){return arguments.length?(o=t,c):o},c.range=d(Hb),c.rangeRound=d(Vb),c.unknown=function(t){return arguments.length?(n=t,c):n},function(n){return r=n,t=n(a),e=n(s),i=t===e?0:1/(e-t),c}}()(Fw));return t.copy=function(){return e=t,ck().domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown());var e},Rw.apply(t,arguments)}function dk(t){return t}tk=ak({thousands:",",grouping:[3],currency:["$",""]}),ek=tk.format,ik=tk.formatPrefix;var hk=1,pk=2,uk=3,mk=4,fk=1e-6;function gk(t){return"translate("+t+",0)"}function _k(t){return"translate(0,"+t+")"}function vk(t){return e=>+t(e)}function yk(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),i=>+t(i)+e}function bk(){return!this.__axis}function xk(t,e){var i=[],r=null,n=null,a=6,s=6,o=3,l="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,c=t===hk||t===mk?-1:1,d=t===mk||t===pk?"x":"y",h=t===hk||t===uk?gk:_k;function p(p){var u=null==r?e.ticks?e.ticks.apply(e,i):e.domain():r,m=null==n?e.tickFormat?e.tickFormat.apply(e,i):dk:n,f=Math.max(a,0)+o,g=e.range(),_=+g[0]+l,v=+g[g.length-1]+l,y=(e.bandwidth?yk:vk)(e.copy(),l),b=p.selection?p.selection():p,x=b.selectAll(".domain").data([null]),w=b.selectAll(".tick").data(u,e).order(),k=w.exit(),T=w.enter().append("g").attr("class","tick"),S=w.select("line"),C=w.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),w=w.merge(T),S=S.merge(T.append("line").attr("stroke","currentColor").attr(d+"2",c*a)),C=C.merge(T.append("text").attr("fill","currentColor").attr(d,c*f).attr("dy",t===hk?"0em":t===uk?"0.71em":"0.32em")),p!==b&&(x=x.transition(p),w=w.transition(p),S=S.transition(p),C=C.transition(p),k=k.transition(p).attr("opacity",fk).attr("transform",(function(t){return isFinite(t=y(t))?h(t+l):this.getAttribute("transform")})),T.attr("opacity",fk).attr("transform",(function(t){var e=this.parentNode.__axis;return h((e&&isFinite(e=e(t))?e:y(t))+l)}))),k.remove(),x.attr("d",t===mk||t===pk?s?"M"+c*s+","+_+"H"+l+"V"+v+"H"+c*s:"M"+l+","+_+"V"+v:s?"M"+_+","+c*s+"V"+l+"H"+v+"V"+c*s:"M"+_+","+l+"H"+v),w.attr("opacity",1).attr("transform",(function(t){return h(y(t)+l)})),S.attr(d+"2",c*a),C.attr(d,c*f).text(m),b.filter(bk).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===pk?"start":t===mk?"end":"middle"),b.each((function(){this.__axis=y}))}return p.scale=function(t){return arguments.length?(e=t,p):e},p.ticks=function(){return i=Array.from(arguments),p},p.tickArguments=function(t){return arguments.length?(i=null==t?[]:Array.from(t),p):i.slice()},p.tickValues=function(t){return arguments.length?(r=null==t?null:Array.from(t),p):r&&r.slice()},p.tickFormat=function(t){return arguments.length?(n=t,p):n},p.tickSize=function(t){return arguments.length?(a=s=+t,p):a},p.tickSizeInner=function(t){return arguments.length?(a=+t,p):a},p.tickSizeOuter=function(t){return arguments.length?(s=+t,p):s},p.tickPadding=function(t){return arguments.length?(o=+t,p):o},p.offset=function(t){return arguments.length?(l=+t,p):l},p}const wk={1:249250621,2:243199373,3:198022430,4:191154276,5:180915260,6:171115067,7:159138663,8:146364022,9:141213431,10:135534747,11:135006516,12:133851895,13:115169878,14:107349540,15:102531392,16:90354753,17:81195210,18:78077248,19:59128983,20:63025520,21:48129895,22:51304566,X:155270560};function kk(t,{fontFamily:e="Inter var",fontSize:i=16,fontWeight:r=350,fontColor:n="rgba(0, 0, 0, 0.8)",width:a=800,margin:s={top:0,right:10,bottom:0,left:35},interGroupPadding:o=.2,intraGroupPadding:l=.15,barHeight:c=11,tickPadding:d=13,colorP:h="#EEF1F5",colorM:p="#F9ECEE"}={}){const u=Object.keys(wk),m=["P","M"],f=u.map((t=>({group:t,P:wk[t],M:wk[t]}))),g=(2+1*l/(1-l))*c,_=(f.length+(f.length+1)*o/(1-o))*g,v=gw("svg").attr("width",a+s.left+s.right).attr("height",_+s.top+s.bottom).attr("style","max-width: 100%; height: intrinsic;").attr("font-family",e).attr("font-size",i).attr("font-weight",r),y=t.map((t=>t.handle)),b=Dw().domain(y).range(Py);v.append("defs").selectAll("pattern").data(t).join("pattern").attr("id",((t,e)=>`pattern-${e}`)).attr("width",8).attr("height",8).attr("patternUnits","userSpaceOnUse").attr("patternTransform","rotate(45)").append("rect").attr("width",4).attr("height",8).attr("style",(t=>`fill:${b(t.handle)}`));const x=v.append("g").attr("transform",`translate(${s.left},${s.top})`),w=jw().domain(u).range([0,_]).padding([o]);x.append("g").call(function(t){return xk(mk,t)}(w).tickSize(0).tickPadding(d)).attr("font-family",e).attr("font-size",i).attr("color",n).attr("stroke-width",0);const k=lk().domain([0,249250621]).range([0,a]),T=jw().domain(m).range([0,w.bandwidth()]).paddingInner([l]),S=Dw().domain(m).range([h,p]);return x.append("g").selectAll("g").data(f).join("g").attr("transform",(t=>`translate(0, ${w(t.group)})`)).selectAll("rect").data((t=>m.map((e=>({key:e,value:t[e]}))))).join("rect").attr("y",(t=>T(t.key))).attr("x",0).attr("rx",2).attr("width",(t=>k(t.value))).attr("height",T.bandwidth()).attr("fill",(t=>S(t.key))),x.append("g").selectAll("g").data(t).join("g").selectAll("g").data(((t,e)=>t.segments.map((i=>({...i,handle:t.handle,index:e}))))).join("g").attr("transform",(t=>`translate(0, ${w(t.chromosome)})`)).selectAll("rect").data(((t,e)=>m.filter((e=>e===t.side||"U"===t.side&&"P"===e)).map((i=>({...t,subgroup:i,color:b(t.handle),segmentIndex:e}))))).join("rect").attr("y",(t=>T(t.subgroup))).attr("x",(t=>k(t.start))).attr("rx",2).attr("width",(t=>k(t.stop-t.start))).attr("height",(t=>"U"===t.side?w.bandwidth():T.bandwidth())).attr("fill",(t=>"U"===t.side?`url(#pattern-${t.index})`:t.color)).attr("opacity",.8).attr("id",(t=>`rect-segment-${t.handle}-${t.start}-${t.stop}`)),v.node()}class Tk extends(al(K)){static get styles(){return[nl,n`
        svg a {
          text-decoration: none !important;
        }

        div#container {
          display: inline-block;
          max-width: 800px;
          vertical-align: top;
          margin-bottom: 20px;
        }

        div#legend {
          display: inline-block;
          vertical-align: top;
          padding: 0;
          font-size: 15px;
          font-weight: 330;
          margin-left: 20px;
        }

        #legend ul {
          list-style-type: none;
          padding: 0;
          margin: 0;
        }

        #legend ul li {
          padding: 4px;
          margin: 0;
          cursor: pointer;
        }

        #legend ul li.muted {
          opacity: 0.3;
        }

        span.dot {
          display: inline-block;
          width: 11px;
          height: 11px;
          border-radius: 3px;
          margin-right: 8px;
          opacity: 0.9;
        }

        @keyframes pulse {
          0% {
            opacity: 0.1;
          }
          50% {
            opacity: 1;
          }
          100% {
            opacity: 0.1;
          }
        }

        div.loading svg {
          animation: pulse 1.5s linear infinite;
        }
      `]}static get properties(){return{data:{type:Array},width:{type:String},selected:{type:Number},person:{type:Object},loading:{type:Boolean}}}constructor(){super(),this.data=[],this.width=600,this.selected=-1,this.person={},this.loading=!1}render(){return M`${this.renderChart()} `}renderChart(){let{data:t}=this;return this.selected>=0&&(t=t.map(((t,e)=>e===this.selected?t:{segments:[],handle:t.handle}))),M`
      <div id="container" class="${Ot({loading:this.loading})}">
        ${kk(t,{width:this.width})}
      </div>
      <div id="legend">${this.renderLegend()}</div>
    `}_getNameFromHandle(t){let e=(this.person?.extended?.people||[]).filter((e=>e.handle===t));return 0===e.length?"":(e=e[0],Ga(e))}renderLegend(){return M`<ul>
      ${this.data.map(((t,e)=>M`
          <li
            @click="${t=>this._handleLegendClick(t,e)}"
            @keydown="${gs}"
            class="${Ot({muted:this.selected>-1&&this.selected!==e})}"
            id="legend-item-${e}"
          >
            <span class="dot" style="background-color:${Py[e]};"></span
            >${this._getNameFromHandle(t.handle)}
          </li>
        `))}
    </ul> `}updated(t){(t.has("data")||t.has("selected")||t.has("width"))&&this._updateTooltips()}_updateTooltips(){this.data.map((t=>t.segments.map((e=>{const i=`rect-segment-${t.handle}-${e.start}-${e.stop}`,r=this.renderRoot.getElementById(i);return r&&ud(r,{content:`\n            ${this._getNameFromHandle(t.handle)}<br/>\n            ${e.cM?`<b>${(new Intl.NumberFormat).format(e.cM)} cM</b>`:""}${e.cM&&e.SNPs?",":""}\n            ${e.SNPs?`${e.SNPs} SNPs`:""}\n            ${e.cM||e.SNPs?"<br/>":""}\n            ${(new Intl.NumberFormat).format(e.start)}&ndash;${(new Intl.NumberFormat).format(e.stop)}<br/>\n            ${t.ancestor_profiles?.length?`${this._("Common ancestors")}: ${t.ancestor_profiles.map((t=>`${t.name_given} ${t.name_surname}`)).join(", ")}<br/>`:""}\n            ${t.relation?`${this._("Relationship")}: ${t.relation}`:""}\n            `,allowHTML:!0}),null}))))}_handleLegendClick(t,e){this.selected=this.selected===e?-1:e,t.preventDefault(),t.stopPropagation()}firstUpdated(){const t=this.renderRoot.getElementById("container");this.handleResize(),new ResizeObserver((()=>this.handleResize())).observe(t)}handleResize(){const t=this.renderRoot.getElementById("container");this.width=t.offsetWidth-45}}window.customElements.define("grampsjs-chromosome-browser",Tk);class Sk extends(al(K)){static get styles(){return[nl,n`
        .match {
          border-top: 1px solid rgba(0, 0, 0, 0.1);
          padding: 0 20px;
        }

        .match:last-child {
          border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        .head {
          display: inline-block;
          margin-right: 2em;
          vertical-align: middle;
          width: 10rem;
          padding: 20px 0;
        }

        .name {
          font-weight: 350;
          font-size: 17px;
        }

        dl {
          display: inline-block;
          vertical-align: middle;
        }

        dd {
          font-size: 15px;
        }
      `]}static get properties(){return{data:{type:Array},person:{type:Object},loading:{type:Boolean}}}constructor(){super(),this.data=[],this.person={},this.loading=!1}render(){return this.loading?this.renderLoading():M`
      <table>
        ${this.data.filter((t=>t.segments&&t.segments.length>0)).map((t=>this._personCard(t)))}
      </table>
    `}renderLoading(){const t=this.person?.person_ref_list?.filter((t=>"DNA"===t.rel))?.length??1;return M`
      <table>
        ${[...Array(t).keys()].map((()=>M`
            <div class="match">
              <div class="head">
                <span class="name">
                  <span class="skeleton" style="width: 7em; height: 1.2em;"
                    >&nbsp;</span
                  >
                </span>
              </div>
              <dl>
                <div>
                  <dt>${this._("Relationship")}</dt>
                  <dd>
                    <span class="skeleton" style="width: 7em;">&nbsp;</span>
                  </dd>
                </div>
                <div>
                  <dt>${this._("Shared DNA")}</dt>
                  <dd>
                    <span class="skeleton" style="width: 3em;">&nbsp;</span>
                  </dd>
                </div>
                <div>
                  <dt>${this._("Shared Segments")}</dt>
                  <dd>
                    <span class="skeleton" style="width: 2em;">&nbsp;</span>
                  </dd>
                </div>
                <div>
                  <dt>${this._("Largest Segment")}</dt>
                  <dd>
                    <span class="skeleton" style="width: 3em;">&nbsp;</span>
                  </dd>
                </div>
              </dl>
            </div>
          `))}
      </table>
    `}_personCard(t){return M`
      <div class="match">
        <div class="head">
          <span class="name">
            <a href="/person/${this._getGidFromHandle(t.handle)}"
              >${this._getNameFromHandle(t.handle)}</a
            ></span
          >
        </div>
        <dl>
          <div>
            <dt>${this._("Relationship")}</dt>
            <dd>${t.relation||this._("Unknown")}</dd>
          </div>
          <div>
            <dt>${this._("Shared DNA")}</dt>
            <dd>
              ${t.segments.reduce(((t,e)=>t+e.cM),0).toFixed(1)}
              cM
            </dd>
          </div>
          <div>
            <dt>${this._("Shared Segments")}</dt>
            <dd>${t.segments.length}</dd>
          </div>
          <div>
            <dt>${this._("Largest Segment")}</dt>
            <dd>
              ${t.segments.reduce(((t,e)=>Math.max(t,e.cM)),0).toFixed(1)}
              cM
            </dd>
          </div>
        </dl>
      </div>
    `}_getNameFromHandle(t){let e=(this.person?.extended?.people||[]).filter((e=>e.handle===t));return 0===e.length?"":(e=e[0],Ga(e))}_getGidFromHandle(t){let e=(this.person?.extended?.people||[]).filter((e=>e.handle===t));return 0===e.length?"":(e=e[0],e.gramps_id)}}window.customElements.define("grampsjs-dna-matches",Sk);window.customElements.define("grampsjs-view-person-dna",class extends $d{static get styles(){return[super.styles,n`
        :host {
          margin: 0;
        }

        h3 {
          margin: 1.2em 0;
        }
      `]}static get properties(){return{handle:{type:String},_data:{type:Array},person:{type:Object}}}constructor(){super(),this.handle="",this._data=[],this.person={}}renderContent(){return this.renderElements()}renderElements(){return M`
      <h3>${this._("Matches")}</h3>
      <grampsjs-dna-matches
        .data="${this._data}"
        .strings="${this.strings}"
        .person="${this.person}"
        ?loading="${this.loading}"
      ></grampsjs-dna-matches>
      <h3>${this._("Chromosome Browser")}</h3>
      <grampsjs-chromosome-browser
        .data="${this._data}"
        .strings="${this.strings}"
        .person="${this.person}"
        ?loading="${this.loading}"
      ></grampsjs-chromosome-browser>
    `}update(t){super.update(t),this.active&&t.has("handle")&&this._updateData()}get _url(){return`/api/people/${this.handle}/dna/matches?locale=${this.strings.__lang__||"en"}`}_updateData(){this.handle&&(this._data=[],this.loading=!0,On(this._url).then((t=>{this.loading=!1,"data"in t?(this.error=!1,this._data=t.data):"error"in t&&(this.error=!0,this._errorMessage=t.error)})))}});class Ck extends(al(K)){static get styles(){return[nl,n`
        dl {
          clear: left;
        }

        dl > div {
          float: none;
        }

        dl > div > dt {
          display: inline-block;
          width: 10em;
          margin-right: 1em;
          text-align: right;
        }

        dl > div > dd {
          display: inline-block;
        }
      `]}static get properties(){return{data:{type:Object}}}constructor(){super(),this.data={}}render(){return 0===Object.keys(this.data).length?"":M`
    ${this.data.map((t=>M`
        <dl>
          ${t?.date?.dateval?M`
                <div>
                  <dt>${this._("Date")}</dt>
                  <dd>${this._toDate(t?.date?.dateval)}</dd>
                </div>
              `:""}
          ${t.street?M`
                <div>
                  <dt>${this._("Street")}</dt>
                  <dd>${t.street}</dd>
                </div>
              `:""}
          ${t.locality?M`
                <div>
                  <dt>${this._("Locality")}</dt>
                  <dd>${t.locality}</dd>
                </div>
              `:""}
          ${t.city?M`
                <div>
                  <dt>${this._("City")}</dt>
                  <dd>${t.city}</dd>
                </div>
              `:""}
          ${t.county?M`
                <div>
                  <dt>${this._("County")}</dt>
                  <dd>${t.county}</dd>
                </div>
              `:""}
          ${t.state?M`
                <div>
                  <dt>${this._("State")}</dt>
                  <dd>${t.state}</dd>
                </div>
              `:""}
          ${t.country?M`
                <div>
                  <dt>${this._("Country")}</dt>
                  <dd>${t.country}</dd>
                </div>
              `:""}
        </dl>
      `))}
      </table>
    `}_toDate(t){try{return`${t[2]}-${t[1]}-${t[0]}`}catch{return""}}}window.customElements.define("grampsjs-addresses",Ck);window.customElements.define("grampsjs-form-edit-association",class extends lh{static get properties(){return{person:{type:Object},personProfile:{type:Object}}}constructor(){super(),this.person={},this.personProfile={}}renderForm(){return M`
      <h4 class="label">${this._("Person")}</h4>
      <p>
        <grampsjs-form-select-object-list
          fixedMenuPosition
          style="min-height: 300px;"
          objectType="person"
          .strings="${this.strings}"
          id="person-select"
          label="${this._("Select")}"
          .objectsInitial="${this.data.ref?[{object_type:"person",object:this.person,handle:this.data.ref}]:[]}"
          class="edit"
        ></grampsjs-form-select-object-list>
      </p>

      <p>
        <grampsjs-form-string
          required
          fullwidth
          id="rel"
          @formdata:changed="${this._handleFormData}"
          label="${this._("Association")}"
          .strings="${this.strings}"
          .data="${this.data}"
          value="${this.data?.rel||""}"
        >
        </grampsjs-form-string>
      </p>

      <h4 class="label">${this._("Citations")}</h4>
      <p>
        <grampsjs-form-select-object-list
          multiple
          fixedMenuPosition
          style="min-height: 300px;"
          objectType="citation"
          .strings="${this.strings}"
          id="personref-citation-select"
          label="${this._("Select")}"
          .objectsInitial="${this.data.citation_list&&this.data.citation_list.length?this.data.citation_list.map((t=>({object_type:"citation",object:{},handle:t}))):[]}"
          class="edit"
        ></grampsjs-form-select-object-list>
      </p>

      <h4 class="label">${this._("Notes")}</h4>
      <p>
        <grampsjs-form-select-object-list
          multiple
          fixedMenuPosition
          style="min-height: 300px;"
          objectType="note"
          .strings="${this.strings}"
          id="personref-note-select"
          label="${this._("Select")}"
          .objectsInitial="${this.data.note_list&&this.data.note_list.length?this.data.note_list.map((t=>({object_type:"note",object:{},handle:t}))):[]}"
          class="edit"
        ></grampsjs-form-select-object-list>
      </p>
    `}get isValid(){return this.data.rel&&this.data.ref}});window.customElements.define("grampsjs-associations",class extends pf{static get properties(){return{extended:{type:Array}}}row(t,e){return M`
      <mwc-list-item
        twoline
        graphic="avatar"
        ?hasMeta="${this.edit}"
        @click="${()=>this._handleClick(this.extended[e])}"
        >${Ga(this.extended[e])}
        <span slot="secondary">${this._(t.rel)}</span>
        <mwc-icon slot="graphic">group</mwc-icon>
      </mwc-list-item>
    `}_handleClick(t){this.edit||os(this,"nav",{path:this._getItemPath(t.gramps_id)})}_getItemPath(t){return`person/${t}`}_handleAdd(){this.dialogContent=M`
      <grampsjs-form-edit-association
        new
        @object:save="${this._handleAssocSave}"
        @object:cancel="${this._handleDialogCancel}"
        .strings="${this.strings}"
      >
      </grampsjs-form-edit-association>
    `}_handleEdit(){const t=this.data[this._selectedIndex],e=this.extended[this._selectedIndex];this.dialogContent=M`
      <grampsjs-form-edit-association
        @object:save="${this._handleAssocSaveEdit}"
        @object:cancel="${this._handleDialogCancel}"
        .strings="${this.strings}"
        .data="${t}"
        .person="${e}"
      >
      </grampsjs-form-edit-association>
    `}_handleDelete(){os(this,"edit:action",{action:"delAssociation",index:this._selectedIndex})}_handleAssocSave(t){os(this,"edit:action",{action:"addAssociation",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleAssocSaveEdit(t){os(this,"edit:action",{action:"updateAssociation",data:t.detail.data,index:this._selectedIndex}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleDialogCancel(){this.dialogContent=""}});window.customElements.define("grampsjs-form-edit-attribute",class extends lh{static get properties(){return{source:{type:Boolean}}}constructor(){super(),this.source=!1}renderForm(){return M`
      <grampsjs-form-select-type
        required
        id="${this.source?"srcattrtype":"attrtype"}"
        heading="${this._("Type")}"
        .strings="${this.strings}"
        typeName="attribute_types"
        ?loadingTypes=${this.loadingTypes}
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
        .data="${this.data}"
        initialValue=${this.data?.type?.string||""}
      >
      </grampsjs-form-select-type>
      <grampsjs-form-string
        required
        fullwidth
        id="attrvalue"
        @formdata:changed="${this._handleFormData}"
        label="${this._("Value")}"
        .strings="${this.strings}"
        .data="${this.data}"
        value="${this.data?.value||""}"
      >
      </grampsjs-form-string>
    `}});window.customElements.define("grampsjs-attributes",class extends pf{static get styles(){return[super.styles,n`
        mwc-list-item {
          cursor: default;
        }

        mwc-list-item[hasMeta] {
          cursor: pointer;
        }
      `]}static get properties(){return{source:{type:Boolean}}}constructor(){super(),this.source=!1}row(t){return M`
      <mwc-list-item twoline graphic="avatar" ?hasMeta="${this.edit}">
        ${this.edit?t.value:ys(t.value,!1)}
        <span slot="secondary">${this._(t.type)}</span>
        <mwc-icon slot="graphic">info</mwc-icon>
      </mwc-list-item>
    `}_handleAdd(){this.dialogContent=M`
      <grampsjs-form-edit-attribute
        ?source="${this.source}"
        new
        @object:save="${this._handleAttrSave}"
        @object:cancel="${this._handleAttrCancel}"
        .strings="${this.strings}"
      >
      </grampsjs-form-edit-attribute>
    `}_handleEdit(){const t=this.data[this._selectedIndex],e={type:{_class:this.source?"SrcAttributeType":"AttributeType",string:t.type||""},value:t.value||""};this.dialogContent=M`
      <grampsjs-form-edit-attribute
        ?source="${this.source}"
        @object:save="${this._handleAttrSaveEdit}"
        @object:cancel="${this._handleAttrCancel}"
        .strings="${this.strings}"
        .data="${e}"
      >
      </grampsjs-form-edit-attribute>
    `}_handleDelete(){os(this,"edit:action",{action:"delAttr",index:this._selectedIndex})}_handleAttrSave(t){os(this,"edit:action",{action:"addAttribute",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleAttrSaveEdit(t){os(this,"edit:action",{action:"updateAttribute",data:t.detail.data,index:this._selectedIndex}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleAttrCancel(){this.dialogContent=""}});class Ek extends(al(K)){static get styles(){return[nl,n`
        :host {
          font-size: 14px;
          font-weight: 450;
          color: rgba(0, 0, 0, 0.45);
        }

        mwc-icon {
          font-size: 18px;
          top: 4px;
          position: relative;
          color: rgba(0, 0, 0, 0.4);
        }

        mwc-icon-button {
          --mdc-icon-size: 16px;
          --mdc-icon-button-size: 28px;
          position: relative;
        }
      `]}static get properties(){return{href:{type:String}}}constructor(){super(),this.href=""}render(){return M`
      <mwc-icon-button
        id="share-icon"
        icon="share"
        @click="${this._handleShareClick}"
        @keydown="${gs}"
      ></mwc-icon-button>
      <grampsjs-tooltip for="share-icon"
        >${this._("Copy URL")}</grampsjs-tooltip
      >
    `}_handleShareClick(){const t=this.href;if(navigator.share)navigator.share({url:t});else{const e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),navigator.clipboard.writeText(t).finally((()=>{document.body.removeChild(e)}));const i=this.renderRoot.getElementById("share-icon");i.icon="done",setTimeout((()=>{i.icon="share"}),1e3)}}}window.customElements.define("grampsjs-share-url",Ek);class $k extends(al(K)){static get styles(){return[nl]}static get properties(){return{endpoint:{type:String},handle:{type:String},bookmarked:{type:Boolean}}}constructor(){super(),this.endpoint="",this.handle="",this.bookmarked=!1}render(){return M`
      <mwc-icon-button
        icon="${this.bookmarked?"bookmark":"bookmark_border"}"
        @click="${this._handleClick}"
        @keydown="${gs}"
        id="btn-star"
      ></mwc-icon-button>
      <grampsjs-tooltip
        for="btn-star"
        content="${this.bookmarked?this._("Remove bookmark"):this._("Bookmark this")}"
      ></grampsjs-tooltip>
    `}_handleClick(){this.bookmarked?this._handleUnmark():this._handleMark()}_handleUnmark(){!function(t,e){const i=An(),r=Gn();if(r?.[i]?.[t]){r[i][t]=[...r[i][t].filter((t=>t!==e))];const n=JSON.stringify(r);localStorage.setItem("bookmarks",n)}}(this.endpoint,this.handle),os(this,"bookmark:changed"),this.bookmarked=!1}_handleMark(){!function(t,e){const i=An(),r=Gn();Object.hasOwn(r,i)?Object.hasOwn(r[i],t)?r[i][t]=[...r[i][t].filter((t=>t!==e)),e]:r[i]={...r[i],[t]:[e]}:r[i]={[t]:[e]};const n=JSON.stringify(r);localStorage.setItem("bookmarks",n)}(this.endpoint,this.handle),os(this,"bookmark:changed"),this.bookmarked=!0}update(t){super.update(t),(t.has("handle")||t.has("endpoint"))&&this._updateStatus()}_updateStatus(){this.bookmarked=function(t,e){const i=Wn();return!!i?.[t]?.includes(e)}(this.endpoint,this.handle)}}window.customElements.define("grampsjs-bookmark-button",$k);class Ak extends(al(K)){static get styles(){return[nl,n`
        .breadcrumb {
          font-size: 14px;
          font-weight: 450;
          color: rgba(0, 0, 0, 0.45);
          margin-bottom: 18px;
        }

        .breadcrumb a:link,
        a:visited {
          color: rgba(0, 0, 0, 0.45);
          text-decoration: none;
          border-radius: 3px;
          padding: 4px 7px;
        }

        .breadcrumb a:hover {
          color: rgba(0, 0, 0, 0.45);
          text-decoration: none;
          background-color: rgba(0, 0, 0, 0.05);
        }

        .breadcrumb .dark {
        }

        .breadcrumb mwc-icon {
          font-size: 18px;
          top: 4px;
          position: relative;
          color: rgba(0, 0, 0, 0.4);
        }

        .breadcrumb .action-buttons {
          margin-left: 1rem;
        }

        .breadcrumb .action-buttons mwc-icon-button {
          --mdc-icon-size: 16px;
          --mdc-icon-button-size: 28px;
          position: relative;
          top: -3px;
          color: rgba(0, 0, 0, 0.4);
        }

        .breadcrumb .action-buttons mwc-icon-button.edit {
          color: var(--mdc-theme-secondary);
        }

        .breadcrumb .action-buttons mwc-icon-button#btn-star {
          --mdc-icon-size: 20px;
          --mdc-icon-button-size: 28px;
          position: relative;
          top: -3px;
        }

        .breadcrumb .action-buttons grampsjs-share-url,
        .breadcrumb .action-buttons grampsjs-bookmark-button {
          --mdc-icon-size: 16px;
          --mdc-icon-button-size: 28px;
          position: relative;
          top: -3px;
        }

        .breadcrumb .action-buttons grampsjs-bookmark-button {
          --mdc-icon-size: 17px;
          top: -2px;
        }
      `]}static get properties(){return{data:{type:Object},edit:{type:Boolean},objectsName:{type:String},objectEndpoint:{type:String},objectIcon:{type:String},hideBookmark:{type:Boolean},hideLock:{type:Boolean}}}constructor(){super(),this.data={},this.edit=!1,this.objectsName="",this.objectEndpoint="",this.objectIcon="",this.hideBookmark=!1,this.hideLock=!1}render(){return M`
      <div class="breadcrumb">
        <mwc-icon>${this.objectIcon}</mwc-icon>
        <a href="/${this._getObjectsLink()}">${this._(this.objectsName)}</a>
        <mwc-icon>chevron_right</mwc-icon>
        <span class="dark">${this.data.gramps_id}</span>
        <span class="action-buttons">
          ${this.hideLock?"":M`
                <span id="wrap-btn-private">
                  <mwc-icon-button
                    icon="${this.data.private?"lock_outline":"lock_open"}"
                    ?disabled="${!this.edit}"
                    @click="${this._handlePrivacyClick}"
                    @keydown="${gs}"
                    class="edit"
                    id="btn-private"
                  ></mwc-icon-button>
                </span>
                <grampsjs-tooltip
                  for="wrap-btn-private"
                  content="${this.data.private?this._("Record is private"):this._("Record is public")}"
                ></grampsjs-tooltip>
              `}
          ${this.hideBookmark?"":M`
                <grampsjs-bookmark-button
                  .strings="${this.strings}"
                  handle="${this.data.handle}"
                  endpoint="${this.objectEndpoint}"
                ></grampsjs-bookmark-button>
              `}
          <grampsjs-share-url
            href="${document.URL}"
            .strings="${this.strings}"
          ></grampsjs-share-url>
        </span>
      </div>
    `}_getObjectsLink(){return"Media Objects"===this.objectsName?"medialist":this.objectsName.toLowerCase()}_handlePrivacyClick(){os(this,"edit:action",{action:"updateProp",data:{private:!this.data.private}})}}window.customElements.define("grampsjs-breadcrumbs",Ak);class Ik extends(al(K)){static get styles(){return[nl,n`
        table {
          font-size: 15px;
          margin-top: 20px;
          border-collapse: collapse;
          border-spacing: 0;
        }

        th {
          font-size: 14px;
          color: #666;
          font-weight: 400;
        }

        th,
        td {
          padding: 14px 20px;
          border-bottom: 1px solid #e0e0e0;
          text-align: left;
          margin: 0;
        }

        table.linked tr:hover td {
          background-color: #f0f0f0;
          cursor: pointer;
        }

        table.linked tr.highlight td {
          font-weight: 400;
        }

        table.linked tr.highlight:hover td {
          background-color: white;
          cursor: auto;
        }

        td mwc-icon.inline {
          color: rgba(0, 0, 0, 0.25);
          font-size: 16px;
        }

        td mwc-icon-button {
          --mdc-icon-size: 20px;
          --mdc-icon-button-size: 36px;
          margin: -2px 0px;
        }

        @media (max-width: 768px) {
          table {
            font-size: 14px;
          }

          th {
            font-size: 12px;
          }

          th,
          td {
            padding: 10px 8px;
          }

          td mwc-icon.inline {
            font-size: 15px;
          }

          td mwc-icon-button {
            --mdc-icon-size: 18px;
            --mdc-icon-button-size: 33px;
          }
        }
      `]}static get properties(){return{data:{type:Array}}}constructor(){super(),this.data=[]}}class Mk extends Ik{static get styles(){return[super.styles,n`
        tr:hover td {
          background-color: #f0f0f0;
          cursor: pointer;
        }
      `]}static get properties(){return{edit:{type:Boolean},objType:{type:String},dialogContent:{type:String},dialogTitle:{type:String},_columns:{type:Array}}}constructor(){super(),this.edit=!1,this.objType="",this.dialogContent="",this.dialogTitle="",this._columns=[]}render(){return M`
      ${0===Object.keys(this.data).length?"":M`
            <table>
              <tr>
                ${this._columns.map((t=>M` <th>${this._(t)}</th> `))}
              </tr>
              ${this.sortData([...this.data]).map(((t,e,i)=>this.row(t,e,i)))}
            </table>
          `}
      ${this.renderAfterTable()}
    `}sortData(t){return t}renderAfterTable(){return""}row(t,e,i){return""}_renderActionBtns(t,e,i,r=!1,n=!0){return M`
      ${e&&!n?"":M`
            <mwc-icon-button
              class="edit"
              icon="delete"
              @click="${e=>this._handleActionClick(e,`del${this.objType}`,t)}"
            ></mwc-icon-button>
          `}
      ${e?"":M`
            <mwc-icon-button
              class="edit"
              icon="arrow_upward"
              @click="${e=>this._handleActionClick(e,`up${this.objType}`,t)}"
            ></mwc-icon-button>
          `}
      ${i?"":M`
            <mwc-icon-button
              class="edit"
              icon="arrow_downward"
              @click="${e=>this._handleActionClick(e,`down${this.objType}`,t)}"
            ></mwc-icon-button>
          `}
      ${r?M`
            <mwc-icon-button
              class="edit"
              icon="edit"
              @click="${e=>this._handleEditClick(t)}"
            ></mwc-icon-button>
          `:""}
    `}_handleActionClick(t,e,i){os(this,"edit:action",{action:e,handle:i}),t.preventDefault(),t.stopPropagation()}}window.customElements.define("grampsjs-form-childref",class extends lh{renderForm(){return M`
      <grampsjs-form-select-object-list
        fixedMenuPosition
        style="min-height: 300px;"
        objectType="person"
        .strings="${this.strings}"
        id="child-select"
        label="${this._("Select")}"
        class="edit"
      ></grampsjs-form-select-object-list>
      <grampsjs-form-select-type
        required
        id="child-frel"
        heading="${this._("Relationship to _Father:").replace(":","")}"
        .strings="${this.strings}"
        ?loadingTypes=${this.loadingTypes}
        typeName="child_reference_types"
        defaultTypeName="Birth"
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
      >
      </grampsjs-form-select-type>
      <grampsjs-form-select-type
        required
        id="child-mrel"
        heading="${this._("Relationship to _Mother:").replace(":","")}"
        .strings="${this.strings}"
        ?loadingTypes=${this.loadingTypes}
        typeName="child_reference_types"
        defaultTypeName="Birth"
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
      >
      </grampsjs-form-select-type>
    `}});window.customElements.define("grampsjs-children",class extends Mk{static get properties(){return{profile:{type:Array},highlightId:{type:String}}}constructor(){super(),this.profile=[],this.highlightId="",this._columns=["","Given name","Birth","Death","Age at death",""],this.objType="ChildRef"}row(t,e,i){return M`
      <tr
        @click=${()=>this._handleClick(this.profile[e].gramps_id)}
        class="${t.gramps_id===this.highlightId?"highlight":""}"
      >
        <td>${function(t){return"M"===t?Na("M9,9C10.29,9 11.5,9.41 12.47,10.11L17.58,5H13V3H21V11H19V6.41L13.89,11.5C14.59,12.5 15,13.7 15,15A6,6 0 0,1 9,21A6,6 0 0,1 3,15A6,6 0 0,1 9,9M9,11A4,4 0 0,0 5,15A4,4 0 0,0 9,19A4,4 0 0,0 13,15A4,4 0 0,0 9,11Z","var(--color-boy)"):"F"===t?Na("M12,4A6,6 0 0,1 18,10C18,12.97 15.84,15.44 13,15.92V18H15V20H13V22H11V20H9V18H11V15.92C8.16,15.44 6,12.97 6,10A6,6 0 0,1 12,4M12,6A4,4 0 0,0 8,10A4,4 0 0,0 12,14A4,4 0 0,0 16,10A4,4 0 0,0 12,6Z","var(--color-girl)"):""}(this.profile[e]?.sex)}</td>
        <td>${this.profile[e]?.name_given||""}</td>
        <td>${this.profile[e]?.birth?.date||" "}</td>
        <td>${this.profile[e]?.death?.date||""}</td>
        <td>${this.profile[e]?.death?.age||""}</td>
        <td>
          ${this.edit?this._renderActionBtns(t.ref,0===e,e===i.length-1):""}
        </td>
      </tr>
    `}renderAfterTable(){return this.edit?M`
          <mwc-icon-button
            class="edit large"
            icon="add_circle"
            @click="${this._handleAddClick}"
          ></mwc-icon-button>
          ${this.dialogContent}
        `:""}_handleAddClick(){this.dialogContent=M`
      <grampsjs-form-childref
        new
        @object:save="${this._handleChildRefSave}"
        @object:cancel="${this._handleChildRefCancel}"
        .strings="${this.strings}"
        objType="${this.objType}"
        dialogTitle=${this._("Add existing child to family")}
      >
      </grampsjs-form-childref>
    `}_handleChildRefSave(t){os(this,"edit:action",{action:"addChildRef",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleChildRefCancel(){this.dialogContent=""}_handleClick(t){this.edit||t===this.grampsId||this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:this._getItemPath(t)}}))}_getItemPath(t){return`person/${t}`}});window.customElements.define("grampsjs-citations",class extends pf{constructor(){super(),this.objType="Citation"}row(t){return M`
      <mwc-list-item
        twoline
        graphic="avatar"
        @click="${()=>this._handleClick(t.gramps_id)}"
      >
        ${t.page||this._("Citation")}
        <span slot="secondary"> ${t.gramps_id} </span>
        ${fs({object:t,object_type:"citation"})}
      </mwc-list-item>
    `}_handleClick(t){this.edit||os(this,"nav",{path:this._getItemPath(t)})}_getItemPath(t){return`citation/${t}`}});window.customElements.define("grampsjs-form-eventref",class extends lh{static get properties(){return{defaultRole:{type:String}}}constructor(){super(),this.defaultRole="Primary"}renderForm(){return M`
      ${this.new?M`
            <grampsjs-form-select-object-list
              fixedMenuPosition
              style="min-height: 300px;"
              objectType="event"
              .strings="${this.strings}"
              id="event-select"
              label="${this._("Select")}"
              class="edit"
              .data="${this.data}"
            ></grampsjs-form-select-object-list>
          `:""}
      <grampsjs-form-select-type
        required
        id="event-role-type"
        defaultTypeName="${this.defaultRole}"
        heading="${this._("Role")}"
        .strings="${this.strings}"
        typeName="event_role_types"
        ?loadingTypes=${this.loadingTypes}
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
        initialValue="${this.data?.role?.string||this.data?.role||""}"
      >
      </grampsjs-form-select-type>
    `}get isValid(){return!!this.data.ref}});const Lk={0:"Regular",1:"Before",2:"After",3:"About",4:"Range",5:"Span"},Pk={0:"Regular",1:"Estimated",2:"Calculated"},Rk={_class:"Date",calendar:0,modifier:0,quality:0,dateval:[0,0,0,!1],sortval:0};function zk(t){if(!t)return[0,0,0];return[parseInt(t.substr(0,4),10)||0,parseInt(t.substr(5,2),10)||0,parseInt(t.substr(8,2),10)||0]}class Dk extends(al(K)){static get styles(){return[nl,n`
        p {
          margin: 7px 0;
        }

        mwc-icon-button {
          color: rgba(0, 0, 0, 0.5);
          --mdc-theme-text-disabled-on-light: rgba(0, 0, 0, 0.25);
        }

        span.dateform {
          white-space: nowrap;
        }

        span.dateform mwc-textfield {
          margin-bottom: 10px;
        }
      `]}static get properties(){return{data:{type:Object},disabled:{type:Boolean}}}constructor(){super(),this.data=Rk,this.disabled=!1}render(){return M`
    <p>
      <mwc-select
        id="select-modifier"
        label="${this._("Type")}"
        @change="${this.handleType}"
      >
        ${Object.keys(Lk).map((t=>M`
            <mwc-list-item
              value="${t}"
              ?selected="${t==(this.data.modifier||0)}"
              >${this._(Lk[t])}</mwc-list-item
            >
          `))}
      </mwc-select>

      <mwc-select
        id="select-quality"
        label="${this._("Quality")}"
        @change="${this.handleQuality}"
      >
        ${Object.keys(Pk).map((t=>M`
            <mwc-list-item
              value="${t}"
              ?selected="${t==(this.data.quality||0)}"
              >${this._(Pk[t])}</mwc-list-item
            >
          `))}
      </mwc-select>
    </p>
    <p>
    <span class="dateform">
      <mwc-textfield
        @change="${this.handleYear1}"
        id="year1"
        label="${this._("Year")}"
        type="number"
        style="width: 6em;"
        value="${this.data.dateval[2]||""}"
      ></mwc-textfield>
      <mwc-select
        @change="${this.handleMonth1}"
        id="month1"
        label="${this._("Month")}"
        style="width: 6em;"
      >${[...Array(13).keys()].map((t=>M`
          <mwc-list-item
            value="${t}"
            ?selected="${t==(this.data.dateval[1]||0)}"
          >
            ${0===t?"":t}
          </mwc-list-item>
        `))}
      </mwc-select>
      <mwc-select
        @change="${this.handleDay1}"
        id="day1"
        label="${this._("Day")}"
        style="width: 6em;"
      >${[...Array(32).keys()].map((t=>M`
          <mwc-list-item
            value="${t}"
            ?selected="${t==(this.data.dateval[0]||0)}"
          >
            ${0===t?"":t}
          </mwc-list-item>
        `))}
      </mwc-select>

      <input
        type="date"
        id="input-date1"
        style="visibility: hidden; position: absolute;"
        @change="${this.handleDate1}"
      >
      </input>

      <mwc-icon-button
        icon="event"
        ?disabled="${0!==this.data.calendar}"
        @click=${this._openDatePicker1}
      ></mwc-icon-button>
      </span>

      ${this._hasSecondDate()?M`
      <span class="dateform">
      &nbsp;&nbsp;&ndash;&nbsp;&nbsp;

      <mwc-textfield
        @change="${this.handleYear2}"
        id="year2"
        label="${this._("Year")}"
        type="number"
        style="width: 6em;"
        value="${this.data.dateval[6]||""}"
      ></mwc-textfield>
      <mwc-select
        @change="${this.handleMonth2}"
        id="month2"
        label="${this._("Month")}"
        style="width: 6em;"
      >${[...Array(13).keys()].map((t=>M`
          <mwc-list-item
            value="${t}"
            ?selected="${t==(this.data.dateval[5]||0)}"
          >
            ${0===t?"":t}
          </mwc-list-item>
        `))}
      </mwc-select>
      <mwc-select
        @change="${this.handleDay2}"
        id="day2"
        label="${this._("Day")}"
        style="width: 6em;"
      >${[...Array(32).keys()].map((t=>M`
          <mwc-list-item
            value="${t}"
            ?selected="${t==(this.data.dateval[4]||0)}"
          >
            ${0===t?"":t}
          </mwc-list-item>
        `))}
      </mwc-select>

      <input
        type="date"
        id="input-date2"
        style="visibility: hidden; position: absolute;"
        @change="${this.handleDate2}"
      >
      </input>

      <mwc-icon-button
        ?disabled="${0!==this.data.calendar}"
        icon="event"
        @click=${this._openDatePicker2}
      ></mwc-icon-button>
      </span>
    </p>
      `:""}

      `}_hasSecondDate(){return this.data?.modifier>=4}reset(){this.data=Rk,this.shadowRoot.querySelectorAll("mwc-textfield").forEach((t=>{t.value=""})),this.shadowRoot.querySelectorAll("mwc-select").forEach((t=>{t.value=0}))}handleType(t){this.data={...this.data,modifier:parseInt(t.target.value,10)||0},this._hasSecondDate()&&"dateval"in this.data&&this.data.dateval.length<8&&(this.data={...this.data,dateval:[...this.data.dateval.slice(0,4),0,0,0,!1]}),!this._hasSecondDate()&&"dateval"in this.data&&(this.data={...this.data,dateval:this.data.dateval.slice(0,4)}),this.handleChange()}handleQuality(t){this.data={...this.data,quality:parseInt(t.target.value,10)||0},this.handleChange()}handleDate1(t){const[e,i,r]=zk(t.target.value),n=[...this.data?.dateval];this.data={...this.data,dateval:[r,i,e,!1,...n.slice(4)],sortval:cs(e,i,r),year:e},this.handleChange()}handleDate2(t){const[e,i,r]=zk(t.target.value),n=[...this.data?.dateval];this.data={...this.data,dateval:[...n.slice(0,4),r,i,e,!1]},this.handleChange()}_getValue1(){const t=[...this.data.dateval];if(null==t)return null;const[e,i,r]=t.slice(0,3);return`${`${r}`.padStart(4,"0")}-${`${i}`.padStart(2,"0")}-${`${e}`.padStart(2,"0")}`}_getValue2(){const t=[...this.data.dateval];if(null==t||t.length<6)return null;const[e,i,r]=t.slice(4,7);return`${`${r}`.padStart(4,"0")}-${`${i}`.padStart(2,"0")}-${`${e}`.padStart(2,"0")}`}handleYear1(t){const e=parseInt(t.target.value,10)||0,i=this.data?.dateval?[...this.data.dateval]:[0,0,0,!1];i[2]=e;const r=i[1],n=i[0];this.data={...this.data,dateval:i,sortval:cs(e,r,n),year:e},this.handleChange()}handleMonth1(t){const e=parseInt(t.target.value,10)||0,i=this.data?.dateval?[...this.data.dateval]:[0,0,0,!1];i[1]=e;const r=i[2],n=i[0];this.data={...this.data,dateval:i,sortval:cs(r,e,n)},this.handleChange()}handleDay1(t){const e=parseInt(t.target.value,10)||0,i=this.data?.dateval?[...this.data.dateval]:[0,0,0,!1];i[0]=e;const r=i[2],n=i[1];this.data={...this.data,dateval:i,sortval:cs(r,n,e)},this.handleChange()}handleYear2(t){const e=parseInt(t.target.value,10)||0,i=this.data.dateval&&this.data.dateval.length>4?this.data.dateval.slice(4):[0,0,0,!1];i[2]=e;const r=this.data?.dateval||[0,0,0,!1];this.data={...this.data,dateval:[...r.slice(0,4),...i]},this.handleChange()}handleDay2(t){const e=parseInt(t.target.value,10)||0,i=this.data.dateval&&this.data.dateval.length>4?this.data.dateval.slice(4):[0,0,0,!1];i[0]=e;const r=this.data?.dateval||[0,0,0,!1];this.data={...this.data,dateval:[...r.slice(0,4),...i]},this.handleChange()}handleMonth2(t){const e=parseInt(t.target.value,10)||0,i=this.data.dateval&&this.data.dateval.length>4?this.data.dateval.slice(4):[0,0,0,!1];i[1]=e;const r=this.data?.dateval?[...this.data.dateval]:[0,0,0,!1];this.data={...this.data,dateval:[...r.slice(0,4),...i]},this.handleChange(),this.handleChange()}handleChange(){this.dispatchEvent(new CustomEvent("formdata:changed",{bubbles:!0,composed:!0,detail:{data:this.data}})),this.renderRoot.getElementById("year1").reportValidity();const t=this.renderRoot.getElementById("input-date1");t&&(t.value=this._getValue1());const e=this.renderRoot.getElementById("input-date2");e&&(e.value=this._getValue2())}isValid(){if(!this.data.dateval)return!1;if(!this._hasSecondDate()&&0===this.data.dateval[0]&&0===this.data.dateval[1]&&0===this.data.dateval[2])return!0;if(this._hasSecondDate()){if(this.data.dateval.length<8)return!1;if(this.data.dateval[6]>this.data.dateval[2])return!0;if(this.data.dateval[6]<this.data.dateval[2])return!1;if(this.data.dateval[5]>this.data.dateval[1])return!0;if(this.data.dateval[5]<this.data.dateval[1])return!1;if(this.data.dateval[4]<=this.data.dateval[0])return!1}else if(this.data.dateval.length>4)return!1;return!0}isEmpty(){return _s(this.data)}_openDatePicker1(){this.renderRoot.getElementById("input-date1").showPicker()}_openDatePicker2(){this.renderRoot.getElementById("input-date2").showPicker()}}window.customElements.define("grampsjs-form-select-date",Dk);const jk=t=>class extends t{renderForm(){return M`
        <grampsjs-form-select-type
          required
          id="event-type"
          .strings="${this.strings}"
          ?loadingTypes="${this.loadingTypes}"
          typeName="event_types"
          .types="${this.types}"
          .typesLocale="${this.typesLocale}"
        >
        </grampsjs-form-select-type>

        <h4 class="label">${this._("Date")}</h4>
        <p>
          <grampsjs-form-select-date id="date" .strings="${this.strings}">
          </grampsjs-form-select-date>
        </p>

        <h4 class="label">${this._("Description")}</h4>
        <p>
          <grampsjs-form-string
            fullwidth
            id="description"
            @formdata:changed="${this._handleFormData}"
            label="${this._("Description")}"
            .strings="${this.strings}"
          >
          </grampsjs-form-string>
        </p>

        <h4 class="label">${this._("Place")}</h4>
        <grampsjs-form-select-object-list
          id="place"
          objectType="place"
          .strings="${this.strings}"
        ></grampsjs-form-select-object-list>

        ${this._renderCitationForm()}

        <div class="spacer"></div>
        <grampsjs-form-private
          id="private"
          .strings="${this.strings}"
        ></grampsjs-form-private>
      `}};class Ok extends(jk(lh)){static get properties(){return{defaultRole:{type:String}}}constructor(){super(),this.data={_class:"Event"},this.defaultRole="Primary"}_renderCitationForm(){return M`
      <h4 class="label">${this._("Citation")}</h4>

      <grampsjs-form-select-object-list
        multiple
        id="object-citation"
        objectType="citation"
        .strings="${this.strings}"
      ></grampsjs-form-select-object-list>
    `}renderForm(){return M`
      ${super.renderForm()}

      <grampsjs-form-select-type
        required
        id="event-role-type"
        defaultTypeName="${this.defaultRole}"
        heading="${this._("Role")}"
        .strings="${this.strings}"
        typeName="event_role_types"
        ?loadingTypes=${this.loadingTypes}
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
      >
      </grampsjs-form-select-type>
    `}checkFormValidity(){const t=this.shadowRoot.querySelector("grampsjs-form-select-type");let e=!0;null===!t||t.isValid()||(e=!1);const i=this.shadowRoot.querySelector("grampsjs-form-select-date");null===!i||i.isValid()||(e=!1),this.isFormValid=e}}window.customElements.define("grampsjs-form-new-event",Ok);window.customElements.define("grampsjs-events",class extends pf{static get properties(){return{profile:{type:Array},eventRef:{type:Array},dialogContent:{type:String},useSummary:{type:Boolean},sorted:{type:Boolean},defaultRole:{type:String}}}constructor(){super(),this.profile=[],this.eventRef=[],this.objType="Event",this.useSummary=!1,this.sorted=!1,this.hasAdd=!1,this.hasShare=!0,this.hasReorder=!0,this.defaultRole="Primary"}row(t){const e=this.data.indexOf(t),i={...t,profile:this.profile[e]};return M`
      <mwc-list-item
        twoline
        graphic="avatar"
        @click="${()=>this._handleClick(t.gramps_id)}"
      >
        ${this._getPrimaryText(i)}
        <span slot="secondary">${this._getSecondaryText(i)}</span>
        ${fs({object:t,object_type:"event"})}
      </mwc-list-item>
    `}_getPrimaryText(t){return this.useSummary?t.profile.summary:M`
      ${t.profile.type}
      ${!t.profile?.role||["Primary","Family",this._("Primary"),this._("Family")].includes(t.profile?.role)?"":`(${t.profile?.role})`}
    `}_getSecondaryText(t){const e=rs("event",t,this.strings)||"";return M`
      ${e} ${t.description&&e.trim()?M` &ndash; `:""}
      ${t.description||""}
    `}sortData(t){return this.sorted?t.sort(((t,e)=>(t?.date?.sortval||0)-(e?.date?.sortval||0))):t}_handleShare(){this.dialogContent=M`
      <grampsjs-form-eventref
        new
        id="share-event-ref"
        defaultRole="${this.defaultRole}"
        @object:save="${this._handleEventRefSave}"
        @object:cancel="${this._handleDialogCancel}"
        .strings="${this.strings}"
        objType="${this.objType}"
        dialogTitle=${this._("Share an existing event")}
      >
      </grampsjs-form-eventref>
    `}_handleEdit(){const t=this.eventRef[this._selectedIndex];this.dialogContent=M`
      <grampsjs-form-eventref
        id="edit-event-ref"
        @object:save="${this._handleEventRefSaveEdit}"
        @object:cancel="${this._handleDialogCancel}"
        .strings="${this.strings}"
        objType="${this.objType}"
        .data="${t}"
        dialogTitle=${this._("Event Reference Editor")}
      >
      </grampsjs-form-eventref>
    `}_handleAdd(){this.dialogContent=M`
      <grampsjs-form-new-event
        defaultRole="${this.defaultRole}"
        @object:save="${this._handleNewEventSave}"
        @object:cancel="${this._handleDialogCancel}"
        .strings="${this.strings}"
        dialogTitle="${this._("Add a new event")}"
      >
      </grampsjs-form-new-event>
    `}_handleNewEventSave(t){os(this,"edit:action",{action:"newEvent",data:{handle:ls(),...t.detail.data}}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleEventRefSave(t){os(this,"edit:action",{action:"addEventRef",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleEventRefSaveEdit(t){os(this,"edit:action",{action:"updateEventRef",data:t.detail.data,index:this._selectedIndex}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleDialogCancel(){this.dialogContent=""}_handleDelete(){os(this,"edit:action",{action:"delEvent",index:this._selectedIndex})}_handleUp(){const t=this.data?.[this._selectedIndex]?.handle;t&&os(this,"edit:action",{action:"upEvent",handle:this.data[this._selectedIndex].handle})}_handleDown(){const t=this.data?.[this._selectedIndex]?.handle;t&&(os(this,"edit:action",{action:"downEvent",handle:this.data[this._selectedIndex].handle}),this.renderRoot.querySelector("mwc-list").select(-1))}_handleClick(t){this.edit||os(this,"nav",{path:this._getItemPath(t)})}_getItemPath(t){return`event/${t}`}});class Bk extends(al(K)){static get styles(){return[nl,n`
        mwc-textfield.fullwidth {
          width: 100%;
        }

        .hide {
          display: none;
        }

        mwc-icon-button {
          color: rgba(0, 0, 0, 0.5);
        }
      `]}static get properties(){return{data:{type:Object},showMore:{type:Boolean},idx:{type:Number},types:{type:Object},typesLocale:{type:Object},loadingTypes:{type:Boolean},origintype:{type:Boolean}}}constructor(){super(),this.data={_class:"Name"},this.showMore=!1,this.idx=0,this.types={},this.typesLocale={},this.loadingTypes=!1,this.origintype=!1}render(){return M`
      <p class="${Ot({hide:!this.showMore})}">
        <grampsjs-form-string
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="prefix"
          value="${this.data.prefix||""}"
          label="${this._("Prefix")}"
        ></grampsjs-form-string>
      </p>
      <p>
        <grampsjs-form-string
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="surname"
          value="${this.data.surname||""}"
          label="${this._("Surname")}"
        ></grampsjs-form-string>
      </p>
      <p class="${Ot({hide:!this.showMore})}">
        <grampsjs-form-string
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="connector"
          value="${this.data.connector||""}"
          label="${this._("Connector")}"
        ></grampsjs-form-string>
      </p>
      ${this.origintype?M`
            <p class="${Ot({hide:!this.showMore})}">
              <grampsjs-form-select-type
                noheading
                label="${this._("Surname origin type:").replace(":","")}"
                id="surname-origin-type"
                .strings="${this.strings}"
                typeName="name_origin_types"
                defaultTypeName=""
                initialValue=${this.data?.origintype||""}
                .types="${this.types}"
                .typesLocale="${this.typesLocale}"
                ?loadingTypes=${this.loadingTypes}
                @formdata:changed="${this._handleFormData}"
              >
              </grampsjs-form-select-type>
            </p>
          `:""}
    `}reset(){this.shadowRoot.querySelectorAll("grampsjs-form-string").forEach((t=>t.reset())),this.shadowRoot.querySelectorAll("grampsjs-form-select-type").forEach((t=>t.reset())),this.showMore=!1}handleChange(){os(this,"formdata:changed",{data:this.data,idx:this.idx})}_handleFormData(t){const e=t.composedPath()[0];["prefix","connector","surname"].includes(e.id)?this.data={...this.data,[e.id]:t.detail.data}:"surname-origin-type"===e.id&&(this.data={...this.data,origintype:t.detail.data}),t.stopPropagation(),this.handleChange()}}window.customElements.define("grampsjs-form-surname",Bk);class Fk extends(al(K)){static get styles(){return[nl,n`
        mwc-textfield.fullwidth {
          width: 100%;
        }

        .clear {
          clear: both;
          margin-bottom: 2.5em;
        }

        .hide {
          display: none;
        }

        mwc-icon-button {
          color: rgba(0, 0, 0, 0.5);
        }
      `]}static get properties(){return{data:{type:Object},showMore:{type:Boolean},loadingTypes:{type:Boolean},types:{type:Object},typesLocale:{type:Object},origintype:{type:Boolean}}}constructor(){super(),this.data={_class:"Name"},this.showMore=!1,this.types={},this.typesLocale={},this.loadingTypes=!1,this.origintype=!1}render(){return M`
      <p class="${Ot({hide:!this.showMore})}">
        <grampsjs-form-string
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="title"
          value="${this.data.title||""}"
          label="${this._("Title")}"
        ></grampsjs-form-string>
      </p>
      <p>
        <grampsjs-form-string
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="first_name"
          value="${this.data.first_name||""}"
          label="${this._("Given name")}"
        ></grampsjs-form-string>
      </p>
      <p class="${Ot({hide:!this.showMore})}">
        <grampsjs-form-string
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="suffix"
          value="${this.data.suffix||""}"
          label="${this._("Suffix")}"
        ></grampsjs-form-string>
      </p>
      <p class="${Ot({hide:!this.showMore})}">
        <grampsjs-form-string
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="call"
          value="${this.data.call||""}"
          label="${this._("Call name")}"
        ></grampsjs-form-string>
      </p>
      <p class="${Ot({hide:!this.showMore})}">
        <grampsjs-form-string
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="nick"
          value="${this.data.nick||""}"
          label="${this._("Nick name")}"
        ></grampsjs-form-string>
      </p>
      <p class="${Ot({hide:!this.showMore})}">
        <grampsjs-form-string
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="famnick"
          value="${this.data.famnick||""}"
          label="${this._("Family nick name")}"
        ></grampsjs-form-string>
      </p>

      <div class="clear"></div>

      <h4 class="label ${Ot({hide:!this.showMore})}">
        ${this._("Surnames")}
      </h4>
      ${(this.data.surname_list||[{}]).map(((t,e)=>M`
          <mwc-icon-button
            ?disabled="${!this.data?.surname_list||1===this.data?.surname_list?.length}"
            class="edit ${Ot({hide:!this.showMore})}"
            icon="delete"
            @click="${()=>this._handleDeleteSurname(e)}"
          ></mwc-icon-button>

          <mwc-icon-button
            ?disabled="${!this.data?.surname_list||0===e}"
            class="edit ${Ot({hide:!this.showMore})}"
            icon="arrow_upward"
            @click="${()=>this._handleUpSurname(e)}"
          ></mwc-icon-button>

          <mwc-icon-button
            ?disabled="${!this.data?.surname_list||e===this.data?.surname_list?.length-1}"
            class="edit ${Ot({hide:!this.showMore})}"
            icon="arrow_downward"
            @click="${()=>this._handleDownSurname(e)}"
          ></mwc-icon-button>

          <grampsjs-form-surname
            ?origintype="${this.origintype}"
            ?showMore="${this.showMore}"
            id="surnames${e}"
            idx="${e}"
            @formdata:changed="${this._handleFormData}"
            .strings="${this.strings}"
            .data="${t}"
            .types="${this.types}"
            ?loadingTypes=${this.loadingTypes}
            .typesLocale="${this.typesLocale}"
          >
          </grampsjs-form-surname>
          <hr />
        `))}
      <p class="${Ot({hide:!this.showMore})}">
        <mwc-icon-button
          @click="${this._handleAddSurname}"
          icon="add"
        ></mwc-icon-button>
      </p>

      ${this.showMore?"":M`
            <mwc-icon-button
              class="edit"
              id="button-show-more"
              @click="${this._handleShowMore}"
              icon="more_horiz"
            ></mwc-icon-button>
            <grampsjs-tooltip for="button-show-more" .strings="${this.strings}"
              >${this._("Show more")}</grampsjs-tooltip
            >
          `}
    `}_handleShowMore(){this.showMore=!0}reset(){this.shadowRoot.querySelectorAll("grampsjs-form-string").forEach((t=>t.reset())),this.shadowRoot.querySelector("grampsjs-form-surname").reset(),this.showMore=!1,this.data={_class:"Name"}}handleChange(){os(this,"formdata:changed",{data:this.data})}_handleAddSurname(){this.data={...this.data,surname_list:[...this.data.surname_list||[{}],{}]}}_handleDeleteSurname(t){this.data.surname_list.splice(t,1),this.data={...this.data,surname_list:[...this.data.surname_list]}}_handleUpSurname(t){this.data={...this.data,surname_list:[...this.moveItem(this.data.surname_list,t,t-1)]}}_handleDownSurname(t){this.data={...this.data,surname_list:[...this.moveItem(this.data.surname_list,t,t+1)]}}_handleFormData(t){const e=t.composedPath()[0];if(["first_name","call","nick","famnick","title","suffix"].includes(e.id))this.data={...this.data,[e.id]:t.detail.data};else if(e.id.startsWith("surnames")){const e=t.detail.idx,i=this.data.surname_list||[];this.data={...this.data,surname_list:[...i.slice(0,e),t.detail.data,...i.slice(e+1)]}}t.stopPropagation(),this.handleChange()}moveItem=(t,e,i)=>{const r=t[e];return t.splice(e,1),t.splice(i,0,r),t}}window.customElements.define("grampsjs-form-name",Fk);window.customElements.define("grampsjs-form-edit-name",class extends lh{static get properties(){return{isFormValid:{type:Boolean}}}constructor(){super(),this.isFormValid=!1}renderForm(){return M`
      <grampsjs-form-select-type
        required
        id="name-type"
        noheading
        label="${this._("Name type")}"
        .strings="${this.strings}"
        typeName="name_types"
        ?loadingTypes=${this.loadingTypes}
        defaultTypeName="Birth Name"
        initialValue=${this.data?.type?.string||this.data?.type||null}
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
        @formdata:changed="${this._handleFormData}"
      >
      </grampsjs-form-select-type>

      <grampsjs-form-name
        origintype
        id="name"
        @formdata:changed="${this._handleFormData}"
        ?loadingTypes=${this.loadingTypes}
        .strings="${this.strings}"
        .data="${this.data}"
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
      >
      </grampsjs-form-name>
    `}_handleFormData(t){super._handleFormData(t),this.checkFormValidity()}checkFormValidity(){const t=this.shadowRoot.querySelector("grampsjs-form-select-type");this.isFormValid=null===t||t.isValid()}get isValid(){return this.isFormValid}});class Nk extends(al(K)){static get styles(){return[nl,n`
        h4 {
          clear: left;
        }
      `]}static get properties(){return{data:{type:Object}}}constructor(){super(),this.data={}}render(){return M`
      <h4>${this._(this.data.type)}</h4>
      <dl>
        ${this.data.title?M`
              <div>
                <dt>${this._("Title")}</dt>
                <dd>${this.data.title}</dd>
              </div>
            `:""}
        ${this.data.first_name?M`
              <div>
                <dt>${this._("Given name")}</dt>
                <dd>${this.data.first_name}</dd>
              </div>
            `:""}
        ${this.data.suffix?M`
              <div>
                <dt>${this._("Suffix")}</dt>
                <dd>${this.data.suffix}</dd>
              </div>
            `:""}
        ${this.data.call?M`
              <div>
                <dt>${this._("Call name")}</dt>
                <dd>${this.data.call}</dd>
              </div>
            `:""}
        ${this.data.nick?M`
              <div>
                <dt>${this._("Nickname")}</dt>
                <dd>${this.data.nick}</dd>
              </div>
            `:""}
        ${this.data.surname_list.length>0?M`
              ${this.data.surname_list.map((t=>M`
                  <div>
                    <dt>
                      ${this._("Surname")}
                      ${t.origintype?M`(${this._(t.origintype)})`:""}
                    </dt>
                    <dd>
                      ${t.prefix} ${t.surname} ${t.connector}
                    </dd>
                  </div>
                `))}
            `:""}
        ${this.data.famnick?M`
              <div>
                <dt>${this._("Family nick name")}</dt>
                <dd>${this.data.famnick}</dd>
              </div>
            `:""}
      </dl>
    `}}window.customElements.define("grampsjs-name",Nk);window.customElements.define("grampsjs-names",class extends pf{static get properties(){return{data:{type:Array},edit:{type:Boolean},dialogContent:{type:String},dialogTitle:{type:String}}}constructor(){super(),this.data=[],this.edit=!1,this.dialogContent="",this.dialogTitle="",this.hasEdit=!0}row(t){return M` ${t?M`
          <mwc-list-item style="height: auto">
            <grampsjs-name
              .strings="${this.strings}"
              .data="${t}"
            ></grampsjs-name>
          </mwc-list-item>
        `:""}`}_handleAdd(){this.dialogContent=M`
      <grampsjs-form-edit-name
        id="name"
        @object:save="${this._handleNameAdd}"
        @object:cancel="${this._handleNameCancel}"
        .strings="${this.strings}"
      >
      </grampsjs-form-edit-name>
    `}_handleDelete(){const t=this._selectedIndex;this.dialogContent=M`
      <mwc-dialog
        open
        @closed="${e=>this._handleDialog(t,e)}"
        heading="${this._("Are you sure?")}"
      >
        <div>${this._("This action cannot be undone.")}</div>
        <mwc-button slot="primaryAction" dialogAction="confirm">
          ${this._("Yes")}
        </mwc-button>
        <mwc-button slot="secondaryAction" dialogAction="cancel">
          ${this._("Cancel")}
        </mwc-button>
      </mwc-dialog>
    `}_handleEdit(){const t=this._selectedIndex;this.dialogContent=M`
      <grampsjs-form-edit-name
        id="name"
        @object:save="${e=>this._handleNameSave(t,e)}"
        @object:cancel="${this._handleNameCancel}"
        .strings="${this.strings}"
        .data="${this.data[t]}"
      >
      </grampsjs-form-edit-name>
    `}_handleDialog(t,e){"confirm"===e.detail.action?this._handleNameDelete(t,e):"cancel"===e.detail.action&&this._handleNameCancel()}_handleNameAdd(t){os(this,"edit:action",{action:"addName",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleNameDelete(t,e){os(this,"edit:action",{action:"delName",data:{index:t}}),e.preventDefault(),e.stopPropagation(),this.dialogContent=""}_handleNameSave(t,e){os(this,"edit:action",{action:"updateName",data:{index:t,name:e.detail.data}}),e.preventDefault(),e.stopPropagation(),this.dialogContent=""}_handleNameCancel(){this.dialogContent=""}});window.customElements.define("grampsjs-place-children",class extends Mk{constructor(){super(),this.objType="Place",this._columns=["Name","Type"]}row(t,e,i){return M`
      <tr @click=${()=>this._handleClick(t.gramps_id)}>
        <td>${t.name}</td>
        <td>${t.type}</td>
      </tr>
    `}_handleClick(t){this.edit||os(this,"nav",{path:this._getItemPath(t)})}_getItemPath(t){return`place/${t}`}});window.customElements.define("grampsjs-form-placeref",class extends lh{static get properties(){return{place:{type:Object}}}constructor(){super(),this.place={}}renderForm(){return M`
      <h4 class="label">${this._("Place")}</h4>
      <p>
        <grampsjs-form-select-object-list
          fixedMenuPosition
          notDeletable
          style="min-height: 300px;"
          objectType="place"
          .objectsInitial="${this.data.ref?[{object_type:"place",object:this.place,handle:this.data.ref}]:[]}"
          .strings="${this.strings}"
          id="place-select"
          label="${this._("Select")}"
          class="edit"
        ></grampsjs-form-select-object-list>
      </p>

      <h4 class="label">${this._("Date")}</h4>
      <p>
        ${this.data?.date?M`
              <grampsjs-form-select-date
                fullwidth
                id="date"
                @formdata:changed="${this._handleFormData}"
                .strings="${this.strings}"
                .data="${this.data.date}"
              >
              </grampsjs-form-select-date>
            `:M`
              <grampsjs-form-select-date
                fullwidth
                id="date"
                @formdata:changed="${this._handleFormData}"
                .strings="${this.strings}"
              >
              </grampsjs-form-select-date>
            `}
      </p>
    `}get isValid(){return!!this.data.ref&&this._areDateSelectValid()}});window.customElements.define("grampsjs-place-refs",class extends Mk{static get properties(){return{places:{type:Array},dialogContent:{type:String}}}constructor(){super(),this.places=[],this.objType="Place",this._columns=["Name","Type",""],this.dialogContent=""}row(t,e,i){const r=this.places.length>e?this.places[e].profile:{};return M`
      <tr @click=${()=>this._handleClick(r.gramps_id)}>
        <td>${r.name}</td>
        <td>${r.type}</td>
        <td>
          ${this.edit?this._renderActionBtns(t.ref,0===e,e===i.length-1):""}
        </td>
      </tr>
    `}renderAfterTable(){return this.edit?M`
          <mwc-icon-button
            class="edit large"
            icon="add_circle"
            @click="${this._handleAddClick}"
          ></mwc-icon-button>
          ${this.dialogContent}
        `:""}update(t){super.update(t),t.has("data")&&this._updateData()}async _updateData(){if(0===this.data.length)this.places=[];else{const t=[];this.loading=!0;const e=this.data.map((t=>t.ref));for(let i=0;i<e.length;i+=1){const r=await On(this._getUrl(e[i]));t.push(r?.data||{})}this.places=[...t]}}_getUrl(t){return`/api/places/${t}?locale=${this.strings?.__lang__||"en"}&profile=self`}_handleAddClick(){this.dialogContent=M`
      <grampsjs-form-placeref
        new
        @object:save="${this._handlePlaceRefAdd}"
        @object:cancel="${this._handlePlaceRefCancel}"
        .strings="${this.strings}"
        dialogTitle=${this._("Share an existing place")}
      >
      </grampsjs-form-placeref>
    `}_handlePlaceRefAdd(t){os(this,"edit:action",{action:"addPlaceRef",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handlePlaceRefCancel(){this.dialogContent=""}_handleClick(t){this.edit||os(this,"nav",{path:this._getItemPath(t)})}_getItemPath(t){return`place/${t}`}});window.customElements.define("grampsjs-lightbox",class extends K{static get styles(){return[nl,n`
        #lightbox-container {
          background-color: black;
          position: fixed;
          left: 0;
          top: 0;
          right: 0;
          min-height: 100vh;
          width: 100vw;
          z-index: 10000;
          overflow: auto;
        }

        #lightbox {
          width: 100%;
          position: fixed;
          overflow: hidden;
          top: 0;
          left: 0;
          bottom: 70px;
          color: white;
          display: flex;
          justify-content: center;
          align-items: center;
        }

        #text {
          position: absolute;
          box-sizing: border-box;
          width: 100%;
          top: calc(100vh - 70px);
          left: 0;
          background-color: white;
          z-index: 10002;
          min-height: 70px;
          overflow-x: hidden;
          margin: 0;
        }

        #description-container {
          font-family: var(--grampsjs-heading-font-family);
          height: 70px;
          font-size: 22px;
          line-height: 30px;
          font-weight: 400;
          overflow: hidden;
          padding: 20px;
          text-overflow: ellipsis;
        }

        #button-container {
          float: right;
          height: 70px;
          width: 300px;
          font-size: 22px;
          line-height: 30px;
          font-weight: 400;
          overflow: hidden;
          padding: 20px;
          text-overflow: ellipsis;
          text-align: right;
        }

        #detail-container {
          clear: right;
        }

        .lightbox-nav {
          z-index: 10001;
        }

        .lightbox-nav svg {
          height: 2em;
          width: 2em;
        }

        .lightbox-nav:hover svg path {
          fill: #ffffff;
        }

        .lightbox-nav svg path {
          fill: #aaaaaa;
        }

        #close-lightbox {
          position: fixed;
          right: 1.5em;
          top: 1.5em;
        }

        .arrow {
          position: fixed;
          top: calc(50vh - 45px);
        }

        .arrow-left {
          left: 5vw;
        }

        .arrow-right {
          right: 5vw;
        }

        #media-container {
          position: absolute;
          width: 100%;
          height: 100%;
          text-align: center;
        }
      `]}static get properties(){return{open:{type:Boolean},_translateX:{type:Number},hideLeftArrow:{type:Boolean},hideRightArrow:{type:Boolean},disableTouch:{type:Boolean}}}constructor(){super(),this.open=!1,this._translateX=0,this.hideLeftArrow=!1,this.hideRightArrow=!1,this.disableTouch=!1}render(){return this.open?M`
      <div id="lightbox-container" @keydown="${this._handleKeyPress}">
        <div class="lightbox-nav" id="close-lightbox" tabindex="0">
          <span @click="${this._close}" class="link" @keydown=""
            >${Oa}</span
          >
        </div>
        ${this.hideLeftArrow?"":M`
              <div class="lightbox-nav arrow arrow-left">
                <span @click="${this._handleLeft}" class="link" @keydown=""
                  >${Ba}</span
                >
              </div>
            `}
        ${this.hideRightArrow?"":M`
              <div class="lightbox-nav arrow arrow-right">
                <span @click="${this._handleRight}" class="link" @keydown=""
                  >${Fa}</span
                >
              </div>
            `}
        <div
          id="lightbox"
          tabindex="0"
          style="transform: translateX(${this._translateX}px);"
          @touchstart="${this._handleTouchStart}"
          @touchmove="${this._handleTouchMove}"
          @touchend="${this._handleTouchEnd}"
        >
          <slot
            name="image"
            @rect:draw-start="${this._handleRectStart}"
            @rect:draw-end="${this._handleRectEnd}"
          ></slot>
        </div>
        <div id="text" tabindex="0">
          <div id="button-container">
            <slot name="button"></slot>
          </div>
          <div id="description-container">
            <slot name="description"></slot>
          </div>
          <div id="detail-container">
            <slot name="details"></slot>
          </div>
        </div>
      </div>
    `:M``}_close(){this.open=!1}_handleLeft(){this.dispatchEvent(new CustomEvent("lightbox:left",{bubbles:!0,composed:!0,detail:{id:this.id}}))}_handleRight(){this.dispatchEvent(new CustomEvent("lightbox:right",{bubbles:!0,composed:!0,detail:{id:this.id}}))}_handleKeyPress(t){"Escape"===t.code?this._close():"ArrowRight"===t.key||"Right"===t.key?this._handleRight():"ArrowLeft"!==t.key&&"Left"!==t.key||this._handleLeft()}_handleRectStart(t){this.disableTouch=!0,t.preventDefault(),t.stopPropagation()}_handleRectEnd(t){this.disableTouch=!1,t.preventDefault(),t.stopPropagation()}_handleTouchStart(t){this.disableTouch||(this._touchStartX=t.touches[0].pageX,this._touchMoveX=this._touchStartX)}_handleTouchMove(t){this.disableTouch||(this._touchMoveX=t.touches[0].pageX,this._translateX=this._touchMoveX-this._touchStartX)}_handleTouchEnd(){if(!this.disableTouch){this._translateX=0;const t=this._touchMoveX-this._touchStartX;t<-10?this._handleRight():t>10&&this._handleLeft()}}_focus(){if(this.open){this.shadowRoot.getElementById("lightbox").focus()}}updated(){this._focus()}});class Hk extends(al(K)){static get styles(){return[nl,n`
        #rect-container {
          display: inline-block;
          position: relative;
          overflow: hidden;
        }

        .draw {
          cursor: crosshair;
        }
      `]}static get properties(){return{draw:{type:Boolean},_drawActive:{type:Boolean},_drawStart:{type:Array},_drawEnd:{type:Array}}}constructor(){super(),this.draw=!1,this._drawActive=!1,this._drawStart=[],this._drawEnd=[]}render(){return M`
      <div
        id="rect-container"
        class="${Ot({draw:this.draw})}"
        @pointerdown="${this._handleDown}"
        @pointerup="${this._handleUp}"
        @pointermove="${this._handleMove}"
        @pointerleave="${this._handleUp}"
      >
        <slot name="image"></slot>
        ${this.draw?"":M`<slot></slot>`}
      </div>
    `}_handleDown(t){t.preventDefault(),t.stopPropagation(),this._drawActive=!0,this._drawStart=this._getRelativeCoords(t)}_handleUp(){this._drawActive&&(this._drawActive=!1)}_handleMove(t){if(!this._drawActive)return;const e=this._getRelativeCoords(t);if(e&&this._drawStart){const[t,i]=e,[r,n]=this._drawStart,a=Math.round(Math.max(0,Math.min(r,t))),s=Math.round(Math.min(Math.max(r,t),100));os(this,"rect:draw",{rect:[a,Math.round(Math.max(0,Math.min(n,i))),s,Math.round(Math.min(Math.max(n,i),100))]})}}_getRelativeCoords(t){const e=this.renderRoot.querySelector("#rect-container");if(e){const i=e.getBoundingClientRect();return[(t.clientX-i.left)/i.width*100,(t.clientY-i.top)/i.height*100]}return null}}window.customElements.define("grampsjs-rect-container",Hk);window.customElements.define("grampsjs-rect",class extends K{static get styles(){return[nl,n`
        .rect {
          border-radius: 3px;
          border: 2px solid rgba(255, 255, 255, 0.6);
          box-shadow: 0 0 1px 1px rgba(0, 0, 0, 0.4);
          position: absolute;
          cursor: pointer;
        }

        .rect .label {
          background-color: rgba(0.5, 0.5, 0.5, 0.25);
          border-radius: 3px;
          color: #fff;
          cursor: pointer;
          display: block;
          font-size: 0.8em;
          left: 50%;
          overflow: hidden;
          padding: 0.1em 0.5em;
          position: relative;
          top: 100%;
          transform: translate(-50%, 10px);
          text-align: center;
        }

        .rect.selected {
          border: 3px solid var(--mdc-theme-secondary);
          box-shadow: 0px 0px 0px 9999px rgba(0, 0, 0, 0.4);
        }

        .rect.muted {
          border-style: dotted;
          box-shadow: None;
        }

        @media (hover: hover) {
          .rect .label {
            background-color: rgba(0.5, 0.5, 0.5, 0.25);
            border-radius: 3px;
            color: #fff;
            cursor: pointer;
            display: block;
            font-size: 0.7em;
            left: 50%;
            overflow: hidden;
            padding: 0 0.5em;
            position: relative;
            top: 100%;
            transform: translate(-50%, 10px);
          }
        }

        .rect.selected .label {
          display: block;
        }

        .rect.inner {
          display: none;
        }
      `]}static get properties(){return{rect:{type:Array},label:{type:String},target:{type:String},selected:{type:Boolean},muted:{type:Boolean}}}constructor(){super(),this.rect=[],this.label="",this.target="",this.selected=!1,this.muted=!1}render(){if(0===this.rect.length)return"";const t=this.rect[0],e=this.rect[1],i=this.rect[2]-this.rect[0],r=this.rect[3]-this.rect[1];return M`
      <div
        class="rect ${Ot({selected:this.selected,muted:this.muted})}"
        @click="${this._handleClick}"
        @keydown=""
        style="left:${t}%;top:${e}%;width:${i}%;height:${r}%;"
      >
        <div class="rect inner ${Ot({selected:this.selected})}"></div>
        <div class="label">${this.label}</div>
        <slot></slot>
      </div>
    `}_handleClick(){this.dispatchEvent(new CustomEvent("rect:clicked",{bubbles:!0,composed:!0,detail:{target:this.target}}))}});window.customElements.define("grampsjs-view-media-lightbox",class extends $d{static get styles(){return[nl,n`
        :host {
          margin: 0px;
        }

        .date {
          font-size: 0.85em;
          font-weight: 300;
          font-family: var(--grampsjs-body-font-family);
          color: rgba(0, 0, 0, 0.8);
          padding-left: 0.8em;
        }

        mwc-icon-button.download {
          color: var(--mdc-theme-primary);
          position: relative;
          bottom: 5px;
          margin-right: 10px;
        }
      `]}static get properties(){return{handle:{type:String},_data:{type:Object},hideLeftArrow:{type:Boolean},hideRightArrow:{type:Boolean},editRect:{type:Boolean}}}constructor(){super(),this._data={},this.hideLeftArrow=!1,this.hideRightArrow=!1,this.editRect=!1}renderContent(){return M`
      <grampsjs-lightbox
        id="gallery-lightbox"
        ?hideLeftArrow=${this.hideLeftArrow}
        ?hideRightArrow=${this.hideRightArrow}
      >
        <div slot="image">${this._innerContainerContent()}</div>
        <span slot="description"
          >${this._data?.desc||""}
          ${this._data?.profile?.date?M`<span class="date">${this._data?.profile?.date}</span>`:""}</span
        >
        <span slot="button">
          <mwc-icon-button
            icon="download"
            class="download"
            @click="${this._handleDownload}"
          ></mwc-icon-button>
          <mwc-button
            unelevated
            label="${this._("Show Details")}"
            @click="${this._handleButtonClick}"
          >
          </mwc-button>
        </span>
        <span slot="details"></span>
      </grampsjs-lightbox>
    `}open(){const t=this.shadowRoot.getElementById("gallery-lightbox");t&&(t.open=!0)}_innerContainerContent(){if(0===Object.keys(this._data).length)return M``;const{mime:t}=this._data;return t.startsWith("image/")?this._innerContainerContentImage():"application/pdf"===t?this._innerContainerContentPdf():this._innerContainerContentFile()}_innerContainerContentPdf(){return M` <object
      data="${Vn(this._data.handle)}"
      type="application/pdf"
      title="PDF"
      style="width: 80vw; height: 90vh;"
      @error=${this._pdfErrorHandler}
    >
      ${this._innerContainerContentFile("application/pdf")}
    </object>`}_pdfErrorHandler(){this.dispatchEvent(new CustomEvent("grampsjs:error",{bubbles:!0,composed:!0,detail:{message:"Failed loading PDF file"}}))}_innerContainerContentFile(){return this._renderImage()}_innerContainerContentImage(){return M` <grampsjs-rect-container
      ?edit="${this.editRect}"
      .strings="${this.strings}"
      @rect:save="${this._handleSaveRect}"
    >
      ${this._renderImage()}
      ${this._getRectangles().map((t=>M`
          <grampsjs-rect
            .rect="${t.rect}"
            label="${t.label}"
            target="${t.type}/${t.grampsId}"
          >
          </grampsjs-rect>
        `))}
    </grampsjs-rect-container>`}_renderImage(){const{handle:t,mime:e}=this._data;return M`
      <grampsjs-img
        handle="${t}"
        size="2000"
        mime="${e}"
        slot="image"
      ></grampsjs-img>
    `}_handleDownload(){window.location.assign(Vn(this._data.handle,!0))}_handleButtonClick(){this.shadowRoot.getElementById("gallery-lightbox").open=!1,this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:`media/${this._data?.gramps_id}`}}))}_handleSaveRect(t){const e=this.shadowRoot.querySelector("grampsjs-img");if(null===e)return;const i=e.getBBox(),r=t.detail.bbox,n=Math.max(0,(r.left-i.left)/i.width),a=Math.min(1,(r.right-i.left)/i.width),s=Math.max(0,(r.top-i.top)/i.height),o=Math.min(1,(r.bottom-i.top)/i.height),l=[Math.round(100*n),Math.round(100*s),Math.round(100*a),Math.round(100*o)];if((l[2]-l[0])*(l[3]-l[1])>0){os(this,"edit:action",{action:"updateMediaRef",data:{ref:this.handle,rect:l}})}}update(t){super.update(t),t.has("handle")&&this._updateData()}getUrl(){return`/api/media/${this.handle}?locale=${this.strings?.__lang__||"en"}&profile=all&backlinks=true&extend=all`}_updateData(){void 0!==this.handle&&this.handle&&(this._data={},On(this.getUrl()).then((t=>{"data"in t?(this.error=!1,this._data=t.data):"error"in t&&(this.error=!0,this._errorMessage=t.error)})))}_getRectangles(){const t=this._data?.extended?.backlinks||{},e=this._data?.profile?.references||{};return 0===Object.keys(t).length?[]:Object.keys(t).map((i=>t[i].map(((t,r)=>{const n=i in e?e[i]:[],a=n.length>=r?ss(n[r]||{},i,this.strings):"...";return{rect:t?.media_list?.find((t=>t.ref===this._data.handle))?.rect,type:i,label:a,grampsId:t.gramps_id}})))).flat().filter((t=>t.rect?.length>0))}connectedCallback(){super.connectedCallback(),window.addEventListener("db:changed",(()=>this._updateData()))}});window.customElements.define("grampsjs-form-mediaref",class extends lh{renderForm(){return M`
      <grampsjs-form-select-object-list
        fixedMenuPosition
        style="min-height: 300px;"
        objectType="media"
        .strings="${this.strings}"
        id="media-select"
        label="${this._("Select")}"
        class="edit"
      ></grampsjs-form-select-object-list>
    `}});const Vk=t=>class extends t{renderForm(){return M`
        <h4 class="label">${this._("File")}</h4>
        <p>
          <grampsjs-form-upload
            preview
            id="upload"
            .strings="${this.strings}"
          ></grampsjs-form-upload>
        </p>

        <h4 class="label">${this._("Title")}</h4>
        <p>
          <grampsjs-form-string
            ?disabled="${!this.isFormValid}"
            value="${this.data.desc}"
            fullwidth
            id="desc"
          ></grampsjs-form-string>
        </p>

        <h4 class="label">${this._("Date")}</h4>
        <p>
          <grampsjs-form-select-date id="date" .strings="${this.strings}">
          </grampsjs-form-select-date>
        </p>

        <div class="spacer"></div>
        <grampsjs-form-private
          id="private"
          .strings="${this.strings}"
        ></grampsjs-form-private>
      `}};class Uk extends(Vk(lh)){constructor(){super(),this.data={_class:"Media"}}checkFormValidity(){const t=this.shadowRoot.getElementById("upload");this.isFormValid=!!t.file.name}_handleFormData(t){super._handleFormData(t);const e=t.composedPath()[0];"date"===e.id&&(this.data={...this.data,date:t.detail.data}),"upload"===e.id&&(this.data={...this.data,desc:t.detail.data.name.replace(/\.[^/.]+$/,"")}),this.checkFormValidity()}async upload(t=!1){const e=this.shadowRoot.getElementById("upload");let i=await Nn("/api/media/",e.file,!1,!1);if("data"in i)this.data={...i.data[0].new,...this.data};else if("error"in i)return os(this,"grampsjs:error",{message:i.error}),{error:i.error};const r=`/api/media/${this.data.handle}`;return i=await Fn(r,this.data,!0,t),"error"in i?(os(this,"grampsjs:error",{message:i.error}),{error:i.error}):{data:this.data}}}window.customElements.define("grampsjs-form-new-media",Uk);class Yk extends(al(K)){static get styles(){return[nl,n`
        .tile {
          margin: 3px;
          float: left;
          cursor: pointer;
          position: relative;
        }

        .clear {
          clear: both;
          padding-bottom: 2em;
        }

        .delbtn {
          position: absolute;
          right: 5px;
          bottom: 5px;
          opacity: 0.7;
        }
      `]}static get properties(){return{mediaRef:{type:Array},media:{type:Array},dialogContent:{type:String},edit:{type:Boolean},editRect:{type:Boolean},_lightboxSelected:{type:Number},radius:{type:Number},size:{type:Number},square:{type:Boolean}}}constructor(){super(),this.mediaRef=[],this.media=[],this.edit=!1,this.editRect=!1,this.dialogContent="",this._lightboxSelected=0,this.radius=0,this.size=200,this.square=!1}render(){return M`
      <div class="tiles">
        ${this.media.map(((t,e,i)=>this._renderThumbnail(e,i.length)))}
      </div>

      <div class="clear"></div>

      <grampsjs-view-media-lightbox
        active
        ?editRect="${this.editRect}"
        id="gallery-lightbox-view"
        @lightbox:left="${this._handleLeft}"
        @lightbox:right="${this._handleRight}"
        @rect:clicked="${this._handleRectClick}"
        handle="${this.media[this._lightboxSelected]?.handle}"
        ?hideLeftArrow="${0===this._lightboxSelected}"
        ?hideRightArrow="${this._lightboxSelected===this.media.length-1}"
        .strings="${this.strings}"
      >
      </grampsjs-view-media-lightbox>

      ${this.edit?M`
            <div>
              <mwc-icon-button
                class="edit"
                icon="add_link"
                @click="${this._handleShareClick}"
              ></mwc-icon-button>
              <mwc-icon-button
                class="edit"
                icon="add"
                @click="${this._handleAddClick}"
              ></mwc-icon-button>
              ${this.dialogContent}
            </div>
          `:""}
    `}_handleRectClick(t){this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:t.detail.target}}))}_handleClick(t){if(!this.edit){const e=this.shadowRoot.getElementById("gallery-lightbox-view");e&&(this._lightboxSelected=t,e.open())}}_handleLeft(t){"gallery-lightbox"===t.detail?.id&&this._lightboxSelected>0&&(this._lightboxSelected-=1)}_handleRight(t){"gallery-lightbox"===t.detail?.id&&this._lightboxSelected<this.media.length-1&&(this._lightboxSelected+=1)}_renderThumbnail(t,e){const i=this.media[t],{handle:r,mime:n}=i,{rect:a}=this.mediaRef[t];return M`<div class="tile">
      <grampsjs-img
        ?square="${this.square}"
        radius="${this.radius}"
        handle="${r}"
        size="300"
        displayHeight="${this.size}"
        .rect="${a||[]}"
        mime="${n}"
        @click="${()=>this._handleClick(t)}"
      ></grampsjs-img>
      ${this.edit?M`
            <div class="delbtn">
              ${0===t?"":M`
                    <mwc-icon-button
                      class="edit"
                      icon="arrow_back"
                      @click="${()=>this._handleMediaRefLeft(this.mediaRef[t].ref)}"
                    ></mwc-icon-button>
                  `}
              ${t===e-1?"":M` <mwc-icon-button
                    class="edit"
                    icon="arrow_forward"
                    @click="${()=>this._handleMediaRefRight(this.mediaRef[t].ref)}"
                  ></mwc-icon-button>`}
              <mwc-icon-button
                class="edit"
                icon="delete"
                @click="${()=>this._handleMediaRefDel(this.mediaRef[t].ref)}"
              ></mwc-icon-button>
            </div>
          `:""}
    </div>`}_handleMediaRefDel(t){os(this,"edit:action",{action:"delMediaRef",handle:t})}_handleMediaRefLeft(t){os(this,"edit:action",{action:"upMediaRef",handle:t})}_handleMediaRefRight(t){os(this,"edit:action",{action:"downMediaRef",handle:t})}_handleAddClick(){this.dialogContent=M`
      <grampsjs-form-new-media
        @object:save="${this._handleNewMediaSave}"
        @object:cancel="${this._handleMediaRefCancel}"
        .strings="${this.strings}"
        dialogTitle="${this._("Add a new media object")}"
      >
      </grampsjs-form-new-media>
    `}_handleShareClick(){this.dialogContent=M`
      <grampsjs-form-mediaref
        new
        @object:save="${this._handleMediaRefSave}"
        @object:cancel="${this._handleMediaRefCancel}"
        .strings="${this.strings}"
        objType="${this.objType}"
        dialogTitle=${this._("Select an existing media object")}
      >
      </grampsjs-form-mediaref>
    `}_handleNewMediaSave(t){this.renderRoot.querySelector("grampsjs-form-new-media").upload(!1).then((t=>{"data"in t&&os(this,"edit:action",{action:"addMediaRef",data:{ref:t.data.handle}}),this.dialogContent=""})),t.preventDefault(),t.stopPropagation()}_handleMediaRefSave(t){os(this,"edit:action",{action:"addMediaRef",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleMediaRefCancel(){this.dialogContent=""}}window.customElements.define("grampsjs-gallery",Yk);window.customElements.define("grampsjs-participants",class extends Ik{render(){return 0===this.data.length||0===Object.keys(this.data[0]).length?M``:M`
      <table class="linked">
        <tr>
          <th>${this._("Role")}</th>
          <th>${this._("Name")}</th>
        </tr>
        ${this.data[0].families.map((t=>M`
            <tr
              @click=${()=>this._handleClick("family",t.family.gramps_id)}
            >
              <td>${this._(t.role)}</td>
              <td>${Xa(t.family)||""}</td>
            </tr>
          `),this)}
        ${this.data[0].people.map((t=>M`
            <tr
              @click=${()=>this._handleClick("person",t.person.gramps_id)}
            >
              <td>${this._(t.role)}</td>
              <td>${qa(t.person)||""}</td>
            </tr>
          `),this)}
      </table>
    `}_handleClick(t,e){this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:this._getItemPath(t,e)}}))}_getItemPath(t,e){return`${t}/${e}`}});window.customElements.define("grampsjs-references",class extends Ik{static get properties(){return{profile:{type:Object}}}constructor(){super(),this.profile={}}render(){return 0===this.data.length||0===Object.keys(this.data[0]).length?M``:M`
      <table class="linked">
        <tr>
          <th>${this._("Type")}</th>
          <th>${this._("Description")}</th>
        </tr>
        ${Object.keys(this.data[0]).map((t=>this.data[0][t].map(((e,i)=>{return M`
                <tr @click=${()=>this._handleClick(t,e.gramps_id)}>
                  <td>${this._((r=t,`${r.charAt(0).toUpperCase()}${r.slice(1)}`))}</td>
                  <td>
                    ${t in this.profile?ss(this.profile[t][i]||{},t,this.strings)||ts(e,t)||"":ts(e,t)}
                  </td>
                </tr>
              `;var r}),this)),this)}
      </table>
    `}_handleClick(t,e){this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:this._getItemPath(t,e)}}))}_getItemPath(t,e){return`${t}/${e}`}});class Zk extends(al(K)){static get styles(){return[nl,n`
        .familybtn {
          margin-left: 1.5em;
        }

        .number {
          color: rgba(0, 0, 0, 0.35);
          font-size: 22px;
        }
      `]}static get properties(){return{grampsId:{type:String},familyList:{type:Array},families:{type:Array},parentFamilies:{type:Array},primaryParentFamily:{type:Object},otherParentFamilies:{type:Array}}}constructor(){super(),this.grampsId="",this.familyList=[],this.parentFamilyList=[],this.families=[],this.otherParentFamilies=[],this.primaryParentFamily={}}render(){return M`
      ${this._renderFamily(this.primaryParentFamily,this._("Parents"),this._("Siblings"))}
      ${this.otherParentFamilies.map(((t,e)=>this._renderFamily(t,`${this._("Parents")} #${e+2}`,this._("Siblings"))),this)}
      ${this.families.map(((t,e)=>this._renderFamily(t,M`${this._("Partner")}
            ${this.families.length<2?"":M`<span class="number">${e+1}</span>`}`,this._("Children"))),this)}
    `}_renderFamily(t,e,i){return 0===Object.keys(t).length?M``:M`
      <h3>${e} ${this._renderFamilyBtn(t.gramps_id)}</h3>
      ${t?.father?.gramps_id===this.grampsId||0===Object.keys(t?.father||{}).length?"":M` <p>${Qa(t.father)}</p> `}
      ${t?.mother?.gramps_id===this.grampsId||0===Object.keys(t?.mother||{}).length?"":M` <p>${Qa(t.mother)}</p> `}
      ${this._renderChildren(t,i)}
    `}_renderFamilyBtn(t){return M` <mwc-button
      class="familybtn"
      outlined
      label="${this._("Family")}"
      @click="${()=>this._handleButtonClick(t)}"
    >
    </mwc-button>`}_handleButtonClick(t){this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:`family/${t}`}}))}_renderChildren(t,e){const i=[...this.familyList,...this.parentFamilyList],[r]=i.filter((e=>e.handle===t.handle));return M`
      ${t?.children?.length?M`
            <h3>${e}</h3>
            <grampsjs-children
              .profile=${t?.children||[]}
              .data=${r.child_ref_list}
              .strings=${this.strings}
              highlightId="${this.grampsId}"
            >
            </grampsjs-children>
          `:""}
    `}}window.customElements.define("grampsjs-relationships",Zk);window.customElements.define("grampsjs-form-reporef",class extends lh{renderForm(){return M`
      <grampsjs-form-select-object-list
        fixedMenuPosition
        style="min-height: 300px;"
        objectType="repository"
        .strings="${this.strings}"
        id="repository-select"
        label="${this._("Select")}"
        class="edit"
      ></grampsjs-form-select-object-list>

      <h4 class="label">${this._("Call Number")}</h4>
      <p>
        <grampsjs-form-string
          fullwidth
          id="call_number"
          value="${this.data.call_number}"
        ></grampsjs-form-string>
      </p>

      <grampsjs-form-select-type
        required
        id="source-media-type"
        heading="${this._("Type")}"
        .strings="${this.strings}"
        typeName="source_media_types"
        ?loadingTypes=${this.loadingTypes}
        defaultTypeName="Book"
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
      >
      </grampsjs-form-select-type>
    `}});window.customElements.define("grampsjs-repositories",class extends Mk{static get properties(){return{extended:{type:Array}}}constructor(){super(),this.extended=[],this.objType="Repository",this._columns=["Title","Call Number","_Media Type:",""],this.dialogContent=""}row(t,e,i){return M`
      <tr @click=${()=>this._handleClick(this.extended[e].gramps_id)}>
        <td>${this.extended[e].name}</td>
        <td>${t.call_number}</td>
        <td>${this._(t.media_type)}</td>
        <td>
          ${this.edit?this._renderActionBtns(t.ref,0===e,e===i.length-1):""}
        </td>
      </tr>
    `}renderAfterTable(){return this.edit?M`
          <mwc-icon-button
            class="edit large"
            icon="add_circle"
            @click="${this._handleAddClick}"
          ></mwc-icon-button>
          ${this.dialogContent}
        `:""}_handleAddClick(){this.dialogContent=M`
      <grampsjs-form-reporef
        new
        @object:save="${this._handleRepoRefAdd}"
        @object:cancel="${this._handleRepoRefCancel}"
        .strings="${this.strings}"
        objType="${this.objType}"
        dialogTitle=${this._("Add an existing repository")}
      >
      </grampsjs-form-reporef>
    `}_handleRepoRefAdd(t){t.detail.data.ref&&os(this,"edit:action",{action:"addRepoRef",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleRepoRefCancel(){this.dialogContent=""}_handleClick(t){this.edit||os(this,"nav",{path:this._getItemPath(t)})}_getItemPath(t){return`repository/${t}`}});window.customElements.define("grampsjs-sources",class extends Mk{constructor(){super(),this.objType="Source",this._columns=["Title","Author","Abbreviation"]}row(t,e,i){return M`
      <tr @click=${()=>this._handleClick(t.gramps_id)}>
        <td>${t.title}</td>
        <td>${t.author}</td>
        <td>${t.abbrev}</td>
      </tr>
    `}_handleClick(t){this.edit||os(this,"nav",{path:this._getItemPath(t)})}_getItemPath(t){return`source/${t}`}});class qk extends(al(K)){static get styles(){return[nl,n`
        .chip {
          font-size: 14px;
          font-weight: 400;
          font-family: var(--grampsjs-body-font-family);
          padding: 6px 12px;
          border-radius: 9999px;
          margin: 5px 5px;
          border-width: 1px;
          border-style: solid;
        }

        .tags {
          clear: left;
          margin: 15px 0px;
          align-items: center;
          display: inline-flex;
          padding: 5px;
        }

        .chip mwc-icon-button {
          --mdc-icon-size: 14px;
          --mdc-icon-button-size: 18px;
        }

        .newtag {
          padding: 6px 12px;
        }
      `]}static get properties(){return{data:{type:Array},edit:{type:Boolean},hideTags:{type:Array}}}constructor(){super(),this.data=[],this.edit=!1,this.hideTags=[]}render(){return 0!==Object.keys(this.data).length||this.edit?M`
      <div class="tags">
        ${this.data.filter((t=>!this.hideTags.includes(t.name))).map((t=>M`
              <span
                class="chip"
                style="border-color:${Ya(t.color,.9)};color:${Ya(t.color,.9)};"
                >${t.name}${this.edit?M` <mwc-icon-button
                      icon="clear"
                      @click=${()=>this._handleClear(t.handle)}
                    ></mwc-icon-button>`:""}</span
              >
            `))}
        ${this.edit?M` <span class="newtag">
              <mwc-icon-button
                icon="new_label"
                id="btn-tag"
                class="edit"
                @click="${this._handleNewTag}"
              ></mwc-icon-button>
              <grampsjs-tooltip for="btn-tag" .strings="${this.strings}"
                >${this._("Add Tag")}</grampsjs-tooltip
              >
            </span>`:""}
      </div>
    `:M``}_handleNewTag(){os(this,"tag:new")}_handleList(){return this.data.map((t=>t.handle))}_handleClear(t){const e=this._handleList().filter((e=>e!==t));os(this,"edit:action",{action:"updateProp",data:{tag_list:e}})}}window.customElements.define("grampsjs-tags",qk);window.customElements.define("grampsjs-form-edit-url",class extends lh{renderForm(){return M`
      <p>
        <grampsjs-form-select-type
          required
          id="urltype"
          heading="${this._("Type")}"
          .strings="${this.strings}"
          typeName="url_types"
          ?loadingTypes=${this.loadingTypes}
          .types="${this.types}"
          .typesLocale="${this.typesLocale}"
          .data="${this.data}"
          initialValue=${this.data?.type?.string||""}
        >
        </grampsjs-form-select-type>
      </p>
      <p>
        <grampsjs-form-string
          required
          fullwidth
          id="path"
          @formdata:changed="${this._handleFormData}"
          label="${this._("Path")}"
          .strings="${this.strings}"
          .data="${this.data}"
          value="${this.data?.path||""}"
        >
        </grampsjs-form-string>
      </p>
      <p>
        <grampsjs-form-string
          fullwidth
          id="desc"
          @formdata:changed="${this._handleFormData}"
          label="${this._("Description")}"
          .strings="${this.strings}"
          .data="${this.data}"
          value="${this.data?.desc||""}"
        >
        </grampsjs-form-string>
      </p>
    `}});window.customElements.define("grampsjs-urls",class extends pf{row(t){return M`
      <mwc-list-item
        twoline
        graphic="avatar"
        ?hasMeta="${this.edit}"
        @click="${()=>this._handleClick(t)}"
      >
        <a
          href="${function(t){let e=t;try{e=new URL(t)}catch(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?`mailto:${t}`:`https://${t}`}return e}(t.path)}"
          target="_blank"
          class="${Ot({nopointer:this.edit})}"
          >${t.path}</a
        >
        <span slot="secondary"
          >${this._(t.type)}${t.type&&t.desc?M` &ndash; `:""}${t.desc}</span
        >
        <mwc-icon slot="graphic">open_in_new</mwc-icon>
      </mwc-list-item>
    `}_handleClick(t){this.edit||window.open(t.path,"_blank")}_handleAdd(){this.dialogContent=M`
      <grampsjs-form-edit-url
        new
        @object:save="${this._handleUrlSave}"
        @object:cancel="${this._handleDialogCancel}"
        .strings="${this.strings}"
      >
      </grampsjs-form-edit-url>
    `}_handleEdit(){const t=this.data[this._selectedIndex],e={type:{_class:"UrlType",string:t.type||""},path:t.path||"",desc:t.desc||""};this.dialogContent=M`
      <grampsjs-form-edit-url
        @object:save="${this._handleUrlSaveEdit}"
        @object:cancel="${this._handleDialogCancel}"
        .strings="${this.strings}"
        .data="${e}"
      >
      </grampsjs-form-edit-url>
    `}_handleDelete(){os(this,"edit:action",{action:"delURL",index:this._selectedIndex})}_handleUrlSave(t){os(this,"edit:action",{action:"addURL",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleUrlSaveEdit(t){os(this,"edit:action",{action:"updateURL",data:t.detail.data,index:this._selectedIndex}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleDialogCancel(){this.dialogContent=""}});const Wk={relationships:{title:"Relationships",condition:t=>t.family_list?.length>0||t.parent_family_list?.length>0,conditionEdit:()=>!1},names:{title:"_Names",condition:t=>"primary_name"in t,conditionEdit:t=>"primary_name"in t},enclosed:{title:"Place Hierarchy",condition:t=>t.placeref_list?.length>0||"placeref_list"in t&&t?.backlinks?.place?.length>=0,conditionEdit:t=>"placeref_list"in t},map:{title:"Map",condition:t=>null!=t?.profile?.lat&&(0!==t?.profile?.lat||0!==t?.profile?.long)||(t.attribute_list||[]).filter((t=>"map:bounds"===t.type)).length>0,conditionEdit:t=>"lat"in t||"mime"in t&&t.mime.startsWith("image")},children:{title:"Children",condition:t=>t.child_ref_list?.length>0,conditionEdit:t=>"child_ref_list"in t},sources:{title:"Sources",condition:t=>t?.backlinks?.source?.length>0&&"name"in t,conditionEdit:t=>!1},events:{title:"Events",condition:t=>t?.event_ref_list?.length>0,conditionEdit:t=>"event_ref_list"in t},placeEvents:{title:"Events",condition:t=>"placeref_list"in t&&t?.backlinks?.event?.length>0,conditionEdit:t=>!1},timeline:{title:"Timeline",condition:t=>t?.event_ref_list?.length>0,conditionEdit:()=>!1},participants:{title:"Participants",condition:t=>t?.profile?.participants?.people?.length||t?.profile?.participants?.families?.length,conditionEdit:t=>!1},gallery:{title:"Gallery",condition:t=>t?.media_list?.length>0,conditionEdit:t=>"media_list"in t},notes:{title:"Notes",condition:t=>t?.note_list?.length>0,conditionEdit:t=>"note_list"in t},sourceCitations:{title:"Sources",condition:t=>t?.citation_list?.length>0,conditionEdit:t=>"citation_list"in t},citations:{title:"Citations",condition:t=>t?.backlinks?.citation?.length>0&&"abbrev"in t,conditionEdit:t=>!1},attributes:{title:"Attributes",condition:t=>t?.attribute_list?.length>0,conditionEdit:t=>"attribute_list"in t},addresses:{title:"Addresses",condition:t=>t?.address_list?.length>0,conditionEdit:t=>!1},internet:{title:"Internet",condition:t=>t?.urls?.length>0,conditionEdit:t=>"urls"in t},associations:{title:"Associations",condition:t=>t?.person_ref_list?.length>0,conditionEdit:t=>"person_ref_list"in t},dna:{title:"DNA",condition:t=>(t?.person_ref_list||[]).filter((t=>"DNA"===t.rel)).length>0,conditionEdit:t=>!1},repositories:{title:"Repositories",condition:t=>t?.reporef_list?.length>0,conditionEdit:t=>"reporef_list"in t},references:{title:"References",condition:t=>Object.keys(t?.backlinks)?.length>0,conditionEdit:t=>!1}};class Gk extends(al(K)){static get styles(){return[nl,n`
        :host {
        }

        pre {
          max-width: 80%;
          font-size: 11px;
        }

        .tab-content {
          margin-top: 25px;
          padding-bottom: 3em;
        }

        #tabs {
          clear: both;
          margin-top: 30px;
        }

        mwc-tab-bar {
          border-bottom: solid #6d4c4133 1px;
          margin-top: 28px;
          margin-bottom: 36px;
          --mdc-tab-horizontal-padding: 16px;
        }

        #picture {
          margin-bottom: 20px;
          position: relative;
          text-align: center;
        }

        @media (min-width: 768px) {
          #picture {
            float: right;
            text-align: right;
            margin-left: 40px;
            margin-right: 0px;
          }
        }
      `]}static get properties(){return{data:{type:Object},edit:{type:Boolean},canEdit:{type:Boolean},dialogContent:{type:String},_objectsName:{type:String},_objectEndpoint:{type:String},_objectIcon:{type:String},_currentTabId:{type:Number},_currentTab:{type:String},_showReferences:{type:Boolean},_showPersonTimeline:{type:Boolean},_showFamilyTimeline:{type:Boolean}}}constructor(){super(),this.data={},this.edit=!1,this.canEdit=!1,this.dialogContent="",this._objectsName="Objects",this._objectIcon="",this._currentTabId=0,this._showReferences=!0,this._showPersonTimeline=!1,this._showFamilyTimeline=!1}render(){return 0===Object.keys(this.data).length?M``:M`
      ${this.renderHeader()}

      <div id="picture">${this.renderPicture()}</div>

      ${this.renderProfile()}

      <div style="clear:left;"></div>

      ${this.renderBeforeTags()} ${this.renderTags()}

      <div id="tabs">${this.renderTabs()}</div>

      <div class="tab-content">${this.renderTabContent()}</div>

      ${this.dialogContent}
    `}renderHeader(){return M`
      <grampsjs-breadcrumbs
        .data="${this.data}"
        .strings="${this.strings}"
        ?edit="${this.edit}"
        objectsName="${this._objectsName}"
        objectIcon="${this._objectIcon}"
        objectEndpoint="${this._objectEndpoint}"
      ></grampsjs-breadcrumbs>
    `}renderPicture(){if(!this.data?.media_list?.length)return M``;const t=this.data.media_list[0],e=this.data.extended.media[0];return M`
      <grampsjs-img
        handle="${e.handle}"
        size="200"
        displayHeight="200"
        .rect="${t.rect||[]}"
        square
        circle
        mime="${e.mime}"
        @click="${()=>this._handleImgClick(e.gramps_id)}"
        class="link"
      ></grampsjs-img>
    `}_handleImgClick(t){this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:`media/${t}`}}))}renderTabs(){const t=this._getTabs(this.edit);return t.includes(this._currentTab)||([this._currentTab]=t),0===t.length?M``:M`
      <mwc-tab-bar
        .activeIndex=${this._currentTabId}
        @MDCTabBar:activated=${this._handleTabActivated}
        @MDCTab:interacted=${this._handleTabInteracted}
        id="tab-bar"
      >
        ${t.map((t=>this._makeTab(t)))}
      </mwc-tab-bar>
    `}renderBeforeTags(){return""}renderTags(){return M` <grampsjs-tags
      .data=${this.data?.extended?.tags||[]}
      ?edit="${this.edit}"
      .strings="${this.strings}"
      @tag:new="${this._handleNewTag}"
    ></grampsjs-tags>`}renderTabContent(){const t=(this.data.attribute_list||[]).filter((t=>"map:bounds"===t.type));switch(this._currentTab){case"relationships":return M`<grampsjs-relationships
          grampsId="${this.data.gramps_id}"
          .strings=${this.strings}
          ?edit=${this.edit}
          .familyList=${this.data?.extended?.families||[]}
          .parentFamilyList=${this.data?.extended?.parent_families||[]}
          .families=${this.data?.profile?.families||[]}
          .primaryParentFamily=${this.data?.profile?.primary_parent_family||{}}
          .otherParentFamilies=${this.data?.profile?.other_parent_families||[]}
        ></grampsjs-relationships>`;case"names":return M`
          <grampsjs-names
            .strings="${this.strings}"
            .data="${[this.data.primary_name,...this.data.alternate_names]}"
            ?edit=${this.edit}
          ></grampsjs-names>
        `;case"enclosed":return M` ${this.data.placeref_list?.length||this.edit?M`
      <h4>${this._("Enclosed By")}</h3>
        <grampsjs-place-refs
          .strings="${this.strings}"
          .data="${this.data?.placeref_list}"
          ?edit="${this.edit}"
        ></grampsjs-place-refs>
        `:""}
        ${this.data?.backlinks?.place?.length?M`<h4>${this._("Encloses")}</h3>
        <grampsjs-place-children
          .strings="${this.strings}"
          .data="${this.data?.profile?.references?.place||[]}"
          ?edit="false"
        ></grampsjs-place-children>
        `:""}`;case"map":return M` ${this.edit?M`
              <p>
                <mwc-button
                  icon="edit"
                  class="edit"
                  @click="${this._handleEditGeo}"
                  >${this._("Edit coordinates")}</mwc-button
                >
              </p>
            `:""}
        ${this.data.lat&&this.data.long?M` <grampsjs-map
                latitude="${this.data.profile.lat}"
                longitude="${this.data.profile.long}"
                layerSwitcher
                mapid="place-map"
                id="map"
              >
                <grampsjs-map-marker
                  latitude="${this.data.profile.lat}"
                  longitude="${this.data.profile.long}"
                >
                </grampsjs-map-marker>
              </grampsjs-map>`:t.length>0?M` <grampsjs-map
                latitude="${(JSON.parse(t[0].value)[0][0]+JSON.parse(t[0].value)[1][0])/2}"
                longitude="${(JSON.parse(t[0].value)[0][1]+JSON.parse(t[0].value)[1][1])/2}"
                zoom="${this._getZoomFromBounds(JSON.parse(t[0].value))}"
                layerSwitcher
                mapid="media-map"
                id="map"
              >
                <grampsjs-map-overlay
                  url="${Vn(this.data.handle)}"
                  bounds="${t[0].value}"
                  title="${this.data.desc}"
                >
                </grampsjs-map-overlay>
              </grampsjs-map>`:""}`;case"events":return M`<grampsjs-events
          hasShare
          hasAdd
          hasEdit
          defaultRole=${"Families"===this._objectsName?"Family":"Primary"}
          .strings=${this.strings}
          .data=${this.data?.extended?.events}
          .profile=${this.data?.profile?.events}
          .eventRef=${this.data?.event_ref_list}
          ?edit="${this.edit}"
        ></grampsjs-events>`;case"placeEvents":return M`<grampsjs-events
          useSummary
          sorted
          .strings=${this.strings}
          .data=${this.data?.extended?.backlinks?.event}
          .profile=${this.data?.profile?.references?.event}
        ></grampsjs-events>`;case"timeline":return this._showPersonTimeline?M`<grampsjs-view-person-timeline
            active
            .strings=${this.strings}
            handle=${this.data.handle}
          ></grampsjs-view-person-timeline>`:"";case"sources":return M`<grampsjs-sources
          .strings=${this.strings}
          .data=${this.data?.extended?.backlinks?.source||[]}
        ></grampsjs-sources>`;case"citations":{let t=this.data?.profile?.references?.citation||[];return t.length>0&&(t=t.map(((t,e)=>({...t,media_list:this.data?.extended?.backlinks?.citation[e]?.media_list})))),M`<grampsjs-citations
          .strings=${this.strings}
          .data=${t}
        ></grampsjs-citations>`}case"children":return M`<grampsjs-children
          .strings=${this.strings}
          .data=${this.data?.child_ref_list}
          .profile=${this.data?.profile?.children}
          ?edit="${this.edit}"
        ></grampsjs-children>`;case"sourceCitations":return M`<grampsjs-view-source-citations
          active
          .strings=${this.strings}
          ?edit="${this.edit}"
          .grampsIds=${(this.data?.extended?.citations||[]).map((t=>t.gramps_id)).filter((t=>Boolean(t)))}
        ></grampsjs-view-source-citations>`;case"attributes":return M`<grampsjs-attributes
          hasEdit
          .strings=${this.strings}
          ?edit="${this.edit}"
          .data=${this.data.attribute_list}
          ?source="${"Sources"===this._objectsName}"
        ></grampsjs-attributes>`;case"addresses":return M`<grampsjs-addresses
          .strings=${this.strings}
          .data=${this.data.address_list}
        ></grampsjs-addresses>`;case"notes":return M` <grampsjs-view-object-notes
          active
          .strings=${this.strings}
          .grampsIds=${(this.data?.extended?.notes||[]).map((t=>t.gramps_id)).filter((t=>Boolean(t)))}
          ?edit="${this.edit}"
        ></grampsjs-view-object-notes>`;case"gallery":return M` <grampsjs-gallery
          .strings=${this.strings}
          .media=${this.data?.extended?.media}
          .mediaRef=${this.data?.media_list}
          ?edit="${this.edit}"
          ?editRect="${this.canEdit}"
        ></grampsjs-gallery>`;case"internet":return M`<grampsjs-urls
          hasEdit
          .strings=${this.strings}
          .data=${this.data.urls}
          ?edit="${this.edit}"
        ></grampsjs-urls>`;case"associations":return M`<grampsjs-associations
          hasEdit
          .strings=${this.strings}
          .data=${this.data?.person_ref_list||[]}
          .extended=${this.data?.extended?.people||[]}
          ?edit="${this.edit}"
        ></grampsjs-associations>`;case"dna":return M`<grampsjs-view-person-dna
          active
          .strings=${this.strings}
          handle="${this.data.handle||""}"
          .person="${this.data}"
        ></grampsjs-view-person-dna>`;case"participants":return M`<grampsjs-participants
          .strings=${this.strings}
          .data=${[this.data?.profile?.participants]}
        ></grampsjs-participants>`;case"repositories":return M` <grampsjs-repositories
          .strings=${this.strings}
          .data=${this.data?.reporef_list}
          .extended=${this.data?.extended?.repositories}
          ?edit=${this.edit}
        ></grampsjs-repositories>`;case"references":return M`<grampsjs-references
          .strings=${this.strings}
          .data=${[this.data?.extended?.backlinks]}
          .profile=${this.data?.profile?.references||{}}
        ></grampsjs-references>`}return M``}_getTabs(t){return t?Object.keys(Wk).filter((t=>Wk[t].conditionEdit(this.data))):Object.keys(Wk).filter((t=>Wk[t].condition(this.data)&&(this._showReferences||"references"!==t)&&(this._showFamilyTimeline||this._showPersonTimeline||"timeline"!==t)))}_makeTab(t){return M`
      <mwc-tab id="${t}" label="${this._(Wk[t].title)}"> </mwc-tab>
    `}updated(t){t.has("edit")&&this._updateTabIndicator(t.get("  "))}_updateTabIndicator(t){const e=this._getTabs(!t);e.includes(this._currentTab)&&e.indexOf(this._currentTab)!==this._currentTabId&&(this._currentTabId=e.indexOf(this._currentTab))}_handleTabActivated(t){this._currentTabId=t.detail.index}_handleTabInteracted(t){this._currentTab=t.detail.tabId}_handleCancelDialog(){this.dialogContent=""}_handleNewTag(){this.dialogContent=M`
      <grampsjs-form-new-tag
        .strings="${this.strings}"
        .data="${this.data.tag_list}"
        @object:save="${this._handleSaveTag}"
        @object:cancel="${this._handleCancelDialog}"
      >
      </grampsjs-form-new-tag>
    `}_handleSaveTag(t){os(this,"edit:action",{action:"updateProp",data:{tag_list:t.detail.data}}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleSaveType(t){os(this,"edit:action",{action:"updateProp",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_getZoomFromBounds(t){const e=t[0][0],i=t[0][1],r=t[1][0]-e,n=t[1][1]-i,a=Math.max(r,n);return Math.round(Math.log2(360/a))}}const Xk={0:"female",1:"male",2:"question_mark"},Kk={0:1,1:2,2:0};window.customElements.define("grampsjs-edit-gender",class extends K{static get styles(){return[nl]}static get properties(){return{gender:{type:Number},edit:{type:Boolean}}}constructor(){super(),this.gender=2,this.edit=!1}render(){return this.edit?M`
      <mwc-icon-button
        icon="${Xk[this.gender]}"
        @click="${this._handleClick}"
        class="edit"
      ></mwc-icon-button>
    `:""}_handleClick(){os(this,"edit:action",{action:"updateProp",data:{gender:Kk[this.gender]}})}});window.customElements.define("grampsjs-person-relationship",class extends fm{static get properties(){return{person1:{type:String},person2:{type:String}}}constructor(){super(),this.person1="",this.person2=""}getUrl(){return`/api/relations/${this.person1}/${this.person2}?locale=${this.strings?.__lang__||"en"}`}renderLoading(){return M`<span class="skeleton" style="width:7em;">&nbsp;</span>`}renderContent(){const t=this._data?.data?.relationship_string;return this.person1===this.person2?M`${this._("self")}`:void 0===t?M`&nbsp;`:""===t?M`${this._("Not Related")}`:M`${t}`}});window.customElements.define("grampsjs-person",class extends Gk{static get styles(){return[super.styles,n``]}static get properties(){return{homePersonDetails:{type:Object}}}constructor(){super(),this.homePersonDetails={},this._objectsName="People",this._objectEndpoint="people",this._objectIcon="person",this._showReferences=!1,this._showPersonTimeline=!0}renderProfile(){return M`
      <h2>
        <grampsjs-edit-gender
          ?edit="${this.edit}"
          gender="${this.data.gender}"
        ></grampsjs-edit-gender>
        ${this._displayName()}
      </h2>
      ${this._renderBirth()} ${this._renderDeath()} ${this._renderRelation()}
      ${this._renderTreeBtn()}
    `}_displayName(){if(!this.data.profile)return"";const t=this.data.profile.name_surname||M`&hellip;`,e=this.data.profile.name_suffix||"";let i=this.data.profile.name_given||M`&hellip;`;const r=this.data?.primary_name?.call,n=r?i.search(r):-1;return i=n>-1?M`
            ${i.substring(0,n)}
            <span class="given-name"
              >${i.substring(n,n+r.length)}</span
            >
            ${i.substring(n+r.length)}
          `:i,M`${i} ${t} ${e}`}_renderBirth(){const t=this.data?.profile?.birth;return void 0===t||0===Object.keys(t).length?"":M`
      <span class="event">
        <i>${za}</i>
        ${t.date||""} ${t.place?this._("in"):""} ${t.place||""}
      </span>
    `}_renderDeath(){const t=this.data?.profile?.death;return void 0===t||0===Object.keys(t).length?"":M`
    <span class="event">
    <i>${Da}</i>
    ${t.date||""}
      ${t.place?this._("in"):""}
      ${t.place||""}
    </event>
    `}_renderRelation(){return this.homePersonDetails.handle?M`
      <dl>
        <dt>${this._("Relationship to home person")}</dt>
        <dd>
          <grampsjs-person-relationship
            person1="${this.homePersonDetails.handle}"
            person2="${this.data.handle}"
            .strings="${this.strings}"
          ></grampsjs-person-relationship>
        </dd>
      </dl>
    `:""}_renderTreeBtn(){return M` <p>
      <mwc-button
        outlined
        label="${this._("Show in tree")}"
        @click="${this._handleButtonClick}"
      >
      </mwc-button>
    </p>`}_handleButtonClick(){this.dispatchEvent(new CustomEvent("pedigree:person-selected",{bubbles:!0,composed:!0,detail:{grampsId:this.data.gramps_id}})),this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:"tree"}}))}});window.customElements.define("grampsjs-view-person",class extends Ym{static get properties(){return{homePersonDetails:{type:Object}}}constructor(){super(),this.homePersonDetails={},this._className="person"}getUrl(){return`/api/people/?gramps_id=${this.grampsId}&locale=${this.strings?.__lang__||"en"}&profile=all&backlinks=true&extend=all`}renderElement(){return M`
      <grampsjs-person
        .data=${this._data}
        .strings=${this.strings}
        .homePersonDetails=${this.homePersonDetails}
        ?edit="${this.edit}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-person>
    `}});window.customElements.define("grampsjs-form-edit-family",class extends lh{static get properties(){return{father:{type:Object},mother:{type:Object},fatherProfile:{type:Object},motherProfile:{type:Object}}}constructor(){super(),this.father={},this.mother={},this.fatherProfile={},this.motherProfile={}}renderForm(){return M`
      <h4 class="label">${this._("Father")}</h4>

      <grampsjs-form-select-object-list
        id="father"
        objectType="person"
        label="${this._("Select a person as the father")}"
        .strings="${this.strings}"
        .objectsInitial="${this.data.father_handle?[{object_type:"person",object:{...this.father,profile:this.fatherProfile},handle:this.data.father_handle}]:[]}"
        class="edit"
      ></grampsjs-form-select-object-list>

      <h4 class="label">${this._("Mother")}</h4>

      <grampsjs-form-select-object-list
        id="mother"
        objectType="person"
        label="${this._("Select a person as the mother")}"
        .strings="${this.strings}"
        .objectsInitial="${this.data.mother_handle?[{object_type:"person",object:{...this.mother,profile:this.motherProfile},handle:this.data.mother_handle}]:[]}"
        class="edit"
      ></grampsjs-form-select-object-list>

      <grampsjs-form-select-type
        id="family-rel-type"
        heading="${this._("Relationship type:").replace(":","")}"
        .strings="${this.strings}"
        ?loadingTypes="${this.loadingTypes}"
        typeName="family_relation_types"
        defaultTypeName="Unknown"
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
        initialValue=${this.data?.type?.string||this.data?.type||""}
      >
      </grampsjs-form-select-type>
    `}});window.customElements.define("grampsjs-family",class extends Gk{static get styles(){return[super.styles,n`
        :host {
        }
      `]}constructor(){super(),this._showReferences=!1,this._objectsName="Families",this._objectEndpoint="families",this._objectIcon="people"}renderProfile(){return M`
      <h2>${this._renderTitle()}</h2>
      ${this._renderFather()} ${this._renderMother()}
      ${this.edit?M`
            <mwc-icon-button
              icon="edit"
              class="edit"
              @click="${this._handleEditFamily}"
            ></mwc-icon-button>
          `:""}
      <p>
        ${this._renderRelType()} ${this._renderMarriage()}
        ${this._renderDivorce()}
      </p>
    `}_renderTitle(){return M`
      ${this.data?.profile?.father?.name_given||""}
      ${this.data?.profile?.father?.name_surname||""} &amp;
      ${this.data?.profile?.mother?.name_given||""}
      ${this.data?.profile?.mother?.name_surname||""}
    `}_renderRelType(){return this.data?.type&&this.data?.profile?.relationship?M`
      <span class="event">
        ${this._("Relationship type:")} ${this.data.profile.relationship}
      </span>
    `:""}_renderFather(){return M` <p>${Qa(this.data?.profile?.father||{})}</p> `}_renderMother(){return M` <p>${Qa(this.data?.profile?.mother||{})}</p> `}_renderMarriage(){const t=this.data?.profile?.marriage;return t?.date||t?.place?M`
      <span class="event">
        <i>${ja}</i>
        ${t.date||""} ${t.place?this._("in"):""} ${t.place||""}
      </span>
    `:""}_renderDivorce(){const t=this.data?.profile?.divorce;return void 0===t||0===Object.keys(t).length?"":M`
      <span class="event">
        <i>oo</i>
        ${t.date||""} ${t.place?this._("in"):""} ${t.place||""}
      </span>
    `}_handleEditFamily(){const t={father_handle:this.data.father_handle,mother_handle:this.data.mother_handle,type:this.data?.type?.string||this.data.type},e=this.data?.extended?.father,i=this.data?.extended?.mother,r=this.data?.profile?.father,n=this.data?.profile?.mother;this.dialogContent=M`
      <grampsjs-form-edit-family
        @object:save="${this._handleSaveDetails}"
        @object:cancel="${this._handleCancelDialog}"
        .strings=${this.strings}
        .data=${t}
        .father=${e}
        .mother=${i}
        .fatherProfile=${r}
        .motherProfile=${n}
      >
      </grampsjs-form-edit-family>
    `}_handleSaveDetails(t){os(this,"edit:action",{action:"updateProp",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}});window.customElements.define("grampsjs-view-family",class extends Ym{constructor(){super(),this._className="family"}getUrl(){return`/api/families/?gramps_id=${this.grampsId}&locale=${this.strings?.__lang__||"en"}&profile=all&backlinks=true&extend=all`}renderElement(){return M`
      <grampsjs-family
        .data=${this._data}
        .strings=${this.strings}
        ?edit="${this.edit}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-family>
    `}});window.customElements.define("grampsjs-form-edit-lat-long",class extends lh{static get styles(){return[super.styles,n`
        mwc-dialog {
          --mdc-dialog-min-width: 80vw;
        }

        .search-results {
          clear: left;
          padding: 1em 0em;
        }

        .search-result {
          padding: 0.5em 0;
          border-bottom: 1px solid rgba(0, 0, 0, 0.1);
          border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .attribution {
          font-size: 0.8em;
          color: rgba(0, 0, 0, 0.4);
          text-align: right;
        }

        .attribution a:link,
        a:hover,
        a:visited {
          color: rgba(0, 0, 0, 0.4);
        }
      `]}static get properties(){return{searchRes:{type:Array},searchResLoading:{type:Boolean},showMore:{type:Boolean},_searchFieldValue:{type:String}}}constructor(){super(),this.searchRes=[],this.searchResLoading=!1,this.showMore=!1,this._searchFieldValue=""}renderForm(){return M`
      <div>
        <div style="width:calc(50% - 20px);margin-right:20px;float:left;">
          <grampsjs-form-string
            @formdata:changed="${this._handleFormData}"
            fullwidth
            id="lat"
            value="${this.data.lat||""}"
            label="${this._("Latitude")}"
            style="width:50%;"
          ></grampsjs-form-string>
        </div>
        <div style="width:50%;float:left;">
          <grampsjs-form-string
            fullwidth
            @formdata:changed="${this._handleFormData}"
            id="long"
            value="${this.data.long||""}"
            label="${this._("Longitude")}"
          ></grampsjs-form-string>
        </div>
      </div>
      <div style="clear:left; height: 20px;"></div>
      <div>
        <div style="width:calc(100% - 60px);float:left;">
          <grampsjs-form-string
            @formdata:changed="${this._handleSearchField}"
            @keydown="${this._handleSearchKey}"
            id="geocode"
            label="${this._("Search %s","OpenStreetMap")}"
            fullwidth
          ></grampsjs-form-string>
        </div>
        <div style="float:left;padding:5px;">
          <mwc-icon-button
            icon="search"
            @click="${this._executeSearch}"
          ></mwc-icon-button>
        </div>
      </div>
      ${this._renderSearchResults()}
      <p>
        <grampsjs-map
          latitude="${this.data.lat?parseFloat(this.data.lat):0}"
          longitude="${this.data.long?parseFloat(this.data.long):0}"
          layerSwitcher
          mapid="edit-latlong-map"
          id="map"
          @click="${this._handleMapClick}"
        >
          ${this.data.lat&&this.data.long?M`
                <grampsjs-map-marker
                  latitude="${parseFloat(this.data.lat)}"
                  longitude="${parseFloat(this.data.long)}"
                >
                </grampsjs-map-marker>
              `:""}
        </grampsjs-map>
      </p>
    `}_handleSearchField(t){this._searchFieldValue=t.detail.data}_handleSearchKey(t){"Enter"===t.code&&(this._executeSearch(),t.preventDefault(),t.stopPropagation())}async _executeSearch(){if(this._searchFieldValue){this.searchResLoading=!0;const t=await async function(t){const e=`https://nominatim.openstreetmap.org/search?q=${t}&format=jsonv2`;try{const t=await fetch(e,{headers:{"Content-Type":"application/json"}});if(200!==t.status)throw new Error(`Error ${t.statusText}`);return{data:await t.json()}}catch(t){return{error:t.message}}}(this._searchFieldValue);this.searchResLoading=!1,this.searchRes=t.data||[]}else this.searchRes=[]}reset(){this.shadowRoot.querySelectorAll("grampsjs-form-string").forEach((t=>t.reset()))}_renderSearchResults(){return this.searchResLoading?M` <div class="search-results">
        <mwc-circular-progress indeterminate density="-3" open>
        </mwc-circular-progress>
      </div>`:0===this.searchRes.length?M` <div class="search-results"></div> `:M` <div class="search-results">
      ${this.searchRes.slice(0,this.showMore?this.searchRes.length:3).map((t=>M`
          <div class="search-result">
            <span class="link" @click=${()=>this._handleResClick(t)}
              >${t.display_name}</span
            >
          </div>
        `))}
      ${this.showMore||this.searchRes.length<=3?"":M`
      <mwc-icon-button
        @click="${this._handleShowMore}"
        icon="more_horiz"
      ></mwc-button>
    `}
      <div class="attribution">
        <a href="https://nominatim.openstreetmap.org/"
          >OpenStreetMap Nominatim</a
        >
      </div>
    </div>`}_handleShowMore(){this.showMore=!0}_handleResClick(t){this._setLatLong(t.lat,t.lon)}_handleMapClick(t){const e=this.shadowRoot.querySelector("grampsjs-map");if(null!==e){const i=e._map.mouseEventToLatLng(t);this._setLatLong(i.lat,i.lng)}}_setLatLong(t,e){this.data={lat:`${t}`,long:`${e}`};const i=this.shadowRoot.querySelector("grampsjs-map");null!==i&&(i.zoom=i._map.getZoom(),i.latitude=t,i.longitude=e)}});window.customElements.define("grampsjs-form-edit-placename",class extends lh{renderForm(){return M`
      <grampsjs-form-string
        @formdata:changed="${this._handleFormData}"
        fullwidth
        id="place-name-value"
        label="${this._("Name")}"
        value="${this.data.value||""}"
      >
      </grampsjs-form-string>
    `}});window.customElements.define("grampsjs-place",class extends Gk{static get styles(){return[super.styles,n`
        :host {
        }

        #btn-edit-type {
          vertical-align: middle;
        }
      `]}constructor(){super(),this._showReferences=!1,this._objectsName="Places",this._objectEndpoint="places",this._objectIcon="place"}renderProfile(){return M`
      <h2>
        ${this.data?.name?.value||this.data.title||this._("Place")}
        ${this.edit?M`
              <mwc-icon-button
                icon="edit"
                class="edit"
                @click="${this._handleEditName}"
              ></mwc-icon-button>
            `:""}
      </h2>

      ${this.data?.profile?.type||this.edit?M`<p>
            ${this.data?.profile?.type||this._("Unknown")}
            ${this.edit?M`
                  <mwc-icon-button
                    id="btn-edit-type"
                    icon="edit"
                    class="edit"
                    @click="${this._handleEditType}"
                  ></mwc-icon-button>
                `:""}
          </p>`:""}
      ${this.data?.profile?.parent_places.length>0?M`
            <dl>
              ${this.data.profile.parent_places.map((t=>M`
                  <div>
                    <dt>${t.type}</dt>
                    <dd>
                      <a href="${""}/place/${t.gramps_id}"
                        >${t.name}</a
                      >
                    </dd>
                  </div>
                `))}
            </dl>
          `:""}
    `}_handleEditGeo(){let t={};this.data.profile.lat&&this.data.profile.long&&(t={lat:this.data.profile.lat,long:this.data.profile.long}),this.dialogContent=M`
      <grampsjs-form-edit-lat-long
        @object:save="${this._handleSaveLatLong}"
        @object:cancel="${this._handleCancelDialog}"
        .strings="${this.strings}"
        .data="${t}"
      ></grampsjs-form-edit-lat-long>
    `}_handleEditName(){this.dialogContent=M`
      <grampsjs-form-edit-placename
        @object:save="${this._handleSaveName}"
        @object:cancel="${this._handleCancelDialog}"
        .strings=${this.strings}
        .data=${this.data?.name||{}}
        prop="value"
      >
      </grampsjs-form-edit-placename>
    `}_handleEditType(){this.dialogContent=M`
      <grampsjs-form-edit-type
        dialogTitle="${this._("Edit place type")}"
        formId="place-type"
        typeName="place_types"
        @object:save="${this._handleSaveType}"
        @object:cancel="${this._handleCancelDialog}"
        .strings=${this.strings}
        .data=${{type:this.data?.place_type?.string||this.data?.place_type||""}}
        prop="value"
      >
      </grampsjs-form-edit-type>
    `}_handleSaveName(t){os(this,"edit:action",{action:"updateProp",data:{name:t.detail.data}}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleSaveLatLong(t){os(this,"edit:action",{action:"updateProp",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}});window.customElements.define("grampsjs-view-place",class extends Ym{constructor(){super(),this._className="place"}getUrl(){return`/api/places/?gramps_id=${this.grampsId}&backlinks=true&extend=all&locale=${this.strings?.__lang__||"en"}&profile=all`}renderElement(){return M`
      <grampsjs-place
        .data=${this._data}
        .strings=${this.strings}
        ?edit="${this.edit}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-place>
    `}});window.customElements.define("grampsjs-form-edit-event-details",class extends lh{static get properties(){return{place:{type:Object}}}constructor(){super(),this.place={}}renderForm(){return M`
      <h4 class="label">${this._("Date")}</h4>
      <p>
        <grampsjs-form-select-date
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="date"
          label="${this._("Date")}"
          .data="${this.data.date}"
          .strings="${this.strings}"
        >
        </grampsjs-form-select-date>
      </p>
      <h4 class="label">${this._("Place")}</h4>
      <p>
        <grampsjs-form-select-object-list
          fixedMenuPosition
          style="min-height: 300px;"
          objectType="place"
          .strings="${this.strings}"
          id="place"
          label="${this._("Select")}"
          .objectsInitial="${this.data.place?[{object_type:"place",object:this.place,handle:this.data.place}]:[]}"
          class="edit"
        ></grampsjs-form-select-object-list>
      </p>
    `}get isValid(){return this._areDateSelectValid()}});window.customElements.define("grampsjs-form-edit-title",class extends lh{static get properties(){return{prop:{type:String}}}constructor(){super(),this.prop="title"}renderForm(){return M`
      <grampsjs-form-string
        @formdata:changed="${this._handleFormData}"
        fullwidth
        id="${this.prop}"
        label="${this._("Title")}"
        value="${this.data[this.prop]||""}"
      >
      </grampsjs-form-string>
    `}});window.customElements.define("grampsjs-event",class extends Gk{static get styles(){return[super.styles,n`
        :host {
        }
      `]}constructor(){super(),this._objectsName="Events",this._objectIcon="event",this._objectEndpoint="events",this._showReferences=!1}renderProfile(){return M`
      <h2>
        ${this._renderTitle()}
        ${this.edit?M`
              <mwc-icon-button
                id="btn-edit-type"
                icon="edit"
                class="edit"
                @click="${this._handleEditType}"
              ></mwc-icon-button>
              <grampsjs-tooltip for="btn-edit-type"
                >${this._("Edit event type")}</grampsjs-tooltip
              >
            `:""}
      </h2>
      ${this.data.description||this.edit?M` <dl>
            <div>
              <dt>${this._("Description")}</dt>
              <dd>${this.data.description}</dd>
            </div>
          </dl>`:""}
      ${this.edit?M`
            <mwc-icon-button
              icon="edit"
              class="edit"
              @click="${this._handleEditDesc}"
            ></mwc-icon-button>
          `:""}

      <dl style="clear:left;">
        ${this.data?.profile?.date||this.edit?M`
              <div>
                <dt>${this._("Date")}</dt>
                <dd>${this.data.profile.date}</dd>
              </div>
            `:""}
        ${this.data?.profile?.place||this.edit?M`
              <div>
                <dt>${this._("Place")}</dt>
                <dd>
                  <a
                    href="${""}/place/${this.data.extended.place.gramps_id}"
                    >${this.data.profile.place}</a
                  >
                </dd>
              </div>
            `:""}
      </dl>
      ${this.edit?M`
            <mwc-icon-button
              icon="edit"
              class="edit"
              @click="${this._handleEditDetails}"
            ></mwc-icon-button>
          `:""}
    `}_renderPerson(t){return void 0===t?"":`${t?.name_given||""} ${t?.name_surname||""}`}_renderFamily(t){return void 0===t?"":`${this._renderPerson(t.family?.father)} & ${this._renderPerson(t.family?.mother)}`}_renderPrimaryPeople(){const t=this._("Primary"),e=this._("Family"),i=this.data?.profile?.participants?.people.filter((e=>e.role===t||"Primary"===e.role))||[],r=this.data?.profile?.participants?.families.filter((t=>t.role===e||"Family"===t.role))||[];return`${i.map((t=>this._renderPerson(t.person)),this).join(", ")}\n            ${r.map((t=>this._renderFamily(t)),this).join(", ")}`}_renderTitle(){return M`${this.data.profile.type}: ${this._renderPrimaryPeople()}`}_handleEditDetails(){const t={date:this.data.date};this.data.place&&(t.place=this.data.place);const e=this.data?.extended?.place;this.dialogContent=M`
      <grampsjs-form-edit-event-details
        @object:save="${this._handleSaveDetails}"
        @object:cancel="${this._handleCancelDialog}"
        .strings=${this.strings}
        .data=${t}
        .place=${e}
      >
      </grampsjs-form-edit-event-details>
    `}_handleSaveDetails(t){os(this,"edit:action",{action:"updateProp",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleEditDesc(){this.dialogContent=M`
      <grampsjs-form-edit-title
        @object:save="${this._handleSaveDesc}"
        @object:cancel="${this._handleCancelDialog}"
        .strings=${this.strings}
        .data=${{description:this.data?.description||""}}
        prop="description"
      >
      </grampsjs-form-edit-title>
    `}_handleSaveDesc(t){os(this,"edit:action",{action:"updateProp",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleEditType(){this.dialogContent=M`
      <grampsjs-form-edit-type
        dialogTitle="${this._("Edit event type")}"
        formId="event-type"
        typeName="event_types"
        @object:save="${this._handleSaveType}"
        @object:cancel="${this._handleCancelDialog}"
        .strings=${this.strings}
        .data=${{type:this.data?.type?.string||this.data?.type||""}}
        prop="value"
      >
      </grampsjs-form-edit-type>
    `}});window.customElements.define("grampsjs-view-event",class extends Ym{constructor(){super(),this._className="event"}getUrl(){return`/api/events/?gramps_id=${this.grampsId}&locale=${this.strings?.__lang__||"en"}&profile=all&backlinks=true&extend=all`}renderElement(){return M`
      <grampsjs-event
        .data=${this._data}
        .strings=${this.strings}
        ?edit="${this.edit}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-event>
    `}});window.customElements.define("grampsjs-source",class extends Gk{static get styles(){return[super.styles,n`
        :host {
        }
      `]}constructor(){super(),this._showReferences=!1,this._objectsName="Sources",this._objectEndpoint="sources",this._objectIcon="bookmarks"}renderProfile(){return M`
      <h2>
        ${this.data.title||this._("Media Object")}
        ${this.edit?M`
              <mwc-icon-button
                icon="edit"
                class="edit"
                @click="${this._handleEditTitle}"
              ></mwc-icon-button>
            `:""}
      </h2>

      <dl>
        ${this.data?.abbrev?M`
              <div>
                <dt>${this._("Abbreviation")}</dt>
                <dd>${this.data.abbrev}</dd>
              </div>
            `:""}
        ${this.data?.author?M`
              <div>
                <dt>${this._("Author")}</dt>
                <dd>${this.data.author}</dd>
              </div>
            `:""}
        ${this.data?.pubinfo?M`
              <div>
                <dt>${this._("Publication info")}</dt>
                <dd>${this.data.pubinfo}</dd>
              </div>
            `:""}
      </dl>
      ${this._renderBlogBtn()}
    `}renderPicture(){return""}_renderBlogBtn(){return!(this.data?.extended?.tags||[]).filter((t=>"Blog"===t.name)).length>0?"":M` <p style="clear: both; margin-top: 1em;">
      <mwc-button
        outlined
        label="${this._("Show in blog")}"
        @click="${this._handleButtonClick}"
      >
      </mwc-button>
    </p>`}_handleButtonClick(){os(this,"nav",{path:`blog/${this.data.gramps_id}`})}_handleEditTitle(){this.dialogContent=M`
      <grampsjs-form-edit-title
        @object:save="${this._handleSaveTitle}"
        @object:cancel="${this._handleCancelDialog}"
        .strings=${this.strings}
        .data=${{title:this.data?.title||""}}
        prop="title"
      >
      </grampsjs-form-edit-title>
    `}_handleSaveTitle(t){os(this,"edit:action",{action:"updateProp",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}});class Jk extends Ym{constructor(){super(),this._className="source"}getUrl(){return`/api/sources/?gramps_id=${this.grampsId}&locale=${this.strings?.__lang__||"en"}&profile=all&backlinks=true&extend=all`}renderElement(){return M`
      <grampsjs-source
        .data=${this._data}
        .strings=${this.strings}
        ?edit="${this.edit}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-source>
    `}}window.customElements.define("grampsjs-view-source",Jk);window.customElements.define("grampsjs-connected-note",class extends fm{static get properties(){return{handle:{type:String}}}constructor(){super(),this.handle=""}getUrl(){if(!this.handle)return"";const t={link_format:"/{obj_class}/{gramps_id}"};return`/api/notes/${this.handle}?locale=${this.strings?.__lang__||"en"}&profile=all&extend=all&formats=html&format_options=${encodeURIComponent(JSON.stringify(t))}`}renderContent(){return M`
      <grampsjs-note-content
        framed
        .strings="${this.strings}"
        grampsId="${this._data.data.gramps_id}"
        content="${this._data?.data?.formatted?.html||this._data?.data?.text?.string}"
      ></grampsjs-note-content>
    `}renderLoading(){return M` <grampsjs-note-content
      framed
      content="${'<p><span class="skeleton" style="width:100%;">&nbsp;</span></p>'}"
    ></grampsjs-note-content>`}update(t){super.update(t),t.has("handle")&&this._updateData()}});class Qk extends(al(K)){static get styles(){return[nl,n`
        #btn-details {
          margin-top: 2em;
        }

        h2#title {
          display: block;
          border-radius: 5px;
          padding: 5px 10px;
          margin-left: -10px;
        }

        h2.editable:hover,
        mwc-select:hover {
          background-color: rgba(2, 119, 189, 0.2);
        }

        .dropdowns {
          margin-top: 48px;
          --mdc-select-outlined-disabled-border-color: rgba(0, 0, 0, 0.38);
          --mdc-select-disabled-ink-color: rgba(0, 0, 0, 0.87);
          --mdc-select-disabled-dropdown-icon-color: #fff;
        }

        .dropdowns mwc-select {
          margin-right: 12px;
          margin-bottom: 18px;
        }

        h3 {
          margin-top: 2em;
        }

        .controls {
          margin: 0.7em 0;
        }

        .muted {
          opacity: 0.4;
        }
      `]}static get properties(){return{source:{type:Object},note:{type:Object},canEdit:{type:Boolean},dialogContent:{type:String},_editingNote:{type:Boolean},_editingGallery:{type:Boolean}}}constructor(){super(),this.source={},this.note={},this.canEdit=!1,this.dialogContent="",this._editingNote=!1,this._editingGallery=!1}render(){return 0===Object.keys(this.source).length?M``:M`
      <grampsjs-breadcrumbs
        .data="${this.source}"
        .strings="${this.strings}"
        objectsName="Tasks"
        objectIcon="checklist"
        hideBookmark
        hideLock
      ></grampsjs-breadcrumbs>
      <h2
        id="title"
        class="${Ot({editable:this.canEdit})}"
        contenteditable="${this.canEdit}"
        @input="${as((()=>this._handleEditTitle()),500)}"
        .innerText="${Ai(this.source.title)}"
      >
        &nbsp;
      </h2>

      <p class="dropdowns">
        <mwc-select
          outlined
          ?disabled="${!this.canEdit}"
          label="${this._("Status")}"
          id="select-status"
          @change="${this._handleStatusChange}"
        >
          ${["Open","In Progress","Blocked","Done"].map((t=>M`
              <mwc-list-item
                value="${t}"
                ?selected="${this._status===t}"
                >${this._(t)}</mwc-list-item
              >
            `))}
        </mwc-select>
        <mwc-select
          outlined
          ?disabled="${!this.canEdit}"
          label="${this._("Priority")}"
          id="select-priority"
          @change="${this._handlePrioChange}"
        >
          <mwc-list-item value="1" ?selected="${this._priority<5}"
            >${this._("High")}</mwc-list-item
          >
          <mwc-list-item value="5" ?selected="${"5"===this._priority}"
            >${this._("Medium")}</mwc-list-item
          >
          <mwc-list-item value="9" ?selected="${this._priority>5}"
            >${this._("Low")}</mwc-list-item
          >
        </mwc-select>
      </p>

      <h3>${this._("Description")}</h3>
      <p>
        ${this.source?.note_list?.length>0?M` ${this._editingNote?M`
                  <grampsjs-editor
                    .data=${this.source.extended.notes[0].text}
                    .strings=${this.strings}
                  ></grampsjs-editor>
                `:M`
                  <grampsjs-connected-note handle="${this.source.note_list[0]}">
                  </grampsjs-connected-note>
                `}`:M`${this._editingNote?M`<grampsjs-editor
                  .strings=${this.strings}
                ></grampsjs-editor>`:M`<span class="muted">${this._("None")}</span>`}`}
        ${this.canEdit?M`
              <div class="controls">
                ${this._editingNote?M`
                      <mwc-icon-button
                        class="edit"
                        id="btn-save-note"
                        icon="save"
                        @click="${this._handleSaveNote}"
                      ></mwc-icon-button>
                      <grampsjs-tooltip for="btn-save-note"
                        >${this._("_Save")}</grampsjs-tooltip
                      >
                      <mwc-icon-button
                        class="edit"
                        id="btn-cancel-note"
                        icon="clear"
                        @click="${this._handleCancelNote}"
                      ></mwc-icon-button>
                      <grampsjs-tooltip for="btn-cancel-note"
                        >${this._("Cancel")}</grampsjs-tooltip
                      >
                    `:M`
                      <mwc-icon-button
                        id="btn-edit-note"
                        class="edit"
                        icon="edit"
                        @click="${this._handleEditNote}"
                      ></mwc-icon-button>
                      <grampsjs-tooltip for="btn-edit-note"
                        >${this._("Edit Note")}</grampsjs-tooltip
                      >
                    `}
              </div>
            `:""}
      </p>
      <h3>${this._("Attachments")}</h3>
      ${0!==this.source?.media_list?.length||this._editingGallery?M`
            <grampsjs-gallery
              ?edit="${this._editingGallery}"
              .strings=${this.strings}
              .media=${this.source?.extended?.media}
              .mediaRef=${this.source?.media_list}
            ></grampsjs-gallery>
          `:M`<p><span class="muted">${this._("None")}</span></p>`}
      ${this.canEdit?M`
            <div class="controls">
              <mwc-icon-button
                id="btn-edit-gallery"
                class="edit"
                @click="${this._handleEditGallery}"
              >
                ${this._editingGallery?Ha("M18.66,2C18.4,2 18.16,2.09 17.97,2.28L16.13,4.13L19.88,7.88L21.72,6.03C22.11,5.64 22.11,5 21.72,4.63L19.38,2.28C19.18,2.09 18.91,2 18.66,2M3.28,4L2,5.28L8.5,11.75L4,16.25V20H7.75L12.25,15.5L18.72,22L20,20.72L13.5,14.25L9.75,10.5L3.28,4M15.06,5.19L11.03,9.22L14.78,12.97L18.81,8.94L15.06,5.19Z","var(--mdc-theme-secondary)"):Ha(Ra,"var(--mdc-theme-secondary)")}
              </mwc-icon-button>
              <grampsjs-tooltip for="btn-edit-gallery"
                >${this._("Edit")}</grampsjs-tooltip
              >
            </div>
          `:""}

      <h3>${this._("Tags")}</h3>
      <grampsjs-tags
        .data="${this.source?.extended?.tags}"
        .hideTags="${["ToDo"]}"
        ?edit="${this.canEdit}"
        .strings="${this.strings}"
        @tag:new="${this._handleNewTag}"
      ></grampsjs-tags>

      ${this.dialogContent}
    `}get _status(){return this.source.attribute_list.filter((t=>"Status"===t.type))[0]?.value}get _priority(){return this.source.attribute_list.filter((t=>"Priority"===t.type))[0]?.value}_handleEditGallery(){this._editingGallery=!this._editingGallery}_handleEditNote(){this._editingNote=!0}_handleSaveNote(){const t=this.renderRoot.querySelector("grampsjs-editor").data,e={_class:"NoteType",string:"To Do"};if(this.source.note_list.length>0){os(this,"task:update-note-text",{...this.source.extended.notes[0],text:t,type:e})}else{const i={text:t,type:e};""!==t.string.trim()&&os(this,"task:add-note-text",i)}this._editingNote=!1}_handleCancelNote(){this._editingNote=!1}_handleStatusChange(t){if(`${t.target.value}`===this._status)return;const e={type:"Status",value:`${t.target.value}`};if(void 0===this._status)os(this,"edit:action",{action:"addAttribute",data:e});else{os(this,"edit:action",{action:"updateAttribute",data:e,index:this.source.attribute_list.findIndex((t=>"Status"===t.type))})}}_handlePrioChange(t){if(`${t.target.value}`===this._priority)return;const e={type:"Priority",value:`${t.target.value}`};if(void 0===this._priority)os(this,"edit:action",{action:"addAttribute",data:e});else{os(this,"edit:action",{action:"updateAttribute",data:e,index:this.source.attribute_list.findIndex((t=>"Priority"===t.type))})}}_handleEditTitle(){const t=this.renderRoot.getElementById("title"),e=t.textContent.replace(/(\r\n|\n|\r)/gm,"").trim();t.blur(),os(this,"edit:action",{action:"updateProp",data:{title:e}})}_clickDetails(t){os(this,"nav",{path:`source/${t}`})}_handleCancelDialog(){this.dialogContent=""}_handleNewTag(){this.dialogContent=M`
      <grampsjs-form-new-tag
        .strings="${this.strings}"
        .data="${this.source.tag_list}"
        @object:save="${this._handleSaveTag}"
        @object:cancel="${this._handleCancelDialog}"
      >
      </grampsjs-form-new-tag>
    `}_handleSaveTag(t){os(this,"edit:action",{action:"updateProp",data:{tag_list:t.detail.data}}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}}window.customElements.define("grampsjs-task",Qk);window.customElements.define("grampsjs-view-task",class extends Jk{constructor(){super(),this._className="source"}renderElement(){return M`
      <grampsjs-task
        @task:update-note-text="${this._handleUpdateNoteText}"
        @task:add-note-text="${this._handleAddNoteText}"
        .source="${this._data}"
        .strings="${this.strings}"
        ?edit="${this.edit}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-task>
    `}async _handleUpdateNoteText(t){const e=t.detail;await Fn(`/api/notes/${e.handle}`,e),this._updateData(!1)}async _handleAddNoteText(t){const e=t.detail,i=await Nn("/api/notes/",e);if("data"in i){const[t]=i.data;this.addHandle(t.handle,this._data,this._className,"note_list")}this._updateData(!1)}renderFab(){return""}});class tT extends Oi{constructor(){super(...arguments),this.left=!1,this.graphic="control"}render(){const t={"mdc-deprecated-list-item__graphic":this.left,"mdc-deprecated-list-item__meta":!this.left},e=this.renderText(),i=this.graphic&&"control"!==this.graphic&&!this.left?this.renderGraphic():M``,r=this.hasMeta&&this.left?this.renderMeta():M``,n=this.renderRipple();return M`
      ${n}
      ${i}
      ${this.left?"":e}
      <span class=${Ot(t)}>
        <mwc-checkbox
            reducedTouchTarget
            tabindex=${this.tabindex}
            .checked=${this.selected}
            ?disabled=${this.disabled}
            @change=${this.onChange}>
        </mwc-checkbox>
      </span>
      ${this.left?e:""}
      ${r}`}async onChange(t){const e=t.target;this.selected===e.checked||(this._skipPropRequest=!0,this.selected=e.checked,await this.updateComplete,this._skipPropRequest=!1)}}it([ht("slot")],tT.prototype,"slotElement",void 0),it([ht("mwc-checkbox")],tT.prototype,"checkboxElement",void 0),it([ot({type:Boolean})],tT.prototype,"left",void 0),it([ot({type:String,reflect:!0})],tT.prototype,"graphic",void 0);const eT=n`:host(:not([twoline])){height:56px}:host(:not([left])) .mdc-deprecated-list-item__meta{height:40px;width:40px}`;let iT=class extends tT{};iT.styles=[Bi,eT],iT=it([at("mwc-check-list-item")],iT);class rT extends(al(K)){static get styles(){return[nl,n`
        .chip {
          font-size: 11px;
          font-weight: 500;
          font-family: var(--grampsjs-body-font-family);
          padding: 0px 12px;
          border-radius: 6px;
          margin: 0 3px;
          height: 24px;
          display: inline-block;
        }

        .chip mwc-icon-button {
          --mdc-icon-size: 14px;
          --mdc-icon-button-size: 18px;
        }
      `]}static get properties(){return{data:{type:Array}}}constructor(){super(),this.data=[]}render(){return 0===Object.keys(this.data).length?M``:M`
      ${this.data.map((t=>{let e=t.color?.length>7?Ua(t.color,.8):Ya(t.color,.8);return e=e||"rgba(0, 0, 0, 0.6)",M`<span
          class="chip"
          style="background-color:${e};color:white;"
          >${t.name}</span
        >`}))}
    `}_handleList(){return this.data.map((t=>t.handle))}}window.customElements.define("grampsjs-tags-small",rT);class nT extends(al(K)){static get styles(){return[nl,n`
        mwc-list {
          --mdc-typography-subtitle1-font-size: 15px;
          margin-bottom: 85px;
        }

        mwc-check-list-item {
          border-top: 1px solid rgba(0, 0, 0, 0.1);
          height: auto;
          width: 100%;
        }

        mwc-check-list-item:last-child {
          border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        h4 {
          font-family: var(--grampsjs-body-font-family);
          font-size: 14px;
          font-weight: 450;
          color: rgba(0, 0, 0, 0.7);
          text-transform: uppercase;
        }

        span.link {
          color: var(--mdc-theme-text-primary-on-background);
          padding: 0;
        }

        span.link:hover {
          color: #1976d2;
          text-decoration: none;
        }

        .item-content {
          padding: 14px 6px;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .status-icon {
          width: 32px;
        }

        .title {
          white-space: normal;
          overflow-wrap: break-word;
          height: 100%;
          width: 100%;
          background-color: rgba(0, 0, 0, 255, 0.1) !important;
          padding-right: 8px;
          flex: auto;
          word-wrap: break-word;
          hyphens: auto;
        }

        .tags {
          flex: auto;
          white-space: normal;
          overflow-wrap: break-word;
          word-wrap: break-word;
        }

        mwc-checkbox#select-all {
          margin-right: 8px;
        }

        .filters {
          margin-bottom: 32px;
        }

        .taskbar {
          padding-left: 10px;
          display: flex;
          align-items: center;
          margin-bottom: 8px;
        }

        mwc-check-list-item mwc-icon {
          color: rgba(0, 0, 0, 0.3);
          --mdc-icon-size: 20px;
        }

        .status-icon mwc-icon {
          margin-right: 12px;
          position: relative;
          top: 3px;
        }

        .success {
          color: #41ad49;
        }

        .done {
          color: rgba(65, 173, 73, 0.4);
        }

        .progress {
          color: #ff9800;
        }

        .open {
          color: #007bff;
        }

        .error,
        .blocked {
          color: #bf360c;
        }

        .warn {
          color: #f9a825;
        }

        .strike {
          text-decoration: line-through !important;
        }

        .taskbar mwc-button {
          margin-right: 8px;
        }

        .prio-icon mwc-icon {
          padding-left: 8px;
          position: relative;
          top: 2px;
        }

        grampsjs-tags-small {
          margin-left: 1em;
        }
      `]}static get properties(){return{data:{type:Array},_selected:{type:Array},canEdit:{type:Boolean}}}constructor(){super(),this.data=[],this._selected=[],this.canEdit=!1}render(){return M`
      ${this._renderFilters()} ${this.canEdit?this._renderTaskBar():""}
      ${this._renderTaskList(this.data)}
    `}_renderFilters(){return M`
      <div class="filters">
        <grampsjs-filters .strings="${this.strings}" objectType="sources">
          <grampsjs-filter-tags
            .strings="${this.strings}"
          ></grampsjs-filter-tags>
        </grampsjs-filters>
      </div>
    `}_renderTaskBar(){return M`
      <div class="taskbar">
        <mwc-checkbox
          id="select-all"
          @change="${this._handleSelectAll}"
          ?checked=${this._selected.length>0}
        ></mwc-checkbox>
        <div style="position: relative; display: inline-block;">
          <mwc-button
            id="prio-btn"
            outlined
            class="edit"
            ?disabled="${0===this._selected.length}"
            @click="${this._handleSetPrioClick}"
            >${this._("Set Priority")}</mwc-button
          >
          <mwc-menu
            @action="${this._handlePrioSet}"
            id="prio-menu"
            .anchor=${this.prioBtn}
            x="0"
            y="40"
          >
            <mwc-list-item>${this._("High")}</mwc-list-item>
            <mwc-list-item>${this._("Medium")}</mwc-list-item>
            <mwc-list-item>${this._("Low")}</mwc-list-item>
          </mwc-menu>
        </div>
        <div style="position: relative; display: inline-block;">
          <mwc-button
            id="prio-btn"
            outlined
            class="edit"
            ?disabled="${0===this._selected.length}"
            @click="${this._handleSetStatusClick}"
            >${this._("Set Status")}</mwc-button
          >
          <mwc-menu
            @action="${this._handleStatusSet}"
            id="status-menu"
            .anchor=${this.statusBtn}
            x="0"
            y="40"
          >
            <mwc-list-item>${this._("Open")}</mwc-list-item>
            <mwc-list-item>${this._("In Progress")}</mwc-list-item>
            <mwc-list-item>${this._("Blocked")}</mwc-list-item>
            <mwc-list-item>${this._("Done")}</mwc-list-item>
          </mwc-menu>
        </div>
      </div>
    `}get prioBtn(){return this.renderRoot.getElementById("prio-btn")}get statusBtn(){return this.renderRoot.getElementById("status-btn")}_handlePrioSet(t){this.renderRoot.getElementById("prio-menu").select(null);const e={0:"1",1:"5",2:"9"}[t.detail.index];e&&this._updateAttributes(this._selected,"Priority",e),this._selected=[]}_handleSetPrioClick(){this.renderRoot.getElementById("prio-menu").open=!0}_handleStatusSet(t){this.renderRoot.getElementById("prio-menu").select(null);const e={0:"Open",1:"In Progress",2:"Blocked",3:"Done"}[t.detail.index];e&&this._updateAttributes(this._selected,"Status",e),this._selected=[]}_handleSetStatusClick(){this.renderRoot.getElementById("status-menu").open=!0}_renderTaskList(t){return M` <mwc-list multi @action="${this._handleAction}" id="all-tasks">
      ${t.map(((t,e)=>this._renderTask(t,e)))}
    </mwc-list>`}_handleAction(t){this._selected=[...t.target.index]}_handleSelectAll(){0===this._selected.length?this._selected=[...Array(this.data.length).keys()]:this._selected=[]}_statusIcon(t,e){const i=`status-icon-${e}`,r={Open:M`<mwc-icon class="open" id="${i}"
        >radio_button_unchecked</mwc-icon
      >`,"In Progress":M`<mwc-icon class="progress" id="${i}"
        >timelapse</mwc-icon
      >`,Blocked:M`<mwc-icon class="blocked" id="${i}"
        >remove_circle</mwc-icon
      >`,Done:M`<mwc-icon class="done" id="${i}">check_circle</mwc-icon>`,unknown:M`<mwc-icon class="" id="${i}">help</mwc-icon>`};return M`
      ${r[t]||r.unknown}
      <grampsjs-tooltip for="${i}" .strings="${this.strings}"
        >${this._(t)}</grampsjs-tooltip
      >
    `}_priorityIcon(t,e){const i=`priority-icon-${e}`;let r="";if(t>5)r="Low";else if("5"===t)r="Medium";else{if(!(t<5))return"";r="High"}const n={Low:M`<mwc-icon class="success" id="${i}"
        >keyboard_double_arrow_down</mwc-icon
      >`,Medium:M`<mwc-icon id="${i}">adjust</mwc-icon>`,High:M`<mwc-icon class="error" id="${i}"
        >keyboard_double_arrow_up</mwc-icon
      >`};return M`
      <span class="priority-label">
        ${n[r]}
        <grampsjs-tooltip for="${i}" .strings="${this.strings}"
          >${this._("Priority")}: ${this._(r)}</grampsjs-tooltip
        >
      </span>
    `}_getAttribute(t,e){return t.attribute_list.filter((t=>t.type===e))[0]?.value}_renderTask(t,e){const i=this._getAttribute(t,"Status"),r=this._getAttribute(t,"Priority");return M`
      <mwc-check-list-item
        left
        hasMeta
        graphic=""
        ?selected="${this._selected.includes(e)}"
        @keydown="${e=>this._handleListKeyDown(e,t.gramps_id)}"
      >
        <div class="item-content">
          <div class="status-icon">${this._statusIcon(i,t.handle)}</div>
          <div class="title">
            <span
              class="${Ot({link:!0,strike:"Done"===i})}"
              @click="${e=>this._handleTitleClick(e,t.gramps_id)}"
              @keydown="${gs}"
              >${t.title}</span
            >
            <grampsjs-tags-small
              .data="${t.extended.tags.filter((t=>"ToDo"!==t.name))}"
            ></grampsjs-tags-small>
          </div>
        </div>
        <div slot="meta">
          <span class="prio-icon"
            >${this._priorityIcon(r,t.handle)}</span
          >
        </div>
      </mwc-check-list-item>
    `}_handleTitleClick(t,e){os(this,"nav",{path:`task/${e}`}),t.stopPropagation()}_handleListKeyDown(t,e){"ArrowRight"===t.key&&os(this,"nav",{path:`task/${e}`})}async _updateAttributes(t,e,i){os(this,"tasks:update-attribute",{objects:this.data.filter(((e,i)=>t.includes(i))),key:e,value:i})}}window.customElements.define("grampsjs-tasks",nT);window.customElements.define("grampsjs-view-tasks",class extends $d{static get styles(){return[super.styles,n`
        mwc-fab {
          position: fixed;
          bottom: 32px;
          right: 32px;
        }
      `]}static get properties(){return{_data:{type:Array},canAdd:{type:Boolean},canEdit:{type:Boolean},_filters:{type:Array}}}constructor(){super(),this.canAdd=!1,this.canEdit=!1,this._data=[],this._filters=[],this._boundFetchData=this._fetchData.bind(this)}render(){return M`<h2>${this._("Tasks")}</h2>

      <grampsjs-tasks
        .strings="${this.strings}"
        .data="${this._data}"
        @tasks:update-attribute="${this._handleUpdateAttribute}"
        @filters:changed="${this._handleFiltersChanged}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-tasks>

      ${this.canAdd?this.renderFab():""} `}renderFab(){return M` <mwc-fab icon="add" @click=${this._handleClickAdd}></mwc-fab> `}_handleClickAdd(){os(this,"nav",{path:"new_task"})}_getAttribute(t,e){return t.attribute_list.filter((t=>t.type===e))[0]?.value}async _fetchData(){this.loading=!0;const t={rules:[{name:"HasTag",values:["ToDo"]},...this._filters]},e=`/api/sources/?rules=${encodeURIComponent(JSON.stringify(t))}&locale=${this.strings.__lang__||"en"}&sort=-gramps_id&extend=tag_list`,i=await On(e);if(this.loading=!1,"data"in i){this.error=!1;const t={Open:1,"In Progress":2,Blocked:3,other:4,Done:5};this._data=i.data.sort(((e,i)=>t[this._getAttribute(e,"Status")||"other"]-t[this._getAttribute(i,"Status")||"other"]))}"error"in i&&(this.error=!0,this._errorMessage=i.error)}async _handleUpdateAttribute(t){const{key:e}=t.detail,{value:i}=t.detail;for(let r=0;r<t.detail.objects.length;r+=1){const n=t.detail.objects[r],{extended:a,profile:s,...o}=n;o.attribute_list=[...o.attribute_list.filter((t=>t.type!==e)),{type:e,value:i}],await Fn(`/api/sources/${n.handle}`,o,!0,!1)}os(this,"db:changed")}_handleFiltersChanged(t){this._filters=t.detail.filters,t.preventDefault(),t.stopPropagation(),this._fetchData()}firstUpdated(){"__lang__"in this.strings&&this._fetchData()}connectedCallback(){super.connectedCallback(),window.addEventListener("db:changed",this._boundFetchData)}disconnectedCallback(){window.removeEventListener("db:changed",this._boundFetchData),super.disconnectedCallback()}});var aT={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};Ca.extend(Ia),Ca.extend((function(t,e,i){var r=e.prototype,n=r.format;i.en.formats=aT,r.format=function(t){void 0===t&&(t=fa);var e=this.$locale().formats,i=function(t,e){return t.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,i,r){var n=r&&r.toUpperCase();return i||e[r]||aT[r]||function(t){return t.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(t,e,i){return e||i.slice(1)}))}(e[n])}))}(t,void 0===e?{}:e);return n.call(this,i)}}));window.customElements.define("grampsjs-timedelta",class extends K{static get properties(){return{timestamp:{type:Number},locale:{type:String},timestampString:{type:String},tooltipString:{type:String}}}constructor(){super(),this.timestamp=0,this.locale="en_GB",this.timestampString="",this.tooltipString=""}render(){return M`<span id="timestamp">${this.timestampString}</span
      ><grampsjs-tooltip
        for="timestamp"
        content="${this.tooltipString}"
      ></grampsjs-tooltip>`}_updateString(){const t="pt_PT"===this.locale?"pt":this.locale;Ca.locale(t.toLowerCase().replace("_","-")),this.timestampString=Ca.unix(this.timestamp).fromNow(),this.tooltipString=Ca.unix(this.timestamp).format("lll")}connectedCallback(){super.connectedCallback(),this._updateString(),this._timerInterval=setInterval((()=>this._updateString()),1e4)}disconnectedCallback(){super.disconnectedCallback(),clearInterval(this._timerInterval)}});class sT extends(al(K)){static get styles(){return[nl,n`
        h3 {
          font-family: var(--grampsjs-heading-font-family);
          font-size: 20px;
          margin-bottom: 20px;
          font-weight: 400;
          margin-top: 0;
          line-height: 1.3em;
          min-height: 2.6em;
          color: rgba(0, 0, 0, 0.75);
        }

        #image {
          width: 170px;
          flex-shrink: 0;
          text-align: right;
        }

        #note {
          flex-grow: 1;
          font-size: 17px;
          font-weight: 300;
          color: rgba(0, 0, 0, 0.7);
          line-height: 1.45em;
        }

        #date {
          color: rgba(0, 0, 0, 0.6);
          font-size: 14px;
          letter-spacing: 0.02em;
          margin: 2em 0;
          font-weight: 250;
        }

        .clear {
          clear: both;
        }

        #content {
          display: flex;
        }

        @media (max-width: 500px) {
          #image {
            display: none;
          }
        }
      `]}static get properties(){return{data:{type:Object}}}constructor(){super(),this.data={}}render(){return 0===Object.keys(this.data).length?M``:M`
      <div class="blog-preview">
        <h3>${this.data.title}</h3>
        <div id="content">
          <div id="note">${this.getPreviewText()}</div>
          ${this.data?.media_list?.length?this._renderImage():""}
        </div>
        <div class="clear"></div>
        <div id="date">
          ${this.strings.__lang__?M`<grampsjs-timedelta
                timestamp="${this.data.change}"
                locale="${this.strings.__lang__}"
              ></grampsjs-timedelta>`:""}
        </div>
      </div>
    `}getPreviewText(){const t=this.data?.extended?.notes[0]?.text?.string;if(!t)return"";const e=t.match(/[\s\S]{250}[^\s]{0,50}\s?/g);return null===e?t:`${e[0]} ...`}_renderImage(){const t=this.data.media_list[0],e=this.data.extended.media[0];return M`
      <div id="image">
        <grampsjs-img
          handle="${e.handle}"
          size="150"
          displayHeight="150"
          square
          .rect="${t.rect||[]}"
          mime="${e.mime}"
        ></grampsjs-img>
      </div>
    `}}window.customElements.define("grampsjs-blog-post-preview",sT);window.customElements.define("grampsjs-view-blog",class extends $d{static get styles(){return[super.styles,n`
        .muted {
          opacity: 0.4;
        }

        #posts {
          display: grid;
          gap: 1em;
          grid-template-columns: repeat(
            auto-fill,
            minmax(min(420px, 100%), 1fr)
          );
        }

        .post {
          padding: 0.8em 1em;
          cursor: pointer;
          outline: 2px solid rgba(0, 0, 0, 0);
          transition: outline-color 0.3s ease-in;
        }

        .post:focus,
        .post:focus-within {
          outline: 2px solid rgba(0, 0, 0, 0.1);
          border-radius: 5px;
        }

        .post > div {
        }
      `]}static get properties(){return{_dataSources:{type:Array},_dataNotes:{type:Array},_totalCount:{type:Number},_page:{type:Number},_pages:{type:Number}}}constructor(){super(),this._dataSources=[],this._dataNotes=[],this._page=1,this._pageSize=6,this._firstLoaded=!1,this._totalCount=-1,this._pages=-1}renderContent(){return M`
      ${this.renderPosts()}
      ${this._totalCount>0?this.renderPagination():""}
    `}renderPosts(){return this._firstLoaded&&0===this._dataSources.length?M`
        <h2>${this._("Blog")}</h2>
        <p class="muted">
          ${this._("To start using the blog, add a source with tag 'Blog'.")}
        </p>
      `:this.loading?M``:M`
      <div id="posts">
        ${this._dataSources.map(((t,e)=>this.renderPost(t,this._dataNotes[e])),this)}
      </div>
    `}renderPagination(){return M`
      <grampsjs-pagination
        page="${this._page}"
        pages="${this._pages}"
        @page:changed="${this._handlePageChanged}"
        .strings="${this.strings}"
      ></grampsjs-pagination>
    `}_handlePageChanged(t){this._page=t.detail.page,this._fetchData()}renderPost(t){return M`
      <div
        class="post"
        tabindex="0"
        @click="${()=>this._handlePreviewClick(t.gramps_id)}"
        @keydown="${gs}"
      >
        <div>
          <grampsjs-blog-post-preview
            .data="${t}"
            .strings="${this.strings}"
          ></grampsjs-blog-post-preview>
        </div>
      </div>
    `}firstUpdated(){this._fetchData()}_handlePreviewClick(t){os(this,"nav",{path:`blog/${t}`})}async _fetchData(){this.loading=!0;const t=`/api/sources/?rules=${encodeURIComponent(JSON.stringify({rules:[{name:"HasTag",values:["Blog"]}]}))}&page=${this._page}&pagesize=${this._pageSize}&sort=-change&locale=${this.strings?.__lang__||"en"}&profile=all&extend=all`;await On(t).then((t=>{"data"in t?(this.error=!1,this._dataSources=t.data,this._totalCount=t.total_count,this._pages=Math.ceil(this._totalCount/this._pageSize)):"error"in t&&(this.error=!0,this._errorMessage=t.error)})),this.loading=!1,this._firstLoaded=!0}});class oT extends(al(K)){static get styles(){return[nl,n`
        h2 {
          color: #222222;
          font-weight: 300;
          font-size: 40px;
          padding-bottom: 0.3em;
          margin-bottom: 0.5em;
          padding-top: 0.5em;
          text-align: center;
          border-bottom: 2px solid #222222;
        }

        h3.author {
          font-family: var(--grampsjs-body-font-family);
          font-size: 16px;
          text-transform: uppercase;
          letter-spacing: 0.15em;
          margin-bottom: 60px;
          text-align: center;
        }

        #img-container {
          width: 100%;
          text-align: center;
        }

        #image {
          margin-top: 2em;
          margin-bottom: 3em;
        }

        #note {
          margin: 4em 0em;
        }

        #note-wrapper {
          margin: 0 auto;
          max-width: 40em;
        }

        grampsjs-note-content {
          --grampsjs-note-line-height: 1.7em;
          --grampsjs-note-font-size: 18px;
          --grampsjs-note-font-family: 'EB Garamond x';
          --grampsjs-note-color: #333;
        }

        #btn-details {
          margin-top: 2em;
        }

        @media (min-width: 768px) {
          h2 {
            font-size: 60px;
          }

          grampsjs-note-content {
            --grampsjs-note-font-size: 23px;
          }
        }
      `]}static get properties(){return{source:{type:Object},note:{type:Object}}}constructor(){super(),this.source={},this.note={}}render(){return 0===Object.keys(this.source).length?M``:M`
      <div class="blog-preview">
        <h2>${this.source.title}</h2>
        <h3 class="author">
          ${this.source.author} ~
          ${this.strings.__lang__?M`<grampsjs-timedelta
                timestamp="${this.source.change}"
                locale="${this.strings.__lang__}"
              ></grampsjs-timedelta>`:""}
        </h3>
        <div id="image">
          ${this.source?.media_list?.length?this._renderImage():""}
        </div>
        <div id="note">
          <div id="note-wrapper">
            <grampsjs-note-content
              ?framed="${!1}"
              grampsId="${this.note.grampsId}"
              content="${this.note?.formatted?.html||this.note?.text?.string||"Error loading note"}"
            >
            </grampsjs-note-content>

            ${this.source?.media_list?.length>1?M`
                  <grampsjs-gallery
                    .strings=${this.strings}
                    .media=${this.source?.extended?.media}
                    .mediaRef=${this.source?.media_list}
                  ></grampsjs-gallery>
                `:""}

            <mwc-button
              id="btn-details"
              @click="${()=>this._clickDetails(this.source.gramps_id)}"
              >Details</mwc-button
            >
          </div>
        </div>
      </div>
    `}_clickDetails(t){this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:`source/${t}`}}))}_renderImage(){const t=this.source.media_list[0],e=this.source.extended.media[0];return M`
      <div id="img-container">
        <grampsjs-img
          handle="${e.handle}"
          size="1000"
          .rect="${t.rect||[]}"
          mime="${e.mime}"
        ></grampsjs-img>
      </div>
    `}}window.customElements.define("grampsjs-blog-post",oT);window.customElements.define("grampsjs-view-blog-post",class extends $d{static get styles(){return[super.styles,n`
        .muted {
          opacity: 0.4;
        }
      `]}static get properties(){return{grampsId:{type:String},_dataSources:{type:Array},_dataNotes:{type:Array}}}constructor(){super(),this.grampsId="",this._dataSources=[],this._dataNotes=[],this._firstLoaded=!1}renderContent(){return M` ${this.renderPosts()} `}renderPosts(){return this._firstLoaded&&0===this._dataSources.length?M`
        <h2>${this._("Blog")}</h2>
        <p class="muted">
          ${this._("To start using the blog, add a source with tag 'Blog'.")}
        </p>
      `:this.loading?M``:M`
      ${this._dataSources.map(((t,e)=>this.renderPost(t,this._dataNotes[e])),this)}
    `}renderPost(t,e){return M`
      <grampsjs-blog-post
        .source="${t}"
        .note="${e}"
        .strings="${this.strings}"
      ></grampsjs-blog-post>
    `}firstUpdated(){this._fetchData()}_getNotesUrl(){const t=this._dataSources[0]?.extended?.notes[0]?.gramps_id;if(!t)return"";const e={link_format:"/{obj_class}/{gramps_id}"};return`/api/notes/?locale=${this.strings?.__lang__||"en"}&profile=all&extend=all&formats=html&gramps_id=${t}&format_options=${encodeURIComponent(JSON.stringify(e))}`}update(t){super.update(t),this.active&&t.has("grampsId")&&this._fetchData()}async _fetchData(){this.loading=!0;const t=`/api/sources/?gramps_id=${this.grampsId}&locale=${this.strings?.__lang__||"en"}&profile=all&backlinks=true&extend=all`;await On(t).then((t=>{"data"in t?(this.error=!1,this._dataSources=t.data):"error"in t&&(this.error=!0,this._errorMessage=t.error)}));const e=this._getNotesUrl();e&&await On(e).then((t=>{"data"in t?(this.error=!1,this._dataNotes=t.data):"error"in t&&(this.error=!0,this._errorMessage=t.error)})),this.loading=!1,this._firstLoaded=!0}});class lT extends $d{static get styles(){return[super.styles,n`
        :host {
        }

        div.spacer {
          margin-top: 2em;
        }

        p.right {
          text-align: right;
        }
      `]}static get properties(){return{data:{type:Object},types:{type:Object},typesLocale:{type:Object},loadingTypes:{type:Boolean},postUrl:{type:String},itemPath:{type:String},objClass:{type:String},isFormValid:{type:Boolean}}}constructor(){super(),this.data={},this.types={},this.typesLocale={},this.loadingTypes=!1,this.postUrl="",this.itemPath="",this.objClass="",this.isFormValid=!1}update(t){super.update(t),t.has("active")&&this._updateData()}_reset(){this.shadowRoot.querySelectorAll(["grampsjs-form-select-type","grampsjs-form-private","grampsjs-form-object-list","grampsjs-form-select-object","grampsjs-form-select-object-list","grampsjs-form-select-date","grampsjs-form-string","grampsjs-form-upload","grampsjs-form-name"].join(", ")).forEach((t=>t.reset())),this.shadowRoot.querySelectorAll("mwc-textfield").forEach((t=>{t.value=""}))}_submit(){Nn(this.postUrl,this.data).then((t=>{if("data"in t){this.error=!1;const e=t.data.filter((t=>t.new._class===this.objClass))[0].new.gramps_id;this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:this._getItemPath(e)}})),this._reset()}else"error"in t&&(this.error=!0,this._errorMessage=t.error)}))}_getItemPath(t){return`${this.itemPath}/${t}`}renderButtons(){return M`
      <div class="spacer"></div>
      <p class="right">
        <mwc-button
          outlined
          label="${this._("Cancel")}"
          type="reset"
          @click="${this._reset}"
          icon="cancel"
        >
        </mwc-button>
        <mwc-button
          raised
          label="${this._("Add")}"
          type="submit"
          @click="${this._submit}"
          icon="save"
          ?disabled=${!this.isFormValid}
        >
          <span slot="trailingIcon" style="display:none;">
            <mwc-circular-progress
              indeterminate
              density="-7"
              closed
              id="login-progress"
            >
            </mwc-circular-progress>
          </span>
        </mwc-button>
      </p>
    `}_renderCitationForm(){return M`
      <h4 class="label">${this._("Citation")}</h4>

      <grampsjs-form-select-object-list
        multiple
        id="object-citation"
        objectType="citation"
        .strings="${this.strings}"
      ></grampsjs-form-select-object-list>
    `}_updateData(){this.loading=!0,this.loadingTypes=!0,On("/api/types/").then((t=>{this.loading=!1,"data"in t?(this.types=t.data||{},this.error=!1):"error"in t&&(this.error=!0,this._errorMessage=t.error)})).then((()=>{this.loading=!0,On("/api/types/?locale=1").then((t=>{this.loading=!1,this.loadingTypes=!1,"data"in t?(this.typesLocale=t.data||{},this.error=!1):"error"in t&&(this.error=!0,this._errorMessage=t.error)}))}))}translateTypeName(t,e,i){const r=((this.types[t?"custom":"default"]||{})[e]||[]).indexOf(i);try{return this.typesLocale[t?"custom":"default"][e][r]}catch{return i}}connectedCallback(){super.connectedCallback(),this.addEventListener("formdata:changed",this._handleFormData.bind(this))}disconnectedCallback(){this.removeEventListener("formdata:changed",this._handleFormData.bind(this)),super.disconnectedCallback()}_handleFormData(t){const e=t.composedPath()[0];"private"===e.id&&(this.data={...this.data,private:t.detail.checked}),["author","pubinfo","abbrev","page","desc","description"].includes(e.id)&&(this.data={...this.data,[e.id]:t.detail.data}),"object-citation-list"===e.id&&(this.data={...this.data,citation_list:t.detail.data??[]})}}const cT={0:"Very Low",1:"Low",2:"Normal",3:"High",4:"Very High"};window.customElements.define("grampsjs-view-new-citation",class extends lT{constructor(){super(),this.data={_class:"Citation",confidence:2},this.postUrl="/api/citations/",this.itemPath="citation",this.objClass="Citation"}renderContent(){return M`
      <h2>${this._("New Citation")}</h2>

      <h4 class="label">${this._("Source")}</h4>
      <grampsjs-form-select-object-list
        id="source"
        objectType="source"
        .strings="${this.strings}"
      ></grampsjs-form-select-object-list>

      <h4 class="label">${this._("Page")}</h4>
      <p>
        <grampsjs-form-string fullwidth id="page"></grampsjs-form-string>
      </p>

      <h4 class="label">${this._("Date")}</h4>
      <p>
        <grampsjs-form-select-date id="date" .strings="${this.strings}">
        </grampsjs-form-select-date>
      </p>

      <h4 class="label">${this._("Confidence")}</h4>
      <mwc-select id="select-confidence" @change="${this.handleConfidence}">
        ${Object.keys(cT).map((t=>M`
            <mwc-list-item
              value="${t}"
              ?selected="${t==this.data.confidence}"
              >${this._(cT[t])}</mwc-list-item
            >
          `))}
      </mwc-select>

      <div class="spacer"></div>
      <grampsjs-form-private
        id="private"
        .strings="${this.strings}"
      ></grampsjs-form-private>

      ${this.renderButtons()}
    `}checkFormValidity(){let t=!!this.data?.source_handle;const e=this.shadowRoot.querySelector("grampsjs-form-select-date");null===!e||e.isValid()||(t=!1),this.isFormValid=t}handleConfidence(t){this.data={...this.data,confidence:parseInt(t.target.value,10)}}_handleFormData(t){super._handleFormData(t);const e=t.composedPath()[0];"source-list"===e.id&&(this.data={...this.data,source_handle:t.detail.data[0]}),"date"===e.id&&(this.data={...this.data,date:t.detail.data}),this.checkFormValidity()}_reset(){super._reset(),this.isFormValid=!1,this.data={_class:"Citation",confidence:2}}});window.customElements.define("grampsjs-form-edit-citation-details",class extends lh{static get properties(){return{source:{type:Object}}}constructor(){super(),this.source={}}renderForm(){return M`
      <h4 class="label">${this._("Source")}</h4>
      <grampsjs-form-select-object-list
        id="source"
        objectType="source"
        .objectsInitial="${this.data.source_handle?[{object_type:"source",object:this.source,handle:this.data.source_handle}]:[]}"
        .strings="${this.strings}"
        notDeletable
      ></grampsjs-form-select-object-list>

      <h4 class="label">${this._("Page")}</h4>
      <p>
        <grampsjs-form-string
          fullwidth
          id="page"
          value="${this.data.page}"
        ></grampsjs-form-string>
      </p>

      <h4 class="label">${this._("Date")}</h4>
      <p>
        <grampsjs-form-select-date
          fullwidth
          id="date"
          @formdata:changed="${this._handleFormData}"
          .data="${this.data.date}"
          .strings="${this.strings}"
        >
        </grampsjs-form-select-date>
      </p>

      <h4 class="label">${this._("Confidence")}</h4>
      <mwc-select id="select-confidence" @change="${this.handleConfidence}">
        ${Object.keys(cT).map((t=>M`
            <mwc-list-item
              value="${t}"
              ?selected="${t==this.data.confidence}"
              >${this._(cT[t])}</mwc-list-item
            >
          `))}
      </mwc-select>
    `}get isValid(){return!!this.data.source_handle&&this._areDateSelectValid()}handleConfidence(t){this.data={...this.data,confidence:parseInt(t.target.value,10)}}});const dT={0:"Very Low",1:"Low",2:"Normal",3:"High",4:"Very High"};window.customElements.define("grampsjs-citation",class extends Gk{static get styles(){return[super.styles,n`
        :host {
        }
      `]}constructor(){super(),this._objectsName="Citations",this._objectEndpoint="citations",this._objectIcon="bookmark"}renderProfile(){return M`
      <h2>${this._("Citation")}</h2>

      <dl>
        ${this.data?.profile?.date?M`
              <div>
                <dt>${this._("Date")}</dt>
                <dd>${this.data.profile.date}</dd>
              </div>
            `:""}
        <div>
          <dt>${this._("Source")}</dt>
          <dd>
            <a href="${""}/source/${this.data.extended.source.gramps_id}"
              >${this.data.extended.source.title||this.data.extended.source.gramps_id}</a
            >
          </dd>
        </div>
        ${this.data?.page?M`
              <div>
                <dt>${this._("Page")}</dt>
                <dd>${ys(this.data.page,!1)}</dd>
              </div>
            `:""}
        <div>
          <dt>${this._("Confidence")}</dt>
          <dd>${this._(dT[this.data.confidence])}</dd>
        </div>
      </dl>
      ${this.edit?M`
            <mwc-icon-button
              icon="edit"
              class="edit"
              @click="${this._handleEditDetails}"
            ></mwc-icon-button>
          `:""}
    `}renderPicture(){return""}_handleEditDetails(){const t={date:this.data.date,confidence:this.data.confidence,source_handle:this.data.source_handle,page:this.data.page},e=this.data?.extended?.source;this.dialogContent=M`
      <grampsjs-form-edit-citation-details
        @object:save="${this._handleSaveDetails}"
        @object:cancel="${this._handleCancelDialog}"
        .strings=${this.strings}
        .data=${t}
        .source=${e}
      >
      </grampsjs-form-edit-citation-details>
    `}_handleSaveDetails(t){os(this,"edit:action",{action:"updateProp",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}});window.customElements.define("grampsjs-view-citation",class extends Ym{constructor(){super(),this._className="citation"}getUrl(){return`/api/citations/?gramps_id=${this.grampsId}&locale=${this.strings?.__lang__||"en"}&profile=all&backlinks=true&extend=all`}renderElement(){return M`
      <grampsjs-citation
        .data=${this._data}
        .strings=${this.strings}
        ?edit="${this.edit}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-citation>
    `}});class hT extends em{}const pT=vh`:host{--_container-height: var(--md-text-button-container-height, 40px);--_disabled-label-text-color: var(--md-text-button-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-text-button-disabled-label-text-opacity, 0.38);--_focus-label-text-color: var(--md-text-button-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_hover-label-text-color: var(--md-text-button-hover-label-text-color, var(--md-sys-color-primary, #6750a4));--_hover-state-layer-color: var(--md-text-button-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--_hover-state-layer-opacity: var(--md-text-button-hover-state-layer-opacity, 0.08);--_label-text-color: var(--md-text-button-label-text-color, var(--md-sys-color-primary, #6750a4));--_label-text-font: var(--md-text-button-label-text-font, var(--md-sys-typescale-label-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-text-button-label-text-line-height, var(--md-sys-typescale-label-large-line-height, 1.25rem));--_label-text-size: var(--md-text-button-label-text-size, var(--md-sys-typescale-label-large-size, 0.875rem));--_label-text-weight: var(--md-text-button-label-text-weight, var(--md-sys-typescale-label-large-weight, var(--md-ref-typeface-weight-medium, 500)));--_pressed-label-text-color: var(--md-text-button-pressed-label-text-color, var(--md-sys-color-primary, #6750a4));--_pressed-state-layer-color: var(--md-text-button-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--_pressed-state-layer-opacity: var(--md-text-button-pressed-state-layer-opacity, 0.12);--_disabled-icon-color: var(--md-text-button-disabled-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-icon-opacity: var(--md-text-button-disabled-icon-opacity, 0.38);--_focus-icon-color: var(--md-text-button-focus-icon-color, var(--md-sys-color-primary, #6750a4));--_hover-icon-color: var(--md-text-button-hover-icon-color, var(--md-sys-color-primary, #6750a4));--_icon-color: var(--md-text-button-icon-color, var(--md-sys-color-primary, #6750a4));--_icon-size: var(--md-text-button-icon-size, 18px);--_pressed-icon-color: var(--md-text-button-pressed-icon-color, var(--md-sys-color-primary, #6750a4));--_container-shape-start-start: var(--md-text-button-container-shape-start-start, var(--md-text-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-start-end: var(--md-text-button-container-shape-start-end, var(--md-text-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-end: var(--md-text-button-container-shape-end-end, var(--md-text-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-start: var(--md-text-button-container-shape-end-start, var(--md-text-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_leading-space: var(--md-text-button-leading-space, 12px);--_trailing-space: var(--md-text-button-trailing-space, 12px);--_with-leading-icon-leading-space: var(--md-text-button-with-leading-icon-leading-space, 12px);--_with-leading-icon-trailing-space: var(--md-text-button-with-leading-icon-trailing-space, 16px);--_with-trailing-icon-leading-space: var(--md-text-button-with-trailing-icon-leading-space, 16px);--_with-trailing-icon-trailing-space: var(--md-text-button-with-trailing-icon-trailing-space, 12px);--_container-color: none;--_disabled-container-color: none;--_disabled-container-opacity: 0}
`;let uT=class extends hT{};uT.styles=[am,pT],uT=it([ph("md-text-button")],uT);window.customElements.define("grampsjs-view-recently-changed",class extends fm{renderContent(){return M` <h3>${this._("Recently changed objects")}</h3>
      ${0===this._data.data.length?M` <p>${this._("No items")}.</p> `:M`
            <grampsjs-search-result-list
              linked
              large
              .data="${this._data.data}"
              .strings="${this.strings}"
              date
              noSep
            ></grampsjs-search-result-list>
          `}`}renderLoading(){return M`
      <h3>${this._("Recently changed objects")}</h3>
      <grampsjs-search-result-list
        .data="${this._data.data}"
        .strings="${this.strings}"
        loading
        numberLoading="8"
        noSep
      ></grampsjs-search-result-list>
    `}getUrl(){if(window._oldSearchBackend){return`/api/search/?sort=-change&query=${"change:'-1 year to tomorrow'"}&locale=${this.strings.__lang__||"en"}&profile=all&page=1&pagesize=8`}const t=Math.floor(Date.now()/1e3)-31536e3;return`/api/search/?sort=-change&query=${encodeURIComponent("*")}&change=${encodeURIComponent(`>${t}`)}&locale=${this.strings.__lang__||"en"}&profile=all&page=1&pagesize=8`}});window.customElements.define("grampsjs-view-recent-blog-posts",class extends fm{static get styles(){return[super.styles,n`
        .change {
          font-size: 0.8em;
          color: rgba(0, 0, 0, 0.5);
          margin-top: 0.3em;
        }

        h3 {
          margin-bottom: 15px;
        }
      `]}renderContent(){return this._data?.data?.length?M`
      <h3>${this._("Latest Blog Post")}</h3>
      <grampsjs-search-result-list
        large
        selectable
        @search-result:clicked="${this._handleClick}"
        .data="${this._data.data.slice(0,1).map((t=>({object:t,object_type:"source"})))}"
        .strings="${this.strings}"
        date
        noSep
      >
      </grampsjs-search-result-list>
    `:M`
        <h3>${this._("Latest Blog Post")}</h3>
        <p>${this._("No items")}.</p>
      `}renderLoading(){return M`
      <h3>${this._("Latest Blog Post")}</h3>
      <grampsjs-search-result-list
        .data="${this._data.data}"
        .strings="${this.strings}"
        loading
        numberLoading="1"
        noSep
      ></grampsjs-search-result-list>
    `}_handleClick(t){const e=t?.detail?.object?.gramps_id;e&&os(this,"nav",{path:`blog/${e}`})}getUrl(){return`/api/sources/?rules=${encodeURIComponent(JSON.stringify({rules:[{name:"HasTag",values:["Blog"]}]}))}&pagesize=1&sort=-change&locale=${this.strings.__lang__||"en"}&profile=all&extend=all`}});window.customElements.define("grampsjs-view-anniversaries",class extends fm{static get styles(){return[super.styles,n`
        .date {
          font-size: 0.9em;
          color: rgba(0, 0, 0, 0.5);
        }

        .title {
          margin-top: 0.4em;
          margin-bottom: 0.7em;
        }

        h3 {
          margin-bottom: 15px;
        }

        .years {
          height: 38px;
          width: 38px;
          border-radius: 19px;
          background-color: var(--mdc-theme-primary);
          opacity: 0.6;
          color: white;
          font-size: 15px;
          line-height: 38px;
          display: inline-block;
          text-align: center;
          font-family: var(--grampsjs-heading-font-family);
          font-weight: 300;
        }
      `]}renderLoading(){return M`<h3>${this._("Anniversaries")}</h3>
      <mwc-list>
        ${Array(2).fill(M`
            <mwc-list-item noninteractive twoline graphic="avatar">
              <span class="skeleton" style="width:15em;">&nbsp;</span>
              <span slot="secondary" class="skeleton" style="width:10em;"
                >&nbsp;</span
              >
              <span slot="graphic" class="skeleton avatar">&nbsp;</span>
            </mwc-list-item>
          `)}
      </mwc-list>`}renderContent(){return M`<h3>${this._("Anniversaries")}</h3>
      ${0===this._data.data.length?M`<p>${this._("No items")}.</p>`:M`
            <mwc-list class="large">
              ${this._data.data.map((t=>this._renderEvent(t)))}
            </mwc-list>
          `} `}_renderEvent(t){let e=new Date;e=new Date(t.date.year,e.getMonth(),e.getDate());const i=e.getTime()/1e3,r=(new Date).getFullYear()-e.getFullYear();return r<1?"":M`
      <mwc-list-item
        twoline
        graphic="avatar"
        @click="${()=>this._handleClick(t)}"
        @keydown="${this._handleKeyDown}"
      >
        <span
          >${Ja(t.profile,this.strings)}</span
        >
        <span slot="graphic" class="years">${r}</span>
        <span slot="secondary">
          <grampsjs-timedelta
            timestamp="${i}"
            locale="${this.strings.__lang__}"
          ></grampsjs-timedelta
          >${t?.profile?.place?M`, ${t.profile.place}`:""}
        </span>
      </mwc-list-item>
    `}_handleClick(t){os(this,"nav",{path:`event/${t.gramps_id}`})}_handleKeyDown(t){"Enter"===t.code&&(t.target.click(),t.preventDefault(),t.stopPropagation())}getUrl(){const t=new Date;return`/api/events/?dates=*/${t.getMonth()+1}/${t.getDate()}&profile=all&sort=-date&locale=${this.strings.__lang__||"en"}&pagesize=10&page=1`}});class mT extends(al(K)){static get styles(){return[nl,n`
        h3 {
          margin-bottom: 15px;
        }
      `]}static get properties(){return{homePersonDetails:{type:Object},homePersonGrampsId:{type:String}}}constructor(){super(),this.homePersonDetails={},this.homePersonGrampsId=""}render(){return M`
      <h3>${this._("Home Person")}</h3>

      ${this.homePersonGrampsId?M`
            <div class="content">
              <grampsjs-search-result-list
                large
                linked
                metaIcon="edit"
                .strings=${this.strings}
                .data=${[{object:this.homePersonDetails,object_type:"person"}]}
                @search-result:metaClicked="${this._handleMetaClick}"
              >
              </grampsjs-search-result-list>
            </div>
          `:M` <md-text-button trailing-icon @click="${this._handleMetaClick}">
            ${this._("Set _Home Person")}
            <svg viewBox="0 0 24 24" slot="icon">
              <path d="${Ra}" />
            </svg>
          </md-text-button>`}
    `}_handleMetaClick(){os(this,"nav",{path:"settings"})}}window.customElements.define("grampsjs-home-person",mT);const fT=["people","families","events","places","sources","citations","repositories","notes","media"];window.customElements.define("grampsjs-statistics",class extends Ik{static get styles(){return[super.styles,n`
        :host {
          margin-bottom: 5em;
        }
      `]}render(){return M`
      <h3>${this._("Statistics")}</h3>
      <table>
        ${fT.map((t=>t in this.data?M`
            <tr
              class="${Ot({link:"tags"!==t})}"
              @click=${()=>this._handleClick(t)}
            >
              <th>${this._(`Number of ${t}`)}</th>
              <td>${this.data[t]}</td>
            </tr>
          `:""),this)}
      </table>
    `}_handleClick(t){if("tags"!==t){os(this,"nav",{path:"media"===t?"medialist":t})}}});window.customElements.define("grampsjs-view-dashboard",class extends $d{static get properties(){return{dbInfo:{type:Object},homePersonDetails:{type:Object},homePersonGrampsId:{type:String}}}constructor(){super(),this.dbInfo={},this.homePersonDetails={},this.homePersonGrampsId=""}static get styles(){return[super.styles,n`
        .column {
          float: left;
          width: 50%;
          overflow-x: hidden;
        }

        .column:first-child {
          width: calc(50% - 2em);
          padding-right: 2em;
        }

        .column > div {
          margin-bottom: 1.5em;
        }

        @media screen and (max-width: 768px) {
          .column,
          .column:first-child {
            width: 100%;
            padding-right: 0;
          }
        }
      `]}renderContent(){return M`
      <div class="column">
        <div>
          <grampsjs-home-person
            id="homeperson"
            .strings="${this.strings}"
            .homePersonDetails=${this.homePersonDetails}
            .homePersonGrampsId=${this.homePersonGrampsId}
          >
          </grampsjs-home-person>
        </div>
        <div>
          <grampsjs-view-anniversaries
            id="anniversaries"
            .strings="${this.strings}"
          >
          </grampsjs-view-anniversaries>
        </div>
        <div>
          <grampsjs-view-recently-changed
            id="recently-changed"
            .strings="${this.strings}"
          >
          </grampsjs-view-recently-changed>
        </div>
      </div>
      <div class="column">
        <div>
          <grampsjs-view-recent-blog-posts
            ?active=${this.active}
            id="recent-blog"
            .strings="${this.strings}"
          >
          </grampsjs-view-recent-blog-posts>
        </div>
        <div>
          <grampsjs-statistics
            .data="${this.dbInfo?.object_counts||{}}"
            id="statistics"
            .strings="${this.strings}"
          >
          </grampsjs-statistics>
        </div>
      </div>
    `}});window.customElements.define("grampsjs-repository",class extends Gk{static get styles(){return[super.styles,n`
        :host {
        }
      `]}constructor(){super(),this._showReferences=!1,this._objectsName="Repositories",this._objectEndpoint="repositories",this._objectIcon="account_balance"}renderProfile(){return M`
      <h2
        id="name"
        class="${Ot({editable:this.edit})}"
        contenteditable="${this.edit}"
        @input="${as((()=>this._handleEditName()),500)}"
        .innerText="${Ai(this.data.name)}"
      >
        &nbsp;
      </h2>
      <dl>
        ${this.data?.type?M`
      <dt>${this._("Type")}</dt>
      <dd>${this._(this.data.type)}</dd>
    </dl>`:""}
      </dl>
    `}_handleEditName(){const t=this.renderRoot.getElementById("name"),e=t.textContent.replace(/(\r\n|\n|\r)/gm,"").trim();t.blur(),os(this,"edit:action",{action:"updateProp",data:{name:e}})}});window.customElements.define("grampsjs-view-repository",class extends Ym{constructor(){super(),this._className="repository"}getUrl(){return`/api/repositories/?gramps_id=${this.grampsId}&locale=${this.strings?.__lang__||"en"}&profile=all&backlinks=true&extend=all`}renderElement(){return M`
      <grampsjs-repository
        .data=${this._data}
        .strings=${this.strings}
        ?edit="${this.edit}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-repository>
    `}});window.customElements.define("grampsjs-form-edit-type",class extends lh{static get properties(){return{formId:{type:String},typeName:{type:String}}}constructor(){super(),this.formId="",this.typeName=""}renderForm(){return M`
      <grampsjs-form-select-type
        id="${this.formId}"
        .strings="${this.strings}"
        ?loadingTypes="${this.loadingTypes}"
        typeName="${this.typeName}"
        defaultTypeName="General"
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
        initialValue="${this.data?.type||""}"
      >
      </grampsjs-form-select-type>
    `}});window.customElements.define("grampsjs-note",class extends Gk{static get styles(){return[super.styles,n`
        :host {
        }
      `]}constructor(){super(),this._objectsName="Notes",this._objectEndpoint="notes",this._objectIcon="sticky_note_2"}renderProfile(){return M`
      <h2>
        ${this._(this.data?.type||"Note")}
        ${this.edit?M`
              <mwc-icon-button
                icon="edit"
                class="edit"
                @click="${this._handleEditType}"
              ></mwc-icon-button>
            `:""}
      </h2>

      ${this.edit?M` <grampsjs-editor
            .data=${this.data.text}
            .strings=${this.strings}
          ></grampsjs-editor>`:M` <grampsjs-note-content
            framed
            grampsId="${this.data.gramps_id}"
            content="${this.data?.formatted?.html||this.data?.text?.string||"Error loading note"}"
          ></grampsjs-note-content>`}
    `}_handleEditType(){this.dialogContent=M`
      <grampsjs-form-edit-type
        formId="note-type"
        typeName="note_types"
        @object:save="${this._handleSaveType}"
        @object:cancel="${this._handleCancelDialog}"
        .strings=${this.strings}
        .data=${{type:this.data?.type||""}}
        prop="value"
      >
      </grampsjs-form-edit-type>
    `}});window.customElements.define("grampsjs-view-note",class extends Ym{constructor(){super(),this._className="note",this._saveButton=!0}getUrl(){const t={link_format:"/{obj_class}/{gramps_id}"};return`/api/notes/?gramps_id=${this.grampsId}&locale=${this.strings?.__lang__||"en"}&profile=all&backlinks=true&extend=all&formats=html&format_options=${encodeURIComponent(JSON.stringify(t))}`}renderElement(){return M`
      <grampsjs-note
        .data=${this._data}
        .strings=${this.strings}
        ?edit="${this.edit}"
      ></grampsjs-note>
    `}});window.customElements.define("grampsjs-form-edit-date",class extends lh{static get properties(){return{prop:{type:String}}}constructor(){super(),this.prop="date"}renderForm(){return M`
      <grampsjs-form-select-date
        @formdata:changed="${this._handleFormData}"
        fullwidth
        id="${this.prop}"
        label="${this._("Date")}"
        .data="${this.data.date}"
        .strings="${this.strings}"
      >
      </grampsjs-form-select-date>
    `}get isValid(){return this._areDateSelectValid()}});const gT=n`.mdc-slider{cursor:pointer;height:48px;margin:0 24px;position:relative;touch-action:pan-y}.mdc-slider .mdc-slider__track{height:4px;position:absolute;top:50%;transform:translateY(-50%);width:100%}.mdc-slider .mdc-slider__track--active,.mdc-slider .mdc-slider__track--inactive{display:flex;height:100%;position:absolute;width:100%}.mdc-slider .mdc-slider__track--active{border-radius:3px;height:6px;overflow:hidden;top:-1px}.mdc-slider .mdc-slider__track--active_fill{border-top:6px solid;box-sizing:border-box;height:100%;width:100%;position:relative;-webkit-transform-origin:left;transform-origin:left}[dir=rtl] .mdc-slider .mdc-slider__track--active_fill,.mdc-slider .mdc-slider__track--active_fill[dir=rtl]{-webkit-transform-origin:right;transform-origin:right}.mdc-slider .mdc-slider__track--inactive{border-radius:2px;height:4px;left:0;top:0}.mdc-slider .mdc-slider__track--inactive::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid transparent;border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__track--inactive::before{border-color:CanvasText}}.mdc-slider .mdc-slider__track--active_fill{border-color:#6200ee;border-color:var(--mdc-theme-primary, #6200ee)}.mdc-slider.mdc-slider--disabled .mdc-slider__track--active_fill{border-color:#000;border-color:var(--mdc-theme-on-surface, #000)}.mdc-slider .mdc-slider__track--inactive{background-color:#6200ee;background-color:var(--mdc-theme-primary, #6200ee);opacity:.24}.mdc-slider.mdc-slider--disabled .mdc-slider__track--inactive{background-color:#000;background-color:var(--mdc-theme-on-surface, #000);opacity:.24}.mdc-slider .mdc-slider__value-indicator-container{bottom:44px;left:50%;left:var(--slider-value-indicator-container-left, 50%);pointer-events:none;position:absolute;right:var(--slider-value-indicator-container-right);transform:translateX(-50%);transform:var(--slider-value-indicator-container-transform, translateX(-50%))}.mdc-slider .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0.4, 0, 1, 1);align-items:center;border-radius:4px;display:flex;height:32px;padding:0 12px;transform:scale(0);transform-origin:bottom}.mdc-slider .mdc-slider__value-indicator::before{border-left:6px solid transparent;border-right:6px solid transparent;border-top:6px solid;bottom:-5px;content:"";height:0;left:50%;left:var(--slider-value-indicator-caret-left, 50%);position:absolute;right:var(--slider-value-indicator-caret-right);transform:translateX(-50%);transform:var(--slider-value-indicator-caret-transform, translateX(-50%));width:0}.mdc-slider .mdc-slider__value-indicator::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid transparent;border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__value-indicator::after{border-color:CanvasText}}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator-container{pointer-events:auto}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale(1)}@media(prefers-reduced-motion){.mdc-slider .mdc-slider__value-indicator,.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:none}}.mdc-slider .mdc-slider__value-indicator-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto, sans-serif;font-family:var(--mdc-typography-subtitle2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:0.875rem;font-size:var(--mdc-typography-subtitle2-font-size, 0.875rem);line-height:1.375rem;line-height:var(--mdc-typography-subtitle2-line-height, 1.375rem);font-weight:500;font-weight:var(--mdc-typography-subtitle2-font-weight, 500);letter-spacing:0.0071428571em;letter-spacing:var(--mdc-typography-subtitle2-letter-spacing, 0.0071428571em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle2-text-transform, inherit)}.mdc-slider .mdc-slider__value-indicator{background-color:#000;opacity:.6}.mdc-slider .mdc-slider__value-indicator::before{border-top-color:#000}.mdc-slider .mdc-slider__value-indicator{color:#fff;color:var(--mdc-theme-on-primary, #fff)}.mdc-slider .mdc-slider__thumb{display:flex;height:48px;left:-24px;outline:none;position:absolute;user-select:none;width:48px}.mdc-slider .mdc-slider__thumb--top{z-index:1}.mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-style:solid;border-width:1px;box-sizing:content-box}.mdc-slider .mdc-slider__thumb-knob{box-shadow:0px 2px 1px -1px rgba(0, 0, 0, 0.2),0px 1px 1px 0px rgba(0, 0, 0, 0.14),0px 1px 3px 0px rgba(0,0,0,.12);border:10px solid;border-radius:50%;box-sizing:border-box;height:20px;left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);width:20px}.mdc-slider .mdc-slider__thumb-knob{background-color:#6200ee;background-color:var(--mdc-theme-primary, #6200ee);border-color:#6200ee;border-color:var(--mdc-theme-primary, #6200ee)}.mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mdc-slider.mdc-slider--disabled .mdc-slider__thumb-knob{background-color:#000;background-color:var(--mdc-theme-on-surface, #000);border-color:#000;border-color:var(--mdc-theme-on-surface, #000)}.mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mdc-slider .mdc-slider__thumb::before,.mdc-slider .mdc-slider__thumb::after{background-color:#6200ee;background-color:var(--mdc-ripple-color, var(--mdc-theme-primary, #6200ee))}.mdc-slider .mdc-slider__thumb:hover::before,.mdc-slider .mdc-slider__thumb.mdc-ripple-surface--hover::before{opacity:0.04;opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded--background-focused::before,.mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:0.12;opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-slider .mdc-slider__tick-marks{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:space-between;padding:0 1px;position:absolute;width:100%}.mdc-slider .mdc-slider__tick-mark--active,.mdc-slider .mdc-slider__tick-mark--inactive{border-radius:50%;height:2px;width:2px}.mdc-slider .mdc-slider__tick-mark--active{background-color:#fff;background-color:var(--mdc-theme-on-primary, #fff);opacity:.6}.mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--active{background-color:#fff;background-color:var(--mdc-theme-on-primary, #fff);opacity:.6}.mdc-slider .mdc-slider__tick-mark--inactive{background-color:#6200ee;background-color:var(--mdc-theme-primary, #6200ee);opacity:.6}.mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--inactive{background-color:#000;background-color:var(--mdc-theme-on-surface, #000);opacity:.6}.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:transform 80ms ease}@media(prefers-reduced-motion){.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:none}}.mdc-slider--disabled{opacity:.38;cursor:auto}.mdc-slider--disabled .mdc-slider__thumb{pointer-events:none}.mdc-slider__input{cursor:pointer;left:0;margin:0;height:100%;opacity:0;pointer-events:none;position:absolute;top:0;width:100%}:host{outline:none;display:block;-webkit-tap-highlight-color:transparent}.ripple{--mdc-ripple-color:#6200ee;--mdc-ripple-color:var(--mdc-theme-primary, #6200ee)}`;var _T,vT;!function(t){t[t.ACTIVE=0]="ACTIVE",t[t.INACTIVE=1]="INACTIVE"}(_T||(_T={})),function(t){t[t.START=1]="START",t[t.END=2]="END"}(vT||(vT={}));var yT={animation:{prefixed:"-webkit-animation",standard:"animation"},transform:{prefixed:"-webkit-transform",standard:"transform"},transition:{prefixed:"-webkit-transition",standard:"transition"}};function bT(t,e){if(function(t){return Boolean(t.document)&&"function"==typeof t.document.createElement}(t)&&e in yT){var i=t.document.createElement("div"),r=yT[e],n=r.standard,a=r.prefixed;return n in i.style?n:a}return e}var xT,wT="mdc-slider--disabled",kT="mdc-slider--discrete",TT="mdc-slider--range",ST="mdc-slider__thumb--focused",CT="mdc-slider__thumb--top",ET="mdc-slider__thumb--with-indicator",$T="mdc-slider--tick-marks",AT=1,IT=0,MT=5,LT="aria-valuetext",PT="disabled",RT="min",zT="max",DT="value",jT="step",OT="data-min-range",BT="--slider-value-indicator-caret-left",FT="--slider-value-indicator-caret-right",NT="--slider-value-indicator-caret-transform",HT="--slider-value-indicator-container-left",VT="--slider-value-indicator-container-right",UT="--slider-value-indicator-container-transform";!function(t){t.SLIDER_UPDATE="slider_update"}(xT||(xT={}));var YT="undefined"!=typeof window,ZT=function(t){function e(i){var r=t.call(this,et(et({},e.defaultAdapter),i))||this;return r.initialStylesRemoved=!1,r.isDisabled=!1,r.isDiscrete=!1,r.step=AT,r.minRange=IT,r.hasTickMarks=!1,r.isRange=!1,r.thumb=null,r.downEventClientX=null,r.startThumbKnobWidth=0,r.endThumbKnobWidth=0,r.animFrame=new Xo,r}return tt(e,t),Object.defineProperty(e,"defaultAdapter",{get:function(){return{hasClass:function(){return!1},addClass:function(){},removeClass:function(){},addThumbClass:function(){},removeThumbClass:function(){},getAttribute:function(){return null},getInputValue:function(){return""},setInputValue:function(){},getInputAttribute:function(){return null},setInputAttribute:function(){return null},removeInputAttribute:function(){return null},focusInput:function(){},isInputFocused:function(){return!1},shouldHideFocusStylesForPointerEvents:function(){return!1},getThumbKnobWidth:function(){return 0},getValueIndicatorContainerWidth:function(){return 0},getThumbBoundingClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getBoundingClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},isRTL:function(){return!1},setThumbStyleProperty:function(){},removeThumbStyleProperty:function(){},setTrackActiveStyleProperty:function(){},removeTrackActiveStyleProperty:function(){},setValueIndicatorText:function(){},getValueToAriaValueTextFn:function(){return null},updateTickMarks:function(){},setPointerCapture:function(){},emitChangeEvent:function(){},emitInputEvent:function(){},emitDragStartEvent:function(){},emitDragEndEvent:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){},registerThumbEventHandler:function(){},deregisterThumbEventHandler:function(){},registerInputEventHandler:function(){},deregisterInputEventHandler:function(){},registerBodyEventHandler:function(){},deregisterBodyEventHandler:function(){},registerWindowEventHandler:function(){},deregisterWindowEventHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this;this.isDisabled=this.adapter.hasClass(wT),this.isDiscrete=this.adapter.hasClass(kT),this.hasTickMarks=this.adapter.hasClass($T),this.isRange=this.adapter.hasClass(TT);var e=this.convertAttributeValueToNumber(this.adapter.getInputAttribute(RT,this.isRange?vT.START:vT.END),RT),i=this.convertAttributeValueToNumber(this.adapter.getInputAttribute(zT,vT.END),zT),r=this.convertAttributeValueToNumber(this.adapter.getInputAttribute(DT,vT.END),DT),n=this.isRange?this.convertAttributeValueToNumber(this.adapter.getInputAttribute(DT,vT.START),DT):e,a=this.adapter.getInputAttribute(jT,vT.END),s=a?this.convertAttributeValueToNumber(a,jT):this.step,o=this.adapter.getAttribute(OT),l=o?this.convertAttributeValueToNumber(o,OT):this.minRange;this.validateProperties({min:e,max:i,value:r,valueStart:n,step:s,minRange:l}),this.min=e,this.max=i,this.value=r,this.valueStart=n,this.step=s,this.minRange=l,this.numDecimalPlaces=qT(this.step),this.valueBeforeDownEvent=r,this.valueStartBeforeDownEvent=n,this.mousedownOrTouchstartListener=this.handleMousedownOrTouchstart.bind(this),this.moveListener=this.handleMove.bind(this),this.pointerdownListener=this.handlePointerdown.bind(this),this.pointerupListener=this.handlePointerup.bind(this),this.thumbMouseenterListener=this.handleThumbMouseenter.bind(this),this.thumbMouseleaveListener=this.handleThumbMouseleave.bind(this),this.inputStartChangeListener=function(){t.handleInputChange(vT.START)},this.inputEndChangeListener=function(){t.handleInputChange(vT.END)},this.inputStartFocusListener=function(){t.handleInputFocus(vT.START)},this.inputEndFocusListener=function(){t.handleInputFocus(vT.END)},this.inputStartBlurListener=function(){t.handleInputBlur(vT.START)},this.inputEndBlurListener=function(){t.handleInputBlur(vT.END)},this.resizeListener=this.handleResize.bind(this),this.registerEventHandlers()},e.prototype.destroy=function(){this.deregisterEventHandlers()},e.prototype.setMin=function(t){this.min=t,this.isRange||(this.valueStart=t),this.updateUI()},e.prototype.setMax=function(t){this.max=t,this.updateUI()},e.prototype.getMin=function(){return this.min},e.prototype.getMax=function(){return this.max},e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(t){if(this.isRange&&t<this.valueStart+this.minRange)throw new Error("end thumb value ("+t+") must be >= start thumb value ("+this.valueStart+") + min range ("+this.minRange+")");this.updateValue(t,vT.END)},e.prototype.getValueStart=function(){if(!this.isRange)throw new Error("`valueStart` is only applicable for range sliders.");return this.valueStart},e.prototype.setValueStart=function(t){if(!this.isRange)throw new Error("`valueStart` is only applicable for range sliders.");if(this.isRange&&t>this.value-this.minRange)throw new Error("start thumb value ("+t+") must be <= end thumb value ("+this.value+") - min range ("+this.minRange+")");this.updateValue(t,vT.START)},e.prototype.setStep=function(t){this.step=t,this.numDecimalPlaces=qT(t),this.updateUI()},e.prototype.setMinRange=function(t){if(!this.isRange)throw new Error("`minRange` is only applicable for range sliders.");if(t<0)throw new Error("`minRange` must be non-negative. Current value: "+t);if(this.value-this.valueStart<t)throw new Error("start thumb value ("+this.valueStart+") and end thumb value ("+this.value+") must differ by at least "+t+".");this.minRange=t},e.prototype.setIsDiscrete=function(t){this.isDiscrete=t,this.updateValueIndicatorUI(),this.updateTickMarksUI()},e.prototype.getStep=function(){return this.step},e.prototype.getMinRange=function(){if(!this.isRange)throw new Error("`minRange` is only applicable for range sliders.");return this.minRange},e.prototype.setHasTickMarks=function(t){this.hasTickMarks=t,this.updateTickMarksUI()},e.prototype.getDisabled=function(){return this.isDisabled},e.prototype.setDisabled=function(t){this.isDisabled=t,t?(this.adapter.addClass(wT),this.isRange&&this.adapter.setInputAttribute(PT,"",vT.START),this.adapter.setInputAttribute(PT,"",vT.END)):(this.adapter.removeClass(wT),this.isRange&&this.adapter.removeInputAttribute(PT,vT.START),this.adapter.removeInputAttribute(PT,vT.END))},e.prototype.getIsRange=function(){return this.isRange},e.prototype.layout=function(t){var e=(void 0===t?{}:t).skipUpdateUI;this.rect=this.adapter.getBoundingClientRect(),this.isRange&&(this.startThumbKnobWidth=this.adapter.getThumbKnobWidth(vT.START),this.endThumbKnobWidth=this.adapter.getThumbKnobWidth(vT.END)),e||this.updateUI()},e.prototype.handleResize=function(){this.layout()},e.prototype.handleDown=function(t){if(!this.isDisabled){this.valueStartBeforeDownEvent=this.valueStart,this.valueBeforeDownEvent=this.value;var e=null!=t.clientX?t.clientX:t.targetTouches[0].clientX;this.downEventClientX=e;var i=this.mapClientXOnSliderScale(e);this.thumb=this.getThumbFromDownEvent(e,i),null!==this.thumb&&(this.handleDragStart(t,i,this.thumb),this.updateValue(i,this.thumb,{emitInputEvent:!0}))}},e.prototype.handleMove=function(t){if(!this.isDisabled){t.preventDefault();var e=null!=t.clientX?t.clientX:t.targetTouches[0].clientX,i=null!=this.thumb;if(this.thumb=this.getThumbFromMoveEvent(e),null!==this.thumb){var r=this.mapClientXOnSliderScale(e);i||(this.handleDragStart(t,r,this.thumb),this.adapter.emitDragStartEvent(r,this.thumb)),this.updateValue(r,this.thumb,{emitInputEvent:!0})}}},e.prototype.handleUp=function(){var t,e;if(!this.isDisabled&&null!==this.thumb){(null===(e=(t=this.adapter).shouldHideFocusStylesForPointerEvents)||void 0===e?void 0:e.call(t))&&this.handleInputBlur(this.thumb);var i=this.thumb===vT.START?this.valueStartBeforeDownEvent:this.valueBeforeDownEvent,r=this.thumb===vT.START?this.valueStart:this.value;i!==r&&this.adapter.emitChangeEvent(r,this.thumb),this.adapter.emitDragEndEvent(r,this.thumb),this.thumb=null}},e.prototype.handleThumbMouseenter=function(){this.isDiscrete&&this.isRange&&(this.adapter.addThumbClass(ET,vT.START),this.adapter.addThumbClass(ET,vT.END))},e.prototype.handleThumbMouseleave=function(){var t,e;this.isDiscrete&&this.isRange&&(!(null===(e=(t=this.adapter).shouldHideFocusStylesForPointerEvents)||void 0===e?void 0:e.call(t))&&(this.adapter.isInputFocused(vT.START)||this.adapter.isInputFocused(vT.END))||this.thumb||(this.adapter.removeThumbClass(ET,vT.START),this.adapter.removeThumbClass(ET,vT.END)))},e.prototype.handleMousedownOrTouchstart=function(t){var e=this,i="mousedown"===t.type?"mousemove":"touchmove";this.adapter.registerBodyEventHandler(i,this.moveListener);var r=function(){e.handleUp(),e.adapter.deregisterBodyEventHandler(i,e.moveListener),e.adapter.deregisterEventHandler("mouseup",r),e.adapter.deregisterEventHandler("touchend",r)};this.adapter.registerBodyEventHandler("mouseup",r),this.adapter.registerBodyEventHandler("touchend",r),this.handleDown(t)},e.prototype.handlePointerdown=function(t){0===t.button&&(null!=t.pointerId&&this.adapter.setPointerCapture(t.pointerId),this.adapter.registerEventHandler("pointermove",this.moveListener),this.handleDown(t))},e.prototype.handleInputChange=function(t){var e=Number(this.adapter.getInputValue(t));t===vT.START?this.setValueStart(e):this.setValue(e),this.adapter.emitChangeEvent(t===vT.START?this.valueStart:this.value,t),this.adapter.emitInputEvent(t===vT.START?this.valueStart:this.value,t)},e.prototype.handleInputFocus=function(t){if(this.adapter.addThumbClass(ST,t),this.isDiscrete&&(this.adapter.addThumbClass(ET,t),this.isRange)){var e=t===vT.START?vT.END:vT.START;this.adapter.addThumbClass(ET,e)}},e.prototype.handleInputBlur=function(t){if(this.adapter.removeThumbClass(ST,t),this.isDiscrete&&(this.adapter.removeThumbClass(ET,t),this.isRange)){var e=t===vT.START?vT.END:vT.START;this.adapter.removeThumbClass(ET,e)}},e.prototype.handleDragStart=function(t,e,i){var r,n;this.adapter.emitDragStartEvent(e,i),this.adapter.focusInput(i),(null===(n=(r=this.adapter).shouldHideFocusStylesForPointerEvents)||void 0===n?void 0:n.call(r))&&this.handleInputFocus(i),t.preventDefault()},e.prototype.getThumbFromDownEvent=function(t,e){if(!this.isRange)return vT.END;var i=this.adapter.getThumbBoundingClientRect(vT.START),r=this.adapter.getThumbBoundingClientRect(vT.END),n=t>=i.left&&t<=i.right,a=t>=r.left&&t<=r.right;return n&&a?null:n?vT.START:a?vT.END:e<this.valueStart?vT.START:e>this.value?vT.END:e-this.valueStart<=this.value-e?vT.START:vT.END},e.prototype.getThumbFromMoveEvent=function(t){if(null!==this.thumb)return this.thumb;if(null===this.downEventClientX)throw new Error("`downEventClientX` is null after move event.");return Math.abs(this.downEventClientX-t)<MT?this.thumb:t<this.downEventClientX?this.adapter.isRTL()?vT.END:vT.START:this.adapter.isRTL()?vT.START:vT.END},e.prototype.updateUI=function(t){t?this.updateThumbAndInputAttributes(t):(this.updateThumbAndInputAttributes(vT.START),this.updateThumbAndInputAttributes(vT.END)),this.updateThumbAndTrackUI(t),this.updateValueIndicatorUI(t),this.updateTickMarksUI()},e.prototype.updateThumbAndInputAttributes=function(t){if(t){var e=this.isRange&&t===vT.START?this.valueStart:this.value,i=String(e);this.adapter.setInputAttribute(DT,i,t),this.isRange&&t===vT.START?this.adapter.setInputAttribute(RT,String(e+this.minRange),vT.END):this.isRange&&t===vT.END&&this.adapter.setInputAttribute(zT,String(e-this.minRange),vT.START),this.adapter.getInputValue(t)!==i&&this.adapter.setInputValue(i,t);var r=this.adapter.getValueToAriaValueTextFn();r&&this.adapter.setInputAttribute(LT,r(e,t),t)}},e.prototype.updateValueIndicatorUI=function(t){if(this.isDiscrete){var e=this.isRange&&t===vT.START?this.valueStart:this.value;this.adapter.setValueIndicatorText(e,t===vT.START?vT.START:vT.END),!t&&this.isRange&&this.adapter.setValueIndicatorText(this.valueStart,vT.START)}},e.prototype.updateTickMarksUI=function(){if(this.isDiscrete&&this.hasTickMarks){var t=(this.valueStart-this.min)/this.step,e=(this.value-this.valueStart)/this.step+1,i=(this.max-this.value)/this.step,r=Array.from({length:t}).fill(_T.INACTIVE),n=Array.from({length:e}).fill(_T.ACTIVE),a=Array.from({length:i}).fill(_T.INACTIVE);this.adapter.updateTickMarks(r.concat(n).concat(a))}},e.prototype.mapClientXOnSliderScale=function(t){var e=(t-this.rect.left)/this.rect.width;this.adapter.isRTL()&&(e=1-e);var i=this.min+e*(this.max-this.min);return i===this.max||i===this.min?i:Number(this.quantize(i).toFixed(this.numDecimalPlaces))},e.prototype.quantize=function(t){var e=Math.round((t-this.min)/this.step);return this.min+e*this.step},e.prototype.updateValue=function(t,e,i){var r=(void 0===i?{}:i).emitInputEvent;if(t=this.clampValue(t,e),this.isRange&&e===vT.START){if(this.valueStart===t)return;this.valueStart=t}else{if(this.value===t)return;this.value=t}this.updateUI(e),r&&this.adapter.emitInputEvent(e===vT.START?this.valueStart:this.value,e)},e.prototype.clampValue=function(t,e){return t=Math.min(Math.max(t,this.min),this.max),this.isRange&&e===vT.START&&t>this.value-this.minRange?this.value-this.minRange:this.isRange&&e===vT.END&&t<this.valueStart+this.minRange?this.valueStart+this.minRange:t},e.prototype.updateThumbAndTrackUI=function(t){var e=this,i=this.max,r=this.min,n=(this.value-this.valueStart)/(i-r),a=n*this.rect.width,s=this.adapter.isRTL(),o=YT?bT(window,"transform"):"transform";if(this.isRange){var l=this.adapter.isRTL()?(i-this.value)/(i-r)*this.rect.width:(this.valueStart-r)/(i-r)*this.rect.width,c=l+a;this.animFrame.request(xT.SLIDER_UPDATE,(function(){!s&&t===vT.START||s&&t!==vT.START?(e.adapter.setTrackActiveStyleProperty("transform-origin","right"),e.adapter.setTrackActiveStyleProperty("left","auto"),e.adapter.setTrackActiveStyleProperty("right",e.rect.width-c+"px")):(e.adapter.setTrackActiveStyleProperty("transform-origin","left"),e.adapter.setTrackActiveStyleProperty("right","auto"),e.adapter.setTrackActiveStyleProperty("left",l+"px")),e.adapter.setTrackActiveStyleProperty(o,"scaleX("+n+")");var i=s?c:l,r=e.adapter.isRTL()?l:c;t!==vT.START&&t&&e.initialStylesRemoved||(e.adapter.setThumbStyleProperty(o,"translateX("+i+"px)",vT.START),e.alignValueIndicator(vT.START,i)),t!==vT.END&&t&&e.initialStylesRemoved||(e.adapter.setThumbStyleProperty(o,"translateX("+r+"px)",vT.END),e.alignValueIndicator(vT.END,r)),e.removeInitialStyles(s),e.updateOverlappingThumbsUI(i,r,t)}))}else this.animFrame.request(xT.SLIDER_UPDATE,(function(){var t=s?e.rect.width-a:a;e.adapter.setThumbStyleProperty(o,"translateX("+t+"px)",vT.END),e.alignValueIndicator(vT.END,t),e.adapter.setTrackActiveStyleProperty(o,"scaleX("+n+")"),e.removeInitialStyles(s)}))},e.prototype.alignValueIndicator=function(t,e){if(this.isDiscrete){var i=this.adapter.getThumbBoundingClientRect(t).width/2,r=this.adapter.getValueIndicatorContainerWidth(t),n=this.adapter.getBoundingClientRect().width;r/2>e+i?(this.adapter.setThumbStyleProperty(BT,i+"px",t),this.adapter.setThumbStyleProperty(FT,"auto",t),this.adapter.setThumbStyleProperty(NT,"translateX(-50%)",t),this.adapter.setThumbStyleProperty(HT,"0",t),this.adapter.setThumbStyleProperty(VT,"auto",t),this.adapter.setThumbStyleProperty(UT,"none",t)):r/2>n-e+i?(this.adapter.setThumbStyleProperty(BT,"auto",t),this.adapter.setThumbStyleProperty(FT,i+"px",t),this.adapter.setThumbStyleProperty(NT,"translateX(50%)",t),this.adapter.setThumbStyleProperty(HT,"auto",t),this.adapter.setThumbStyleProperty(VT,"0",t),this.adapter.setThumbStyleProperty(UT,"none",t)):(this.adapter.setThumbStyleProperty(BT,"50%",t),this.adapter.setThumbStyleProperty(FT,"auto",t),this.adapter.setThumbStyleProperty(NT,"translateX(-50%)",t),this.adapter.setThumbStyleProperty(HT,"50%",t),this.adapter.setThumbStyleProperty(VT,"auto",t),this.adapter.setThumbStyleProperty(UT,"translateX(-50%)",t))}},e.prototype.removeInitialStyles=function(t){if(!this.initialStylesRemoved){var e=t?"right":"left";this.adapter.removeThumbStyleProperty(e,vT.END),this.isRange&&this.adapter.removeThumbStyleProperty(e,vT.START),this.initialStylesRemoved=!0,this.resetTrackAndThumbAnimation()}},e.prototype.resetTrackAndThumbAnimation=function(){var t=this;if(this.isDiscrete){var e=YT?bT(window,"transition"):"transition",i="none 0s ease 0s";this.adapter.setThumbStyleProperty(e,i,vT.END),this.isRange&&this.adapter.setThumbStyleProperty(e,i,vT.START),this.adapter.setTrackActiveStyleProperty(e,i),requestAnimationFrame((function(){t.adapter.removeThumbStyleProperty(e,vT.END),t.adapter.removeTrackActiveStyleProperty(e),t.isRange&&t.adapter.removeThumbStyleProperty(e,vT.START)}))}},e.prototype.updateOverlappingThumbsUI=function(t,e,i){var r=!1;if(this.adapter.isRTL()){var n=t-this.startThumbKnobWidth/2;r=e+this.endThumbKnobWidth/2>=n}else{r=t+this.startThumbKnobWidth/2>=e-this.endThumbKnobWidth/2}r?(this.adapter.addThumbClass(CT,i||vT.END),this.adapter.removeThumbClass(CT,i===vT.START?vT.END:vT.START)):(this.adapter.removeThumbClass(CT,vT.START),this.adapter.removeThumbClass(CT,vT.END))},e.prototype.convertAttributeValueToNumber=function(t,e){if(null===t)throw new Error("MDCSliderFoundation: `"+e+"` must be non-null.");var i=Number(t);if(isNaN(i))throw new Error("MDCSliderFoundation: `"+e+"` value is `"+t+"`, but must be a number.");return i},e.prototype.validateProperties=function(t){var e=t.min,i=t.max,r=t.value,n=t.valueStart,a=t.step,s=t.minRange;if(e>=i)throw new Error("MDCSliderFoundation: min must be strictly less than max. Current: [min: "+e+", max: "+i+"]");if(a<=0)throw new Error("MDCSliderFoundation: step must be a positive number. Current step: "+a);if(this.isRange){if(r<e||r>i||n<e||n>i)throw new Error("MDCSliderFoundation: values must be in [min, max] range. Current values: [start value: "+n+", end value: "+r+", min: "+e+", max: "+i+"]");if(n>r)throw new Error("MDCSliderFoundation: start value must be <= end value. Current values: [start value: "+n+", end value: "+r+"]");if(s<0)throw new Error("MDCSliderFoundation: minimum range must be non-negative. Current min range: "+s);if(r-n<s)throw new Error("MDCSliderFoundation: start value and end value must differ by at least "+s+". Current values: [start value: "+n+", end value: "+r+"]");var o=(n-e)/a,l=(r-e)/a;if(!Number.isInteger(parseFloat(o.toFixed(6)))||!Number.isInteger(parseFloat(l.toFixed(6))))throw new Error("MDCSliderFoundation: Slider values must be valid based on the step value ("+a+"). Current values: [start value: "+n+", end value: "+r+", min: "+e+"]")}else{if(r<e||r>i)throw new Error("MDCSliderFoundation: value must be in [min, max] range. Current values: [value: "+r+", min: "+e+", max: "+i+"]");l=(r-e)/a;if(!Number.isInteger(parseFloat(l.toFixed(6))))throw new Error("MDCSliderFoundation: Slider value must be valid based on the step value ("+a+"). Current value: "+r)}},e.prototype.registerEventHandlers=function(){this.adapter.registerWindowEventHandler("resize",this.resizeListener),e.SUPPORTS_POINTER_EVENTS?(this.adapter.registerEventHandler("pointerdown",this.pointerdownListener),this.adapter.registerEventHandler("pointerup",this.pointerupListener)):(this.adapter.registerEventHandler("mousedown",this.mousedownOrTouchstartListener),this.adapter.registerEventHandler("touchstart",this.mousedownOrTouchstartListener)),this.isRange&&(this.adapter.registerThumbEventHandler(vT.START,"mouseenter",this.thumbMouseenterListener),this.adapter.registerThumbEventHandler(vT.START,"mouseleave",this.thumbMouseleaveListener),this.adapter.registerInputEventHandler(vT.START,"change",this.inputStartChangeListener),this.adapter.registerInputEventHandler(vT.START,"focus",this.inputStartFocusListener),this.adapter.registerInputEventHandler(vT.START,"blur",this.inputStartBlurListener)),this.adapter.registerThumbEventHandler(vT.END,"mouseenter",this.thumbMouseenterListener),this.adapter.registerThumbEventHandler(vT.END,"mouseleave",this.thumbMouseleaveListener),this.adapter.registerInputEventHandler(vT.END,"change",this.inputEndChangeListener),this.adapter.registerInputEventHandler(vT.END,"focus",this.inputEndFocusListener),this.adapter.registerInputEventHandler(vT.END,"blur",this.inputEndBlurListener)},e.prototype.deregisterEventHandlers=function(){this.adapter.deregisterWindowEventHandler("resize",this.resizeListener),e.SUPPORTS_POINTER_EVENTS?(this.adapter.deregisterEventHandler("pointerdown",this.pointerdownListener),this.adapter.deregisterEventHandler("pointerup",this.pointerupListener)):(this.adapter.deregisterEventHandler("mousedown",this.mousedownOrTouchstartListener),this.adapter.deregisterEventHandler("touchstart",this.mousedownOrTouchstartListener)),this.isRange&&(this.adapter.deregisterThumbEventHandler(vT.START,"mouseenter",this.thumbMouseenterListener),this.adapter.deregisterThumbEventHandler(vT.START,"mouseleave",this.thumbMouseleaveListener),this.adapter.deregisterInputEventHandler(vT.START,"change",this.inputStartChangeListener),this.adapter.deregisterInputEventHandler(vT.START,"focus",this.inputStartFocusListener),this.adapter.deregisterInputEventHandler(vT.START,"blur",this.inputStartBlurListener)),this.adapter.deregisterThumbEventHandler(vT.END,"mouseenter",this.thumbMouseenterListener),this.adapter.deregisterThumbEventHandler(vT.END,"mouseleave",this.thumbMouseleaveListener),this.adapter.deregisterInputEventHandler(vT.END,"change",this.inputEndChangeListener),this.adapter.deregisterInputEventHandler(vT.END,"focus",this.inputEndFocusListener),this.adapter.deregisterInputEventHandler(vT.END,"blur",this.inputEndBlurListener)},e.prototype.handlePointerup=function(){this.handleUp(),this.adapter.deregisterEventHandler("pointermove",this.moveListener)},e.SUPPORTS_POINTER_EVENTS=YT&&Boolean(window.PointerEvent)&&!(["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document),e}(vt);function qT(t){var e=/(?:\.(\d+))?(?:[eE]([+\-]?\d+))?$/.exec(String(t));if(!e)return 0;var i=e[1]||"",r=e[2]||0;return Math.max(0,("0"===i?0:i.length)-Number(r))}class WT extends hi{constructor(){super(...arguments),this.mdcFoundationClass=ZT,this.disabled=!1,this.min=0,this.max=100,this.valueEnd=0,this.name="",this.step=1,this.withTickMarks=!1,this.discrete=!1,this.tickMarks=[],this.trackTransformOriginStyle="",this.trackLeftStyle="",this.trackRightStyle="",this.trackTransitionStyle="",this.endThumbWithIndicator=!1,this.endThumbTop=!1,this.shouldRenderEndRipple=!1,this.endThumbTransformStyle="",this.endThumbTransitionStyle="",this.endThumbCssProperties={},this.valueToAriaTextTransform=null,this.valueToValueIndicatorTransform=t=>`${t}`,this.boundMoveListener=null,this.endRippleHandlers=new de((()=>(this.shouldRenderEndRipple=!0,this.endRipple)))}update(t){if(t.has("valueEnd")&&this.mdcFoundation){this.mdcFoundation.setValue(this.valueEnd);const t=this.mdcFoundation.getValue();t!==this.valueEnd&&(this.valueEnd=t)}t.has("discrete")&&(this.discrete||(this.tickMarks=[])),super.update(t)}render(){return this.renderRootEl(M`
      ${this.renderStartInput()}
      ${this.renderEndInput()}
      ${this.renderTrack()}
      ${this.renderTickMarks()}
      ${this.renderStartThumb()}
      ${this.renderEndThumb()}`)}renderRootEl(t){const e=Ot({"mdc-slider--disabled":this.disabled,"mdc-slider--discrete":this.discrete});return M`
    <div
        class="mdc-slider ${e}"
        @pointerdown=${this.onPointerdown}
        @pointerup=${this.onPointerup}
        @contextmenu=${this.onContextmenu}>
      ${t}
    </div>`}renderStartInput(){return R}renderEndInput(){var t;return M`
      <input
          class="mdc-slider__input end"
          type="range"
          step=${this.step}
          min=${this.min}
          max=${this.max}
          .value=${this.valueEnd}
          @change=${this.onEndChange}
          @focus=${this.onEndFocus}
          @blur=${this.onEndBlur}
          ?disabled=${this.disabled}
          name=${this.name}
          aria-label=${Ke(this.ariaLabel)}
          aria-labelledby=${Ke(this.ariaLabelledBy)}
          aria-describedby=${Ke(this.ariaDescribedBy)}
          aria-valuetext=${Ke(null===(t=this.valueToAriaTextTransform)||void 0===t?void 0:t.call(this,this.valueEnd))}>
    `}renderTrack(){return R}renderTickMarks(){return this.withTickMarks?M`
      <div class="mdc-slider__tick-marks">
        ${this.tickMarks.map((t=>{const e=t===_T.ACTIVE;return M`<div class="${e?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive"}"></div>`}))}
      </div>`:R}renderStartThumb(){return R}renderEndThumb(){const t=Ot({"mdc-slider__thumb--with-indicator":this.endThumbWithIndicator,"mdc-slider__thumb--top":this.endThumbTop}),e=se(Object.assign({"-webkit-transform":this.endThumbTransformStyle,transform:this.endThumbTransformStyle,"-webkit-transition":this.endThumbTransitionStyle,transition:this.endThumbTransitionStyle,left:this.endThumbTransformStyle||"rtl"===getComputedStyle(this).direction?"":`calc(${(this.valueEnd-this.min)/(this.max-this.min)*100}% - 24px)`,right:this.endThumbTransformStyle||"rtl"!==getComputedStyle(this).direction?"":`calc(${(this.valueEnd-this.min)/(this.max-this.min)*100}% - 24px)`},this.endThumbCssProperties)),i=this.shouldRenderEndRipple?M`<mwc-ripple class="ripple" unbounded></mwc-ripple>`:R;return M`
      <div
          class="mdc-slider__thumb end ${t}"
          style=${e}
          @mouseenter=${this.onEndMouseenter}
          @mouseleave=${this.onEndMouseleave}>
        ${i}
        ${this.renderValueIndicator(this.valueToValueIndicatorTransform(this.valueEnd))}
        <div class="mdc-slider__thumb-knob"></div>
      </div>
    `}renderValueIndicator(t){return this.discrete?M`
    <div class="mdc-slider__value-indicator-container" aria-hidden="true">
      <div class="mdc-slider__value-indicator">
        <span class="mdc-slider__value-indicator-text">
          ${t}
        </span>
      </div>
    </div>`:R}disconnectedCallback(){super.disconnectedCallback(),this.mdcFoundation&&this.mdcFoundation.destroy()}createAdapter(){}async firstUpdated(){super.firstUpdated(),await this.layout(!0)}updated(t){super.updated(t),this.mdcFoundation&&(t.has("disabled")&&this.mdcFoundation.setDisabled(this.disabled),t.has("min")&&this.mdcFoundation.setMin(this.min),t.has("max")&&this.mdcFoundation.setMax(this.max),t.has("step")&&this.mdcFoundation.setStep(this.step),t.has("discrete")&&this.mdcFoundation.setIsDiscrete(this.discrete),t.has("withTickMarks")&&this.mdcFoundation.setHasTickMarks(this.withTickMarks))}async layout(t=!1){var e;null===(e=this.mdcFoundation)||void 0===e||e.layout({skipUpdateUI:t}),this.requestUpdate(),await this.updateComplete}onEndChange(t){var e;this.valueEnd=Number(t.target.value),null===(e=this.mdcFoundation)||void 0===e||e.handleInputChange(vT.END)}onEndFocus(){var t;null===(t=this.mdcFoundation)||void 0===t||t.handleInputFocus(vT.END),this.endRippleHandlers.startFocus()}onEndBlur(){var t;null===(t=this.mdcFoundation)||void 0===t||t.handleInputBlur(vT.END),this.endRippleHandlers.endFocus()}onEndMouseenter(){var t;null===(t=this.mdcFoundation)||void 0===t||t.handleThumbMouseenter(),this.endRippleHandlers.startHover()}onEndMouseleave(){var t;null===(t=this.mdcFoundation)||void 0===t||t.handleThumbMouseleave(),this.endRippleHandlers.endHover()}onPointerdown(t){this.layout(),this.mdcFoundation&&(this.mdcFoundation.handlePointerdown(t),this.boundMoveListener=this.mdcFoundation.handleMove.bind(this.mdcFoundation),this.mdcRoot.addEventListener("pointermove",this.boundMoveListener))}onPointerup(){this.mdcFoundation&&(this.mdcFoundation.handleUp(),this.boundMoveListener&&(this.mdcRoot.removeEventListener("pointermove",this.boundMoveListener),this.boundMoveListener=null))}onContextmenu(t){t.preventDefault()}setFormData(t){this.name&&t.append(this.name,`${this.valueEnd}`)}}it([ht("input.end")],WT.prototype,"formElement",void 0),it([ht(".mdc-slider")],WT.prototype,"mdcRoot",void 0),it([ht(".end.mdc-slider__thumb")],WT.prototype,"endThumb",void 0),it([ht(".end.mdc-slider__thumb .mdc-slider__thumb-knob")],WT.prototype,"endThumbKnob",void 0),it([ht(".end.mdc-slider__thumb .mdc-slider__value-indicator-container")],WT.prototype,"endValueIndicatorContainer",void 0),it([pt(".end .ripple")],WT.prototype,"endRipple",void 0),it([ot({type:Boolean,reflect:!0})],WT.prototype,"disabled",void 0),it([ot({type:Number})],WT.prototype,"min",void 0),it([ot({type:Number})],WT.prototype,"max",void 0),it([ot({type:Number})],WT.prototype,"valueEnd",void 0),it([ot({type:String})],WT.prototype,"name",void 0),it([ot({type:Number})],WT.prototype,"step",void 0),it([ot({type:Boolean})],WT.prototype,"withTickMarks",void 0),it([ot({type:Boolean})],WT.prototype,"discrete",void 0),it([lt()],WT.prototype,"tickMarks",void 0),it([lt()],WT.prototype,"trackTransformOriginStyle",void 0),it([lt()],WT.prototype,"trackLeftStyle",void 0),it([lt()],WT.prototype,"trackRightStyle",void 0),it([lt()],WT.prototype,"trackTransitionStyle",void 0),it([lt()],WT.prototype,"endThumbWithIndicator",void 0),it([lt()],WT.prototype,"endThumbTop",void 0),it([lt()],WT.prototype,"shouldRenderEndRipple",void 0),it([lt()],WT.prototype,"endThumbTransformStyle",void 0),it([lt()],WT.prototype,"endThumbTransitionStyle",void 0),it([lt()],WT.prototype,"endThumbCssProperties",void 0),it([Xe,ot({type:String,attribute:"aria-label"})],WT.prototype,"ariaLabel",void 0),it([Xe,ot({type:String,attribute:"aria-labelledby"})],WT.prototype,"ariaLabelledBy",void 0),it([Xe,ot({type:String,attribute:"aria-describedby"})],WT.prototype,"ariaDescribedBy",void 0);class GT extends WT{get value(){return this.valueEnd}set value(t){this.valueEnd=t}renderTrack(){const t=se({"transform-origin":this.trackTransformOriginStyle,left:this.trackLeftStyle,right:this.trackRightStyle,"-webkit-transform":`scaleX(${(this.valueEnd-this.min)/(this.max-this.min)})`,transform:`scaleX(${(this.valueEnd-this.min)/(this.max-this.min)})`,"-webkit-transition":this.trackTransitionStyle,transition:this.trackTransitionStyle});return M`
      <div class="mdc-slider__track">
        <div class="mdc-slider__track--inactive"></div>
        <div class="mdc-slider__track--active">
          <div
              class="mdc-slider__track--active_fill"
              style=${t}>
          </div>
        </div>
      </div>`}createAdapter(){return{addClass:t=>{if("mdc-slider--disabled"===t)this.disabled=!0},removeClass:t=>{if("mdc-slider--disabled"===t)this.disabled=!1},hasClass:t=>{switch(t){case"mdc-slider--disabled":return this.disabled;case"mdc-slider--discrete":return this.discrete;default:return!1}},addThumbClass:(t,e)=>{if(e!==vT.START&&"mdc-slider__thumb--with-indicator"===t)this.endThumbWithIndicator=!0},removeThumbClass:(t,e)=>{if(e!==vT.START&&"mdc-slider__thumb--with-indicator"===t)this.endThumbWithIndicator=!1},registerEventHandler:()=>{},deregisterEventHandler:()=>{},registerBodyEventHandler:(t,e)=>{document.body.addEventListener(t,e)},deregisterBodyEventHandler:(t,e)=>{document.body.removeEventListener(t,e)},registerInputEventHandler:(t,e,i)=>{t!==vT.START&&this.formElement.addEventListener(e,i)},deregisterInputEventHandler:(t,e,i)=>{t!==vT.START&&this.formElement.removeEventListener(e,i)},registerThumbEventHandler:()=>{},deregisterThumbEventHandler:()=>{},registerWindowEventHandler:(t,e)=>{window.addEventListener(t,e)},deregisterWindowEventHandler:(t,e)=>{window.addEventListener(t,e)},emitChangeEvent:(t,e)=>{if(e===vT.START)return;const i=new CustomEvent("change",{bubbles:!0,composed:!0,detail:{value:t,thumb:e}});this.dispatchEvent(i)},emitDragEndEvent:(t,e)=>{e!==vT.START&&this.endRippleHandlers.endPress()},emitDragStartEvent:(t,e)=>{e!==vT.START&&this.endRippleHandlers.startPress()},emitInputEvent:(t,e)=>{if(e===vT.START)return;const i=new CustomEvent("input",{bubbles:!0,composed:!0,detail:{value:t,thumb:e}});this.dispatchEvent(i)},focusInput:t=>{t!==vT.START&&this.formElement.focus()},getAttribute:()=>"",getBoundingClientRect:()=>this.mdcRoot.getBoundingClientRect(),getInputAttribute:(t,e)=>{if(e===vT.START)return null;switch(t){case"min":return this.min.toString();case"max":return this.max.toString();case"value":return this.valueEnd.toString();case"step":return this.step.toString();default:return null}},getInputValue:t=>t===vT.START?"":this.valueEnd.toString(),getThumbBoundingClientRect:t=>t===vT.START?this.getBoundingClientRect():this.endThumb.getBoundingClientRect(),getThumbKnobWidth:t=>t===vT.START?0:this.endThumbKnob.getBoundingClientRect().width,getValueIndicatorContainerWidth:t=>t===vT.START?0:this.endValueIndicatorContainer.getBoundingClientRect().width,getValueToAriaValueTextFn:()=>this.valueToAriaTextTransform,isInputFocused:t=>{if(t===vT.START)return!1;const e=$t();return e[e.length-1]===this.formElement},isRTL:()=>"rtl"===getComputedStyle(this).direction,setInputAttribute:(t,e,i)=>{vT.START},removeInputAttribute:t=>{},setThumbStyleProperty:(t,e,i)=>{if(i!==vT.START)switch(t){case"transform":case"-webkit-transform":this.endThumbTransformStyle=e;break;case"transition":case"-webkit-transition":this.endThumbTransitionStyle=e;break;default:t.startsWith("--")&&(this.endThumbCssProperties[t]=e)}},removeThumbStyleProperty:(t,e)=>{if(e!==vT.START)switch(t){case"left":case"right":break;case"transition":case"-webkit-transition":this.endThumbTransitionStyle=""}},setTrackActiveStyleProperty:(t,e)=>{switch(t){case"transform-origin":this.trackTransformOriginStyle=e;break;case"left":this.trackLeftStyle=e;break;case"right":this.trackRightStyle=e;break;case"transform":case"-webkit-transform":break;case"transition":case"-webkit-transition":this.trackTransitionStyle=e}},removeTrackActiveStyleProperty:t=>{switch(t){case"transition":case"-webkit-transition":this.trackTransitionStyle=""}},setInputValue:(t,e)=>{e!==vT.START&&(this.valueEnd=Number(t))},setPointerCapture:t=>{this.mdcRoot.setPointerCapture(t)},setValueIndicatorText:()=>{},updateTickMarks:t=>{this.tickMarks=t}}}}it([ot({type:Number})],GT.prototype,"value",null);let XT=class extends GT{};XT.styles=[gT],XT=it([at("mwc-slider")],XT);window.customElements.define("grampsjs-form-edit-map-layer",class extends lh{static get styles(){return[super.styles,n`
        mwc-dialog {
          --mdc-dialog-min-width: 80vw;
        }

        mwc-slider {
          width: 100%;
        }
      `]}static get properties(){return{opacity:{type:Number},state:{type:String},pinCoordinates:{type:Array}}}constructor(){super(),this.opacity=.6,this.state="",this.pinCoordinates=[]}_getBounds(){const[t]=(this.data.attribute_list||[]).filter((t=>"map:bounds"===t.type));return void 0===t?[]:JSON.parse(t.value)}_getLatCenter(){const t=this._getBounds();return 2!==t.length?50:(t[0][0]+t[1][0])/2}_getLongCenter(){const t=this._getBounds();return 2!==t.length?50:(t[0][1]+t[1][1])/2}_getZoom(){const t=this._getBounds();if(2!==t.length)return 1;const e=t[0][0],i=t[0][1],r=t[1][0],n=t[1][1]-i,a=r-e,s=Math.max(n,a);return Math.round(Math.log2(360/s))}_getLogWidth(){const t=this._getBounds();if(2!==t.length)return Math.round(10*Math.log(.1))/10;const e=t[1][1]-t[0][1];return Math.round(10*Math.log(e))/10}renderForm(){return M`
    Scale<br/>
    <mwc-slider
      value="${this._getLogWidth()}"
      min="-6.9"
      max="5.2"
      step="0.1"
      @input="${this._handleScaleSlider}"
    ></mwc-slider>
    Opacity<br/>
    <mwc-slider
      value="0.8"
      min="0.0"
      max="1.0"
      step="0.05"
      @input="${this._handleOpacitySlider}"
    ></mwc-slider>
    <p>
      <mwc-button
        class="edit"
        icon="pin_drop"
        ?unelevated="${"placeMarker"===this.state}"
        @click="${this._handleClickPinBtn}"
      >${this._("Select a point on the map")}</mwc-button>
      ${2===this.pinCoordinates.length?M`
              <mwc-button
                class="edit"
                icon="pin_drop"
                ?unelevated="${"alignImage"===this.state}"
                @click="${this._handleClickAlignBtn}"
                >${this._("Align the image")}</mwc-button
              >
            `:""}
    </p>
    <grampsjs-map
      latitude="${2===this.pinCoordinates.length?this.pinCoordinates[0]:this._getLatCenter()}"
      longitude="${2===this.pinCoordinates.length?this.pinCoordinates[1]:this._getLongCenter()}"
      zoom="${this._getZoom()}"
      layerSwitcher
      mapid="media-map"
      id="map"
      @click="${this._handleMapClick}"
    >
      ${2===this._getBounds().length?M` <grampsjs-map-overlay
              url="${Vn(this.data.handle)}"
              opacity="${this.opacity}"
              title="${this.data.desc}"
              .bounds="${this._getBounds()}"
            ></grampsjs-map-overlay>`:""}
      ${2===this.pinCoordinates.length?M`
              <grampsjs-map-marker
                latitude="${this.pinCoordinates[0]}"
                longitude="${this.pinCoordinates[1]}"
              ></grampsjs-map-marker>
            `:""}
          </grampsjs-map-overlay>
    </grampsjs-map>
  `}_handleClickPinBtn(){"placeMarker"!==this.state?this.state="placeMarker":this.state=""}_handleClickAlignBtn(){"alignImage"!==this.state?this.state="alignImage":this.state=""}_handleScaleSlider(t){this._setScale(Math.exp(t.detail.value))}_handleOpacitySlider(t){this.opacity=t.detail.value}_setScale(t){const e=this._getBounds();if(2!==e.length)return;const i=e[1][1]-e[0][1],r=e[1][0],n=e[0][1],a=2===this.pinCoordinates.length?this.pinCoordinates:[r,n],s=t/i,o=[[a[0]+(e[0][0]-a[0])*s,a[1]+(e[0][1]-a[1])*s],[a[0]+(e[1][0]-a[0])*s,a[1]+(e[1][1]-a[1])*s]];this._setBounds(o)}_handleMapClick(t){const e=this.shadowRoot.querySelector("grampsjs-map");if(null!==e){const i=e._map.mouseEventToLatLng(t);"placeMarker"===this.state&&(this.pinCoordinates=[i.lat,i.lng],this.state="",t.preventDefault(),t.stopPropagation(),0===this._getBounds().length&&this._placeImage(i.lat,i.lng,.1)),"alignImage"===this.state&&(this._alignToPin(i.lat,i.lng),this.state="",t.preventDefault(),t.stopPropagation())}}_placeImage(t,e,i){const r=Vn(this.data.handle),n=new Image;n.onload=()=>{const r=n.naturalWidth,a=n.naturalHeight/r*i*Math.cos(t/180*Math.PI);this._setBounds([[t-a,e],[t,e+i]])},n.src=r}_setTopLeft(t,e){const i=this._getBounds();if(2!==i.length)return;const r=[[t-(i[1][0]-i[0][0]),e],[t,e+(i[1][1]-i[0][1])]];this._setBounds(r)}_alignToPin(t,e){if(2!==this.pinCoordinates.length)return;const[i,r]=this.pinCoordinates,n=this._getBounds(),a=i-t,s=r-e,o=[[n[0][0]+a,n[0][1]+s],[n[1][0]+a,n[1][1]+s]];this._setBounds(o)}_setBounds(t){let[e]=(this.data.attribute_list||[]).filter((t=>"map:bounds"===t.type));e||(e={}),this.data={...this.data,attribute_list:[...(this.data.attribute_list||[]).filter((t=>"map:bounds"!==t.type)),{...e,type:"map:bounds",value:JSON.stringify(t)}]}}});window.customElements.define("grampsjs-faces",class extends fm{renderContent(){return M`
      <grampsjs-rect-container .strings="${this.strings}">
        <slot></slot>
        ${this.rectHidden?"":this._getFaces().map((t=>ms(t,this.selectedRect)||this.deletedRects.some((e=>ms(t,e)))?"":M`
                    <grampsjs-rect
                      muted
                      .rect="${t}"
                      label="?"
                      target=""
                      @click="${()=>this._handleRectClick(t)}"
                    >
                    </grampsjs-rect>
                  `))}
      </grampsjs-rect-container>
    `}_handleRectClick(t){os(this,"rect:selected",t)}_getFaces(){return this._data.data?this._data.data.map((t=>{const[e,i,r,n]=t,a=r-e,s=n-i;return[Math.round(e-.15*a),Math.round(i-.37*s),Math.round(r+.15*a),Math.round(n+.37*s)]})):[]}static get properties(){return{handle:{type:String},selectedRect:{type:Array},deletedRects:{type:Array},rectHidden:{type:Boolean}}}constructor(){super(),this.handle="",this.selectedRect=[],this.deletedRects=[],this.rectHidden=!1,this.renderOnError=!0}getUrl(){return`/api/media/${this.handle}/face_detection`}});const KT={afr:"Afrikaans",amh:"",ara:"",asm:"",aze:"Azrbaycanca",aze_cyrl:"",bel:"",ben:"",bod:"",bos:"Bosanski",bre:"Brezhoneg",bul:"",cat:"Catal",ceb:"Sinugboanon",ces:"etina",chi_sim:"",chi_tra:"",chr:"",cos:"Corsu",cym:"Cymraeg",dan:"Dansk",dan_frak:"Dansk - Fraktur",deu:"Deutsch",deu_frak:"Deutsch - Fraktur",dzo:"",ell:"",eng:"English",enm:"English, Middle",epo:"Esperanto",est:"Eesti",eus:"Euskara",fao:"Froyskt",fas:"",fil:"Wikang Filipino",fin:"Suomi",fra:"Franais",frk:"Deutsch - Fraktur",frm:"Franais, Moyen",fry:"Frysk",gla:"Gidhlig",gle:"Gaeilge",glg:"Galego",grc:"",guj:"",hat:"Kreyl Ayisyen",heb:"",hin:"",hrv:"Hrvatski",hun:"Magyar",hye:"",iku:"",ind:"Bahasa Indonesia",isl:"slenska",ita:"Italiano",ita_old:"Italiano - Vecchio",jav:"Basa Jawa",jpn:"",kan:"",kat:"",kat_old:" - ",kaz:"",khm:"",kir:"",kmr:"Kurmanji",kor:"",kor_vert:" ()",kur:"",lao:"",lat:"Latina",lav:"Latvieu",lit:"Lietuvi",ltz:"Ltzebuergesch",mal:"",mar:"",mkd:"",mlt:"Malti",mon:"",mri:"Te Reo Mori",msa:"Bahasa Malaysia",mya:"",nep:"",nld:"Nederlands",nor:"Norsk",oci:"Occitan",ori:"",pan:"",pol:"Polski",por:"Portugus",pus:"",que:"Runasimi",ron:"Romn",rus:"",san:"",sin:"",slk:"Slovenina",slk_frak:"Slovenina - Fraktur",slv:"Slovenina",snd:"",spa:"Espaol",spa_old:"Espaol - Antiguo",sqi:"Shqip",srp:"",srp_latn:"Srpski - Latinica",sun:"Basa Sunda",swa:"Kiswahili",swe:"Svenska",syr:"",tam:"",tat:"",tel:"",tgk:"",tgl:"Filipino",tha:"",tir:"",ton:"lea faka-Tonga",tur:"Trke",uig:"",ukr:"",urd:"",uzb:"Ozbek",uzb_cyrl:"",vie:"Ting Vit",yid:"",yor:"Yorb"},JT={ar:"ara",bg:"bul",br:"bre",ca:"cat",cs:"ces",da:"dan",de_AT:"deu",de:"deu",el:"ell",en_GB:"eng",en:"eng",eo:"epo",es:"spa",fi:"fin",fr:"fra",ga:"gle",he:"heb",hr:"hrv",hu:"hun",is:"isl",it:"ita",ja:"jpn",lt:"lit",lv:"lav",mk:"mkd",nb:"nor",nl:"nld",nn:"nld",pl:"pol",pt_BR:"por",pt_PT:"por",ro:"ron",ru:"rus",sk:"slk",sl:"slv",sq:"sqi",sr:"srp",sv:"swe",ta:"tam",tr:"tur",uk:"ukr",vi:"vie",zh_CN:"chi_sim",zh_HK:"chi_tra",zh_TW:"chi_tra"};class QT extends(al(K)){static get styles(){return[nl,n`
        .result {
          font-family: var(
            --grampsjs-note-font-family,
            var(--grampsjs-body-font-family)
          );
          font-size: var(--grampsjs-note-font-size, 17px);
          line-height: var(--grampsjs-note-line-height, 1.5em);
          color: var(--grampsjs-note-color, #000000);
          white-space: pre-wrap;
        }
      `]}static get properties(){return{handle:{type:String},options:{type:Object},languages:{type:Array},canEdit:{type:Boolean},_string:{type:String}}}constructor(){super(),this.options={},this.handle="",this.languages=[],this.canEdit=!1,this._string=""}render(){return M`
      <p>
        <mwc-select
          outlined
          label="${this._("Language")}"
          @change="${this._handleLangChange}"
        >
          ${this.languages.map((t=>M`
              <mwc-list-item
                value="${t}"
                ?selected=${t===this.options.lang}
                >${KT[t]||t}</mwc-list-item
              >
            `))}
        </mwc-select>
      </p>
      <p>
        <mwc-button
          raised
          @click="${this._handleRun}"
          ?disabled="${this._isDisabled()}"
          >${this._("Run")}</mwc-button
        >
        <grampsjs-task-progress-indicator
          id="indicator-ocr"
          taskName="runOcr"
          class="button"
          size="20"
          hideAfter="10"
          @task:complete="${this._handleTaskComplete}"
        ></grampsjs-task-progress-indicator>
      </p>
      <p class="result">${this._string??""}</p>
      ${this._string&&this.canEdit?M`
            <p>
              <mwc-button raised @click="${this._handleSaveAsNote}"
                >${this._("Save as Note")}</mwc-button
              >
            </p>
          `:""}
    `}firstUpdated(){this._setLangInitial()}_setLangInitial(){const t=this.strings.__lang__??"";if(!t)return;const e=JT[t]??"";e&&(this.options={...this.options,lang:e})}_isDisabled(){return!(this.options.lang&&this.handle)}_handleLangChange(t){this.options={...this.options,lang:t.target.value}}async _handleRun(){const t=this.renderRoot.querySelector("#indicator-ocr");t.reset(),t.open=!0;const e=new URLSearchParams(this.options).toString(),i=`/api/media/${this.handle}/ocr?${e}`,r=await Nn(i);"error"in r?(t.setError(),t.errorMessage=r.error):"task"in r?t.taskId=r.task?.id||"":(this._string=r.data||"",t.setComplete())}_handleTaskComplete(t){const{status:e}=t.detail,i=JSON.parse(e.result||{});this._string=i||""}async _handleSaveAsNote(){const t={_class:"Note",type:{_class:"NoteType",string:"Transcript"},text:{_class:"StyledText",string:this._string}},e=await Nn("/api/notes/",t);if("error"in e)os(this,"grampsjs:error",{message:e.error});else{const[t]=e.data,i=t?.new?.gramps_id,r=t?.handle;i&&r&&os(this,"edit:action",{action:"addNoteRef",data:{data:[r]}})}}}window.customElements.define("grampsjs-text-recognition",QT);window.customElements.define("grampsjs-media-object",class extends Gk{static get styles(){return[super.styles,n`
        :host {
        }

        grampsjs-img {
          margin: 30px 0;
        }

        dl::after {
          content: '';
          display: block;
          clear: both;
        }

        .controls {
          margin-top: 1em;
        }

        .hidden {
          visibility: hidden;
        }

        .controls span {
          display: inline-block;
          margin-left: 0.6em;
        }

        .ocr {
          padding: 1em 1em;
          border-radius: 16px;
          background-color: rgba(109, 76, 65, 0.12);
        }

        .close-icon {
          float: right;
          size: 12px;
          margin-right: -0.5em;
          margin-top: -0.5em;
          color: var(--mdc-theme-primary);
        }
      `]}static get properties(){return{selectedRect:{type:Object},deletedRects:{type:Array},bbox:{type:Object},dbInfo:{type:Object},canEdit:{type:Boolean},_drawing:{type:Boolean},_ocr:{type:Boolean}}}constructor(){super(),this._objectsName="Media Objects",this._objectEndpoint="media",this._objectIcon="photo",this.selectedRect={},this.deletedRects=[],this.bbox={},this.dbInfo={},this.canEdit=!1,this._drawing=!1,this._ocr=!1}renderProfile(){return M`
      <h2>
        ${this.data.desc||this._("Media Object")}
        ${this.edit?M`
              <mwc-icon-button
                icon="edit"
                class="edit"
                @click="${this._handleEditTitle}"
              ></mwc-icon-button>
            `:""}
      </h2>

      <dl>
        ${this.data?.profile?.date||this.edit?M`
              <div>
                <dt>${this._("Date")}</dt>
                <dd>${this.data.profile.date}</dd>
              </div>
              ${this.edit?M`
                    <mwc-icon-button
                      icon="edit"
                      class="edit"
                      @click="${this._handleEditDate}"
                    ></mwc-icon-button>
                  `:""}
            `:""}
      </dl>

      ${this.data?.mime?.startsWith("image")?this.edit?this._renderImageEdit():this._renderImageNoEdit():this._renderNoImage()}
      ${this._ocr?this._renderOcr():""}

      <grampsjs-view-media-lightbox
        id="obj-lightbox-view"
        @rect:clicked="${this._handleRectClick}"
        handle="${this.data.handle}"
        hideLeftArrow
        hideRightArrow
        active
        .strings="${this.strings}"
      >
      </grampsjs-view-media-lightbox>
    `}_renderImageEdit(){const t=!this.selectedRect?.rect?.length;return M`
      <p class="controls">
        <span style="position: relative; top: 5px;">
          <grampsjs-form-select-object
            fixedMenuPosition
            objectType="person"
            .strings="${this.strings}"
            id="face-select"
            label="${this._("Person")}"
            ?disabled="${t}"
            class="edit"
            @select-object:changed="${this._handleFacePerson}"
          ></grampsjs-form-select-object>
        </span>
        <span>
          <mwc-icon-button
            class="edit"
            icon="delete"
            ?disabled="${t}"
            @click="${this._handleFaceDelete}"
          ></mwc-icon-button>
        </span>
        <span>
          <mwc-icon-button
            class="edit"
            icon="deselect"
            ?disabled="${t&&!this._drawing}"
            @click="${this._handleFaceDeselect}"
          ></mwc-icon-button>
          <mwc-icon-button
            class="edit"
            ?disabled="${this._drawing}"
            @click="${this._handleEnableDraw}"
            >${Ha("M13,17H17V13H19V17H23V19H19V23H17V19H13V17M11,17V19H9V17H11M7,17V19H5V17H7M19,9V11H17V9H19M19,5V7H17V5H19M15,5V7H13V5H15M11,5V7H9V5H11M7,5V7H5V5H7M7,13V15H5V13H7M7,9V11H5V9H7Z","")}</mwc-icon-button
          >
        </span>
      </p>

      <grampsjs-rect-container
        .strings="${this.strings}"
        ?draw="${this._drawing}"
        @rect:draw="${this._handleDrawRec}"
      >
        <grampsjs-faces
          handle="${this.data.handle}"
          ?rectHidden="${this._drawing}"
          .selectedRect="${this.selectedRect?.rect||[]}"
          .deletedRects="${[...this.deletedRects,...this._getRectangles().map((t=>t.rect))]}"
          .strings="${this.strings}"
          @rect:selected="${this._handleRectSelected}"
          slot="image"
        >
          <grampsjs-img
            handle="${this.data.handle}"
            size="1000"
            border
            mime="${this.data.mime}"
          ></grampsjs-img>
          ${this.selectedRect?.rect?.length?M`<grampsjs-rect
                selected
                .rect="${this.selectedRect.rect}"
                label="?"
                target=""
              >
              </grampsjs-rect>`:""}
        </grampsjs-faces>

        ${this._drawing?"":this._getRectangles().map((t=>M`
            <grampsjs-rect
              .rect="${t.rect}"
              label="${t.label}"
              target="${t.type}/${t.grampsId}"
              ?selected="${ms(t.rect,this.selectedRect?.rect||[])}"
              ?resizable="${!1}"
              @rect:clicked="${e=>this._handeRectClickedEdit(e,t)}"
            >
            </grampsjs-rect>
          </grampsjs-rect-container>

            `))}
      </grampsjs-rect-container>

      <p>
        <grampsjs-form-upload
          @formdata:changed="${this._handleFormData}"
          preview
          id="upload"
          label="${this._("Replace file")}"
          class="edit"
          .strings="${this.strings}"
        ></grampsjs-form-upload>
      </p>
    `}_handleFormData(t){os(this,"file:replace",{...t.detail,handle:this.data.handle}),t.stopPropagation(),t.preventDefault();const e=this.renderRoot.getElementById("upload");e&&e.reset()}_renderNoImage(){return M`
      <grampsjs-img
        handle="${this.data.handle}"
        size="1000"
        class="link"
        border
        mime="${this.data.mime}"
        @click=${this._handleClick}
      ></grampsjs-img>
    `}_renderImageNoEdit(){return M`
      <grampsjs-rect-container
        .strings="${this.strings}"
        @rect:clicked="${this._handleRectClick}"
      >
        <grampsjs-img
          handle="${this.data.handle}"
          size="1000"
          class="link"
          border
          mime="${this.data.mime}"
          @click=${this._handleClick}
        ></grampsjs-img>

        ${this._getRectangles().map((t=>M`
            <grampsjs-rect
              .rect="${t.rect}"
              label="${t.label}"
              target="${t.type}/${t.grampsId}"
            >
            </grampsjs-rect>
          `))}
      </grampsjs-rect-container>

      ${this.dbInfo?.server?.ocr?M`
            <p>
              <mwc-button raised @click="${this._handleOcrClick}"
                >${Ha("M2 4C2 2.9 2.9 2 4 2H8V4H4V8H2V4M22 20C22 21.11 21.11 22 20 22H16V20H20V16H22V20M4 22C2.9 22 2 21.11 2 20V16H4V20H8V22H4M20 2C21.11 2 22 2.9 22 4V8H20V4H16V2H20M9 7V9H11V17H13V9H15V7H9Z","var(--mdc-theme-on-primary)",0,"icon")}
                ${this._("Text Recognition")}</mwc-button
              >
            </p>
          `:""}
    `}_handleOcrClick(){this._ocr=!0}_handleCloseOcrClick(){this._ocr=!1}_renderOcr(){return M` <div class="ocr">
      <span class="close-icon">
        <mwc-icon-button
          icon="close"
          @click="${this._handleCloseOcrClick}"
        ></mwc-icon-button>
      </span>
      <grampsjs-text-recognition
        ?canEdit="${this.canEdit}"
        .languages="${this.dbInfo?.server?.ocr_languages??[]}"
        handle="${this.data.handle??""}"
        .strings="${this.strings}"
      ></grampsjs-text-recognition>
    </div>`}_handleFaceDeselect(t){this.selectedRect={},this._drawing=!1,t.stopPropagation()}_handleEnableDraw(t){this.selectedRect={},this._drawing=!0,t.stopPropagation()}_handleDrawRec(t){this.selectedRect={rect:t.detail.rect}}_handleFaceDelete(t){"handle"in this.selectedRect?os(this,"rect:delete",{objHandle:this.selectedRect.handle,objType:this.selectedRect.type,mediaHandle:this.data.handle,rect:this.selectedRect.rect}):this.deletedRects=[...this.deletedRects,this.selectedRect.rect],this.selectedRect={},t.stopPropagation()}_handleRectSelected(t){this.selectedRect={rect:t.detail},t.stopPropagation()}_handeRectClickedEdit(t,e){this.selectedRect=e,t.stopPropagation()}async _handleFacePerson(t){this._drawing=!1;const[e]=t.detail.objects;t.stopPropagation();os(this,"facetag:add",{personHandle:e.handle,mediaHandle:this.data.handle,rect:this.selectedRect.rect,oldHandle:this.selectedRect.handle,oldType:this.selectedRect.type}),this.selectedRect={}}_handleEditTitle(){this.dialogContent=M`
      <grampsjs-form-edit-title
        @object:save="${this._handleSaveTitle}"
        @object:cancel="${this._handleCancelDialog}"
        .strings=${this.strings}
        .data=${{desc:this.data?.desc||""}}
        prop="desc"
      >
      </grampsjs-form-edit-title>
    `}_handleEditDate(){this.dialogContent=M`
    <grampsjs-form-edit-date
      @object:save="${this._handleSaveDate}"
      @object:cancel="${this._handleCancelDialog}"
      .strings=${this.strings}
      .data=${{date:this.data.date}}
    >
    </grampsjs-form-edit-title>
    `}_handleSaveTitle(t){os(this,"edit:action",{action:"updateProp",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleSaveDate(t){os(this,"edit:action",{action:"updateProp",data:t.detail.data}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleEditGeo(){this.dialogContent=M`
      <grampsjs-form-edit-map-layer
        @object:save="${this._handleSaveMap}"
        @object:cancel="${this._handleCancelDialog}"
        .strings="${this.strings}"
        .data="${this.data}"
      ></grampsjs-form-edit-map-layer>
    `}_getRectangles(){const t=this.data?.extended?.backlinks||{},e=this.data?.profile?.references||{};return 0===Object.keys(t).length?[]:Object.keys(t).map((i=>t[i].map(((t,r)=>{const n=i in e?e[i]:[],a=n.length>=r?ss(n[r]||{},i,this.strings):"...";return{rect:t?.media_list?.find((t=>t.ref===this.data.handle))?.rect,type:i,label:a,grampsId:t.gramps_id,handle:t.handle}})))).flat().filter((t=>t?.rect?.length>0))}_handleSaveMap(t){const e=t.detail?.data?.attribute_list||[];e.length>0&&os(this,"edit:action",{action:"updateProp",data:{attribute_list:e}}),t.preventDefault(),t.stopPropagation(),this.dialogContent=""}_handleClick(){this.shadowRoot.getElementById("obj-lightbox-view").open()}_handleRectClick(t){this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:t.detail.target}}))}reloadImage(){this.renderRoot.querySelectorAll("grampsjs-img").forEach((t=>t.reload()))}updated(t){t.has("edit")&&(this.selectedRect={},this.deletedRects=[],this._drawing=!1)}});window.customElements.define("grampsjs-view-media",class extends Ym{static get properties(){return{dbInfo:{type:Object}}}constructor(){super(),this.dbInfo={},this._className="media"}getUrl(){return`/api/media/?gramps_id=${this.grampsId}&locale=${this.strings?.__lang__||"en"}&backlinks=true&extend=all&profile=all`}renderElement(){return M`
      <grampsjs-media-object
        .data=${this._data}
        .strings=${this.strings}
        .dbInfo=${this.dbInfo}
        ?canEdit="${this.canEdit}"
        ?edit="${this.edit}"
        @facetag:add="${this._handleFacePerson}"
        @rect:delete="${this._handleDeleteRect}"
        @file:replace="${this._handleUploadFile}"
      ></grampsjs-media-object>
    `}async _handleFacePerson(t){const e=t.detail;t.stopPropagation(),"personHandle"in e&&(e.oldHandle?(await this.addMediaRefToPerson(e.personHandle,e.mediaHandle,e.rect,!1,!1),await this.delMediaRef(e.oldHandle,e.oldType,e.mediaHandle,e.rect,!1),this._updateData(!1)):this.addMediaRefToPerson(e.personHandle,e.mediaHandle,e.rect))}async _handleDeleteRect(t){const e=t.detail;t.stopPropagation(),"objHandle"in e&&this.delMediaRef(e.objHandle,e.objType,e.mediaHandle,e.rect)}async addMediaRefToPerson(t,e,i,r=!0,n=!0){const a=`/api/people/${t}`;let s=await On(a);if("error"in s)return;const o={_class:"Person",...s.data},l={ref:e,rect:i};o.media_list=[...o.media_list.filter((t=>t.ref!==e)),l],s=await Fn(a,o,!0,n),"error"in s||r&&this._updateData(!1)}async delMediaRef(t,e,i,r,n=!0){const a=`/api/${is[e]}/${t}`;let s=await On(a);if("error"in s)return;const o=s.data;o.media_list=o.media_list.filter((t=>!ms(t.rect,r)||t.ref!==i)),s=await Fn(a,o),"error"in s||n&&this._updateData(!1)}_handleUploadFile(t){Fn(`/api/media/${t.detail.handle}/file`,t.detail.data,!1).then((t=>{"data"in t?(this.error=!1,this._updateData(),this._reloadImage()):"error"in t&&(this.error=!0,this._errorMessage=t.error)}))}_reloadImage(){this.renderRoot.querySelectorAll("grampsjs-media-object").forEach((t=>t.reloadImage()))}});class tS extends(al(K)){static get styles(){return[nl,n`
        mwc-button {
          --mdc-typography-button-text-transform: none;
          --mdc-typography-button-font-weight: 400;
          --mdc-typography-button-letter-spacing: 0px;
          --mdc-typography-button-font-size: 13px;
        }
      `]}static get properties(){return{icon:{type:String},checked:{type:Boolean}}}constructor(){super(),this.icon="",this.checked=!1}render(){return M`
      <mwc-button
        dense
        ?unelevated="${this.checked}"
        icon="${this.icon}"
        @click="${this.toggle}"
      >
        <slot></slot>
      </mwc-button>
    `}toggle(){this.checked=!this.checked,os(this,"grampsjs-button-toggle:toggle",{checked:this.checked})}}window.customElements.define("grampsjs-button-toggle",tS);window.customElements.define("grampsjs-view-search",class extends $d{static get styles(){return[super.styles,n`
        #search-field-container {
          text-align: center;
          display: flex;
          align-items: center;
          justify-content: center;
          max-width: 100%;
          min-width: 80%;
          clear: left;
        }

        .mode-toggle {
          float: right;
        }

        mwc-textfield#search-field {
          --mdc-shape-small: 28px;
          --mdc-typography-subtitle1-font-size: 22px;
          --mdc-typography-subtitle1-font-weight: 300;
          --mdc-text-field-idle-line-color: rgba(0, 0, 0, 0.2);
          width: calc(100% - 70px);
          margin: 30px auto;
        }

        #search-field-container mwc-icon-button {
          color: rgba(0, 0, 0, 0.5);
          --mdc-icon-size: 26px;
          --mdc-icon-button-size: 55px;
          position: relative;
          top: -2px;
        }

        grampsjs-button-toggle {
          margin-right: 0.35em;
          margin-bottom: 0.35em;
          display: inline-block;
        }
      `]}static get properties(){return{semantic:{type:Boolean},dbInfo:{type:Object},_data:{type:Array},_totalCount:{type:Number},_page:{type:Number},_pages:{type:Number},_objectTypes:{type:Object}}}constructor(){super(),this.semantic=!1,this.dbInfo={},this._data=[],this._totalCount=-1,this._page=1,this._pages=-1,this._objectTypes=Object.fromEntries(Object.keys(is).filter((t=>"tag"!==t)).map((t=>[t,!0])))}renderContent(){return M`
      ${this._semanticEnabled()?this._renderModeToggle():""}

      <h2>${this._("Search")}</h2>

      <div id="search-field-container">
        <mwc-textfield
          id="search-field"
          outlined
          icon="search"
          @keydown="${this._handleSearchKey}"
        >
        </mwc-textfield>
        <mwc-icon-button icon="search" @click="${()=>this._executeSearch()}">
        </mwc-icon-button>
      </div>

      ${this.renderFilters()}
      ${-1!==this._totalCount||Object.values(this._objectTypes).some(Boolean)?"":M`<p>${this._("Select at least one object type")}</p>`}
      ${0===this._totalCount?M`<p>${this._("No items")}</p>`:""}
      ${this._totalCount>0?M`<p>Total: ${this._totalCount}</p>`:""}
      <grampsjs-search-result-list
        .data="${this._data}"
        .strings="${this.strings}"
        large
        noSep
        linked
      ></grampsjs-search-result-list>

      ${this._totalCount>0?M`
            <grampsjs-pagination
              page="${this._page}"
              pages="${this._pages}"
              .strings="${this.strings}"
              @page:changed="${this._handlePageChanged}"
            ></grampsjs-pagination>
          `:""}
    `}_renderModeToggle(){return M`
      <div class="mode-toggle">
        <grampsjs-button-group>
          <mwc-button
            dense
            ?unelevated="${!this.semantic}"
            @click="${this._handleModeClick}"
            >${this._("full-text")}</mwc-button
          >
          <mwc-button
            dense
            ?unelevated="${this.semantic}"
            @click="${this._handleModeClick}"
            >${this._("semantic")}</mwc-button
          >
        </grampsjs-button-group>
      </div>
    `}async _handleModeClick(){this.semantic=!this.semantic,this._executeSearch()}renderFilters(){return M`
      <div @grampsjs-button-toggle:toggle="${this._handleFilterToggle}">
        <grampsjs-button-toggle
          ?checked="${Object.values(this._objectTypes).every(Boolean)}"
          icon=""
          id="toggle-all"
        >
          ${this._("All")}
        </grampsjs-button-toggle>
        ${Object.keys(this._objectTypes).map((t=>{return M`<grampsjs-button-toggle
            ?checked="${this._objectTypes[t]}"
            icon="${es[t]}"
            id="toggle-${t}"
          >
            ${this._((e=is[t],`${e.charAt(0).toUpperCase()}${e.slice(1)}`))}
          </grampsjs-button-toggle>`;var e}))}
      </div>
    `}_semanticEnabled(){return!!this.dbInfo?.server?.semantic_search&&!!this.dbInfo?.search?.sifts?.count_semantic}_handleFilterToggle(t){const e=t.target.id.split("-",2)[1];this._objectTypes="all"===e?Object.fromEntries(Object.keys(this._objectTypes).map((e=>[e,t.detail.checked]))):{...this._objectTypes,[e]:t.detail.checked},this._page=1,as((()=>this._executeSearch()),500)()}_handlePageChanged(t){this._page=t.detail.page}firstUpdated(){this._focus()}_focus(t=!0){if(this.active){const e=this.shadowRoot.getElementById("search-field");try{e.focus()}catch(e){t&&window.setTimeout((()=>this._focus(!1)),100)}}}_unfocus(){if(this.active){const t=this.shadowRoot.getElementById("search-field");try{t.blur()}catch(t){window.setTimeout((()=>this._blur(!1)),100)}}}_clearBox(){this.shadowRoot.getElementById("search-field").value=""}_clearAll(){this._clearBox(),this._data=[],this._totalCount=-1}_clearPage(){this._data=[]}update(t){super.update(t),t.has("active")&&this._focus(),t.has("_page")&&this._totalCount>0&&(this.loading=!0,this._executeSearch(this._page))}_handleSearchKey(t){if("Enter"===t.code&&this._executeSearch(),"Escape"===t.code){""===this.shadowRoot.getElementById("search-field").value?this._unfocus():this._clearBox()}}_executeSearch(t=1){let e=this.shadowRoot.getElementById("search-field").value;if(""!==e){if(!Object.values(this._objectTypes).every(Boolean)){if(!Object.values(this._objectTypes).some(Boolean))return this._data=[],void(this._totalCount=-1);window._oldSearchBackend&&(e=this._filterQueryByObjectType(e))}this.loading=!0,this._fetchData(e,t)}else this._clearAll()}_filterQueryByObjectType(t){return`${t} (${Object.keys(this._objectTypes).filter((t=>this._objectTypes[t])).map((t=>`type:${t}`)).join(" OR ")})`}_pageFirst(){this._page=1}_pagePrev(){this._page-=1}_pageNext(){this._page+=1}_pageLast(){this._page=this._pages}async _fetchData(t,e){let i=`/api/search/?query=${t}&locale=${this.strings?.__lang__||"en"}&profile=all&page=${e}&pagesize=20`;if(this._semanticEnabled()&&(i=`${i}&semantic=${this.semantic?1:0}`),!window._oldSearchBackend){i=`${i}&type=${Object.keys(this._objectTypes).filter((t=>this._objectTypes[t])).join(",")}`}const r=await On(i);this.loading=!1,"data"in r?(this.error=!1,this._data=r.data,this._totalCount=parseInt(r.total_count,10),this._pages=Math.ceil(this._totalCount/20)):"error"in r&&(this.error=!0,this._errorMessage=r.error)}connectedCallback(){super.connectedCallback(),window.addEventListener("nav",(t=>this._handleNav(t)))}_handleNav(t){"search"===t.detail.path&&this._focus()}});class eS extends $d{static get styles(){return[super.styles,n`
        .red {
          --mdc-button-outline-color: #c62828;
          --mdc-theme-primary: #c62828;
        }

        mwc-select {
          width: 100%;
          max-width: 30em;
          margin-bottom: 10px;
        }

        #complete-button {
          margin-top: 25px;
        }
      `]}static get properties(){return{homePersonDetails:{type:Object},requireHomePerson:{type:Boolean},_translations:{type:Array},_settings:{type:Object},_langLoading:{type:Boolean},_peopleLoading:{type:Boolean}}}constructor(){super(),this.homePersonDetails={},this.requireHomePerson=!1,this._translations=[],this._settings=Mn(),this._langLoading=!1,this._peopleLoading=!1}renderContent(){return M`
      <h3>${this._("Select language")}</h3>

      ${this.renderLangSelect()}

      <h3>${this._("Set _Home Person")}</h3>

      ${this.renderPersonSelect()}

      <mwc-button
        raised
        id="complete-button"
        label="${this._("Complete")}"
        icon="check_circle"
        ?disabled="${!this._isCompleted()}"
        @click=${()=>this._doSubmit()}
      ></mwc-button>
    `}_isCompleted(){return!(this.requireHomePerson&&!this._settings.homePerson||!this._settings.lang)}_doSubmit(){this.dispatchEvent(new CustomEvent("onboarding:completed",{bubbles:!0,composed:!0}))}renderPersonSelect(){return M`
      <p>
        <grampsjs-form-object-list
          .strings="${this.strings}"
          .objects=${this.homePersonDetails?.handle?[this.homePersonDetails]:[]}
          id="homeperson-list"
        ></grampsjs-form-object-list>
      </p>
      <p>
        <grampsjs-form-select-object
          @select-object:changed="${this._handleHomePerson}"
          objectType="person"
          .strings="${this.strings}"
          id="homeperson-select"
          label="${this._("Select")}"
          ?disabled="${this._peopleLoading}"
        ></grampsjs-form-select-object>
      </p>
    `}_handleHomePerson(t){const e=t.detail.objects[0];e.object?.gramps_id&&(Ln({homePerson:e.object.gramps_id},!0),this._handleStorage(),this.homePersonDetails=e),t.preventDefault(),t.stopPropagation()}renderLangSelect(){return M`
      <mwc-select
        id="select-language"
        label="${this._langLoading?this._("Loading items..."):this._("Language")}"
        @selected="${this._handleLangSelected}"
        ?disabled="${this._langLoading}"
      >
        ${this._translations.map((t=>M`
            <mwc-list-item
              value="${t.language}"
              ?selected="${t.language===this._settings.lang}"
              >${t.native}</mwc-list-item
            >
          `),this)}
      </mwc-select>
    `}_handleLangSelected(t){const e=t.detail.index;if(null!=e&&e<this._translations.length){Ln({lang:this._translations[e].language}),this._handleStorage()}}connectedCallback(){super.connectedCallback(),window.addEventListener("storage",this._handleStorage.bind(this))}_handleStorage(){this._settings=Mn(),window.dispatchEvent(new CustomEvent("settings:changed",{bubbles:!0,composed:!0}))}firstUpdated(){this.active&&(this._fetchDataLang(),this._fetchDataHomePerson())}update(t){super.update(t),t.has("active")&&this.active&&(this._langLoading||0!==this._translations.length||this._fetchDataLang(),this._peopleLoading||this.homePersonDetails?.object?.grampd_id===this._settings.homePerson||this._fetchDataHomePerson())}async _fetchDataLang(){this.loading=!0,this._langLoading=!0;const t=await On("/api/translations/");if("data"in t)this.error=!1,this._translations=t.data;else if("error"in t)return this.error=!0,void(this._errorMessage=t.error);this._langLoading=!1,this._peopleLoading||(this.loading=!1)}async _fetchDataHomePerson(){if(this._settings.homePerson&&this.homePersonDetails?.object?.grampd_id!==this._settings.homePerson){this.loading=!0,this._peopleLoading=!0;const t=await On(`/api/people/?locale=${this.strings?.__lang__||"en"}&gramps_id=${this._settings.homePerson}&profile=self&extend=media_list`);if("data"in t){this.error=!1;const[e]=t.data;void 0!==e&&(this.homePersonDetails={object_type:"person",object:e,handle:e.handle})}else"error"in t&&(this.error=!0,this._errorMessage=t.error);this._peopleLoading=!1,this._langLoading||(this.loading=!1)}}}window.customElements.define("grampsjs-view-settings-onboarding",eS);window.customElements.define("grampsjs-task-progress-indicator",class extends yd{static get properties(){return{taskId:{type:String},taskName:{type:String},pollInterval:{type:Number},hideAfter:{type:Number},status:{type:Object}}}constructor(){super(),this.taskId="",this.taskName="",this.pollInterval=1,this.hideAfter=10,this.status={}}firstUpdated(){this.open=!!this.taskId,this.fetchData()}update(t){super.update(t),t.has("taskId")&&(this.reset(),this.open=!!this.taskId,this.fetchData())}fetchData(){this.taskId&&(this.taskName&&function(t,e){const i=An(),r=Xn();Object.hasOwn(r,i)?r[i][t]=e:r[i]={[t]:e};const n=JSON.stringify(r);localStorage.setItem("tasks",n)}(this.taskName,this.taskId),qn(this.taskId,(t=>{this.status=t,"SUCCESS"===t.state?this.setComplete():"FAILURE"===t.state||"REVOKED"===t.state?this.setError():"PROGRESS"===t.state&&(this.progress=t.result_object?.progress??-1,this.infoMessage=`${t.result_object?.title??""}\n          ${t.result_object?.title?"<br>":""}\n          ${t.result_object?.message??""}\n          ${t.result_object?.message?"<br>":""}\n          ${Math.floor(100*this.progress)}%`)}),1e3*this.pollInterval))}setComplete(){this.progress=1,this.closeAfter(),this.taskName&&Kn(this.taskName,this.taskId),os(this,"task:complete",{status:this.status}),this.infoMessage=""}setError(){this.error=!0,this.errorMessage=this.status?.info||"",this.closeAfter(),this.taskName&&Kn(this.taskName,this.taskId),os(this,"task:error",{status:this.status}),this.infoMessage=""}closeAfter(){this.hideAfter>0&&setTimeout((()=>{this.open=!1}),1e3*this.hideAfter)}_handleStorage(){this.taskName&&(this.taskId&&this.open||this._restoreState())}_restoreState(){const t=function(){try{const t=localStorage.getItem("tasks"),e=JSON.parse(t)??{},i=An();return i?e[i]:{}}catch(t){return{}}}();this.taskName&&t?.[this.taskName]&&(this.taskId=t[this.taskName])}connectedCallback(){super.connectedCallback(),window.addEventListener("storage",this._handleStorage.bind(this)),this._restoreState()}});class iS extends(al(K)){static get styles(){return[nl,n`
        .hidden {
          display: none;
        }
      `]}static get properties(){return{_state:{type:Object},_mediaState:{type:Object},_uploadHint:{type:String}}}constructor(){super(),this._state=0,this._uploadHint=""}render(){return M`
      <h3>${this._("Import Family Tree")}</h3>

      <p>
        <grampsjs-form-upload
          outlined
          id="upload-tree"
          .strings="${this.strings}"
          filename
          @formdata:changed="${this._handleUploadChanged}"
        ></grampsjs-form-upload>
      </p>
      ${this._uploadHint?M`${this._uploadHint}`:""}
      <p>
        <mwc-button
          raised
          label="${this._("Import")}"
          type="submit"
          @click="${this._submit}"
          ?disabled=${1!==this._state}
        ></mwc-button>
        <grampsjs-task-progress-indicator
          id="progress-tree"
          taskName="importFile"
          ?open="${0!==this._state&&1!==this._state}"
          class="button"
          size="20"
          hideAfter="0"
          pollInterval="0.2"
          @task:complete="${this._handleSuccess}"
          @task:error="${()=>this._handleCompleted(-1)}"
        ></grampsjs-task-progress-indicator>
      </p>
    `}async _submit(){if(1===this._state){const t=this.shadowRoot.querySelector("#upload-tree"),e=t.file.name.split(".").pop().toLowerCase();await this._submitTree(e,t.file)}}async _submitTree(t,e){this._state=2;const i=this.renderRoot.querySelector("#progress-tree");i.reset(),i.open=!0;const r=await Nn(`/api/importers/${t}/file`,e,!1,!1);"error"in r?(i.setError(),i.errorMessage=this._(r.error),this._handleCompleted(-1)):"task"in r?i.taskId=r.task?.id||"":(i.setComplete(),this._handleSuccess())}_handleSuccess(){this._handleCompleted(3),os(this,"db:changed",{})}_handleCompleted(t){this._state=t;this.shadowRoot.querySelector("#upload-tree").reset(),this._uploadHint=""}_handleUploadChanged(){const t=this.shadowRoot.querySelector("#upload-tree");if(!t.file?.name)return this._uploadHint="",void(this._state=0);const e=t.file.name.split(".").pop().toLowerCase();return["gpkg","gramps","gw","def","vcf","csv","ged"].includes(e)?"gpkg"===e?(this._uploadHint=M`<p class="alert error">
        ${this._("The Gramps package format (.gpkg) is currently not supported.")}
        ${this._("Please upload a file in Gramps XML (.gramps) format without media files.")}
      </p>`,void(this._state=0)):(this._uploadHint="gramps"!==e?M`<p class="alert warn">
        ${this._("If you intend to synchronize an existing Gramps database with Gramps Web, use the Gramps XML (.gramps) format instead.")}
      </p>`:"",void(this._state=1)):(this._uploadHint=M`<p class="alert error">
        ${this._("Unsupported format")}
      </p>`,void(this._state=0))}}window.customElements.define("grampsjs-import",iS);class rS extends(al(K)){static get styles(){return[nl,n`
        .hidden {
          display: none;
        }
      `]}static get properties(){return{_mediaState:{type:Object},_uploadHint:{type:String}}}constructor(){super(),this._mediaState=0,this._uploadHint=""}render(){return M`
      <h3>${this._("Import Media Files")}</h3>
      <p>
        ${this._("Upload a ZIP archive with files for existing media objects.")}
      </p>

      <p>
        <grampsjs-form-upload
          outlined
          accept="application/zip"
          id="upload-media"
          .strings="${this.strings}"
          filename
          @formdata:changed="${this._handleUploadChangedMedia}"
        ></grampsjs-form-upload>
      </p>
      <p>
        <mwc-button
          raised
          label="${this._("Import")}"
          type="submit"
          @click="${this._submitMedia}"
          ?disabled=${1!==this._mediaState}
        ></mwc-button>
        <grampsjs-task-progress-indicator
          id="progress-media"
          taskName="importMedia"
          ?open="${0!==this._mediaState&&1!==this._mediaState}"
          class="button"
          size="20"
          hideAfter="0"
          pollInterval="0.2"
          @task:complete="${this._handleSuccessMedia}"
          @task:error="${()=>this._handleCompletedMedia(-1)}"
        ></grampsjs-task-progress-indicator>
      </p>
    `}async _submitMedia(){if(1===this._mediaState){const t=this.shadowRoot.querySelector("#upload-media");await this._submitMediaArchive(t.file)}}async _submitMediaArchive(t){this._mediaState=2;const e=this.renderRoot.querySelector("#progress-media");e.reset(),e.open=!0;const i=await Nn("/api/media/archive/upload/zip",t,!1,!1);"error"in i?(e.setError(),e.errorMessage=this._(i.error),this._handleCompletedMedia(-1)):"task"in i?e.taskId=i.task?.id||"":(e.setComplete(),this._handleSuccessMedia())}_handleSuccessMedia(){this._handleCompletedMedia(3),os(this,"media:uploaded")}_handleCompletedMedia(t){this._mediaState=t;this.shadowRoot.querySelector("#upload-media").reset()}_handleUploadChangedMedia(){const t=this.shadowRoot.querySelector("#upload-media");t.file?.name?this._mediaState=1:this._mediaState=0}}window.customElements.define("grampsjs-import-media",rS);const nS=M`<mwc-icon class="success"
  >check_circle</mwc-icon
>`;class aS extends fm{static get styles(){return[nl,n`
        :host {
          font-size: 16px;
          line-height: 28px;
        }

        mwc-icon {
          font-size: 20px;
          color: rgba(0, 0, 0, 0.4);
          top: 3px;
          position: relative;
        }

        .inline {
          display: inline-block;
          margin-right: 1em;
        }

        mwc-circular-progress {
          top: 3px;
          position: relative;
          --mdc-theme-primary: rgba(0, 0, 0, 0.4);
        }
      `]}renderContent(){const t=this._data.data.length,e=this._data.data.filter((t=>!t.checksum)).length;return M`
      <h3>${this._("Media file status")}</h3>

      <span class="inline">
        <mwc-icon>photo</mwc-icon> ${t} ${this._("Media Objects")}
      </span>
      <span class="inline">
        ${t?M`${e?M`${this.errorMessage(this._data.data.filter((t=>!t.checksum)))}`:M`${nS}`}
            ${this._("%s media objects with missing checksum",e)}`:""}
      </span>
    `}renderLoading(){return M` <h3>${this._("Media file status")}</h3>
      <mwc-icon>photo</mwc-icon>
      <mwc-circular-progress
        indeterminate
        density="-7"
      ></mwc-circular-progress>`}errorMessage(t){return M`
      <mwc-icon class="error link" @click="${this._handleErrorClick}"
        >error</mwc-icon
      >
      <mwc-dialog hideActions
        >${t.map((t=>M`<a href="/media/${t.gramps_id}">${t.gramps_id}</a></br>`))}</mwc-dialog
      >
    `}_handleErrorClick(){this.renderRoot.querySelector("mwc-dialog").open=!0}getUrl(){return"/api/media/?keys=checksum,gramps_id&sort=gramps_id"}connectedCallback(){super.connectedCallback(),window.addEventListener("media:uploaded",this._boundUpdateData)}disconnectedCallback(){window.removeEventListener("media:uploaded",this._boundUpdateData),super.disconnectedCallback()}}window.customElements.define("grampsjs-media-status",aS);window.customElements.define("grampsjs-media-file-status",class extends aS{renderContent(){const t=this._data.data.length;return M`
      <span class="inline">
        ${t?M`${this.errorMessage(this._data.data)}`:M`${nS}`}
        ${this._("%s media objects with missing file",t)}
      </span>
    `}renderLoading(){return M` <mwc-circular-progress
      indeterminate
      density="-7"
    ></mwc-circular-progress>`}getUrl(){return"/api/media/?keys=checksum,gramps_id&sort=gramps_id&filemissing=1"}});class sS extends $p{constructor(){super(...arguments),this.inset=!1,this.insetStart=!1,this.insetEnd=!1}}it([jh({type:Boolean,reflect:!0})],sS.prototype,"inset",void 0),it([jh({type:Boolean,reflect:!0,attribute:"inset-start"})],sS.prototype,"insetStart",void 0),it([jh({type:Boolean,reflect:!0,attribute:"inset-end"})],sS.prototype,"insetEnd",void 0);const oS=vh`:host{box-sizing:border-box;color:var(--md-divider-color, var(--md-sys-color-outline-variant, #cac4d0));display:flex;height:var(--md-divider-thickness, 1px);width:100%}:host([inset]),:host([inset-start]){padding-inline-start:16px}:host([inset]),:host([inset-end]){padding-inline-end:16px}:host::before{background:currentColor;content:"";height:100%;width:100%}@media(forced-colors: active){:host::before{background:CanvasText}}
`;let lS=class extends sS{};lS.styles=[oS],lS=it([ph("md-divider")],lS);const cS={dialog:[[[{transform:"translateY(-50px)"},{transform:"translateY(0)"}],{duration:500,easing:jp}]],scrim:[[[{opacity:0},{opacity:.32}],{duration:500,easing:"linear"}]],container:[[[{opacity:0},{opacity:1}],{duration:50,easing:"linear",pseudoElement:"::before"}],[[{height:"35%"},{height:"100%"}],{duration:500,easing:jp,pseudoElement:"::before"}]],headline:[[[{opacity:0},{opacity:0,offset:.2},{opacity:1}],{duration:250,easing:"linear",fill:"forwards"}]],content:[[[{opacity:0},{opacity:0,offset:.2},{opacity:1}],{duration:250,easing:"linear",fill:"forwards"}]],actions:[[[{opacity:0},{opacity:0,offset:.5},{opacity:1}],{duration:300,easing:"linear",fill:"forwards"}]]},dS={dialog:[[[{transform:"translateY(0)"},{transform:"translateY(-50px)"}],{duration:150,easing:Op}]],scrim:[[[{opacity:.32},{opacity:0}],{duration:150,easing:"linear"}]],container:[[[{height:"100%"},{height:"35%"}],{duration:150,easing:Op,pseudoElement:"::before"}],[[{opacity:"1"},{opacity:"0"}],{delay:100,duration:50,easing:"linear",pseudoElement:"::before"}]],headline:[[[{opacity:1},{opacity:0}],{duration:100,easing:"linear",fill:"forwards"}]],content:[[[{opacity:1},{opacity:0}],{duration:100,easing:"linear",fill:"forwards"}]],actions:[[[{opacity:1},{opacity:0}],{duration:100,easing:"linear",fill:"forwards"}]]};class hS extends $p{get open(){return this.isOpen}set open(t){t!==this.isOpen&&(this.isOpen=t,t?(this.setAttribute("open",""),this.show()):(this.removeAttribute("open"),this.close()))}constructor(){super(),this.quick=!1,this.returnValue="",this.getOpenAnimation=()=>cS,this.getCloseAnimation=()=>dS,this.isOpen=!1,this.isOpening=!1,this.isConnectedPromise=this.getIsConnectedPromise(),this.isAtScrollTop=!1,this.isAtScrollBottom=!1,this.nextClickIsFromContent=!1,this.hasHeadline=!1,this.hasActions=!1,this.hasIcon=!1,this.escapePressedWithoutCancel=!1,this.addEventListener("submit",this.handleSubmit),this.addEventListener("focus",(()=>{this.dialog?.focus()})),this.addEventListener("blur",(()=>{this.dialog?.blur()}))}async show(){this.isOpening=!0,await this.isConnectedPromise,await this.updateComplete;const t=this.dialog;if(t.open||!this.isOpening)return void(this.isOpening=!1);this.dispatchEvent(new Event("open",{cancelable:!0}))?(t.showModal(),this.open=!0,this.scroller&&(this.scroller.scrollTop=0),this.querySelector("[autofocus]")?.focus(),await this.animateDialog(this.getOpenAnimation()),this.dispatchEvent(new Event("opened")),this.isOpening=!1):this.open=!1}async close(t=this.returnValue){if(this.isOpening=!1,!this.isConnected)return void(this.open=!1);await this.updateComplete;const e=this.dialog;if(!e.open||this.isOpening)return void(this.open=!1);const i=this.returnValue;this.returnValue=t;this.dispatchEvent(new Event("close",{cancelable:!0}))?(await this.animateDialog(this.getCloseAnimation()),e.close(t),this.open=!1,this.dispatchEvent(new Event("closed"))):this.returnValue=i}connectedCallback(){super.connectedCallback(),this.isConnectedPromiseResolve()}disconnectedCallback(){super.disconnectedCallback(),this.isConnectedPromise=this.getIsConnectedPromise()}render(){const t=this.open&&!(this.isAtScrollTop&&this.isAtScrollBottom),e={"has-headline":this.hasHeadline,"has-actions":this.hasActions,"has-icon":this.hasIcon,scrollable:t,"show-top-divider":t&&!this.isAtScrollTop,"show-bottom-divider":t&&!this.isAtScrollBottom},{ariaLabel:i}=this;return dp`
      <div class="scrim"></div>
      <dialog
        class=${zp(e)}
        aria-label=${i||pp}
        aria-labelledby=${this.hasHeadline?"headline":pp}
        role=${"alert"===this.type?"alertdialog":pp}
        @cancel=${this.handleCancel}
        @click=${this.handleDialogClick}
        @close=${this.handleClose}
        @keydown=${this.handleKeydown}
        .returnValue=${this.returnValue||pp}>
        <div class="container" @click=${this.handleContentClick}>
          <div class="headline">
            <div class="icon" aria-hidden="true">
              <slot name="icon" @slotchange=${this.handleIconChange}></slot>
            </div>
            <h2 id="headline" aria-hidden=${!this.hasHeadline||pp}>
              <slot
                name="headline"
                @slotchange=${this.handleHeadlineChange}></slot>
            </h2>
            <md-divider></md-divider>
          </div>
          <div class="scroller">
            <div class="content">
              <div class="top anchor"></div>
              <slot name="content"></slot>
              <div class="bottom anchor"></div>
            </div>
          </div>
          <div class="actions">
            <md-divider></md-divider>
            <slot name="actions" @slotchange=${this.handleActionsChange}></slot>
          </div>
        </div>
      </dialog>
    `}firstUpdated(){this.intersectionObserver=new IntersectionObserver((t=>{for(const e of t)this.handleAnchorIntersection(e)}),{root:this.scroller}),this.intersectionObserver.observe(this.topAnchor),this.intersectionObserver.observe(this.bottomAnchor)}handleDialogClick(){if(this.nextClickIsFromContent)return void(this.nextClickIsFromContent=!1);!this.dispatchEvent(new Event("cancel",{cancelable:!0}))||this.close()}handleContentClick(){this.nextClickIsFromContent=!0}handleSubmit(t){const e=t.target,{submitter:i}=t;"dialog"===e.method&&i&&this.close(i.getAttribute("value")??this.returnValue)}handleCancel(t){if(t.target!==this.dialog)return;this.escapePressedWithoutCancel=!1;const e=!au(this,t);t.preventDefault(),e||this.close()}handleClose(){this.escapePressedWithoutCancel&&(this.escapePressedWithoutCancel=!1,this.dialog?.dispatchEvent(new Event("cancel",{cancelable:!0})))}handleKeydown(t){"Escape"===t.key&&(this.escapePressedWithoutCancel=!0,setTimeout((()=>{this.escapePressedWithoutCancel=!1})))}async animateDialog(t){if(this.cancelAnimations?.abort(),this.cancelAnimations=new AbortController,this.quick)return;const{dialog:e,scrim:i,container:r,headline:n,content:a,actions:s}=this;if(!(e&&i&&r&&n&&a&&s))return;const{container:o,dialog:l,scrim:c,headline:d,content:h,actions:p}=t,u=[[e,l??[]],[i,c??[]],[r,o??[]],[n,d??[]],[a,h??[]],[s,p??[]]],m=[];for(const[t,e]of u)for(const i of e){const e=t.animate(...i);this.cancelAnimations.signal.addEventListener("abort",(()=>{e.cancel()})),m.push(e)}await Promise.all(m.map((t=>t.finished.catch((()=>{})))))}handleHeadlineChange(t){const e=t.target;this.hasHeadline=e.assignedElements().length>0}handleActionsChange(t){const e=t.target;this.hasActions=e.assignedElements().length>0}handleIconChange(t){const e=t.target;this.hasIcon=e.assignedElements().length>0}handleAnchorIntersection(t){const{target:e,isIntersecting:i}=t;e===this.topAnchor&&(this.isAtScrollTop=i),e===this.bottomAnchor&&(this.isAtScrollBottom=i)}getIsConnectedPromise(){return new Promise((t=>{this.isConnectedPromiseResolve=t}))}}ru(hS),it([jh({type:Boolean})],hS.prototype,"open",null),it([jh({type:Boolean})],hS.prototype,"quick",void 0),it([jh({attribute:!1})],hS.prototype,"returnValue",void 0),it([jh()],hS.prototype,"type",void 0),it([Fh("dialog")],hS.prototype,"dialog",void 0),it([Fh(".scrim")],hS.prototype,"scrim",void 0),it([Fh(".container")],hS.prototype,"container",void 0),it([Fh(".headline")],hS.prototype,"headline",void 0),it([Fh(".content")],hS.prototype,"content",void 0),it([Fh(".actions")],hS.prototype,"actions",void 0),it([Oh()],hS.prototype,"isAtScrollTop",void 0),it([Oh()],hS.prototype,"isAtScrollBottom",void 0),it([Fh(".scroller")],hS.prototype,"scroller",void 0),it([Fh(".top.anchor")],hS.prototype,"topAnchor",void 0),it([Fh(".bottom.anchor")],hS.prototype,"bottomAnchor",void 0),it([Oh()],hS.prototype,"hasHeadline",void 0),it([Oh()],hS.prototype,"hasActions",void 0),it([Oh()],hS.prototype,"hasIcon",void 0);const pS=vh`:host{border-start-start-radius:var(--md-dialog-container-shape-start-start, var(--md-dialog-container-shape, var(--md-sys-shape-corner-extra-large, 28px)));border-start-end-radius:var(--md-dialog-container-shape-start-end, var(--md-dialog-container-shape, var(--md-sys-shape-corner-extra-large, 28px)));border-end-end-radius:var(--md-dialog-container-shape-end-end, var(--md-dialog-container-shape, var(--md-sys-shape-corner-extra-large, 28px)));border-end-start-radius:var(--md-dialog-container-shape-end-start, var(--md-dialog-container-shape, var(--md-sys-shape-corner-extra-large, 28px)));display:contents;margin:auto;max-height:min(560px,100% - 48px);max-width:min(560px,100% - 48px);min-height:140px;min-width:280px;position:fixed;height:fit-content;width:fit-content}dialog{background:rgba(0,0,0,0);border:none;border-radius:inherit;flex-direction:column;height:inherit;margin:inherit;max-height:inherit;max-width:inherit;min-height:inherit;min-width:inherit;outline:none;overflow:visible;padding:0;width:inherit}dialog[open]{display:flex}::backdrop{background:none}.scrim{background:var(--md-sys-color-scrim, #000);display:none;inset:0;opacity:32%;pointer-events:none;position:fixed;z-index:1}:host([open]) .scrim{display:flex}h2{all:unset;align-self:stretch}.headline{align-items:center;color:var(--md-dialog-headline-color, var(--md-sys-color-on-surface, #1d1b20));display:flex;flex-direction:column;font-family:var(--md-dialog-headline-font, var(--md-sys-typescale-headline-small-font, var(--md-ref-typeface-brand, Roboto)));font-size:var(--md-dialog-headline-size, var(--md-sys-typescale-headline-small-size, 1.5rem));line-height:var(--md-dialog-headline-line-height, var(--md-sys-typescale-headline-small-line-height, 2rem));font-weight:var(--md-dialog-headline-weight, var(--md-sys-typescale-headline-small-weight, var(--md-ref-typeface-weight-regular, 400)));position:relative}slot[name=headline]::slotted(*){align-items:center;align-self:stretch;box-sizing:border-box;display:flex;gap:8px;padding:24px 24px 0}.icon{display:flex}slot[name=icon]::slotted(*){color:var(--md-dialog-icon-color, var(--md-sys-color-secondary, #625b71));fill:currentColor;font-size:var(--md-dialog-icon-size, 24px);margin-top:24px;height:var(--md-dialog-icon-size, 24px);width:var(--md-dialog-icon-size, 24px)}.has-icon slot[name=headline]::slotted(*){justify-content:center;padding-top:16px}.scrollable slot[name=headline]::slotted(*){padding-bottom:16px}.scrollable.has-headline slot[name=content]::slotted(*){padding-top:8px}.container{border-radius:inherit;display:flex;flex-direction:column;flex-grow:1;overflow:hidden;position:relative;transform-origin:top}.container::before{background:var(--md-dialog-container-color, var(--md-sys-color-surface-container-high, #ece6f0));border-radius:inherit;content:"";inset:0;position:absolute}.scroller{display:flex;flex:1;flex-direction:column;overflow:hidden;z-index:1}.scrollable .scroller{overflow-y:scroll}.content{color:var(--md-dialog-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-dialog-supporting-text-font, var(--md-sys-typescale-body-medium-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-dialog-supporting-text-size, var(--md-sys-typescale-body-medium-size, 0.875rem));line-height:var(--md-dialog-supporting-text-line-height, var(--md-sys-typescale-body-medium-line-height, 1.25rem));font-weight:var(--md-dialog-supporting-text-weight, var(--md-sys-typescale-body-medium-weight, var(--md-ref-typeface-weight-regular, 400)));height:min-content;position:relative}slot[name=content]::slotted(*){box-sizing:border-box;padding:24px}.anchor{position:absolute}.top.anchor{top:0}.bottom.anchor{bottom:0}.actions{position:relative}slot[name=actions]::slotted(*){box-sizing:border-box;display:flex;gap:8px;justify-content:flex-end;padding:16px 24px 24px}.has-actions slot[name=content]::slotted(*){padding-bottom:8px}md-divider{display:none;position:absolute}.has-headline.show-top-divider .headline md-divider,.has-actions.show-bottom-divider .actions md-divider{display:flex}.headline md-divider{bottom:0}.actions md-divider{top:0}@media(forced-colors: active){dialog{outline:2px solid WindowText}}
`;let uS=class extends hS{};uS.styles=[pS],uS=it([ph("md-dialog")],uS);class mS extends $p{constructor(){super(...arguments),this.disabled=!1,this.alwaysFocusable=!1,this.label="",this.hasIcon=!1}get rippleDisabled(){return this.disabled}focus(t){this.disabled&&!this.alwaysFocusable||super.focus(t)}render(){return dp`
      <div class="container ${zp(this.getContainerClasses())}">
        ${this.renderContainerContent()}
      </div>
    `}updated(t){t.has("disabled")&&void 0!==t.get("disabled")&&this.dispatchEvent(new Event("update-focus",{bubbles:!0}))}getContainerClasses(){return{disabled:this.disabled,"has-icon":this.hasIcon}}renderContainerContent(){return dp`
      ${this.renderOutline()}
      <md-focus-ring part="focus-ring" for=${this.primaryId}></md-focus-ring>
      <md-ripple
        for=${this.primaryId}
        ?disabled=${this.rippleDisabled}></md-ripple>
      ${this.renderPrimaryAction(this.renderPrimaryContent())}
    `}renderOutline(){return dp`<span class="outline"></span>`}renderLeadingIcon(){return dp`<slot name="icon" @slotchange=${this.handleIconChange}></slot>`}renderPrimaryContent(){return dp`
      <span class="leading icon" aria-hidden="true">
        ${this.renderLeadingIcon()}
      </span>
      <span class="label">${this.label}</span>
      <span class="touch"></span>
    `}handleIconChange(t){const e=t.target;this.hasIcon=e.assignedElements({flatten:!0}).length>0}}ru(mS),mS.shadowRootOptions={...$p.shadowRootOptions,delegatesFocus:!0},it([jh({type:Boolean,reflect:!0})],mS.prototype,"disabled",void 0),it([jh({type:Boolean,attribute:"always-focusable"})],mS.prototype,"alwaysFocusable",void 0),it([jh()],mS.prototype,"label",void 0),it([jh({type:Boolean,reflect:!0,attribute:"has-icon"})],mS.prototype,"hasIcon",void 0);class fS extends $p{get chips(){return this.childElements.filter((t=>t instanceof mS))}constructor(){super(),this.internals=this.attachInternals(),this.addEventListener("focusin",this.updateTabIndices.bind(this)),this.addEventListener("update-focus",this.updateTabIndices.bind(this)),this.addEventListener("keydown",this.handleKeyDown.bind(this)),this.internals.role="toolbar"}render(){return dp`<slot @slotchange=${this.updateTabIndices}></slot>`}handleKeyDown(t){const e="ArrowLeft"===t.key,i="ArrowRight"===t.key,r="Home"===t.key,n="End"===t.key;if(!(e||i||r||n))return;const{chips:a}=this;if(a.length<2)return;if(t.preventDefault(),r||n){return a[r?0:a.length-1].focus({trailing:n}),void this.updateTabIndices()}const s="rtl"===getComputedStyle(this).direction?e:i,o=a.find((t=>t.matches(":focus-within")));if(!o){return(s?a[0]:a[a.length-1]).focus({trailing:!s}),void this.updateTabIndices()}const l=a.indexOf(o);let c=s?l+1:l-1;for(;c!==l;){c>=a.length?c=0:c<0&&(c=a.length-1);const t=a[c];if(!t.disabled||t.alwaysFocusable){t.focus({trailing:!s}),this.updateTabIndices();break}s?c++:c--}}updateTabIndices(){const{chips:t}=this;let e;for(const i of t){const t=i.alwaysFocusable||!i.disabled;i.matches(":focus-within")&&t?e=i:(t&&!e&&(e=i),i.tabIndex=-1)}e&&(e.tabIndex=0)}}it([Vh()],fS.prototype,"childElements",void 0);const gS=vh`:host{display:flex;flex-wrap:wrap;gap:8px}
`;let _S=class extends fS{};_S.styles=[gS],_S=it([ph("md-chip-set")],_S);const vS=vh`.elevated{--md-elevation-level: var(--_elevated-container-elevation);--md-elevation-shadow-color: var(--_elevated-container-shadow-color)}.elevated::before{background:var(--_elevated-container-color)}.elevated:hover{--md-elevation-level: var(--_elevated-hover-container-elevation)}.elevated:focus-within{--md-elevation-level: var(--_elevated-focus-container-elevation)}.elevated:active{--md-elevation-level: var(--_elevated-pressed-container-elevation)}.elevated.disabled{--md-elevation-level: var(--_elevated-disabled-container-elevation)}.elevated.disabled::before{background:var(--_elevated-disabled-container-color);opacity:var(--_elevated-disabled-container-opacity)}@media(forced-colors: active){.elevated md-elevation{border:1px solid CanvasText}.elevated.disabled md-elevation{border-color:GrayText}}
`,yS="aria-label-remove";class bS extends mS{get ariaLabelRemove(){if(this.hasAttribute(yS))return this.getAttribute(yS);const{ariaLabel:t}=this;return`Remove ${t||this.label}`}set ariaLabelRemove(t){t!==this.ariaLabelRemove&&(null===t?this.removeAttribute(yS):this.setAttribute(yS,t),this.requestUpdate())}constructor(){super(),this.handleTrailingActionFocus=this.handleTrailingActionFocus.bind(this),this.addEventListener("keydown",this.handleKeyDown.bind(this))}focus(t){(this.alwaysFocusable||!this.disabled)&&t?.trailing&&this.trailingAction?this.trailingAction.focus(t):super.focus(t)}renderContainerContent(){return dp`
      ${super.renderContainerContent()}
      ${this.renderTrailingAction(this.handleTrailingActionFocus)}
    `}handleKeyDown(t){const e="ArrowLeft"===t.key,i="ArrowRight"===t.key;if(!e&&!i)return;if(!this.primaryAction||!this.trailingAction)return;const r="rtl"===getComputedStyle(this).direction?e:i,n=this.primaryAction?.matches(":focus-within"),a=this.trailingAction?.matches(":focus-within");if(r&&a||!r&&n)return;t.preventDefault(),t.stopPropagation();(r?this.trailingAction:this.primaryAction).focus()}handleTrailingActionFocus(){const{primaryAction:t,trailingAction:e}=this;t&&e&&(t.tabIndex=-1,e.addEventListener("focusout",(()=>{t.tabIndex=0}),{once:!0}))}}function xS({ariaLabel:t,disabled:e,focusListener:i,tabbable:r=!1}){return dp`
    <button
      class="trailing action"
      aria-label=${t}
      tabindex=${r?pp:-1}
      @click=${wS}
      @focus=${i}>
      <md-focus-ring part="trailing-focus-ring"></md-focus-ring>
      <md-ripple ?disabled=${e}></md-ripple>
      <span class="trailing icon" aria-hidden="true">
        <slot name="remove-trailing-icon">
          <svg viewBox="0 96 960 960">
            <path
              d="m249 849-42-42 231-231-231-231 42-42 231 231 231-231 42 42-231 231 231 231-42 42-231-231-231 231Z" />
          </svg>
        </slot>
      </span>
      <span class="touch"></span>
    </button>
  `}function wS(t){if(this.disabled)return;t.stopPropagation();!this.dispatchEvent(new Event("remove",{cancelable:!0}))||this.remove()}class kS extends bS{constructor(){super(...arguments),this.elevated=!1,this.removable=!1,this.selected=!1,this.hasSelectedIcon=!1}get primaryId(){return"button"}getContainerClasses(){return{...super.getContainerClasses(),elevated:this.elevated,selected:this.selected,"has-trailing":this.removable,"has-icon":this.hasIcon||this.selected}}renderPrimaryAction(t){const{ariaLabel:e}=this;return dp`
      <button
        class="primary action"
        id="button"
        aria-label=${e||pp}
        aria-pressed=${this.selected}
        ?disabled=${this.disabled&&!this.alwaysFocusable}
        @click=${this.handleClick}
        >${t}</button
      >
    `}renderLeadingIcon(){return this.selected?dp`
      <slot name="selected-icon">
        <svg class="checkmark" viewBox="0 0 18 18" aria-hidden="true">
          <path
            d="M6.75012 12.1274L3.62262 8.99988L2.55762 10.0574L6.75012 14.2499L15.7501 5.24988L14.6926 4.19238L6.75012 12.1274Z" />
        </svg>
      </slot>
    `:super.renderLeadingIcon()}renderTrailingAction(t){return this.removable?xS({focusListener:t,ariaLabel:this.ariaLabelRemove,disabled:this.disabled}):pp}renderOutline(){return this.elevated?dp`<md-elevation part="elevation"></md-elevation>`:super.renderOutline()}handleClick(t){if(this.disabled)return;const e=this.selected;this.selected=!this.selected;!au(this,t)&&(this.selected=e)}}it([jh({type:Boolean})],kS.prototype,"elevated",void 0),it([jh({type:Boolean})],kS.prototype,"removable",void 0),it([jh({type:Boolean,reflect:!0})],kS.prototype,"selected",void 0),it([jh({type:Boolean,reflect:!0,attribute:"has-selected-icon"})],kS.prototype,"hasSelectedIcon",void 0),it([Fh(".primary.action")],kS.prototype,"primaryAction",void 0),it([Fh(".trailing.action")],kS.prototype,"trailingAction",void 0);const TS=vh`:host{--_container-height: var(--md-filter-chip-container-height, 32px);--_disabled-label-text-color: var(--md-filter-chip-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-filter-chip-disabled-label-text-opacity, 0.38);--_elevated-container-elevation: var(--md-filter-chip-elevated-container-elevation, 1);--_elevated-container-shadow-color: var(--md-filter-chip-elevated-container-shadow-color, var(--md-sys-color-shadow, #000));--_elevated-disabled-container-color: var(--md-filter-chip-elevated-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_elevated-disabled-container-elevation: var(--md-filter-chip-elevated-disabled-container-elevation, 0);--_elevated-disabled-container-opacity: var(--md-filter-chip-elevated-disabled-container-opacity, 0.12);--_elevated-focus-container-elevation: var(--md-filter-chip-elevated-focus-container-elevation, 1);--_elevated-hover-container-elevation: var(--md-filter-chip-elevated-hover-container-elevation, 2);--_elevated-pressed-container-elevation: var(--md-filter-chip-elevated-pressed-container-elevation, 1);--_elevated-selected-container-color: var(--md-filter-chip-elevated-selected-container-color, var(--md-sys-color-secondary-container, #e8def8));--_label-text-font: var(--md-filter-chip-label-text-font, var(--md-sys-typescale-label-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-filter-chip-label-text-line-height, var(--md-sys-typescale-label-large-line-height, 1.25rem));--_label-text-size: var(--md-filter-chip-label-text-size, var(--md-sys-typescale-label-large-size, 0.875rem));--_label-text-weight: var(--md-filter-chip-label-text-weight, var(--md-sys-typescale-label-large-weight, var(--md-ref-typeface-weight-medium, 500)));--_selected-focus-label-text-color: var(--md-filter-chip-selected-focus-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-hover-label-text-color: var(--md-filter-chip-selected-hover-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-hover-state-layer-color: var(--md-filter-chip-selected-hover-state-layer-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-hover-state-layer-opacity: var(--md-filter-chip-selected-hover-state-layer-opacity, 0.08);--_selected-label-text-color: var(--md-filter-chip-selected-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-pressed-label-text-color: var(--md-filter-chip-selected-pressed-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-pressed-state-layer-color: var(--md-filter-chip-selected-pressed-state-layer-color, var(--md-sys-color-on-surface-variant, #49454f));--_selected-pressed-state-layer-opacity: var(--md-filter-chip-selected-pressed-state-layer-opacity, 0.12);--_elevated-container-color: var(--md-filter-chip-elevated-container-color, var(--md-sys-color-surface-container-low, #f7f2fa));--_disabled-outline-color: var(--md-filter-chip-disabled-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-outline-opacity: var(--md-filter-chip-disabled-outline-opacity, 0.12);--_disabled-selected-container-color: var(--md-filter-chip-disabled-selected-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-selected-container-opacity: var(--md-filter-chip-disabled-selected-container-opacity, 0.12);--_focus-outline-color: var(--md-filter-chip-focus-outline-color, var(--md-sys-color-on-surface-variant, #49454f));--_outline-color: var(--md-filter-chip-outline-color, var(--md-sys-color-outline, #79747e));--_outline-width: var(--md-filter-chip-outline-width, 1px);--_selected-container-color: var(--md-filter-chip-selected-container-color, var(--md-sys-color-secondary-container, #e8def8));--_selected-outline-width: var(--md-filter-chip-selected-outline-width, 0px);--_focus-label-text-color: var(--md-filter-chip-focus-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-label-text-color: var(--md-filter-chip-hover-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-color: var(--md-filter-chip-hover-state-layer-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-opacity: var(--md-filter-chip-hover-state-layer-opacity, 0.08);--_label-text-color: var(--md-filter-chip-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-label-text-color: var(--md-filter-chip-pressed-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-state-layer-color: var(--md-filter-chip-pressed-state-layer-color, var(--md-sys-color-on-secondary-container, #1d192b));--_pressed-state-layer-opacity: var(--md-filter-chip-pressed-state-layer-opacity, 0.12);--_icon-size: var(--md-filter-chip-icon-size, 18px);--_disabled-leading-icon-color: var(--md-filter-chip-disabled-leading-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-icon-opacity: var(--md-filter-chip-disabled-leading-icon-opacity, 0.38);--_selected-focus-leading-icon-color: var(--md-filter-chip-selected-focus-leading-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-hover-leading-icon-color: var(--md-filter-chip-selected-hover-leading-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-leading-icon-color: var(--md-filter-chip-selected-leading-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-pressed-leading-icon-color: var(--md-filter-chip-selected-pressed-leading-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_focus-leading-icon-color: var(--md-filter-chip-focus-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_hover-leading-icon-color: var(--md-filter-chip-hover-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_leading-icon-color: var(--md-filter-chip-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_pressed-leading-icon-color: var(--md-filter-chip-pressed-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_disabled-trailing-icon-color: var(--md-filter-chip-disabled-trailing-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-icon-opacity: var(--md-filter-chip-disabled-trailing-icon-opacity, 0.38);--_selected-focus-trailing-icon-color: var(--md-filter-chip-selected-focus-trailing-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-hover-trailing-icon-color: var(--md-filter-chip-selected-hover-trailing-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-pressed-trailing-icon-color: var(--md-filter-chip-selected-pressed-trailing-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-trailing-icon-color: var(--md-filter-chip-selected-trailing-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_focus-trailing-icon-color: var(--md-filter-chip-focus-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-icon-color: var(--md-filter-chip-hover-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-trailing-icon-color: var(--md-filter-chip-pressed-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-icon-color: var(--md-filter-chip-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_container-shape-start-start: var(--md-filter-chip-container-shape-start-start, var(--md-filter-chip-container-shape, var(--md-sys-shape-corner-small, 8px)));--_container-shape-start-end: var(--md-filter-chip-container-shape-start-end, var(--md-filter-chip-container-shape, var(--md-sys-shape-corner-small, 8px)));--_container-shape-end-end: var(--md-filter-chip-container-shape-end-end, var(--md-filter-chip-container-shape, var(--md-sys-shape-corner-small, 8px)));--_container-shape-end-start: var(--md-filter-chip-container-shape-end-start, var(--md-filter-chip-container-shape, var(--md-sys-shape-corner-small, 8px)));--_leading-space: var(--md-filter-chip-leading-space, 16px);--_trailing-space: var(--md-filter-chip-trailing-space, 16px);--_icon-label-space: var(--md-filter-chip-icon-label-space, 8px);--_with-leading-icon-leading-space: var(--md-filter-chip-with-leading-icon-leading-space, 8px);--_with-trailing-icon-trailing-space: var(--md-filter-chip-with-trailing-icon-trailing-space, 8px)}.selected.elevated::before{background:var(--_elevated-selected-container-color)}.checkmark{height:var(--_icon-size);width:var(--_icon-size)}.disabled .checkmark{opacity:var(--_disabled-leading-icon-opacity)}@media(forced-colors: active){.disabled .checkmark{opacity:1}}
`,SS=vh`.selected{--md-ripple-hover-color: var(--_selected-hover-state-layer-color);--md-ripple-hover-opacity: var(--_selected-hover-state-layer-opacity);--md-ripple-pressed-color: var(--_selected-pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_selected-pressed-state-layer-opacity)}:where(.selected)::before{background:var(--_selected-container-color)}:where(.selected) .outline{border-width:var(--_selected-outline-width)}:where(.selected.disabled)::before{background:var(--_disabled-selected-container-color);opacity:var(--_disabled-selected-container-opacity)}:where(.selected) .label{color:var(--_selected-label-text-color)}:where(.selected:hover) .label{color:var(--_selected-hover-label-text-color)}:where(.selected:focus) .label{color:var(--_selected-focus-label-text-color)}:where(.selected:active) .label{color:var(--_selected-pressed-label-text-color)}:where(.selected) .leading.icon{color:var(--_selected-leading-icon-color)}:where(.selected:hover) .leading.icon{color:var(--_selected-hover-leading-icon-color)}:where(.selected:focus) .leading.icon{color:var(--_selected-focus-leading-icon-color)}:where(.selected:active) .leading.icon{color:var(--_selected-pressed-leading-icon-color)}@media(forced-colors: active){:where(.selected:not(.elevated))::before{border:1px solid CanvasText}:where(.selected) .outline{border-width:1px}}
`,CS=vh`:host{border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-start-radius:var(--_container-shape-end-start);border-end-end-radius:var(--_container-shape-end-end);display:inline-flex;height:var(--_container-height);cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);--md-ripple-hover-color: var(--_hover-state-layer-color);--md-ripple-hover-opacity: var(--_hover-state-layer-opacity);--md-ripple-pressed-color: var(--_pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_pressed-state-layer-opacity)}:host([disabled]){pointer-events:none}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--_container-height))/2) 0}md-focus-ring{--md-focus-ring-shape-start-start: var(--_container-shape-start-start);--md-focus-ring-shape-start-end: var(--_container-shape-start-end);--md-focus-ring-shape-end-end: var(--_container-shape-end-end);--md-focus-ring-shape-end-start: var(--_container-shape-end-start)}.container{border-radius:inherit;box-sizing:border-box;display:flex;height:100%;position:relative;width:100%}.container::before{border-radius:inherit;content:"";inset:0;pointer-events:none;position:absolute}.container:not(.disabled){cursor:pointer}.container.disabled{pointer-events:none}.cell{display:flex}.action{align-items:baseline;appearance:none;background:none;border:none;border-radius:inherit;display:flex;outline:none;padding:0;position:relative;text-decoration:none}.primary.action{padding-inline-start:var(--_leading-space);padding-inline-end:var(--_trailing-space)}.has-icon .primary.action{padding-inline-start:var(--_with-leading-icon-leading-space)}.touch{height:48px;inset:50% 0 0;position:absolute;transform:translateY(-50%);width:100%}:host([touch-target=none]) .touch{display:none}.outline{border:var(--_outline-width) solid var(--_outline-color);border-radius:inherit;inset:0;pointer-events:none;position:absolute}:where(:focus) .outline{border-color:var(--_focus-outline-color)}:where(.disabled) .outline{border-color:var(--_disabled-outline-color);opacity:var(--_disabled-outline-opacity)}md-ripple{border-radius:inherit}.label,.icon,.touch{z-index:1}.label{align-items:center;color:var(--_label-text-color);display:flex;font-family:var(--_label-text-font);font-size:var(--_label-text-size);line-height:var(--_label-text-line-height);font-weight:var(--_label-text-weight);height:100%;text-overflow:ellipsis;user-select:none;white-space:nowrap}:where(:hover) .label{color:var(--_hover-label-text-color)}:where(:focus) .label{color:var(--_focus-label-text-color)}:where(:active) .label{color:var(--_pressed-label-text-color)}:where(.disabled) .label{color:var(--_disabled-label-text-color);opacity:var(--_disabled-label-text-opacity)}.icon{align-self:center;display:flex;fill:currentColor;position:relative}.icon ::slotted(:first-child){font-size:var(--_icon-size);height:var(--_icon-size);width:var(--_icon-size)}.leading.icon{color:var(--_leading-icon-color)}.leading.icon ::slotted(*),.leading.icon svg{margin-inline-end:var(--_icon-label-space)}:where(:hover) .leading.icon{color:var(--_hover-leading-icon-color)}:where(:focus) .leading.icon{color:var(--_focus-leading-icon-color)}:where(:active) .leading.icon{color:var(--_pressed-leading-icon-color)}:where(.disabled) .leading.icon{color:var(--_disabled-leading-icon-color);opacity:var(--_disabled-leading-icon-opacity)}@media(forced-colors: active){:where(.disabled) :is(.label,.outline,.leading.icon){color:GrayText;opacity:1}}a,button{text-transform:inherit}a,button:not(:disabled){cursor:inherit}
`,ES=vh`.trailing.action{align-items:center;justify-content:center;padding-inline-start:var(--_icon-label-space);padding-inline-end:var(--_with-trailing-icon-trailing-space)}.trailing.action :is(md-ripple,md-focus-ring){border-radius:50%;height:calc(1.3333333333*var(--_icon-size));width:calc(1.3333333333*var(--_icon-size))}.trailing.action md-focus-ring{inset:unset}.has-trailing .primary.action{padding-inline-end:0}.trailing.icon{color:var(--_trailing-icon-color);height:var(--_icon-size);width:var(--_icon-size)}:where(:hover) .trailing.icon{color:var(--_hover-trailing-icon-color)}:where(:focus) .trailing.icon{color:var(--_focus-trailing-icon-color)}:where(:active) .trailing.icon{color:var(--_pressed-trailing-icon-color)}:where(.disabled) .trailing.icon{color:var(--_disabled-trailing-icon-color);opacity:var(--_disabled-trailing-icon-opacity)}:where(.selected) .trailing.icon{color:var(--_selected-trailing-icon-color)}:where(.selected:hover) .trailing.icon{color:var(--_selected-hover-trailing-icon-color)}:where(.selected:focus) .trailing.icon{color:var(--_selected-focus-trailing-icon-color)}:where(.selected:active) .trailing.icon{color:var(--_selected-pressed-trailing-icon-color)}@media(forced-colors: active){.trailing.icon{color:ButtonText}:where(.disabled) .trailing.icon{color:GrayText;opacity:1}}
`;let $S=class extends kS{};$S.styles=[CS,vS,ES,SS,TS],$S=it([ph("md-filter-chip")],$S);const AS={people:"People",families:"Families",events:"Events",places:"Places",sources:"Sources",citations:"Citations",repositories:"Repositories",notes:"Notes",media:"Media Objects",tags:"Tags"};class IS extends(al(K)){static get styles(){return[nl,n`
        md-filter-chip {
          --md-sys-color-secondary-container: rgba(109, 76, 65, 0.32);
          --md-sys-color-on-secondary-container: rgba(0, 0, 0, 0.78);
        }
      `]}static get properties(){return{_namespaces:{type:String}}}constructor(){super(),this._namespaces=""}show(){this.renderRoot.querySelector("md-dialog").show()}render(){return M`
      <md-dialog
        id="filter-dialog"
        ?open="${this.open}"
        @close=${this._handleClose}
      >
        <div slot="headline">${this._("Delete all objects")}</div>

        <form slot="content" id="form-id" method="dialog">
          <md-chip-set>
            ${Object.keys(AS).map((t=>M`
                <md-filter-chip
                  @click="${this._handleChipsChanged}"
                  label="${this._(AS[t])}"
                  id="${t}"
                  selected
                ></md-filter-chip>
              `))}
          </md-chip-set>
        </form>
        <div slot="actions">
          <md-text-button form="form-id" value="cancel"
            >${this._("Cancel")}</md-text-button
          >
          <md-text-button
            form="form-id"
            value="ok"
            ?disabled="${"none"===this._namespaces}"
            >${this._("Delete")}</md-text-button
          >
        </div>
      </md-dialog>
    `}_handleChipsChanged(){const t=[...this.renderRoot.querySelectorAll("md-filter-chip")].filter((t=>t.selected));0===t.length?this._namespaces="none":this._namespaces=t.map((t=>t.id)).join(",")}_handleClose(){const{returnValue:t}=this.renderRoot.querySelector("md-dialog");"ok"===t&&os(this,"delete-objects",{namespaces:this._namespaces})}}window.customElements.define("grampsjs-delete-all",IS);class MS extends Bp{renderBackground(){return dp`
      <div class="background"></div>
      <div class="state-layer"></div>
    `}renderIndicator(){return dp`<div class="active-indicator"></div>`}}const LS=vh`@layer styles{:host{--_active-indicator-color: var(--md-filled-field-active-indicator-color, var(--md-sys-color-on-surface-variant, #49454f));--_active-indicator-height: var(--md-filled-field-active-indicator-height, 1px);--_bottom-space: var(--md-filled-field-bottom-space, 16px);--_container-color: var(--md-filled-field-container-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_content-color: var(--md-filled-field-content-color, var(--md-sys-color-on-surface, #1d1b20));--_content-font: var(--md-filled-field-content-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_content-line-height: var(--md-filled-field-content-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_content-size: var(--md-filled-field-content-size, var(--md-sys-typescale-body-large-size, 1rem));--_content-weight: var(--md-filled-field-content-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_disabled-active-indicator-color: var(--md-filled-field-disabled-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-active-indicator-height: var(--md-filled-field-disabled-active-indicator-height, 1px);--_disabled-active-indicator-opacity: var(--md-filled-field-disabled-active-indicator-opacity, 0.38);--_disabled-container-color: var(--md-filled-field-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-container-opacity: var(--md-filled-field-disabled-container-opacity, 0.04);--_disabled-content-color: var(--md-filled-field-disabled-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-content-opacity: var(--md-filled-field-disabled-content-opacity, 0.38);--_disabled-label-text-color: var(--md-filled-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-filled-field-disabled-label-text-opacity, 0.38);--_disabled-leading-content-color: var(--md-filled-field-disabled-leading-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-content-opacity: var(--md-filled-field-disabled-leading-content-opacity, 0.38);--_disabled-supporting-text-color: var(--md-filled-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-supporting-text-opacity: var(--md-filled-field-disabled-supporting-text-opacity, 0.38);--_disabled-trailing-content-color: var(--md-filled-field-disabled-trailing-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-content-opacity: var(--md-filled-field-disabled-trailing-content-opacity, 0.38);--_error-active-indicator-color: var(--md-filled-field-error-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-content-color: var(--md-filled-field-error-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-active-indicator-color: var(--md-filled-field-error-focus-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-focus-content-color: var(--md-filled-field-error-focus-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-label-text-color: var(--md-filled-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-leading-content-color: var(--md-filled-field-error-focus-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-supporting-text-color: var(--md-filled-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-trailing-content-color: var(--md-filled-field-error-focus-trailing-content-color, var(--md-sys-color-error, #b3261e));--_error-hover-active-indicator-color: var(--md-filled-field-error-hover-active-indicator-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-content-color: var(--md-filled-field-error-hover-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-label-text-color: var(--md-filled-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-leading-content-color: var(--md-filled-field-error-hover-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-hover-state-layer-color: var(--md-filled-field-error-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-state-layer-opacity: var(--md-filled-field-error-hover-state-layer-opacity, 0.08);--_error-hover-supporting-text-color: var(--md-filled-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-hover-trailing-content-color: var(--md-filled-field-error-hover-trailing-content-color, var(--md-sys-color-on-error-container, #410e0b));--_error-label-text-color: var(--md-filled-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_error-leading-content-color: var(--md-filled-field-error-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-supporting-text-color: var(--md-filled-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-trailing-content-color: var(--md-filled-field-error-trailing-content-color, var(--md-sys-color-error, #b3261e));--_focus-active-indicator-color: var(--md-filled-field-focus-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_focus-active-indicator-height: var(--md-filled-field-focus-active-indicator-height, 3px);--_focus-content-color: var(--md-filled-field-focus-content-color, var(--md-sys-color-on-surface, #1d1b20));--_focus-label-text-color: var(--md-filled-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_focus-leading-content-color: var(--md-filled-field-focus-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-supporting-text-color: var(--md-filled-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-trailing-content-color: var(--md-filled-field-focus-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-active-indicator-color: var(--md-filled-field-hover-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-active-indicator-height: var(--md-filled-field-hover-active-indicator-height, 1px);--_hover-content-color: var(--md-filled-field-hover-content-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-filled-field-hover-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-leading-content-color: var(--md-filled-field-hover-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-color: var(--md-filled-field-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-state-layer-opacity: var(--md-filled-field-hover-state-layer-opacity, 0.08);--_hover-supporting-text-color: var(--md-filled-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-content-color: var(--md-filled-field-hover-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-color: var(--md-filled-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-font: var(--md-filled-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-filled-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_label-text-populated-line-height: var(--md-filled-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_label-text-populated-size: var(--md-filled-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_label-text-size: var(--md-filled-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_label-text-weight: var(--md-filled-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_leading-content-color: var(--md-filled-field-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_leading-space: var(--md-filled-field-leading-space, 16px);--_supporting-text-color: var(--md-filled-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_supporting-text-font: var(--md-filled-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_supporting-text-leading-space: var(--md-filled-field-supporting-text-leading-space, 16px);--_supporting-text-line-height: var(--md-filled-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_supporting-text-size: var(--md-filled-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_supporting-text-top-space: var(--md-filled-field-supporting-text-top-space, 4px);--_supporting-text-trailing-space: var(--md-filled-field-supporting-text-trailing-space, 16px);--_supporting-text-weight: var(--md-filled-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_top-space: var(--md-filled-field-top-space, 16px);--_trailing-content-color: var(--md-filled-field-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-space: var(--md-filled-field-trailing-space, 16px);--_with-label-bottom-space: var(--md-filled-field-with-label-bottom-space, 8px);--_with-label-top-space: var(--md-filled-field-with-label-top-space, 8px);--_container-shape-start-start: var(--md-filled-field-container-shape-start-start, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-start-end: var(--md-filled-field-container-shape-start-end, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-end: var(--md-filled-field-container-shape-end-end, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-end-start: var(--md-filled-field-container-shape-end-start, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-none, 0px)))}.background,.state-layer{border-radius:inherit;inset:0;pointer-events:none;position:absolute}.background{background:var(--_container-color)}.state-layer{visibility:hidden}.field:not(.disabled):hover .state-layer{visibility:visible}.label.floating{position:absolute;top:var(--_with-label-top-space)}.field:not(.with-start) .label-wrapper{margin-inline-start:var(--_leading-space)}.field:not(.with-end) .label-wrapper{margin-inline-end:var(--_trailing-space)}.active-indicator{inset:auto 0 0 0;pointer-events:none;position:absolute;width:100%;z-index:1}.active-indicator::before,.active-indicator::after{border-bottom:var(--_active-indicator-height) solid var(--_active-indicator-color);inset:auto 0 0 0;content:"";position:absolute;width:100%}.active-indicator::after{opacity:0;transition:opacity 150ms cubic-bezier(0.2, 0, 0, 1)}.focused .active-indicator::after{opacity:1}.field:not(.with-start) .content ::slotted(*){padding-inline-start:var(--_leading-space)}.field:not(.with-end) .content ::slotted(*){padding-inline-end:var(--_trailing-space)}.field:not(.no-label) .content ::slotted(:not(textarea)){padding-bottom:var(--_with-label-bottom-space);padding-top:calc(var(--_with-label-top-space) + var(--_label-text-populated-line-height))}.field:not(.no-label) .content ::slotted(textarea){margin-bottom:var(--_with-label-bottom-space);margin-top:calc(var(--_with-label-top-space) + var(--_label-text-populated-line-height))}:hover .active-indicator::before{border-bottom-color:var(--_hover-active-indicator-color);border-bottom-width:var(--_hover-active-indicator-height)}.active-indicator::after{border-bottom-color:var(--_focus-active-indicator-color);border-bottom-width:var(--_focus-active-indicator-height)}:hover .state-layer{background:var(--_hover-state-layer-color);opacity:var(--_hover-state-layer-opacity)}.disabled .active-indicator::before{border-bottom-color:var(--_disabled-active-indicator-color);border-bottom-width:var(--_disabled-active-indicator-height);opacity:var(--_disabled-active-indicator-opacity)}.disabled .background{background:var(--_disabled-container-color);opacity:var(--_disabled-container-opacity)}.error .active-indicator::before{border-bottom-color:var(--_error-active-indicator-color)}.error:hover .active-indicator::before{border-bottom-color:var(--_error-hover-active-indicator-color)}.error:hover .state-layer{background:var(--_error-hover-state-layer-color);opacity:var(--_error-hover-state-layer-opacity)}.error .active-indicator::after{border-bottom-color:var(--_error-focus-active-indicator-color)}.resizable .container{bottom:var(--_focus-active-indicator-height);clip-path:inset(var(--_focus-active-indicator-height) 0 0 0)}.resizable .container>*{top:var(--_focus-active-indicator-height)}}@layer hcm{@media(forced-colors: active){.disabled .active-indicator::before{border-color:GrayText;opacity:1}}}
`;let PS=class extends MS{};PS.styles=[Hp,LS],PS=it([ph("md-filled-field")],PS);const RS=vh`:host{--_active-indicator-color: var(--md-filled-text-field-active-indicator-color, var(--md-sys-color-on-surface-variant, #49454f));--_active-indicator-height: var(--md-filled-text-field-active-indicator-height, 1px);--_caret-color: var(--md-filled-text-field-caret-color, var(--md-sys-color-primary, #6750a4));--_container-color: var(--md-filled-text-field-container-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_disabled-active-indicator-color: var(--md-filled-text-field-disabled-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-active-indicator-height: var(--md-filled-text-field-disabled-active-indicator-height, 1px);--_disabled-active-indicator-opacity: var(--md-filled-text-field-disabled-active-indicator-opacity, 0.38);--_disabled-container-color: var(--md-filled-text-field-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-container-opacity: var(--md-filled-text-field-disabled-container-opacity, 0.04);--_disabled-input-text-color: var(--md-filled-text-field-disabled-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-input-text-opacity: var(--md-filled-text-field-disabled-input-text-opacity, 0.38);--_disabled-label-text-color: var(--md-filled-text-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-filled-text-field-disabled-label-text-opacity, 0.38);--_disabled-leading-icon-color: var(--md-filled-text-field-disabled-leading-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-icon-opacity: var(--md-filled-text-field-disabled-leading-icon-opacity, 0.38);--_disabled-supporting-text-color: var(--md-filled-text-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-supporting-text-opacity: var(--md-filled-text-field-disabled-supporting-text-opacity, 0.38);--_disabled-trailing-icon-color: var(--md-filled-text-field-disabled-trailing-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-icon-opacity: var(--md-filled-text-field-disabled-trailing-icon-opacity, 0.38);--_error-active-indicator-color: var(--md-filled-text-field-error-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-focus-active-indicator-color: var(--md-filled-text-field-error-focus-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-focus-caret-color: var(--md-filled-text-field-error-focus-caret-color, var(--md-sys-color-error, #b3261e));--_error-focus-input-text-color: var(--md-filled-text-field-error-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-label-text-color: var(--md-filled-text-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-leading-icon-color: var(--md-filled-text-field-error-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-supporting-text-color: var(--md-filled-text-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-trailing-icon-color: var(--md-filled-text-field-error-focus-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_error-hover-active-indicator-color: var(--md-filled-text-field-error-hover-active-indicator-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-input-text-color: var(--md-filled-text-field-error-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-label-text-color: var(--md-filled-text-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-leading-icon-color: var(--md-filled-text-field-error-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-hover-state-layer-color: var(--md-filled-text-field-error-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-state-layer-opacity: var(--md-filled-text-field-error-hover-state-layer-opacity, 0.08);--_error-hover-supporting-text-color: var(--md-filled-text-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-hover-trailing-icon-color: var(--md-filled-text-field-error-hover-trailing-icon-color, var(--md-sys-color-on-error-container, #410e0b));--_error-input-text-color: var(--md-filled-text-field-error-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-label-text-color: var(--md-filled-text-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_error-leading-icon-color: var(--md-filled-text-field-error-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-supporting-text-color: var(--md-filled-text-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-trailing-icon-color: var(--md-filled-text-field-error-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_focus-active-indicator-color: var(--md-filled-text-field-focus-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_focus-active-indicator-height: var(--md-filled-text-field-focus-active-indicator-height, 3px);--_focus-input-text-color: var(--md-filled-text-field-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_focus-label-text-color: var(--md-filled-text-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_focus-leading-icon-color: var(--md-filled-text-field-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-supporting-text-color: var(--md-filled-text-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-trailing-icon-color: var(--md-filled-text-field-focus-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-active-indicator-color: var(--md-filled-text-field-hover-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-active-indicator-height: var(--md-filled-text-field-hover-active-indicator-height, 1px);--_hover-input-text-color: var(--md-filled-text-field-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-filled-text-field-hover-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-leading-icon-color: var(--md-filled-text-field-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-color: var(--md-filled-text-field-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-state-layer-opacity: var(--md-filled-text-field-hover-state-layer-opacity, 0.08);--_hover-supporting-text-color: var(--md-filled-text-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-icon-color: var(--md-filled-text-field-hover-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-color: var(--md-filled-text-field-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_input-text-font: var(--md-filled-text-field-input-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_input-text-line-height: var(--md-filled-text-field-input-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_input-text-placeholder-color: var(--md-filled-text-field-input-text-placeholder-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-prefix-color: var(--md-filled-text-field-input-text-prefix-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-size: var(--md-filled-text-field-input-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_input-text-suffix-color: var(--md-filled-text-field-input-text-suffix-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-weight: var(--md-filled-text-field-input-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_label-text-color: var(--md-filled-text-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-font: var(--md-filled-text-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-filled-text-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_label-text-populated-line-height: var(--md-filled-text-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_label-text-populated-size: var(--md-filled-text-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_label-text-size: var(--md-filled-text-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_label-text-weight: var(--md-filled-text-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_leading-icon-color: var(--md-filled-text-field-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_leading-icon-size: var(--md-filled-text-field-leading-icon-size, 24px);--_supporting-text-color: var(--md-filled-text-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_supporting-text-font: var(--md-filled-text-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_supporting-text-line-height: var(--md-filled-text-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_supporting-text-size: var(--md-filled-text-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_supporting-text-weight: var(--md-filled-text-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_trailing-icon-color: var(--md-filled-text-field-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-icon-size: var(--md-filled-text-field-trailing-icon-size, 24px);--_container-shape-start-start: var(--md-filled-text-field-container-shape-start-start, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-start-end: var(--md-filled-text-field-container-shape-start-end, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-end: var(--md-filled-text-field-container-shape-end-end, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-end-start: var(--md-filled-text-field-container-shape-end-start, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_leading-space: var(--md-filled-text-field-leading-space, 16px);--_trailing-space: var(--md-filled-text-field-trailing-space, 16px);--_top-space: var(--md-filled-text-field-top-space, 16px);--_bottom-space: var(--md-filled-text-field-bottom-space, 16px);--_input-text-prefix-trailing-space: var(--md-filled-text-field-input-text-prefix-trailing-space, 2px);--_input-text-suffix-leading-space: var(--md-filled-text-field-input-text-suffix-leading-space, 2px);--_with-label-top-space: var(--md-filled-text-field-with-label-top-space, 8px);--_with-label-bottom-space: var(--md-filled-text-field-with-label-bottom-space, 8px);--_focus-caret-color: var(--md-filled-text-field-focus-caret-color, var(--md-sys-color-primary, #6750a4));--md-filled-field-active-indicator-color: var(--_active-indicator-color);--md-filled-field-active-indicator-height: var(--_active-indicator-height);--md-filled-field-bottom-space: var(--_bottom-space);--md-filled-field-container-color: var(--_container-color);--md-filled-field-container-shape-end-end: var(--_container-shape-end-end);--md-filled-field-container-shape-end-start: var(--_container-shape-end-start);--md-filled-field-container-shape-start-end: var(--_container-shape-start-end);--md-filled-field-container-shape-start-start: var(--_container-shape-start-start);--md-filled-field-content-color: var(--_input-text-color);--md-filled-field-content-font: var(--_input-text-font);--md-filled-field-content-line-height: var(--_input-text-line-height);--md-filled-field-content-size: var(--_input-text-size);--md-filled-field-content-weight: var(--_input-text-weight);--md-filled-field-disabled-active-indicator-color: var(--_disabled-active-indicator-color);--md-filled-field-disabled-active-indicator-height: var(--_disabled-active-indicator-height);--md-filled-field-disabled-active-indicator-opacity: var(--_disabled-active-indicator-opacity);--md-filled-field-disabled-container-color: var(--_disabled-container-color);--md-filled-field-disabled-container-opacity: var(--_disabled-container-opacity);--md-filled-field-disabled-content-color: var(--_disabled-input-text-color);--md-filled-field-disabled-content-opacity: var(--_disabled-input-text-opacity);--md-filled-field-disabled-label-text-color: var(--_disabled-label-text-color);--md-filled-field-disabled-label-text-opacity: var(--_disabled-label-text-opacity);--md-filled-field-disabled-leading-content-color: var(--_disabled-leading-icon-color);--md-filled-field-disabled-leading-content-opacity: var(--_disabled-leading-icon-opacity);--md-filled-field-disabled-supporting-text-color: var(--_disabled-supporting-text-color);--md-filled-field-disabled-supporting-text-opacity: var(--_disabled-supporting-text-opacity);--md-filled-field-disabled-trailing-content-color: var(--_disabled-trailing-icon-color);--md-filled-field-disabled-trailing-content-opacity: var(--_disabled-trailing-icon-opacity);--md-filled-field-error-active-indicator-color: var(--_error-active-indicator-color);--md-filled-field-error-content-color: var(--_error-input-text-color);--md-filled-field-error-focus-active-indicator-color: var(--_error-focus-active-indicator-color);--md-filled-field-error-focus-content-color: var(--_error-focus-input-text-color);--md-filled-field-error-focus-label-text-color: var(--_error-focus-label-text-color);--md-filled-field-error-focus-leading-content-color: var(--_error-focus-leading-icon-color);--md-filled-field-error-focus-supporting-text-color: var(--_error-focus-supporting-text-color);--md-filled-field-error-focus-trailing-content-color: var(--_error-focus-trailing-icon-color);--md-filled-field-error-hover-active-indicator-color: var(--_error-hover-active-indicator-color);--md-filled-field-error-hover-content-color: var(--_error-hover-input-text-color);--md-filled-field-error-hover-label-text-color: var(--_error-hover-label-text-color);--md-filled-field-error-hover-leading-content-color: var(--_error-hover-leading-icon-color);--md-filled-field-error-hover-state-layer-color: var(--_error-hover-state-layer-color);--md-filled-field-error-hover-state-layer-opacity: var(--_error-hover-state-layer-opacity);--md-filled-field-error-hover-supporting-text-color: var(--_error-hover-supporting-text-color);--md-filled-field-error-hover-trailing-content-color: var(--_error-hover-trailing-icon-color);--md-filled-field-error-label-text-color: var(--_error-label-text-color);--md-filled-field-error-leading-content-color: var(--_error-leading-icon-color);--md-filled-field-error-supporting-text-color: var(--_error-supporting-text-color);--md-filled-field-error-trailing-content-color: var(--_error-trailing-icon-color);--md-filled-field-focus-active-indicator-color: var(--_focus-active-indicator-color);--md-filled-field-focus-active-indicator-height: var(--_focus-active-indicator-height);--md-filled-field-focus-content-color: var(--_focus-input-text-color);--md-filled-field-focus-label-text-color: var(--_focus-label-text-color);--md-filled-field-focus-leading-content-color: var(--_focus-leading-icon-color);--md-filled-field-focus-supporting-text-color: var(--_focus-supporting-text-color);--md-filled-field-focus-trailing-content-color: var(--_focus-trailing-icon-color);--md-filled-field-hover-active-indicator-color: var(--_hover-active-indicator-color);--md-filled-field-hover-active-indicator-height: var(--_hover-active-indicator-height);--md-filled-field-hover-content-color: var(--_hover-input-text-color);--md-filled-field-hover-label-text-color: var(--_hover-label-text-color);--md-filled-field-hover-leading-content-color: var(--_hover-leading-icon-color);--md-filled-field-hover-state-layer-color: var(--_hover-state-layer-color);--md-filled-field-hover-state-layer-opacity: var(--_hover-state-layer-opacity);--md-filled-field-hover-supporting-text-color: var(--_hover-supporting-text-color);--md-filled-field-hover-trailing-content-color: var(--_hover-trailing-icon-color);--md-filled-field-label-text-color: var(--_label-text-color);--md-filled-field-label-text-font: var(--_label-text-font);--md-filled-field-label-text-line-height: var(--_label-text-line-height);--md-filled-field-label-text-populated-line-height: var(--_label-text-populated-line-height);--md-filled-field-label-text-populated-size: var(--_label-text-populated-size);--md-filled-field-label-text-size: var(--_label-text-size);--md-filled-field-label-text-weight: var(--_label-text-weight);--md-filled-field-leading-content-color: var(--_leading-icon-color);--md-filled-field-leading-space: var(--_leading-space);--md-filled-field-supporting-text-color: var(--_supporting-text-color);--md-filled-field-supporting-text-font: var(--_supporting-text-font);--md-filled-field-supporting-text-line-height: var(--_supporting-text-line-height);--md-filled-field-supporting-text-size: var(--_supporting-text-size);--md-filled-field-supporting-text-weight: var(--_supporting-text-weight);--md-filled-field-top-space: var(--_top-space);--md-filled-field-trailing-content-color: var(--_trailing-icon-color);--md-filled-field-trailing-space: var(--_trailing-space);--md-filled-field-with-label-bottom-space: var(--_with-label-bottom-space);--md-filled-field-with-label-top-space: var(--_with-label-top-space)}
`;class zS extends Au{constructor(){super(...arguments),this.fieldTag=Zp`md-filled-field`}}let DS=class extends zS{constructor(){super(...arguments),this.fieldTag=Zp`md-filled-field`}};DS.styles=[Mu,RS],DS=it([ph("md-filled-text-field")],DS);class jS extends(al(K)){static get styles(){return[nl,n`
        md-filled-text-field {
          margin-right: 8px;
          margin-bottom: 12px;
          --md-filled-text-field-container-color: #f5f5f5;
        }

        .hidden {
          display: none;
        }
      `]}static get properties(){return{username:{type:String},_error:{type:String}}}constructor(){super(),this.username="",this._error=""}show(){this.renderRoot.querySelector("md-dialog").show()}render(){return M`
      <md-dialog id="filter-dialog" @close=${this._handleClose}>
        <form slot="content" id="form-id" method="dialog">
          <p>${this._("Please re-enter your password to continue.")}</p>
          <md-filled-text-field
            label="${this._("Password: ").replace(":","")}"
            type="password"
            id="password"
          >
          </md-filled-text-field>
          ${this._error?M` <p class="alert error">${this._error}</p>`:""}
        </form>

        <div slot="actions">
          <md-text-button form="form-id" value="cancel"
            >${this._("Cancel")}</md-text-button
          >
          <md-text-button @click="${this._handleClickOk}"
            >${this._("login")}</md-text-button
          >
          <md-text-button
            class="hidden"
            form="form-id"
            value="ok"
            id="hidden-ok"
          ></md-text-button>
        </div>
      </md-dialog>
    `}async _handleClickOk(t){t.stopPropagation(),t.preventDefault();const e=await this._fetchToken();e?this._error=this._((e.message??e)||"Error"):(this._error="",this.renderRoot.querySelector("#hidden-ok").click())}async _fetchToken(){const t=this.renderRoot.querySelector("#password")?.value;if(!t)return"Password is required";const e=await Dn(this.username,t);return"error"in e&&e.error}_handleClose(){this._error="";const{returnValue:t}=this.renderRoot.querySelector("md-dialog");"ok"===t&&os(this,"relogin")}}function OS(t,e){return void 0===t||void 0===e||0===t||null===e?0:t/e}function BS(t){if(null===t)return null;if(0===t)return"0 B";const e=Math.floor(Math.log10(t)/Math.log10(1e3));return`${(t/1e3**e).toFixed(1)} ${["","k","M","G","T","P","E","Z","Y"][e]}B`}window.customElements.define("grampsjs-relogin",jS);window.customElements.define("grampsjs-tree-quotas",class extends fm{static get styles(){return[nl,n`
        mwc-linear-progress {
        }

        span.label {
        }

        div.progress {
          max-width: 100px;
          height: 20px;
          margin-left: 20px;
        }

        th,
        td {
          font-size: 14px;
          font-weight: 300;
          height: 20px;
          padding-bottom: 10px;
          padding-top: 10px;
          padding-right: 25px;
          padding-left: 0;
          text-align: left;
        }

        th {
          font-weight: 450;
          color: rgba(0, 0, 0, 0.6);
          text-align: right;
        }

        td.progress {
          width: 100px;
        }

        td.numbers {
          font-size: 14px;
        }
      `]}renderContent(){const{data:t}=this._data;if(!t)return M`${this._("Error")}`;const e=void 0===t.usage_people||null===t.usage_people?this._("unknown"):t.usage_people,i="quota_people"in t?t.quota_people||M`&infin;`:this._("unknown"),r=void 0===t.usage_media||null===t.usage_media?this._("unknown"):BS(t.usage_media),n="quota_media"in t?BS(t.quota_media)||M`&infin;`:this._("unknown"),a=void 0===t.usage_ai||null===t.usage_ai?this._("unknown"):t.usage_ai,s="quota_ai"in t?t.quota_ai||M`&infin;`:this._("unknown"),o=OS(t.usage_people,t.quota_people),l=OS(t.usage_media,t.quota_media),c=OS(t.usage_ai,t.quota_ai);return M`
      <table>
        <tr>
          <th>${this._("Number of people")}</th>
          <td class="progress">
            <mwc-linear-progress
              progress="${o}"
            ></mwc-linear-progress>
          </td>
          <td class="numbers">
            ${Math.round(100*o)}%
            (&hairsp;${e}&thinsp;/&thinsp;${i}&hairsp;)
          </td>
        </tr>
        <tr>
          <th>${this._("Total size of media objects")}</th>
          <td class="progress">
            <mwc-linear-progress
              progress="${l}"
            ></mwc-linear-progress>
          </td>
          <td class="numbers">
            ${Math.round(100*l)}%
            (&hairsp;${r}&thinsp;/&thinsp;${n}&hairsp;)
          </td>
        </tr>
        ${"usage_ai"in t?M`
              <tr>
                <th>${this._("Chat messages")}</th>
                <td class="progress">
                  <mwc-linear-progress
                    progress="${c}"
                  ></mwc-linear-progress>
                </td>
                <td class="numbers">
                  ${Math.round(100*c)}%
                  (&hairsp;${a}&thinsp;/&thinsp;${s}&hairsp;)
                </td>
              </tr>
            `:""}
      </table>
    `}renderLoading(){return M`
      <table>
        <tr>
          <th>${this._("Number of people")}</th>
          <td class="progress">
            <mwc-linear-progress indeterminate></mwc-linear-progress>
          </td>
          <td class="numbers">
            <span class="skeleton" style="width: 6em;">&nbsp;</span>
          </td>
        </tr>
        <tr>
          <th>${this._("Total size of media objects")}</th>
          <td class="progress">
            <mwc-linear-progress indeterminate></mwc-linear-progress>
          </td>
          <td class="numbers">
            <span class="skeleton" style="width: 7em;">&nbsp;</span>
          </td>
        </tr>
      </table>
    `}getUrl(){return"/api/trees/-"}});function FS(t,e=qS){const i=VS(t,e);return i&&(i.tabIndex=0,i.focus()),i}function NS(t,e=qS){const i=US(t,e);return i&&(i.tabIndex=0,i.focus()),i}function HS(t,e=qS){for(let i=0;i<t.length;i++){const r=t[i];if(0===r.tabIndex&&e(r))return{item:r,index:i}}return null}function VS(t,e=qS){for(const i of t)if(e(i))return i;return null}function US(t,e=qS){for(let i=t.length-1;i>=0;i--){const r=t[i];if(e(r))return r}return null}function YS(t,e,i=qS,r=!0){if(e){const n=function(t,e,i=qS,r=!0){for(let n=1;n<t.length;n++){const a=(n+e)%t.length;if(a<e&&!r)return null;const s=t[a];if(i(s))return s}return t[e]?t[e]:null}(t,e.index,i,r);return n&&(n.tabIndex=0,n.focus()),n}return FS(t,i)}function ZS(t,e,i=qS,r=!0){if(e){const n=function(t,e,i=qS,r=!0){for(let n=1;n<t.length;n++){const a=(e-n+t.length)%t.length;if(a>e&&!r)return null;const s=t[a];if(i(s))return s}return t[e]?t[e]:null}(t,e.index,i,r);return n&&(n.tabIndex=0,n.focus()),n}return NS(t,i)}function qS(t){return!t.disabled}window.customElements.define("grampsjs-view-admin-settings",class extends $d{static get styles(){return[super.styles,n`
        :host {
          margin: 0;
        }

        .card {
          padding: 1em 1em;
          border-radius: 16px;
          background-color: rgba(109, 76, 65, 0.12);
        }

        .pre {
          white-space: pre-line;
        }

        .danger-zone {
          font-size: 16px;
          padding: 0.8em 1.4em;
          border: 1px solid #bf360c;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .danger-zone div.text {
          order: 1;
          display: inline-block;
          padding-right: 1.2em;
        }

        .danger-zone div.button {
          float: right;
          order: 2;
          --mdc-button-outline-color: #bf360c;
          --mdc-theme-primary: #bf360c;
        }

        .danger-zone p {
          margin: 0.4em 0;
        }

        .bold {
          font-weight: 500;
        }

        mwc-icon.status {
          font-size: 18px;
          top: 4px;
          position: relative;
          margin-right: 5px;
        }

        .small {
          font-size: 16px;
        }
      `]}static get properties(){return{userData:{type:Array},dbInfo:{type:Object},userInfo:{type:Object},_repairResults:{type:Object},_buttonUpdateSearchDisabled:{type:Boolean},_buttonUpdateSearchSemanticDisabled:{type:Boolean}}}constructor(){super(),this.userData=[],this.dbInfo={},this.userInfo={},this._repairResults={},this._buttonUpdateSearchDisabled=!1,this._buttonUpdateSearchSemanticDisabled=!1}renderContent(){return M`
      <h3>${this._("Usage quotas")}</h3>

      <grampsjs-tree-quotas .strings="${this.strings}"></grampsjs-tree-quotas>

      <grampsjs-media-status .strings="${this.strings}"></grampsjs-media-status>
      ${this.dbInfo?.object_counts?.media?M`<grampsjs-media-file-status
            .strings="${this.strings}"
          ></grampsjs-media-file-status>`:""}

      <grampsjs-import .strings="${this.strings}"></grampsjs-import>

      <grampsjs-import-media .strings="${this.strings}"></grampsjs-import-media>

      <h3>${this._("Manage search index")}</h3>

      ${this._renderSearchStatus()}

      <p>
        ${this._("Manually updating the search index is usually unnecessary, but it may become necessary after an upgrade.")}
      </p>
      <mwc-button
        outlined
        ?disabled=${this._buttonUpdateSearchDisabled}
        @click="${()=>this._updateSearch(!1)}"
        @keydown="${gs}"
        >${this._("Update search index")}</mwc-button
      >
      <grampsjs-task-progress-indicator
        class="button"
        id="progress-update-search"
        taskName="searchReindexFull"
        size="20"
        pollInterval="0.2"
        @task:complete="${this._handleSuccessUpdateSearch}"
      ></grampsjs-task-progress-indicator>

      ${this.dbInfo?.server?.semantic_search?M`
            <h3>${this._("Manage semantic search index")}</h3>

            ${this._renderSearchStatus(!0)}

            <p>
              ${this._("Updating the semantic search index requires substantial time and computational resources. Run this operation only when necessary.")}
            </p>
            <mwc-button
              outlined
              ?disabled=${this._buttonUpdateSearchSemanticDisabled}
              @click="${()=>this._updateSearch(!0)}"
              @keydown="${gs}"
              >${this._("Update semantic search index")}</mwc-button
            >
            <grampsjs-task-progress-indicator
              class="button"
              id="progress-update-search-semantic"
              taskName="searchReindexFullSemantic"
              size="20"
              pollInterval="0.2"
              @task:complete="${this._handleSuccessUpdateSearch}"
            ></grampsjs-task-progress-indicator>
          `:""}
      <h3>${this._("Check and Repair Database")}</h3>

      <p>
        ${this._("This tool checks the database for integrity problems, fixing the problems it can.")}
      </p>
      <mwc-button
        outlined
        @click="${this._checkRepair}"
        @keydown="${gs}"
        >${this._("Check and Repair")}</mwc-button
      >
      <grampsjs-task-progress-indicator
        class="button"
        id="progress-repair"
        taskName="repairDb"
        size="20"
        pollInterval="0.2"
        @task:complete="${this._handleRepairComplete}"
      ></grampsjs-task-progress-indicator>

      ${void 0!==this._repairResults?.num_errors?M`<p class="card">
            ${0===this._repairResults.num_errors?this._("No errors were found: the database has passed internal checks."):M`<span class="pre">${this._repairResults.message}</span>`}
          </p>`:""}
      <h3>${this._("Danger Zone")}</h3>
      <div class="danger-zone">
        <div class="text">
          <p class="bold">${this._("Delete all objects")}</p>
          <p>
            ${this._("Clear the family tree by removing all existing objects. Optionally, select specific types of objects for deletion.")}
          </p>
        </div>
        <div class="button">
          <grampsjs-task-progress-indicator
            class="button-left"
            id="progress-delete-all"
            taskName="deleteObjects"
            size="20"
            pollInterval="0.2"
          ></grampsjs-task-progress-indicator>
          <mwc-button
            outlined
            @click="${this._openDeleteAll}"
            @keydown="${gs}"
            icon="delete_forever"
            >${this._("Delete")}</mwc-button
          >
        </div>
      </div>
      <grampsjs-delete-all
        .strings="${this.strings}"
        @delete-objects="${this._handleDeleteAll}"
      ></grampsjs-delete-all>
      <grampsjs-relogin
        .strings="${this.strings}"
        @relogin="${this._openDeleteAll}"
        username="${this.userInfo?.name||""}"
      ></grampsjs-relogin>
    `}_renderSearchStatus(t=!1){const e=t?"count_semantic":"count",i=this.dbInfo?.search?.sifts?.[e]??-1,r=this.dbInfo?.object_counts??{},n=Object.values(r).reduce(((t,e)=>t+e),0),a=M`<mwc-icon class="error status">error</mwc-icon>`,s=M`<mwc-icon class="success status"
      >check_circle</mwc-icon
    >`;return M`<p class="small">
      ${0===n||i/n>.98?s:a} ${this._("Status")}:
      ${-1===i?this._("unknown"):i}/${n}
    </p>`}_openDeleteAll(){!function(){const t=localStorage.getItem("access_token");return!(!t||"1"===t)&&!!(Sn(t)||{}).fresh}()?this.renderRoot.querySelector("grampsjs-relogin").show():this.renderRoot.querySelector("grampsjs-delete-all").show()}async _handleDeleteAll(t){const e=this.renderRoot.querySelector("#progress-delete-all");e.reset(),e.open=!0;const i=`/api/objects/delete/${t.detail.namespaces?`?namespaces=${t.detail.namespaces}`:""}`,r=await Nn(i,null,!0,!0,!0);"error"in r?(e.setError(),e.errorMessage=r.error):"task"in r?e.taskId=r.task?.id||"":(e.setComplete(),os(this,"db:changed"))}async _updateSearch(t=!1){const e=t?"progress-update-search-semantic":"progress-update-search",i=this.renderRoot.querySelector(`#${e}`);i.reset(),i.open=!0;const r=t?"/api/search/index/?full=1&semantic=1":"/api/search/index/?full=1";t?this._buttonUpdateSearchSemanticDisabled=!0:this._buttonUpdateSearchDisabled=!0;const n=await Nn(r);"error"in n?(i.setError(),i.errorMessage=n.error,this._doneUpdateSearch(t)):"task"in n?i.taskId=n.task?.id||"":(i.setComplete(),this._handleSuccessUpdateSearch(t))}_handleSuccessUpdateSearch(t=!1){this._doneUpdateSearch(t),os(this,"db:changed")}_doneUpdateSearch(t=!1){t?this._buttonUpdateSearchSemanticDisabled=!1:this._buttonUpdateSearchDisabled=!1}async _checkRepair(){this._repairResults={};const t=this.renderRoot.querySelector("#progress-repair");t.reset(),t.open=!0;const e=await Nn("/api/trees/-/repair");"error"in e?(t.setError(),t.errorMessage=e.error):"task"in e?t.taskId=e.task?.id||"":t.setComplete()}_handleRepairComplete(t){const e=t.detail?.status?.info;void 0!==e&&(this._repairResults=JSON.parse(e))}});const WS={ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",Home:"Home",End:"End"};class GS{constructor(t){this.handleKeydown=t=>{const e=t.key;if(t.defaultPrevented||!this.isNavigableKey(e))return;const i=this.items;if(!i.length)return;const r=HS(i,this.isActivatable);t.preventDefault();const n=this.isRtl();let a=null;switch(e){case WS.ArrowDown:case n?WS.ArrowLeft:WS.ArrowRight:a=YS(i,r,this.isActivatable,this.wrapNavigation());break;case WS.ArrowUp:case n?WS.ArrowRight:WS.ArrowLeft:a=ZS(i,r,this.isActivatable,this.wrapNavigation());break;case WS.Home:a=FS(i,this.isActivatable);break;case WS.End:a=NS(i,this.isActivatable)}a&&r&&r.item!==a&&(r.item.tabIndex=-1)},this.onDeactivateItems=()=>{const t=this.items;for(const e of t)this.deactivateItem(e)},this.onRequestActivation=t=>{this.onDeactivateItems();const e=t.target;this.activateItem(e),e.focus()},this.onSlotchange=()=>{const t=this.items;let e=!1;for(const i of t){!(!i.disabled&&i.tabIndex>-1)||e?i.tabIndex=-1:(e=!0,i.tabIndex=0)}if(e)return;const i=VS(t,this.isActivatable);i&&(i.tabIndex=0)};const{isItem:e,getPossibleItems:i,isRtl:r,deactivateItem:n,activateItem:a,isNavigableKey:s,isActivatable:o,wrapNavigation:l}=t;this.isItem=e,this.getPossibleItems=i,this.isRtl=r,this.deactivateItem=n,this.activateItem=a,this.isNavigableKey=s,this.isActivatable=o,this.wrapNavigation=l??(()=>!0)}get items(){const t=this.getPossibleItems(),e=[];for(const i of t){if(this.isItem(i)){e.push(i);continue}const t=i.item;t&&this.isItem(t)&&e.push(t)}return e}activateNextItem(){const t=this.items,e=HS(t,this.isActivatable);return e&&(e.item.tabIndex=-1),YS(t,e,this.isActivatable,this.wrapNavigation())}activatePreviousItem(){const t=this.items,e=HS(t,this.isActivatable);return e&&(e.item.tabIndex=-1),ZS(t,e,this.isActivatable,this.wrapNavigation())}}const XS=function(t,e){return new CustomEvent("close-menu",{bubbles:!0,composed:!0,detail:{initiator:t,reason:e,itemPath:[t]}})},KS={SPACE:"Space",ENTER:"Enter"},JS="click-selection",QS="keydown",tC={ESCAPE:"Escape",SPACE:KS.SPACE,ENTER:KS.ENTER};function eC(t){return Object.values(tC).some((e=>e===t))}function iC(t,e){const i=new Event("md-contains",{bubbles:!0,composed:!0});let r=[];const n=t=>{r=t.composedPath()};e.addEventListener("md-contains",n),t.dispatchEvent(i),e.removeEventListener("md-contains",n);return r.length>0}const rC="none",nC="list-root",aC="first-item",sC="last-item",oC="end-start",lC="start-start";class cC{constructor(t,e){this.host=t,this.getProperties=e,this.surfaceStylesInternal={display:"none"},this.lastValues={isOpen:!1},this.host.addController(this)}get surfaceStyles(){return this.surfaceStylesInternal}async position(){const{surfaceEl:t,anchorEl:e,anchorCorner:i,surfaceCorner:r,positioning:n,xOffset:a,yOffset:s,repositionStrategy:o}=this.getProperties(),l=i.toLowerCase().trim(),c=r.toLowerCase().trim();if(!t||!e)return;const d=window.innerWidth,h=window.innerHeight,p=document.createElement("div");p.style.opacity="0",p.style.position="fixed",p.style.display="block",p.style.inset="0",document.body.appendChild(p);const u=p.getBoundingClientRect();p.remove();const m=window.innerHeight-u.bottom,f=window.innerWidth-u.right;this.surfaceStylesInternal={display:"block",opacity:"0"},this.host.requestUpdate(),await this.host.updateComplete,t.popover&&t.isConnected&&t.showPopover();const g=t.getSurfacePositionClientRect?t.getSurfacePositionClientRect():t.getBoundingClientRect(),_=e.getSurfacePositionClientRect?e.getSurfacePositionClientRect():e.getBoundingClientRect(),[v,y]=c.split("-"),[b,x]=l.split("-"),w="ltr"===getComputedStyle(t).direction;let{blockInset:k,blockOutOfBoundsCorrection:T,surfaceBlockProperty:S}=this.calculateBlock({surfaceRect:g,anchorRect:_,anchorBlock:b,surfaceBlock:v,yOffset:s,positioning:n,windowInnerHeight:h,blockScrollbarHeight:m});if(T){const t="start"===v?"end":"start",e="start"===b?"end":"start",i=this.calculateBlock({surfaceRect:g,anchorRect:_,anchorBlock:e,surfaceBlock:t,yOffset:s,positioning:n,windowInnerHeight:h,blockScrollbarHeight:m});T>i.blockOutOfBoundsCorrection&&(k=i.blockInset,T=i.blockOutOfBoundsCorrection,S=i.surfaceBlockProperty)}let{inlineInset:C,inlineOutOfBoundsCorrection:E,surfaceInlineProperty:$}=this.calculateInline({surfaceRect:g,anchorRect:_,anchorInline:x,surfaceInline:y,xOffset:a,positioning:n,isLTR:w,windowInnerWidth:d,inlineScrollbarWidth:f});if(E){const t="start"===y?"end":"start",e="start"===x?"end":"start",i=this.calculateInline({surfaceRect:g,anchorRect:_,anchorInline:e,surfaceInline:t,xOffset:a,positioning:n,isLTR:w,windowInnerWidth:d,inlineScrollbarWidth:f});Math.abs(E)>Math.abs(i.inlineOutOfBoundsCorrection)&&(C=i.inlineInset,E=i.inlineOutOfBoundsCorrection,$=i.surfaceInlineProperty)}"move"===o&&(k-=T,C-=E),this.surfaceStylesInternal={display:"block",opacity:"1",[S]:`${k}px`,[$]:`${C}px`},"resize"===o&&(T&&(this.surfaceStylesInternal.height=g.height-T+"px"),E&&(this.surfaceStylesInternal.width=g.width-E+"px")),this.host.requestUpdate()}calculateBlock(t){const{surfaceRect:e,anchorRect:i,anchorBlock:r,surfaceBlock:n,yOffset:a,positioning:s,windowInnerHeight:o,blockScrollbarHeight:l}=t,c="fixed"===s||"document"===s?1:0,d="document"===s?1:0,h="start"===n?1:0,p="end"===n?1:0,u=(r!==n?1:0)*i.height+a,m=h*i.top+p*(o-i.bottom-l);return{blockInset:c*m+d*(h*window.scrollY-p*window.scrollY)+u,blockOutOfBoundsCorrection:Math.abs(Math.min(0,o-m-u-e.height)),surfaceBlockProperty:"start"===n?"inset-block-start":"inset-block-end"}}calculateInline(t){const{isLTR:e,surfaceInline:i,anchorInline:r,anchorRect:n,surfaceRect:a,xOffset:s,positioning:o,windowInnerWidth:l,inlineScrollbarWidth:c}=t,d="fixed"===o||"document"===o?1:0,h="document"===o?1:0,p=e?1:0,u=e?0:1,m="start"===i?1:0,f="end"===i?1:0,g=(r!==i?1:0)*n.width+s,_=p*(m*n.left+f*(l-n.right-c))+u*(m*(l-n.right-c)+f*n.left);let v="start"===i?"inset-inline-start":"inset-inline-end";return"document"!==o&&"fixed"!==o||(v="start"===i&&e||"end"===i&&!e?"left":"right"),{inlineInset:d*_+g+h*(p*(m*window.scrollX-f*window.scrollX)+u*(f*window.scrollX-m*window.scrollX)),inlineOutOfBoundsCorrection:Math.abs(Math.min(0,l-_-g-a.width)),surfaceInlineProperty:v}}hostUpdate(){this.onUpdate()}hostUpdated(){this.onUpdate()}async onUpdate(){const t=this.getProperties();let e=!1;for(const[i,r]of Object.entries(t))if(e=e||r!==this.lastValues[i],e)break;const i=this.lastValues.isOpen!==t.isOpen,r=!!t.anchorEl,n=!!t.surfaceEl;e&&r&&n&&(this.lastValues.isOpen=t.isOpen,t.isOpen?(this.lastValues=t,await this.position(),t.onOpen()):i&&(await t.beforeClose(),this.close(),t.onClose()))}close(){this.surfaceStylesInternal={display:"none"},this.host.requestUpdate();const t=this.getProperties().surfaceEl;t?.popover&&t?.isConnected&&t.hidePopover()}}const dC=0,hC=1,pC=2;class uC{constructor(t){this.getProperties=t,this.typeaheadRecords=[],this.typaheadBuffer="",this.cancelTypeaheadTimeout=0,this.isTypingAhead=!1,this.lastActiveRecord=null,this.onKeydown=t=>{this.isTypingAhead?this.typeahead(t):this.beginTypeahead(t)},this.endTypeahead=()=>{this.isTypingAhead=!1,this.typaheadBuffer="",this.typeaheadRecords=[]}}get items(){return this.getProperties().getItems()}get active(){return this.getProperties().active}beginTypeahead(t){this.active&&("Space"===t.code||"Enter"===t.code||t.code.startsWith("Arrow")||"Escape"===t.code||(this.isTypingAhead=!0,this.typeaheadRecords=this.items.map(((t,e)=>[e,t,t.typeaheadText.trim().toLowerCase()])),this.lastActiveRecord=this.typeaheadRecords.find((t=>0===t[hC].tabIndex))??null,this.lastActiveRecord&&(this.lastActiveRecord[hC].tabIndex=-1),this.typeahead(t)))}typeahead(t){if(t.defaultPrevented)return;if(clearTimeout(this.cancelTypeaheadTimeout),"Enter"===t.code||t.code.startsWith("Arrow")||"Escape"===t.code)return this.endTypeahead(),void(this.lastActiveRecord&&(this.lastActiveRecord[hC].tabIndex=-1));"Space"===t.code&&t.preventDefault(),this.cancelTypeaheadTimeout=setTimeout(this.endTypeahead,this.getProperties().typeaheadBufferTime),this.typaheadBuffer+=t.key.toLowerCase();const e=this.lastActiveRecord?this.lastActiveRecord[dC]:-1,i=this.typeaheadRecords.length,r=t=>(t[dC]+i-e)%i,n=this.typeaheadRecords.filter((t=>!t[hC].disabled&&t[pC].startsWith(this.typaheadBuffer))).sort(((t,e)=>r(t)-r(e)));if(0===n.length)return clearTimeout(this.cancelTypeaheadTimeout),this.lastActiveRecord&&(this.lastActiveRecord[hC].tabIndex=-1),void this.endTypeahead();const a=1===this.typaheadBuffer.length;let s;s=this.lastActiveRecord===n[0]&&a?n[1]??n[0]:n[0],this.lastActiveRecord&&(this.lastActiveRecord[hC].tabIndex=-1),this.lastActiveRecord=s,s[hC].tabIndex=0,s[hC].focus()}}const mC=new Set([WS.ArrowDown,WS.ArrowUp,WS.Home,WS.End]),fC=new Set([WS.ArrowLeft,WS.ArrowRight,...mC]);class gC extends $p{get openDirection(){return"start"===this.menuCorner.split("-")[0]?"DOWN":"UP"}get anchorElement(){return this.anchor?this.getRootNode().querySelector(`#${this.anchor}`):this.currentAnchorElement}set anchorElement(t){this.currentAnchorElement=t,this.requestUpdate("anchorElement")}constructor(){super(),this.anchor="",this.positioning="absolute",this.quick=!1,this.hasOverflow=!1,this.open=!1,this.xOffset=0,this.yOffset=0,this.typeaheadDelay=200,this.anchorCorner=oC,this.menuCorner=lC,this.stayOpenOnOutsideClick=!1,this.stayOpenOnFocusout=!1,this.skipRestoreFocus=!1,this.defaultFocus=aC,this.noNavigationWrap=!1,this.typeaheadActive=!0,this.isSubmenu=!1,this.pointerPath=[],this.isRepositioning=!1,this.openCloseAnimationSignal=function(){let t=null;return{start:()=>(t?.abort(),t=new AbortController,t.signal),finish(){t=null}}}(),this.listController=new GS({isItem:t=>t.hasAttribute("md-menu-item"),getPossibleItems:()=>this.slotItems,isRtl:()=>"rtl"===getComputedStyle(this).direction,deactivateItem:t=>{t.selected=!1,t.tabIndex=-1},activateItem:t=>{t.selected=!0,t.tabIndex=0},isNavigableKey:t=>{if(!this.isSubmenu)return fC.has(t);return t===("rtl"===getComputedStyle(this).direction?WS.ArrowLeft:WS.ArrowRight)||mC.has(t)},wrapNavigation:()=>!this.noNavigationWrap}),this.lastFocusedElement=null,this.typeaheadController=new uC((()=>({getItems:()=>this.items,typeaheadBufferTime:this.typeaheadDelay,active:this.typeaheadActive}))),this.currentAnchorElement=null,this.internals=this.attachInternals(),this.menuPositionController=new cC(this,(()=>({anchorCorner:this.anchorCorner,surfaceCorner:this.menuCorner,surfaceEl:this.surfaceEl,anchorEl:this.anchorElement,positioning:"popover"===this.positioning?"document":this.positioning,isOpen:this.open,xOffset:this.xOffset,yOffset:this.yOffset,onOpen:this.onOpened,beforeClose:this.beforeClose,onClose:this.onClosed,repositionStrategy:this.hasOverflow&&"popover"!==this.positioning?"move":"resize"}))),this.onWindowResize=()=>{this.isRepositioning||"document"!==this.positioning&&"fixed"!==this.positioning&&"popover"!==this.positioning||(this.isRepositioning=!0,this.reposition(),this.isRepositioning=!1)},this.handleFocusout=async t=>{const e=this.anchorElement;if(this.stayOpenOnFocusout||!this.open||this.pointerPath.includes(e))return;if(t.relatedTarget){if(iC(t.relatedTarget,this)||0!==this.pointerPath.length&&iC(t.relatedTarget,e))return}else if(this.pointerPath.includes(this))return;const i=this.skipRestoreFocus;this.skipRestoreFocus=!0,this.close(),await this.updateComplete,this.skipRestoreFocus=i},this.onOpened=async()=>{this.lastFocusedElement=function(t=document){let e=t.activeElement;for(;e&&e?.shadowRoot?.activeElement;)e=e.shadowRoot.activeElement;return e}();const t=this.items,e=HS(t);e&&this.defaultFocus!==rC&&(e.item.tabIndex=-1);let i=!this.quick;switch(this.quick?this.dispatchEvent(new Event("opening")):i=!!await this.animateOpen(),this.defaultFocus){case aC:const e=VS(t);e&&(e.tabIndex=0,e.focus(),await e.updateComplete);break;case sC:const i=US(t);i&&(i.tabIndex=0,i.focus(),await i.updateComplete);break;case nC:this.focus()}i||this.dispatchEvent(new Event("opened"))},this.beforeClose=async()=>{this.open=!1,this.skipRestoreFocus||this.lastFocusedElement?.focus?.(),this.quick||await this.animateClose()},this.onClosed=()=>{this.quick&&(this.dispatchEvent(new Event("closing")),this.dispatchEvent(new Event("closed")))},this.onWindowPointerdown=t=>{this.pointerPath=t.composedPath()},this.onDocumentClick=t=>{if(!this.open)return;const e=t.composedPath();this.stayOpenOnOutsideClick||e.includes(this)||e.includes(this.anchorElement)||(this.open=!1)},this.internals.role="menu",this.addEventListener("keydown",this.handleKeydown),this.addEventListener("keydown",this.captureKeydown,{capture:!0}),this.addEventListener("focusout",this.handleFocusout)}get items(){return this.listController.items}willUpdate(t){t.has("open")&&(this.open?this.removeAttribute("aria-hidden"):this.setAttribute("aria-hidden","true"))}update(t){t.has("open")&&(this.open?this.setUpGlobalEventListeners():this.cleanUpGlobalEventListeners()),t.has("positioning")&&"popover"===this.positioning&&!this.showPopover&&(this.positioning="fixed"),super.update(t)}connectedCallback(){super.connectedCallback(),this.open&&this.setUpGlobalEventListeners()}disconnectedCallback(){super.disconnectedCallback(),this.cleanUpGlobalEventListeners()}render(){return this.renderSurface()}renderSurface(){return dp`
      <div
        class="menu ${zp(this.getSurfaceClasses())}"
        style=${tu(this.menuPositionController.surfaceStyles)}
        popover=${"popover"===this.positioning?"manual":pp}>
        ${this.renderElevation()}
        <div class="items">
          <div class="item-padding"> ${this.renderMenuItems()} </div>
        </div>
      </div>
    `}renderMenuItems(){return dp`<slot
      @close-menu=${this.onCloseMenu}
      @deactivate-items=${this.onDeactivateItems}
      @request-activation=${this.onRequestActivation}
      @deactivate-typeahead=${this.handleDeactivateTypeahead}
      @activate-typeahead=${this.handleActivateTypeahead}
      @stay-open-on-focusout=${this.handleStayOpenOnFocusout}
      @close-on-focusout=${this.handleCloseOnFocusout}
      @slotchange=${this.listController.onSlotchange}></slot>`}renderElevation(){return dp`<md-elevation part="elevation"></md-elevation>`}getSurfaceClasses(){return{open:this.open,fixed:"fixed"===this.positioning,"has-overflow":this.hasOverflow}}captureKeydown(t){t.target===this&&!t.defaultPrevented&&eC(t.code)&&(t.preventDefault(),this.close()),this.typeaheadController.onKeydown(t)}async animateOpen(){const t=this.surfaceEl,e=this.slotEl;if(!t||!e)return!0;const i=this.openDirection;this.dispatchEvent(new Event("opening")),t.classList.toggle("animating",!0);const r=this.openCloseAnimationSignal.start(),n=t.offsetHeight,a="UP"===i,s=this.items,o=250/s.length,l=t.animate([{height:"0px"},{height:`${n}px`}],{duration:500,easing:jp}),c=e.animate([{transform:a?`translateY(-${n}px)`:""},{transform:""}],{duration:500,easing:jp}),d=t.animate([{opacity:0},{opacity:1}],50),h=[];for(let t=0;t<s.length;t++){const e=s[a?s.length-1-t:t],i=e.animate([{opacity:0},{opacity:1}],{duration:250,delay:o*t});e.classList.toggle("md-menu-hidden",!0),i.addEventListener("finish",(()=>{e.classList.toggle("md-menu-hidden",!1)})),h.push([e,i])}let p=t=>{};const u=new Promise((t=>{p=t}));return r.addEventListener("abort",(()=>{l.cancel(),c.cancel(),d.cancel(),h.forEach((([t,e])=>{t.classList.toggle("md-menu-hidden",!1),e.cancel()})),p(!0)})),l.addEventListener("finish",(()=>{t.classList.toggle("animating",!1),this.openCloseAnimationSignal.finish(),p(!1)})),await u}animateClose(){let t,e;const i=new Promise(((i,r)=>{t=i,e=r})),r=this.surfaceEl,n=this.slotEl;if(!r||!n)return e(),i;const a="UP"===this.openDirection;this.dispatchEvent(new Event("closing")),r.classList.toggle("animating",!0);const s=this.openCloseAnimationSignal.start(),o=r.offsetHeight,l=this.items,c=150,d=50/l.length,h=r.animate([{height:`${o}px`},{height:.35*o+"px"}],{duration:c,easing:Op}),p=n.animate([{transform:""},{transform:a?`translateY(-${.65*o}px)`:""}],{duration:c,easing:Op}),u=r.animate([{opacity:1},{opacity:0}],{duration:50,delay:100}),m=[];for(let t=0;t<l.length;t++){const e=l[a?t:l.length-1-t],i=e.animate([{opacity:1},{opacity:0}],{duration:50,delay:50+d*t});i.addEventListener("finish",(()=>{e.classList.toggle("md-menu-hidden",!0)})),m.push([e,i])}return s.addEventListener("abort",(()=>{h.cancel(),p.cancel(),u.cancel(),m.forEach((([t,e])=>{e.cancel(),t.classList.toggle("md-menu-hidden",!1)})),e()})),h.addEventListener("finish",(()=>{r.classList.toggle("animating",!1),m.forEach((([t])=>{t.classList.toggle("md-menu-hidden",!1)})),this.openCloseAnimationSignal.finish(),this.dispatchEvent(new Event("closed")),t(!0)})),i}handleKeydown(t){this.pointerPath=[],this.listController.handleKeydown(t)}setUpGlobalEventListeners(){document.addEventListener("click",this.onDocumentClick,{capture:!0}),window.addEventListener("pointerdown",this.onWindowPointerdown),document.addEventListener("resize",this.onWindowResize,{passive:!0}),window.addEventListener("resize",this.onWindowResize,{passive:!0})}cleanUpGlobalEventListeners(){document.removeEventListener("click",this.onDocumentClick,{capture:!0}),window.removeEventListener("pointerdown",this.onWindowPointerdown),document.removeEventListener("resize",this.onWindowResize),window.removeEventListener("resize",this.onWindowResize)}onCloseMenu(){this.close()}onDeactivateItems(t){t.stopPropagation(),this.listController.onDeactivateItems()}onRequestActivation(t){t.stopPropagation(),this.listController.onRequestActivation(t)}handleDeactivateTypeahead(t){t.stopPropagation(),this.typeaheadActive=!1}handleActivateTypeahead(t){t.stopPropagation(),this.typeaheadActive=!0}handleStayOpenOnFocusout(t){t.stopPropagation(),this.stayOpenOnFocusout=!0}handleCloseOnFocusout(t){t.stopPropagation(),this.stayOpenOnFocusout=!1}close(){this.open=!1;this.slotItems.forEach((t=>{t.close?.()}))}show(){this.open=!0}activateNextItem(){return this.listController.activateNextItem()??null}activatePreviousItem(){return this.listController.activatePreviousItem()??null}reposition(){this.open&&this.menuPositionController.position()}}it([Fh(".menu")],gC.prototype,"surfaceEl",void 0),it([Fh("slot")],gC.prototype,"slotEl",void 0),it([jh()],gC.prototype,"anchor",void 0),it([jh()],gC.prototype,"positioning",void 0),it([jh({type:Boolean})],gC.prototype,"quick",void 0),it([jh({type:Boolean,attribute:"has-overflow"})],gC.prototype,"hasOverflow",void 0),it([jh({type:Boolean,reflect:!0})],gC.prototype,"open",void 0),it([jh({type:Number,attribute:"x-offset"})],gC.prototype,"xOffset",void 0),it([jh({type:Number,attribute:"y-offset"})],gC.prototype,"yOffset",void 0),it([jh({type:Number,attribute:"typeahead-delay"})],gC.prototype,"typeaheadDelay",void 0),it([jh({attribute:"anchor-corner"})],gC.prototype,"anchorCorner",void 0),it([jh({attribute:"menu-corner"})],gC.prototype,"menuCorner",void 0),it([jh({type:Boolean,attribute:"stay-open-on-outside-click"})],gC.prototype,"stayOpenOnOutsideClick",void 0),it([jh({type:Boolean,attribute:"stay-open-on-focusout"})],gC.prototype,"stayOpenOnFocusout",void 0),it([jh({type:Boolean,attribute:"skip-restore-focus"})],gC.prototype,"skipRestoreFocus",void 0),it([jh({attribute:"default-focus"})],gC.prototype,"defaultFocus",void 0),it([jh({type:Boolean,attribute:"no-navigation-wrap"})],gC.prototype,"noNavigationWrap",void 0),it([Vh({flatten:!0})],gC.prototype,"slotItems",void 0),it([Oh()],gC.prototype,"typeaheadActive",void 0);const _C=vh`:host{--md-elevation-level: var(--md-menu-container-elevation, 2);--md-elevation-shadow-color: var(--md-menu-container-shadow-color, var(--md-sys-color-shadow, #000));min-width:112px;color:unset;display:contents}md-focus-ring{--md-focus-ring-shape: var(--md-menu-container-shape, var(--md-sys-shape-corner-extra-small, 4px))}.menu{border-radius:var(--md-menu-container-shape, var(--md-sys-shape-corner-extra-small, 4px));display:none;inset:auto;border:none;padding:0px;overflow:visible;background-color:rgba(0,0,0,0);color:inherit;opacity:0;z-index:20;position:absolute;user-select:none;max-height:inherit;height:inherit;min-width:inherit;max-width:inherit}.menu::backdrop{display:none}.fixed{position:fixed}.items{display:block;list-style-type:none;margin:0;outline:none;box-sizing:border-box;background-color:var(--md-menu-container-color, var(--md-sys-color-surface-container, #f3edf7));height:inherit;max-height:inherit;overflow:auto;min-width:inherit;max-width:inherit;border-radius:inherit}.item-padding{padding-block:8px}.has-overflow:not([popover]) .items{overflow:visible}.has-overflow.animating .items,.animating .items{overflow:hidden}.has-overflow.animating .items{pointer-events:none}.animating ::slotted(.md-menu-hidden){opacity:0}slot{display:block;height:inherit;max-height:inherit}::slotted(:is(md-divider,[role=separator])){margin:8px 0}@media(forced-colors: active){.menu{border-style:solid;border-color:CanvasText;border-width:1px}}
`;let vC=class extends gC{};vC.styles=[_C],vC=it([ph("md-menu")],vC);class yC extends Su{computeValidity(t){return this.selectControl||(this.selectControl=document.createElement("select")),Ep(dp`<option value=${t.value}></option>`,this.selectControl),this.selectControl.value=t.value,this.selectControl.required=t.required,{validity:this.selectControl.validity,validationMessage:this.selectControl.validationMessage}}equals(t,e){return t.value===e.value&&t.required===e.required}copy({value:t,required:e}){return{value:t,required:e}}}var bC;const xC=Symbol("value"),wC=ku(mu(_u(lu($p))));class kC extends wC{get value(){return this[xC]}set value(t){this.lastUserSetValue=t,this.select(t)}get options(){return this.menu?.items??[]}get selectedIndex(){const[t,e]=(this.getSelectedOptions()??[])[0]??[];return e??-1}set selectedIndex(t){this.lastUserSetSelectedIndex=t,this.selectIndex(t)}get selectedOptions(){return(this.getSelectedOptions()??[]).map((([t])=>t))}get hasError(){return this.error||this.nativeError}constructor(){super(),this.quick=!1,this.required=!1,this.errorText="",this.label="",this.supportingText="",this.error=!1,this.menuPositioning="popover",this.clampMenuWidth=!1,this.typeaheadDelay=200,this.hasLeadingIcon=!1,this.displayText="",this.menuAlign="start",this[bC]="",this.lastUserSetValue=null,this.lastUserSetSelectedIndex=null,this.lastSelectedOption=null,this.lastSelectedOptionRecords=[],this.nativeError=!1,this.nativeErrorText="",this.focused=!1,this.open=!1,this.defaultFocus=rC,this.prevOpen=this.open,this.selectWidth=0,this.addEventListener("focus",this.handleFocus.bind(this)),this.addEventListener("blur",this.handleBlur.bind(this))}select(t){const e=this.options.find((e=>e.value===t));e&&this.selectItem(e)}selectIndex(t){const e=this.options[t];e&&this.selectItem(e)}reset(){for(const t of this.options)t.selected=t.hasAttribute("selected");this.updateValueAndDisplayText(),this.nativeError=!1,this.nativeErrorText=""}[(bC=xC,vu)](t){t?.preventDefault();const e=this.getErrorText();this.nativeError=!!t,this.nativeErrorText=this.validationMessage,e===this.getErrorText()&&this.field?.reannounceError()}update(t){if(this.hasUpdated||this.initUserSelection(),this.prevOpen!==this.open&&this.open){const t=this.getBoundingClientRect();this.selectWidth=t.width}this.prevOpen=this.open,super.update(t)}render(){return dp`
      <span
        class="select ${zp(this.getRenderClasses())}"
        @focusout=${this.handleFocusout}>
        ${this.renderField()} ${this.renderMenu()}
      </span>
    `}async firstUpdated(t){await(this.menu?.updateComplete),this.lastSelectedOptionRecords.length||this.initUserSelection(),this.lastSelectedOptionRecords.length||this.options.length||setTimeout((()=>{this.updateValueAndDisplayText()})),super.firstUpdated(t)}getRenderClasses(){return{disabled:this.disabled,error:this.error,open:this.open}}renderField(){return Wp`
      <${this.fieldTag}
          aria-haspopup="listbox"
          role="combobox"
          part="field"
          id="field"
          tabindex=${this.disabled?"-1":"0"}
          aria-label=${this.ariaLabel||pp}
          aria-describedby="description"
          aria-expanded=${this.open?"true":"false"}
          aria-controls="listbox"
          class="field"
          label=${this.label}
          .focused=${this.focused||this.open}
          .populated=${!!this.displayText}
          .disabled=${this.disabled}
          .required=${this.required}
          .error=${this.hasError}
          ?has-start=${this.hasLeadingIcon}
          has-end
          supporting-text=${this.supportingText}
          error-text=${this.getErrorText()}
          @keydown=${this.handleKeydown}
          @click=${this.handleClick}>
         ${this.renderFieldContent()}
         <div id="description" slot="aria-describedby"></div>
      </${this.fieldTag}>`}renderFieldContent(){return[this.renderLeadingIcon(),this.renderLabel(),this.renderTrailingIcon()]}renderLeadingIcon(){return dp`
      <span class="icon leading" slot="start">
        <slot name="leading-icon" @slotchange=${this.handleIconChange}></slot>
      </span>
    `}renderTrailingIcon(){return dp`
      <span class="icon trailing" slot="end">
        <slot name="trailing-icon" @slotchange=${this.handleIconChange}>
          <svg height="5" viewBox="7 10 10 5" focusable="false">
            <polygon
              class="down"
              stroke="none"
              fill-rule="evenodd"
              points="7 10 12 15 17 10"></polygon>
            <polygon
              class="up"
              stroke="none"
              fill-rule="evenodd"
              points="7 15 12 10 17 15"></polygon>
          </svg>
        </slot>
      </span>
    `}renderLabel(){return dp`<div id="label">${this.displayText||dp`&nbsp;`}</div>`}renderMenu(){const t=this.label||this.ariaLabel;return dp`<div class="menu-wrapper">
      <md-menu
        id="listbox"
        .defaultFocus=${this.defaultFocus}
        role="listbox"
        tabindex="-1"
        aria-label=${t||pp}
        stay-open-on-focusout
        part="menu"
        exportparts="focus-ring: menu-focus-ring"
        anchor="field"
        style=${tu({"--__menu-min-width":`${this.selectWidth}px`,"--__menu-max-width":this.clampMenuWidth?`${this.selectWidth}px`:void 0})}
        no-navigation-wrap
        .open=${this.open}
        .quick=${this.quick}
        .positioning=${this.menuPositioning}
        .typeaheadDelay=${this.typeaheadDelay}
        .anchorCorner=${"start"===this.menuAlign?"end-start":"end-end"}
        .menuCorner=${"start"===this.menuAlign?"start-start":"start-end"}
        @opening=${this.handleOpening}
        @opened=${this.redispatchEvent}
        @closing=${this.redispatchEvent}
        @closed=${this.handleClosed}
        @close-menu=${this.handleCloseMenu}
        @request-selection=${this.handleRequestSelection}
        @request-deselection=${this.handleRequestDeselection}>
        ${this.renderMenuContent()}
      </md-menu>
    </div>`}renderMenuContent(){return dp`<slot></slot>`}handleKeydown(t){if(this.open||this.disabled||!this.menu)return;const e=this.menu.typeaheadController,i="Space"===t.code||"ArrowDown"===t.code||"ArrowUp"===t.code||"End"===t.code||"Home"===t.code||"Enter"===t.code;if(!e.isTypingAhead&&i){switch(t.preventDefault(),this.open=!0,t.code){case"Space":case"ArrowDown":case"Enter":this.defaultFocus=rC;break;case"End":this.defaultFocus=sC;break;case"ArrowUp":case"Home":this.defaultFocus=aC}return}if(1===t.key.length){e.onKeydown(t),t.preventDefault();const{lastActiveRecord:i}=e;if(!i)return;this.labelEl?.setAttribute?.("aria-live","polite");this.selectItem(i[hC])&&this.dispatchInteractionEvents()}}handleClick(){this.open=!this.open}handleFocus(){this.focused=!0}handleBlur(){this.focused=!1}handleFocusout(t){t.relatedTarget&&iC(t.relatedTarget,this)||(this.open=!1)}getSelectedOptions(){if(!this.menu)return this.lastSelectedOptionRecords=[],null;const t=this.menu.items;return this.lastSelectedOptionRecords=function(t){const e=[];for(let i=0;i<t.length;i++){const r=t[i];r.selected&&e.push([r,i])}return e}(t),this.lastSelectedOptionRecords}async getUpdateComplete(){return await(this.menu?.updateComplete),super.getUpdateComplete()}updateValueAndDisplayText(){const t=this.getSelectedOptions()??[];let e=!1;if(t.length){const[i]=t[0];e=this.lastSelectedOption!==i,this.lastSelectedOption=i,this[xC]=i.value,this.displayText=i.displayText}else e=null!==this.lastSelectedOption,this.lastSelectedOption=null,this[xC]="",this.displayText="";return e}async handleOpening(t){if(this.labelEl?.removeAttribute?.("aria-live"),this.redispatchEvent(t),this.defaultFocus!==rC)return;const e=this.menu.items,i=HS(e)?.item;let[r]=this.lastSelectedOptionRecords[0]??[null];i&&i!==r&&(i.tabIndex=-1),r=r??e[0],r&&(r.tabIndex=0,r.focus())}redispatchEvent(t){au(this,t)}handleClosed(t){this.open=!1,this.redispatchEvent(t)}handleCloseMenu(t){const e=t.detail.reason,i=t.detail.itemPath[0];this.open=!1;let r=!1;var n;"click-selection"===e.kind||"keydown"===e.kind&&(n=e.key,Object.values(KS).some((t=>t===n)))?r=this.selectItem(i):(i.tabIndex=-1,i.blur()),r&&this.dispatchInteractionEvents()}selectItem(t){return(this.getSelectedOptions()??[]).forEach((([e])=>{t!==e&&(e.selected=!1)})),t.selected=!0,this.updateValueAndDisplayText()}handleRequestSelection(t){const e=t.target;this.lastSelectedOptionRecords.some((([t])=>t===e))||this.selectItem(e)}handleRequestDeselection(t){const e=t.target;this.lastSelectedOptionRecords.some((([t])=>t===e))&&this.updateValueAndDisplayText()}initUserSelection(){this.lastUserSetValue&&!this.lastSelectedOptionRecords.length?this.select(this.lastUserSetValue):null===this.lastUserSetSelectedIndex||this.lastSelectedOptionRecords.length?this.updateValueAndDisplayText():this.selectIndex(this.lastUserSetSelectedIndex)}handleIconChange(){this.hasLeadingIcon=this.leadingIcons.length>0}dispatchInteractionEvents(){this.dispatchEvent(new Event("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0}))}getErrorText(){return this.error?this.errorText:this.nativeErrorText}[fu](){return this.value}formResetCallback(){this.reset()}formStateRestoreCallback(t){this.value=t}[cu](){return new yC((()=>this))}[du](){return this.field}}ru(kC),kC.shadowRootOptions={...$p.shadowRootOptions,delegatesFocus:!0},it([jh({type:Boolean})],kC.prototype,"quick",void 0),it([jh({type:Boolean})],kC.prototype,"required",void 0),it([jh({type:String,attribute:"error-text"})],kC.prototype,"errorText",void 0),it([jh()],kC.prototype,"label",void 0),it([jh({type:String,attribute:"supporting-text"})],kC.prototype,"supportingText",void 0),it([jh({type:Boolean,reflect:!0})],kC.prototype,"error",void 0),it([jh({attribute:"menu-positioning"})],kC.prototype,"menuPositioning",void 0),it([jh({type:Boolean,attribute:"clamp-menu-width"})],kC.prototype,"clampMenuWidth",void 0),it([jh({type:Number,attribute:"typeahead-delay"})],kC.prototype,"typeaheadDelay",void 0),it([jh({type:Boolean,attribute:"has-leading-icon"})],kC.prototype,"hasLeadingIcon",void 0),it([jh({attribute:"display-text"})],kC.prototype,"displayText",void 0),it([jh({attribute:"menu-align"})],kC.prototype,"menuAlign",void 0),it([jh()],kC.prototype,"value",null),it([jh({type:Number,attribute:"selected-index"})],kC.prototype,"selectedIndex",null),it([Oh()],kC.prototype,"nativeError",void 0),it([Oh()],kC.prototype,"nativeErrorText",void 0),it([Oh()],kC.prototype,"focused",void 0),it([Oh()],kC.prototype,"open",void 0),it([Oh()],kC.prototype,"defaultFocus",void 0),it([Fh(".field")],kC.prototype,"field",void 0),it([Fh("md-menu")],kC.prototype,"menu",void 0),it([Fh("#label")],kC.prototype,"labelEl",void 0),it([Vh({slot:"leading-icon",flatten:!0})],kC.prototype,"leadingIcons",void 0);class TC extends kC{constructor(){super(...arguments),this.fieldTag=Zp`md-filled-field`}}const SC=vh`:host{--_text-field-active-indicator-color: var(--md-filled-select-text-field-active-indicator-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-active-indicator-height: var(--md-filled-select-text-field-active-indicator-height, 1px);--_text-field-container-color: var(--md-filled-select-text-field-container-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_text-field-disabled-active-indicator-color: var(--md-filled-select-text-field-disabled-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-active-indicator-height: var(--md-filled-select-text-field-disabled-active-indicator-height, 1px);--_text-field-disabled-active-indicator-opacity: var(--md-filled-select-text-field-disabled-active-indicator-opacity, 0.38);--_text-field-disabled-container-color: var(--md-filled-select-text-field-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-container-opacity: var(--md-filled-select-text-field-disabled-container-opacity, 0.04);--_text-field-disabled-input-text-color: var(--md-filled-select-text-field-disabled-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-input-text-opacity: var(--md-filled-select-text-field-disabled-input-text-opacity, 0.38);--_text-field-disabled-label-text-color: var(--md-filled-select-text-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-label-text-opacity: var(--md-filled-select-text-field-disabled-label-text-opacity, 0.38);--_text-field-disabled-leading-icon-color: var(--md-filled-select-text-field-disabled-leading-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-leading-icon-opacity: var(--md-filled-select-text-field-disabled-leading-icon-opacity, 0.38);--_text-field-disabled-supporting-text-color: var(--md-filled-select-text-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-supporting-text-opacity: var(--md-filled-select-text-field-disabled-supporting-text-opacity, 0.38);--_text-field-disabled-trailing-icon-color: var(--md-filled-select-text-field-disabled-trailing-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-trailing-icon-opacity: var(--md-filled-select-text-field-disabled-trailing-icon-opacity, 0.38);--_text-field-error-active-indicator-color: var(--md-filled-select-text-field-error-active-indicator-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-active-indicator-color: var(--md-filled-select-text-field-error-focus-active-indicator-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-input-text-color: var(--md-filled-select-text-field-error-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-focus-label-text-color: var(--md-filled-select-text-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-leading-icon-color: var(--md-filled-select-text-field-error-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-focus-supporting-text-color: var(--md-filled-select-text-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-trailing-icon-color: var(--md-filled-select-text-field-error-focus-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_text-field-error-hover-active-indicator-color: var(--md-filled-select-text-field-error-hover-active-indicator-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-hover-input-text-color: var(--md-filled-select-text-field-error-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-hover-label-text-color: var(--md-filled-select-text-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-hover-leading-icon-color: var(--md-filled-select-text-field-error-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-hover-state-layer-color: var(--md-filled-select-text-field-error-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-hover-state-layer-opacity: var(--md-filled-select-text-field-error-hover-state-layer-opacity, 0.08);--_text-field-error-hover-supporting-text-color: var(--md-filled-select-text-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-hover-trailing-icon-color: var(--md-filled-select-text-field-error-hover-trailing-icon-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-input-text-color: var(--md-filled-select-text-field-error-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-label-text-color: var(--md-filled-select-text-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-leading-icon-color: var(--md-filled-select-text-field-error-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-supporting-text-color: var(--md-filled-select-text-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-trailing-icon-color: var(--md-filled-select-text-field-error-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_text-field-focus-active-indicator-color: var(--md-filled-select-text-field-focus-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_text-field-focus-active-indicator-height: var(--md-filled-select-text-field-focus-active-indicator-height, 3px);--_text-field-focus-input-text-color: var(--md-filled-select-text-field-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-focus-label-text-color: var(--md-filled-select-text-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_text-field-focus-leading-icon-color: var(--md-filled-select-text-field-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-focus-supporting-text-color: var(--md-filled-select-text-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-focus-trailing-icon-color: var(--md-filled-select-text-field-focus-trailing-icon-color, var(--md-sys-color-primary, #6750a4));--_text-field-hover-active-indicator-color: var(--md-filled-select-text-field-hover-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-active-indicator-height: var(--md-filled-select-text-field-hover-active-indicator-height, 1px);--_text-field-hover-input-text-color: var(--md-filled-select-text-field-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-label-text-color: var(--md-filled-select-text-field-hover-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-leading-icon-color: var(--md-filled-select-text-field-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-hover-state-layer-color: var(--md-filled-select-text-field-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-state-layer-opacity: var(--md-filled-select-text-field-hover-state-layer-opacity, 0.08);--_text-field-hover-supporting-text-color: var(--md-filled-select-text-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-hover-trailing-icon-color: var(--md-filled-select-text-field-hover-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-input-text-color: var(--md-filled-select-text-field-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-input-text-font: var(--md-filled-select-text-field-input-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-input-text-line-height: var(--md-filled-select-text-field-input-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_text-field-input-text-size: var(--md-filled-select-text-field-input-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_text-field-input-text-weight: var(--md-filled-select-text-field-input-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-label-text-color: var(--md-filled-select-text-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-label-text-font: var(--md-filled-select-text-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-label-text-line-height: var(--md-filled-select-text-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_text-field-label-text-populated-line-height: var(--md-filled-select-text-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_text-field-label-text-populated-size: var(--md-filled-select-text-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_text-field-label-text-size: var(--md-filled-select-text-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_text-field-label-text-weight: var(--md-filled-select-text-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-leading-icon-color: var(--md-filled-select-text-field-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-leading-icon-size: var(--md-filled-select-text-field-leading-icon-size, 24px);--_text-field-supporting-text-color: var(--md-filled-select-text-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-supporting-text-font: var(--md-filled-select-text-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-supporting-text-line-height: var(--md-filled-select-text-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_text-field-supporting-text-size: var(--md-filled-select-text-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_text-field-supporting-text-weight: var(--md-filled-select-text-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-trailing-icon-color: var(--md-filled-select-text-field-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-trailing-icon-size: var(--md-filled-select-text-field-trailing-icon-size, 24px);--_text-field-container-shape-start-start: var(--md-filled-select-text-field-container-shape-start-start, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_text-field-container-shape-start-end: var(--md-filled-select-text-field-container-shape-start-end, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_text-field-container-shape-end-end: var(--md-filled-select-text-field-container-shape-end-end, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_text-field-container-shape-end-start: var(--md-filled-select-text-field-container-shape-end-start, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--md-filled-field-active-indicator-color: var(--_text-field-active-indicator-color);--md-filled-field-active-indicator-height: var(--_text-field-active-indicator-height);--md-filled-field-container-color: var(--_text-field-container-color);--md-filled-field-container-shape-end-end: var(--_text-field-container-shape-end-end);--md-filled-field-container-shape-end-start: var(--_text-field-container-shape-end-start);--md-filled-field-container-shape-start-end: var(--_text-field-container-shape-start-end);--md-filled-field-container-shape-start-start: var(--_text-field-container-shape-start-start);--md-filled-field-content-color: var(--_text-field-input-text-color);--md-filled-field-content-font: var(--_text-field-input-text-font);--md-filled-field-content-line-height: var(--_text-field-input-text-line-height);--md-filled-field-content-size: var(--_text-field-input-text-size);--md-filled-field-content-weight: var(--_text-field-input-text-weight);--md-filled-field-disabled-active-indicator-color: var(--_text-field-disabled-active-indicator-color);--md-filled-field-disabled-active-indicator-height: var(--_text-field-disabled-active-indicator-height);--md-filled-field-disabled-active-indicator-opacity: var(--_text-field-disabled-active-indicator-opacity);--md-filled-field-disabled-container-color: var(--_text-field-disabled-container-color);--md-filled-field-disabled-container-opacity: var(--_text-field-disabled-container-opacity);--md-filled-field-disabled-content-color: var(--_text-field-disabled-input-text-color);--md-filled-field-disabled-content-opacity: var(--_text-field-disabled-input-text-opacity);--md-filled-field-disabled-label-text-color: var(--_text-field-disabled-label-text-color);--md-filled-field-disabled-label-text-opacity: var(--_text-field-disabled-label-text-opacity);--md-filled-field-disabled-leading-content-color: var(--_text-field-disabled-leading-icon-color);--md-filled-field-disabled-leading-content-opacity: var(--_text-field-disabled-leading-icon-opacity);--md-filled-field-disabled-supporting-text-color: var(--_text-field-disabled-supporting-text-color);--md-filled-field-disabled-supporting-text-opacity: var(--_text-field-disabled-supporting-text-opacity);--md-filled-field-disabled-trailing-content-color: var(--_text-field-disabled-trailing-icon-color);--md-filled-field-disabled-trailing-content-opacity: var(--_text-field-disabled-trailing-icon-opacity);--md-filled-field-error-active-indicator-color: var(--_text-field-error-active-indicator-color);--md-filled-field-error-content-color: var(--_text-field-error-input-text-color);--md-filled-field-error-focus-active-indicator-color: var(--_text-field-error-focus-active-indicator-color);--md-filled-field-error-focus-content-color: var(--_text-field-error-focus-input-text-color);--md-filled-field-error-focus-label-text-color: var(--_text-field-error-focus-label-text-color);--md-filled-field-error-focus-leading-content-color: var(--_text-field-error-focus-leading-icon-color);--md-filled-field-error-focus-supporting-text-color: var(--_text-field-error-focus-supporting-text-color);--md-filled-field-error-focus-trailing-content-color: var(--_text-field-error-focus-trailing-icon-color);--md-filled-field-error-hover-active-indicator-color: var(--_text-field-error-hover-active-indicator-color);--md-filled-field-error-hover-content-color: var(--_text-field-error-hover-input-text-color);--md-filled-field-error-hover-label-text-color: var(--_text-field-error-hover-label-text-color);--md-filled-field-error-hover-leading-content-color: var(--_text-field-error-hover-leading-icon-color);--md-filled-field-error-hover-state-layer-color: var(--_text-field-error-hover-state-layer-color);--md-filled-field-error-hover-state-layer-opacity: var(--_text-field-error-hover-state-layer-opacity);--md-filled-field-error-hover-supporting-text-color: var(--_text-field-error-hover-supporting-text-color);--md-filled-field-error-hover-trailing-content-color: var(--_text-field-error-hover-trailing-icon-color);--md-filled-field-error-label-text-color: var(--_text-field-error-label-text-color);--md-filled-field-error-leading-content-color: var(--_text-field-error-leading-icon-color);--md-filled-field-error-supporting-text-color: var(--_text-field-error-supporting-text-color);--md-filled-field-error-trailing-content-color: var(--_text-field-error-trailing-icon-color);--md-filled-field-focus-active-indicator-color: var(--_text-field-focus-active-indicator-color);--md-filled-field-focus-active-indicator-height: var(--_text-field-focus-active-indicator-height);--md-filled-field-focus-content-color: var(--_text-field-focus-input-text-color);--md-filled-field-focus-label-text-color: var(--_text-field-focus-label-text-color);--md-filled-field-focus-leading-content-color: var(--_text-field-focus-leading-icon-color);--md-filled-field-focus-supporting-text-color: var(--_text-field-focus-supporting-text-color);--md-filled-field-focus-trailing-content-color: var(--_text-field-focus-trailing-icon-color);--md-filled-field-hover-active-indicator-color: var(--_text-field-hover-active-indicator-color);--md-filled-field-hover-active-indicator-height: var(--_text-field-hover-active-indicator-height);--md-filled-field-hover-content-color: var(--_text-field-hover-input-text-color);--md-filled-field-hover-label-text-color: var(--_text-field-hover-label-text-color);--md-filled-field-hover-leading-content-color: var(--_text-field-hover-leading-icon-color);--md-filled-field-hover-state-layer-color: var(--_text-field-hover-state-layer-color);--md-filled-field-hover-state-layer-opacity: var(--_text-field-hover-state-layer-opacity);--md-filled-field-hover-supporting-text-color: var(--_text-field-hover-supporting-text-color);--md-filled-field-hover-trailing-content-color: var(--_text-field-hover-trailing-icon-color);--md-filled-field-label-text-color: var(--_text-field-label-text-color);--md-filled-field-label-text-font: var(--_text-field-label-text-font);--md-filled-field-label-text-line-height: var(--_text-field-label-text-line-height);--md-filled-field-label-text-populated-line-height: var(--_text-field-label-text-populated-line-height);--md-filled-field-label-text-populated-size: var(--_text-field-label-text-populated-size);--md-filled-field-label-text-size: var(--_text-field-label-text-size);--md-filled-field-label-text-weight: var(--_text-field-label-text-weight);--md-filled-field-leading-content-color: var(--_text-field-leading-icon-color);--md-filled-field-supporting-text-color: var(--_text-field-supporting-text-color);--md-filled-field-supporting-text-font: var(--_text-field-supporting-text-font);--md-filled-field-supporting-text-line-height: var(--_text-field-supporting-text-line-height);--md-filled-field-supporting-text-size: var(--_text-field-supporting-text-size);--md-filled-field-supporting-text-weight: var(--_text-field-supporting-text-weight);--md-filled-field-trailing-content-color: var(--_text-field-trailing-icon-color)}[has-start] .icon.leading{font-size:var(--_text-field-leading-icon-size);height:var(--_text-field-leading-icon-size);width:var(--_text-field-leading-icon-size)}.icon.trailing{font-size:var(--_text-field-trailing-icon-size);height:var(--_text-field-trailing-icon-size);width:var(--_text-field-trailing-icon-size)}
`,CC=vh`:host{color:unset;min-width:210px;display:flex}.field{cursor:default;outline:none}.select{position:relative;flex-direction:column}.icon.trailing svg,.icon ::slotted(*){fill:currentColor}.icon ::slotted(*){width:inherit;height:inherit;font-size:inherit}.icon slot{display:flex;height:100%;width:100%;align-items:center;justify-content:center}.icon.trailing :is(.up,.down){opacity:0;transition:opacity 75ms linear 75ms}.select:not(.open) .down,.select.open .up{opacity:1}.field,.select,md-menu{min-width:inherit;width:inherit;max-width:inherit;display:flex}md-menu{min-width:var(--__menu-min-width);max-width:var(--__menu-max-width, inherit)}.menu-wrapper{width:0px;height:0px;max-width:inherit}md-menu ::slotted(:not[disabled]){cursor:pointer}.field,.select{width:100%}:host{display:inline-flex}:host([disabled]){pointer-events:none}
`;let EC=class extends TC{};EC.styles=[CC,SC],EC=it([ph("md-filled-select")],EC);const $C=vh`:host{display:flex;--md-ripple-hover-color: var(--md-menu-item-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-hover-opacity: var(--md-menu-item-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-menu-item-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-pressed-opacity: var(--md-menu-item-pressed-state-layer-opacity, 0.12)}:host([disabled]){opacity:var(--md-menu-item-disabled-opacity, 0.3);pointer-events:none}md-focus-ring{z-index:1;--md-focus-ring-shape: 8px}a,button,li{background:none;border:none;padding:0;margin:0;text-align:unset;text-decoration:none}.list-item{border-radius:inherit;display:flex;flex:1;max-width:inherit;min-width:inherit;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.list-item:not(.disabled){cursor:pointer}[slot=container]{pointer-events:none}md-ripple{border-radius:inherit}md-item{border-radius:inherit;flex:1;color:var(--md-menu-item-label-text-color, var(--md-sys-color-on-surface, #1d1b20));font-family:var(--md-menu-item-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-menu-item-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));line-height:var(--md-menu-item-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));font-weight:var(--md-menu-item-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));min-height:var(--md-menu-item-one-line-container-height, 56px);padding-top:var(--md-menu-item-top-space, 12px);padding-bottom:var(--md-menu-item-bottom-space, 12px);padding-inline-start:var(--md-menu-item-leading-space, 16px);padding-inline-end:var(--md-menu-item-trailing-space, 16px)}md-item[multiline]{min-height:var(--md-menu-item-two-line-container-height, 72px)}[slot=supporting-text]{color:var(--md-menu-item-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-menu-item-supporting-text-font, var(--md-sys-typescale-body-medium-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-menu-item-supporting-text-size, var(--md-sys-typescale-body-medium-size, 0.875rem));line-height:var(--md-menu-item-supporting-text-line-height, var(--md-sys-typescale-body-medium-line-height, 1.25rem));font-weight:var(--md-menu-item-supporting-text-weight, var(--md-sys-typescale-body-medium-weight, var(--md-ref-typeface-weight-regular, 400)))}[slot=trailing-supporting-text]{color:var(--md-menu-item-trailing-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-menu-item-trailing-supporting-text-font, var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-menu-item-trailing-supporting-text-size, var(--md-sys-typescale-label-small-size, 0.6875rem));line-height:var(--md-menu-item-trailing-supporting-text-line-height, var(--md-sys-typescale-label-small-line-height, 1rem));font-weight:var(--md-menu-item-trailing-supporting-text-weight, var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500)))}:is([slot=start],[slot=end])::slotted(*){fill:currentColor}[slot=start]{color:var(--md-menu-item-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}[slot=end]{color:var(--md-menu-item-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}.list-item{background-color:var(--md-menu-item-container-color, transparent)}.list-item.selected{background-color:var(--md-menu-item-selected-container-color, var(--md-sys-color-secondary-container, #e8def8))}.selected:not(.disabled) ::slotted(*){color:var(--md-menu-item-selected-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b))}@media(forced-colors: active){:host([disabled]),:host([disabled]) slot{color:GrayText;opacity:1}.list-item{position:relative}.list-item.selected::before{content:"";position:absolute;inset:0;box-sizing:border-box;border-radius:inherit;pointer-events:none;border:3px double CanvasText}}
`;class AC extends $p{constructor(){super(...arguments),this.multiline=!1}render(){return dp`
      <slot name="container"></slot>
      <slot class="non-text" name="start"></slot>
      <div class="text">
        <slot name="overline" @slotchange=${this.handleTextSlotChange}></slot>
        <slot
          class="default-slot"
          @slotchange=${this.handleTextSlotChange}></slot>
        <slot name="headline" @slotchange=${this.handleTextSlotChange}></slot>
        <slot
          name="supporting-text"
          @slotchange=${this.handleTextSlotChange}></slot>
      </div>
      <slot class="non-text" name="trailing-supporting-text"></slot>
      <slot class="non-text" name="end"></slot>
    `}handleTextSlotChange(){let t=!1,e=0;for(const i of this.textSlots)if(IC(i)&&(e+=1),e>1){t=!0;break}this.multiline=t}}function IC(t){for(const e of t.assignedNodes({flatten:!0})){const t=e.nodeType===Node.ELEMENT_NODE,i=e.nodeType===Node.TEXT_NODE&&e.textContent?.match(/\S/);if(t||i)return!0}return!1}it([jh({type:Boolean,reflect:!0})],AC.prototype,"multiline",void 0),it([function(t){return(e,i)=>Bh(e,i,{get(){return(this.renderRoot??(Nh??=document.createDocumentFragment())).querySelectorAll(t)}})}(".text slot")],AC.prototype,"textSlots",void 0);const MC=vh`:host{color:var(--md-sys-color-on-surface, #1d1b20);font-family:var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-body-large-size, 1rem);font-weight:var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400));line-height:var(--md-sys-typescale-body-large-line-height, 1.5rem);align-items:center;box-sizing:border-box;display:flex;gap:16px;min-height:56px;overflow:hidden;padding:12px 16px;position:relative;text-overflow:ellipsis}:host([multiline]){min-height:72px}[name=overline]{color:var(--md-sys-color-on-surface-variant, #49454f);font-family:var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-label-small-size, 0.6875rem);font-weight:var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500));line-height:var(--md-sys-typescale-label-small-line-height, 1rem)}[name=supporting-text]{color:var(--md-sys-color-on-surface-variant, #49454f);font-family:var(--md-sys-typescale-body-medium-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-body-medium-size, 0.875rem);font-weight:var(--md-sys-typescale-body-medium-weight, var(--md-ref-typeface-weight-regular, 400));line-height:var(--md-sys-typescale-body-medium-line-height, 1.25rem)}[name=trailing-supporting-text]{color:var(--md-sys-color-on-surface-variant, #49454f);font-family:var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-label-small-size, 0.6875rem);font-weight:var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500));line-height:var(--md-sys-typescale-label-small-line-height, 1rem)}[name=container]::slotted(*){inset:0;position:absolute}.default-slot{display:inline}.default-slot,.text ::slotted(*){overflow:hidden;text-overflow:ellipsis}.text{display:flex;flex:1;flex-direction:column;overflow:hidden}
`;let LC=class extends AC{};LC.styles=[MC],LC=it([ph("md-item")],LC);class PC{constructor(t,e){this.host=t,this.internalTypeaheadText=null,this.onClick=()=>{this.host.keepOpen||this.host.dispatchEvent(XS(this.host,{kind:JS}))},this.onKeydown=t=>{if(this.host.href&&"Enter"===t.code){const t=this.getInteractiveElement();t instanceof HTMLAnchorElement&&t.click()}if(t.defaultPrevented)return;const e=t.code;this.host.keepOpen&&"Escape"!==e||eC(e)&&(t.preventDefault(),this.host.dispatchEvent(XS(this.host,{kind:QS,key:e})))},this.getHeadlineElements=e.getHeadlineElements,this.getSupportingTextElements=e.getSupportingTextElements,this.getDefaultElements=e.getDefaultElements,this.getInteractiveElement=e.getInteractiveElement,this.host.addController(this)}get typeaheadText(){if(null!==this.internalTypeaheadText)return this.internalTypeaheadText;const t=this.getHeadlineElements(),e=[];return t.forEach((t=>{t.textContent&&t.textContent.trim()&&e.push(t.textContent.trim())})),0===e.length&&this.getDefaultElements().forEach((t=>{t.textContent&&t.textContent.trim()&&e.push(t.textContent.trim())})),0===e.length&&this.getSupportingTextElements().forEach((t=>{t.textContent&&t.textContent.trim()&&e.push(t.textContent.trim())})),e.join(" ")}get tagName(){switch(this.host.type){case"link":return"a";case"button":return"button";default:return"li"}}get role(){return"option"===this.host.type?"option":"menuitem"}hostConnected(){this.host.toggleAttribute("md-menu-item",!0)}hostUpdate(){this.host.href&&(this.host.type="link")}setTypeaheadText(t){this.internalTypeaheadText=t}}class RC{get role(){return this.menuItemController.role}get typeaheadText(){return this.menuItemController.typeaheadText}setTypeaheadText(t){this.menuItemController.setTypeaheadText(t)}get displayText(){return null!==this.internalDisplayText?this.internalDisplayText:this.menuItemController.typeaheadText}setDisplayText(t){this.internalDisplayText=t}constructor(t,e){this.host=t,this.internalDisplayText=null,this.lastSelected=this.host.selected,this.firstUpdate=!0,this.onClick=()=>{this.menuItemController.onClick()},this.onKeydown=t=>{this.menuItemController.onKeydown(t)},this.menuItemController=new PC(t,e),t.addController(this)}hostUpdate(){this.lastSelected!==this.host.selected&&(this.host.ariaSelected=this.host.selected?"true":"false")}hostUpdated(){this.lastSelected===this.host.selected||this.firstUpdate||(this.host.selected?this.host.dispatchEvent(new Event("request-selection",{bubbles:!0,composed:!0})):this.host.dispatchEvent(new Event("request-deselection",{bubbles:!0,composed:!0}))),this.lastSelected=this.host.selected,this.firstUpdate=!1}}class zC extends $p{constructor(){super(...arguments),this.disabled=!1,this.isMenuItem=!0,this.selected=!1,this.value="",this.type="option",this.selectOptionController=new RC(this,{getHeadlineElements:()=>this.headlineElements,getSupportingTextElements:()=>this.supportingTextElements,getDefaultElements:()=>this.defaultElements,getInteractiveElement:()=>this.listItemRoot})}get typeaheadText(){return this.selectOptionController.typeaheadText}set typeaheadText(t){this.selectOptionController.setTypeaheadText(t)}get displayText(){return this.selectOptionController.displayText}set displayText(t){this.selectOptionController.setDisplayText(t)}render(){return this.renderListItem(dp`
      <md-item>
        <div slot="container">
          ${this.renderRipple()} ${this.renderFocusRing()}
        </div>
        <slot name="start" slot="start"></slot>
        <slot name="end" slot="end"></slot>
        ${this.renderBody()}
      </md-item>
    `)}renderListItem(t){return dp`
      <li
        id="item"
        tabindex=${this.disabled?-1:0}
        role=${this.selectOptionController.role}
        aria-label=${this.ariaLabel||pp}
        aria-selected=${this.ariaSelected||pp}
        aria-checked=${this.ariaChecked||pp}
        aria-expanded=${this.ariaExpanded||pp}
        aria-haspopup=${this.ariaHasPopup||pp}
        class="list-item ${zp(this.getRenderClasses())}"
        @click=${this.selectOptionController.onClick}
        @keydown=${this.selectOptionController.onKeydown}
        >${t}</li
      >
    `}renderRipple(){return dp` <md-ripple
      part="ripple"
      for="item"
      ?disabled=${this.disabled}></md-ripple>`}renderFocusRing(){return dp` <md-focus-ring
      part="focus-ring"
      for="item"
      inward></md-focus-ring>`}getRenderClasses(){return{disabled:this.disabled,selected:this.selected}}renderBody(){return dp`
      <slot></slot>
      <slot name="overline" slot="overline"></slot>
      <slot name="headline" slot="headline"></slot>
      <slot name="supporting-text" slot="supporting-text"></slot>
      <slot
        name="trailing-supporting-text"
        slot="trailing-supporting-text"></slot>
    `}focus(){this.listItemRoot?.focus()}}ru(zC),zC.shadowRootOptions={...$p.shadowRootOptions,delegatesFocus:!0},it([jh({type:Boolean,reflect:!0})],zC.prototype,"disabled",void 0),it([jh({type:Boolean,attribute:"md-menu-item",reflect:!0})],zC.prototype,"isMenuItem",void 0),it([jh({type:Boolean})],zC.prototype,"selected",void 0),it([jh()],zC.prototype,"value",void 0),it([Fh(".list-item")],zC.prototype,"listItemRoot",void 0),it([Vh({slot:"headline"})],zC.prototype,"headlineElements",void 0),it([Vh({slot:"supporting-text"})],zC.prototype,"supportingTextElements",void 0),it([Uh({slot:""})],zC.prototype,"defaultElements",void 0),it([jh({attribute:"typeahead-text"})],zC.prototype,"typeaheadText",null),it([jh({attribute:"display-text"})],zC.prototype,"displayText",null);let DC=class extends zC{};DC.styles=[$C],DC=it([ph("md-select-option")],DC);const jC={"-2":"unconfirmed","-1":"disabled",0:"Guest",1:"Member",2:"Contributor",3:"Editor",4:"Owner",5:"Administrator"};class OC extends(al(K)){static get styles(){return[nl,n`
        mwc-textfield.fullwidth {
          width: 100%;
        }

        .hide {
          display: none;
        }

        mwc-icon-button {
          color: rgba(0, 0, 0, 0.5);
        }
      `]}static get properties(){return{data:{type:Object},ismulti:{type:Boolean},isFormValid:{type:Boolean},newUser:{type:Boolean}}}constructor(){super(),this.data={},this.ismulti=!1,this.isFormValid=!1,this.newUser=!1}render(){return M`
      <p>
        <grampsjs-form-string
          required
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="name"
          ?hidden="${!this.newUser}"
          label="${this._("Username: ").replace(":","")}"
          value="${this.data.name||""}"
        ></grampsjs-form-string>
      </p>
      ${this.newUser?M`
            <p>
              <grampsjs-form-string
                required
                @formdata:changed="${this._handleFormData}"
                fullwidth
                id="password"
                type="password"
                label="${this._("Password: ").replace(":","")}"
                value="${this.data.password||""}"
              ></grampsjs-form-string>
            </p>
          `:""}
      <p>
        <grampsjs-form-string
          required
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="full_name"
          label="${this._("Full Name")}"
          value="${this.data.full_name||""}"
        ></grampsjs-form-string>
      </p>
      <p>
        <grampsjs-form-string
          required
          @formdata:changed="${this._handleFormData}"
          fullwidth
          id="email"
          label="${this._("E-mail")}"
          type="email"
          value="${this.data.email||""}"
        ></grampsjs-form-string>
      </p>
      <p>
        <mwc-select
          fixedMenuPosition
          @selected="${this._handleRoleChange}"
          id="role"
          style="width: 100%;"
        >
          ${Object.keys(jC).map(Number).sort(((t,e)=>t-e)).filter((t=>t<=4||this.ismulti)).map((t=>M`
                <mwc-list-item
                  value="${t}"
                  ?selected="${void 0===this.data.role?0===t:t===this.data.role}"
                  >${this._(jC[t])}
                </mwc-list-item>
              `))}
        </mwc-select>
      </p>
    `}reset(){this.shadowRoot.querySelectorAll("grampsjs-form-string").forEach((t=>t.reset()))}_handleFormData(t){const e=t.composedPath()[0];this.data={...this.data,[e.id]:t.detail.data},t.stopPropagation(),this._checkFormValid()}_handleRoleChange(t){const e=t.detail.index,i=Object.keys(jC).map(Number).sort(((t,e)=>t-e)),r=i[e];this.data={...this.data,role:r},this._checkFormValid()}_checkFormValid(){const t=Array.from(this.shadowRoot.querySelectorAll("grampsjs-form-string"));this.isFormValid=t.every((t=>t.isValid()))}}window.customElements.define("grampsjs-form-user",OC);window.customElements.define("grampsjs-users",class extends Ik{static get properties(){return{dialogContent:{type:String},ismulti:{type:Boolean},_downloadUrl:{type:String},_userData:{type:Array}}}constructor(){super(),this.dialogContent="",this.ismulti=!1,this._downloadUrl="",this._userData=[]}render(){return 0===this.data.length?M``:M`
      ${this._renderButtons()}
      <table>
        <tr>
          <th>${this._("Username: ").replace(":","")}</th>
          <th>${this._("Full Name")}</th>
          <th>${this._("E-mail")}</th>
          <th>${this._("Role")}</th>
          <th></th>
        </tr>
        ${this.data.map(((t,e)=>M`
            <tr>
              <td>${t.name}</td>
              <td>${t.full_name}</td>
              <td>${t.email}</td>
              <td>${this._(jC[t.role])}</td>
              <td>
                <mwc-icon-button
                  class="edit"
                  icon="edit"
                  @click="${e=>this._handleEditClick(e,t.name)}"
                  id="button-edit-${e}"
                ></mwc-icon-button>
                <grampsjs-tooltip for="button-edit-${e}">
                  ${this._("Edit user")}
                </grampsjs-tooltip>
              </td>
            </tr>
          `))}
      </table>
      ${this.dialogContent}
    `}_renderButtons(){return M`
      <p>
        <mwc-icon-button
          class="edit"
          icon="person_add"
          @click="${this._handleAddClick}"
          id="button-add"
        ></mwc-icon-button>
        <grampsjs-tooltip for="button-add">
          ${this._("Add a new user")}
        </grampsjs-tooltip>

        <mwc-icon-button
          class="edit"
          icon="group_add"
          id="button-import"
          @click="${this._handleImportClick}"
        ></mwc-icon-button>
        <grampsjs-tooltip for="button-import">
          ${this._("Import user accounts")}
        </grampsjs-tooltip>

        <mwc-icon-button
          class="edit"
          icon="file_download"
          id="button-export"
          @click="${this._handleExportClick}"
        ></mwc-icon-button>
        <grampsjs-tooltip for="button-export">
          ${this._("Export user details")}
        </grampsjs-tooltip>
        <a
          download="grampsweb-export-users.json"
          href="${this._downloadUrl}"
          id="downloadanchor"
          >&nbsp;</a
        >
      </p>
    `}_handleEditClick(t,e){this.dialogContent=this._editUserDialog(e),this._openDialog()}_handleAddClick(){this.dialogContent=this._addUserDialog(),this._openDialog()}_openDialog(){const t=this.shadowRoot.querySelector("mwc-dialog");null!==t&&(t.open=!0)}_handleImportClick(){this._userData=[],this.dialogContent=this._importUsersDialog(),this._openDialog()}async _handleExportClick(){this._downloadUrl="";const t=new Blob([JSON.stringify(this.data)],{type:"application/json"});this._downloadUrl=URL.createObjectURL(t)}_importUsersDialog(){return M`
      <mwc-dialog
        scrimClickAction=""
        escapeKeyAction=""
        open
        heading="${this._("Import user accounts")}"
      >
        <grampsjs-form-upload
          accept=".json"
          filename
          @formdata:changed="${this._handleUploadChanged}"
        ></grampsjs-form-upload>

        <mwc-button
          slot="primaryAction"
          dialogAction="ok"
          ?disabled="${0===this._userData.length}"
          @click="${this._handleUpload}"
        >
          ${this._("Import")}
        </mwc-button>
        <mwc-button
          slot="secondaryAction"
          dialogAction="cancel"
          @click="${this._handleDialogCancel}"
        >
          ${this._("Cancel")}
        </mwc-button>
      </mwc-dialog>
    `}async _handleUploadChanged(){const t=this.shadowRoot.querySelector("grampsjs-form-upload");try{const e=await t.readAsJson();this._processUserData(e)}catch{return t.reset(),void os(this,"grampsjs:error",{message:this._("Error parsing JSON file")})}this.dialogContent=this._importUsersDialog()}_processUserData(t){const e=t.map((t=>({name:t.name,full_name:t.full_name,email:t.email,role:t.role}))).filter((t=>!!t.name));this._userData=e}async _handleUpload(){const t=this.shadowRoot.querySelector("grampsjs-form-upload");os(this,"user:added-multiple",this._userData),t.reset()}_handleDialogCancel(){this.shadowRoot.querySelector("grampsjs-form-upload").reset()}_startDownload(){this.shadowRoot.querySelector("#downloadanchor").click(),URL.revokeObjectURL(this._downloadUrl),this._downloadUrl=""}_editUserDialog(t){const[e]=this.data.filter((e=>e.name===t));return M`
      <mwc-dialog
        scrimClickAction=""
        escapeKeyAction=""
        open
        heading="${this._("Edit user")} &ndash; ${t}"
      >
        <grampsjs-form-user
          .data="${e}"
          .strings="${this.strings}"
          ?ismulti="${this.ismulti}"
        ></grampsjs-form-user>
        <mwc-button
          slot="primaryAction"
          dialogAction="ok"
          @click="${this._handleSave}"
        >
          ${this._("_Save")}
        </mwc-button>
        <mwc-button slot="secondaryAction" dialogAction="cancel">
          ${this._("Cancel")}
        </mwc-button>
      </mwc-dialog>
    `}_addUserDialog(){return M`
      <mwc-dialog
        scrimClickAction=""
        escapeKeyAction=""
        open
        heading="${this._("Add a new user")}"
      >
        <grampsjs-form-user
          newUser
          .strings="${this.strings}"
          ?ismulti="${this.ismulti}"
        ></grampsjs-form-user>
        <mwc-button
          slot="primaryAction"
          dialogAction="ok"
          @click="${this._handleSave}"
        >
          ${this._("_Save")}
        </mwc-button>
        <mwc-button slot="secondaryAction" dialogAction="cancel">
          ${this._("Cancel")}
        </mwc-button>
      </mwc-dialog>
    `}_handleSave(){const t=this.shadowRoot.querySelector("grampsjs-form-user");if(null!==t){os(this,this.data.map((t=>t.name)).includes(t.data.name)?"user:updated":"user:added",t.data),this.dialogContent=""}}updated(t){t.has("_downloadUrl")&&this._downloadUrl&&this._startDownload()}});const BC={4:"Owners and administrators",3:"Editor and above",2:"Contributor and above",1:"Member and above",0:"Everybody",99:"Nobody"};window.customElements.define("grampsjs-chat-permissions",class extends fm{static get styles(){return[nl,n`
        p {
          padding-bottom: 15px;
        }

        .margin-left {
          margin-left: 1em;
        }

        .hidden {
          visibility: hidden;
        }
      `]}renderContent(){let t=this._data?.data?.min_role_ai??99;return t=t>5?99:t,M`<p>
      ${this._("User groups allowed to use AI chat:")}
      <md-filled-select
        id="select-role-ai"
        class="margin-left"
        @change="${this._handleChange}"
      >
        ${Object.keys(BC).map((e=>M`
            <md-select-option
              value="${e}"
              ?selected="${`${e}`==`${t}`}"
            >
              <div slot="headline">${this._(BC[e])}</div>
            </md-select-option>
          `))}
      </md-filled-select>
    </p> `}renderLoading(){return M`
      <p>
        ${this._("User groups allowed to use AI chat:")}
        <span class="skeleton margin-left">
          <md-filled-select class="hidden"> </md-filled-select>
        </span>
      </p>
    `}async _handleChange(t){const e={min_role_ai:parseInt(t.target.value,10)},i=await Fn("/api/trees/-",e);"error"in i?os(this,"grampsjs:error",{message:i.error}):os(this,"token:refresh",{})}getUrl(){return"/api/trees/-"}});window.customElements.define("grampsjs-view-user-management",class extends $d{static get styles(){return[super.styles,n`
        :host {
          margin: 0 15px;
        }

        grampsjs-share-url {
          --mdc-icon-size: 18px;
          --mdc-icon-button-size: 32px;
          position: relative;
          top: -5px;
          color: rgba(0, 0, 0, 0.4);
        }

        span.url {
          border-radius: 5px;
          border: 1px solid #ddd;
          font-size: 13px;
          padding: 6px 6px;
          color: #444;
        }
      `]}static get properties(){return{userData:{type:Array},dbInfo:{type:Object}}}constructor(){super(),this.userData=[],this.dbInfo={}}get _registerUrl(){const t=new URL(document.URL),e=An();return`${t.origin}/register/${e}`}renderContent(){return M`
      ${this.dbInfo?.server?.chat?M`<grampsjs-chat-permissions
            .strings=${this.strings}
          ></grampsjs-chat-permissions>`:""}
      ${this.dbInfo?.server?.multi_tree?M` <p>
            ${this._("Registration link")}:
            <span class="url">${this._registerUrl}</span>
            <grampsjs-share-url
              href="${this._registerUrl}"
            ></grampsjs-share-url>
          </p>`:""}

      <grampsjs-users
        .strings="${this.strings}"
        .data="${this.userData}"
        ?ismulti="${!!this.dbInfo?.server?.multi_tree}"
        @user:updated="${this._handleUserChanged}"
        @user:added="${this._handleUserAdded}"
        @user:added-multiple="${this._handleUsersAdded}"
      >
      </grampsjs-users>
    `}firstUpdated(){this._fetchUserData()}_handleUserChanged(t){const e=t.detail;this._updateUser(t.detail.name,{role:e.role,email:e.email,full_name:e.full_name})}_handleUserAdded(t){const e=t.detail;this._addUser(t.detail.name,{role:e.role,email:e.email,full_name:e.full_name,password:e.password})}async _handleUsersAdded(t){const e=await Nn("/api/users/",t.detail);"error"in e?(this.error=!0,this._errorMessage=e.error):(this.error=!1,this._fetchUserData())}_updateUser(t,e){Fn(`/api/users/${t}/`,e).then((t=>{"error"in t?(this.error=!0,this._errorMessage=t.error):(this.error=!1,this._fetchUserData())}))}_addUser(t,e){Nn(`/api/users/${t}/`,e).then((t=>{"error"in t?(this.error=!0,this._errorMessage=t.error):(this.error=!1,this._fetchUserData())}))}_fetchUserData(){this.loading=!0,On("/api/users/").then((t=>{"data"in t?(this.error=!1,this.userData=t.data):"error"in t&&(this.error=!0,this._errorMessage=t.error),this.loading=!1}))}});class FC extends(al(K)){static get styles(){return[nl,n`
        div.copy {
          border: 1px solid rgba(0, 0, 0, 0.2);
          border-radius: 5px;
          padding: 20px;
          max-width: 20em;
          line-height: 26px;
          font-size: 16px;
        }

        div.copy mwc-icon-button {
          color: rgba(0, 0, 0, 0.3);
          --mdc-icon-size: 16px;
          float: right;
        }
      `]}static get properties(){return{data:{type:Object}}}constructor(){super(),this.data={}}render(){return M`
      <div class="copy">
        <mwc-icon-button
          icon="content_copy"
          id="copy-button"
          @click=${this._copyToClipboard}
        ></mwc-icon-button>
        <grampsjs-tooltip for="copy-button" .strings="${this.strings}"
          >${this._("Copy to clipboard")}</grampsjs-tooltip
        >
        <span id="copy">
          Gramps ${this.data?.gramps?.version||"?"}<br />
          Gramps Web API ${this.data?.gramps_webapi?.version||"?"}<br />
          Gramps Web Frontend ${"24.12.0"}<br />
          Gramps QL ${this.data?.gramps_ql?.version||"?"}<br />
          Sifts ${this.data?.search?.sifts?.version||"?"}<br />
          locale: ${this.data?.locale?.language}<br />
          multi-tree: ${this.data?.server?.multi_tree}<br />
          task queue: ${this.data?.server?.task_queue}<br />
          OCR: ${this.data?.server?.ocr}<br />
          chat: ${this.data?.server?.chat}<br />
        </span>
      </div>
    `}_copyToClipboard(){const t=this.renderRoot.getElementById("copy").innerText,e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),e.setSelectionRange(0,99999),navigator.clipboard.writeText(e.value),document.body.removeChild(e);const i=this.renderRoot.getElementById("copy-button");i.icon="done",setTimeout((()=>{i.icon="content_copy"}),1e3)}}window.customElements.define("grampsjs-sysinfo",FC);window.customElements.define("grampsjs-view-settings",class extends eS{static get styles(){return[super.styles,n`
        mwc-tab-bar {
          margin-bottom: 30px;
        }

        .medium {
          font-weight: 500;
          color: rgb(0.05, 0.05, 0.05);
        }
      `]}static get properties(){return{owner:{type:Boolean},page:{type:String},dbInfo:{type:Object},_userInfo:{type:Object}}}constructor(){super(),this.owner=!1,this.page="user",this.dbInfo={},this._userInfo={}}renderContent(){return["#user","#admin","#users","#info"].includes(window.location.hash)&&(this.page=window.location.hash.substring(1),window.history.pushState("",document.title,window.location.pathname+window.location.search)),M`
      <mwc-tab-bar>
        <mwc-tab
          label="${this._("User settings")}"
          @click=${()=>{this.page="user"}}
        ></mwc-tab>
        ${this.owner?M`
              <mwc-tab
                label="${this._("Administration")}"
                @click=${()=>{this.page="admin"}}
              ></mwc-tab>
              <mwc-tab
                label="${this._("Manage users")}"
                @click=${()=>{this.page="users"}}
              ></mwc-tab>
            `:""}
        <mwc-tab
          label="${this._("System Information")}"
          @click=${()=>{this.page="info"}}
        ></mwc-tab>
      </mwc-tab-bar>
      ${"user"===this.page?this.renderUserSettings():""}
      ${"admin"===this.page&&this.owner?this.renderAdminSettings():""}
      ${"users"===this.page&&this.owner?this.renderUserManagement():""}
      ${"info"===this.page?this.renderSysInfo():""}
    `}get _registerUrl(){const t=new URL(document.URL),e=An();return`${t.origin}/register/${e}`}renderAdminSettings(){return M`
      <grampsjs-view-admin-settings
        active
        .strings="${this.strings}"
        .dbInfo="${this.dbInfo}"
        .userInfo="${this._userInfo}"
      >
      </grampsjs-view-admin-settings>
    `}renderUserManagement(){return M`
      <grampsjs-view-user-management
        active
        .strings="${this.strings}"
        .dbInfo="${this.dbInfo}"
      >
      </grampsjs-view-user-management>
    `}renderUserSettings(){return M`
      ${M`
    <mwc-button
      outlined
      class="red"
      label="logout"
      icon="exit_to_app"
      @click=${()=>En()}
    ></mwc-button>
  `}

      <h3>${this._("User Information")}</h3>
      <dl>
        <div>
          <dt><span>${this._("Username: ").replace(":","")}</span></dt>
          <dd>${this._userInfo?.name}</dd>
        </div>
        <div>
          <dt><span>${this._("User group")}</span></dt>
          <dd>${this._(jC[this._userInfo?.role])}</dd>
        </div>
      </dl>
      <div style="clear: both;"></div>

      <h3>${this._("Select language")}</h3>

      ${this.renderLangSelect()}

      <h3>${this._("Set _Home Person")}</h3>

      ${this.renderPersonSelect()}

      <h3>${this._("Change E-mail")}</h3>

      ${this.renderChangeEmail()}

      <h3>${this._("Change password")}</h3>

      ${this.renderChangePw()}
    `}renderSysInfo(){return M`
      <h3>${this._("System Information")}</h3>

      <grampsjs-sysinfo
        .data="${this.dbInfo}"
        .strings="${this.strings}"
        .userInfo="${this._userInfo}"
      ></grampsjs-sysinfo>
      <h3>${this._("Tree Information")}</h3>
      <p class="small">ID: <span class="monospace">${An()}</a></p>

      `}renderChangeEmail(){return M`
      <p>
        <mwc-textfield
          id="change-email"
          label="${this._("New E-mail")}"
          value="${this._userInfo?.email?this._userInfo.email:""}"
        >
        </mwc-textfield>
      </p>
      <p>
        <mwc-button
          outlined
          label="${this._("Submit")}"
          @click="${this._changeEmail}"
        ></mwc-button>
      </p>
    `}renderChangePw(){return M`
      <p>
        <mwc-textfield
          id="old-pw"
          label="${this._("Old password")}"
          type="password"
        >
        </mwc-textfield>
        <mwc-textfield
          id="new-pw"
          label="${this._("New password")}"
          type="password"
        >
        </mwc-textfield>
      </p>
      <p>
        <mwc-button
          outlined
          label="${this._("Submit")}"
          @click="${this._changePw}"
        ></mwc-button>
      </p>
    `}async _changeEmail(){const t=this.shadowRoot.getElementById("change-email");if(!t.value)return;this.loading=!0;const e={email:t.value},i=await Fn("/api/users/-/",e);if(this.loading=!1,"error"in i)return this.error=!1,this.error=!0,void(this._errorMessage=i.error);os(this,"grampsjs:notification",{message:"E-mail successfully updated"}),t.value="",await this._fetchOwnUserDetails(),t.value=this._userInfo.email}_changePw(){const t=this.shadowRoot.getElementById("old-pw"),e=this.shadowRoot.getElementById("new-pw");if(!t.value||!e.value)return;this.loading=!0;Nn("/api/users/-/password/change",{old_password:t.value,new_password:e.value}).then((i=>{this.loading=!1,"error"in i?(this.error=!0,this._errorMessage=i.error):(this.error=!1,os(this,"grampsjs:notification",{message:"Password successfully updated"}),t.value="",e.value="")}))}async _fetchOwnUserDetails(){const t=await On("/api/users/-/");"error"in t?(this.error=!0,this._errorMessage=t.error):(this.error=!1,this._userInfo=t.data)}connectedCallback(){super.connectedCallback(),this._fetchOwnUserDetails()}});window.customElements.define("grampsjs-view-recent",class extends $d{static get properties(){return{_data:{type:Array},_searchResult:{type:Array},_isStale:{type:Boolean}}}constructor(){super(),this._searchResult=[],this._data=[],this._isStale=!1}connectedCallback(){super.connectedCallback(),this._boundHandleEvent=this._handleEvent.bind(this),window.addEventListener("object:loaded",this._boundHandleEvent),this._boundStorageHandler=this._handleStorage.bind(this),window.addEventListener("storage",this._boundStorageHandler),this._handleStorage(),window.addEventListener("language:changed",(t=>this._handleLanguageChanged(t)))}_handleLanguageChanged(t){this._hasFirstUpdated&&this._fetchData(t.detail.lang)}_handleStorage(){const t=function(){try{const t=localStorage.getItem("recentObjects"),e=JSON.parse(t);if(Array.isArray(e))return e;const i=An();return i?e[i]:[]}catch(t){return[]}}();null!=t&&(this._data=t,this._hasFirstUpdated&&this._fetchData(this.strings.__lang__))}_handleEvent(t){this._data=this._data.filter((e=>e.grampsId!==t.detail.grampsId||e.className!==t.detail.className)),this._data.push(t.detail),this._data=this._data.slice(-20),Pn(this._data),this.active?this._fetchData(this.strings.__lang__):this._isStale=!0}_handleClear(){this._data=[],Pn(this._data)}render(){return M` <mwc-button
        raised
        label="${this._("Clear")}"
        class="float-right"
        icon="clear_all"
        @click="${this._handleClear}"
        ?disabled=${0===this._data.length}
      ></mwc-button>
      <h2>${this._("Recently browsed objects")}</h2>
      ${0===this._data.length?M` <p>${this._("No items")}.</p> `:M`
            <grampsjs-search-result-list
              .data="${this._searchResult.slice().reverse()}"
              .strings="${this.strings}"
              large
              noSep
              linked
            ></grampsjs-search-result-list>
          `}`}async _fetchData(t){if(0===this._data.length)return void(this._searchResult=[]);this.loading=!0;const e=this._data.map((t=>t.grampsId.trim().replace(/\s\s+/g," OR "))).filter((t=>t&&t.trim())).join(" OR "),i=await On(`/api/search/?query=${e}&locale=${t||"en"}&profile=all&page=1&pagesize=100`);if(this.loading=!1,"data"in i){this.error=!1;const t=i.data.reduce(((t,e)=>(t[e?.object?.gramps_id]=e,t)),{});this._searchResult=this._data.map((e=>t[e.grampsId])).filter((t=>void 0!==t))}else"error"in i&&(this.error=!0,this._errorMessage=i.error)}firstUpdated(){this._hasFirstUpdated=!0,"__lang__"in this.strings&&this._fetchData(this.strings.__lang__)}update(t){super.update(t),t.has("active")&&this.active&&this._isStale&&(this._fetchData(this.strings.__lang__),this._isStale=!1)}});const NC=new Set(Object.values(WS));class HC extends $p{get items(){return this.listController.items}constructor(){super(),this.listController=new GS({isItem:t=>t.hasAttribute("md-list-item"),getPossibleItems:()=>this.slotItems,isRtl:()=>"rtl"===getComputedStyle(this).direction,deactivateItem:t=>{t.tabIndex=-1},activateItem:t=>{t.tabIndex=0},isNavigableKey:t=>NC.has(t),isActivatable:t=>!t.disabled&&"text"!==t.type}),this.internals=this.attachInternals(),this.internals.role="list",this.addEventListener("keydown",this.listController.handleKeydown)}render(){return dp`
      <slot
        @deactivate-items=${this.listController.onDeactivateItems}
        @request-activation=${this.listController.onRequestActivation}
        @slotchange=${this.listController.onSlotchange}>
      </slot>
    `}activateNextItem(){return this.listController.activateNextItem()}activatePreviousItem(){return this.listController.activatePreviousItem()}}it([Vh({flatten:!0})],HC.prototype,"slotItems",void 0);const VC=vh`:host{background:var(--md-list-container-color, var(--md-sys-color-surface, #fef7ff));color:unset;display:flex;flex-direction:column;outline:none;padding:8px 0;position:relative}
`;let UC=class extends HC{};UC.styles=[VC],UC=it([ph("md-list")],UC);class YC extends $p{constructor(){super(...arguments),this.disabled=!1,this.type="text",this.isListItem=!0,this.href="",this.target=""}get isDisabled(){return this.disabled&&"link"!==this.type}willUpdate(t){this.href&&(this.type="link"),super.willUpdate(t)}render(){return this.renderListItem(dp`
      <md-item>
        <div slot="container">
          ${this.renderRipple()} ${this.renderFocusRing()}
        </div>
        <slot name="start" slot="start"></slot>
        <slot name="end" slot="end"></slot>
        ${this.renderBody()}
      </md-item>
    `)}renderListItem(t){const e="link"===this.type;let i;switch(this.type){case"link":i=Zp`a`;break;case"button":i=Zp`button`;break;default:i=Zp`li`}const r="text"!==this.type,n=e&&this.target?this.target:pp;return Wp`
      <${i}
        id="item"
        tabindex="${this.isDisabled||!r?-1:0}"
        ?disabled=${this.isDisabled}
        role="listitem"
        aria-selected=${this.ariaSelected||pp}
        aria-checked=${this.ariaChecked||pp}
        aria-expanded=${this.ariaExpanded||pp}
        aria-haspopup=${this.ariaHasPopup||pp}
        class="list-item ${zp(this.getRenderClasses())}"
        href=${this.href||pp}
        target=${n}
        @focus=${this.onFocus}
      >${t}</${i}>
    `}renderRipple(){return"text"===this.type?pp:dp` <md-ripple
      part="ripple"
      for="item"
      ?disabled=${this.isDisabled}></md-ripple>`}renderFocusRing(){return"text"===this.type?pp:dp` <md-focus-ring
      @visibility-changed=${this.onFocusRingVisibilityChanged}
      part="focus-ring"
      for="item"
      inward></md-focus-ring>`}onFocusRingVisibilityChanged(t){}getRenderClasses(){return{disabled:this.isDisabled}}renderBody(){return dp`
      <slot></slot>
      <slot name="overline" slot="overline"></slot>
      <slot name="headline" slot="headline"></slot>
      <slot name="supporting-text" slot="supporting-text"></slot>
      <slot
        name="trailing-supporting-text"
        slot="trailing-supporting-text"></slot>
    `}onFocus(){-1===this.tabIndex&&this.dispatchEvent(new Event("request-activation",{bubbles:!0,composed:!0}))}focus(){this.listItemRoot?.focus()}}ru(YC),YC.shadowRootOptions={...$p.shadowRootOptions,delegatesFocus:!0},it([jh({type:Boolean,reflect:!0})],YC.prototype,"disabled",void 0),it([jh({reflect:!0})],YC.prototype,"type",void 0),it([jh({type:Boolean,attribute:"md-list-item",reflect:!0})],YC.prototype,"isListItem",void 0),it([jh()],YC.prototype,"href",void 0),it([jh()],YC.prototype,"target",void 0),it([Fh(".list-item")],YC.prototype,"listItemRoot",void 0);const ZC=vh`:host{display:flex;-webkit-tap-highlight-color:rgba(0,0,0,0);--md-ripple-hover-color: var(--md-list-item-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-hover-opacity: var(--md-list-item-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-list-item-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-pressed-opacity: var(--md-list-item-pressed-state-layer-opacity, 0.12)}:host(:is([type=button]:not([disabled]),[type=link])){cursor:pointer}md-focus-ring{z-index:1;--md-focus-ring-shape: 8px}a,button,li{background:none;border:none;cursor:inherit;padding:0;margin:0;text-align:unset;text-decoration:none}.list-item{border-radius:inherit;display:flex;flex:1;max-width:inherit;min-width:inherit;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%}.list-item.interactive{cursor:pointer}.list-item.disabled{opacity:var(--md-list-item-disabled-opacity, 0.3);pointer-events:none}[slot=container]{pointer-events:none}md-ripple{border-radius:inherit}md-item{border-radius:inherit;flex:1;height:100%;color:var(--md-list-item-label-text-color, var(--md-sys-color-on-surface, #1d1b20));font-family:var(--md-list-item-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-list-item-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));line-height:var(--md-list-item-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));font-weight:var(--md-list-item-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));min-height:var(--md-list-item-one-line-container-height, 56px);padding-top:var(--md-list-item-top-space, 12px);padding-bottom:var(--md-list-item-bottom-space, 12px);padding-inline-start:var(--md-list-item-leading-space, 16px);padding-inline-end:var(--md-list-item-trailing-space, 16px)}md-item[multiline]{min-height:var(--md-list-item-two-line-container-height, 72px)}[slot=supporting-text]{color:var(--md-list-item-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-list-item-supporting-text-font, var(--md-sys-typescale-body-medium-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-list-item-supporting-text-size, var(--md-sys-typescale-body-medium-size, 0.875rem));line-height:var(--md-list-item-supporting-text-line-height, var(--md-sys-typescale-body-medium-line-height, 1.25rem));font-weight:var(--md-list-item-supporting-text-weight, var(--md-sys-typescale-body-medium-weight, var(--md-ref-typeface-weight-regular, 400)))}[slot=trailing-supporting-text]{color:var(--md-list-item-trailing-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-list-item-trailing-supporting-text-font, var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-list-item-trailing-supporting-text-size, var(--md-sys-typescale-label-small-size, 0.6875rem));line-height:var(--md-list-item-trailing-supporting-text-line-height, var(--md-sys-typescale-label-small-line-height, 1rem));font-weight:var(--md-list-item-trailing-supporting-text-weight, var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500)))}:is([slot=start],[slot=end])::slotted(*){fill:currentColor}[slot=start]{color:var(--md-list-item-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}[slot=end]{color:var(--md-list-item-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}@media(forced-colors: active){.disabled slot{color:GrayText}.list-item.disabled{color:GrayText;opacity:1}}
`;let qC=class extends YC{};qC.styles=[ZC],qC=it([ph("md-list-item")],qC);const WC={Person_0:"M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z",Family_0:"M19 17V19H7V17S7 13 13 13 19 17 19 17M16 8A3 3 0 1 0 13 11A3 3 0 0 0 16 8M19.2 13.06A5.6 5.6 0 0 1 21 17V19H24V17S24 13.55 19.2 13.06M18 5A2.91 2.91 0 0 0 17.11 5.14A5 5 0 0 1 17.11 10.86A2.91 2.91 0 0 0 18 11A3 3 0 0 0 18 5M8 10H5V7H3V10H0V12H3V15H5V12H8Z",Event_0:"M19 19V8H5V19H19M16 1H18V3H19C20.11 3 21 3.9 21 5V19C21 20.11 20.11 21 19 21H5C3.89 21 3 20.1 3 19V5C3 3.89 3.89 3 5 3H6V1H8V3H16V1M11 9.5H13V12.5H16V14.5H13V17.5H11V14.5H8V12.5H11V9.5Z",Place_0:"M9,11.5A2.5,2.5 0 0,0 11.5,9A2.5,2.5 0 0,0 9,6.5A2.5,2.5 0 0,0 6.5,9A2.5,2.5 0 0,0 9,11.5M9,2C12.86,2 16,5.13 16,9C16,14.25 9,22 9,22C9,22 2,14.25 2,9A7,7 0 0,1 9,2M15,17H18V14H20V17H23V19H20V22H18V19H15V17Z",Source_0:"M13.09 20H5V6H3V20A2 2 0 0 0 5 22H13.81A5.5 5.5 0 0 1 13.09 20M19 2H14V7L12 5.5L10 7V2H9A2 2 0 0 0 7 4V16A2 2 0 0 0 9 18H13.09A6 6 0 0 1 21 13.34V4A2 2 0 0 0 19 2M20 15V18H23V20H20V23H18V20H15V18H18V15Z",Citation_0:"M13 19C13 20.1 13.3 21.12 13.81 22H6C4.89 22 4 21.11 4 20V4C4 2.9 4.89 2 6 2H7V9L9.5 7.5L12 9V2H18C19.1 2 20 2.89 20 4V13.09C19.67 13.04 19.34 13 19 13C15.69 13 13 15.69 13 19M20 18V15H18V18H15V20H18V23H20V20H23V18H20Z",Repository_0:"M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11.5,1L21,6V8H2V6L11.5,1M16,10H19V12.08L18,12C17.3,12 16.63,12.12 16,12.34V10M2,22V19H12.08C12.27,20.14 12.79,21.17 13.53,22H2M10,10H13V14.68C12.54,15.37 12.22,16.15 12.08,17H10V10M4,10H7V17H4V10Z",Note_0:"M14 2H6C4.89 2 4 2.89 4 4V20C4 21.11 4.89 22 6 22H13.81C13.28 21.09 13 20.05 13 19C13 18.67 13.03 18.33 13.08 18H6V16H13.81C14.27 15.2 14.91 14.5 15.68 14H6V12H18V13.08C18.33 13.03 18.67 13 19 13S19.67 13.03 20 13.08V8L14 2M13 9V3.5L18.5 9H13M18 15V18H15V20H18V23H20V20H23V18H20V15H18Z",Tag_0:"M21.41,11.58L12.41,2.58C12.04,2.21 11.53,2 11,2H4A2,2 0 0,0 2,4V11C2,11.53 2.21,12.04 2.59,12.41L3,12.81C3.9,12.27 4.94,12 6,12A6,6 0 0,1 12,18C12,19.06 11.72,20.09 11.18,21L11.58,21.4C11.95,21.78 12.47,22 13,22C13.53,22 14.04,21.79 14.41,21.41L21.41,14.41C21.79,14.04 22,13.53 22,13C22,12.47 21.79,11.96 21.41,11.58M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M10,19H7V22H5V19H2V17H5V14H7V17H10V19Z",Media_0:"M18 15V18H15V20H18V23H20V20H23V18H20V15H18M13.3 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H19C20.1 3 21 3.9 21 5V13.3C20.4 13.1 19.7 13 19 13C17.9 13 16.8 13.3 15.9 13.9L14.5 12L11 16.5L8.5 13.5L5 18H13.1C13 18.3 13 18.7 13 19C13 19.7 13.1 20.4 13.3 21Z",Person_1:"M21.7,13.35L20.7,14.35L18.65,12.3L19.65,11.3C19.86,11.09 20.21,11.09 20.42,11.3L21.7,12.58C21.91,12.79 21.91,13.14 21.7,13.35M12,18.94L18.06,12.88L20.11,14.93L14.06,21H12V18.94M12,14C7.58,14 4,15.79 4,18V20H10V18.11L14,14.11C13.34,14.03 12.67,14 12,14M12,4A4,4 0 0,0 8,8A4,4 0 0,0 12,12A4,4 0 0,0 16,8A4,4 0 0,0 12,4Z",Family_1:"M16 17V19H2V17S2 13 9 13 16 17 16 17M12.5 7.5A3.5 3.5 0 1 0 9 11A3.5 3.5 0 0 0 12.5 7.5M15.94 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13M15 4A3.39 3.39 0 0 0 13.07 4.59A5 5 0 0 1 13.07 10.41A3.39 3.39 0 0 0 15 11A3.5 3.5 0 0 0 15 4Z",Event_1:"M19,3H18V1H16V3H8V1H6V3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H10V19H5V8H19V9H21V5A2,2 0 0,0 19,3M21.7,13.35L20.7,14.35L18.65,12.35L19.65,11.35C19.85,11.14 20.19,11.13 20.42,11.35L21.7,12.63C21.89,12.83 21.89,13.15 21.7,13.35M12,18.94L18.07,12.88L20.12,14.88L14.06,21H12V18.94Z",Place_1:Pa,Source_1:"M15,5A2,2 0 0,1 17,7V23L10,20L3,23V7C3,5.89 3.9,5 5,5H15M9,1H19A2,2 0 0,1 21,3V19L19,18.13V3H7A2,2 0 0,1 9,1Z",Citation_1:"M19.39 10.74L11 19.13V22H6C4.89 22 4 21.11 4 20V4C4 2.9 4.89 2 6 2H7V9L9.5 7.5L12 9V2H18C19.1 2 20 2.89 20 4V10.3C19.78 10.42 19.57 10.56 19.39 10.74M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z",Repository_1:"M11.5,1L2,6V8H21V6M16,10V17H19V10M2,22H21V19H2M10,10V17H13V10M4,10V17H7V10H4Z",Note_1:"M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H10V20.09L12.09,18H6V16H14.09L16.09,14H6V12H18.09L20,10.09V8L14,2H6M13,3.5L18.5,9H13V3.5M20.15,13C20,13 19.86,13.05 19.75,13.16L18.73,14.18L20.82,16.26L21.84,15.25C22.05,15.03 22.05,14.67 21.84,14.46L20.54,13.16C20.43,13.05 20.29,13 20.15,13M18.14,14.77L12,20.92V23H14.08L20.23,16.85L18.14,14.77Z",Tag_1:"M12.41 2.58L21.41 11.58C21.77 11.94 22 12.44 22 13C22 13.55 21.78 14.05 21.41 14.41L14.41 21.41C14.05 21.77 13.55 22 13 22C12.45 22 11.95 21.77 11.58 21.41L9.45 19.28L10.7 18.03L10.7 18.04L13.11 15.62C14.11 14.63 14.11 13 13.11 12L11.83 10.74C10.84 9.75 9.23 9.75 8.24 10.74L8.07 10.91L8.06 10.91L4.57 14.4L2.59 12.41C2.22 12.05 2 11.55 2 11V4C2 2.89 2.89 2 4 2H11C11.55 2 12.05 2.22 12.41 2.58M4.44 6.56C4.72 6.84 5.1 7 5.5 7C5.9 7 6.28 6.84 6.56 6.56C6.84 6.28 7 5.9 7 5.5C7 5.1 6.84 4.72 6.56 4.44C6.28 4.16 5.9 4 5.5 4C5.1 4 4.72 4.16 4.44 4.44C4.16 4.72 4 5.1 4 5.5C4 5.9 4.16 6.28 4.44 6.56M10.7 15.35L11.7 14.35C11.91 14.14 11.91 13.79 11.7 13.58L10.42 12.3C10.21 12.09 9.86 12.09 9.65 12.3L8.65 13.3L10.7 15.35M8.06 13.88L2 19.94V22H4.06L10.11 15.93L8.06 13.88Z",Media_1:"M22.7 14.3L21.7 15.3L19.7 13.3L20.7 12.3C20.8 12.2 20.9 12.1 21.1 12.1C21.2 12.1 21.4 12.2 21.5 12.3L22.8 13.6C22.9 13.8 22.9 14.1 22.7 14.3M13 19.9V22H15.1L21.2 15.9L19.2 13.9L13 19.9M21 5C21 3.9 20.1 3 19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H11V19.1L12.1 18H5L8.5 13.5L11 16.5L14.5 12L16.1 14.1L21 9.1V5Z",Person_2:"M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M1,10V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z",Family_2:"M19 17V19H7V17S7 13 13 13 19 17 19 17M16 8A3 3 0 1 0 13 11A3 3 0 0 0 16 8M19.2 13.06A5.6 5.6 0 0 1 21 17V19H24V17S24 13.55 19.2 13.06M18 5A2.91 2.91 0 0 0 17.11 5.14A5 5 0 0 1 17.11 10.86A2.91 2.91 0 0 0 18 11A3 3 0 0 0 18 5M8 10H0V12H8Z",Event_2:"M19 19V8H5V19H19M16 1H18V3H19C20.11 3 21 3.9 21 5V19C21 20.11 20.11 21 19 21H5C3.89 21 3 20.1 3 19V5C3 3.89 3.89 3 5 3H6V1H8V3H16V1M16 12.5V14.5H8V12.5H16Z",Place_2:"M9,11.5A2.5,2.5 0 0,0 11.5,9A2.5,2.5 0 0,0 9,6.5A2.5,2.5 0 0,0 6.5,9A2.5,2.5 0 0,0 9,11.5M9,2C12.86,2 16,5.13 16,9C16,14.25 9,22 9,22C9,22 2,14.25 2,9A7,7 0 0,1 9,2M15,17H23V19H15V17Z",Source_2:"M13.09 20H5V6H3V20C3 21.11 3.9 22 5 22H13.81C13.44 21.39 13.2 20.71 13.09 20M19 2H14V7L12 5.5L10 7V2H9C7.9 2 7 2.9 7 4V16C7 17.11 7.9 18 9 18H13.09C13.64 14.73 16.74 12.53 20 13.08C20.34 13.14 20.68 13.23 21 13.34V4C21 2.9 20.11 2 19 2M23 18V20H15V18H23Z",Citation_2:"M13 19C13 20.1 13.3 21.12 13.81 22H6C4.89 22 4 21.11 4 20V4C4 2.9 4.89 2 6 2H7V9L9.5 7.5L12 9V2H18C19.1 2 20 2.89 20 4V13.09C19.67 13.04 19.34 13 19 13C15.69 13 13 15.69 13 19M15 18V20H23V18H15Z",Repository_2:"M14,17H22V19H14V17M11.5,1L21,6V8H2V6L11.5,1M16,10H19V12.08L18,12C17.3,12 16.63,12.12 16,12.34V10M2,22V19H12.08C12.27,20.14 12.79,21.17 13.53,22H2M10,10H13V14.68C12.54,15.37 12.22,16.15 12.08,17H10V10M4,10H7V17H4V10Z",Note_2:"M15 18H23V20H15M6 2C4.89 2 4 2.89 4 4V20C4 21.11 4.89 22 6 22H13.81C13.28 21.09 13 20.05 13 19C13 18.67 13.03 18.33 13.08 18H6V16H13.81C14.27 15.2 14.91 14.5 15.68 14H6V12H18V13.08C18.33 13.03 18.67 13 19 13C19.34 13 19.67 13.03 20 13.08V8L14 2M13 3.5L18.5 9H13Z",Tag_2:"M21.41,11.58L12.41,2.58C12.04,2.21 11.53,2 11,2H4A2,2 0 0,0 2,4V11C2,11.53 2.21,12.04 2.59,12.41L3,12.81C3.9,12.27 4.94,12 6,12A6,6 0 0,1 12,18C12,19.06 11.72,20.09 11.18,21L11.58,21.4C11.95,21.78 12.47,22 13,22C13.53,22 14.04,21.79 14.41,21.41L21.41,14.41C21.79,14.04 22,13.53 22,13C22,12.47 21.79,11.96 21.41,11.58M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M10,19H2V17H10V19Z",Media_2:"M15 18V20H23V18H15M13.3 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H19C20.1 3 21 3.9 21 5V13.3C20.4 13.1 19.7 13 19 13C17.9 13 16.8 13.3 15.9 13.9L14.5 12L11 16.5L8.5 13.5L5 18H13.1C13 18.3 13 18.7 13 19C13 19.7 13.1 20.4 13.3 21Z"};window.customElements.define("grampsjs-view-revisions",class extends $d{static get styles(){return[super.styles,n`
        md-list-item {
          --md-list-item-label-text-weight: 350;
          --md-list-item-label-text-size: 17px;
          --md-list-item-supporting-text-color: rgba(0, 0, 0, 0.5);
          --md-list-item-trailing-supporting-text-color: rgba(0, 0, 0, 0.8);
        }

        md-list-item[type='text'] {
          --md-list-item-label-text-color: rgba(0, 0, 0, 0.48);
        }

        svg[slot='end'] {
          height: 22px;
          width: 22px;
          opacity: 0.9;
        }

        md-divider {
          --md-divider-thickness: 1px;
          --md-divider-color: rgba(0, 0, 0, 0.1);
        }
        .counter {
          position: relative;
          color: white;
          font-size: 11px;
          min-width: 14px;
          height: 14px;
          line-height: 16px;
          left: -17px;
          top: -6px;
          font-weight: 600;
          background-color: rgba(0, 0, 0, 0.35);
          border-radius: 100px;
          display: inline-block;
          text-align: center;
          vertical-align: middle;
        }
      `]}static get properties(){return{_data:{type:Array},_page:{type:Number},_pages:{type:Number},_pageSize:{type:Number}}}constructor(){super(),this._data=[],this._page=1,this._pages=-1,this._pageSize=20}render(){return M`
      <h2>${this._("Revision History")}</h2>

      <md-list>
        <md-divider></md-divider>
        ${this._data.map((t=>this._renderTransaction(t)))}
      </md-list>

      <grampsjs-pagination
        page="${this._page}"
        pages="${this._pages}"
        @page:changed="${this._handlePageChanged}"
        .strings="${this.strings}"
      ></grampsjs-pagination>
    `}_renderTransaction(t){const e=t.changes.reduce(((t,{obj_class:e,trans_type:i})=>{const r=`${e}_${i}`;return t[r]=(t[r]||0)+1,t}),{});return M`<md-list-item
        ?interactive="${!!t.changes?.length}"
        type="${t.changes?.length?"link":"text"}"
        href="${t.changes?.length?`/revision/${t.id}`:""}"
      >
        <div slot="headline">${this._(t.description)}</div>
        ${Ha("M17,12C17,14.42 15.28,16.44 13,16.9V21H11V16.9C8.72,16.44 7,14.42 7,12C7,9.58 8.72,7.56 11,7.1V3H13V7.1C15.28,7.56 17,9.58 17,12M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z","#777777",0,"start")}
        ${t.changes?.length?Object.keys(e).map((t=>WC[t]?M`
                      ${Ha(WC[t],"rgba(0, 0, 0, 0.45)",0,"end")} </span
                    > `:"")):Ha("M5 12C5 13.11 4.11 14 3 14C1.9 14 1 13.11 1 12C1 10.9 1.9 10 3 10C4.11 10 5 10.9 5 12M4 2V8H2V2H4M2 22V16H4V22H2M24 6V18C24 19.11 23.11 20 22 20H10C8.9 20 8 19.11 8 18V14L6 12L8 10V6C8 4.89 8.9 4 10 4H22C23.11 4 24 4.89 24 6M22 6H10V10.83L8.83 12L10 13.17V18H22V6M16.5 15.5V17H15V15.5H16.5M14.5 10.5H13V10C13 8.34 14.34 7 16 7C17.66 7 19 8.34 19 10C19 10.97 18.5 11.88 17.71 12.41L17.41 12.6C16.84 13 16.5 13.62 16.5 14.3V14.5H15V14.3C15 13.11 15.6 12 16.59 11.35L16.88 11.16C17.27 10.9 17.5 10.47 17.5 10C17.5 9.18 16.83 8.5 16 8.5C15.17 8.5 14.5 9.17 14.5 10V10.5Z","rgba(0, 0, 0, 0.45)",0,"end")}
        <div slot="supporting-text">
          <span class="user">
            ${t.connection?.user?this._renderUser(t.connection?.user):this._("Unknown")},
          </span>
          <span class="time">
            <grampsjs-timedelta
              timestamp="${t.timestamp}"
              locale="${this.strings.__lang__}"
            ></grampsjs-timedelta>
          </span>
        </div>
      </md-list-item>
      <md-divider></md-divider> `}_renderUser(t){return t.full_name||t.name}async _fetchData(){this.loading=!0;const t=`/api/transactions/history/?sort=-id&page=${this._page}&pagesize=${this._pageSize}`,e=await On(t);this.loading=!1,"data"in e?(this.error=!1,this._data=e.data,this._totalCount=e.total_count,this._pages=Math.ceil(this._totalCount/this._pageSize)):"error"in e&&(this.error=!0,this._errorMessage=e.error)}_handlePageChanged(t){this._page=t.detail.page}firstUpdated(){this._fetchData()}update(t){super.update(t),t.has("_page")&&t._page!==this._page&&this._fetchData()}connectedCallback(){super.connectedCallback(),window.addEventListener("db:changed",(()=>this._fetchData()))}});class GC extends em{renderElevationOrOutline(){return dp`<md-elevation part="elevation"></md-elevation>`}}const XC=vh`:host{--_container-color: var(--md-filled-tonal-button-container-color, var(--md-sys-color-secondary-container, #e8def8));--_container-elevation: var(--md-filled-tonal-button-container-elevation, 0);--_container-height: var(--md-filled-tonal-button-container-height, 40px);--_container-shadow-color: var(--md-filled-tonal-button-container-shadow-color, var(--md-sys-color-shadow, #000));--_disabled-container-color: var(--md-filled-tonal-button-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-container-elevation: var(--md-filled-tonal-button-disabled-container-elevation, 0);--_disabled-container-opacity: var(--md-filled-tonal-button-disabled-container-opacity, 0.12);--_disabled-label-text-color: var(--md-filled-tonal-button-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-filled-tonal-button-disabled-label-text-opacity, 0.38);--_focus-container-elevation: var(--md-filled-tonal-button-focus-container-elevation, 0);--_focus-label-text-color: var(--md-filled-tonal-button-focus-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_hover-container-elevation: var(--md-filled-tonal-button-hover-container-elevation, 1);--_hover-label-text-color: var(--md-filled-tonal-button-hover-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_hover-state-layer-color: var(--md-filled-tonal-button-hover-state-layer-color, var(--md-sys-color-on-secondary-container, #1d192b));--_hover-state-layer-opacity: var(--md-filled-tonal-button-hover-state-layer-opacity, 0.08);--_label-text-color: var(--md-filled-tonal-button-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_label-text-font: var(--md-filled-tonal-button-label-text-font, var(--md-sys-typescale-label-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-filled-tonal-button-label-text-line-height, var(--md-sys-typescale-label-large-line-height, 1.25rem));--_label-text-size: var(--md-filled-tonal-button-label-text-size, var(--md-sys-typescale-label-large-size, 0.875rem));--_label-text-weight: var(--md-filled-tonal-button-label-text-weight, var(--md-sys-typescale-label-large-weight, var(--md-ref-typeface-weight-medium, 500)));--_pressed-container-elevation: var(--md-filled-tonal-button-pressed-container-elevation, 0);--_pressed-label-text-color: var(--md-filled-tonal-button-pressed-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_pressed-state-layer-color: var(--md-filled-tonal-button-pressed-state-layer-color, var(--md-sys-color-on-secondary-container, #1d192b));--_pressed-state-layer-opacity: var(--md-filled-tonal-button-pressed-state-layer-opacity, 0.12);--_disabled-icon-color: var(--md-filled-tonal-button-disabled-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-icon-opacity: var(--md-filled-tonal-button-disabled-icon-opacity, 0.38);--_focus-icon-color: var(--md-filled-tonal-button-focus-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_hover-icon-color: var(--md-filled-tonal-button-hover-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_icon-color: var(--md-filled-tonal-button-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_icon-size: var(--md-filled-tonal-button-icon-size, 18px);--_pressed-icon-color: var(--md-filled-tonal-button-pressed-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_container-shape-start-start: var(--md-filled-tonal-button-container-shape-start-start, var(--md-filled-tonal-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-start-end: var(--md-filled-tonal-button-container-shape-start-end, var(--md-filled-tonal-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-end: var(--md-filled-tonal-button-container-shape-end-end, var(--md-filled-tonal-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-start: var(--md-filled-tonal-button-container-shape-end-start, var(--md-filled-tonal-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_leading-space: var(--md-filled-tonal-button-leading-space, 24px);--_trailing-space: var(--md-filled-tonal-button-trailing-space, 24px);--_with-leading-icon-leading-space: var(--md-filled-tonal-button-with-leading-icon-leading-space, 16px);--_with-leading-icon-trailing-space: var(--md-filled-tonal-button-with-leading-icon-trailing-space, 24px);--_with-trailing-icon-leading-space: var(--md-filled-tonal-button-with-trailing-icon-leading-space, 24px);--_with-trailing-icon-trailing-space: var(--md-filled-tonal-button-with-trailing-icon-trailing-space, 16px)}
`;let KC=class extends GC{};KC.styles=[am,nm,XC],KC=it([ph("md-filled-tonal-button")],KC);class JC extends jt{constructor(t){if(super(t),this.it=R,t.type!==Pt)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(t){if(t===R||null==t)return this.vt=void 0,this.it=t;if(t===P)return t;if("string"!=typeof t)throw Error(this.constructor.directiveName+"() called with a non-string value");if(t===this.it)return this.vt;this.it=t;const e=[t];return e.raw=e,this.vt={_$litType$:this.constructor.resultType,strings:e,values:[]}}}JC.directiveName="unsafeHTML",JC.resultType=1;const QC=Dt(JC);var tE=class{constructor(t){this.selfOptions=t||{},this.pipes={}}options(t){return t&&(this.selfOptions=t),this.selfOptions}pipe(t,e){let i=e;if("string"==typeof t){if(void 0===i)return this.pipes[t];this.pipes[t]=i}if(t&&t.name){if(i=t,i.processor===this)return i;this.pipes[i.name]=i}return i.processor=this,i}process(t,e){let i=t;i.options=this.options();let r,n=e||t.pipe||"default";for(;n;)void 0!==i.nextAfterChildren&&(i.next=i.nextAfterChildren,i.nextAfterChildren=null),"string"==typeof n&&(n=this.pipe(n)),n.process(i),r=n,n=null,i&&i.next&&(i=i.next,n=i.pipe||r);return i.hasResult?i.result:void 0}};var eE=class{constructor(t){this.name=t,this.filters=[]}process(t){if(!this.processor)throw new Error("add this pipe to a processor before using it");const e=this.debug,i=this.filters.length,r=t;for(let t=0;t<i;t++){const i=this.filters[t];if(e&&this.log(`filter: ${i.filterName}`),i(r),"object"==typeof r&&r.exiting){r.exiting=!1;break}}!r.next&&this.resultCheck&&this.resultCheck(r)}log(t){console.log(`[jsondiffpatch] ${this.name} pipe, ${t}`)}append(...t){return this.filters.push(...t),this}prepend(...t){return this.filters.unshift(...t),this}indexOf(t){if(!t)throw new Error("a filter name is required");for(let e=0;e<this.filters.length;e++){if(this.filters[e].filterName===t)return e}throw new Error(`filter not found: ${t}`)}list(){return this.filters.map((t=>t.filterName))}after(t,...e){const i=this.indexOf(t);return this.filters.splice(i+1,0,...e),this}before(t,...e){const i=this.indexOf(t);return this.filters.splice(i,0,...e),this}replace(t,...e){const i=this.indexOf(t);return this.filters.splice(i,1,...e),this}remove(t){const e=this.indexOf(t);return this.filters.splice(e,1),this}clear(){return this.filters.length=0,this}shouldHaveResult(t){if(!1!==t){if(!this.resultCheck)return this.resultCheck=t=>{if(!t.hasResult){console.log(t);const e=new Error(`${this.name} failed`);throw e.noResult=!0,e}},this}else this.resultCheck=null}};class iE{setResult(t){return this.result=t,this.hasResult=!0,this}exit(){return this.exiting=!0,this}push(t,e){return t.parent=this,void 0!==e&&(t.childName=e),t.root=this.root||this,t.options=t.options||this.options,this.children?(this.children[this.children.length-1].next=t,this.children.push(t)):(this.children=[t],this.nextAfterChildren=this.next||null,this.next=t),t.next=this,this}}function rE(t){if("object"!=typeof t)return t;if(null===t)return null;if(Array.isArray(t))return t.map(rE);if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return function(t){const e=/^\/(.*)\/([gimyu]*)$/.exec(t.toString());return new RegExp(e[1],e[2])}(t);const e={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=rE(t[i]));return e}var nE=class extends iE{constructor(t,e){super(),this.left=t,this.right=e,this.pipe="diff"}setResult(t){if(this.options.cloneDiffValues&&"object"==typeof t){const e="function"==typeof this.options.cloneDiffValues?this.options.cloneDiffValues:rE;"object"==typeof t[0]&&(t[0]=e(t[0])),"object"==typeof t[1]&&(t[1]=e(t[1]))}return super.setResult(t)}};var aE=class extends iE{constructor(t,e){super(),this.left=t,this.delta=e,this.pipe="patch"}};var sE=class extends iE{constructor(t){super(),this.delta=t,this.pipe="reverse"}};const oE=function(t){if(t.left!==t.right)if(void 0!==t.left)if(void 0!==t.right){if("function"==typeof t.left||"function"==typeof t.right)throw new Error("functions are not supported");t.leftType=null===t.left?"null":typeof t.left,t.rightType=null===t.right?"null":typeof t.right,t.leftType===t.rightType&&"boolean"!==t.leftType&&"number"!==t.leftType?("object"===t.leftType&&(t.leftIsArray=Array.isArray(t.left)),"object"===t.rightType&&(t.rightIsArray=Array.isArray(t.right)),t.leftIsArray===t.rightIsArray?t.left instanceof RegExp&&(t.right instanceof RegExp?t.setResult([t.left.toString(),t.right.toString()]).exit():t.setResult([t.left,t.right]).exit()):t.setResult([t.left,t.right]).exit()):t.setResult([t.left,t.right]).exit()}else t.setResult([t.left,0,0]).exit();else{if("function"==typeof t.right)throw new Error("functions are not supported");t.setResult([t.right]).exit()}else t.setResult(void 0).exit()};oE.filterName="trivial";const lE=function(t){if(void 0===t.delta)return void t.setResult(t.left).exit();if(t.nested=!Array.isArray(t.delta),t.nested)return;const e=t.delta;if(1!==e.length)if(2!==e.length)3===e.length&&0===e[2]&&t.setResult(void 0).exit();else{if(t.left instanceof RegExp){const i=/^\/(.*)\/([gimyu]+)$/.exec(e[1]);if(i)return void t.setResult(new RegExp(i[1],i[2])).exit()}t.setResult(e[1]).exit()}else t.setResult(e[0]).exit()};lE.filterName="trivial";const cE=function(t){if(void 0===t.delta)return void t.setResult(t.delta).exit();if(t.nested=!Array.isArray(t.delta),t.nested)return;const e=t.delta;1!==e.length?2!==e.length?3===e.length&&0===e[2]&&t.setResult([e[0]]).exit():t.setResult([e[1],e[0]]).exit():t.setResult([e[0],0,0]).exit()};cE.filterName="trivial";const dE=t=>{if(!t||!t.children)return;const e=t.children.length;let i,r=t.result;for(let n=0;n<e;n++)i=t.children[n],void 0!==i.result&&(r=r||{},r[i.childName]=i.result);r&&t.leftIsArray&&(r._t="a"),t.setResult(r).exit()};dE.filterName="collectChildren";const hE=t=>{if(t.leftIsArray||"object"!==t.leftType)return;const e=t.left,i=t.right;let r,n;const a=t.options.propertyFilter;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a&&!a(r,t)||(n=new nE(e[r],i[r]),t.push(n,r)));for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(a&&!a(r,t)||void 0===e[r]&&(n=new nE(void 0,i[r]),t.push(n,r)));t.children&&0!==t.children.length?t.exit():t.setResult(void 0).exit()};hE.filterName="objects";const pE=function(t){if(!t.nested)return;const e=t.delta;if(e._t)return;const i=e;let r,n;for(r in i)n=new aE(t.left[r],i[r]),t.push(n,r);t.exit()};pE.filterName="objects";const uE=function(t){if(!t||!t.children)return;if(t.delta._t)return;const e=t.left,i=t.children.length;let r;for(let n=0;n<i;n++){r=t.children[n];const i=r.childName;Object.prototype.hasOwnProperty.call(t.left,i)&&void 0===r.result?delete e[i]:e[i]!==r.result&&(e[i]=r.result)}t.setResult(e).exit()};uE.filterName="collectChildren";const mE=function(t){if(!t.nested)return;if(t.delta._t)return;const e=t.delta;let i,r;for(i in e)r=new sE(e[i]),t.push(r,i);t.exit()};mE.filterName="objects";const fE=t=>{if(!t||!t.children)return;if(t.delta._t)return;const e=t.children.length;let i;const r={};for(let n=0;n<e;n++){i=t.children[n];const e=i.childName;r[e]!==i.result&&(r[e]=i.result)}t.setResult(r).exit()};fE.filterName="collectChildren";const gE=function(t,e,i,r){return t[i]===e[r]};var _E=function(t,e,i,r){const n=r||{},a=function(t,e,i,r){const n=t.length,a=e.length;let s,o;const l=new Array(n+1);for(s=0;s<n+1;s++)for(l[s]=new Array(a+1),o=0;o<a+1;o++)l[s][o]=0;for(l.match=i,s=1;s<n+1;s++)for(o=1;o<a+1;o++)i(t,e,s-1,o-1,r)?l[s][o]=l[s-1][o-1]+1:l[s][o]=Math.max(l[s-1][o],l[s][o-1]);return l}(t,e,i||gE,n);return function(t,e,i,r){let n=e.length,a=i.length;const s={sequence:[],indices1:[],indices2:[]};for(;0!==n&&0!==a;)t.match(e,i,n-1,a-1,r)?(s.sequence.unshift(e[n-1]),s.indices1.unshift(n-1),s.indices2.unshift(a-1),--n,--a):t[n][a-1]>t[n-1][a]?--a:--n;return s}(a,t,e,n)};function vE(t,e,i,r,n){const a=t[i],s=e[r];if(a===s)return!0;if("object"!=typeof a||"object"!=typeof s)return!1;const o=n.objectHash;if(!o)return n.matchByPosition&&i===r;n.hashCache1=n.hashCache1||[];let l=n.hashCache1[i];if(void 0===l&&(n.hashCache1[i]=l=o(a,i)),void 0===l)return!1;n.hashCache2=n.hashCache2||[];let c=n.hashCache2[r];return void 0===c&&(n.hashCache2[r]=c=o(s,r)),void 0!==c&&l===c}const yE=function(t){if(!t.leftIsArray)return;const e={objectHash:t.options&&t.options.objectHash,matchByPosition:t.options&&t.options.matchByPosition};let i,r,n,a=0,s=0;const o=t.left,l=t.right,c=o.length,d=l.length;let h,p;for(c>0&&d>0&&!e.objectHash&&"boolean"!=typeof e.matchByPosition&&(e.matchByPosition=!function(t,e,i,r){for(let n=0;n<i;n++){const i=t[n];for(let t=0;t<r;t++){const r=e[t];if(n!==t&&i===r)return!0}}}(o,l,c,d));a<c&&a<d&&vE(o,l,a,a,e);)i=a,h=new nE(o[i],l[i]),t.push(h,i),a++;for(;s+a<c&&s+a<d&&vE(o,l,c-1-s,d-1-s,e);)r=c-1-s,n=d-1-s,h=new nE(o[r],l[n]),t.push(h,n),s++;if(a+s===c){if(c===d)return void t.setResult(void 0).exit();for(p=p||{_t:"a"},i=a;i<d-s;i++)p[i]=[l[i]];return void t.setResult(p).exit()}if(a+s===d){for(p=p||{_t:"a"},i=a;i<c-s;i++)p[`_${i}`]=[o[i],0,0];return void t.setResult(p).exit()}delete e.hashCache1,delete e.hashCache2;const u=o.slice(a,c-s),m=l.slice(a,d-s),f=_E(u,m,vE,e),g=[];for(p=p||{_t:"a"},i=a;i<c-s;i++)f.indices1.indexOf(i-a)<0&&(p[`_${i}`]=[o[i],0,0],g.push(i));let _=!0;t.options&&t.options.arrays&&!1===t.options.arrays.detectMove&&(_=!1);let v=!1;t.options&&t.options.arrays&&t.options.arrays.includeValueOnMove&&(v=!0);const y=g.length;for(i=a;i<d-s;i++){const s=f.indices2.indexOf(i-a);if(s<0){let s=!1;if(_&&y>0)for(let c=0;c<y;c++)if(r=g[c],vE(u,m,r-a,i-a,e)){p[`_${r}`].splice(1,2,i,3),v||(p[`_${r}`][0]=""),n=i,h=new nE(o[r],l[n]),t.push(h,n),g.splice(c,1),s=!0;break}s||(p[i]=[l[i]])}else r=f.indices1[s]+a,n=f.indices2[s]+a,h=new nE(o[r],l[n]),t.push(h,n)}t.setResult(p).exit()};yE.filterName="arrays";const bE={numerically:(t,e)=>t-e,numericallyBy:t=>(e,i)=>e[t]-i[t]},xE=function(t){if(!t.nested)return;const e=t.delta;if("a"!==e._t)return;let i,r;const n=e,a=t.left;let s=[],o=[];const l=[];for(i in n)if("_t"!==i)if("_"===i[0]){const t=i;if(0!==n[t][2]&&3!==n[t][2])throw new Error(`only removal or move can be applied at original array indices, invalid diff type: ${n[t][2]}`);s.push(parseInt(i.slice(1),10))}else{const t=i;1===n[t].length?o.push({index:parseInt(t,10),value:n[t][0]}):l.push({index:parseInt(t,10),delta:n[t]})}for(s=s.sort(bE.numerically),i=s.length-1;i>=0;i--){r=s[i];const t=n[`_${r}`],e=a.splice(r,1)[0];3===t[2]&&o.push({index:t[1],value:e})}o=o.sort(bE.numericallyBy("index"));const c=o.length;for(i=0;i<c;i++){const t=o[i];a.splice(t.index,0,t.value)}const d=l.length;let h;if(d>0)for(i=0;i<d;i++){const e=l[i];h=new aE(a[e.index],e.delta),t.push(h,e.index)}t.children?t.exit():t.setResult(a).exit()};xE.filterName="arrays";const wE=function(t){if(!t||!t.children)return;if("a"!==t.delta._t)return;const e=t.left,i=t.children.length;let r;for(let n=0;n<i;n++){r=t.children[n];e[r.childName]=r.result}t.setResult(e).exit()};wE.filterName="arraysCollectChildren";const kE=function(t){if(!t.nested){const e=t.delta;if(3===e[2]){const i=e;t.newName=`_${i[1]}`,t.setResult([i[0],parseInt(t.childName.substring(1),10),3]).exit()}return}const e=t.delta;if("a"!==e._t)return;const i=e;let r,n;for(r in i)"_t"!==r&&(n=new sE(i[r]),t.push(n,r));t.exit()};kE.filterName="arrays";const TE=(t,e,i)=>{if("string"==typeof e&&"_"===e[0])return parseInt(e.substring(1),10);if(Array.isArray(i)&&0===i[2])return`_${e}`;let r=+e;for(const i in t){const n=t[i];if(Array.isArray(n))if(3===n[2]){const t=parseInt(i.substring(1),10),a=n[1];if(a===+e)return t;t<=r&&a>r?r++:t>=r&&a<r&&r--}else if(0===n[2]){parseInt(i.substring(1),10)<=r&&r++}else 1===n.length&&parseInt(i,10)<=r&&r--}return r},SE=t=>{if(!t||!t.children)return;const e=t.delta;if("a"!==e._t)return;const i=e,r=t.children.length;let n;const a={_t:"a"};for(let e=0;e<r;e++){n=t.children[e];let r=n.newName;void 0===r&&(r=TE(i,n.childName,n.result)),a[r]!==n.result&&(a[r]=n.result)}t.setResult(a).exit()};SE.filterName="arraysCollectChildren";const CE=function(t){t.left instanceof Date?(t.right instanceof Date?t.left.getTime()!==t.right.getTime()?t.setResult([t.left,t.right]):t.setResult(void 0):t.setResult([t.left,t.right]),t.exit()):t.right instanceof Date&&t.setResult([t.left,t.right]).exit()};CE.filterName="dates";let EE=null;function $E(t,e){var i;if(!EE){let r;if(!(null===(i=null==t?void 0:t.textDiff)||void 0===i?void 0:i.diffMatchPatch)){if(!e)return null;const t=new Error("The diff-match-patch library was not provided. Pass the library in through the options or use the `jsondiffpatch/with-text-diffs` entry-point.");throw t.diff_match_patch_not_found=!0,t}r=new t.textDiff.diffMatchPatch,EE={diff:function(t,e){return r.patch_toText(r.patch_make(t,e))},patch:function(t,e){const i=r.patch_apply(r.patch_fromText(e),t);for(let t=0;t<i[1].length;t++)if(!i[1][t]){new Error("text patch failed").textPatchFailed=!0}return i[0]}}}return EE}const AE=function(t){if("string"!==t.leftType)return;const e=t.left,i=t.right,r=t.options&&t.options.textDiff&&t.options.textDiff.minLength||60;if(e.length<r||i.length<r)return void t.setResult([e,i]).exit();const n=$E(t.options);if(!n)return void t.setResult([e,i]).exit();const a=n.diff;t.setResult([a(e,i),0,2]).exit()};AE.filterName="texts";const IE=function(t){if(t.nested)return;const e=t.delta;if(2!==e[2])return;const i=e,r=$E(t.options,!0).patch;t.setResult(r(t.left,i[0])).exit()};IE.filterName="texts";const ME=function(t){let e,i,r,n,a=null;const s=/^@@ +-(\d+),(\d+) +\+(\d+),(\d+) +@@$/;let o;const l=t.split("\n");for(e=0,i=l.length;e<i;e++){r=l[e];const t=r.slice(0,1);"@"===t?(a=s.exec(r),o=e,l[o]="@@ -"+a[3]+","+a[4]+" +"+a[1]+","+a[2]+" @@"):"+"===t?(l[e]="-"+l[e].slice(1),"+"===l[e-1].slice(0,1)&&(n=l[e],l[e]=l[e-1],l[e-1]=n)):"-"===t&&(l[e]="+"+l[e].slice(1))}return l.join("\n")},LE=function(t){if(t.nested)return;const e=t.delta;if(2!==e[2])return;const i=e;t.setResult([ME(i[0]),0,2]).exit()};LE.filterName="texts";var PE=class{constructor(t){this.processor=new tE(t),this.processor.pipe(new eE("diff").append(dE,oE,CE,AE,hE,yE).shouldHaveResult()),this.processor.pipe(new eE("patch").append(uE,wE,lE,IE,pE,xE).shouldHaveResult()),this.processor.pipe(new eE("reverse").append(fE,SE,cE,LE,mE,kE).shouldHaveResult())}options(t){return this.processor.options(t)}diff(t,e){return this.processor.process(new nE(t,e))}patch(t,e){return this.processor.process(new aE(t,e))}reverse(t){return this.processor.process(new sE(t))}unpatch(t,e){return this.patch(t,this.reverse(e))}clone(t){return rE(t)}};let RE;const zE=t=>"_t"===t?-1:"_"===t.substring(0,1)?parseInt(t.slice(1),10):parseInt(t,10)+.1,DE=(t,e)=>zE(t)-zE(e);var jE=class{format(t,e){const i={};this.prepareContext(i);const r=i;return this.recurse(r,t,e),this.finalize(r)}prepareContext(t){t.buffer=[],t.out=function(...t){this.buffer.push(...t)}}typeFormattterNotFound(t,e){throw new Error(`cannot format delta type: ${e}`)}typeFormattterErrorFormatter(t,e,i,r,n,a,s){}finalize({buffer:t}){if(Array.isArray(t))return t.join("")}recurse(t,e,i,r,n,a,s){const o=e&&a?a.value:i;if(void 0===e&&void 0===r)return;const l=this.getDeltaType(e,a),c="node"===l?"a"===e._t?"array":"object":"";let d;void 0!==r?this.nodeBegin(t,r,n,l,c,s):this.rootBegin(t,l,c);try{d="unknown"!==l?this[`format_${l}`]:this.typeFormattterNotFound(t,l),d.call(this,t,e,o,r,n,a)}catch(i){this.typeFormattterErrorFormatter(t,i,e,o,r,n,a),"undefined"!=typeof console&&console.error&&console.error(i.stack)}void 0!==r?this.nodeEnd(t,r,n,l,c,s):this.rootEnd(t,l,c)}formatDeltaChildren(t,e,i){this.forEachDeltaKey(e,i,((r,n,a,s)=>{this.recurse(t,e[r],i?i[n]:void 0,r,n,a,s)}))}forEachDeltaKey(t,e,i){const r=Object.keys(t),n="a"===t._t,a={};let s;if(void 0!==e)for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&(void 0!==t[s]||n&&void 0!==t[`_${s}`]||r.push(s));for(s in t)if(Object.prototype.hasOwnProperty.call(t,s)){const i=t[s];if(Array.isArray(i)&&3===i[2]){const n=i;a[`${n[1]}`]={key:s,value:e&&e[parseInt(s.substring(1),10)]},!1!==this.includeMoveDestinations&&void 0===e&&void 0===t[n[1]]&&r.push(n[1].toString())}}n?r.sort(DE):r.sort();for(let t=0,e=r.length;t<e;t++){const s=r[t];if(n&&"_t"===s)continue;const l=n?parseInt("_"===(o=s).substring(0,1)?o.slice(1):o,10):s,c=t===e-1;i(s,l,a[l],c)}var o}getDeltaType(t,e){if(void 0===t)return void 0!==e?"movedestination":"unchanged";if(Array.isArray(t)){if(1===t.length)return"added";if(2===t.length)return"modified";if(3===t.length&&0===t[2])return"deleted";if(3===t.length&&2===t[2])return"textdiff";if(3===t.length&&3===t[2])return"moved"}else if("object"==typeof t)return"node";return"unknown"}parseTextDiff(t){const e=[],i=t.split("\n@@ ");for(let t=0,r=i.length;t<r;t++){const r=i[t],n={pieces:[]},a=/^(?:@@ )?[-+]?(\d+),(\d+)/.exec(r).slice(1);n.location={line:a[0],chr:a[1]};const s=r.split("\n").slice(1);for(let t=0,e=s.length;t<e;t++){const e=s[t];if(!e.length)continue;const i={type:"context"};"+"===e.substring(0,1)?i.type="added":"-"===e.substring(0,1)&&(i.type="deleted"),i.text=e.slice(1),n.pieces.push(i)}e.push(n)}return e}};class OE extends jE{typeFormattterErrorFormatter(t,e){t.out(`<pre class="jsondiffpatch-error">${e}</pre>`)}formatValue(t,e){t.out(`<pre>${BE(JSON.stringify(e,null,2))}</pre>`)}formatTextDiffString(t,e){const i=this.parseTextDiff(e);t.out('<ul class="jsondiffpatch-textdiff">');for(let e=0,r=i.length;e<r;e++){const r=i[e];t.out(`<li><div class="jsondiffpatch-textdiff-location"><span class="jsondiffpatch-textdiff-line-number">${r.location.line}</span><span class="jsondiffpatch-textdiff-char">${r.location.chr}</span></div><div class="jsondiffpatch-textdiff-line">`);const n=r.pieces;for(let e=0,i=n.length;e<i;e++){const i=n[e];t.out(`<span class="jsondiffpatch-textdiff-${i.type}">${BE(decodeURI(i.text))}</span>`)}t.out("</div></li>")}t.out("</ul>")}rootBegin(t,e,i){const r=`jsondiffpatch-${e}${i?` jsondiffpatch-child-node-type-${i}`:""}`;t.out(`<div class="jsondiffpatch-delta ${r}">`)}rootEnd(t){t.out("</div>"+(t.hasArrows?`<script type="text/javascript">setTimeout(${FE.toString()},10);<\/script>`:""))}nodeBegin(t,e,i,r,n){const a=`jsondiffpatch-${r}${n?` jsondiffpatch-child-node-type-${n}`:""}`;t.out(`<li class="${a}" data-key="${i}"><div class="jsondiffpatch-property-name">${i}</div>`)}nodeEnd(t){t.out("</li>")}format_unchanged(t,e,i){void 0!==i&&(t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,i),t.out("</div>"))}format_movedestination(t,e,i){void 0!==i&&(t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,i),t.out("</div>"))}format_node(t,e,i){const r="a"===e._t?"array":"object";t.out(`<ul class="jsondiffpatch-node jsondiffpatch-node-type-${r}">`),this.formatDeltaChildren(t,e,i),t.out("</ul>")}format_added(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,e[0]),t.out("</div>")}format_modified(t,e){t.out('<div class="jsondiffpatch-value jsondiffpatch-left-value">'),this.formatValue(t,e[0]),t.out('</div><div class="jsondiffpatch-value jsondiffpatch-right-value">'),this.formatValue(t,e[1]),t.out("</div>")}format_deleted(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,e[0]),t.out("</div>")}format_moved(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,e[0]),t.out(`</div><div class="jsondiffpatch-moved-destination">${e[1]}</div>`),t.out('<div class="jsondiffpatch-arrow" style="position: relative; left: -34px;">\n          <svg width="30" height="60" style="position: absolute; display: none;">\n          <defs>\n              <marker id="markerArrow" markerWidth="8" markerHeight="8"\n                 refx="2" refy="4"\n                     orient="auto" markerUnits="userSpaceOnUse">\n                  <path d="M1,1 L1,7 L7,4 L1,1" style="fill: #339;" />\n              </marker>\n          </defs>\n          <path d="M30,0 Q-10,25 26,50"\n            style="stroke: #88f; stroke-width: 2px; fill: none; stroke-opacity: 0.5; marker-end: url(#markerArrow);"\n          ></path>\n          </svg>\n      </div>'),t.hasArrows=!0}format_textdiff(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatTextDiffString(t,e[0]),t.out("</div>")}}function BE(t){let e=t;const i=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/'/g,"&apos;"],[/"/g,"&quot;"]];for(let t=0;t<i.length;t++)e=e.replace(i[t][0],i[t][1]);return e}const FE=function(t){const e=t||document;((t,e,i)=>{const r=t.querySelectorAll(e);for(let t=0,e=r.length;t<e;t++)i(r[t])})(e,".jsondiffpatch-arrow",(({parentNode:t,children:e,style:i})=>{const r=t,n=e[0],a=n.children[1];n.style.display="none";const s=(({textContent:t,innerText:e})=>t||e)(r.querySelector(".jsondiffpatch-moved-destination"));let o;if((({children:t},e)=>{for(let i=0,r=t.length;i<r;i++)e(t[i],i)})(r.parentNode,(t=>{t.getAttribute("data-key")===s&&(o=t)})),o)try{const t=o.offsetTop-r.offsetTop;n.setAttribute("height",`${Math.abs(t)+6}`),i.top=`${-8+(t>0?0:t)}px`;const e=t>0?`M30,0 Q-10,${Math.round(t/2)} 26,${t-4}`:`M30,${-t} Q-10,${Math.round(-t/2)} 26,4`;a.setAttribute("d",e),n.style.display=""}catch(t){}}))};let NE;class HE extends(al(K)){static get styles(){return[nl,n`
        :host {
          --color-red: #ffebe9;
          --color-green: #dafbe1;
          --color-blue: #ddf4ff;
          color: #222;
        }

        #container {
          overflow: hidden;
          border: 1px solid rgba(0, 0, 0, 0.2);
          border-radius: 8px;
          padding: 20px 8px;
        }

        .jsondiffpatch-delta {
          font-family: 'Commit Mono';
          font-size: 14px;
          margin: 0;
          padding: 0 0 0 14px;
          display: inline-block;
        }
        .jsondiffpatch-delta pre {
          font-family: 'Commit Mono';
          font-size: 14px;
          margin: 0;
          padding: 0;
          display: inline-block;
        }
        ul.jsondiffpatch-delta {
          list-style-type: none;
          padding: 0 0 0 22px;
          margin: 0;
        }
        .jsondiffpatch-delta ul {
          list-style-type: none;
          padding: 0 0 0 22px;
          margin: 0;
        }
        .jsondiffpatch-added .jsondiffpatch-property-name,
        .jsondiffpatch-added .jsondiffpatch-value pre,
        .jsondiffpatch-modified .jsondiffpatch-right-value pre,
        .jsondiffpatch-textdiff-added {
          background: var(--color-green);
        }
        .jsondiffpatch-deleted .jsondiffpatch-property-name,
        .jsondiffpatch-deleted pre,
        .jsondiffpatch-modified .jsondiffpatch-left-value pre,
        .jsondiffpatch-textdiff-deleted {
          background: var(--color-red);
          text-decoration: line-through;
          text-decoration-color: rgba(0, 0, 0, 0.2);
          text-decoration-thickness: 1px;
        }
        .jsondiffpatch-unchanged,
        .jsondiffpatch-movedestination {
          color: gray;
        }
        .jsondiffpatch-unchanged,
        .jsondiffpatch-movedestination > .jsondiffpatch-value {
          transition: all 0.5s;
          -webkit-transition: all 0.5s;
          overflow-y: hidden;
        }
        .jsondiffpatch-unchanged-showing .jsondiffpatch-unchanged,
        .jsondiffpatch-unchanged-showing
          .jsondiffpatch-movedestination
          > .jsondiffpatch-value {
          max-height: 100px;
        }
        .jsondiffpatch-unchanged-hidden .jsondiffpatch-unchanged,
        .jsondiffpatch-unchanged-hidden
          .jsondiffpatch-movedestination
          > .jsondiffpatch-value {
          max-height: 0;
        }
        .jsondiffpatch-unchanged-hiding
          .jsondiffpatch-movedestination
          > .jsondiffpatch-value,
        .jsondiffpatch-unchanged-hidden
          .jsondiffpatch-movedestination
          > .jsondiffpatch-value {
          display: block;
        }
        .jsondiffpatch-unchanged-visible .jsondiffpatch-unchanged,
        .jsondiffpatch-unchanged-visible
          .jsondiffpatch-movedestination
          > .jsondiffpatch-value {
          max-height: 100px;
        }
        .jsondiffpatch-unchanged-hiding .jsondiffpatch-unchanged,
        .jsondiffpatch-unchanged-hiding
          .jsondiffpatch-movedestination
          > .jsondiffpatch-value {
          max-height: 0;
        }
        .jsondiffpatch-unchanged-showing .jsondiffpatch-arrow,
        .jsondiffpatch-unchanged-hiding .jsondiffpatch-arrow {
          display: none;
        }
        .jsondiffpatch-value {
          display: inline-block;
        }
        .jsondiffpatch-property-name {
          display: inline-block;
          padding-right: 5px;
          vertical-align: top;
        }
        .jsondiffpatch-property-name:after {
          content: ': ';
        }
        .jsondiffpatch-child-node-type-array
          > .jsondiffpatch-property-name:after {
          content: ': [';
        }
        .jsondiffpatch-child-node-type-array:after {
          content: '],';
        }
        div.jsondiffpatch-child-node-type-array:before {
          content: '[';
        }
        div.jsondiffpatch-child-node-type-array:after {
          content: ']';
        }
        .jsondiffpatch-child-node-type-object
          > .jsondiffpatch-property-name:after {
          content: ': {';
        }
        .jsondiffpatch-child-node-type-object:after {
          content: '},';
        }
        div.jsondiffpatch-child-node-type-object:before {
          content: '{';
        }
        div.jsondiffpatch-child-node-type-object:after {
          content: '}';
        }
        .jsondiffpatch-value pre:after {
          content: ',';
        }
        li:last-child > .jsondiffpatch-value pre:after,
        .jsondiffpatch-modified > .jsondiffpatch-left-value pre:after {
          content: '';
        }
        .jsondiffpatch-modified .jsondiffpatch-value {
          display: inline-block;
        }
        .jsondiffpatch-modified .jsondiffpatch-right-value {
          margin-left: 5px;
        }
        .jsondiffpatch-moved .jsondiffpatch-value {
          display: none;
        }
        .jsondiffpatch-moved .jsondiffpatch-moved-destination {
          display: inline-block;
          background: var(--color-blue);
          color: #888;
        }
        .jsondiffpatch-moved .jsondiffpatch-moved-destination:before {
          content: ' => ';
        }
        ul.jsondiffpatch-textdiff {
          padding: 0;
        }
        .jsondiffpatch-textdiff-location {
          color: #bbb;
          display: inline-block;
          min-width: 60px;
        }
        .jsondiffpatch-textdiff-line {
          display: inline-block;
        }
        .jsondiffpatch-textdiff-line-number:after {
          content: ',';
        }
        .jsondiffpatch-error {
          background: red;
          color: white;
          font-weight: bold;
        }
      `]}static get properties(){return{left:{type:Object},right:{type:Object},_diff:{type:Object}}}constructor(){super(),this.left={},this.right={},this._diff={}}render(){return M`
      <div id="container">
        ${QC(function(t,e){return NE||(NE=new OE),NE.format(t,e)}(this._diff,this.left))}
      </div>
    `}updated(t){(t.has("left")||t.has("right"))&&this._updateDiff()}_updateDiff(){this._diff=function(t,e){return RE||(RE=new PE),RE.diff(t,e)}(this.left,this.right)}}window.customElements.define("grampsjs-diff-json",HE);window.customElements.define("grampsjs-view-revision",class extends $d{static get styles(){return[super.styles,n`
        md-list-item {
          --md-list-item-label-text-weight: 350;
          --md-list-item-label-text-size: 17px;
          --md-list-item-supporting-text-color: rgba(0, 0, 0, 0.5);
          --md-list-item-trailing-supporting-text-color: rgba(0, 0, 0, 0.8);
        }

        svg[slot='end'] {
          height: 22px;
          width: 22px;
          opacity: 0.9;
        }

        md-divider {
          --md-divider-thickness: 1px;
          --md-divider-color: rgba(0, 0, 0, 0.1);
        }

        #left {
        }

        .hidden {
          display: none;
        }

        #clear {
          clear: left;
        }

        #close-button {
          text-align: right;
          margin-bottom: 15px;
        }

        @media (min-width: 1200px) {
          .hidden {
            display: block;
          }

          #left {
            width: calc(50% - 20px);
            margin-right: 40px;
            margin-left: 0px;
            float: left;
          }

          #right {
            width: calc(50% - 20px);
            margin: 0;
            float: left;
            margin-top: 0px;
          }
        }

        p.user-time {
          font-size: 0.95em;
          color: rgba(0, 0, 0, 0.6);
        }

        span.user {
          font-weight: 440;
        }
      `]}static get properties(){return{transactionId:{type:Number},_data:{type:Object},_detailId:{type:Number}}}constructor(){super(),this.transactionId=-1,this._data={},this._detailId=-1}_getChanges(t){return this._data.changes?.filter((e=>e.trans_type===t&&"7"!==e.obj_class))??[]}render(){return this._data.id?M`
      <grampsjs-breadcrumbs
        hideLock
        hideBookmark
        .data="${{gramps_id:this.transactionId}}"
        .strings="${this.strings}"
        objectsName="Revisions"
        objectIcon="commit"
      ></grampsjs-breadcrumbs>

      <h2>${this._(this._data.description)}</h2>

      <p class="user-time">
        <span class="user">
          ${this._data.connection?.user?this._renderUser(this._data.connection?.user):this._("Unknown")},
        </span>
        <span class="time">
          <grampsjs-timedelta
            timestamp="${this._data.timestamp}"
            locale="${this.strings.__lang__}"
          ></grampsjs-timedelta>
        </span>
      </p>

      <div id="left" class="${Ot({hidden:this._detailId>0})}">
        ${this._getChanges(0).length>0?M`<h3>${this._("Added")}</h3>
              ${this._renderAdded()}`:""}
        ${this._getChanges(2).length>0?M`
              <h3>${this._("Deleted")}</h3>
              ${this._renderDeleted()}
            `:""}
        ${this._getChanges(1).length>0?M`<h3>${this._("Edited")}</h3>
              ${this._renderEdited()} `:""}
      </div>
      <div id="right">${this._renderDetail()}</div>
      <div id="clear"></div>
    `:""}_renderDetail(){if(this._detailId<0)return"";const t=this._data.changes?.[this._detailId];return M`
      <div id="close-button">
        <md-text-button @click="${this._handleCloseDetail}"
          >${Ha("M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z","--md-sys-color-primary",0,"icon")}
          Close</md-text-button
        >
      </div>
      <grampsjs-diff-json
        .left="${t.old_data}"
        .right="${t.new_data}"
        .strings="${this.strings}"
      ></grampsjs-diff-json>
    `}_handleCloseDetail(){this._detailId=-1}_renderAdded(){return M`<grampsjs-search-result-list
      @search-result:clicked=${this._handleEditedClicked}
      selectable
      .data="${this._getChanges(0).map((t=>({object_type:t.obj_class?.toLowerCase(),object:t.new_data})))}"
      .strings="${this.strings}"
    >
    </grampsjs-search-result-list> `}_renderDeleted(){return M`
      <grampsjs-search-result-list
        @search-result:clicked=${this._handleEditedClicked}
        selectable
        .data="${this._getChanges(2).map((t=>({object_type:t.obj_class?.toLowerCase(),object:t.old_data})))}"
        .strings="${this.strings}"
      >
      </grampsjs-search-result-list>
    `}_renderEdited(){return M`
      <grampsjs-search-result-list
        @search-result:clicked=${this._handleEditedClicked}
        selectable
        .data="${this._getChanges(1).map((t=>({object_type:t.obj_class?.toLowerCase(),object:t.old_data})))}"
        .strings="${this.strings}"
      >
      </grampsjs-search-result-list>
    `}_renderUser(t){return t.full_name||t.name}_handleEditedClicked(t){const e=t.detail,i=this._data.changes.findIndex((t=>t.obj_class.toLowerCase()===e.object_type&&t.obj_handle===e.object.handle));this._detailId=i}async _fetchData(){this.loading=!0;const t=await On(`/api/transactions/history/${this.transactionId}?old=1&new=1`);this.loading=!1,"data"in t?(this.error=!1,this._data=t.data):"error"in t&&(this.error=!0,this._errorMessage=t.error)}firstUpdated(){this._fetchData()}update(t){super.update(t),this.active&&t.has("transactionId")&&(this._data=[],this._detailId=-1,this._fetchData()),!t.has("active")||!this.active||0!==Object.keys(this._data).length&&this._data.id===this.transactionId||this.loading||(this._data=[],this._detailId=-1,this._fetchData())}});window.customElements.define("grampsjs-view-bookmarks",class extends $d{static get properties(){return{_data:{type:Array},_searchResult:{type:Array},_isStale:{type:Boolean}}}constructor(){super(),this._searchResult=[],this._data=[],this._isStale=!1}connectedCallback(){super.connectedCallback(),this._boundStorageHandler=this._handleStorage.bind(this),window.addEventListener("bookmark:changed",this._boundStorageHandler),window.addEventListener("storage",this._boundStorageHandler),this._handleStorage()}_handleStorage(){const t=Wn();null!=t&&(this._data=t,this._hasFirstUpdated&&(this.active?this._fetchData(this.strings.__lang__):this._isStale=!0))}render(){return M` <h2>${this._("_Bookmarks")}</h2>
      ${0===this._data.length?M` <p>${this._("No items")}.</p> `:M`
            <grampsjs-search-result-list
              .data="${this._searchResult.slice().reverse()}"
              .strings="${this.strings}"
              large
              noSep
              linked
            ></grampsjs-search-result-list>
          `}`}async _fetchData(t){const e=Object.fromEntries(Object.entries(is).map((([t,e])=>[e,t])));this._searchResult=Object.entries(this._data).flatMap((([t,i])=>i.map((i=>({object_type:e[t],object:{handle:i},loading:!0}))))),this._searchResult.forEach((e=>this._fetchDataObject(t,e.object_type,e.object.handle)))}async _fetchDataObject(t,e,i){const r=is[e],n=await On(`/api/${r}/${i}?locale=${t||"en"}&profile=self`);if("data"in n){const t={object_type:e,object:n.data};this._searchResult=[...this._searchResult.map((e=>e.object?.handle===i?t:e))]}}firstUpdated(){this._hasFirstUpdated=!0,"__lang__"in this.strings&&this._fetchData(this.strings.__lang__)}update(t){super.update(t),t.has("active")&&this.active&&this._isStale&&(this._fetchData(this.strings.__lang__),this._isStale=!1)}});class VE extends(al(K)){static get styles(){return[nl,n`
        #details,
        #searchbox,
        #searchresult,
        #filter {
          z-index: 999;
          position: absolute;
          left: 20px;
          border-radius: 5px;
          background-color: white;
          box-shadow: 0 2px 2px rgba(0, 0, 0, 0.2),
            0 -1px 0px rgba(0, 0, 0, 0.02);
        }

        #searchbox {
          width: 350px;
          top: 90px;
          padding: 0px;
          --mdc-text-field-outlined-idle-border-color: rgba(0, 0, 0, 0.2);
          --mdc-text-field-outlined-hover-border-color: rgba(0, 0, 0, 0.38);
          --mdc-text-field-outlined-disabled-border-color: rgba(0, 0, 0, 0.06);
        }

        md-outlined-text-field {
          width: 100%;
        }

        md-outlined-text-field mwc-icon-button {
          color: rgba(0, 0, 0, 0.5);
        }

        #details,
        #searchresult,
        #filter {
          width: 350px;
          font-size: 14px;
          line-height: 20px;
          overflow-x: hidden;
          overflow-y: scroll;
          scrollbar-width: thin;
        }

        #details-content,
        #filter-content {
          padding-left: 20px;
          padding-right: 20px;
        }

        #details,
        #filter {
          top: 155px;
          padding-top: 15px;
          padding-bottom: 15px;
          max-height: calc(100vh - 210px);
        }

        #searchresult {
          top: 150px;
          max-height: calc(100vh - 170px);
        }

        #details::-webkit-scrollbar,
        #searchresult::-webkit-scrollbar {
          width: 2px;
        }

        #details::-webkit-scrollbar-thumb,
        #searchresult::-webkit-scrollbar-thumb {
          background: rgba(0, 0, 0, 0.4);
        }

        #searchresult-content {
          font-size: 14px;
        }

        #searchresult-content mwc-list-item {
          --mdc-list-item-graphic-margin: 16px;
        }

        .hidden {
          display: none;
        }

        @media (max-width: 512px) {
          #searchbox {
            left: 0;
            top: 70px;
            width: 100%;
          }

          #details,
          #searchresult {
            left: 0;
            width: 100%;
          }

          #details {
            top: 50vh;
            bottom: 0;
          }

          #searchresult {
            top: 130px;
            max-height: calc(100vh - 160px);
          }
        }
      `]}static get properties(){return{value:{type:String},data:{type:Array},resultsOpen:{type:Boolean},detailsOpen:{type:Boolean},placeFilters:{type:Object},_showClearButton:{type:Boolean}}}constructor(){super(),this.value="",this.data=[],this.resultsOpen=!1,this.detailsOpen=!1,this.placeFilters={},this._showClearButton=!1}render(){const t=Object.values(this.placeFilters).some((t=>t));return M`
      <div id="container">
        <div id="searchbox">
          <md-outlined-text-field
            id="searchfield"
            placeholder="${this._("Search")}"
            @keydown="${this._handleKeyDown}"
            @input="${as((()=>this._handleInput()),500)}"
            value="${this.value}"
          >
            <div slot="trailing-icon">
              ${this._showClearButton?M`
                    <mwc-icon-button
                      icon="clear"
                      @click="${this._handleClear}"
                    ></mwc-icon-button>
                  `:M`
                    <mwc-icon-button
                      icon="search"
                      @click="${this._handleInput}"
                    ></mwc-icon-button>
                  `}
              <div style="position: relative; display: inline-block;">
                ${t?M`
                      <svg
                        width="20"
                        height="20"
                        xmlns="http://www.w3.org/2000/svg"
                        style="position: absolute; top: 7px; right: 7px;"
                      >
                        <circle cx="15" cy="5" r="5" fill="#BA1B1B" />
                      </svg>
                    `:""}
                <mwc-icon-button
                  icon="filter_alt"
                  @click="${this._handleFilter}"
                ></mwc-icon-button>
              </div>
            </div>
          </md-outlined-text-field>
        </div>
        ${this.resultsOpen?this._renderResults():""}
        ${this._renderDetails()} ${this._renderFilter()}
      </div>
    `}_renderResults(){return M`
      <div id="searchresult">
        <div id="searchresult-content">
          <mwc-list id="searchresult-list" @selected="${this._handleSelected}">
            ${this.data.map(this._renderListItem)}
          </mwc-list>
        </div>
      </div>
    `}_renderListItem(t){return M`
      <mwc-list-item graphic="icon">
        ${t.object?.profile?.name||""}
        <mwc-icon slot="graphic"
          >${t.object.lat&&t.object.long?"place":"location_off"}</mwc-icon
        >
      </mwc-list-item>
    `}_renderDetails(){return M`
      <div id="details" class="${Ot({hidden:!this.detailsOpen})}">
        <div id="details-content">
          <slot @slotchange="${this._handleSlotchange}"></slot>
        </div>
      </div>
    </div>
    `}_renderFilter(){return M`
      <md-dialog id="filter-dialog">
        <div slot="headline">${this._("Filter")}</div>

        <form slot="content" id="form-id" method="dialog">
          <label>
            ${this._("Only places related to events")}
            <md-switch
              @change="${t=>this.toggleFilter(t,"hasEvent")}"
              ?selected="${!!this.placeFilters.hasEvent}"
            ></md-switch>
          </label>
        </form>

        <div slot="actions">
          <md-text-button form="form-id" value="apply"
            >${this._("OK")}</md-text-button
          >
        </div>
      </md-dialog>
    `}toggleFilter(t,e){this.placeFilters[e]=t.target.selected,os(this,"placefilter:changed",this.placeFilters)}_handleSlotchange(t){0===t.target.assignedNodes({flatten:!0}).length?this.detailsOpen=!1:this.detailsOpen=!0}_handleKeyDown(t){if("ArrowDown"===t.code){const e=this.renderRoot.querySelector("#searchresult-list > mwc-list-item");e&&e.focus(),t.preventDefault(),t.stopPropagation()}else if("Escape"===t.code){""===this.shadowRoot.getElementById("searchfield").value?this.unfocus():this.clear()}}_handleInput(){const t=this.shadowRoot.getElementById("searchfield"),{value:e}=t;""===e?this.clear():(this._showClearButton=!0,e.length>=2&&os(this,"mapsearch:input",{value:e}))}_handleSelected(t){if(0===this.data.length)return;const{index:e}=t.detail;os(this,"mapsearch:selected",{object:this.data[e].object}),this.detailsOpen=!0}_handleClear(){this.clear(),this.focus()}_handleFilter(){this.renderRoot.querySelector("#filter-dialog").open=!0}clear(){os(this,"mapsearch:clear"),this.detailsOpen=!1,this.resultsOpen=!1,this._showClearButton=!1;const t=this.shadowRoot.getElementById("searchfield");t&&(t.value="")}firstUpdated(){this.focus()}update(t){super.update(t),t.has("data")&&(this.data.length>0?(this.resultsOpen=!0,this.detailsOpen=!1):this.resultsOpen=!1),t.has("value")&&this.value.length>0&&(this._showClearButton=!0)}focus(t=!0){const e=this.shadowRoot.getElementById("searchfield");try{e.focus()}catch(e){t&&window.setTimeout((()=>this.focus(!1)),100)}}unfocus(t=!0){const e=this.shadowRoot.getElementById("searchfield");try{e.blur()}catch(e){t&&window.setTimeout((()=>this.unfocus(!1)),100)}}}window.customElements.define("grampsjs-map-searchbox",VE);const UE=vh`@media(forced-colors: active){:host{--md-slider-active-track-color: CanvasText;--md-slider-disabled-active-track-color: GrayText;--md-slider-disabled-active-track-opacity: 1;--md-slider-disabled-handle-color: GrayText;--md-slider-disabled-inactive-track-color: GrayText;--md-slider-disabled-inactive-track-opacity: 1;--md-slider-focus-handle-color: CanvasText;--md-slider-handle-color: CanvasText;--md-slider-handle-shadow-color: Canvas;--md-slider-hover-handle-color: CanvasText;--md-slider-hover-state-layer-color: Canvas;--md-slider-hover-state-layer-opacity: 1;--md-slider-inactive-track-color: Canvas;--md-slider-label-container-color: Canvas;--md-slider-label-text-color: CanvasText;--md-slider-pressed-handle-color: CanvasText;--md-slider-pressed-state-layer-color: Canvas;--md-slider-pressed-state-layer-opacity: 1;--md-slider-with-overlap-handle-outline-color: CanvasText}.label,.label::before{border:var(--_with-overlap-handle-outline-color) solid var(--_with-overlap-handle-outline-width)}:host(:not([disabled])) .track::before{border:1px solid var(--_active-track-color)}.tickmarks::before{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='CanvasText'%3E%3Ccircle cx='2' cy='2'  r='1'/%3E%3C/svg%3E")}.tickmarks::after{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='Canvas'%3E%3Ccircle cx='2' cy='2' r='1'/%3E%3C/svg%3E")}:host([disabled]) .tickmarks::before{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='Canvas'%3E%3Ccircle cx='2' cy='2'  r='1'/%3E%3C/svg%3E")}}
`;function YE(t,e,i){return t?e(t):i?.(t)}const ZE=_u(lu($p));class qE extends ZE{get nameStart(){return this.getAttribute("name-start")??this.name}set nameStart(t){this.setAttribute("name-start",t)}get nameEnd(){return this.getAttribute("name-end")??this.nameStart}set nameEnd(t){this.setAttribute("name-end",t)}get renderAriaLabelStart(){const{ariaLabel:t}=this;return this.ariaLabelStart||t&&`${t} start`||this.valueLabelStart||String(this.valueStart)}get renderAriaValueTextStart(){return this.ariaValueTextStart||this.valueLabelStart||String(this.valueStart)}get renderAriaLabelEnd(){const{ariaLabel:t}=this;return this.range?this.ariaLabelEnd||t&&`${t} end`||this.valueLabelEnd||String(this.valueEnd):t||this.valueLabel||String(this.value)}get renderAriaValueTextEnd(){if(this.range)return this.ariaValueTextEnd||this.valueLabelEnd||String(this.valueEnd);const{ariaValueText:t}=this;return t||this.valueLabel||String(this.value)}constructor(){super(),this.min=0,this.max=100,this.valueLabel="",this.valueLabelStart="",this.valueLabelEnd="",this.ariaLabelStart="",this.ariaValueTextStart="",this.ariaLabelEnd="",this.ariaValueTextEnd="",this.step=1,this.ticks=!1,this.labeled=!1,this.range=!1,this.handleStartHover=!1,this.handleEndHover=!1,this.startOnTop=!1,this.handlesOverlapping=!1,this.ripplePointerId=1,this.isRedispatchingEvent=!1,this.addEventListener("click",(t=>{Ju(t)&&this.inputEnd&&(this.focus(),Ku(this.inputEnd))}))}focus(){this.inputEnd?.focus()}willUpdate(t){this.renderValueStart=t.has("valueStart")?this.valueStart:this.inputStart?.valueAsNumber;const e=t.has("valueEnd")&&this.range||t.has("value");this.renderValueEnd=e?this.range?this.valueEnd:this.value:this.inputEnd?.valueAsNumber,void 0!==t.get("handleStartHover")?this.toggleRippleHover(this.rippleStart,this.handleStartHover):void 0!==t.get("handleEndHover")&&this.toggleRippleHover(this.rippleEnd,this.handleEndHover)}updated(t){if(this.range&&(this.renderValueStart=this.inputStart.valueAsNumber),this.renderValueEnd=this.inputEnd.valueAsNumber,this.range){const t=(this.max-this.min)/3;if(void 0===this.valueStart){this.inputStart.valueAsNumber=this.min+t;const e=this.inputStart.valueAsNumber;this.valueStart=this.renderValueStart=e}if(void 0===this.valueEnd){this.inputEnd.valueAsNumber=this.min+2*t;const e=this.inputEnd.valueAsNumber;this.valueEnd=this.renderValueEnd=e}}else this.value??(this.value=this.renderValueEnd);if(t.has("range")||t.has("renderValueStart")||t.has("renderValueEnd")||this.isUpdatePending){const t=this.handleStart?.querySelector(".handleNub"),e=this.handleEnd?.querySelector(".handleNub");this.handlesOverlapping=function(t,e){if(!t||!e)return!1;const i=t.getBoundingClientRect(),r=e.getBoundingClientRect();return!(i.top>r.bottom||i.right<r.left||i.bottom<r.top||i.left>r.right)}(t,e)}this.performUpdate()}render(){const t=0===this.step?1:this.step,e=Math.max(this.max-this.min,t),i=this.range?((this.renderValueStart??this.min)-this.min)/e:0,r=((this.renderValueEnd??this.min)-this.min)/e,n={"--_start-fraction":String(i),"--_end-fraction":String(r),"--_tick-count":String(e/t)},a={ranged:this.range},s=this.valueLabelStart||String(this.renderValueStart),o=(this.range?this.valueLabelEnd:this.valueLabel)||String(this.renderValueEnd),l={start:!0,value:this.renderValueStart,ariaLabel:this.renderAriaLabelStart,ariaValueText:this.renderAriaValueTextStart,ariaMin:this.min,ariaMax:this.valueEnd??this.max},c={start:!1,value:this.renderValueEnd,ariaLabel:this.renderAriaLabelEnd,ariaValueText:this.renderAriaValueTextEnd,ariaMin:this.range?this.valueStart??this.min:this.min,ariaMax:this.max},d={start:!0,hover:this.handleStartHover,label:s},h={start:!1,hover:this.handleEndHover,label:o},p={hover:this.handleStartHover||this.handleEndHover};return dp` <div
      class="container ${zp(a)}"
      style=${tu(n)}>
      ${YE(this.range,(()=>this.renderInput(l)))}
      ${this.renderInput(c)} ${this.renderTrack()}
      <div class="handleContainerPadded">
        <div class="handleContainerBlock">
          <div class="handleContainer ${zp(p)}">
            ${YE(this.range,(()=>this.renderHandle(d)))}
            ${this.renderHandle(h)}
          </div>
        </div>
      </div>
    </div>`}renderTrack(){return dp`
      <div class="track"></div>
      ${this.ticks?dp`<div class="tickmarks"></div>`:pp}
    `}renderLabel(t){return dp`<div class="label" aria-hidden="true">
      <span class="labelContent" part="label">${t}</span>
    </div>`}renderHandle({start:t,hover:e,label:i}){const r=!this.disabled&&t===this.startOnTop,n=!this.disabled&&this.handlesOverlapping,a=t?"start":"end";return dp`<div
      class="handle ${zp({[a]:!0,hover:e,onTop:r,isOverlapping:n})}">
      <md-focus-ring part="focus-ring" for=${a}></md-focus-ring>
      <md-ripple
        for=${a}
        class=${a}
        ?disabled=${this.disabled}></md-ripple>
      <div class="handleNub">
        <md-elevation part="elevation"></md-elevation>
      </div>
      ${YE(this.labeled,(()=>this.renderLabel(i)))}
    </div>`}renderInput({start:t,value:e,ariaLabel:i,ariaValueText:r,ariaMin:n,ariaMax:a}){const s=t?"start":"end";return dp`<input
      type="range"
      class="${zp({start:t,end:!t})}"
      @focus=${this.handleFocus}
      @pointerdown=${this.handleDown}
      @pointerup=${this.handleUp}
      @pointerenter=${this.handleEnter}
      @pointermove=${this.handleMove}
      @pointerleave=${this.handleLeave}
      @keydown=${this.handleKeydown}
      @keyup=${this.handleKeyup}
      @input=${this.handleInput}
      @change=${this.handleChange}
      id=${s}
      .disabled=${this.disabled}
      .min=${String(this.min)}
      aria-valuemin=${n}
      .max=${String(this.max)}
      aria-valuemax=${a}
      .step=${String(this.step)}
      .value=${String(e)}
      .tabIndex=${t?1:0}
      aria-label=${i||pp}
      aria-valuetext=${r} />`}async toggleRippleHover(t,e){const i=await t;i&&(e?i.handlePointerenter(new PointerEvent("pointerenter",{isPrimary:!0,pointerId:this.ripplePointerId})):i.handlePointerleave(new PointerEvent("pointerleave",{isPrimary:!0,pointerId:this.ripplePointerId})))}handleFocus(t){this.updateOnTop(t.target)}startAction(t){const e=t.target,i=e===this.inputStart?this.inputEnd:this.inputStart;this.action={canFlip:"pointerdown"===t.type,flipped:!1,target:e,fixed:i,values:new Map([[e,e.valueAsNumber],[i,i?.valueAsNumber]])}}finishAction(t){this.action=void 0}handleKeydown(t){this.startAction(t)}handleKeyup(t){this.finishAction(t)}handleDown(t){this.startAction(t),this.ripplePointerId=t.pointerId;const e=t.target===this.inputStart;this.handleStartHover=!this.disabled&&e&&Boolean(this.handleStart),this.handleEndHover=!this.disabled&&!e&&Boolean(this.handleEnd)}async handleUp(t){if(!this.action)return;const{target:e,values:i,flipped:r}=this.action;await new Promise(requestAnimationFrame),void 0!==e&&(e.focus(),r&&e.valueAsNumber!==i.get(e)&&e.dispatchEvent(new Event("change",{bubbles:!0}))),this.finishAction(t)}handleMove(t){this.handleStartHover=!this.disabled&&WE(t,this.handleStart),this.handleEndHover=!this.disabled&&WE(t,this.handleEnd)}handleEnter(t){this.handleMove(t)}handleLeave(){this.handleStartHover=!1,this.handleEndHover=!1}updateOnTop(t){this.startOnTop=t.classList.contains("start")}needsClamping(){if(!this.action)return!1;const{target:t,fixed:e}=this.action;return t===this.inputStart?t.valueAsNumber>e.valueAsNumber:t.valueAsNumber<e.valueAsNumber}isActionFlipped(){const{action:t}=this;if(!t)return!1;const{target:e,fixed:i,values:r}=t;if(t.canFlip){r.get(e)===r.get(i)&&this.needsClamping()&&(t.canFlip=!1,t.flipped=!0,t.target=i,t.fixed=e)}return t.flipped}flipAction(){if(!this.action)return!1;const{target:t,fixed:e,values:i}=this.action,r=t.valueAsNumber!==e.valueAsNumber;return t.valueAsNumber=e.valueAsNumber,e.valueAsNumber=i.get(e),r}clampAction(){if(!this.needsClamping()||!this.action)return!1;const{target:t,fixed:e}=this.action;return t.valueAsNumber=e.valueAsNumber,!0}handleInput(t){if(this.isRedispatchingEvent)return;let e=!1,i=!1;this.range&&(this.isActionFlipped()&&(e=!0,i=this.flipAction()),this.clampAction()&&(e=!0,i=!1));const r=t.target;this.updateOnTop(r),this.range?(this.valueStart=this.inputStart.valueAsNumber,this.valueEnd=this.inputEnd.valueAsNumber):this.value=this.inputEnd.valueAsNumber,e&&t.stopPropagation(),i&&(this.isRedispatchingEvent=!0,au(r,t),this.isRedispatchingEvent=!1)}handleChange(t){const e=t.target,{target:i,values:r}=this.action??{};i&&i.valueAsNumber===r.get(e)||au(this,t),this.finishAction(t)}[fu](){if(this.range){const t=new FormData;return t.append(this.nameStart,String(this.valueStart)),t.append(this.nameEnd,String(this.valueEnd)),t}return String(this.value)}formResetCallback(){if(this.range){const t=this.getAttribute("value-start");this.valueStart=null!==t?Number(t):void 0;const e=this.getAttribute("value-end");return void(this.valueEnd=null!==e?Number(e):void 0)}const t=this.getAttribute("value");this.value=null!==t?Number(t):void 0}formStateRestoreCallback(t){if(Array.isArray(t)){const[[,e],[,i]]=t;return this.valueStart=Number(e),this.valueEnd=Number(i),void(this.range=!0)}this.value=Number(t),this.range=!1}}function WE({x:t,y:e},i){if(!i)return!1;const{top:r,left:n,bottom:a,right:s}=i.getBoundingClientRect();return t>=n&&t<=s&&e>=r&&e<=a}ru(qE),qE.shadowRootOptions={...$p.shadowRootOptions,delegatesFocus:!0},it([jh({type:Number})],qE.prototype,"min",void 0),it([jh({type:Number})],qE.prototype,"max",void 0),it([jh({type:Number})],qE.prototype,"value",void 0),it([jh({type:Number,attribute:"value-start"})],qE.prototype,"valueStart",void 0),it([jh({type:Number,attribute:"value-end"})],qE.prototype,"valueEnd",void 0),it([jh({attribute:"value-label"})],qE.prototype,"valueLabel",void 0),it([jh({attribute:"value-label-start"})],qE.prototype,"valueLabelStart",void 0),it([jh({attribute:"value-label-end"})],qE.prototype,"valueLabelEnd",void 0),it([jh({attribute:"aria-label-start"})],qE.prototype,"ariaLabelStart",void 0),it([jh({attribute:"aria-valuetext-start"})],qE.prototype,"ariaValueTextStart",void 0),it([jh({attribute:"aria-label-end"})],qE.prototype,"ariaLabelEnd",void 0),it([jh({attribute:"aria-valuetext-end"})],qE.prototype,"ariaValueTextEnd",void 0),it([jh({type:Number})],qE.prototype,"step",void 0),it([jh({type:Boolean})],qE.prototype,"ticks",void 0),it([jh({type:Boolean})],qE.prototype,"labeled",void 0),it([jh({type:Boolean})],qE.prototype,"range",void 0),it([Fh("input.start")],qE.prototype,"inputStart",void 0),it([Fh(".handle.start")],qE.prototype,"handleStart",void 0),it([Hh("md-ripple.start")],qE.prototype,"rippleStart",void 0),it([Fh("input.end")],qE.prototype,"inputEnd",void 0),it([Fh(".handle.end")],qE.prototype,"handleEnd",void 0),it([Hh("md-ripple.end")],qE.prototype,"rippleEnd",void 0),it([Oh()],qE.prototype,"handleStartHover",void 0),it([Oh()],qE.prototype,"handleEndHover",void 0),it([Oh()],qE.prototype,"startOnTop",void 0),it([Oh()],qE.prototype,"handlesOverlapping",void 0),it([Oh()],qE.prototype,"renderValueStart",void 0),it([Oh()],qE.prototype,"renderValueEnd",void 0);const GE=vh`:host{--_active-track-color: var(--md-slider-active-track-color, var(--md-sys-color-primary, #6750a4));--_active-track-height: var(--md-slider-active-track-height, 4px);--_active-track-shape: var(--md-slider-active-track-shape, var(--md-sys-shape-corner-full, 9999px));--_disabled-active-track-color: var(--md-slider-disabled-active-track-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-active-track-opacity: var(--md-slider-disabled-active-track-opacity, 0.38);--_disabled-handle-color: var(--md-slider-disabled-handle-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-handle-elevation: var(--md-slider-disabled-handle-elevation, 0);--_disabled-inactive-track-color: var(--md-slider-disabled-inactive-track-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-inactive-track-opacity: var(--md-slider-disabled-inactive-track-opacity, 0.12);--_focus-handle-color: var(--md-slider-focus-handle-color, var(--md-sys-color-primary, #6750a4));--_handle-color: var(--md-slider-handle-color, var(--md-sys-color-primary, #6750a4));--_handle-elevation: var(--md-slider-handle-elevation, 1);--_handle-height: var(--md-slider-handle-height, 20px);--_handle-shadow-color: var(--md-slider-handle-shadow-color, var(--md-sys-color-shadow, #000));--_handle-shape: var(--md-slider-handle-shape, var(--md-sys-shape-corner-full, 9999px));--_handle-width: var(--md-slider-handle-width, 20px);--_hover-handle-color: var(--md-slider-hover-handle-color, var(--md-sys-color-primary, #6750a4));--_hover-state-layer-color: var(--md-slider-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--_hover-state-layer-opacity: var(--md-slider-hover-state-layer-opacity, 0.08);--_inactive-track-color: var(--md-slider-inactive-track-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_inactive-track-height: var(--md-slider-inactive-track-height, 4px);--_inactive-track-shape: var(--md-slider-inactive-track-shape, var(--md-sys-shape-corner-full, 9999px));--_label-container-color: var(--md-slider-label-container-color, var(--md-sys-color-primary, #6750a4));--_label-container-height: var(--md-slider-label-container-height, 28px);--_pressed-handle-color: var(--md-slider-pressed-handle-color, var(--md-sys-color-primary, #6750a4));--_pressed-state-layer-color: var(--md-slider-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--_pressed-state-layer-opacity: var(--md-slider-pressed-state-layer-opacity, 0.12);--_state-layer-size: var(--md-slider-state-layer-size, 40px);--_with-overlap-handle-outline-color: var(--md-slider-with-overlap-handle-outline-color, var(--md-sys-color-on-primary, #fff));--_with-overlap-handle-outline-width: var(--md-slider-with-overlap-handle-outline-width, 1px);--_with-tick-marks-active-container-color: var(--md-slider-with-tick-marks-active-container-color, var(--md-sys-color-on-primary, #fff));--_with-tick-marks-container-size: var(--md-slider-with-tick-marks-container-size, 2px);--_with-tick-marks-disabled-container-color: var(--md-slider-with-tick-marks-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_with-tick-marks-inactive-container-color: var(--md-slider-with-tick-marks-inactive-container-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-color: var(--md-slider-label-text-color, var(--md-sys-color-on-primary, #fff));--_label-text-font: var(--md-slider-label-text-font, var(--md-sys-typescale-label-medium-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-slider-label-text-line-height, var(--md-sys-typescale-label-medium-line-height, 1rem));--_label-text-size: var(--md-slider-label-text-size, var(--md-sys-typescale-label-medium-size, 0.75rem));--_label-text-weight: var(--md-slider-label-text-weight, var(--md-sys-typescale-label-medium-weight, var(--md-ref-typeface-weight-medium, 500)));--_start-fraction: 0;--_end-fraction: 0;--_tick-count: 0;display:inline-flex;vertical-align:middle;min-inline-size:200px;--md-elevation-level: var(--_handle-elevation);--md-elevation-shadow-color: var(--_handle-shadow-color)}md-focus-ring{height:48px;inset:unset;width:48px}md-elevation{transition-duration:250ms}@media(prefers-reduced-motion){.label{transition-duration:0}}:host([disabled]){opacity:var(--_disabled-active-track-opacity);--md-elevation-level: var(--_disabled-handle-elevation)}.container{flex:1;display:flex;align-items:center;position:relative;block-size:var(--_state-layer-size);pointer-events:none;touch-action:none}.track,.tickmarks{position:absolute;inset:0;display:flex;align-items:center}.track::before,.tickmarks::before,.track::after,.tickmarks::after{position:absolute;content:"";inset-inline-start:calc(var(--_state-layer-size)/2 - var(--_with-tick-marks-container-size));inset-inline-end:calc(var(--_state-layer-size)/2 - var(--_with-tick-marks-container-size));background-size:calc((100% - var(--_with-tick-marks-container-size)*2)/var(--_tick-count)) 100%}.track::before,.tickmarks::before{block-size:var(--_inactive-track-height);border-radius:var(--_inactive-track-shape)}.track::before{background:var(--_inactive-track-color)}.tickmarks::before{background-image:radial-gradient(circle at var(--_with-tick-marks-container-size) center, var(--_with-tick-marks-inactive-container-color) 0, var(--_with-tick-marks-inactive-container-color) calc(var(--_with-tick-marks-container-size) / 2), transparent calc(var(--_with-tick-marks-container-size) / 2))}:host([disabled]) .track::before{opacity:calc(1/var(--_disabled-active-track-opacity)*var(--_disabled-inactive-track-opacity));background:var(--_disabled-inactive-track-color)}.track::after,.tickmarks::after{block-size:var(--_active-track-height);border-radius:var(--_active-track-shape);clip-path:inset(0 calc(var(--_with-tick-marks-container-size) * min((1 - var(--_end-fraction)) * 1000000000, 1) + (100% - var(--_with-tick-marks-container-size) * 2) * (1 - var(--_end-fraction))) 0 calc(var(--_with-tick-marks-container-size) * min(var(--_start-fraction) * 1000000000, 1) + (100% - var(--_with-tick-marks-container-size) * 2) * var(--_start-fraction)))}.track::after{background:var(--_active-track-color)}.tickmarks::after{background-image:radial-gradient(circle at var(--_with-tick-marks-container-size) center, var(--_with-tick-marks-active-container-color) 0, var(--_with-tick-marks-active-container-color) calc(var(--_with-tick-marks-container-size) / 2), transparent calc(var(--_with-tick-marks-container-size) / 2))}.track:dir(rtl)::after{clip-path:inset(0 calc(var(--_with-tick-marks-container-size) * min(var(--_start-fraction) * 1000000000, 1) + (100% - var(--_with-tick-marks-container-size) * 2) * var(--_start-fraction)) 0 calc(var(--_with-tick-marks-container-size) * min((1 - var(--_end-fraction)) * 1000000000, 1) + (100% - var(--_with-tick-marks-container-size) * 2) * (1 - var(--_end-fraction))))}.tickmarks:dir(rtl)::after{clip-path:inset(0 calc(var(--_with-tick-marks-container-size) * min(var(--_start-fraction) * 1000000000, 1) + (100% - var(--_with-tick-marks-container-size) * 2) * var(--_start-fraction)) 0 calc(var(--_with-tick-marks-container-size) * min((1 - var(--_end-fraction)) * 1000000000, 1) + (100% - var(--_with-tick-marks-container-size) * 2) * (1 - var(--_end-fraction))))}:host([disabled]) .track::after{background:var(--_disabled-active-track-color)}:host([disabled]) .tickmarks::before{background-image:radial-gradient(circle at var(--_with-tick-marks-container-size) center, var(--_with-tick-marks-disabled-container-color) 0, var(--_with-tick-marks-disabled-container-color) calc(var(--_with-tick-marks-container-size) / 2), transparent calc(var(--_with-tick-marks-container-size) / 2))}.handleContainerPadded{position:relative;block-size:100%;inline-size:100%;padding-inline:calc(var(--_state-layer-size)/2)}.handleContainerBlock{position:relative;block-size:100%;inline-size:100%}.handleContainer{position:absolute;inset-block-start:0;inset-block-end:0;inset-inline-start:calc(100%*var(--_start-fraction));inline-size:calc(100%*(var(--_end-fraction) - var(--_start-fraction)))}.handle{position:absolute;block-size:var(--_state-layer-size);inline-size:var(--_state-layer-size);border-radius:var(--_handle-shape);display:flex;place-content:center;place-items:center}.handleNub{position:absolute;height:var(--_handle-height);width:var(--_handle-width);border-radius:var(--_handle-shape);background:var(--_handle-color)}:host([disabled]) .handleNub{background:var(--_disabled-handle-color)}input.end:focus~.handleContainerPadded .handle.end>.handleNub,input.start:focus~.handleContainerPadded .handle.start>.handleNub{background:var(--_focus-handle-color)}.container>.handleContainerPadded .handle.hover>.handleNub{background:var(--_hover-handle-color)}:host(:not([disabled])) input.end:active~.handleContainerPadded .handle.end>.handleNub,:host(:not([disabled])) input.start:active~.handleContainerPadded .handle.start>.handleNub{background:var(--_pressed-handle-color)}.onTop.isOverlapping .label,.onTop.isOverlapping .label::before{outline:var(--_with-overlap-handle-outline-color) solid var(--_with-overlap-handle-outline-width)}.onTop.isOverlapping .handleNub{border:var(--_with-overlap-handle-outline-color) solid var(--_with-overlap-handle-outline-width)}.handle.start{inset-inline-start:calc(0px - var(--_state-layer-size)/2)}.handle.end{inset-inline-end:calc(0px - var(--_state-layer-size)/2)}.label{position:absolute;box-sizing:border-box;display:flex;padding:4px;place-content:center;place-items:center;border-radius:var(--md-sys-shape-corner-full, 9999px);color:var(--_label-text-color);font-family:var(--_label-text-font);font-size:var(--_label-text-size);line-height:var(--_label-text-line-height);font-weight:var(--_label-text-weight);inset-block-end:100%;min-inline-size:var(--_label-container-height);min-block-size:var(--_label-container-height);background:var(--_label-container-color);transition:transform 100ms cubic-bezier(0.2, 0, 0, 1);transform-origin:center bottom;transform:scale(0)}:host(:focus-within) .label,.handleContainer.hover .label,:where(:has(input:active)) .label{transform:scale(1)}.label::before,.label::after{position:absolute;display:block;content:"";background:inherit}.label::before{inline-size:calc(var(--_label-container-height)/2);block-size:calc(var(--_label-container-height)/2);bottom:calc(var(--_label-container-height)/-10);transform:rotate(45deg)}.label::after{inset:0px;border-radius:inherit}.labelContent{z-index:1}input[type=range]{opacity:0;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;box-sizing:border-box;height:100%;width:100%;margin:0;background:rgba(0,0,0,0);cursor:pointer;pointer-events:auto;appearance:none}input[type=range]:focus{outline:none}::-webkit-slider-runnable-track{-webkit-appearance:none}::-moz-range-track{appearance:none}::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;block-size:var(--_handle-height);inline-size:var(--_handle-width);opacity:0;z-index:2}input.end::-webkit-slider-thumb{--_track-and-knob-padding: calc( (var(--_state-layer-size) - var(--_handle-width)) / 2 );--_x-translate: calc( var(--_track-and-knob-padding) - 2 * var(--_end-fraction) * var(--_track-and-knob-padding) );transform:translateX(var(--_x-translate))}input.end:dir(rtl)::-webkit-slider-thumb{transform:translateX(calc(-1 * var(--_x-translate)))}input.start::-webkit-slider-thumb{--_track-and-knob-padding: calc( (var(--_state-layer-size) - var(--_handle-width)) / 2 );--_x-translate: calc( var(--_track-and-knob-padding) - 2 * var(--_start-fraction) * var(--_track-and-knob-padding) );transform:translateX(var(--_x-translate))}input.start:dir(rtl)::-webkit-slider-thumb{transform:translateX(calc(-1 * var(--_x-translate)))}::-moz-range-thumb{appearance:none;block-size:var(--_state-layer-size);inline-size:var(--_state-layer-size);transform:scaleX(0);opacity:0;z-index:2}.ranged input.start{clip-path:inset(0 calc(100% - (var(--_state-layer-size) / 2 + (100% - var(--_state-layer-size)) * (var(--_start-fraction) + (var(--_end-fraction) - var(--_start-fraction)) / 2))) 0 0)}.ranged input.start:dir(rtl){clip-path:inset(0 0 0 calc(100% - (var(--_state-layer-size) / 2 + (100% - var(--_state-layer-size)) * (var(--_start-fraction) + (var(--_end-fraction) - var(--_start-fraction)) / 2))))}.ranged input.end{clip-path:inset(0 0 0 calc(var(--_state-layer-size) / 2 + (100% - var(--_state-layer-size)) * (var(--_start-fraction) + (var(--_end-fraction) - var(--_start-fraction)) / 2)))}.ranged input.end:dir(rtl){clip-path:inset(0 calc(var(--_state-layer-size) / 2 + (100% - var(--_state-layer-size)) * (var(--_start-fraction) + (var(--_end-fraction) - var(--_start-fraction)) / 2)) 0 0)}.onTop{z-index:1}.handle{--md-ripple-hover-color: var(--_hover-state-layer-color);--md-ripple-hover-opacity: var(--_hover-state-layer-opacity);--md-ripple-pressed-color: var(--_pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_pressed-state-layer-opacity)}md-ripple{border-radius:50%;height:var(--_state-layer-size);width:var(--_state-layer-size)}
`;let XE=class extends qE{};XE.styles=[GE,UE],XE=it([ph("md-slider")],XE);const KE=vh`:host{--_disabled-icon-color: var(--md-icon-button-disabled-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-icon-opacity: var(--md-icon-button-disabled-icon-opacity, 0.38);--_icon-size: var(--md-icon-button-icon-size, 24px);--_selected-focus-icon-color: var(--md-icon-button-selected-focus-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-hover-icon-color: var(--md-icon-button-selected-hover-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-hover-state-layer-color: var(--md-icon-button-selected-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--_selected-hover-state-layer-opacity: var(--md-icon-button-selected-hover-state-layer-opacity, 0.08);--_selected-icon-color: var(--md-icon-button-selected-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-pressed-icon-color: var(--md-icon-button-selected-pressed-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-pressed-state-layer-color: var(--md-icon-button-selected-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--_selected-pressed-state-layer-opacity: var(--md-icon-button-selected-pressed-state-layer-opacity, 0.12);--_state-layer-height: var(--md-icon-button-state-layer-height, 40px);--_state-layer-shape: var(--md-icon-button-state-layer-shape, var(--md-sys-shape-corner-full, 9999px));--_state-layer-width: var(--md-icon-button-state-layer-width, 40px);--_focus-icon-color: var(--md-icon-button-focus-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-icon-color: var(--md-icon-button-hover-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-color: var(--md-icon-button-hover-state-layer-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-opacity: var(--md-icon-button-hover-state-layer-opacity, 0.08);--_icon-color: var(--md-icon-button-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-icon-color: var(--md-icon-button-pressed-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-state-layer-color: var(--md-icon-button-pressed-state-layer-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-state-layer-opacity: var(--md-icon-button-pressed-state-layer-opacity, 0.12);--_container-shape-start-start: 0;--_container-shape-start-end: 0;--_container-shape-end-end: 0;--_container-shape-end-start: 0;--_container-height: 0;--_container-width: 0;height:var(--_state-layer-height);width:var(--_state-layer-width)}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--_state-layer-height))/2) max(0px,(48px - var(--_state-layer-width))/2)}md-focus-ring{--md-focus-ring-shape-start-start: var(--_state-layer-shape);--md-focus-ring-shape-start-end: var(--_state-layer-shape);--md-focus-ring-shape-end-end: var(--_state-layer-shape);--md-focus-ring-shape-end-start: var(--_state-layer-shape)}.standard{background-color:rgba(0,0,0,0);color:var(--_icon-color);--md-ripple-hover-color: var(--_hover-state-layer-color);--md-ripple-hover-opacity: var(--_hover-state-layer-opacity);--md-ripple-pressed-color: var(--_pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_pressed-state-layer-opacity)}.standard:hover{color:var(--_hover-icon-color)}.standard:focus{color:var(--_focus-icon-color)}.standard:active{color:var(--_pressed-icon-color)}.standard:disabled{color:var(--_disabled-icon-color)}md-ripple{border-radius:var(--_state-layer-shape)}.standard:disabled .icon{opacity:var(--_disabled-icon-opacity)}.selected{--md-ripple-hover-color: var(--_selected-hover-state-layer-color);--md-ripple-hover-opacity: var(--_selected-hover-state-layer-opacity);--md-ripple-pressed-color: var(--_selected-pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_selected-pressed-state-layer-opacity)}.selected:not(:disabled){color:var(--_selected-icon-color)}.selected:not(:disabled):hover{color:var(--_selected-hover-icon-color)}.selected:not(:disabled):focus{color:var(--_selected-focus-icon-color)}.selected:not(:disabled):active{color:var(--_selected-pressed-icon-color)}
`;let JE=class extends Lm{getRenderClasses(){return{...super.getRenderClasses(),standard:!0}}};JE.styles=[Pm,KE],JE=it([ph("md-icon-button")],JE);class QE extends $p{constructor(){super(...arguments),this.disabled=!1,this.type="menuitem",this.href="",this.target="",this.keepOpen=!1,this.selected=!1,this.menuItemController=new PC(this,{getHeadlineElements:()=>this.headlineElements,getSupportingTextElements:()=>this.supportingTextElements,getDefaultElements:()=>this.defaultElements,getInteractiveElement:()=>this.listItemRoot})}get typeaheadText(){return this.menuItemController.typeaheadText}set typeaheadText(t){this.menuItemController.setTypeaheadText(t)}render(){return this.renderListItem(dp`
      <md-item>
        <div slot="container">
          ${this.renderRipple()} ${this.renderFocusRing()}
        </div>
        <slot name="start" slot="start"></slot>
        <slot name="end" slot="end"></slot>
        ${this.renderBody()}
      </md-item>
    `)}renderListItem(t){const e="link"===this.type;let i;switch(this.menuItemController.tagName){case"a":i=Zp`a`;break;case"button":i=Zp`button`;break;default:i=Zp`li`}const r=e&&this.target?this.target:pp;return Wp`
      <${i}
        id="item"
        tabindex=${this.disabled&&!e?-1:0}
        role=${this.menuItemController.role}
        aria-label=${this.ariaLabel||pp}
        aria-selected=${this.ariaSelected||pp}
        aria-checked=${this.ariaChecked||pp}
        aria-expanded=${this.ariaExpanded||pp}
        aria-haspopup=${this.ariaHasPopup||pp}
        class="list-item ${zp(this.getRenderClasses())}"
        href=${this.href||pp}
        target=${r}
        @click=${this.menuItemController.onClick}
        @keydown=${this.menuItemController.onKeydown}
      >${t}</${i}>
    `}renderRipple(){return dp` <md-ripple
      part="ripple"
      for="item"
      ?disabled=${this.disabled}></md-ripple>`}renderFocusRing(){return dp` <md-focus-ring
      part="focus-ring"
      for="item"
      inward></md-focus-ring>`}getRenderClasses(){return{disabled:this.disabled,selected:this.selected}}renderBody(){return dp`
      <slot></slot>
      <slot name="overline" slot="overline"></slot>
      <slot name="headline" slot="headline"></slot>
      <slot name="supporting-text" slot="supporting-text"></slot>
      <slot
        name="trailing-supporting-text"
        slot="trailing-supporting-text"></slot>
    `}focus(){this.listItemRoot?.focus()}}ru(QE),QE.shadowRootOptions={...$p.shadowRootOptions,delegatesFocus:!0},it([jh({type:Boolean,reflect:!0})],QE.prototype,"disabled",void 0),it([jh()],QE.prototype,"type",void 0),it([jh()],QE.prototype,"href",void 0),it([jh()],QE.prototype,"target",void 0),it([jh({type:Boolean,attribute:"keep-open"})],QE.prototype,"keepOpen",void 0),it([jh({type:Boolean})],QE.prototype,"selected",void 0),it([Fh(".list-item")],QE.prototype,"listItemRoot",void 0),it([Vh({slot:"headline"})],QE.prototype,"headlineElements",void 0),it([Vh({slot:"supporting-text"})],QE.prototype,"supportingTextElements",void 0),it([Uh({slot:""})],QE.prototype,"defaultElements",void 0),it([jh({attribute:"typeahead-text"})],QE.prototype,"typeaheadText",null);let t$=class extends QE{};t$.styles=[$C],t$=it([ph("md-menu-item")],t$);class e$ extends(al(K)){static get styles(){return[nl,n`
        #container {
          background-color: #ffffff;
          border-radius: 14px;
          width: 100%;
          position: absolute;
          bottom: 8px;
          height: 24px;
          display: flex;
          justify-content: center;
          align-items: center;
        }

        md-slider {
          width: 100%;
          --md-slider-active-track-color: var(--md-sys-color-primary);
          --md-slider-inactive-track-color: var(--md-sys-color-primary);
        }

        div.date {
          display: inline-block;
          font-size: 13px;
          font-weight: 500;
          color: rgba(0, 0, 0, 0.6);
          white-space: nowrap;
          margin-left: 4px;
          margin-right: 8px;
          line-height: 24px;
          height: 24px;
          min-width: 75px;
          text-align: right;
        }

        .date .year {
          font-weight: 600;
        }

        .control {
          --md-icon-button-icon-size: 18px;
          --md-icon-button-state-layer-height: 22px;
          --md-icon-button-state-layer-width: 22px;
          height: 22px;
          width: 22px;
          display: inline-block;
        }

        md-menu {
          --md-menu-item-one-line-container-height: 48px;
        }

        md-switch {
          transform: scale(0.5);
        }
      `]}static get properties(){return{value:{type:Number},span:{type:Number},min:{type:Number},filterMap:{type:Boolean}}}constructor(){super(),this.min=1500,this.value=(new Date).getFullYear()-50,this.span=50,this.filterMap=!1}render(){return M`
      <div id="container">
        <md-slider
          @input="${this._handleInput}"
          ?disabled="${!this.filterMap&&this.span<0}"
          labeled
          min="${this.min}"
          max="${(new Date).getFullYear()}"
          value="${this.value}"
        ></md-slider>
        <div class="date">
          ${!this.filterMap&&this.span<0?"":M` <span class="year">${this.value}</span>`}
          ${this.span>0?M`&pm; <span class="span">${this.span}</span>`:""}
        </div>
        <div class="control">
          <md-icon-button
            id="span-button"
            @click="${this._handleSpanClick}"
            ?disabled="${this.span<0}"
          >
            <grampsjs-tooltip for="span-button" .strings="${this.strings}"
              >${this._("Span")}</grampsjs-tooltip
            >
            <md-icon
              >${Ha("M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z","var(--md-sys-color-primary)")}</md-icon
            >
          </md-icon-button>
        </div>
        <md-switch
          id="filter-switch"
          @input="${this._handleSwitch}"
          ?selected="${this.span>0}"
        ></md-switch>
        <grampsjs-tooltip for="filter-switch" .strings="${this.strings}"
          >${this._("Toggle time filter for places")}</grampsjs-tooltip
        >
      </div>
      <md-menu
        positioning="fixed"
        id="span-menu"
        anchor="span-button"
        skip-restore-focus
      >
        ${[1,10,25,50,100].map((t=>M`
            <md-menu-item @click="${()=>this._handleSpanYearsClick(t)}">
              <div slot="headline">&pm;&nbsp;${t}</div>
            </md-menu-item>
          `))}
      </md-menu>
    `}_fireEvent(){os(this,"timeslider:change",{value:this.value,span:this.span})}connectedCallback(){super.connectedCallback(),this._fireEvent()}_handleSwitch(){this.renderRoot.querySelector("md-switch").selected!==this.span>0&&(this.span=-this.span),this._fireEvent()}_handleSpanYearsClick(t){this.span=t,this._fireEvent()}_handleSpanClick(){this.renderRoot.querySelector("#span-menu").open=!0}_handleInput(){const t=this.renderRoot.querySelector("md-slider");this.value=t.value,this._fireEvent()}}window.customElements.define("grampsjs-map-time-slider",e$);window.customElements.define("grampsjs-connected-gallery",class extends fm{static get properties(){return{objectType:{type:String},handle:{type:String},radius:{type:Number},size:{type:Number},square:{type:Boolean},count:{type:Number}}}constructor(){super(),this.objectType="",this.handle="",this.radius=0,this.size=200,this.square=!1,this.count=1}getUrl(){return`/api/${is[this.objectType]}/${this.handle}?extend=all&profile=all&locale=${this.strings?.__lang__||"en"}`}renderLoading(){return[...Array(this.count).keys()].map((()=>M`<span
        class="skeleton"
        style="width:${this.size}px;height:${this.size}px;margin:3px;border-radius:${this.radius};"
        >&nbsp;</span
      >`))}renderContent(){const t=this._data.data;return t?.media_list?.length?M`
      <grampsjs-gallery
        .strings=${this.strings}
        .media=${t?.extended?.media}
        .mediaRef=${t?.media_list}
        radius="${this.radius}"
        size="${this.size}"
        ?square="${this.square}"
      ></grampsjs-gallery>
    `:""}update(t){super.update(t),t.has("handle")&&this._updateData()}});class i$ extends(al(K)){static get styles(){return[nl,n`
        h2,
        h3,
        h4 {
          font-family: var(--grampsjs-body-font-family);
        }

        h2 {
          font-weight: 400;
          font-size: 22px;
          margin-top: 10px;
        }

        h3 {
          font-weight: 400;
          font-size: 18px;
          margin-bottom: 5px;
          margin-bottom: 7px;
        }

        h4 {
          margin-top: 2px;
          font-weight: 300;
          font-size: 15px;
        }

        :host {
          font-size: 16px;
        }

        .right {
          text-align: right;
        }

        #banner {
          background-color: red;
          height: 150px;
          width: 302px;
          margin-top: -15px;
          margin-left: -20px;
          position: relative;
        }

        p {
          margin-top: 0.6em;
          margin-bottom: 0.6em;
        }
      `]}static get properties(){return{data:{type:Object}}}constructor(){super(),this.data={}}render(){return M`
    <h2>
      ${this.data?.name?.value||this.data.title||this._("Place")}
      ${this.data?.profile?.parent_places.length>0?M`<h4>
              ${this.data.profile.parent_places.map((t=>t.name)).join(", ")}
            </h4>`:""}
          </h4>

    ${this.data?.media_list?.length?M`
            <h3>${this._("Gallery")}</h3>

            <grampsjs-connected-gallery
              .strings=${this.strings}
              handle=${this.data.handle}
              objectType="place"
              square
              size="95"
              radius="7"
              count="${this.data?.media_list?.length||1}"
            ></grampsjs-connected-gallery>
          `:""}

    <div class="right">
      <mwc-button
        @click="${this._handleDetailClick}"
      >${this._("Show Details")}</mwc-button>
    </div>
    `}_handleDetailClick(){os(this,"nav",{path:`place/${this.data.gramps_id}`})}}window.customElements.define("grampsjs-place-box",i$);const r$={ar:[25,45],bg:[43,25],br:[48,-3],ca:[41,2],cs:[49,15],da:[56,10],de:[51,9],el:[39,22],en:[52,-1],eo:[41,0],es:[40,-4],fi:[64,26],fr:[46,2],ga:[53,-8],he:[32,35],hr:[45,16],hu:[47,19],is:[65,-18],it:[42,12],ja:[36,138],lt:[55,24],mk:[42,21],nb:[62,10],nl:[52,5],nn:[62,10],pl:[52,20],pt:[39,-8],ro:[46,25],ru:[60,100],sk:[48,19],sl:[46,14],sq:[41,20],sr:[44,21],sv:[62,16],ta:[11,78],tr:[39,35],uk:[49,31],vi:[16,106],zh:[35,105],ko:[38,128]};window.customElements.define("grampsjs-view-map",class extends $d{static get styles(){return[super.styles,n`
        :host {
          margin: 0;
          margin-top: -4px;
        }
      `]}static get properties(){return{_dataPlaces:{type:Array},_dataEvents:{type:Array},_filteredPlaces:{type:Array},_handlesHighlight:{type:Array},_dataSearch:{type:Array},_dataLayers:{type:Array},_selected:{type:String},_valueSearch:{type:String},_bounds:{type:Object},_placeFilters:{type:Object},_year:{type:Number},_yearSpan:{type:Number},_currentLayer:{type:String},_minYear:{type:Number}}}constructor(){super(),this._dataPlaces=[],this._dataEvents=[],this._filteredPlaces=[],this._handlesHighlight=[],this._dataSearch=[],this._dataLayers=[],this._selected="",this._valueSearch="",this._bounds={},this._placeFilters={},this._year=-1,this._yearSpan=-1,this._currentLayer="",this._minYear=1500}renderContent(){const t=this._getMapCenter();return M`
      <grampsjs-map
        layerSwitcher
        locateControl
        width="100%"
        height="calc(100vh - 64px - 36px)"
        latitude="${t[0]}"
        longitude="${t[1]}"
        year="${this._year}"
        mapid="map-mapview"
        @map:layerchange="${this._handleLayerChange}"
        @map:moveend="${this._handleMoveEnd}"
        id="map"
        zoom="6"
        >${this._renderMarkers()}${this._renderLayers()}</grampsjs-map
      >
      <grampsjs-map-searchbox
        @mapsearch:input="${this._handleSearchInput}"
        @mapsearch:clear="${this._handleSearchClear}"
        @mapsearch:selected="${this._handleSearchSelected}"
        @placefilter:changed="${this._handlePlaceFilterChanged}"
        .data="${this._dataSearch}"
        .strings="${this.strings}"
        .placeFilters="${this._placeFilters}"
        value="${this._valueSearch}"
        >${this._renderPlaceDetails()}</grampsjs-map-searchbox
      >
      <grampsjs-map-time-slider
        min="${this._minYear}"
        ?filterMap="${"OpenHistoricalMap"===this._currentLayer}"
        @timeslider:change="${this._handleTimeSliderChange}"
        .strings="${this.strings}"
      ></grampsjs-map-time-slider>
    `}_renderPlaceDetails(){if(0===this._handlesHighlight.length)return"";const[t]=this._handlesHighlight,[e]=this._dataPlaces.filter((e=>e.handle===t));return void 0===e?(this._clearSearchBox(),""):M`
      <grampsjs-place-box
        .data="${e}"
        .strings="${this.strings}"
      ></grampsjs-place-box>
    `}_handleLayerChange(t){this._currentLayer=t.detail.layer}update(t){if(super.update(t),t.has("active")&&this.active){const t=this.shadowRoot.getElementById("map");null!==t&&void 0!==t._map&&t._map.invalidateSize(!1);const e=this.shadowRoot.querySelector("grampsjs-map-searchbox");null!==e&&e.focus()}}_handleTimeSliderChange(t){this._year=t.detail.value,this._yearSpan=t.detail.span,this._applyPlaceFilter()}_handlePlaceFilterChanged(t){this._placeFilters={...t.detail},this._applyPlaceFilter()}_handleSearchInput(t){this._fetchDataSearch(t.detail.value)}_handleSearchClear(){this._dataSearch=[],this._valueSearch="",this._handlesHighlight=[]}_clearSearchBox(){const t=this.renderRoot.querySelector("grampsjs-map-searchbox");void 0!==t&&t.clear()}_handleSearchSelected(t){const{object:e}=t.detail;this._handlePlaceSelected(e)}_handleMarkerClick(t){this._handlePlaceSelected(t)}_handlePlaceSelected(t){this._dataSearch=[],this._valueSearch=t.profile.name,this._handlesHighlight=[t.handle],t.lat&&t.long&&(this.latitude=t.profile.lat,this.longitude=t.profile.long,this.getZoom()<14&&this.setZoom(14),this.panTo(this.latitude,this.longitude))}panTo(t,e){this.renderRoot.querySelector("grampsjs-map").panTo(t,e)}setZoom(t){this.renderRoot.querySelector("grampsjs-map")._map.setZoom(t)}getZoom(){return this.renderRoot.querySelector("grampsjs-map")._map.getZoom()}_renderLayers(){return M` ${this._dataLayers.map((t=>this._renderMapLayer(t)))} `}_renderMapLayer(t){const e=t.attribute_list.filter((t=>"map:bounds"===t.type))[0].value;return M`
      <grampsjs-map-overlay
        url="${Vn(t.handle)}"
        title="${t.desc}"
        bounds="${e}"
        ?hidden="${!this._isLayerVisible(JSON.parse(e))}"
      ></grampsjs-map-overlay>
    `}_isLayerVisible(t){if(0===Object.keys(this._bounds).length)return!1;const e=[[this._bounds._southWest.lat,this._bounds._southWest.lng],[this._bounds._northEast.lat,this._bounds._northEast.lng]];return t[0][0]<e[1][0]&&t[1][0]>e[0][0]&&t[0][1]<e[1][1]&&t[1][1]>e[0][1]}_handleMoveEnd(t){this._bounds=t.detail.bounds}_renderMarkers(){const t=this._filteredPlaces.map((t=>t.handle)),e=this._dataPlaces.filter((e=>this._handlesHighlight.includes(e.handle)&&!t.includes(e.handle)));return[...this._filteredPlaces,...e].map((t=>{if(null==t?.profile?.lat||Number.isNaN(parseFloat(t?.profile?.lat))||null==t?.profile?.long||Number.isNaN(parseFloat(t?.profile?.long))||0===t?.profile?.lat&&0===t?.profile?.long)return M``;const e=this._handlesHighlight.includes(t.handle);return M` <grampsjs-map-marker
        latitude="${t.profile.lat}"
        longitude="${t.profile.long}"
        size="${e?48:32}"
        opacity="${!e&&this._handlesHighlight.length>0?.55:.9}"
        popupLabel="<a href='place/${t.profile.gramps_id}'>${t.profile.name}</a>"
        @marker:clicked="${()=>this._handleMarkerClick(t)}"
      ></grampsjs-map-marker>`}))}_applyPlaceFilter(){const t=Object.keys(this._placeFilters).filter((t=>!!this._placeFilters[t])),e=e=>{if(t.includes("hasEvent")&&void 0===e?.backlinks?.event?.length)return!1;if(this._year>0&&this._yearSpan>0){const t=e?.backlinks?.event?.map((t=>this._dataEvents?.find((e=>e.handle===t))))??[];if(0===t.length)return!1;const i=this._year-this._yearSpan,r=this._year+this._yearSpan;return t.some((t=>function(t,e,i){if(void 0===t||_s(t)||6===t.modifier)return!1;let[r,n]=bs(t);return void 0!==r&&(1!==t.modifier&&8!==t.modifier||(r-=50),2!==t.modifier&&7!==t.modifier||(n+=50),3===t.modifier&&(r-=50,n+=50),e<=n&&r<=i)}(t?.date,i,r)))}return!0};this._filteredPlaces=[...this._dataPlaces.filter((t=>e(t)))]}firstUpdated(){this._fetchPlaces(),this._fetchDataLayers(),this._fetchEvents()}_fetchDataAll(){this._fetchPlaces(),this._fetchDataLayers(),this._fetchEvents()}async _fetchDataSearch(t){const e=encodeURIComponent(`${t}*${window._oldSearchBackend?" AND type:place`":""}`),i=this.strings?.__lang__||"en",r=await On(`/api/search/?query=${e}&locale=${i}&profile=self&page=1&pagesize=20${window._oldSearchBackend?"":"&type=place"}`);this.loading=!1,"data"in r?(this.error=!1,this._dataSearch=r.data):"error"in r&&(this.error=!0,this._errorMessage=r.error)}async _fetchPlaces(){const t=await On(`/api/places/?locale=${this.strings?.__lang__||"en"}&profile=self&backlinks=1`);this.loading=!1,"data"in t?(this.error=!1,this._dataPlaces=t.data,this._applyPlaceFilter()):"error"in t&&(this.error=!0,this._errorMessage=t.error)}async _fetchEvents(){const t=await On("/api/events/?keys=date,handle,place");this.loading=!1,"data"in t?(this.error=!1,this._dataEvents=t.data.filter((t=>t.place)),this._minYear=this._getMinYear(),this._applyPlaceFilter()):"error"in t&&(this.error=!0,this._errorMessage=t.error)}_getMinYear(){const t=this._dataEvents?.filter((t=>t.place))?.map((t=>bs(t.date)?.[0]))?.filter((t=>void 0!==t));let e=Math.min(...t);const i=(new Date).getFullYear()-1;return e=Math.min(e,i),e=Math.max(e,1),e}async _fetchDataLayers(){const t=await On(`/api/media/?rules=${encodeURIComponent(JSON.stringify({rules:[{name:"HasAttribute",values:["map:bounds","*"],regex:!0}]}))}`);this.loading=!1,"data"in t?(this.error=!1,this._dataLayers=t.data):"error"in t&&(this.error=!0,this._errorMessage=t.error)}_getMapCenter(){if(0===this._dataPlaces.length){const t=this.strings?.__lang__||"en";return r$[t]||[0,0]}let t=0,e=0,i=0;for(let r=0;r<this._dataPlaces.length;r+=1){const n=this._dataPlaces[r];null==n?.profile?.lat||0===n?.profile?.lat&&0===n?.profile?.long||(t+=n.profile.lat,e+=n.profile.long,i+=1)}return t/=i,e/=i,[t,e]}connectedCallback(){super.connectedCallback(),window.addEventListener("db:changed",(()=>this._fetchDataAll()))}});const n$=Symbol("isFocusable"),a$=Symbol("privateIsFocusable"),s$=Symbol("externalTabIndex"),o$=Symbol("isUpdatingTabIndex"),l$=Symbol("updateTabIndex");var c$;const d$=Symbol("indicator"),h$=Symbol("animateIndicator"),p$=function(t){var e,i,r;class n extends t{constructor(){super(...arguments),this[e]=!0,this[i]=null,this[r]=!1}get[n$](){return this[a$]}set[n$](t){this[n$]!==t&&(this[a$]=t,this[l$]())}connectedCallback(){super.connectedCallback(),this[l$]()}attributeChangedCallback(t,e,i){if("tabindex"===t){if(this.requestUpdate("tabIndex",Number(e??-1)),!this[o$])return this.hasAttribute("tabindex")?void(this[s$]=this.tabIndex):(this[s$]=null,void this[l$]())}else super.attributeChangedCallback(t,e,i)}[(e=a$,i=s$,r=o$,l$)](){const t=this[n$]?0:-1,e=this[s$]??t;this[o$]=!0,this.tabIndex=e,this[o$]=!1}}return it([jh({noAccessor:!0})],n.prototype,"tabIndex",void 0),n}($p);class u$ extends p${get selected(){return this.active}set selected(t){this.active=t}constructor(){super(),this.isTab=!0,this.active=!1,this.hasIcon=!1,this.iconOnly=!1,this.fullWidthIndicator=!1,this.internals=this.attachInternals(),this.internals.role="tab",this.addEventListener("keydown",this.handleKeydown.bind(this))}render(){const t=dp`<div class="indicator"></div>`;return dp`<div
      class="button"
      role="presentation"
      @click=${this.handleContentClick}>
      <md-focus-ring part="focus-ring" inward .control=${this}></md-focus-ring>
      <md-elevation part="elevation"></md-elevation>
      <md-ripple .control=${this}></md-ripple>
      <div
        class="content ${zp(this.getContentClasses())}"
        role="presentation">
        <slot name="icon" @slotchange=${this.handleIconSlotChange}></slot>
        <slot @slotchange=${this.handleSlotChange}></slot>
        ${this.fullWidthIndicator?pp:t}
      </div>
      ${this.fullWidthIndicator?t:pp}
    </div>`}getContentClasses(){return{"has-icon":this.hasIcon,"has-label":!this.iconOnly}}updated(){this.internals.ariaSelected=String(this.active)}async handleKeydown(t){await 0,t.defaultPrevented||"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),this.click())}handleContentClick(t){t.stopPropagation(),this.click()}[(c$=d$,h$)](t){if(!this[d$])return;this[d$].getAnimations().forEach((t=>{t.cancel()}));const e=this.getKeyframes(t);null!==e&&this[d$].animate(e,{duration:250,easing:jp})}getKeyframes(t){const e=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(!this.active)return e?[{opacity:1},{transform:"none"}]:null;const i={},r=t[d$]?.getBoundingClientRect()??{},n=r.left,a=r.width,s=this[d$].getBoundingClientRect(),o=s.left,l=a/s.width;return e||void 0===n||void 0===o||isNaN(l)?i.opacity=0:i.transform=`translateX(${(n-o).toFixed(4)}px) scaleX(${l.toFixed(4)})`,[i,{transform:"none"}]}handleSlotChange(){this.iconOnly=!1;for(const t of this.assignedDefaultNodes){const e=t.nodeType===Node.TEXT_NODE&&!!t.wholeText.match(/\S/);if(t.nodeType===Node.ELEMENT_NODE||e)return}this.iconOnly=!0}handleIconSlotChange(){this.hasIcon=this.assignedIcons.length>0}}it([jh({type:Boolean,reflect:!0,attribute:"md-tab"})],u$.prototype,"isTab",void 0),it([jh({type:Boolean,reflect:!0})],u$.prototype,"active",void 0),it([jh({type:Boolean})],u$.prototype,"selected",null),it([jh({type:Boolean,attribute:"has-icon"})],u$.prototype,"hasIcon",void 0),it([jh({type:Boolean,attribute:"icon-only"})],u$.prototype,"iconOnly",void 0),it([Fh(".indicator")],u$.prototype,c$,void 0),it([Oh()],u$.prototype,"fullWidthIndicator",void 0),it([Uh({flatten:!0})],u$.prototype,"assignedDefaultNodes",void 0),it([Vh({slot:"icon",flatten:!0})],u$.prototype,"assignedIcons",void 0);class m$ extends $p{get activeTab(){return this.tabs.find((t=>t.active))??null}set activeTab(t){t&&this.activateTab(t)}get activeTabIndex(){return this.tabs.findIndex((t=>t.active))}set activeTabIndex(t){const e=()=>{const e=this.tabs[t];e&&this.activateTab(e)};this.slotElement?e():this.updateComplete.then(e)}get focusedTab(){return this.tabs.find((t=>t.matches(":focus-within")))}constructor(){super(),this.autoActivate=!1,this.internals=this.attachInternals(),this.internals.role="tablist",this.addEventListener("keydown",this.handleKeydown.bind(this)),this.addEventListener("keyup",this.handleKeyup.bind(this)),this.addEventListener("focusout",this.handleFocusout.bind(this))}async scrollToTab(t){await this.updateComplete;const{tabs:e}=this;if(t??(t=this.activeTab),!t||!e.includes(t)||!this.tabsScrollerElement)return;for(const t of this.tabs)await t.updateComplete;const i=t.offsetLeft,r=t.offsetWidth,n=this.scrollLeft,a=i-48,s=i+r-this.offsetWidth+48,o=Math.min(a,Math.max(s,n)),l=this.focusedTab?"auto":"instant";this.tabsScrollerElement.scrollTo({behavior:l,top:0,left:o})}render(){return dp`
      <div class="tabs">
        <slot
          @slotchange=${this.handleSlotChange}
          @click=${this.handleTabClick}></slot>
      </div>
      <md-divider part="divider"></md-divider>
    `}async handleTabClick(t){const e=t.target;var i;(await 0,t.defaultPrevented||!((i=e)instanceof HTMLElement&&i.hasAttribute("md-tab"))||e.active)||this.activateTab(e)}activateTab(t){const{tabs:e}=this,i=this.activeTab;if(e.includes(t)&&i!==t){for(const i of e)i.active=i===t;if(i){if(!this.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))){for(const t of e)t.active=t===i;return}t[h$](i)}this.updateFocusableTab(t),this.scrollToTab(t)}}updateFocusableTab(t){for(const e of this.tabs)e.tabIndex=e===t?0:-1}async handleKeydown(t){await 0;const e="ArrowLeft"===t.key,i="ArrowRight"===t.key,r="Home"===t.key,n="End"===t.key;if(t.defaultPrevented||!e&&!i&&!r&&!n)return;const{tabs:a}=this;if(a.length<2)return;let s;if(t.preventDefault(),r||n)s=r?0:a.length-1;else{const t="rtl"===getComputedStyle(this).direction?e:i,{focusedTab:r}=this;if(r){const e=this.tabs.indexOf(r);s=t?e+1:e-1,s>=a.length?s=0:s<0&&(s=a.length-1)}else s=t?0:a.length-1}const o=a[s];o.focus(),this.autoActivate?this.activateTab(o):this.updateFocusableTab(o)}handleKeyup(){this.scrollToTab(this.focusedTab??this.activeTab)}handleFocusout(){if(this.matches(":focus-within"))return;const{activeTab:t}=this;t&&this.updateFocusableTab(t)}handleSlotChange(){const t=this.tabs[0];!this.activeTab&&t&&this.activateTab(t),this.scrollToTab(this.activeTab)}}it([Vh({flatten:!0,selector:"[md-tab]"})],m$.prototype,"tabs",void 0),it([jh({type:Number,attribute:"active-tab-index"})],m$.prototype,"activeTabIndex",null),it([jh({type:Boolean,attribute:"auto-activate"})],m$.prototype,"autoActivate",void 0),it([Fh(".tabs")],m$.prototype,"tabsScrollerElement",void 0),it([Fh("slot")],m$.prototype,"slotElement",void 0);const f$=vh`:host{box-sizing:border-box;display:flex;flex-direction:column;overflow:auto;scroll-behavior:smooth;scrollbar-width:none;position:relative}:host([hidden]){display:none}:host::-webkit-scrollbar{display:none}.tabs{align-items:end;display:flex;height:100%;overflow:inherit;scroll-behavior:inherit;scrollbar-width:inherit;justify-content:space-between;width:100%}::slotted(*){flex:1}::slotted([active]){z-index:1}
`;let g$=class extends m${};g$.styles=[f$],g$=it([ph("md-tabs")],g$);class _$ extends u${constructor(){super(...arguments),this.inlineIcon=!1}getContentClasses(){return{...super.getContentClasses(),stacked:!this.inlineIcon}}}it([jh({type:Boolean,attribute:"inline-icon"})],_$.prototype,"inlineIcon",void 0);const v$=vh`:host{--_active-indicator-color: var(--md-primary-tab-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_active-indicator-height: var(--md-primary-tab-active-indicator-height, 3px);--_active-indicator-shape: var(--md-primary-tab-active-indicator-shape, 3px 3px 0px 0px);--_active-hover-state-layer-color: var(--md-primary-tab-active-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--_active-hover-state-layer-opacity: var(--md-primary-tab-active-hover-state-layer-opacity, 0.08);--_active-pressed-state-layer-color: var(--md-primary-tab-active-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--_active-pressed-state-layer-opacity: var(--md-primary-tab-active-pressed-state-layer-opacity, 0.12);--_container-color: var(--md-primary-tab-container-color, var(--md-sys-color-surface, #fef7ff));--_container-elevation: var(--md-primary-tab-container-elevation, 0);--_container-height: var(--md-primary-tab-container-height, 48px);--_with-icon-and-label-text-container-height: var(--md-primary-tab-with-icon-and-label-text-container-height, 64px);--_hover-state-layer-color: var(--md-primary-tab-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-state-layer-opacity: var(--md-primary-tab-hover-state-layer-opacity, 0.08);--_pressed-state-layer-color: var(--md-primary-tab-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--_pressed-state-layer-opacity: var(--md-primary-tab-pressed-state-layer-opacity, 0.12);--_active-focus-icon-color: var(--md-primary-tab-active-focus-icon-color, var(--md-sys-color-primary, #6750a4));--_active-hover-icon-color: var(--md-primary-tab-active-hover-icon-color, var(--md-sys-color-primary, #6750a4));--_active-icon-color: var(--md-primary-tab-active-icon-color, var(--md-sys-color-primary, #6750a4));--_active-pressed-icon-color: var(--md-primary-tab-active-pressed-icon-color, var(--md-sys-color-primary, #6750a4));--_icon-size: var(--md-primary-tab-icon-size, 24px);--_focus-icon-color: var(--md-primary-tab-focus-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-icon-color: var(--md-primary-tab-hover-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_icon-color: var(--md-primary-tab-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-icon-color: var(--md-primary-tab-pressed-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_label-text-font: var(--md-primary-tab-label-text-font, var(--md-sys-typescale-title-small-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-primary-tab-label-text-line-height, var(--md-sys-typescale-title-small-line-height, 1.25rem));--_label-text-size: var(--md-primary-tab-label-text-size, var(--md-sys-typescale-title-small-size, 0.875rem));--_label-text-weight: var(--md-primary-tab-label-text-weight, var(--md-sys-typescale-title-small-weight, var(--md-ref-typeface-weight-medium, 500)));--_active-focus-label-text-color: var(--md-primary-tab-active-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_active-hover-label-text-color: var(--md-primary-tab-active-hover-label-text-color, var(--md-sys-color-primary, #6750a4));--_active-label-text-color: var(--md-primary-tab-active-label-text-color, var(--md-sys-color-primary, #6750a4));--_active-pressed-label-text-color: var(--md-primary-tab-active-pressed-label-text-color, var(--md-sys-color-primary, #6750a4));--_focus-label-text-color: var(--md-primary-tab-focus-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-primary-tab-hover-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_label-text-color: var(--md-primary-tab-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-label-text-color: var(--md-primary-tab-pressed-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_container-shape-start-start: var(--md-primary-tab-container-shape-start-start, var(--md-primary-tab-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-start-end: var(--md-primary-tab-container-shape-start-end, var(--md-primary-tab-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-end-end: var(--md-primary-tab-container-shape-end-end, var(--md-primary-tab-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-end-start: var(--md-primary-tab-container-shape-end-start, var(--md-primary-tab-container-shape, var(--md-sys-shape-corner-none, 0px)))}.content.stacked{flex-direction:column;gap:2px}.content.stacked.has-icon.has-label{height:var(--_with-icon-and-label-text-container-height)}
`,y$=vh`:host{display:inline-flex;align-items:center;justify-content:center;outline:none;padding:0 16px;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0);vertical-align:middle;user-select:none;font-family:var(--_label-text-font);font-size:var(--_label-text-size);line-height:var(--_label-text-line-height);font-weight:var(--_label-text-weight);color:var(--_label-text-color);z-index:0;--md-ripple-hover-color: var(--_hover-state-layer-color);--md-ripple-hover-opacity: var(--_hover-state-layer-opacity);--md-ripple-pressed-color: var(--_pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_pressed-state-layer-opacity);--md-elevation-level: var(--_container-elevation)}md-focus-ring{--md-focus-ring-shape: 8px}:host([active]) md-focus-ring{margin-bottom:calc(var(--_active-indicator-height) + 1px)}.button::before{background:var(--_container-color);content:"";inset:0;position:absolute;z-index:-1}.button::before,md-ripple,md-elevation{border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-end-radius:var(--_container-shape-end-end);border-end-start-radius:var(--_container-shape-end-start)}.content{position:relative;box-sizing:border-box;display:inline-flex;flex-direction:row;align-items:center;justify-content:center;height:var(--_container-height);gap:8px}.indicator{position:absolute;box-sizing:border-box;z-index:-1;transform-origin:bottom left;background:var(--_active-indicator-color);border-radius:var(--_active-indicator-shape);height:var(--_active-indicator-height);inset:auto 0 0 0;opacity:0}::slotted([slot=icon]){display:inline-flex;position:relative;writing-mode:horizontal-tb;fill:currentColor;color:var(--_icon-color);font-size:var(--_icon-size);width:var(--_icon-size);height:var(--_icon-size)}:host(:hover){color:var(--_hover-label-text-color);cursor:pointer}:host(:hover) ::slotted([slot=icon]){color:var(--_hover-icon-color)}:host(:focus){color:var(--_focus-label-text-color)}:host(:focus) ::slotted([slot=icon]){color:var(--_focus-icon-color)}:host(:active){color:var(--_pressed-label-text-color)}:host(:active) ::slotted([slot=icon]){color:var(--_pressed-icon-color)}:host([active]) .indicator{opacity:1}:host([active]){color:var(--_active-label-text-color);--md-ripple-hover-color: var(--_active-hover-state-layer-color);--md-ripple-hover-opacity: var(--_active-hover-state-layer-opacity);--md-ripple-pressed-color: var(--_active-pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_active-pressed-state-layer-opacity)}:host([active]) ::slotted([slot=icon]){color:var(--_active-icon-color)}:host([active]:hover){color:var(--_active-hover-label-text-color)}:host([active]:hover) ::slotted([slot=icon]){color:var(--_active-hover-icon-color)}:host([active]:focus){color:var(--_active-focus-label-text-color)}:host([active]:focus) ::slotted([slot=icon]){color:var(--_active-focus-icon-color)}:host([active]:active){color:var(--_active-pressed-label-text-color)}:host([active]:active) ::slotted([slot=icon]){color:var(--_active-pressed-icon-color)}:host,::slotted(*){white-space:nowrap}@media(forced-colors: active){.indicator{background:CanvasText}}
`;let b$=class extends _${};b$.styles=[y$,v$],b$=it([ph("md-primary-tab")],b$);class x$ extends $d{static get styles(){return[super.styles,n`
        :host {
          margin: 0;
          margin-top: -4px;
          margin-bottom: -25px;
        }

        #controls {
          position: absolute;
          background: rgba(255, 255, 255, 0.9);
          border-radius: 16px;
          z-index: 1;
          padding: 0 10px;
        }

        #chart {
          height: calc(100vh - 165px);
          margin-left: -40px;
          margin-right: -40px;
          margin-bottom: -25px;
        }

        #controls mwc-icon-button {
          color: rgba(0, 0, 0, 0.35);
          --mdc-icon-size: 26px;
          --mdc-theme-text-disabled-on-light: rgba(0, 0, 0, 0.1);
        }

        #menu-controls mwc-textfield {
          width: 6em;
        }
      `]}static get properties(){return{grampsId:{type:String},disableBack:{type:Boolean},disableHome:{type:Boolean},nAnc:{type:Number},nDesc:{type:Number},nMaxImages:{type:Number},_data:{type:Array},_setAnc:{type:Boolean},_setDesc:{type:Boolean},_setMaxImages:{type:Boolean}}}constructor(){super(),this.grampsId="",this.nAnc=3,this.nDesc=1,this.nMaxImages=50,this.disableBack=!1,this.disableHome=!1,this._data=[],this._setAnc=!1,this._setDesc=!1,this._setSep=!1,this._setMaxImages=!1}renderContent(){return M`<div style="position: relative;">
      <div id="controls">${this.renderControls()}</div>
      <div id="chart">${this.renderChart()}</div>
    </div>`}renderControls(){return M`
        <mwc-icon-button
          @click=${this._backToHomePerson}
          style="margin-bottom:-10px;"
          ?disabled=${this.disableHome}
          id="button-home"
          >${Na("M12,3L2,12H5V20H19V12H22L12,3M12,8.75A2.25,2.25 0 0,1 14.25,11A2.25,2.25 0 0,1 12,13.25A2.25,2.25 0 0,1 9.75,11A2.25,2.25 0 0,1 12,8.75M12,15C13.5,15 16.5,15.75 16.5,17.25V18H7.5V17.25C7.5,15.75 10.5,15 12,15Z",this.disableHome?"var(--mdc-theme-text-disabled-on-light)":"")}</mwc-icon-button>
          <grampsjs-tooltip
            for="button-home"
            .strings="${this.strings}"
            >${this._("Home Person")}</grampsjs-tooltip
          >

        <mwc-icon-button
          icon="arrow_back"
          @click=${this._handleBack}
          ?disabled=${this.disableBack}
          style="margin-bottom:-10px;"
          id="btn-back"
        ></mwc-icon-button>
        <grampsjs-tooltip
          for="btn-back"
          .strings="${this.strings}"
        >${this._("_Back")}</grampsjs-tooltip
        >
        <mwc-icon-button
          @click=${this._goToPerson}
          id="btn-person"
        >${Na("M11 9C11 10.66 9.66 12 8 12C6.34 12 5 10.66 5 9C5 7.34 6.34 6 8 6C9.66 6 11 7.34 11 9M14 20H2V18C2 15.79 4.69 14 8 14C11.31 14 14 15.79 14 18M22 12V14H13V12M22 8V10H13V8M22 4V6H13V4Z")}</mwc-icon-button>
        <grampsjs-tooltip
          for="btn-person"
          .strings="${this.strings}"
        >${this._("Person Details")}</grampsjs-tooltip
        >        <mwc-icon-button
          icon="settings"
          id="btn-controls"
          @click=${this._openMenuControls}
        ></mwc-icon-button>
        <grampsjs-tooltip
          for="btn-controls"
          .strings="${this.strings}"
        >${this._("Preferences")}</grampsjs-tooltip
      >
    <mwc-dialog id="menu-controls">
          <table>
          ${this._setAnc?M` <tr>
                  <td>${this._("Max Ancestor Generations")}</td>
                  <td>
                    <mwc-textfield
                      value=${this.nAnc}
                      type="number"
                      min="1"
                      @change=${this._handleChangeAnc}
                    ></mwc-textfield>
                  </td>
                </tr>`:""}${this._setDesc?M`
            <tr>
              <td>${this._("Max Descendant Generations")}</td>
              <td>
                <mwc-textfield
                  value=${this.nDesc}
                  type="number"
                  min="0"
                  @change=${this._handleChangeDesc}
                ></mwc-textfield>
              </td>
            </tr>
          `:""}${this._setSep?M`
            <tr>
              <td>${this._("Max Degree of Separation")}</td>
              <td>
                <mwc-textfield
                  value=${this.nAnc}
                  type="number"
                  min="0"
                  @change=${this._handleChangeAnc}
                ></mwc-textfield>
              </td>
            </tr>
          `:""}${this._setMaxImages?M`
            <tr>
              <td>${this._("Max Number of Images displayed")}</td>
              <td>
                <mwc-textfield
                  value=${this.nMaxImages}
                  type="number"
                  min="0"
                  size="5"
                  @change=${this._handleChangeMaxImages}
                ></mwc-textfield>
              </td>
            </tr>
          `:""}
          </table>
          <mwc-button slot="primaryAction" dialogAction="close"
            >${this._("done")}</mwc-button
          >
          <mwc-button slot="secondaryAction" @click="${this._resetLevels}"
            >${this._("Reset")}</mwc-button
          >
        </mwc-dialog>
      </div>

    `}renderChart(){return""}_backToHomePerson(){os(this,"tree:home")}_prevPerson(){os(this,"tree:back")}update(t){super.update(t),(t.has("grampsId")||t.has("nAnc")||t.has("nDesc")||t.has("nMaxImages"))&&this._fetchData(this.grampsId)}_resetLevels(){}_getPersonRules(t){return{function:"or",rules:[{name:"IsLessThanNthGenerationAncestorOf",values:[t,this.nAnc+1]},{name:"IsLessThanNthGenerationDescendantOf",values:[t,this.nDesc+1]}]}}async _fetchData(t){this.loading=!0;const e=this._getPersonRules(t),i=await On(`/api/people/?rules=${encodeURIComponent(JSON.stringify(e))}&locale=${this.strings?.__lang__||"en"}&profile=self&extend=event_ref_list,primary_parent_family,family_list`);this.loading=!1,"data"in i?(this.error=!1,this._data=i.data):"error"in i&&(this.error=!0,this._errorMessage=i.error)}_goToPerson(){os(this,"tree:person")}_handleBack(){os(this,"tree:back")}_handleChangeAnc(t){this.nAnc=parseInt(t.target.value,10)}_handleChangeDesc(t){this.nDesc=parseInt(t.target.value,10)}_handleChangeMaxImages(t){this.nMaxImages=parseInt(t.target.value,10)}_openMenuControls(){this.shadowRoot.getElementById("menu-controls").open=!0}}function w$(t){var e=0,i=t.children,r=i&&i.length;if(r)for(;--r>=0;)e+=i[r].value;else e=1;t.value=e}function k$(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=S$)):void 0===e&&(e=T$);for(var i,r,n,a,s,o=new $$(t),l=[o];i=l.pop();)if((n=e(i.data))&&(s=(n=Array.from(n)).length))for(i.children=n,a=s-1;a>=0;--a)l.push(r=n[a]=new $$(n[a])),r.parent=i,r.depth=i.depth+1;return o.eachBefore(E$)}function T$(t){return t.children}function S$(t){return Array.isArray(t)?t[1]:null}function C$(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function E$(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function $$(t){this.data=t,this.depth=this.height=0,this.parent=null}function A$(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function I$(){var t=1,e=1,i=0,r=!1;function n(n){var a=n.height+1;return n.x0=n.y0=i,n.x1=t,n.y1=e/a,n.eachBefore(function(t,e){return function(r){r.children&&function(t,e,i,r,n){for(var a,s=t.children,o=-1,l=s.length,c=t.value&&(r-e)/t.value;++o<l;)(a=s[o]).y0=i,a.y1=n,a.x0=e,a.x1=e+=a.value*c}(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var n=r.x0,a=r.y0,s=r.x1-i,o=r.y1-i;s<n&&(n=s=(n+s)/2),o<a&&(a=o=(a+o)/2),r.x0=n,r.y0=a,r.x1=s,r.y1=o}}(e,a)),r&&n.eachBefore(A$),n}return n.round=function(t){return arguments.length?(r=!!t,n):r},n.size=function(i){return arguments.length?(t=+i[0],e=+i[1],n):[t,e]},n.padding=function(t){return arguments.length?(i=+t,n):i},n}function M$(t,e){return t.parent===e.parent?1:2}function L$(t){var e=t.children;return e?e[0]:t.t}function P$(t){var e=t.children;return e?e[e.length-1]:t.t}function R$(t,e,i){var r=i/(e.i-t.i);e.c-=r,e.s+=i,t.c+=r,e.z+=i,e.m+=i}function z$(t,e,i){return t.a.parent===e.parent?t.a:i}function D$(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function j$(){var t=M$,e=1,i=1,r=null;function n(n){var l=function(t){for(var e,i,r,n,a,s=new D$(t,0),o=[s];e=o.pop();)if(r=e._.children)for(e.children=new Array(a=r.length),n=a-1;n>=0;--n)o.push(i=e.children[n]=new D$(r[n],n)),i.parent=e;return(s.parent=new D$(null,0)).children=[s],s}(n);if(l.eachAfter(a),l.parent.m=-l.z,l.eachBefore(s),r)n.eachBefore(o);else{var c=n,d=n,h=n;n.eachBefore((function(t){t.x<c.x&&(c=t),t.x>d.x&&(d=t),t.depth>h.depth&&(h=t)}));var p=c===d?1:t(c,d)/2,u=p-c.x,m=e/(d.x+p+u),f=i/(h.depth||1);n.eachBefore((function(t){t.x=(t.x+u)*m,t.y=t.depth*f}))}return n}function a(e){var i=e.children,r=e.parent.children,n=e.i?r[e.i-1]:null;if(i){!function(t){for(var e,i=0,r=0,n=t.children,a=n.length;--a>=0;)(e=n[a]).z+=i,e.m+=i,i+=e.s+(r+=e.c)}(e);var a=(i[0].z+i[i.length-1].z)/2;n?(e.z=n.z+t(e._,n._),e.m=e.z-a):e.z=a}else n&&(e.z=n.z+t(e._,n._));e.parent.A=function(e,i,r){if(i){for(var n,a=e,s=e,o=i,l=a.parent.children[0],c=a.m,d=s.m,h=o.m,p=l.m;o=P$(o),a=L$(a),o&&a;)l=L$(l),(s=P$(s)).a=e,(n=o.z+h-a.z-c+t(o._,a._))>0&&(R$(z$(o,e,r),e,n),c+=n,d+=n),h+=o.m,c+=a.m,p+=l.m,d+=s.m;o&&!P$(s)&&(s.t=o,s.m+=h-d),a&&!L$(l)&&(l.t=a,l.m+=c-p,r=e)}return r}(e,n,e.parent.A||r[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function o(t){t.x*=e,t.y=t.depth*i}return n.separation=function(e){return arguments.length?(t=e,n):t},n.size=function(t){return arguments.length?(r=!1,e=+t[0],i=+t[1],n):r?null:[e,i]},n.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],i=+t[1],n):r?[e,i]:null},n}function O$(t){return function(){return t}}$$.prototype=k$.prototype={constructor:$$,count:function(){return this.eachAfter(w$)},each:function(t,e){let i=-1;for(const r of this)t.call(e,r,++i,this);return this},eachAfter:function(t,e){for(var i,r,n,a=this,s=[a],o=[],l=-1;a=s.pop();)if(o.push(a),i=a.children)for(r=0,n=i.length;r<n;++r)s.push(i[r]);for(;a=o.pop();)t.call(e,a,++l,this);return this},eachBefore:function(t,e){for(var i,r,n=this,a=[n],s=-1;n=a.pop();)if(t.call(e,n,++s,this),i=n.children)for(r=i.length-1;r>=0;--r)a.push(i[r]);return this},find:function(t,e){let i=-1;for(const r of this)if(t.call(e,r,++i,this))return r},sum:function(t){return this.eachAfter((function(e){for(var i=+t(e.data)||0,r=e.children,n=r&&r.length;--n>=0;)i+=r[n].value;e.value=i}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,i=function(t,e){if(t===e)return t;var i=t.ancestors(),r=e.ancestors(),n=null;t=i.pop(),e=r.pop();for(;t===e;)n=t,t=i.pop(),e=r.pop();return n}(e,t),r=[e];e!==i;)e=e.parent,r.push(e);for(var n=r.length;t!==i;)r.splice(n,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(i){i!==t&&e.push({source:i.parent,target:i})})),e},copy:function(){return k$(this).eachBefore(C$)},[Symbol.iterator]:function*(){var t,e,i,r,n=this,a=[n];do{for(t=a.reverse(),a=[];n=t.pop();)if(yield n,e=n.children)for(i=0,r=e.length;i<r;++i)a.push(e[i])}while(a.length)}},D$.prototype=Object.create($$.prototype);const B$=Math.abs,F$=Math.atan2,N$=Math.cos,H$=Math.max,V$=Math.min,U$=Math.sin,Y$=Math.sqrt,Z$=1e-12,q$=Math.PI,W$=q$/2,G$=2*q$;function X$(t){return t>=1?W$:t<=-1?-W$:Math.asin(t)}const K$=Math.PI,J$=2*K$,Q$=1e-6,tA=J$-Q$;function eA(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e)this._+=arguments[e]+t[e]}class iA{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?eA:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return eA;const i=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*i)/i+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,i,r){this._append`Q${+t},${+e},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(t,e,i,r,n,a){this._append`C${+t},${+e},${+i},${+r},${this._x1=+n},${this._y1=+a}`}arcTo(t,e,i,r,n){if(t=+t,e=+e,i=+i,r=+r,(n=+n)<0)throw new Error(`negative radius: ${n}`);let a=this._x1,s=this._y1,o=i-t,l=r-e,c=a-t,d=s-e,h=c*c+d*d;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(h>Q$)if(Math.abs(d*o-l*c)>Q$&&n){let p=i-a,u=r-s,m=o*o+l*l,f=p*p+u*u,g=Math.sqrt(m),_=Math.sqrt(h),v=n*Math.tan((K$-Math.acos((m+h-f)/(2*g*_)))/2),y=v/_,b=v/g;Math.abs(y-1)>Q$&&this._append`L${t+y*c},${e+y*d}`,this._append`A${n},${n},0,0,${+(d*p>c*u)},${this._x1=t+b*o},${this._y1=e+b*l}`}else this._append`L${this._x1=t},${this._y1=e}`;else;}arc(t,e,i,r,n,a){if(t=+t,e=+e,a=!!a,(i=+i)<0)throw new Error(`negative radius: ${i}`);let s=i*Math.cos(r),o=i*Math.sin(r),l=t+s,c=e+o,d=1^a,h=a?r-n:n-r;null===this._x1?this._append`M${l},${c}`:(Math.abs(this._x1-l)>Q$||Math.abs(this._y1-c)>Q$)&&this._append`L${l},${c}`,i&&(h<0&&(h=h%J$+J$),h>tA?this._append`A${i},${i},0,1,${d},${t-s},${e-o}A${i},${i},0,1,${d},${this._x1=l},${this._y1=c}`:h>Q$&&this._append`A${i},${i},0,${+(h>=K$)},${d},${this._x1=t+i*Math.cos(n)},${this._y1=e+i*Math.sin(n)}`)}rect(t,e,i,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}}function rA(t){let e=3;return t.digits=function(i){if(!arguments.length)return e;if(null==i)e=null;else{const t=Math.floor(i);if(!(t>=0))throw new RangeError(`invalid digits: ${i}`);e=t}return t},()=>new iA(e)}function nA(t){return t.innerRadius}function aA(t){return t.outerRadius}function sA(t){return t.startAngle}function oA(t){return t.endAngle}function lA(t){return t&&t.padAngle}function cA(t,e,i,r,n,a,s){var o=t-i,l=e-r,c=(s?a:-a)/Y$(o*o+l*l),d=c*l,h=-c*o,p=t+d,u=e+h,m=i+d,f=r+h,g=(p+m)/2,_=(u+f)/2,v=m-p,y=f-u,b=v*v+y*y,x=n-a,w=p*f-m*u,k=(y<0?-1:1)*Y$(H$(0,x*x*b-w*w)),T=(w*y-v*k)/b,S=(-w*v-y*k)/b,C=(w*y+v*k)/b,E=(-w*v+y*k)/b,$=T-g,A=S-_,I=C-g,M=E-_;return $*$+A*A>I*I+M*M&&(T=C,S=E),{cx:T,cy:S,x01:-d,y01:-h,x11:T*(n/x-1),y11:S*(n/x-1)}}function dA(){var t=nA,e=aA,i=O$(0),r=null,n=sA,a=oA,s=lA,o=null,l=rA(c);function c(){var c,d,h=+t.apply(this,arguments),p=+e.apply(this,arguments),u=n.apply(this,arguments)-W$,m=a.apply(this,arguments)-W$,f=B$(m-u),g=m>u;if(o||(o=c=l()),p<h&&(d=p,p=h,h=d),p>Z$)if(f>G$-Z$)o.moveTo(p*N$(u),p*U$(u)),o.arc(0,0,p,u,m,!g),h>Z$&&(o.moveTo(h*N$(m),h*U$(m)),o.arc(0,0,h,m,u,g));else{var _,v,y=u,b=m,x=u,w=m,k=f,T=f,S=s.apply(this,arguments)/2,C=S>Z$&&(r?+r.apply(this,arguments):Y$(h*h+p*p)),E=V$(B$(p-h)/2,+i.apply(this,arguments)),$=E,A=E;if(C>Z$){var I=X$(C/h*U$(S)),M=X$(C/p*U$(S));(k-=2*I)>Z$?(x+=I*=g?1:-1,w-=I):(k=0,x=w=(u+m)/2),(T-=2*M)>Z$?(y+=M*=g?1:-1,b-=M):(T=0,y=b=(u+m)/2)}var L=p*N$(y),P=p*U$(y),R=h*N$(w),z=h*U$(w);if(E>Z$){var D,j=p*N$(b),O=p*U$(b),B=h*N$(x),F=h*U$(x);if(f<q$)if(D=function(t,e,i,r,n,a,s,o){var l=i-t,c=r-e,d=s-n,h=o-a,p=h*l-d*c;if(!(p*p<Z$))return[t+(p=(d*(e-a)-h*(t-n))/p)*l,e+p*c]}(L,P,B,F,j,O,R,z)){var N=L-D[0],H=P-D[1],V=j-D[0],U=O-D[1],Y=1/U$(function(t){return t>1?0:t<-1?q$:Math.acos(t)}((N*V+H*U)/(Y$(N*N+H*H)*Y$(V*V+U*U)))/2),Z=Y$(D[0]*D[0]+D[1]*D[1]);$=V$(E,(h-Z)/(Y-1)),A=V$(E,(p-Z)/(Y+1))}else $=A=0}T>Z$?A>Z$?(_=cA(B,F,L,P,p,A,g),v=cA(j,O,R,z,p,A,g),o.moveTo(_.cx+_.x01,_.cy+_.y01),A<E?o.arc(_.cx,_.cy,A,F$(_.y01,_.x01),F$(v.y01,v.x01),!g):(o.arc(_.cx,_.cy,A,F$(_.y01,_.x01),F$(_.y11,_.x11),!g),o.arc(0,0,p,F$(_.cy+_.y11,_.cx+_.x11),F$(v.cy+v.y11,v.cx+v.x11),!g),o.arc(v.cx,v.cy,A,F$(v.y11,v.x11),F$(v.y01,v.x01),!g))):(o.moveTo(L,P),o.arc(0,0,p,y,b,!g)):o.moveTo(L,P),h>Z$&&k>Z$?$>Z$?(_=cA(R,z,j,O,h,-$,g),v=cA(L,P,B,F,h,-$,g),o.lineTo(_.cx+_.x01,_.cy+_.y01),$<E?o.arc(_.cx,_.cy,$,F$(_.y01,_.x01),F$(v.y01,v.x01),!g):(o.arc(_.cx,_.cy,$,F$(_.y01,_.x01),F$(_.y11,_.x11),!g),o.arc(0,0,h,F$(_.cy+_.y11,_.cx+_.x11),F$(v.cy+v.y11,v.cx+v.x11),g),o.arc(v.cx,v.cy,$,F$(v.y11,v.x11),F$(v.y01,v.x01),!g))):o.arc(0,0,h,w,x,g):o.lineTo(R,z)}else o.moveTo(0,0);if(o.closePath(),c)return o=null,c+""||null}return c.centroid=function(){var i=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+n.apply(this,arguments)+ +a.apply(this,arguments))/2-q$/2;return[N$(r)*i,U$(r)*i]},c.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:O$(+e),c):t},c.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:O$(+t),c):e},c.cornerRadius=function(t){return arguments.length?(i="function"==typeof t?t:O$(+t),c):i},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:O$(+t),c):r},c.startAngle=function(t){return arguments.length?(n="function"==typeof t?t:O$(+t),c):n},c.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:O$(+t),c):a},c.padAngle=function(t){return arguments.length?(s="function"==typeof t?t:O$(+t),c):s},c.context=function(t){return arguments.length?(o=null==t?null:t,c):o},c}var hA=Array.prototype.slice;function pA(t){return t[0]}function uA(t){return t[1]}class mA{constructor(t,e){this._context=t,this._x=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,e,t,e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+e)/2,t,this._y0,t,e)}this._x0=t,this._y0=e}}function fA(t){return new mA(t,!0)}function gA(t){return t.source}function _A(t){return t.target}var vA={draw(t,e){const i=Y$(e/q$);t.moveTo(i,0),t.arc(0,0,i,0,G$)}};const yA=Y$(3);var bA={draw(t,e){const i=-Y$(e/(3*yA));t.moveTo(0,2*i),t.lineTo(-yA*i,-i),t.lineTo(yA*i,-i),t.closePath()}};var xA={value:()=>{}};function wA(){for(var t,e=0,i=arguments.length,r={};e<i;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new kA(r)}function kA(t){this._=t}function TA(t,e){for(var i,r=0,n=t.length;r<n;++r)if((i=t[r]).name===e)return i.value}function SA(t,e,i){for(var r=0,n=t.length;r<n;++r)if(t[r].name===e){t[r]=xA,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=i&&t.push({name:e,value:i}),t}kA.prototype=wA.prototype={constructor:kA,on:function(t,e){var i,r,n=this._,a=(r=n,(t+"").trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");if(i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),s=-1,o=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=a[s]).type)n[i]=SA(n[i],t.name,e);else if(null==e)for(i in n)n[i]=SA(n[i],t.name,null);return this}for(;++s<o;)if((i=(t=a[s]).type)&&(i=TA(n[i],t.name)))return i},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new kA(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var i,r,n=new Array(i),a=0;a<i;++a)n[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,i=(r=this._[t]).length;a<i;++a)r[a].value.apply(e,n)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],n=0,a=r.length;n<a;++n)r[n].value.apply(e,i)}};var CA="http://www.w3.org/1999/xhtml",EA={svg:"http://www.w3.org/2000/svg",xhtml:CA,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $A(t){var e=t+="",i=e.indexOf(":");return i>=0&&"xmlns"!==(e=t.slice(0,i))&&(t=t.slice(i+1)),EA.hasOwnProperty(e)?{space:EA[e],local:t}:t}function AA(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===CA&&e.documentElement.namespaceURI===CA?e.createElement(t):e.createElementNS(i,t)}}function IA(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function MA(t){var e=$A(t);return(e.local?IA:AA)(e)}function LA(){}function PA(t){return null==t?LA:function(){return this.querySelector(t)}}function RA(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function zA(){return[]}function DA(t){return function(e){return e.matches(t)}}var jA=Array.prototype.find;function OA(){return this.firstElementChild}var BA=Array.prototype.filter;function FA(){return this.children}function NA(t){return new Array(t.length)}function HA(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function VA(t,e,i,r,n,a){for(var s,o=0,l=e.length,c=a.length;o<c;++o)(s=e[o])?(s.__data__=a[o],r[o]=s):i[o]=new HA(t,a[o]);for(;o<l;++o)(s=e[o])&&(n[o]=s)}function UA(t,e,i,r,n,a,s){var o,l,c,d=new Map,h=e.length,p=a.length,u=new Array(h);for(o=0;o<h;++o)(l=e[o])&&(u[o]=c=s.call(l,l.__data__,o,e)+"",d.has(c)?n[o]=l:d.set(c,l));for(o=0;o<p;++o)c=s.call(t,a[o],o,a)+"",(l=d.get(c))?(r[o]=l,l.__data__=a[o],d.delete(c)):i[o]=new HA(t,a[o]);for(o=0;o<h;++o)(l=e[o])&&d.get(u[o])===l&&(n[o]=l)}function YA(t){return t.__data__}function ZA(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function qA(t){return function(){this.removeAttribute(t)}}function WA(t){return function(){this.removeAttributeNS(t.space,t.local)}}function GA(t,e){return function(){this.setAttribute(t,e)}}function XA(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function KA(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}}function JA(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function QA(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function tI(t){return function(){this.style.removeProperty(t)}}function eI(t,e,i){return function(){this.style.setProperty(t,e,i)}}function iI(t,e,i){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,i)}}function rI(t){return function(){delete this[t]}}function nI(t,e){return function(){this[t]=e}}function aI(t,e){return function(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}}function sI(t){return t.trim().split(/^|\s+/)}function oI(t){return t.classList||new lI(t)}function lI(t){this._node=t,this._names=sI(t.getAttribute("class")||"")}function cI(t,e){for(var i=oI(t),r=-1,n=e.length;++r<n;)i.add(e[r])}function dI(t,e){for(var i=oI(t),r=-1,n=e.length;++r<n;)i.remove(e[r])}function hI(t){return function(){cI(this,t)}}function pI(t){return function(){dI(this,t)}}function uI(t,e){return function(){(e.apply(this,arguments)?cI:dI)(this,t)}}function mI(){this.textContent=""}function fI(t){return function(){this.textContent=t}}function gI(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function _I(){this.innerHTML=""}function vI(t){return function(){this.innerHTML=t}}function yI(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function bI(){this.nextSibling&&this.parentNode.appendChild(this)}function xI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wI(){return null}function kI(){var t=this.parentNode;t&&t.removeChild(this)}function TI(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function SI(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function CI(t){return function(){var e=this.__on;if(e){for(var i,r=0,n=-1,a=e.length;r<a;++r)i=e[r],t.type&&i.type!==t.type||i.name!==t.name?e[++n]=i:this.removeEventListener(i.type,i.listener,i.options);++n?e.length=n:delete this.__on}}}function EI(t,e,i){return function(){var r,n=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(n)for(var s=0,o=n.length;s<o;++s)if((r=n[s]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=i),void(r.value=e);this.addEventListener(t.type,a,i),r={type:t.type,name:t.name,value:e,listener:a,options:i},n?n.push(r):this.__on=[r]}}function $I(t,e,i){var r=QA(t),n=r.CustomEvent;"function"==typeof n?n=new n(e,i):(n=r.document.createEvent("Event"),i?(n.initEvent(e,i.bubbles,i.cancelable),n.detail=i.detail):n.initEvent(e,!1,!1)),t.dispatchEvent(n)}function AI(t,e){return function(){return $I(this,t,e)}}function II(t,e){return function(){return $I(this,t,e.apply(this,arguments))}}HA.prototype={constructor:HA,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},lI.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var MI=[null];function LI(t,e){this._groups=t,this._parents=e}function PI(t){return"string"==typeof t?new LI([[document.querySelector(t)]],[document.documentElement]):new LI([[t]],MI)}function RI(t){t.preventDefault(),t.stopImmediatePropagation()}LI.prototype={constructor:LI,select:function(t){"function"!=typeof t&&(t=PA(t));for(var e=this._groups,i=e.length,r=new Array(i),n=0;n<i;++n)for(var a,s,o=e[n],l=o.length,c=r[n]=new Array(l),d=0;d<l;++d)(a=o[d])&&(s=t.call(a,a.__data__,d,o))&&("__data__"in a&&(s.__data__=a.__data__),c[d]=s);return new LI(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);return null==e?[]:RA(e)}}(t):function(t){return null==t?zA:function(){return this.querySelectorAll(t)}}(t);for(var e=this._groups,i=e.length,r=[],n=[],a=0;a<i;++a)for(var s,o=e[a],l=o.length,c=0;c<l;++c)(s=o[c])&&(r.push(t.call(s,s.__data__,c,o)),n.push(s));return new LI(r,n)},selectChild:function(t){return this.select(null==t?OA:function(t){return function(){return jA.call(this.children,t)}}("function"==typeof t?t:DA(t)))},selectChildren:function(t){return this.selectAll(null==t?FA:function(t){return function(){return BA.call(this.children,t)}}("function"==typeof t?t:DA(t)))},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var e=this._groups,i=e.length,r=new Array(i),n=0;n<i;++n)for(var a,s=e[n],o=s.length,l=r[n]=[],c=0;c<o;++c)(a=s[c])&&t.call(a,a.__data__,c,s)&&l.push(a);return new LI(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,YA);var i=e?UA:VA,r=this._parents,n=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var a=n.length,s=new Array(a),o=new Array(a),l=new Array(a),c=0;c<a;++c){var d=r[c],h=n[c],p=h.length,u=RA(t.call(d,d&&d.__data__,c,r)),m=u.length,f=o[c]=new Array(m),g=s[c]=new Array(m);i(d,h,f,g,l[c]=new Array(p),u,e);for(var _,v,y=0,b=0;y<m;++y)if(_=f[y]){for(y>=b&&(b=y+1);!(v=g[b])&&++b<m;);_._next=v||null}}return(s=new LI(s,r))._enter=o,s._exit=l,s},enter:function(){return new LI(this._enter||this._groups.map(NA),this._parents)},exit:function(){return new LI(this._exit||this._groups.map(NA),this._parents)},join:function(t,e,i){var r=this.enter(),n=this,a=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(n=e(n)),null==i?a.remove():i(a),r&&n?r.merge(n).order():n},merge:function(t){if(!(t instanceof LI))throw new Error("invalid merge");for(var e=this._groups,i=t._groups,r=e.length,n=i.length,a=Math.min(r,n),s=new Array(r),o=0;o<a;++o)for(var l,c=e[o],d=i[o],h=c.length,p=s[o]=new Array(h),u=0;u<h;++u)(l=c[u]||d[u])&&(p[u]=l);for(;o<r;++o)s[o]=e[o];return new LI(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var r,n=t[e],a=n.length-1,s=n[a];--a>=0;)(r=n[a])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,i){return e&&i?t(e.__data__,i.__data__):!e-!i}t||(t=ZA);for(var i=this._groups,r=i.length,n=new Array(r),a=0;a<r;++a){for(var s,o=i[a],l=o.length,c=n[a]=new Array(l),d=0;d<l;++d)(s=o[d])&&(c[d]=s);c.sort(e)}return new LI(n,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var r=t[e],n=0,a=r.length;n<a;++n){var s=r[n];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,i=0,r=e.length;i<r;++i)for(var n,a=e[i],s=0,o=a.length;s<o;++s)(n=a[s])&&t.call(n,n.__data__,s,a);return this},attr:function(t,e){var i=$A(t);if(arguments.length<2){var r=this.node();return i.local?r.getAttributeNS(i.space,i.local):r.getAttribute(i)}return this.each((null==e?i.local?WA:qA:"function"==typeof e?i.local?JA:KA:i.local?XA:GA)(i,e))},style:function(t,e,i){return arguments.length>1?this.each((null==e?tI:"function"==typeof e?iI:eI)(t,e,null==i?"":i)):function(t,e){return t.style.getPropertyValue(e)||QA(t).getComputedStyle(t,null).getPropertyValue(e)}(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?rI:"function"==typeof e?aI:nI)(t,e)):this.node()[t]},classed:function(t,e){var i=sI(t+"");if(arguments.length<2){for(var r=oI(this.node()),n=-1,a=i.length;++n<a;)if(!r.contains(i[n]))return!1;return!0}return this.each(("function"==typeof e?uI:e?hI:pI)(i,e))},text:function(t){return arguments.length?this.each(null==t?mI:("function"==typeof t?gI:fI)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?_I:("function"==typeof t?yI:vI)(t)):this.node().innerHTML},raise:function(){return this.each(bI)},lower:function(){return this.each(xI)},append:function(t){var e="function"==typeof t?t:MA(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var i="function"==typeof t?t:MA(t),r=null==e?wI:"function"==typeof e?e:PA(e);return this.select((function(){return this.insertBefore(i.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(kI)},clone:function(t){return this.select(t?SI:TI)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,i){var r,n,a=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}}))}(t+""),s=a.length;if(!(arguments.length<2)){for(o=e?EI:CI,r=0;r<s;++r)this.each(o(a[r],e,i));return this}var o=this.node().__on;if(o)for(var l,c=0,d=o.length;c<d;++c)for(r=0,l=o[c];r<s;++r)if((n=a[r]).type===l.type&&n.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?II:AI)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var r,n=t[e],a=0,s=n.length;a<s;++a)(r=n[a])&&(yield r)}};var zI,DI,jI=0,OI=0,BI=0,FI=1e3,NI=0,HI=0,VI=0,UI="object"==typeof performance&&performance.now?performance:Date,YI="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ZI(){return HI||(YI(qI),HI=UI.now()+VI)}function qI(){HI=0}function WI(){this._call=this._time=this._next=null}function GI(t,e,i){var r=new WI;return r.restart(t,e,i),r}function XI(){HI=(NI=UI.now())+VI,jI=OI=0;try{!function(){ZI(),++jI;for(var t,e=zI;e;)(t=HI-e._time)>=0&&e._call.call(null,t),e=e._next;--jI}()}finally{jI=0,function(){var t,e,i=zI,r=1/0;for(;i;)i._call?(r>i._time&&(r=i._time),t=i,i=i._next):(e=i._next,i._next=null,i=t?t._next=e:zI=e);DI=t,JI(r)}(),HI=0}}function KI(){var t=UI.now(),e=t-NI;e>FI&&(VI-=e,NI=t)}function JI(t){jI||(OI&&(OI=clearTimeout(OI)),t-HI>24?(t<1/0&&(OI=setTimeout(XI,t-UI.now()-VI)),BI&&(BI=clearInterval(BI))):(BI||(NI=UI.now(),BI=setInterval(KI,FI)),jI=1,YI(XI)))}function QI(t,e,i){var r=new WI;return e=null==e?0:+e,r.restart((i=>{r.stop(),t(i+e)}),e,i),r}WI.prototype=GI.prototype={constructor:WI,restart:function(t,e,i){if("function"!=typeof t)throw new TypeError("callback is not a function");i=(null==i?ZI():+i)+(null==e?0:+e),this._next||DI===this||(DI?DI._next=this:zI=this,DI=this),this._call=t,this._time=i,JI()},stop:function(){this._call&&(this._call=null,this._time=1/0,JI())}};var tM=wA("start","end","cancel","interrupt"),eM=[],iM=0,rM=1,nM=2,aM=3,sM=4,oM=5,lM=6;function cM(t,e,i,r,n,a){var s=t.__transition;if(s){if(i in s)return}else t.__transition={};!function(t,e,i){var r,n=t.__transition;function a(t){i.state=rM,i.timer.restart(s,i.delay,i.time),i.delay<=t&&s(t-i.delay)}function s(a){var c,d,h,p;if(i.state!==rM)return l();for(c in n)if((p=n[c]).name===i.name){if(p.state===aM)return QI(s);p.state===sM?(p.state=lM,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete n[c]):+c<e&&(p.state=lM,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete n[c])}if(QI((function(){i.state===aM&&(i.state=sM,i.timer.restart(o,i.delay,i.time),o(a))})),i.state=nM,i.on.call("start",t,t.__data__,i.index,i.group),i.state===nM){for(i.state=aM,r=new Array(h=i.tween.length),c=0,d=-1;c<h;++c)(p=i.tween[c].value.call(t,t.__data__,i.index,i.group))&&(r[++d]=p);r.length=d+1}}function o(e){for(var n=e<i.duration?i.ease.call(null,e/i.duration):(i.timer.restart(l),i.state=oM,1),a=-1,s=r.length;++a<s;)r[a].call(t,n);i.state===oM&&(i.on.call("end",t,t.__data__,i.index,i.group),l())}function l(){for(var r in i.state=lM,i.timer.stop(),delete n[e],n)return;delete t.__transition}n[e]=i,i.timer=GI(a,0,i.time)}(t,i,{name:e,index:r,group:n,on:tM,tween:eM,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:iM})}function dM(t,e){var i=pM(t,e);if(i.state>iM)throw new Error("too late; already scheduled");return i}function hM(t,e){var i=pM(t,e);if(i.state>aM)throw new Error("too late; already running");return i}function pM(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}function uM(t,e){var i,r,n,a=t.__transition,s=!0;if(a){for(n in e=null==e?null:e+"",a)(i=a[n]).name===e?(r=i.state>nM&&i.state<oM,i.state=lM,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete a[n]):s=!1;s&&delete t.__transition}}function mM(t,e){var i,r;return function(){var n=hM(this,t),a=n.tween;if(a!==i)for(var s=0,o=(r=i=a).length;s<o;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}n.tween=r}}function fM(t,e,i){var r,n;if("function"!=typeof i)throw new Error;return function(){var a=hM(this,t),s=a.tween;if(s!==r){n=(r=s).slice();for(var o={name:e,value:i},l=0,c=n.length;l<c;++l)if(n[l].name===e){n[l]=o;break}l===c&&n.push(o)}a.tween=n}}function gM(t,e,i){var r=t._id;return t.each((function(){var t=hM(this,r);(t.value||(t.value={}))[e]=i.apply(this,arguments)})),function(t){return pM(t,r).value[e]}}function _M(t,e){var i;return("number"==typeof e?jb:e instanceof Jy?Mb:(i=Jy(e))?(e=i,Mb):Nb)(t,e)}function vM(t){return function(){this.removeAttribute(t)}}function yM(t){return function(){this.removeAttributeNS(t.space,t.local)}}function bM(t,e,i){var r,n,a=i+"";return function(){var s=this.getAttribute(t);return s===a?null:s===r?n:n=e(r=s,i)}}function xM(t,e,i){var r,n,a=i+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===a?null:s===r?n:n=e(r=s,i)}}function wM(t,e,i){var r,n,a;return function(){var s,o,l=i(this);if(null!=l)return(s=this.getAttribute(t))===(o=l+"")?null:s===r&&o===n?a:(n=o,a=e(r=s,l));this.removeAttribute(t)}}function kM(t,e,i){var r,n,a;return function(){var s,o,l=i(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(o=l+"")?null:s===r&&o===n?a:(n=o,a=e(r=s,l));this.removeAttributeNS(t.space,t.local)}}function TM(t,e){var i,r;function n(){var n=e.apply(this,arguments);return n!==r&&(i=(r=n)&&function(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}(t,n)),i}return n._value=e,n}function SM(t,e){var i,r;function n(){var n=e.apply(this,arguments);return n!==r&&(i=(r=n)&&function(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}(t,n)),i}return n._value=e,n}function CM(t,e){return function(){dM(this,t).delay=+e.apply(this,arguments)}}function EM(t,e){return e=+e,function(){dM(this,t).delay=e}}function $M(t,e){return function(){hM(this,t).duration=+e.apply(this,arguments)}}function AM(t,e){return e=+e,function(){hM(this,t).duration=e}}var IM=mw.prototype.constructor;function MM(t){return function(){this.style.removeProperty(t)}}var LM=0;function PM(t,e,i,r){this._groups=t,this._parents=e,this._name=i,this._id=r}function RM(){return++LM}var zM=mw.prototype;PM.prototype={constructor:PM,select:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=dx(t));for(var r=this._groups,n=r.length,a=new Array(n),s=0;s<n;++s)for(var o,l,c=r[s],d=c.length,h=a[s]=new Array(d),p=0;p<d;++p)(o=c[p])&&(l=t.call(o,o.__data__,p,c))&&("__data__"in o&&(l.__data__=o.__data__),h[p]=l,cM(h[p],e,i,p,h,pM(o,i)));return new PM(a,this._parents,e,i)},selectAll:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=px(t));for(var r=this._groups,n=r.length,a=[],s=[],o=0;o<n;++o)for(var l,c=r[o],d=c.length,h=0;h<d;++h)if(l=c[h]){for(var p,u=t.call(l,l.__data__,h,c),m=pM(l,i),f=0,g=u.length;f<g;++f)(p=u[f])&&cM(p,e,i,f,u,m);a.push(u),s.push(l)}return new PM(a,s,e,i)},selectChild:zM.selectChild,selectChildren:zM.selectChildren,filter:function(t){"function"!=typeof t&&(t=mx(t));for(var e=this._groups,i=e.length,r=new Array(i),n=0;n<i;++n)for(var a,s=e[n],o=s.length,l=r[n]=[],c=0;c<o;++c)(a=s[c])&&t.call(a,a.__data__,c,s)&&l.push(a);return new PM(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,r=e.length,n=i.length,a=Math.min(r,n),s=new Array(r),o=0;o<a;++o)for(var l,c=e[o],d=i[o],h=c.length,p=s[o]=new Array(h),u=0;u<h;++u)(l=c[u]||d[u])&&(p[u]=l);for(;o<r;++o)s[o]=e[o];return new PM(s,this._parents,this._name,this._id)},selection:function(){return new IM(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,i=RM(),r=this._groups,n=r.length,a=0;a<n;++a)for(var s,o=r[a],l=o.length,c=0;c<l;++c)if(s=o[c]){var d=pM(s,e);cM(s,t,i,c,o,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new PM(r,this._parents,t,i)},call:zM.call,nodes:zM.nodes,node:zM.node,size:zM.size,empty:zM.empty,each:zM.each,on:function(t,e){var i=this._id;return arguments.length<2?pM(this.node(),i).on.on(t):this.each(function(t,e,i){var r,n,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?dM:hM;return function(){var s=a(this,t),o=s.on;o!==r&&(n=(r=o).copy()).on(e,i),s.on=n}}(i,t,e))},attr:function(t,e){var i=ax(t),r="transform"===i?Xb:_M;return this.attrTween(t,"function"==typeof e?(i.local?kM:wM)(i,r,gM(this,"attr."+t,e)):null==e?(i.local?yM:vM)(i):(i.local?xM:bM)(i,r,e))},attrTween:function(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;var r=ax(t);return this.tween(i,(r.local?TM:SM)(r,e))},style:function(t,e,i){var r="transform"==(t+="")?Gb:_M;return null==e?this.styleTween(t,function(t,e){var i,r,n;return function(){var a=jx(this,t),s=(this.style.removeProperty(t),jx(this,t));return a===s?null:a===i&&s===r?n:n=e(i=a,r=s)}}(t,r)).on("end.style."+t,MM(t)):"function"==typeof e?this.styleTween(t,function(t,e,i){var r,n,a;return function(){var s=jx(this,t),o=i(this),l=o+"";return null==o&&(this.style.removeProperty(t),l=o=jx(this,t)),s===l?null:s===r&&l===n?a:(n=l,a=e(r=s,o))}}(t,r,gM(this,"style."+t,e))).each(function(t,e){var i,r,n,a,s="style."+e,o="end."+s;return function(){var l=hM(this,t),c=l.on,d=null==l.value[s]?a||(a=MM(e)):void 0;c===i&&n===d||(r=(i=c).copy()).on(o,n=d),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,i){var r,n,a=i+"";return function(){var s=jx(this,t);return s===a?null:s===r?n:n=e(r=s,i)}}(t,r,e),i).on("end.style."+t,null)},styleTween:function(t,e,i){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,i){var r,n;function a(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&function(t,e,i){return function(r){this.style.setProperty(t,e.call(this,r),i)}}(t,a,i)),r}return a._value=e,a}(t,e,null==i?"":i))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(gM(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,i;function r(){var r=t.apply(this,arguments);return r!==i&&(e=(i=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var i=this._id;if(t+="",arguments.length<2){for(var r,n=pM(this.node(),i).tween,a=0,s=n.length;a<s;++a)if((r=n[a]).name===t)return r.value;return null}return this.each((null==e?mM:fM)(i,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?CM:EM)(e,t)):pM(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?$M:AM)(e,t)):pM(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){hM(this,t).ease=e}}(e,t)):pM(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var i=e.apply(this,arguments);if("function"!=typeof i)throw new Error;hM(this,t).ease=i}}(this._id,t))},end:function(){var t,e,i=this,r=i._id,n=i.size();return new Promise((function(a,s){var o={value:s},l={value:function(){0==--n&&a()}};i.each((function(){var i=hM(this,r),n=i.on;n!==t&&((e=(t=n).copy())._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),i.on=e})),0===n&&a()}))},[Symbol.iterator]:zM[Symbol.iterator]};var DM={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function jM(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}mw.prototype.interrupt=function(t){return this.each((function(){uM(this,t)}))},mw.prototype.transition=function(t){var e,i;t instanceof PM?(e=t._id,t=t._name):(e=RM(),(i=DM).time=ZI(),t=null==t?null:t+"");for(var r=this._groups,n=r.length,a=0;a<n;++a)for(var s,o=r[a],l=o.length,c=0;c<l;++c)(s=o[c])&&cM(s,t,e,c,o,i||jM(s,e));return new PM(r,this._parents,t,e)};var OM=t=>()=>t;function BM(t,{sourceEvent:e,target:i,transform:r,dispatch:n}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:n}})}function FM(t,e,i){this.k=t,this.x=e,this.y=i}FM.prototype={constructor:FM,scale:function(t){return 1===t?this:new FM(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new FM(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var NM=new FM(1,0,0);function HM(t){t.stopImmediatePropagation()}function VM(t){t.preventDefault(),t.stopImmediatePropagation()}function UM(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function YM(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function ZM(){return this.__zoom||NM}function qM(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function WM(){return navigator.maxTouchPoints||"ontouchstart"in this}function GM(t,e,i){var r=t.invertX(e[0][0])-i[0][0],n=t.invertX(e[1][0])-i[1][0],a=t.invertY(e[0][1])-i[0][1],s=t.invertY(e[1][1])-i[1][1];return t.translate(n>r?(r+n)/2:Math.min(0,r)||Math.max(0,n),s>a?(a+s)/2:Math.min(0,a)||Math.max(0,s))}function XM(){var t,e,i,r=UM,n=YM,a=GM,s=qM,o=WM,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],d=250,h=Jb,p=wA("start","zoom","end"),u=500,m=150,f=0,g=10;function _(t){t.property("__zoom",ZM).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",C).filter(o).on("touchstart.zoom",E).on("touchmove.zoom",$).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new FM(e,t.x,t.y)}function y(t,e,i){var r=e[0]-i[0]*t.k,n=e[1]-i[1]*t.k;return r===t.x&&n===t.y?t:new FM(t.k,r,n)}function b(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function x(t,e,i,r){t.on("start.zoom",(function(){w(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){w(this,arguments).event(r).end()})).tween("zoom",(function(){var t=this,a=arguments,s=w(t,a).event(r),o=n.apply(t,a),l=null==i?b(o):"function"==typeof i?i.apply(t,a):i,c=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),d=t.__zoom,p="function"==typeof e?e.apply(t,a):e,u=h(d.invert(l).concat(c/d.k),p.invert(l).concat(c/p.k));return function(t){if(1===t)t=p;else{var e=u(t),i=c/e[2];t=new FM(i,l[0]-e[0]*i,l[1]-e[1]*i)}s.zoom(null,t)}}))}function w(t,e,i){return!i&&t.__zooming||new k(t,e)}function k(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=n.apply(t,e),this.taps=0}function T(t,...e){if(r.apply(this,arguments)){var i=w(this,e).event(t),n=this.__zoom,o=Math.max(l[0],Math.min(l[1],n.k*Math.pow(2,s.apply(this,arguments)))),d=_w(t);if(i.wheel)i.mouse[0][0]===d[0]&&i.mouse[0][1]===d[1]||(i.mouse[1]=n.invert(i.mouse[0]=d)),clearTimeout(i.wheel);else{if(n.k===o)return;i.mouse=[d,n.invert(d)],uM(this),i.start()}VM(t),i.wheel=setTimeout((function(){i.wheel=null,i.end()}),m),i.zoom("mouse",a(y(v(n,o),i.mouse[0],i.mouse[1]),i.extent,c))}}function S(t,...e){if(!i&&r.apply(this,arguments)){var n=t.currentTarget,s=w(this,e,!0).event(t),o=fw(t.view).on("mousemove.zoom",(function(t){if(VM(t),!s.moved){var e=t.clientX-d,i=t.clientY-h;s.moved=e*e+i*i>f}s.event(t).zoom("mouse",a(y(s.that.__zoom,s.mouse[0]=_w(t,n),s.mouse[1]),s.extent,c))}),!0).on("mouseup.zoom",(function(t){o.on("mousemove.zoom mouseup.zoom",null),function(t,e){var i=t.document.documentElement,r=PI(t).on("dragstart.drag",null);e&&(r.on("click.drag",RI,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in i?r.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect)}(t.view,s.moved),VM(t),s.event(t).end()}),!0),l=_w(t,n),d=t.clientX,h=t.clientY;!function(t){var e=t.document.documentElement,i=PI(t).on("dragstart.drag",RI,!0);"onselectstart"in e?i.on("selectstart.drag",RI,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(t.view),HM(t),s.mouse=[l,this.__zoom.invert(l)],uM(this),s.start()}}function C(t,...e){if(r.apply(this,arguments)){var i=this.__zoom,s=_w(t.changedTouches?t.changedTouches[0]:t,this),o=i.invert(s),l=i.k*(t.shiftKey?.5:2),h=a(y(v(i,l),s,o),n.apply(this,e),c);VM(t),d>0?fw(this).transition().duration(d).call(x,h,s,t):fw(this).call(_.transform,h,s,t)}}function E(i,...n){if(r.apply(this,arguments)){var a,s,o,l,c=i.touches,d=c.length,h=w(this,n,i.changedTouches.length===d).event(i);for(HM(i),s=0;s<d;++s)l=[l=_w(o=c[s],this),this.__zoom.invert(l),o.identifier],h.touch0?h.touch1||h.touch0[2]===l[2]||(h.touch1=l,h.taps=0):(h.touch0=l,a=!0,h.taps=1+!!t);t&&(t=clearTimeout(t)),a&&(h.taps<2&&(e=l[0],t=setTimeout((function(){t=null}),u)),uM(this),h.start())}}function $(t,...e){if(this.__zooming){var i,r,n,s,o=w(this,e).event(t),l=t.changedTouches,d=l.length;for(VM(t),i=0;i<d;++i)n=_w(r=l[i],this),o.touch0&&o.touch0[2]===r.identifier?o.touch0[0]=n:o.touch1&&o.touch1[2]===r.identifier&&(o.touch1[0]=n);if(r=o.that.__zoom,o.touch1){var h=o.touch0[0],p=o.touch0[1],u=o.touch1[0],m=o.touch1[1],f=(f=u[0]-h[0])*f+(f=u[1]-h[1])*f,g=(g=m[0]-p[0])*g+(g=m[1]-p[1])*g;r=v(r,Math.sqrt(f/g)),n=[(h[0]+u[0])/2,(h[1]+u[1])/2],s=[(p[0]+m[0])/2,(p[1]+m[1])/2]}else{if(!o.touch0)return;n=o.touch0[0],s=o.touch0[1]}o.zoom("touch",a(y(r,n,s),o.extent,c))}}function A(t,...r){if(this.__zooming){var n,a,s=w(this,r).event(t),o=t.changedTouches,l=o.length;for(HM(t),i&&clearTimeout(i),i=setTimeout((function(){i=null}),u),n=0;n<l;++n)a=o[n],s.touch0&&s.touch0[2]===a.identifier?delete s.touch0:s.touch1&&s.touch1[2]===a.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(a=_w(a,this),Math.hypot(e[0]-a[0],e[1]-a[1])<g)){var c=fw(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return _.transform=function(t,e,i,r){var n=t.selection?t.selection():t;n.property("__zoom",ZM),t!==n?x(t,e,i,r):n.interrupt().each((function(){w(this,arguments).event(r).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},_.scaleBy=function(t,e,i,r){_.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),i,r)},_.scaleTo=function(t,e,i,r){_.transform(t,(function(){var t=n.apply(this,arguments),r=this.__zoom,s=null==i?b(t):"function"==typeof i?i.apply(this,arguments):i,o=r.invert(s),l="function"==typeof e?e.apply(this,arguments):e;return a(y(v(r,l),s,o),t,c)}),i,r)},_.translateBy=function(t,e,i,r){_.transform(t,(function(){return a(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof i?i.apply(this,arguments):i),n.apply(this,arguments),c)}),null,r)},_.translateTo=function(t,e,i,r,s){_.transform(t,(function(){var t=n.apply(this,arguments),s=this.__zoom,o=null==r?b(t):"function"==typeof r?r.apply(this,arguments):r;return a(NM.translate(o[0],o[1]).scale(s.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof i?-i.apply(this,arguments):-i),t,c)}),r,s)},k.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=fw(this.that).datum();p.call(t,this.that,new BM(t,{sourceEvent:this.sourceEvent,target:_,type:t,transform:this.that.__zoom,dispatch:p}),e)}},_.wheelDelta=function(t){return arguments.length?(s="function"==typeof t?t:OM(+t),_):s},_.filter=function(t){return arguments.length?(r="function"==typeof t?t:OM(!!t),_):r},_.touchable=function(t){return arguments.length?(o="function"==typeof t?t:OM(!!t),_):o},_.extent=function(t){return arguments.length?(n="function"==typeof t?t:OM([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),_):n},_.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],_):[l[0],l[1]]},_.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],_):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},_.constrain=function(t){return arguments.length?(a=t,_):a},_.duration=function(t){return arguments.length?(d=+t,_):d},_.interpolate=function(t){return arguments.length?(h=t,_):h},_.on=function(){var t=p.on.apply(p,arguments);return t===p?_:t},_.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,_):Math.sqrt(f)},_.tapDistance=function(t){return arguments.length?(g=+t,_):g},_}function KM(t){return null==t?0:1+Math.max(KM(t?.children?.[0]),KM(t?.children?.[1]))}function JM(t,e,{depth:i=3,padding:r=20,gapX:n=30,gapY:a=5,stroke:s="#555",strokeWidth:o=1,strokeOpacity:l=.4,strokeLinejoin:c,strokeLinecap:d,curve:h=fA,boxWidth:p=190,boxHeight:u=90,imgPadding:m=10,childrenTriangle:f=!0,getImageUrl:g=null,orientation:_="LTR"}={}){const v=k$(e),y=v.descendants(),b=Math.min(KM(e),i);j$().nodeSize([u+a,p+n]).separation(((t,e)=>(t.parent,e.parent,1)))(v);let x=1/0,w=-x;if(v.each((t=>{t.x>w&&(w=t.x),t.x<x&&(x=t.x)})),"RTL"===_&&y.forEach((t=>{t.y=-t.y})),"function"!=typeof h)throw new Error("Unsupported curve");const k=b*p+(b-1)*n+2*r,[T,S]=function(t){const e=t.map((t=>t.x)),i=function(t,e){let i;if(void 0===e)for(const e of t)null!=e&&(i<e||void 0===i&&e>=e)&&(i=e);else{let r=-1;for(let n of t)null!=(n=e(n,++r,t))&&(i<n||void 0===i&&n>=n)&&(i=n)}return i}(e),r=function(t,e){let i;if(void 0===e)for(const e of t)null!=e&&(i>e||void 0===i&&e>=e)&&(i=e);else{let r=-1;for(let n of t)null!=(n=e(n,++r,t))&&(i>n||void 0===i&&n>=n)&&(i=n)}return i}(e);return[r,i]}(y),C=S-T+u,E=T-u/2,$="RTL"===_?p/2+r-k:-p/2-r,A=t.append("g").attr("transform",`translate(${-$},0)`);A.append("g").attr("fill","none").attr("stroke",s).attr("stroke-opacity",l).attr("stroke-linecap",d).attr("stroke-linejoin",c).attr("stroke-width",o).selectAll("path").data(v.links()).join("path").attr("d",(t=>{const e=t.source.x,i="LTR"===_?t.source.y+p/2-10:t.source.y-p/2+10,r=t.target.x,n="LTR"===_?t.target.y-p/2+10:t.target.y+p/2-10;return function(t){let e=gA,i=_A,r=pA,n=uA,a=null,s=null,o=rA(l);function l(){let l;const c=hA.call(arguments),d=e.apply(this,c),h=i.apply(this,c);if(null==a&&(s=t(l=o())),s.lineStart(),c[0]=d,s.point(+r.apply(this,c),+n.apply(this,c)),c[0]=h,s.point(+r.apply(this,c),+n.apply(this,c)),s.lineEnd(),l)return s=null,l+""||null}return l.source=function(t){return arguments.length?(e=t,l):e},l.target=function(t){return arguments.length?(i=t,l):i},l.x=function(t){return arguments.length?(r="function"==typeof t?t:O$(+t),l):r},l.y=function(t){return arguments.length?(n="function"==typeof t?t:O$(+t),l):n},l.context=function(e){return arguments.length?(null==e?a=s=null:s=t(a=e),l):a},l}(h).x((t=>t.y)).y((t=>t.x))({source:{x:e,y:i},target:{x:r,y:n}})}));const I=A.append("g").selectAll("a").data(y).join("a").attr("transform",(t=>`translate(${t.y},${t.x})`));if(I.append("rect").filter((t=>t.data.person)).attr("fill",(t=>0===t.data?.person?.gender?"var(--color-girl)":"var(--color-boy)")).attr("width",24).attr("height",u-1).attr("rx",12).attr("ry",12).attr("transform",`translate(${-p/2-4},${-u/2+.5})`).attr("id",(t=>t.data.id)),I.append("rect").filter((t=>t.data.person)).attr("fill","rgba(230, 230, 230)").attr("width",p).attr("height",u).attr("rx",8).attr("ry",8).attr("transform",`translate(${-p/2},${-u/2})`).attr("id",(t=>t.data.id)),f){const t=function(t,e){let i=null,r=rA(n);function n(){let n;if(i||(i=n=r()),t.apply(this,arguments).draw(i,+e.apply(this,arguments)),n)return i=null,n+""||null}return t="function"==typeof t?t:O$(t||vA),e="function"==typeof e?e:O$(void 0===e?64:+e),n.type=function(e){return arguments.length?(t="function"==typeof e?e:O$(e),n):t},n.size=function(t){return arguments.length?(e="function"==typeof t?t:O$(+t),n):e},n.context=function(t){return arguments.length?(i=null==t?null:t,n):i},n}().type(bA).size(200),e="LTR"===_?-90:90;I.append("path").filter((t=>0===t.depth)).attr("d",t).attr("transform",(t=>`translate(${function(t){return"LTR"===_?t.y-p/2-12:t.y+p/2+12}(t)},${t.x}) rotate(${e}) scale(-1, 0.5)`)).attr("fill","#bbb").attr("id","triangle-children").on("click",(function(t){A.node().dispatchEvent(new CustomEvent("pedigree:show-children",{bubbles:!0,composed:!0,detail:{pageX:t.pageX,pageY:t.pageY}})),t.stopPropagation(),t.preventDefault()}))}const M=(u-2*m)/2,L=t=>g(t)?2*M+2*m:2*m,P=(t,e)=>{if(!t)return"";const i=e/7.8;return t.length<=i?t:i<2?"":`${t.slice(0,i-2)}`},R=t=>g(t)?p-2*m-2*M:p-2*M;I.append("text").filter((t=>t.data.name_surname)).attr("y",-u/2+25).attr("x",(t=>-p/2+L(t))).attr("text-anchor","start").attr("font-weight","500").attr("fill","rgba(0, 0, 0, 0.9)").attr("paint-order","stroke").text((t=>P(`${t.data.name_surname},`,R(t)))),I.append("text").filter((t=>t.data.name_given)).attr("y",-u/2+25+17).attr("x",(t=>-p/2+L(t))).attr("width",50).attr("text-anchor","start").attr("font-weight","500").attr("fill","rgba(0, 0, 0, 0.9)").attr("paint-order","stroke").attr("text-overflow","ellipsis").attr("overflow","hidden").attr("width",25).text((t=>P(t.data.name_given,R(t)))),I.append("text").filter((t=>t.data.person?.profile?.birth?.date)).attr("y",-u/2+25+34).attr("x",(t=>-p/2+L(t))).attr("text-anchor","start").attr("font-weight","350").attr("fill","rgba(0, 0, 0, 0.9)").attr("paint-order","stroke").text((t=>P(`*${t.data.person.profile.birth.date}`,R(t)))),I.append("text").filter((t=>t.data.person?.profile?.death?.date)).attr("y",-u/2+25+51).attr("x",(t=>-p/2+L(t))).attr("text-anchor","start").attr("font-weight","350").attr("fill","rgba(0, 0, 0, 0.9)").attr("paint-order","stroke").text((t=>P(`${t.data.person.profile.death.date}`,R(t)))),I.filter(g).append("circle").attr("r",M).attr("cy",-u/2+M+m).attr("cx",-p/2+M+m).attr("fill",(t=>`url(#imgpattern-${t.data.id})`));const z=t.append("defs").selectAll(".imgpattern").data(y).enter().append("pattern").attr("id",(t=>`imgpattern-${t.data.id}`)).attr("height",1).attr("width",1).attr("x","0").attr("y","0");return z.append("image").attr("x",0).attr("y",0).attr("height",70).attr("width",70).attr("xlink:href",g),I.style("cursor","pointer").on("click",(function(t,e){dispatchEvent(new CustomEvent("pedigree:person-selected",{bubbles:!0,composed:!0,detail:{grampsId:e.data?.person?.gramps_id}}))})),[$,E,k,C,p+2*r]}FM.prototype;class QM extends(al(K)){static get styles(){return[nl,n`
        div#container {
          display: flex;
          height: calc(100vh - 165px);
        }
      `]}static get properties(){return{data:{type:Array},containerWidth:{type:Number},containerHeight:{type:Number}}}constructor(){super(),this.data=[],this.containerWidth=-1,this.containerHeight=-1}render(){return M`<div id="container">${this.renderChart()}</div>`}firstUpdated(){const t=this.renderRoot.getElementById("container");this.handleResize(),new ResizeObserver((()=>this.handleResize())).observe(t)}handleResize(){const t=this.renderRoot.getElementById("container");t&&(this.containerWidth=t.offsetWidth,this.containerHeight=t.offsetHeight)}}const tL=(t,e)=>t.find((t=>t.handle===e))||{},eL=(t,e)=>t.find((t=>t.gramps_id===e))||{},iL=(t,e,i=!0)=>{if(!t.media_list||0===t.media_list.length)return"";const[r]=t.media_list;return r.rect&&0!==r.rect.length?Yn(r.ref,r.rect,e,i):Un(r.ref,e,i)},rL=(t,e,i,r=!0,n=0,a="p")=>{if(0===i)return{};const s=tL(t,e),o={name_given:s?.profile?s?.profile?.name_given:null,name_surname:s?.profile?s?.profile?.name_surname:null,id:a,depth:n,person:s};if(1===i)return o;const l=s?.extended?.primary_parent_family?.father_handle||"",c=s?.extended?.primary_parent_family?.mother_handle||"";return o.children=[],(l||r)&&o.children.push(rL(t,l,i-1,r,n+1,`${a}f`)),(c||r)&&o.children.push(rL(t,c,i-1,r,n+1,`${a}m`)),o},nL=(t,e,i,r=0,n="p")=>{if(0===i)return{};const a=tL(t,e),s={name_given:a?.profile?a?.profile?.name_given:null,name_surname:a?.profile?a?.profile?.name_surname:null,id:n,depth:r,person:a};if(1===i)return s;const o=(a?.extended?.families||[]).flatMap((t=>t.child_ref_list)).filter((t=>"Birth"===t.frel)).map((t=>t.ref))??[];return s.children=o.map(((e,a)=>nL(t,e,i-1,r+1,`${n}c${a}`))),s},aL=(t,e,{legendItemHeight:i=15,legendItemWidth:r=15,legendItemMargin:n=5,opacity:a=1}={})=>{t.selectAll("rect").data(e).enter().append("rect").attr("x",0).attr("y",((t,e)=>e*(i+n))).attr("width",r).attr("height",i).attr("fill",(t=>t.color)).attr("fill-opacity",a),t.selectAll("text").data(e).enter().append("text").attr("x",r+8).attr("text-anchor","start").attr("font-family","Inter var").attr("font-weight",350).attr("font-size",13).attr("y",((t,e)=>e*(i+n)+i/2)).attr("dy","0.35em").text((t=>t.label))},sL=(t,{opacity:e=1,minColorValue:i=0,maxColorValue:r=100,colorBarWidth:n=20,colorBarHeight:a=200}={})=>{if(i===1/0||r===-1/0||i===r)return;const s=ck(ix).domain([r,i]);t.append("linearGradient").attr("id","color-gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",200).selectAll("stop").data(Lw(0,1.1,.1)).enter().append("stop").attr("offset",(t=>100*t+"%")).attr("stop-color",(t=>s(t*(r-i)+i))),t.append("rect").attr("width",n).attr("height",a).style("fill","url(#color-gradient)").style("fill-opacity",e);const o=s.ticks(5);t.selectAll(".colorbar-tick").data(o).enter().append("g").attr("class","colorbar-tick").attr("transform",(t=>`translate(30, ${(1-(t-i)/(r-i))*a})`)).each((function(){fw(this).append("line").attr("x1",-4).attr("x2",-10).attr("stroke","black")})).append("text").attr("class","colorbar-tick").attr("x",4).attr("text-anchor","start").attr("dy","0.4em").text((t=>`${t}`))};window.customElements.define("grampsjs-tree-chart",class extends QM{static get styles(){return[super.styles,n`
        svg a {
          text-decoration: none !important;
        }

        mwc-menu {
          --mdc-typography-subtitle1-font-size: 13px;
          --mdc-menu-item-height: 36px;
        }
      `]}static get properties(){return{grampsId:{type:String},nAnc:{type:Number},nDesc:{type:Number},ancestors:{type:Boolean},descendants:{type:Boolean},gapX:{type:Number}}}constructor(){super(),this.grampsId="",this.nAnc=5,this.nDesc=5,this.gapX=30}render(){return M`
      <div
        @pedigree:show-children="${this._handleShowChildren}"
        style="position:relative;"
      >
        <div id="container">${this.renderChart()}</div>
        ${this.renderChildrenMenu()}
      </div>
    `}renderChart(){if(0===this.data.length||!this.grampsId)return"";const{handle:t}=eL(this.data,this.grampsId);if(!t)return"";const e=!!this.descendants&&nL(this.data,t,this.nDesc),i=!!this.ancestors&&rL(this.data,t,this.nAnc,!1);let r=!1;return r=(!this.descendants||!this.ancestors)&&(this.descendants?this._hasParents():this._hasChildren()),M`
      ${function(t,e,i){const r=gw("svg").call(XM().on("zoom",(t=>r.select("#chart-content").attr("transform",t.transform)))).attr("font-family","Inter var").attr("font-size",13),n=r.append("g").attr("id","chart-content");let a=0,s=0,o=0,l=0,c=0,d=0,h=0;if(t){const e=n.append("g"),[r,s,d,h,p]=JM(e,t,{...i,orientation:"RTL",depth:i.nDesc});e.attr("transform",`translate(${-d+p},0)`),l=Math.min(l,s),c=Math.max(c,s+h),o=Math.min(o,r),a+=d-p}if(e){const t=n.append("g"),[r,s,d,h]=JM(t,e,{...i,orientation:"LTR",depth:i.nAnc});t.attr("transform","translate(0,0)"),l=Math.min(l,s),c=Math.max(c,s+h),o=Math.min(o,r),a+=d}return d=o,s=c-l,i.bboxWidth>a&&(d-=(i.bboxWidth-a)/2),h=l,i.bboxHeight>s&&(h-=(i.bboxHeight-s)/2),r.attr("viewBox",[d,h,i.bboxWidth,i.bboxHeight]),r.node()}(e,i,{nAnc:this.nAnc,nDesc:this.nDesc,childrenTriangle:r,getImageUrl:t=>iL(t?.data?.person||{},200),orientation:this.descendants?"RTL":"LTR",gapX:this.gapX,bboxWidth:this.containerWidth,bboxHeight:this.containerHeight})}
    `}_hasChildren(){const{handle:t}=eL(this.data,this.grampsId),e=nL(this.data,t,2);return!(!e.children||!e.children.length)}_hasParents(){const{handle:t}=eL(this.data,this.grampsId),e=rL(this.data,t,2,!1);return!(!e.children||!e.children.length)}renderChildrenMenu(){const{handle:t}=eL(this.data,this.grampsId),e=this.descendants?rL(this.data,t,2,!1):nL(this.data,t,2),{children:i}=e;return i&&i.length?M`
      <mwc-menu fixed corner="BOTTOM_LEFT" menuCorner="START">
        ${i.map((t=>M`
              <mwc-list-item
                @click=${()=>this._handleChild(t.person.gramps_id)}
                @keydown=${gs}
                >${t.name_given||M`$hellip;`}</mwc-list-item
              >
            `))}
      </mwc-menu>
    `:""}_handleChild(t){os(this,"pedigree:person-selected",{grampsId:t}),this._closeMenu()}_handleShowChildren(){null!==this.renderRoot.querySelector("#triangle-children")&&this._openMenu()}_openMenu(){const t=this.renderRoot.querySelector("mwc-menu");null!==t&&(t.open=!0)}_closeMenu(){const t=this.renderRoot.querySelector("mwc-menu");null!==t&&(t.open=!1)}update(t){super.update(t),t.has("data")&&this._updateMenuAnchor()}_updateMenuAnchor(){const t=this.renderRoot.querySelector("mwc-menu"),e=this.renderRoot.querySelector("#triangle-children");null!==t&&null!==e&&(t.anchor=e)}});window.customElements.define("grampsjs-view-descendant-chart",class extends x${constructor(){super(),this.nAnc=1,this.nDesc=1,this._setDesc=!0}_resetLevels(){this.nDesc=1}renderChart(){return M`
      <grampsjs-tree-chart
        descendants
        grampsId=${this.grampsId}
        nAnc=${this.nAnc+1}
        nDesc=${this.nDesc+1}
        .data=${this._data}
        gapX="60"
        .strings=${this.strings}
      >
      </grampsjs-tree-chart>
    `}});window.customElements.define("grampsjs-view-tree-chart",class extends x${constructor(){super(),this.nAnc=3,this.nDesc=1,this._setAnc=!0}_resetLevels(){this.nAnc=3}renderChart(){return M`
      <grampsjs-tree-chart
        ancestors
        grampsId=${this.grampsId}
        nAnc=${this.nAnc+1}
        nDesc=${this.nDesc+1}
        .data=${this._data}
        .strings=${this.strings}
      >
      </grampsjs-tree-chart>
    `}});window.customElements.define("grampsjs-view-hourglass-chart",class extends x${constructor(){super(),this.nAnc=2,this.nDesc=1,this._setAnc=!0,this._setDesc=!0}_resetLevels(){this.nAnc=2,this.nDesc=1}renderChart(){return M`
      <grampsjs-tree-chart
        ancestors
        descendants
        grampsId=${this.grampsId}
        nAnc=${this.nAnc+1}
        nDesc=${this.nDesc+1}
        .data=${this._data}
        gapX="60"
        .strings=${this.strings}
      >
      </grampsjs-tree-chart>
    `}});class oL extends bS{constructor(){super(...arguments),this.avatar=!1,this.href="",this.target="",this.removeOnly=!1,this.selected=!1}get primaryId(){return this.href?"link":this.removeOnly?"":"button"}get rippleDisabled(){return!this.href&&this.disabled}get primaryAction(){return this.removeOnly?null:this.renderRoot.querySelector(".primary.action")}getContainerClasses(){return{...super.getContainerClasses(),avatar:this.avatar,disabled:!this.href&&this.disabled,link:!!this.href,selected:this.selected,"has-trailing":!0}}renderPrimaryAction(t){const{ariaLabel:e}=this;return this.href?dp`
        <a
          class="primary action"
          id="link"
          aria-label=${e||pp}
          href=${this.href}
          target=${this.target||pp}
          >${t}</a
        >
      `:this.removeOnly?dp`
        <span class="primary action" aria-label=${e||pp}>
          ${t}
        </span>
      `:dp`
      <button
        class="primary action"
        id="button"
        aria-label=${e||pp}
        ?disabled=${this.disabled&&!this.alwaysFocusable}
        type="button"
        >${t}</button
      >
    `}renderTrailingAction(t){return xS({focusListener:t,ariaLabel:this.ariaLabelRemove,disabled:!this.href&&this.disabled,tabbable:this.removeOnly})}}it([jh({type:Boolean})],oL.prototype,"avatar",void 0),it([jh()],oL.prototype,"href",void 0),it([jh()],oL.prototype,"target",void 0),it([jh({type:Boolean,attribute:"remove-only"})],oL.prototype,"removeOnly",void 0),it([jh({type:Boolean,reflect:!0})],oL.prototype,"selected",void 0),it([Fh(".trailing.action")],oL.prototype,"trailingAction",void 0);const lL=vh`:host{--_container-height: var(--md-input-chip-container-height, 32px);--_disabled-label-text-color: var(--md-input-chip-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-input-chip-disabled-label-text-opacity, 0.38);--_disabled-selected-container-color: var(--md-input-chip-disabled-selected-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-selected-container-opacity: var(--md-input-chip-disabled-selected-container-opacity, 0.12);--_label-text-font: var(--md-input-chip-label-text-font, var(--md-sys-typescale-label-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-input-chip-label-text-line-height, var(--md-sys-typescale-label-large-line-height, 1.25rem));--_label-text-size: var(--md-input-chip-label-text-size, var(--md-sys-typescale-label-large-size, 0.875rem));--_label-text-weight: var(--md-input-chip-label-text-weight, var(--md-sys-typescale-label-large-weight, var(--md-ref-typeface-weight-medium, 500)));--_selected-container-color: var(--md-input-chip-selected-container-color, var(--md-sys-color-secondary-container, #e8def8));--_selected-focus-label-text-color: var(--md-input-chip-selected-focus-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-hover-label-text-color: var(--md-input-chip-selected-hover-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-hover-state-layer-color: var(--md-input-chip-selected-hover-state-layer-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-hover-state-layer-opacity: var(--md-input-chip-selected-hover-state-layer-opacity, 0.08);--_selected-label-text-color: var(--md-input-chip-selected-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-outline-width: var(--md-input-chip-selected-outline-width, 0px);--_selected-pressed-label-text-color: var(--md-input-chip-selected-pressed-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-pressed-state-layer-color: var(--md-input-chip-selected-pressed-state-layer-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-pressed-state-layer-opacity: var(--md-input-chip-selected-pressed-state-layer-opacity, 0.12);--_disabled-outline-color: var(--md-input-chip-disabled-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-outline-opacity: var(--md-input-chip-disabled-outline-opacity, 0.12);--_focus-label-text-color: var(--md-input-chip-focus-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-outline-color: var(--md-input-chip-focus-outline-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-label-text-color: var(--md-input-chip-hover-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-color: var(--md-input-chip-hover-state-layer-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-opacity: var(--md-input-chip-hover-state-layer-opacity, 0.08);--_label-text-color: var(--md-input-chip-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_outline-color: var(--md-input-chip-outline-color, var(--md-sys-color-outline, #79747e));--_outline-width: var(--md-input-chip-outline-width, 1px);--_pressed-label-text-color: var(--md-input-chip-pressed-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-state-layer-color: var(--md-input-chip-pressed-state-layer-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-state-layer-opacity: var(--md-input-chip-pressed-state-layer-opacity, 0.12);--_avatar-shape: var(--md-input-chip-avatar-shape, var(--md-sys-shape-corner-full, 9999px));--_avatar-size: var(--md-input-chip-avatar-size, 24px);--_disabled-avatar-opacity: var(--md-input-chip-disabled-avatar-opacity, 0.38);--_disabled-leading-icon-color: var(--md-input-chip-disabled-leading-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-icon-opacity: var(--md-input-chip-disabled-leading-icon-opacity, 0.38);--_icon-size: var(--md-input-chip-icon-size, 18px);--_selected-focus-leading-icon-color: var(--md-input-chip-selected-focus-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-hover-leading-icon-color: var(--md-input-chip-selected-hover-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-leading-icon-color: var(--md-input-chip-selected-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-pressed-leading-icon-color: var(--md-input-chip-selected-pressed-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_focus-leading-icon-color: var(--md-input-chip-focus-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_hover-leading-icon-color: var(--md-input-chip-hover-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_leading-icon-color: var(--md-input-chip-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_pressed-leading-icon-color: var(--md-input-chip-pressed-leading-icon-color, var(--md-sys-color-primary, #6750a4));--_disabled-trailing-icon-color: var(--md-input-chip-disabled-trailing-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-icon-opacity: var(--md-input-chip-disabled-trailing-icon-opacity, 0.38);--_selected-focus-trailing-icon-color: var(--md-input-chip-selected-focus-trailing-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-hover-trailing-icon-color: var(--md-input-chip-selected-hover-trailing-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-pressed-trailing-icon-color: var(--md-input-chip-selected-pressed-trailing-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_selected-trailing-icon-color: var(--md-input-chip-selected-trailing-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_focus-trailing-icon-color: var(--md-input-chip-focus-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-icon-color: var(--md-input-chip-hover-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-trailing-icon-color: var(--md-input-chip-pressed-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-icon-color: var(--md-input-chip-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_container-shape-start-start: var(--md-input-chip-container-shape-start-start, var(--md-input-chip-container-shape, var(--md-sys-shape-corner-small, 8px)));--_container-shape-start-end: var(--md-input-chip-container-shape-start-end, var(--md-input-chip-container-shape, var(--md-sys-shape-corner-small, 8px)));--_container-shape-end-end: var(--md-input-chip-container-shape-end-end, var(--md-input-chip-container-shape, var(--md-sys-shape-corner-small, 8px)));--_container-shape-end-start: var(--md-input-chip-container-shape-end-start, var(--md-input-chip-container-shape, var(--md-sys-shape-corner-small, 8px)));--_leading-space: var(--md-input-chip-leading-space, 16px);--_trailing-space: var(--md-input-chip-trailing-space, 16px);--_icon-label-space: var(--md-input-chip-icon-label-space, 8px);--_with-leading-icon-leading-space: var(--md-input-chip-with-leading-icon-leading-space, 8px);--_with-trailing-icon-trailing-space: var(--md-input-chip-with-trailing-icon-trailing-space, 8px)}:host([avatar]){--_container-shape-start-start: var( --md-input-chip-container-shape-start-start, var(--md-input-chip-container-shape, calc(var(--_container-height) / 2)) );--_container-shape-start-end: var( --md-input-chip-container-shape-start-end, var(--md-input-chip-container-shape, calc(var(--_container-height) / 2)) );--_container-shape-end-end: var( --md-input-chip-container-shape-end-end, var(--md-input-chip-container-shape, calc(var(--_container-height) / 2)) );--_container-shape-end-start: var( --md-input-chip-container-shape-end-start, var(--md-input-chip-container-shape, calc(var(--_container-height) / 2)) )}.avatar .primary.action{padding-inline-start:4px}.avatar .leading.icon ::slotted(:first-child){border-radius:var(--_avatar-shape);height:var(--_avatar-size);width:var(--_avatar-size)}.disabled.avatar .leading.icon{opacity:var(--_disabled-avatar-opacity)}@media(forced-colors: active){.link .outline{border-color:ActiveText}.disabled.avatar .leading.icon{opacity:1}}
`;let cL=class extends oL{};cL.styles=[CS,ES,SS,lL],cL=it([ph("md-input-chip")],cL);const dL={default:{fct:t=>{if(0===t.depth)return"rgb(120, 120, 120)";const e=Math.min(Math.max(0,Math.floor(t.x0/Math.PI/2*8)),8);return Ly[e]}},nEvents:{type:"count",fct:t=>t?.event_ref_list?.length},nNotes:{type:"count",fct:t=>t?.note_list?.length},nPaths:{type:"multiplicity"},birthYear:{type:"number",fct:t=>t?.extended?.events?.[t?.birth_ref_index]?.date?.year||void 0},deathYear:{type:"number",fct:t=>t?.extended?.events?.[t?.death_ref_index]?.date?.year||void 0},age:{type:"number",fct:t=>{let e=t?.extended?.events?.[t?.birth_ref_index]?.date;e=void 0!==e&&0===e.modifier&&1!==e.quality&&e.sortval||void 0;let i=t?.extended?.events?.[t?.death_ref_index]?.date;if(i=void 0!==i&&0===i.modifier&&1!==i.quality&&i.sortval||void 0,void 0!==e&&void 0!==i)return(i-e)/365.25}},surname:{type:"category",fct:t=>{const e=t?.primary_name?.surname_list?.[0];if(void 0!==e)return`${e.prefix} ${e.surname}`.trim()}},religion:{type:"category",fct:t=>t?.extended?.events?.filter((t=>"Religion"===t?.type))?.[0]?.description}};function hL(t,e){const i=e(t?.data?.person);return void 0===i||0===i?"rgb(220, 220, 220)":ex[9][i>8?8:i]}const pL=[...My.slice(0,7),My[9],My[8],My[7]];function uL(...t){return{minX:Math.min(...t.map((({minX:t})=>t))),minY:Math.min(...t.map((({minY:t})=>t))),maxX:Math.max(...t.map((({maxX:t})=>t))),maxY:Math.max(...t.map((({maxY:t})=>t)))}}function mL(t){return null!=t&&Object.keys(t.person).length>0}function fL(t,e,i=-1,r=0,n={minX:-e,minY:-e,maxX:e,maxY:e}){if(!mL(t))return n;if(t?.children?.some(mL))return uL(...t.children.map(((t,a)=>fL(t,e,i+1,2*r+a,n))));const a=Math.PI/2**i,s=a*r-Math.PI;return uL(n,...[s,s+a/2,s+a].map((t=>function(t,e){const i=t*Math.cos(e),r=t*Math.sin(e);return{minX:i,minY:r,maxX:i,maxY:r}}(e*(i+2),t))))}function gL(t,e){return(t.person?[e(t.person)]:[]).concat((t.children||[]).reduce(((t,i)=>t.concat(gL(i,e))),[]))}function _L(t,{depth:e=5,arcRadius:i=60,padding:r=3,color:n="",bboxWidth:a=800,bboxHeight:s=800,strings:o={}}={}){const l=dL?.[n]??null;let c,d=()=>null,h=.2;if("number"===l.type){const e=l.fct,i=gL(t,(t=>e(t))),[r,n]=function(t){const e=t.filter((t=>void 0!==t));return[Math.min(...e),Math.max(...e)]}(i);c=t=>function(t,e,i,r){const n=e(t?.data?.person);return void 0===n?"rgb(220, 220, 220)":ix(r===i?.5:(n-i)/(r-i))}(t,e,r,n),h=.5,d=t=>sL(t,{opacity:.5,maxColorValue:n,minColorValue:r})}else if("count"===l.type){const t=l.fct;c=e=>hL(e,t),h=.5;const e=[...Array(8).keys()].slice(0,8).map((t=>({label:t,color:ex[9][t]})));e.push({label:" 8",color:ex[9][8]}),e[0].color="rgb(220, 220, 220)",d=t=>aL(t,e,{opacity:.5})}else if("multiplicity"===l.type){const e=function(t){const e={};return gL(t,(function(t){t.handle&&(e[t.handle]=(e[t.handle]||0)+1)})),e}(t);c=t=>0===t.depth?"rgb(220, 220, 220)":hL(t,(t=>e?.[t?.handle]??0)),h=.5;const i=[...Array(8).keys()].slice(0,8).map((t=>({label:t,color:ex[9][t]})));i.push({label:" 8",color:ex[9][8]}),i[0].color="rgb(220, 220, 220)",d=t=>aL(t,i,{opacity:.5})}else if("category"===l.type){const e=l.fct,i=function(t){const e=t.filter((t=>void 0!==t)).reduce(((t,e)=>(t[e]=(t[e]||0)+1,t)),{}),i=Object.entries(e).sort(((t,e)=>e[1]-t[1]));return i.map((([t])=>t))}(gL(t,(t=>e(t))));c=t=>function(t,e,i){const r=e(t?.data?.person);if(void 0===r)return"rgb(220, 220, 220)";const n=i.findIndex((t=>t===r));return-1===n||n>=9?pL[9]:pL[n]}(t,e,i),h=.3;const r=i.slice(0,9).map(((t,e)=>({label:t,color:pL[e]})));i.length>9&&r.push({label:o.Other??"Other",color:pL[9]}),d=t=>aL(t,r,{opacity:.4})}else c=l.fct;const p=k$(t),{minX:u,minY:m,maxX:f,maxY:g}=fL(t,i),_=f-u,v=g-m;p.count();const y=e*i;I$().size([2*Math.PI,y])(p);const b=dA().startAngle((t=>t.x0-Math.PI/2)).endAngle((t=>t.x1-Math.PI/2)).padAngle((t=>Math.min((t.x1-t.x0)/2,2*r/y))).padRadius(y/2).innerRadius((t=>t.y0)).outerRadius((t=>t.y1-r)),x=dA().startAngle((t=>t.x0-Math.PI/2)).endAngle((t=>t.x1-Math.PI/2)).padAngle((t=>Math.min((t.x1-t.x0)/2,2*r/y))).padRadius(y/2).innerRadius((t=>t.y0)).outerRadius((t=>t.y0+3)),w=-(a-_)/2,k=-(s-v)/2,T=gw("svg").attr("viewBox",[u+w,m+k,a,s]).call(XM().on("zoom",(t=>T.select("#chart-content").attr("transform",t.transform)))).attr("style","max-width: 100%; height: auto; height: intrinsic;").attr("font-family","Inter var").attr("font-size",12).attr("text-anchor","middle"),S=T.append("g").attr("id","chart-content").selectAll("a").data(p.descendants()).join("a");function C(t){return null!==t.name_given}S.filter((t=>C(t.data))).append("path").attr("d",b).attr("fill",(t=>null===c?"rgb(200, 200, 200)":c(t))).attr("fill-opacity",h).attr("id",(t=>t.data.id)),S.filter((t=>t.depth>0)).filter((t=>C(t.data))).append("path").attr("d",x).attr("fill",(t=>"m"===t.data.id.slice(-1)?"var(--color-girl)":"var(--color-boy)")),S.filter((t=>C(t.data))).style("cursor","pointer").on("click",(function(t,e){dispatchEvent(new CustomEvent("pedigree:person-selected",{bubbles:!0,composed:!0,detail:{grampsId:e.data?.person?.gramps_id}}))}));const E=t=>Math.min(12,(t.y0+t.y1)/2*(t.x1-t.x0)/10),$=(t,e,i=!1)=>{const n=(i?2*e.y1:(e.x1-e.x0)*(e.y1+e.y0)/2-r)/(.6*E(e));return t.length<=n?t:n<2?"":`${t.slice(0,n-2)}`};S.filter((t=>0===t.depth)).append("text").attr("font-weight","500").attr("dy","-0.6em").text((t=>$(t.data.name_surname,t,!0))),S.filter((t=>0===t.depth)).append("text").attr("font-weight","300").attr("dy","0.6em").text((t=>$(t.data.name_given,t,!0)));const A=t=>t.x0>=Math.PI?(t.y1+t.y0/2)*(t.x1-t.x0)+(t.y1-t.y0)-3.5*r:t.y1*(t.x1-t.x0)/2-r;return S.filter((t=>t.depth>0)).filter((t=>(t.y0+t.y1)/2*(t.x1-t.x0)>50)).append("text").attr("font-weight","500").attr("font-size",E).attr("dy",(t=>(t.y1-t.y0)/2-7+3)).append("textPath").attr("xlink:href",(t=>`#${t.data.id}`)).style("text-anchor","middle").attr("startOffset",A).style("letter-spacing",(t=>t.x0<Math.PI?1/t.y1*20+"em":`-${1/t.y1*10}em`)).text((t=>$(t.data.name_surname||"",t))),S.filter((t=>t.depth>0)).filter((t=>(t.y0+t.y1)/2*(t.x1-t.x0)>50)).append("text").attr("font-weight","300").attr("font-size",E).attr("dy",(t=>(t.y1-t.y0)/2+7+3)).append("textPath").attr("xlink:href",(t=>`#${t.data.id}`)).style("text-anchor","middle").attr("startOffset",A).style("letter-spacing",(t=>t.x0<Math.PI?1/t.y1*40+"em":`-${1/t.y1*15}em`)).text((t=>$(t.data.name_given||"",t))),T.append("g").attr("id","legend").attr("transform",`translate(${u+w+60}, ${m+k+120})`),T.select("#legend").call(d),T.node()}window.customElements.define("grampsjs-fan-chart",class extends QM{static get styles(){return[super.styles,n`
        svg a {
          text-decoration: none !important;
        }
      `]}static get properties(){return{grampsId:{type:String},depth:{type:Number},color:{type:String}}}constructor(){super(),this.grampsId="",this.depth=5,this.color=""}renderChart(){if(0===this.data.length||!this.grampsId)return"";const{handle:t}=eL(this.data,this.grampsId);if(!t)return"";const e=rL(this.data,t,this.depth);return M`
      ${_L(e,{depth:this.depth,arcRadius:60,color:this.color||"default",bboxWidth:this.containerWidth,bboxHeight:this.containerHeight,strings:this.strings})}
    `}});const vL={nEvents:"Number of events",nNotes:"Number of notes",birthYear:"Birth year",deathYear:"Death year",age:"Age",surname:"Surname",religion:"Religion",nPaths:"Ancestor frequency"};var yL,bL,xL,wL;window.customElements.define("grampsjs-view-fan-chart",class extends x${static get styles(){return[super.styles,n`
        :host {
          margin: 0;
          margin-top: -4px;
          margin-bottom: -25px;
          --md-menu-item-one-line-container-height: 48px;
        }

        #controls md-input-chip {
          --md-sys-color-outline: rgba(0, 0, 0, 0.3);
          --md-sys-color-primary: rgba(0, 0, 0, 0.4);
          position: relative;
          top: 8px;
          margin-left: 10px;
          margin-bottom: 0px;
        }

        md-menu {
          min-width: 13em;
        }
      `]}static get properties(){return{color:{type:String}}}constructor(){super(),this.nAnc=4,this.nDesc=1,this._setAnc=!0,this.color=""}_resetLevels(){this.nAnc=4}renderChart(){return M`
      <grampsjs-fan-chart
        grampsId=${this.grampsId}
        depth=${this.nAnc+1}
        .data=${this._data}
        .strings=${this.strings}
        color="${this.color}"
      >
      </grampsjs-fan-chart>
    `}renderControls(){return M`
      ${super.renderControls()}

      <mwc-icon-button
        icon="palette"
        @click=${this._handleColor}
        id="btn-color"
      ></mwc-icon-button>
      <grampsjs-tooltip for="btn-color" .strings="${this.strings}"
        >${this._("Color")}</grampsjs-tooltip
      >
      <span style="position: relative">
        <md-menu id="usage-menu" anchor="btn-color" skip-restore-focus>
          ${Object.keys(vL).map((t=>M`
              <md-menu-item @click="${()=>this._handleColorClick(t)}">
                <div slot="headline">${this._(vL[t])}</div>
              </md-menu-item>
            `))}
        </md-menu>
      </span>
      ${this.color&&vL[this.color]?M`
            <div style="display: inline-block; height: 50px;">
              <md-input-chip
                label="${this._(vL[this.color])}"
                @remove="${()=>this._handleColorClick("")}"
              >
                <svg viewBox="0 0 24 24" slot="icon">
                  <path d="${"M17.5,12A1.5,1.5 0 0,1 16,10.5A1.5,1.5 0 0,1 17.5,9A1.5,1.5 0 0,1 19,10.5A1.5,1.5 0 0,1 17.5,12M14.5,8A1.5,1.5 0 0,1 13,6.5A1.5,1.5 0 0,1 14.5,5A1.5,1.5 0 0,1 16,6.5A1.5,1.5 0 0,1 14.5,8M9.5,8A1.5,1.5 0 0,1 8,6.5A1.5,1.5 0 0,1 9.5,5A1.5,1.5 0 0,1 11,6.5A1.5,1.5 0 0,1 9.5,8M6.5,12A1.5,1.5 0 0,1 5,10.5A1.5,1.5 0 0,1 6.5,9A1.5,1.5 0 0,1 8,10.5A1.5,1.5 0 0,1 6.5,12M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A1.5,1.5 0 0,0 13.5,19.5C13.5,19.11 13.35,18.76 13.11,18.5C12.88,18.23 12.73,17.88 12.73,17.5A1.5,1.5 0 0,1 14.23,16H16A5,5 0 0,0 21,11C21,6.58 16.97,3 12,3Z"}" />
                </svg>
              </md-input-chip>
            </div>
          `:""}
    `}_handleColor(){this.renderRoot.querySelector("#usage-menu").open=!0}_handleColorClick(t){this.color=t}}),function(t){t.load=function(){return import("./33418471.js").then((t=>t.Base91.load()))}}(yL||(yL={})),(bL||(bL={})).load=function(){return import("./31c60384.js").then((t=>t.Expat.load()))},(xL||(xL={})).load=function(){return import("./04cbb1c8.js").then((t=>t.Graphviz.load()))},(wL||(wL={})).load=function(){return import("./579ec6d5.js").then((t=>t.Zstd.load()))};class kL{constructor(t,e,i,r){this.data=t,this.boxWidth=e,this.boxHeight=i,this.rootPersonGrampsId=r,this.rootPerson=void 0,this.nodes={},this.edges={},this.edge_seen={},this.person_node_map={},this.persons={},this.dot=void 0,function(t){const e=t.getData();for(const i of e)t.addPerson(i);for(const i of e){for(const e of i.extended.families)t.known(e.father_handle)&&t.known(e.mother_handle)&&t.addNode(e,e.handle,e.father_handle,e.mother_handle);if(i.extended?.primary_parent_family?.handle){const e=i.extended.primary_parent_family;t.addNode(e,e.handle,e.father_handle,e.mother_handle)}}for(const i of e)t.getNodesOfPerson(i.handle).length<1&&t.addNode(void 0,`p_${i.handle}`,i.handle,!1);for(const i of e){const e=i.extended.primary_parent_family,r=i.handle,n=e.father_handle,a=e.mother_handle;t.known(n)&&t.known(a)?t.addEdge(e.handle,!1,r):t.known(n)?t.addEdge(e.handle,n,r):t.known(a)&&t.addEdge(e.handle,a,r)}for(const i of e){const e=i.extended?.primary_parent_family;if(!(e?.father_handle&&t.known(e?.father_handle)||e?.mother_handle&&t.known(e?.mother_handle))){let e=0;for(const r of i.extended.families){let i=0;for(const e of r.child_ref_list)t.known(e.ref)&&(i+=1);(t.known(r?.father_handle)&&t.known(r?.mother_handle)||i>0)&&(e+=1)}if(e>1){const e=`fakeparent${i.handle}`;t.addPerson({handle:e,gramps_id:"",profile:{fake:!0,name_given:"FAKE",name_surname:i.profile.name_surname}}),t.addNode({fake:!0},`p_${e}`,e,!1),t.addEdge(`p_${e}`,e,i.handle)}}}}(this)}getData(){return this.data}getDot(){return this.dot||(this.dot=function(t){let e="";for(const i of t.getNodes()){const r=i.father,n=i.mother,a=i.fake?0:t.boxWidth/66,s=i.fake?0:t.boxHeight/66-.3;if(r&&n)e+=`\n      subgraph "cluster_${i.handle}" {\n        cluster=true\n        color=white\n        margin="50,0"\n        label="."\n        "node_${i.handle}x${r}" [\n          class="person_${r}"\n          margin=0\n          shape="none"\n          fixedsize=true\n          width=${a}\n          height=${s}\n          label=<->\n        ]\n        "node_${i.handle}" [\n          class="family_${i.handle}"\n          label=<.>\n          shape="none"\n          margin=0\n          fixedsize=true\n          width=0.1\n          height=${s}\n        ]\n        "node_${i.handle}x${n}" [\n          class="person_${n}"\n          margin=0.25\n          shape="none"\n          fixedsize=true\n          width=${a}\n          height=${s}\n          label=<->\n        ]\n      }\n    `;else{const t=r||n;e+=`\n      subgraph "cluster_${i.handle}" {\n        cluster=true\n        color=white\n        label="."\n        "node_${i.handle}x${t}" [\n          class="person_${t}"\n          margin=0.25\n          shape="none"\n          fixedsize=true\n          width=${a}\n          height=${s}\n          label=<->\n        ]\n      }\n    `}}for(const i of t.getEdges())for(const r of t.getNodesOfPerson(i.targetPerson))i.sourcePerson?e+=`"node_${i.sourceFamily}x${i.sourcePerson}" -> "node_${r}x${i.targetPerson}" [label="", arrowhead=none, color="#555"]\n      `:e+=`"node_${i.sourceFamily}" -> "node_${r}x${i.targetPerson}" [ltail="node_${i.sourceFamily}", label="", arrowhead=none, color="#555"]\n      `;return e=`\n    digraph gramps {\n      compound=true\n      ranksep=2.8\n      labelloc="t"\n      charset="UTF-8"\n      pad=2\n      splines=polyline\n      //splines=ortho\n      //splines=spline\n      // this controls the number of iterations = nslimit * no_nodes\n      nslimit=2.0\n      nodesep=0\n      ${e}\n    }\n  `,e}(this)),this.dot}addPerson(t){const e=t.handle;this.persons[e]={handle:e,profile:t.profile,data:t},t.gramps_id===this.rootPersonGrampsId&&(this.rootPerson=this.persons[e])}getRootPerson(){return this.rootPerson}getPersons(){return Object.values(this.persons)}known(t){return this.persons[t]||!1}addNode(t,e,i,r){const n={handle:e,type:t?.type,fake:t?.fake};i&&this.known(i)&&(n.father=i,this.person_node_map[i]=this.person_node_map[i]??{},this.person_node_map[i][e]=!0,n.fatherdata=this.known(i)),r&&this.known(r)&&(n.mother=r,this.person_node_map[r]=this.person_node_map[r]??{},this.person_node_map[r][e]=!0,n.motherdata=this.known(r)),(n.father||n.mother)&&(this.nodes[e]=n)}getNode(t){return this.nodes[t]||!1}getNodes(){return Object.values(this.nodes)}getNodesOfPerson(t){if(this.person_node_map[t]){return Object.keys(this.person_node_map[t])}return[]}addEdge(t,e,i){const r=`${t}__${e}__${i}`;this.edges[r]={sourceFamily:t,sourcePerson:e,targetPerson:i}}getEdges(){return Object.values(this.edges)}}const TL=(t,e)=>{if(!t)return"";const i=e/7.8;return t.length<=i?t:i<2?"":`${t.slice(0,i-2)}`};function SL(t,e){dispatchEvent(new CustomEvent("pedigree:person-selected",{bubbles:!0,composed:!0,detail:{grampsId:e.profile?.gramps_id}}))}function CL(t,{bboxWidth:e=300,bboxHeight:i=150,boxWidth:r=190,boxHeight:n=90,imgPadding:a=10,getImageUrl:s=null,grampsId:o=0,maxImages:l=50}){const c=gw("div").style("width","100%"),d=c.append("div").style("display","none"),h=c.append("svg").call(XM().on("zoom",(t=>h.select("#chart-content").attr("transform",t.transform)))).attr("font-family","Inter var").attr("font-size",13),p=h.append("g").attr("id","chart-content"),u=new kL(t,r,n,o),m=u.getDot();return xL.load().then((t=>{t.dot(m),d.html(t.layout(m,"svg","dot")),function(t,e,i,r,n,a,s,o){const l=t.select("svg"),c=[],d=(n-2*a)/2,h=t=>t.imageUrl?2*d+2*a:2*a,p=t=>t.imageUrl?r-2*d-10:r;l.selectAll("title").remove();let u=0;l.selectAll(".node").each((function(){const t=fw(this),e=t.select("text"),a=e.attr("x"),l=e.attr("y"),d=t.attr("class").match(/(?<handletype>family|person)_(?<handle>\S+)/);if("person"===d.groups.handletype){const t=i.known(d.groups.handle),e=s(t);e&&(u+=1),c.push({nodetype:t.profile.fake?"fake":"person",xCoord:a-r/2+4,yCoord:l-n/2,profile:t.profile,imageUrl:u>o?"":e,handle:d.groups.handle})}else if("family"===d.groups.handletype){const t=i.getNode(d.groups.handle);c.push({nodetype:"family",xCoord:a,yCoord:l,type:t.type,handle:d.groups.handle})}}));const m=e.append("g").attr("class","edges"),f=e.selectAll(".node").data(c).enter().append("g").attr("transform",(t=>`translate(${t.xCoord} ${t.yCoord})`)).attr("class",(t=>`node ${t.nodetype}`));f.filter((t=>"person"===t.nodetype)).append("rect").attr("fill",(t=>"F"===t.profile?.sex?"var(--color-girl)":"var(--color-boy)")).attr("width",24).attr("height",n-1).attr("x",-4).attr("y",0).attr("rx",12).attr("ry",12),f.filter((t=>"person"===t.nodetype)).append("rect",":first-child").attr("width",r).attr("height",n).attr("class","personBox").attr("x",0).attr("y",0).attr("rx",8).attr("ry",8),f.filter((t=>"person"===t.nodetype)).append("text").attr("text-anchor","start").attr("font-weight","500").attr("fill","rgba(0, 0, 0, 0.9)").attr("paint-order","stroke").attr("text-overflow","ellipsis").attr("overflow","hidden").attr("x",(t=>h(t))).attr("y",25).text((t=>TL(`${t.profile.name_surname},`,p(t)))),f.filter((t=>t.profile?.name_given&&"person"===t.nodetype)).append("text").attr("text-anchor","start").attr("font-weight","500").attr("fill","rgba(0, 0, 0, 0.9)").attr("paint-order","stroke").attr("text-overflow","ellipsis").attr("overflow","hidden").attr("x",(t=>h(t))).attr("y",42).text((t=>TL(t.profile.name_given,p(t)))),f.filter((t=>t.profile?.birth?.date&&"person"===t.nodetype)).append("text").attr("text-anchor","start").attr("font-weight","350").attr("fill","rgba(0, 0, 0, 0.9)").attr("paint-order","stroke").attr("x",(t=>h(t))).attr("y",59).text((t=>TL(`*${t.profile.birth.date}`,p(t)))),f.filter((t=>t.profile?.death?.date&&"person"===t.nodetype)).append("text").attr("text-anchor","start").attr("font-weight","350").attr("fill","rgba(0, 0, 0, 0.9)").attr("paint-order","stroke").attr("x",(t=>h(t))).attr("y",76).text((t=>TL(`${t.profile.death.date}`,p(t)))),f.filter((t=>t.imageUrl)).append("circle").attr("r",d).attr("cy",d+a).attr("cx",d+a).attr("fill",(t=>`url(#imgpattern-${t.handle})`));const g=e.append("defs").selectAll(".imgpattern").data(c).enter().filter((t=>"person"===t.nodetype&&t.imageUrl)).append("pattern").attr("id",(t=>`imgpattern-${t.handle}`)).attr("height",1).attr("width",1).attr("x","0").attr("y","0");g.append("image").attr("x",0).attr("y",0).attr("height",70).attr("width",70).attr("xlink:href",(t=>t.imageUrl)),f.filter((t=>"Married"===t.type&&"family"===t.nodetype)).append("circle").attr("r",5).attr("class","married"),f.filter((t=>"person"===t.nodetype)).style("cursor","pointer").on("click",SL),l.selectAll(".edge").each((function(){m.append("g").attr("class","edge").html(fw(this).html())})),m.selectAll("path").attr("stroke-opacity","0.4"),f.filter((t=>t.handle===i.rootPerson?.handle)).each((t=>{const i=-1*t.xCoord-r/2,a=-1*t.yCoord-n/2;e.attr("transform",`translate(${i} ${a})`)})),l.remove()}(d,p.append("g"),u,r,n,a,s,l),h.attr("viewBox",[-e/2,-i/2,e,i])})),c.node()}window.customElements.define("grampsjs-relationship-chart",class extends QM{static get styles(){return[super.styles,n`
        svg a {
          text-decoration: none !important;
        }
        svg .personBox {
          fill: #e6e6e6;
        }
        svg .married {
          fill: #ffffff;
          stroke: #000000;
        }

        mwc-menu {
          --mdc-typography-subtitle1-font-size: 13px;
          --mdc-menu-item-height: 36px;
        }
      `]}static get properties(){return{grampsId:{type:String},nAnc:{type:Number},nMaxImages:{type:Number},gapX:{type:Number}}}constructor(){super(),this.grampsId="",this.gapX=30}render(){return M` <div id="container">${this.renderChart()}</div> `}renderChart(){return 0!==this.data.length&&this.grampsId?M`
      ${CL(this.data,{nAnc:this.nAnc,maxImages:this.nMaxImages,grampsId:this.grampsId,getImageUrl:t=>iL(t?.data||{},200),gapX:this.gapX,bboxWidth:this.containerWidth,bboxHeight:this.containerHeight})}
    `:""}});window.customElements.define("grampsjs-view-relationship-chart",class extends x${static get styles(){return[super.styles,n`
        :host {
          margin: 0;
        }
      `]}constructor(){super(),this.nAnc=2,this._setSep=!0,this._setMaxImages=!0,this.color=""}_resetLevels(){this.nAnc=2}_getPersonRules(t){return{function:"or",rules:[{name:"DegreesOfSeparation",values:[t,this.nAnc]}]}}renderChart(){return M`
      <grampsjs-relationship-chart
        grampsId=${this.grampsId}
        nAnc=${this.nAnc+1}
        nMaxImages=${this.nMaxImages}
        .data=${this._data}
      >
      </grampsjs-relationship-chart>
    `}});window.customElements.define("grampsjs-view-tree",class extends $d{static get styles(){return[super.styles,n`
        .with-margin {
          margin: 25px 40px;
        }

        #outer-container {
          height: calc(100vh - 68px);
        }

        #select {
          z-index: 1;
          position: absolute;
          top: 85px;
          right: 25px;
          border-radius: 5px;
          background-color: rgba(255, 255, 255, 0.9);
          color: #b1b1b1;
          --mdc-theme-text-disabled-on-light: #666;
          --mdc-icon-size: 32px;
        }

        md-primary-tab {
          opacity: 0.8;
        }

        md-primary-tab[active] {
          opacity: 1;
        }

        #tabs {
          height: 85px;
        }

        md-tabs {
          --md-divider-thickness: 0px;
        }
      `]}static get properties(){return{grampsId:{type:String},view:{type:String},_history:{type:Array},_currentTabId:{type:Number}}}constructor(){super(),this.grampsId="",this.view="ancestor",this._history=this.grampsId?[this.grampsId]:[],this._currentTabId=0}renderContent(){return""===this.grampsId?M`
        <div class="with-margin">
          <p>
            ${this._("No Home Person set.")}
            <a href="/settings">${this._("User settings")}</a>
          </p>
        </div>
      `:M`
      <div id="tabs">${this.renderTabs()}</div>
      ${0===this._currentTabId?this._renderPedigree():""}
      ${1===this._currentTabId?this._renderDescendantTree():""}
      ${2===this._currentTabId?this._renderHourglassTree():""}
      ${3===this._currentTabId?this._renderRelationshipChart():""}
      ${4===this._currentTabId?this._renderFan():""}
    `}renderTabs(){return M`
      <md-tabs .activeTabIndex=${this._currentTabId}>
        <md-primary-tab
          @click=${()=>{this._currentTabId=0}}
          has-icon
          >${this._("Ancestor Tree")}
          <span slot="icon"
            >${Ha(La,"--md-sys-color-primary",-90)}</span
          >
        </md-primary-tab>
        <md-primary-tab
          @click=${()=>{this._currentTabId=1}}
          has-icon
        >
          ${this._("Descendant Tree")}
          <span slot="icon"
            >${Ha(La,"--md-sys-color-primary",90)}</span
          >
        </md-primary-tab>
        <md-primary-tab
          @click=${()=>{this._currentTabId=2}}
          has-icon
        >
          ${this._("Hourglass Graph")}
          <span slot="icon"
            >${Ha("m3.501 3.5c-1.3807 0-2.5 1.1193-2.5 2.5 0 1.3807 1.1193 2.5 2.5 2.5 0.99358-5.12e-4 1.8916-0.58936 2.2891-1.5h1.2109v4h-1.2109c-0.39743-0.91064-1.2955-1.4995-2.2891-1.5-1.3807 0-2.5 1.1193-2.5 2.5s1.1193 2.5 2.5 2.5c0.99299-5.12e-4 1.8913-0.58834 2.2891-1.498h1.2109v4h-1.2109c-0.39743-0.91064-1.2955-1.4995-2.2891-1.5-1.3807 0-2.5 1.1193-2.5 2.5 0 1.3807 1.1193 2.5 2.5 2.5 0.99358-5.12e-4 1.8916-0.58936 2.2891-1.5h1.2109c1.1046 0 2-0.89543 2-2v-4.002h0.70898c0.39743 0.91064 1.2955 1.4995 2.2891 1.5 0.99359-5.12e-4 1.8916-0.58936 2.2891-1.5h0.71094v1c0 1.1046 0.89543 2 2 2h1.2109c0.39743 0.91064 1.2955 1.4995 2.2891 1.5 1.3807 0 2.5-1.1193 2.5-2.5 0-1.3807-1.1193-2.5-2.5-2.5-0.99359 5.13e-4 -1.8916 0.58936-2.2891 1.5h-1.2109v-4h1.2109c0.39743 0.91064 1.2955 1.4995 2.2891 1.5 1.3807 0 2.5-1.1193 2.5-2.5 0-1.3807-1.1193-2.5-2.5-2.5-0.99359 5.131e-4 -1.8916 0.58936-2.2891 1.5h-1.2109c-1.1046 0-2 0.89543-2 2v1h-0.71094c-0.39743-0.91064-1.2955-1.4995-2.2891-1.5-0.99359 5.12e-4 -1.8916 0.58936-2.2891 1.5h-0.70898v-4c0-1.1046-0.89543-2-2-2h-1.2109c-0.39743-0.91064-1.2955-1.4995-2.2891-1.5zm0 1.5c0.55228 0 1 0.44772 1 1s-0.44772 1-1 1c-0.55228 0-1-0.44772-1-1s0.44772-1 1-1zm16.998 3c0.55228 0 1 0.44772 1 1 0 0.55228-0.44772 1-1 1s-1-0.44772-1-1c0-0.55228 0.44772-1 1-1zm-16.998 3c0.55228 0 1 0.44772 1 1s-0.44772 1-1 1c-0.55228 0-1-0.44772-1-1s0.44772-1 1-1zm8.498 0c0.55228 0 1 0.44772 1 1s-0.44772 1-1 1-1-0.44772-1-1 0.44772-1 1-1zm8.5 3c0.55228 0 1 0.44772 1 1 0 0.55228-0.44772 1-1 1s-1-0.44772-1-1c0-0.55228 0.44772-1 1-1zm-19.27 1.0391h1.2109zm2.2715 1.9629c0.55228 0 1 0.44772 1 1 0 0.55228-0.44772 1-1 1-0.55228 0-1-0.44772-1-1 0-0.55228 0.44772-1 1-1z","--md-sys-color-primary")}</span
          >
        </md-primary-tab>
        <md-primary-tab
          @click=${()=>{this._currentTabId=3}}
          has-icon
        >
          ${this._("Relationship Graph")}
          <span slot="icon"
            >${Ha("m3 0.47852c-2.1868 0.066468-3.4886 3.4114-1 4.7891v1.2109c0 1.1046 0.89543 2 2 2h1v0.5957a2.5155 2.5155 0 0 0-1.4727 2.2891 2.5155 2.5155 0 0 0 2.5156 2.5156 2.5155 2.5155 0 0 0 2.2344-1.3633h2.7227v2.6816h-0.001953-4c-1.1046 0-2 0.89543-2 2v1.2109c-0.91064 0.39743-1.4995 1.2955-1.5 2.2891 0 1.3807 1.1193 2.5 2.5 2.5s2.5-1.1193 2.5-2.5c-5.12e-4 -0.99358-0.58936-1.8916-1.5-2.2891v-1.2109h4v1.2109c-0.91064 0.39743-1.4995 1.2955-1.5 2.2891 0 1.3807 1.1193 2.5 2.5 2.5 1.3807 0 2.5-1.1193 2.5-2.5-5.12e-4 -0.99299-0.58644-1.8913-1.4961-2.2891v-1.2109h4v1.2109c-0.91064 0.39743-1.4995 1.2955-1.5 2.2891 0 1.3807 1.1193 2.5 2.5 2.5 1.3807 0 2.5-1.1193 2.5-2.5-5.12e-4 -0.99358-0.58936-1.8916-1.5-2.2891v-1.2109c0-1.1046-0.89543-2-2-2h-4.002v-2.6816h2.7695a2.5155 2.5155 0 0 0 2.2305 1.3633 2.5155 2.5155 0 0 0 2.5156-2.5156 2.5155 2.5155 0 0 0-1.5156-2.3066v-0.57812h1c1.1046 0 2-0.89543 2-2v-1.2109c0.91064-0.39743 1.4995-1.2955 1.5-2.2891 0-1.3807-1.1193-2.5-2.5-2.5s-2.5 1.1193-2.5 2.5c5.12e-4 0.99359 0.58936 1.8916 1.5 2.2891v1.2109h-4v-1.2109c0.91064-0.39743 1.4995-1.2955 1.5-2.2891 0-1.3807-1.1193-2.5-2.5-2.5s-2.5 1.1193-2.5 2.5c5.12e-4 0.99359 0.58936 1.8916 1.5 2.2891v1.2109c0 1.1046 0.89543 2 2 2h1v0.57812a2.5155 2.5155 0 0 0-1.3633 1.459h-7.2246a2.5155 2.5155 0 0 0-1.4121-1.4785v-0.55859h1c1.1046 0 2-0.89543 2-2v-1.2109c0.91064-0.39743 1.4995-1.2955 1.5-2.2891 0-1.3807-1.1193-2.5-2.5-2.5-1.3807 0-2.5 1.1193-2.5 2.5 5.119e-4 0.99359 0.58936 1.8916 1.5 2.2891v1.2109h-4v-1.2109c0.91064-0.39743 1.4995-1.2955 1.5-2.2891 0-1.3807-1.1193-2.5-2.5-2.5zm0 1.5c0.55228 0 1 0.44772 1 1 0 0.55228-0.44772 1-1 1s-1-0.44772-1-1c0-0.55228 0.44772-1 1-1zm6 0c0.55228 0 1 0.44772 1 1 0 0.55228-0.44772 1-1 1s-1-0.44772-1-1c0-0.55228 0.44772-1 1-1zm6 0c0.55228 0 1 0.44772 1 1 0 0.55228-0.44772 1-1 1s-1-0.44772-1-1c0-0.55228 0.44772-1 1-1zm6 0c0.55228 0 1 0.44772 1 1 0 0.55228-0.44772 1-1 1s-1-0.44772-1-1c0-0.55228 0.44772-1 1-1zm-14.957 8.3848a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1zm11.957 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1zm-12.002 9.334c0.55228 0 1 0.44772 1 1 0 0.55228-0.44772 1-1 1-0.55228 0-1-0.44772-1-1 0-0.55228 0.44772-1 1-1zm6 0c0.55228 0 1 0.44772 1 1 0 0.55228-0.44772 1-1 1-0.55228 0-1-0.44772-1-1 0-0.55228 0.44772-1 1-1zm6.0039 0c0.55228 0 1 0.44772 1 1 0 0.55228-0.44772 1-1 1-0.55228 0-1-0.44772-1-1 0-0.55228 0.44772-1 1-1zm-2.9629 2.0605v1.2109-1.2109z","--md-sys-color-primary")}</span
          >
        </md-primary-tab>
        <md-primary-tab
          @click=${()=>{this._currentTabId=4}}
          has-icon
        >
          ${this._("Fan Chart")}
          <span slot="icon"
            >${Ha("m13 2.0742v3.0469a7 7 0 0 1 5.9434 5.8789h3.0059a10 10 0 0 0-8.9492-8.9258zm-2 0.0019531a10 10 0 0 0-8.9277 8.9238h3.0508a7 7 0 0 1 5.877-5.873v-3.0508zm1 4.5605a5.3638 5.3638 0 0 0-5.2852 4.4688h2.7754a2.6819 2.6819 0 0 1 2.5098-1.7871 2.6819 2.6819 0 0 1 2.5273 1.7871h2.7598a5.3638 5.3638 0 0 0-5.2871-4.4688zm-5.2852 6.2578a5.3638 5.3638 0 0 0 5.2852 4.4688 5.3638 5.3638 0 0 0 5.2852-4.4688h-2.7754a2.6819 2.6819 0 0 1-2.5098 1.7871 2.6819 2.6819 0 0 1-2.5098-1.7871h-2.7754zm-4.6426 0.10547a10 10 0 0 0 8.9277 8.9238v-2.9863a7 7 0 0 1-5.8828-5.9375h-3.0449zm16.877 0a7 7 0 0 1-5.9492 5.9434v2.9805a10 10 0 0 0 8.9277-8.9238h-2.9785z","--md-sys-color-primary")}</span
          >
        </md-primary-tab>
      </md-tabs>
    `}_renderFan(){return M`
      <grampsjs-view-fan-chart
        @tree:back="${this._prevPerson}"
        @tree:person="${this._goToPerson}"
        @tree:home="${this._backToHomePerson}"
        grampsId=${this.grampsId}
        ?active=${this.active}
        .strings=${this.strings}
        .settings=${this.settings}
        ?disableBack=${this._history.length<2}
        ?disableHome=${this.grampsId===this.settings.homePerson}
      >
      </grampsjs-view-fan-chart>
    `}_renderRelationshipChart(){return M`
      <grampsjs-view-relationship-chart
        @tree:back="${this._prevPerson}"
        @tree:person="${this._goToPerson}"
        @tree:home="${this._backToHomePerson}"
        grampsId=${this.grampsId}
        ?active=${this.active}
        .strings=${this.strings}
        .settings=${this.settings}
        ?disableBack=${this._history.length<2}
        ?disableHome=${this.grampsId===this.settings.homePerson}
      >
      </grampsjs-view-relationship-chart>
    `}_renderPedigree(){return M`
      <grampsjs-view-tree-chart
        @tree:back="${this._prevPerson}"
        @tree:person="${this._goToPerson}"
        @tree:home="${this._backToHomePerson}"
        grampsId=${this.grampsId}
        ?active=${this.active}
        .strings=${this.strings}
        .settings=${this.settings}
        ?disableBack=${this._history.length<2}
        ?disableHome=${this.grampsId===this.settings.homePerson}
      >
      </grampsjs-view-tree-chart>
    `}_renderDescendantTree(){return M`
      <grampsjs-view-descendant-chart
        @tree:back="${this._prevPerson}"
        @tree:person="${this._goToPerson}"
        @tree:home="${this._backToHomePerson}"
        grampsId=${this.grampsId}
        ?active=${this.active}
        .strings=${this.strings}
        .settings=${this.settings}
        ?disableBack=${this._history.length<2}
        ?disableHome=${this.grampsId===this.settings.homePerson}
      >
      </grampsjs-view-descendant-chart>
    `}_renderHourglassTree(){return M`
      <grampsjs-view-hourglass-chart
        @tree:back="${this._prevPerson}"
        @tree:person="${this._goToPerson}"
        @tree:home="${this._backToHomePerson}"
        grampsId=${this.grampsId}
        ?active=${this.active}
        .strings=${this.strings}
        .settings=${this.settings}
        ?disableBack=${this._history.length<2}
        ?disableHome=${this.grampsId===this.settings.homePerson}
      >
      </grampsjs-view-hourglass-chart>
    `}_prevPerson(){this._history.pop(),this.grampsId=this._history.pop()}_backToHomePerson(){this.grampsId=this.settings.homePerson}_goToPerson(){os(this,"nav",{path:`person/${this.grampsId}`})}connectedCallback(){super.connectedCallback(),window.addEventListener("pedigree:person-selected",this._selectPerson.bind(this))}update(t){super.update(t),t.has("grampsId")&&(this._history.push(this.grampsId),this._history=this._history.slice(-100))}async _selectPerson(t){const{grampsId:e}=t.detail;this.grampsId=e}});const EL={2:"Unknown",1:"Male",0:"Female"},$L={_class:"Person",gender:2,citation_list:[]};window.customElements.define("grampsjs-view-new-person",class extends lT{constructor(){super(),this.data=$L,this.postUrl="/api/objects/",this.itemPath="person",this.objClass="Person"}renderContent(){return M`
      <h2>${this._("New Person")}</h2>

      <h4 class="label">${this._("Name")}</h4>
      <grampsjs-form-name
        id="primary-name"
        .strings="${this.strings}"
      ></grampsjs-form-name>

      <h4 class="label">${this._("Gender")}</h4>
      <mwc-select id="select-confidence" @change="${this.handleGender}">
        ${Object.keys(EL).map((t=>M`
            <mwc-list-item
              value="${t}"
              ?selected="${t==this.data.gender}"
              >${this._(EL[t])}</mwc-list-item
            >
          `))}
      </mwc-select>

      <h4 class="label">${this._("Birth Date")}</h4>

      <p>
        <grampsjs-form-select-date id="birth-date" .strings="${this.strings}">
        </grampsjs-form-select-date>
      </p>

      <h4 class="label">${this._("Birth Place")}</h4>

      <grampsjs-form-select-object-list
        id="birth-place"
        objectType="place"
        .strings="${this.strings}"
      ></grampsjs-form-select-object-list>

      <h4 class="label">${this._("Death Date")}</h4>

      <p>
        <grampsjs-form-select-date id="death-date" .strings="${this.strings}">
        </grampsjs-form-select-date>
      </p>

      <h4 class="label">${this._("Death Place")}</h4>

      <grampsjs-form-select-object-list
        id="death-place"
        objectType="place"
        .strings="${this.strings}"
      ></grampsjs-form-select-object-list>

      ${this._renderCitationForm()}

      <div class="spacer"></div>
      <grampsjs-form-private
        id="private"
        .strings="${this.strings}"
      ></grampsjs-form-private>

      ${this.renderButtons()}
    `}handleGender(t){this.data={...this.data,gender:parseInt(t.target.value,10)}}_handleFormData(t){super._handleFormData(t);const e=t.composedPath()[0];"primary-name"===e.id&&(this.data={...this.data,primary_name:t.detail.data}),"birth-date"===e.id&&(this.data={...this.data,birth:{...this.data.birth,date:t.detail.data}}),"birth-place-list"===e.id&&(this.data={...this.data,birth:{...this.data.birth,place:t.detail.data[0]}}),"death-date"===e.id&&(this.data={...this.data,death:{...this.data.death,date:t.detail.data}}),"death-place-list"===e.id&&(this.data={...this.data,death:{...this.data.death,place:t.detail.data[0]}}),this.checkFormValidity()}_processedData(){const t=ls(),e=ls(),i=ls(),r=this.translateTypeName(!1,"event_types","Birth"),n=this.translateTypeName(!1,"event_types","Death"),{birth:a,death:s,...o}=this.data,l=a.place||a?.date&&!_s(a.date),c=s.place||s?.date&&!_s(a.date);return l||c?c?l?[{...o,handle:t,event_ref_list:[{_class:"EventRef",ref:e},{_class:"EventRef",ref:i}],birth_ref_index:0,death_ref_index:1},{...a,_class:"Event",handle:e,type:{_class:"EventType",string:r},citation_list:o.citation_list??[]},{...s,_class:"Event",handle:i,type:{_class:"EventType",string:n},citation_list:o.citation_list??[]}]:[{...o,handle:t,event_ref_list:[{_class:"EventRef",ref:i}],death_ref_index:0},{...s,_class:"Event",handle:i,type:{_class:"EventType",string:n},citation_list:o.citation_list??[]}]:[{...o,handle:t,event_ref_list:[{_class:"EventRef",ref:e}],birth_ref_index:0},{...a,_class:"Event",handle:e,type:{_class:"EventType",string:r},citation_list:o.citation_list??[]}]:[o]}_submit(){const t=this._processedData();Nn(this.postUrl,t).then((t=>{if("data"in t){this.error=!1;const e=t.data.filter((t=>"Person"===t.new._class))[0].new.gramps_id;this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:this._getItemPath(e)}})),this._reset()}else"error"in t&&(this.error=!0,this._errorMessage=t.error)}))}checkFormValidity(){let t=!0;this.shadowRoot.querySelectorAll("grampsjs-form-select-date").forEach((e=>{e.isValid()||(t=!1)})),this.isFormValid=t}_reset(){super._reset(),this.data=$L}});const AL={_class:"Family"};window.customElements.define("grampsjs-view-new-family",class extends lT{constructor(){super(),this.data=AL,this.postUrl="/api/families/",this.itemPath="family",this.objClass="Family"}renderContent(){return M`
      <h2>${this._("New Family")}</h2>

      <h4 class="label">${this._("Father")}</h4>

      <grampsjs-form-select-object-list
        id="father"
        objectType="person"
        label="${this._("Select a person as the father")}"
        .strings="${this.strings}"
      ></grampsjs-form-select-object-list>

      <h4 class="label">${this._("Mother")}</h4>

      <grampsjs-form-select-object-list
        id="mother"
        objectType="person"
        label="${this._("Select a person as the mother")}"
        .strings="${this.strings}"
      ></grampsjs-form-select-object-list>

      <h4 class="label">${this._("Children")}</h4>

      <grampsjs-form-select-object-list
        multiple
        id="children"
        objectType="person"
        label="${this._("Add an existing person as a child of the family")}"
        .strings="${this.strings}"
      ></grampsjs-form-select-object-list>

      <grampsjs-form-select-type
        id="family-rel-type"
        heading="${this._("Relationship type:").replace(":","")}"
        .strings="${this.strings}"
        ?loadingTypes="${this.loadingTypes}"
        typeName="family_relation_types"
        defaultTypeName="Unknown"
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
      >
      </grampsjs-form-select-type>

      ${this._renderCitationForm()}

      <div class="spacer"></div>
      <grampsjs-form-private
        id="private"
        .strings="${this.strings}"
      ></grampsjs-form-private>

      ${this.renderButtons()}
    `}handleGender(t){this.data={...this.data,gender:parseInt(t.target.value,10)}}_handleFormData(t){super._handleFormData(t);const e=t.composedPath()[0];"father-list"===e.id&&(this.data={...this.data,father_handle:t.detail.data[0]}),"mother-list"===e.id&&(this.data={...this.data,mother_handle:t.detail.data[0]}),"children-list"===e.id&&(this.data={...this.data,child_ref_list:t.detail.data.map((t=>({_class:"ChildRef",ref:t})))}),"family-rel-type"===e.id&&(this.data={...this.data,type:{_class:"FamilyRelType",string:t.detail.data}}),this.checkFormValidity()}checkFormValidity(){this.isFormValid=!0}_reset(){super._reset(),this.data=AL}});class IL extends(jk(lT)){constructor(){super(),this.data={_class:"Event"},this.postUrl="/api/events/",this.itemPath="event",this.objClass="Event"}renderContent(){return M`
      <h2>${this._("New Event")}</h2>

      ${this.renderForm()} ${this.renderButtons()}
    `}handleDesc(t){this.data={...this.data,description:t.target.value.trim()}}_handleFormData(t){super._handleFormData(t),this.checkFormValidity();const e=t.composedPath()[0];"event-type"===e.id&&(this.data={...this.data,type:{_class:"EventType",string:t.detail.data}}),"place-list"===e.id&&(this.data={...this.data,place:t.detail.data[0]}),"date"===e.id&&(this.data={...this.data,date:t.detail.data}),"private"===e.id&&(this.data={...this.data,private:t.detail.checked})}checkFormValidity(){const t=this.shadowRoot.querySelector("grampsjs-form-select-type");let e=!0;null===!t||t.isValid()||(e=!1);const i=this.shadowRoot.querySelector("grampsjs-form-select-date");null===!i||i.isValid()||(e=!1),this.isFormValid=e}_reset(){super._reset()}}window.customElements.define("grampsjs-view-new-event",IL);window.customElements.define("grampsjs-view-new-place",class extends lT{constructor(){super(),this.data={_class:"Place"},this.postUrl="/api/places/",this.itemPath="place",this.objClass="Place"}renderContent(){return M`
      <h2>${this._("New Place")}</h2>

      <h4 class="label">${this._("Name")}</h4>
      <p>
        <mwc-textfield
          required
          validationMessage="${this._("This field is mandatory")}"
          style="width:100%;"
          @input="${this.handleName}"
          id="place-name"
        ></mwc-textfield>
      </p>

      <grampsjs-form-select-type
        required
        id="select-place-type"
        .strings="${this.strings}"
        ?loadingTypes="${this.loadingTypes}"
        typeName="place_types"
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
      >
      </grampsjs-form-select-type>

      <h4 class="label">${this._("Enclosed By")}</h4>
      <grampsjs-form-select-object-list
        id="enclosed"
        multiple
        objectType="place"
        .strings="${this.strings}"
      ></grampsjs-form-select-object-list>

      ${this._renderCitationForm()}

      <div class="spacer"></div>
      <grampsjs-form-private
        id="private"
        .strings="${this.strings}"
      ></grampsjs-form-private>

      ${this.renderButtons()}
    `}handleName(t){this.checkFormValidity(),this.data={...this.data,name:{_class:"PlaceName",value:t.target.value.trim()}}}_handleFormData(t){this.checkFormValidity();const e=t.composedPath()[0];if("select-place-type"===e.id&&(this.data={...this.data,place_type:{_class:"PlaceType",string:t.detail.data}}),"enclosed-list"===e.id){const e=t.detail.data;this.data={...this.data,placeref_list:e.map((t=>({_class:"PlaceRef",ref:t})))}}"private"===e.id&&(this.data={...this.data,private:t.detail.checked})}checkFormValidity(){const t=this.shadowRoot.querySelector("grampsjs-form-select-type");this.isFormValid=null===t||t.isValid();const e=this.shadowRoot.getElementById("place-name");try{this.isFormValid=this.isFormValid&&e?.validity?.valid}catch{this.isFormValid=!1}}_reset(){super._reset(),this.data={_class:"Place"}}});const ML={_class:"Source",reporef_list:[]};class LL extends lT{static get styles(){return[super.styles,n`
        .hidden {
          display: none;
        }
      `]}constructor(){super(),this.data={...ML},this.postUrl="/api/sources/",this.itemPath="source",this.objClass="Source"}renderContent(){return M`
      <h2>${this._("New Source")}</h2>

      <h4 class="label">${this._("Title")}</h4>
      <p>
        <mwc-textfield
          required
          validationMessage="${this._("This field is mandatory")}"
          style="width:100%;"
          @input="${this.handleName}"
          id="source-name"
        ></mwc-textfield>
      </p>

      <h4 class="label">${this._("Author")}</h4>
      <p>
        <grampsjs-form-string fullwidth id="author"></grampsjs-form-string>
      </p>

      <h4 class="label">${this._("Publication info")}</h4>
      <p>
        <grampsjs-form-string fullwidth id="pubinfo"></grampsjs-form-string>
      </p>

      <h4 class="label">${this._("Abbreviation")}</h4>
      <p>
        <grampsjs-form-string fullwidth id="abbrev"></grampsjs-form-string>
      </p>

      <h4 class="label">${this._("Repository")}</h4>

      <grampsjs-form-select-object-list
        id="reporef"
        objectType="repository"
        .strings="${this.strings}"
      ></grampsjs-form-select-object-list>

      <div class="${Ot({hidden:!this._hasRepoRef()})}">
        <h4 class="label">${this._("Call Number")}</h4>
        <p>
          <grampsjs-form-string
            fullwidth
            id="call_number"
            value="${this.data?.reporef_list?.[0]?.call_number??""}"
            ?disabled="${!this._hasRepoRef()}"
          ></grampsjs-form-string>
        </p>

        <h4 class="label">${this._("_Media Type:").replace(":","")}</h4>

          <grampsjs-form-select-type
            ?disabled="${!this._hasRepoRef()}"
            id="source-media-type"
            heading=" "
            .strings="${this.strings}"
            ?loadingTypes="${this.loadingTypes}"
            typeName="source_media_types"
            defaultTypeName="Unknown"
            .types="${this.types}"
            .typesLocale="${this.typesLocale}"
          >
          </grampsjs-form-select-type>
        </div>
        <div class="spacer"></div>
        <grampsjs-form-private
          id="private"
          .strings="${this.strings}"
        ></grampsjs-form-private>

        ${this.renderButtons()}
      </h4>
    `}_hasRepoRef(){return!!this.data?.reporef_list?.length}handleName(t){this.checkFormValidity(),this.data={...this.data,title:t.target.value.trim()}}_handleFormData(t){const e=t.composedPath()[0];if(this.checkFormValidity(),super._handleFormData(t),"reporef-list"===e.id){const e=t.detail?.data?.[0],i=void 0===e?[]:[{_class:"RepoRef",ref:e}];this.data={...this.data,reporef_list:i}}if("call_number"===e.id&&this._hasRepoRef()){const e={...this.data.reporef_list[0],call_number:t.detail.data};this.data={...this.data,reporef_list:[e]}}if("source-media-type"===e.id&&this._hasRepoRef()){const e={...this.data.reporef_list[0],media_type:{_class:"SourceMediaType",string:t.detail.data}};this.data={...this.data,reporef_list:[e]}}}checkFormValidity(){const t=this.shadowRoot.getElementById("source-name");t.reportValidity();try{this.isFormValid=t?.validity?.valid}catch{this.isFormValid=!1}}_reset(){super._reset(),this.isFormValid=!1,this.data={...ML}}}window.customElements.define("grampsjs-view-new-source",LL);window.customElements.define("grampsjs-view-new-repository",class extends lT{constructor(){super(),this.data={_class:"Repository"},this.postUrl="/api/repositories/",this.itemPath="repository",this.objClass="Repository"}renderContent(){return M`
      <h2>${this._("New Repository")}</h2>

      <h4 class="label">${this._("Name")}</h4>
      <p>
        <mwc-textfield
          required
          validationMessage="${this._("This field is mandatory")}"
          style="width:100%;"
          @input="${this.handleName}"
          id="repository-name"
        ></mwc-textfield>
      </p>

      <grampsjs-form-select-type
        required
        id="select-repository-type"
        .strings="${this.strings}"
        ?loadingTypes="${this.loadingTypes}"
        typeName="repository_types"
        .types="${this.types}"
        .typesLocale="${this.typesLocale}"
      >
      </grampsjs-form-select-type>

      <div class="spacer"></div>
      <grampsjs-form-private
        id="private"
        .strings="${this.strings}"
      ></grampsjs-form-private>

      ${this.renderButtons()}
    `}handleName(t){this.checkFormValidity(),this.data={...this.data,name:t.target.value.trim()}}_handleFormData(t){this.checkFormValidity();const e=t.composedPath()[0];"select-repository-type"===e.id&&(this.data={...this.data,type:{_class:"RepositoryType",string:t.detail.data}}),"private"===e.id&&(this.data={...this.data,private:t.detail.checked})}checkFormValidity(){const t=this.shadowRoot.querySelector("grampsjs-form-select-type");this.isFormValid=null===t||t.isValid();const e=this.shadowRoot.getElementById("repository-name");try{this.isFormValid=this.isFormValid&&e?.validity?.valid}catch{this.isFormValid=!1}}_reset(){super._reset(),this.data={_class:"Repository"}}});class PL extends(df(lT)){constructor(){super(),this.data={_class:"Note",text:{_class:"StyledText",string:""}},this.postUrl="/api/notes/",this.itemPath="note",this.objClass="Note"}renderContent(){return M`
      <h2>${this._("New Note")}</h2>

      ${this.renderForm()} ${this.renderButtons()}
    `}checkFormValidity(){const t=this.shadowRoot.querySelector("grampsjs-editor");this.isFormValid=""!==t.data.string.trim()}handleEditor(t){this.checkFormValidity(),this.data={...this.data,text:t.detail.data}}_handleFormData(t){this.checkFormValidity();const e=t.composedPath()[0];"select-note-type"===e.id&&(this.data={...this.data,type:{_class:"NoteType",string:t.detail.data}}),"private"===e.id&&(this.data={...this.data,private:t.detail.checked})}_reset(){this.shadowRoot.querySelector("grampsjs-editor").reset();this.shadowRoot.getElementById("select-note-type").reset();this.shadowRoot.getElementById("private").reset(),this.data={_class:"Note",text:{_class:"StyledText",string:""}}}}window.customElements.define("grampsjs-view-new-note",PL);class RL extends(Vk(lT)){constructor(){super(),this.data={_class:"Media"},this.postUrl="/api/media/",this.itemPath="media",this.objClass="Media"}renderContent(){return M`
      <h2>${this._("New Media")}</h2>

      ${this.renderForm()} ${this.renderButtons()}
    `}checkFormValidity(){let t=!!this.shadowRoot.getElementById("upload").file.name;const e=this.shadowRoot.querySelector("grampsjs-form-select-date");null===!e||e.isValid()||(t=!1),this.isFormValid=t}_handleFormData(t){super._handleFormData(t);const e=t.composedPath()[0];"date"===e.id&&(this.data={...this.data,date:t.detail.data}),"upload"===e.id&&(this.data={...this.data,desc:t.detail.data.name.replace(/\.[^/.]+$/,"")}),this.checkFormValidity()}_reset(){super._reset(),this.isFormValid=!1,this.data={_class:"Media"}}_submit(){const t=this.shadowRoot.getElementById("upload");Nn(this.postUrl,t.file,!1,!1).then((t=>{"data"in t?(this.error=!1,this.data={...t.data[0].new,...this.data}):"error"in t&&(this.error=!0,this._errorMessage=t.error)})).then((()=>{Fn(`/api/media/${this.data.handle}`,this.data).then((t=>{"data"in t?(this.error=!1,this.dispatchEvent(new CustomEvent("nav",{bubbles:!0,composed:!0,detail:{path:this._getItemPath(this.data.gramps_id)}})),this._reset()):"error"in t&&(this.error=!0,this._errorMessage=t.error)}))}))}}window.customElements.define("grampsjs-view-new-media",RL);const zL={_class:"Source",attribute_list:[{_class:"SrcAttribute",type:"Priority",value:"5"}]};window.customElements.define("grampsjs-view-new-task",class extends LL{static get properties(){return{_todoTagHandle:{type:String}}}constructor(){super(),this.data=zL,this.postUrl="/api/objects/",this.itemPath="task",this.objClass="Source",this._todoTagHandle=""}renderContent(){const t=this.data.attribute_list.filter((t=>"Priority"===t.type))[0]?.value;return M`
      <h2>${this._("New Task")}</h2>

      <h4 class="label">${this._("Title")}</h4>
      <p>
        <mwc-textfield
          required
          validationMessage="${this._("This field is mandatory")}"
          style="width:100%;"
          @input="${this.handleName}"
          id="source-name"
        ></mwc-textfield>
      </p>

      <h4 class="label">${this._("Description")}</h4>
      <p>
        <grampsjs-editor
          @formdata:changed="${this.handleEditor}"
          id="note-editor"
        ></grampsjs-editor>
      </p>

      <h4 class="label">${this._("Priority")}</h4>
      <p>
        <mwc-select @change="${this.handlePriority}">
          <mwc-list-item ?selected="${t<4}" value="1"
            >${this._("High")}</mwc-list-item
          >
          <mwc-list-item ?selected="${"5"===t}" value="5"
            >${this._("Medium")}</mwc-list-item
          >
          <mwc-list-item ?selected="${t>5}" value="9"
            >${this._("Low")}</mwc-list-item
          >
        </mwc-select>
      </p>

      <div class="spacer"></div>
      <grampsjs-form-private
        id="private"
        .strings="${this.strings}"
      ></grampsjs-form-private>

      ${this.renderButtons()}
    `}handleName(t){this.checkFormValidity(),this.data={...this.data,title:t.target.value.trim()}}_handleFormData(t){this.checkFormValidity(),super._handleFormData(t)}handleEditor(t){if(t.detail?.data?.string&&t.detail.data.string.trim())this.data={...this.data,note:{_class:"Note",text:t.detail.data}};else{const{note:t,...e}=this.data;this.data=e}}checkFormValidity(){const t=this.shadowRoot.getElementById("source-name");t.reportValidity();try{this.isFormValid=t?.validity?.valid}catch{this.isFormValid=!1}}handlePriority(t){const{value:e}=t.target;this.data={...this.data,attribute_list:[...this.data.attribute_list.filter((t=>"Priority"!==t.type)),{_class:"SrcAttribute",type:"Priority",value:e}]}}_reset(){super._reset();this.shadowRoot.querySelector("grampsjs-editor").reset(),this.isFormValid=!1,this.data=zL}_processedData(){const t=ls(),e=ls(),{note:i,...r}=this.data,n=i?.text?.string,a={_class:"SrcAttribute",type:"Status",value:"Open"};return n?[{...r,handle:t,note_list:[e],attribute_list:[...r.attribute_list,a],tag_list:[this._todoTagHandle]},{...i,handle:e,tag_list:[this._todoTagHandle],type:{_class:"NoteType",string:"To Do"}}]:[{...r,attribute_list:[...r.attribute_list,a],tag_list:[this._todoTagHandle]}]}async _fetchTodoTagHandle(t=!0){const e=await On("/api/tags/");if("data"in e){const i=e.data.filter((t=>"ToDo"===t.name));if(i.length>0)this._todoTagHandle=i[0].handle;else{const e={name:"ToDo"};await Nn("/api/tags/",e),t&&await this._fetchTodoTagHandle(!1)}}}firstUpdated(){this._fetchTodoTagHandle()}_submit(){const t=this._processedData();Nn(this.postUrl,t).then((t=>{"data"in t?(this.error=!1,os(this,"nav",{path:"tasks"}),this._reset()):"error"in t&&(this.error=!0,this._errorMessage=t.error)}))}});class DL extends(al(K)){static get styles(){return[nl,n`
        .page {
          display: none;
        }

        .page[active] {
          display: block;
        }
      `]}static get properties(){return{settings:{type:Object},canAdd:{type:Boolean},canEdit:{type:Boolean},canManageUsers:{type:Boolean},canViewPrivate:{type:Boolean},canUseChat:{type:Boolean},homePersonDetails:{type:Object},strings:{type:Object},dbInfo:{type:Object},page:{type:String},pageId:{type:String}}}constructor(){super(),this.settings={},this.canAdd=!1,this.canEdit=!1,this.canManageUsers=!1,this.canUseChat=!1,this.homePersonDetails={},this.strings={},this.dbInfo={},this.page="",this.pageId=""}render(){return M`
      <grampsjs-view-dashboard
        class="page"
        ?active=${"home"===this.page}
        .strings="${this.strings}"
        .dbInfo="${this.dbInfo}"
        .homePersonDetails=${this.homePersonDetails}
        .homePersonGrampsId=${this.settings.homePerson??""}
      ></grampsjs-view-dashboard>
      <grampsjs-view-blog
        class="page"
        ?active=${"blog"===this.page&&!this.pageId}
        .strings="${this.strings}"
      ></grampsjs-view-blog>
      <grampsjs-view-blog-post
        class="page"
        ?active=${"blog"===this.page&&this.pageId}
        grampsId="${this.pageId}"
        .strings="${this.strings}"
      ></grampsjs-view-blog-post>

      <grampsjs-view-people
        class="page"
        ?active=${"people"===this.page}
        .strings="${this.strings}"
        ?canAdd=${this.canAdd}
      ></grampsjs-view-people>
      <grampsjs-view-families
        class="page"
        ?active=${"families"===this.page}
        .strings="${this.strings}"
        ?canAdd=${this.canAdd&&this.canEdit}
      ></grampsjs-view-families>
      <grampsjs-view-events
        class="page"
        ?active=${"events"===this.page}
        .strings="${this.strings}"
        ?canAdd=${this.canAdd}
      ></grampsjs-view-events>
      <grampsjs-view-places
        class="page"
        ?active=${"places"===this.page}
        .strings="${this.strings}"
        ?canAdd=${this.canAdd}
      ></grampsjs-view-places>
      <grampsjs-view-sources
        class="page"
        ?active=${"sources"===this.page}
        .strings="${this.strings}"
        ?canAdd=${this.canAdd}
      ></grampsjs-view-sources>
      <grampsjs-view-citations
        class="page"
        ?active=${"citations"===this.page}
        .strings="${this.strings}"
        ?canAdd=${this.canAdd}
      ></grampsjs-view-citations>
      <grampsjs-view-repositories
        class="page"
        ?active=${"repositories"===this.page}
        .strings="${this.strings}"
        ?canAdd=${this.canAdd}
      ></grampsjs-view-repositories>
      <grampsjs-view-notes
        class="page"
        ?active=${"notes"===this.page}
        .strings="${this.strings}"
        ?canAdd=${this.canAdd}
      ></grampsjs-view-notes>
      <grampsjs-view-media-objects
        class="page"
        ?active=${"medialist"===this.page}
        .strings="${this.strings}"
        ?canAdd=${this.canAdd&&this.canEdit}
      ></grampsjs-view-media-objects>

      <grampsjs-view-map
        class="page"
        ?active=${"map"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-map>
      <grampsjs-view-tree
        class="page"
        ?active=${"tree"===this.page}
        grampsId="${this.settings.homePerson}"
        .strings="${this.strings}"
        .settings="${this.settings}"
      ></grampsjs-view-tree>
      <grampsjs-view-person
        class="page"
        ?active=${"person"===this.page}
        grampsId="${this.pageId}"
        .strings="${this.strings}"
        ?canEdit="${this.canEdit}"
        .homePersonDetails=${this.homePersonDetails}
      ></grampsjs-view-person>
      <grampsjs-view-family
        class="page"
        ?active=${"family"===this.page}
        grampsId="${this.pageId}"
        .strings="${this.strings}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-view-family>
      <grampsjs-view-event
        class="page"
        ?active=${"event"===this.page}
        grampsId="${this.pageId}"
        .strings="${this.strings}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-view-event>
      <grampsjs-view-place
        class="page"
        ?active=${"place"===this.page}
        grampsId="${this.pageId}"
        .strings="${this.strings}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-view-place>
      <grampsjs-view-source
        class="page"
        ?active=${"source"===this.page}
        grampsId="${this.pageId}"
        .strings="${this.strings}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-view-source>
      <grampsjs-view-citation
        class="page"
        ?active=${"citation"===this.page}
        grampsId="${this.pageId}"
        .strings="${this.strings}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-view-citation>
      <grampsjs-view-repository
        class="page"
        ?active=${"repository"===this.page}
        grampsId="${this.pageId}"
        .strings="${this.strings}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-view-repository>
      <grampsjs-view-note
        class="page"
        ?active=${"note"===this.page}
        grampsId="${this.pageId}"
        .strings="${this.strings}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-view-note>
      <grampsjs-view-media
        class="page"
        ?active=${"media"===this.page}
        grampsId="${this.pageId}"
        .strings="${this.strings}"
        ?canEdit="${this.canEdit}"
        .dbInfo="${this.dbInfo}"
      ></grampsjs-view-media>
      ${this.canUseChat?M`
            <grampsjs-view-chat
              class="page"
              ?active=${"chat"===this.page}
              .strings="${this.strings}"
            ></grampsjs-view-chat>
          `:""}
      <grampsjs-view-export
        class="page"
        ?active=${"export"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-export>
      <grampsjs-view-reports
        class="page"
        ?active=${"reports"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-reports>
      <grampsjs-view-search
        class="page"
        ?active=${"search"===this.page}
        .strings="${this.strings}"
        .dbInfo="${this.dbInfo}"
      ></grampsjs-view-search>
      <grampsjs-view-recent
        class="page"
        ?active=${"recent"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-recent>
      <grampsjs-view-bookmarks
        class="page"
        ?active=${"bookmarks"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-bookmarks>
      <grampsjs-view-tasks
        class="page"
        ?active=${"tasks"===this.page}
        .strings="${this.strings}"
        ?canEdit="${this.canEdit}"
        ?canAdd="${this.canAdd}"
      ></grampsjs-view-tasks>
      <grampsjs-view-settings
        class="page"
        ?active=${"settings"===this.page}
        .dbInfo="${this.dbInfo}"
        .strings="${this.strings}"
        ?owner="${this.canManageUsers}"
      ></grampsjs-view-settings>
      <grampsjs-view-report
        class="page"
        ?active=${"report"===this.page}
        .strings="${this.strings}"
        reportId="${this.pageId}"
      ></grampsjs-view-report>
      ${this.canViewPrivate?M`
            <grampsjs-view-revisions
              class="page"
              ?active=${"revisions"===this.page}
              .strings="${this.strings}"
            ></grampsjs-view-revisions>
          `:""}
      <grampsjs-view-revision
        class="page"
        transactionId="${this.pageId}"
        ?active=${"revision"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-revision>

      <grampsjs-view-new-person
        class="page"
        ?active=${"new_person"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-new-person>
      <grampsjs-view-new-family
        class="page"
        ?active=${"new_family"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-new-family>
      <grampsjs-view-new-event
        class="page"
        ?active=${"new_event"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-new-event>
      <grampsjs-view-new-place
        class="page"
        ?active=${"new_place"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-new-place>
      <grampsjs-view-new-source
        class="page"
        ?active=${"new_source"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-new-source>
      <grampsjs-view-new-citation
        class="page"
        ?active=${"new_citation"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-new-citation>
      <grampsjs-view-new-repository
        class="page"
        ?active=${"new_repository"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-new-repository>
      <grampsjs-view-new-note
        class="page"
        ?active=${"new_note"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-new-note>
      <grampsjs-view-new-media
        class="page"
        ?active=${"new_media"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-new-media>
      <grampsjs-view-new-task
        class="page"
        ?active=${"new_task"===this.page}
        .strings="${this.strings}"
      ></grampsjs-view-new-task>
      <grampsjs-view-task
        class="page"
        ?active=${"task"===this.page}
        grampsId="${this.pageId}"
        .strings="${this.strings}"
        ?canEdit="${this.canEdit}"
      ></grampsjs-view-task>
    `}}window.customElements.define("grampsjs-pages",DL);class jL extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"}).innerHTML="<slot><button>New update available!</button></slot>",this._refreshing=!1}async connectedCallback(){if(this.setAttribute("hidden",""),this.addEventListener("click",this._postMessage.bind(this)),"serviceWorker"in navigator){const t=await navigator.serviceWorker.getRegistration();t&&(t.addEventListener("updatefound",(()=>{this._newWorker=t.installing,this._newWorker.addEventListener("statechange",(()=>{"installed"===this._newWorker.state&&navigator.serviceWorker.controller&&(this.dispatchEvent(new CustomEvent("pwa-update-available",{detail:!0})),this.removeAttribute("hidden"))}))})),t.waiting&&navigator.serviceWorker.controller&&(this.dispatchEvent(new CustomEvent("pwa-update-available",{detail:!0})),this._newWorker=t.waiting,this.removeAttribute("hidden"))),navigator.serviceWorker.addEventListener("controllerchange",(()=>{this._refreshing||(window.location.reload(),this._refreshing=!0)}))}}_postMessage(t){t.preventDefault(),this._newWorker.postMessage({type:"SKIP_WAITING"})}}function OL(){return M`
    <mwc-button
      outlined
      label="logout"
      icon="exit_to_app"
      @click=${()=>En()}
    ></mwc-button>
  `}window.customElements.define("grampsjs-update-available",class extends jL{async connectedCallback(){super.connectedCallback(),this.removeEventListener("click",this._postMessage.bind(this)),this.addEventListener("update:reload",this._postMessage.bind(this))}});class BL extends(al(K)){static get styles(){return[nl,n`
        .center-xy {
          display: flex;
          justify-content: center;
          text-align: center;
          align-items: center;
          margin: 0 auto;
          height: 100vh;
        }

        .center-xy div {
          display: block;
          max-width: 30em;
        }
      `]}static get properties(){return{dbInfo:{type:Object},permissions:{type:Array}}}constructor(){super(),this.dbInfo={},this.permissons=[]}render(){return this.permissions.includes("AddObject")?this.renderOwner():this.renderNonOwner()}renderNonOwner(){return M`<div class="center-xy">
      <div>
        ${this._("The Family Tree you are trying to load is in a schema version not supported by this version of Gramps Web. Therefore you cannot load this Family Tree until the tree administrator has upgraded its schema.")}<br /><br />
        ${OL()}
      </div>
    </div>`}renderOwner(){return M`<div class="center-xy">
      <div>
        ${this._("The Family Tree you are trying to load is in a schema version not supported by this version of Gramps Web. Therefore you cannot load this Family Tree without upgrading its schema. This action cannot be undone.")}<br /><br />
        <mwc-button
          raised
          @click="${this._upgradeDb}"
          @keydown="${gs}"
          >${this._("Upgrade database")}</mwc-button
        >
        <grampsjs-task-progress-indicator
          taskName="upgradeDb"
          class="button"
          size="20"
          pollInterval="0.2"
          @task:complete="${this._handleUpgradeComplete}"
        ></grampsjs-task-progress-indicator>
        <br /><br />
        ${OL()}
      </div>
    </div>`}async _upgradeDb(){const t=this.renderRoot.querySelector("grampsjs-task-progress-indicator");t.reset(),t.open=!0;const e=await Nn("/api/trees/-/migrate");"error"in e?(t.setError(),t.errorMessage=e.error):"task"in e?t.taskId=e.task?.id||"":t.setComplete()}connectedCallback(){super.connectedCallback(),this.permissions=In()}_handleUpgradeComplete(){os(this,"dbupgrade:complete")}}window.customElements.define("grampsjs-upgrade-db",BL);class FL extends(al(K)){static get styles(){return[nl]}static get properties(){return{transaction:{type:Array},redirect:{type:String}}}constructor(){super(),this.transaction=[],this.redirect="",this._boundHandleEvent=this._handleEvent.bind(this)}render(){return M`
      <mwc-snackbar leading id="undo-snackbar">
        <mwc-button slot="action" @click="${this._handleUndo}"
          >${this._("Undo")}</mwc-button
        >
        <mwc-icon-button icon="close" slot="dismiss"></mwc-icon-button>
      </mwc-snackbar>
    `}async _handleUndo(){if(this.transaction.length>0){const t=await Nn("/api/transactions/?undo=1",this.transaction);"data"in t?os(this,"nav",{path:this.redirect}):"error"in t&&os(this,"grampsjs:error",{message:t.error})}}_handleEvent(t){this.transaction=t.detail.transaction||[],this.redirect=t.detail.redirect||"";const e=this.renderRoot.querySelector("mwc-snackbar");e.labelText=this._(t.detail.message),e.show()}connectedCallback(){super.connectedCallback(),window.addEventListener("transaction:undo",this._boundHandleEvent)}disconnectedCallback(){window.removeEventListener("transaction:undo",this._boundHandleEvent),super.disconnectedCallback()}}window.customElements.define("grampsjs-undo-transaction",FL);customElements.define("gramps-js",class extends K{static get properties(){return{wide:{type:Boolean},progress:{type:Boolean},loadingState:{type:Number},settings:{type:Object},canAdd:{type:Boolean},canEdit:{type:Boolean},canViewPrivate:{type:Boolean},canManageUsers:{type:Boolean},_homePersonDetails:{type:Object},_lang:{type:String},_strings:{type:Object},_dbInfo:{type:Object},_page:{type:String},_pageId:{type:String},_showShortcuts:{type:Boolean},_shortcutPressed:{type:String},_firstRunToken:{type:String},_loadingStrings:{type:Boolean},reindexNeeded:{type:Boolean}}}constructor(){super(),this.wide=!1,this.progress=!1,this.loadingState=0,this.settings=Mn(),this.canAdd=!1,this.canEdit=!1,this.canViewPrivate=!1,this.canManageUsers=!1,this._homePersonDetails={},this._lang="",this._strings={},this._dbInfo={},this._page="home",this._pageId="",this._showShortcuts=!1,this._shortcutPressed="",this._firstRunToken="",this._loadingStrings=!1,this._reindexNeeded=!1}static get styles(){return[nl,n`
        :host {
          height: 100%;
        }

        main {
          padding: 0;
        }

        .page {
          display: none;
        }

        .page[active] {
          display: block;
        }

        mwc-drawer {
          --mdc-drawer-width: 230px;
          --mdc-typography-headline6-font-family: var(
            --grampsjs-heading-font-family
          );
          --mdc-typography-headline6-font-weight: 400;
          --mdc-typography-headline6-font-size: 19px;
        }

        mwc-drawer[open]:not([type='modal']) {
          --mdc-top-app-bar-width: calc(100% - var(--mdc-drawer-width, 256px));
        }

        mwc-linear-progress {
          --mdc-theme-primary: #4fc3f7;
        }

        #user-menu mwc-button {
          margin: 0.5em 1em;
        }

        #person-button {
          margin-left: 60px;
          margin-top: 10px;
          background-color: #e0e0e0;
          color: #444;
          border-radius: 50%;
        }

        #app-title:first-letter {
          text-transform: capitalize;
        }

        .center-xy {
          display: flex;
          justify-content: center;
          align-items: center;
          margin: 0 auto;
          height: 100vh;
        }

        .center-xy div {
          display: block;
          width: 20%;
          text-align: center;
        }

        .menu-bottom {
          position: absolute;
          bottom: 0;
          width: 100%;
          border-top: 1px solid #e0e0e0;
          background-color: white;
        }

        mwc-list {
          --mdc-list-item-graphic-margin: 20px;
          --mdc-list-side-padding: 20px;
        }

        #onboarding {
          width: 100%;
          max-width: 30em;
        }

        grampsjs-view-settings-onboarding {
          width: 100%;
        }

        mwc-tab-bar {
          margin: 20px;
        }

        #shortcut-overlay-container {
          background-color: rgba(0, 0, 0, 0.1);
          position: fixed;
          left: 0;
          top: 0;
          right: 0;
          bottom: 0;
          min-height: 100vh;
          width: 100vw;
          z-index: 10001;
          overflow: hidden;
          display: flex;
          justify-content: center;
          align-items: center;
        }

        #shortcut-overlay {
          font-size: 16px;
          background-color: white;
          padding: 0.5em 1.5em;
          position: absolute;
          top: 15vh;
          overflow-y: auto;
          max-width: 100vw;
          max-height: 75vh;
          border-radius: 8px;
        }

        #shortcut-overlay section {
          display: flex;
          flex-direction: row;
          gap: 24px;
        }

        #shortcut-overlay h3 {
          margin-top: 0.5em;
          font-size: 1.3em;
          font-weight: 400;
        }

        #shortcut-overlay h4 {
          margin-top: 0.5em;
          font-weight: 400;
          font-size: 1em;
        }

        #shortcut-overlay dl {
          display: grid;
          grid-template-columns: max-content auto;
          margin: 0.5em 0em;
        }

        #shortcut-overlay dt {
          grid-column-start: 1;
          margin-right: 1.2em;
        }

        #shortcut-overlay dt span {
          font-family: var(--grampsjs-heading-font-family);
          font-size: 11px;
          font-weight: 400;
          display: inline-block;
          min-width: 0.75em;
          padding: 4px 6px;
          text-align: center;
          border: 1px solid #ccc;
          color: #555;
          border-radius: 6px;
          margin-bottom: 4px;
        }

        #shortcut-overlay dd {
          grid-column-start: 2;
          padding: 0;
        }
      `]}render(){return M`
      ${this.renderContent()} ${this._renderKeyboardShortcuts()}
      <mwc-snackbar id="error-snackbar" leading></mwc-snackbar>
      <mwc-snackbar id="notification-snackbar" leading></mwc-snackbar>
      ${this._reindexNeeded?this._renderReindexSnackbar():""}
      <grampsjs-undo-transaction
        .strings="${this._strings}"
      ></grampsjs-undo-transaction>
      <grampsjs-update-available>
        <mwc-snackbar
          leading
          open
          timeoutMs="-1"
          labelText="${this._("A new version of the app is available.")}"
        >
          <mwc-button slot="action" @click=${this._postUpdateMessage}
            >${this._("Refresh")}</mwc-button
          >
        </mwc-snackbar>
      </grampsjs-update-available>
    `}_renderReindexSnackbar(){return M`<mwc-snackbar
      id="reindex-snackbar"
      leading
      open
      timeoutMs="-1"
      labelText="${this._("The search index needs to be rebuilt.")}"
    >
      ${this.canManageUsers?M`
            <mwc-button slot="action" @click="${this._handleReindexButton}"
              >${this._("Settings")}</mwc-button
            >
          `:""}
      ></mwc-snackbar
    >`}_handleReindexButton(t){os(this,"nav",{path:"settings"}),t.preventDefault(),t.stopPropagation()}_renderKeyboardShortcuts(){return this._showShortcuts?M`
      <div id="shortcut-overlay-container">
        <div id="shortcut-overlay">
          <h3>${this._("Keyboard Shortcuts")}</h3>
          <section>
            <div>
              <h4>${this._("Global")}</h4>
              <dl>
                <dt><span>?</span></dt>
                <dd>${this._("Show this dialog")}</dd>
                <dt><span>s</span></dt>
                <dd>${this._("Search")}</dd>
              </dl>
            </div>
            <div>
              <h4>${this._("Navigation")}</h4>
              <dl>
                <dt><span>g</span> <span>h</span></dt>
                <dd>${this._("Home Page")}</dd>
                <dt><span>g</span> <span>b</span></dt>
                <dd>${this._("Blog")}</dd>
                <dt><span>g</span> <span>l</span></dt>
                <dd>${this._("Lists")}</dd>
                <dt><span>g</span> <span>m</span></dt>
                <dd>${this._("Map")}</dd>
                <dt><span>g</span> <span>c</span></dt>
                <dd>${this._("Family Tree")}</dd>
                <dt><span>g</span> <span>r</span></dt>
                <dd>${this._("History")}</dd>
                <dt><span>g</span> <span>f</span></dt>
                <dd>${this._("_Bookmarks")}</dd>
                <dt><span>g</span> <span>t</span></dt>
                <dd>${this._("Tasks")}</dd>
                <dt><span>g</span> <span>e</span></dt>
                <dd>${this._("Export")}</dd>
              </dl>
            </div>
            <div>
              <h4>${this._("New")}</h4>
              <dl>
                <dt><span>n</span> <span>p</span></dt>
                <dd>${this._("Person")}</dd>
                <dt><span>n</span> <span>f</span></dt>
                <dd>${this._("Family")}</dd>
                <dt><span>n</span> <span>e</span></dt>
                <dd>${this._("Event")}</dd>
                <dt><span>n</span> <span>l</span></dt>
                <dd>${this._("Place")}</dd>
                <dt><span>n</span> <span>s</span></dt>
                <dd>${this._("Source")}</dd>
                <dt><span>n</span> <span>c</span></dt>
                <dd>${this._("Citation")}</dd>
                <dt><span>n</span> <span>r</span></dt>
                <dd>${this._("Repository")}</dd>
                <dt><span>n</span> <span>n</span></dt>
                <dd>${this._("Note")}</dd>
                <dt><span>n</span> <span>m</span></dt>
                <dd>${this._("Media Object")}</dd>
                <dt><span>n</span> <span>t</span></dt>
                <dd>${this._("Task")}</dd>
              </dl>
            </div>
          </section>
        </div>
      </div>
    `:""}_postUpdateMessage(){os(this,"update:reload")}_renderInitial(){return M`<div class="center-xy">
      <div>
        <mwc-linear-progress indeterminate></mwc-linear-progress>
      </div>
    </div> `}_renderNoConn(){return M`<div class="center-xy">
      <div>
        No connection<br /><br />
        <mwc-button raised @click=${this._handleReload}>Reload</mwc-button>
      </div>
    </div> `}_renderSchemaMismatch(){return M`<grampsjs-upgrade-db
      .dbInfo="${this._dbInfo}"
      .strings="${this._strings}"
      @dbupgrade:complete="${this._handleDbUpgradeComplete}"
    ></grampsjs-upgrade-db>`}_renderLogin(t){return M`
      <grampsjs-login
        ?register="${t}"
        .strings="${this._strings}"
        tree="${this._pageId||""}"
      ></grampsjs-login>
    `}_renderFirstRun(){return M`
      <grampsjs-first-run
        .strings="${this._strings}"
        token="${this._firstRunToken}"
        @firstrun:done="${this._firstRunDone}"
      ></grampsjs-first-run>
    `}_renderOnboarding(){return M`
      <div class="center-xy" id="onboarding">
        <grampsjs-view-settings-onboarding
          @onboarding:completed="${this._setReady}"
          class="page"
          active
          .strings="${this._strings}"
          ?requireHomePerson="${!1}"
        ></grampsjs-view-settings-onboarding>
      </div>
    `}renderContent(){if(0===this.loadingState)return this._renderInitial();if(2===this.loadingState)return this._renderNoConn();if(1===this.loadingState){const{loginRedirect:t}=window.grampsjsConfig;return t&&"login"!==this._page&&"register"!==this._page&&(window.location.href=t),"register"===this._page?(window.history.pushState({},"","register"),this._renderLogin(!0)):(window.history.pushState({},"","login"),this._renderLogin(!1))}if(3===this.loadingState)return window.history.pushState({},"","firstrun"),this._renderFirstRun();if(Mn().lang||(this.loadingState=5),4===this.loadingState)return this._renderSchemaMismatch();if(5===this.loadingState)return this._renderOnboarding();"login"===this._page&&(window.history.pushState({},"",""),this._page="home"),!this.settings.lang||this._backendStringsLoaded()||this._loadingStrings||this._loadStrings(ea,this.settings.lang);const t={people:this._("People"),families:this._("Families"),events:this._("Events"),places:this._("Places"),sources:this._("Sources"),citations:this._("Citations"),repositories:this._("Repositories"),notes:this._("Notes"),medialist:this._("Media Objects")};return M`
      <mwc-drawer type="dismissible" id="app-drawer" ?open="${this.wide}">
        <div>
          <grampsjs-main-menu
            .strings="${this._strings}"
            ?canViewPrivate="${this.canViewPrivate}"
            ?canUseChat="${this.canUseChat}"
          ></grampsjs-main-menu>
        </div>
        <div slot="appContent">
          <grampsjs-app-bar
            ?add="${this.canAdd}"
            .strings="${this._strings}"
          ></grampsjs-app-bar>
          <mwc-linear-progress indeterminate ?closed="${!this.progress}">
          </mwc-linear-progress>

          <main>
            ${this._tabHtml(t)}
            <grampsjs-pages
              .strings="${this._strings}"
              .dbInfo="${this._dbInfo}"
              .homePersonDetails=${this._homePersonDetails}
              .settings="${this.settings}"
              .page="${this._page}"
              .pageId="${this._pageId}"
              .canAdd="${this.canAdd}"
              .canEdit="${this.canEdit}"
              .canViewPrivate="${this.canViewPrivate}"
              .canManageUsers="${this.canManageUsers}"
              .canUseChat="${this.canUseChat}"
            >
            </grampsjs-pages>
          </main>
        </div>
      </mwc-drawer>
    `}_tabHtml(t){return this._page in t?M`
      <mwc-tab-bar activeIndex="${Object.keys(t).indexOf(this._page)}">
        ${Object.keys(t).map((e=>M`<mwc-tab
              isMinWidthIndicator
              label="${t[e]}"
              @click="${()=>this._handleTab(e)}"
            ></mwc-tab>`))}
      </mwc-tab-bar>
    `:""}_toggleDrawer(){const t=this.shadowRoot.getElementById("app-drawer");null!==t&&(t.open=!t.open)}_closeDrawer(){const t=this.shadowRoot.getElementById("app-drawer");null!==t&&t.open&&(t.open=!1)}_handleReload(){this.loadingState=0,this._loadDbInfo()}_firstRunDone(){document.location.href="/"}connectedCallback(){super.connectedCallback(),this._loadDbInfo(),window.addEventListener("db:changed",(()=>this._loadDbInfo(!1))),this.addEventListener("drawer:toggle",this._toggleDrawer),window.addEventListener("keydown",(t=>this._handleKey(t))),document.addEventListener("visibilitychange",(()=>this._handleVisibilityChange())),window.addEventListener("online",(()=>this._handleOnline())),window.addEventListener("token:refresh",(()=>this._handleRefresh()));const t=function(){const t=navigator.language.replaceAll("-","_");return Jn.includes(t)?t:Jn.includes(t.split("_")[0])?t.split("_")[0]:null}();t&&!this.settings.lang&&Ln({lang:t}),this.settings.lang&&this._loadFrontendStrings(t)}firstUpdated(){var t;t=t=>this._loadPage(decodeURIComponent(t.pathname)),document.body.addEventListener("click",(e=>{if(e.defaultPrevented||0!==e.button||e.metaKey||e.ctrlKey||e.shiftKey)return;const i=e.composedPath().filter((t=>"A"===t.tagName))[0];if(!i||i.target||i.hasAttribute("download")||"external"===i.getAttribute("rel"))return;const r=i.href;if(!r||-1!==r.indexOf("mailto:"))return;const n=window.location,a=n.origin||n.protocol+"//"+n.host;0===r.indexOf(a)&&(e.preventDefault(),r!==n.href&&(window.history.pushState({},"",r),t(n,e)))})),window.addEventListener("popstate",(e=>t(window.location,e))),t(window.location,null),((t,e)=>{let i=window.matchMedia(t);i.addListener((t=>e(t.matches))),e(i.matches)})("(min-width: 768px)",(t=>{this.wide=t})),this.addEventListener("nav",this._handleNav.bind(this)),this.addEventListener("grampsjs:error",this._handleError.bind(this)),this.addEventListener("grampsjs:notification",this._handleNotification.bind(this)),this.addEventListener("progress:on",this._progressOn.bind(this)),this.addEventListener("progress:off",this._progressOff.bind(this)),window.addEventListener("user:loggedout",this._handleLogout.bind(this)),window.addEventListener("settings:changed",this._handleSettings.bind(this))}async _loadFrontendStrings(t){const e=await ta(t);this._strings={...this._strings,...e},this._strings.__lang__=t,this._lang=t}_loadDbInfo(t=!0){On("/api/metadata/").then((e=>{if("error"in e)"Network error"===e.error?this.loadingState=2:this._fetchOnboardingToken();else if("data"in e){if(this._dbInfo=e.data,this._checkSearch(),this._checkApiVersion(),!this._checkDbSchema())return;void 0!==this._dbInfo?.locale?.language&&Ln({serverLang:this._dbInfo.locale.language}),t&&this._setReady(),this._loadHomePersonInfo()}}))}_checkApiVersion(){const t=this._dbInfo?.gramps_webapi?.version;if(!t)return;const e=t.split("."),i="2.3.0".split("."),r=Math.min(i.length,e.length);for(let n=0;n<r;n+=1){if(e[n]>i[n])return;e[n]<i[n]&&this._showError(`${this._("outdated backend")} (${t})`)}}_checkSearch(){const t=this._dbInfo?.search?.sifts?.version;if(void 0===t)return void(window._oldSearchBackend=!0);window._oldSearchBackend=!1;const e=this._dbInfo?.search?.sifts?.count??0,i=this._dbInfo?.object_counts??{},r=Object.values(i).reduce(((t,e)=>t+e),0);this._reindexNeeded=0===e&&r>0}_checkDbSchema(){if(this._dbInfo?.database?.actual_schema){if(parseInt(this._dbInfo.database.actual_schema,10)<parseInt(this._dbInfo.database.schema.split(".")[0],10))return this.loadingState=4,!1}return!0}_fetchOnboardingToken(){Nn("/api/token/create_owner/","firstrun"===this._page&&this._pageId?{tree:this._pageId}:{},!0,!1).then((t=>{!("error"in t)&&t?.data?.access_token?(this.loadingState=3,this._firstRunToken=t?.data?.access_token):this.loadingState=1}))}_loadHomePersonInfo(){const t=this.settings.homePerson;t&&On(`/api/people/?gramps_id=${t}&profile=self&extend=media_list`).then((t=>{"data"in t?[this._homePersonDetails]=t.data:"error"in t&&this._showError(t.error)}))}_setReady(){this.loadingState=10,this.setPermissions()}_loadPage(t){if(this._disableEditMode(),"/"===t||"/"===t)this._page="home",this._pageId="";else{const e=t.slice(1),i=e.split("/")[0],r=e.split("/")[1];this._page=i,this._pageId=r||""}this.wide||this._closeDrawer()}_progressOn(){this.progress=!0}_progressOff(){this.progress=!1}_handleTab(t){if(t!==this._page){const e=`/${t}`;this._loadPage(e),window.history.pushState({},"",e),this._disableEditMode()}}_handleNav(t){const{path:e}=t.detail,i=e.split("/")[0],r=e.split("/")[1];if(i!==this._page||r!==this._pageId){const t=`/${e}`;this._loadPage(t),window.history.pushState({},"",t),this._disableEditMode()}}_disableEditMode(){os(this,"edit-mode:off",{})}_handleError(t){const{message:e}=t.detail;this._showError(e)}_handleNotification(t){const{message:e}=t.detail;this._showToast(e)}_handleDbUpgradeComplete(){this._handleReload()}_handleVisibilityChange(){"visible"===document.visibilityState&&this._handleRefresh()}_handleOnline(){this._handleRefresh()}async _handleRefresh(){await jn(),this.setPermissions()}update(t){super.update(t),t.has("settings")&&this.loadingState>2&&this.settings.lang&&this.settings.lang!==this._lang&&this._loadStrings(ea,this.settings.lang)}_backendStringsLoaded(){return Boolean(ea[0]in this._strings)}async _loadStrings(t,e){this._loadingStrings=!0;const i=await Nn(`/api/translations/${e}`,{strings:t},!0,!1);if(this._loadingStrings=!1,"data"in i){if(this._strings=i.data.reduce(((t,e)=>Object.assign(t,{[e.original]:e.translation})),{}),Jn.includes(e)){const t=await ta(e);this._strings=Object.assign(t,this._strings)}this._strings.__lang__=e,this._lang=e,os(this,"language:changed",{lang:e})}"error"in i&&this._showError(i.error)}_showError(t){const e=this.shadowRoot.getElementById("error-snackbar");e.labelText=`${this._("Error")}: ${t}`,e.show()}_showToast(t){const e=this.shadowRoot.getElementById("notification-snackbar");e.labelText=t,e.show()}_openUserMenu(){this.shadowRoot.getElementById("user-menu").open=!0}_handleLogout(){this.loadingState=1}_handleSettings(){this.settings=Mn(),this.settings?.homePerson&&this.settings.homePerson!==this._homePersonDetails.gramps_id&&this._loadHomePersonInfo()}_handleKey(t){const e=t.composedPath()[0];if(!["input","textarea","select","option","mwc-list-item"].includes(e.tagName.toLowerCase())&&!e.getAttribute("contenteditable")){if(this._showShortcuts&&(this._showShortcuts=!1),"g"===this._shortcutPressed)"h"===t.key?os(this,"nav",{path:""}):"b"===t.key?os(this,"nav",{path:"blog"}):"l"===t.key?os(this,"nav",{path:"people"}):"m"===t.key?os(this,"nav",{path:"map"}):"c"===t.key?os(this,"nav",{path:"tree"}):"r"===t.key?os(this,"nav",{path:"recent"}):"f"===t.key?os(this,"nav",{path:"bookmarks"}):"t"===t.key?os(this,"nav",{path:"tasks"}):"e"===t.key&&os(this,"nav",{path:"export"}),this._shortcutPressed="";else if("n"===this._shortcutPressed)"p"===t.key?os(this,"nav",{path:"new_person"}):"f"===t.key?os(this,"nav",{path:"new_family"}):"e"===t.key?os(this,"nav",{path:"new_event"}):"l"===t.key?os(this,"nav",{path:"new_place"}):"s"===t.key?os(this,"nav",{path:"new_source"}):"c"===t.key?os(this,"nav",{path:"new_citation"}):"r"===t.key?os(this,"nav",{path:"new_repository"}):"n"===t.key?os(this,"nav",{path:"new_note"}):"m"===t.key?os(this,"nav",{path:"new_media"}):"t"===t.key&&os(this,"nav",{path:"new_task"}),this._shortcutPressed="";else if("g"===t.key)this._shortcutPressed="g";else if("n"===t.key)this._shortcutPressed="n";else if("s"===t.key)os(this,"nav",{path:"search"});else{if("?"!==t.key)return;this._showShortcuts=!0}t.preventDefault(),t.stopPropagation()}}setPermissions(){const t=In();this.canAdd=t.includes("AddObject"),this.canEdit=t.includes("EditObject"),this.canViewPrivate=t.includes("ViewPrivate"),this.canManageUsers=t.includes("EditOtherUser"),this.canUseChat=t.includes("UseChat")&&this._dbInfo?.server?.chat}_(t){let e=t;return e in this._strings&&(e=this._strings[e]),e=e.replace("_",""),e}});
